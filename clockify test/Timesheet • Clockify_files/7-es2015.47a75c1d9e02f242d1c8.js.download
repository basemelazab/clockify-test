(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"+W0u":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("WjWa"),s=n("1Tmk"),c=n("fXoL"),a=n("tyNb"),o=n("ofXK"),r=n("sYmb");function l(e,t){if(1&e&&(c.Xb(0,"a",4),c.Zc(1),c.oc(2,"translate"),c.Wb()),2&e){const e=c.nc();c.Hb("cl-active",e.page===e.ActivityPills.SCREENSHOTS),c.Cb(1),c.ad(c.pc(2,3,"GLOBAL.SCREENSHOT_TITLE"))}}function b(e,t){if(1&e&&(c.Xb(0,"a",5),c.Zc(1),c.oc(2,"translate"),c.Wb()),2&e){const e=c.nc();c.Hb("cl-active",e.page===e.ActivityPills.LOCATIONS),c.Cb(1),c.ad(c.pc(2,3,"GLOBAL.LOCATIONS_LABEL"))}}let d=(()=>{class e{constructor(e,t){this.router=e,this.workspaceService=t,this.ActivityPills=i.a}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace()}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(a.d),c.Rb(s.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["activity-tabs"]],inputs:{page:"page"},decls:6,vars:5,consts:[[1,"cl-btn-group"],[1,"cl-btn","cl-btn-outline-light","cl-page-switcher-name","cl-d-none","cl-d-sm-inline-flex"],["routerLink","/activity/screenshots","class","cl-btn cl-btn-outline-light",3,"cl-active",4,"ngIf"],["routerLink","/activity/locations","class","cl-btn cl-btn-outline-light",3,"cl-active",4,"ngIf"],["routerLink","/activity/screenshots",1,"cl-btn","cl-btn-outline-light"],["routerLink","/activity/locations",1,"cl-btn","cl-btn-outline-light"]],template:function(e,t){1&e&&(c.Xb(0,"div",0),c.Xb(1,"span",1),c.Zc(2),c.oc(3,"translate"),c.Wb(),c.Xc(4,l,3,5,"a",2),c.Xc(5,b,3,5,"a",3),c.Wb()),2&e&&(c.Cb(2),c.bd(" ",c.pc(3,3,"GLOBAL.ACTIVITY_LABEL")," "),c.Cb(2),c.wc("ngIf",t.workspace.screenshotsEnabled),c.Cb(1),c.wc("ngIf",t.workspace.locationsEnabled))},directives:[o.u,a.g],pipes:[r.e],encapsulation:2}),e})()},"0Mwv":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("lvCY"),s=n("xoOP"),c=n("fXoL"),a=n("ofXK");function o(e,t){if(1&e&&(c.Vb(0),c.Sb(1,"img",2),c.Ub()),2&e){const e=c.nc();c.Cb(1),c.wc("src",e.src,c.Qc)}}const r=function(e,t){return[e,t]};function l(e,t){if(1&e&&(c.Xb(0,"div",4),c.Xb(1,"span"),c.Zc(2),c.Wb(),c.Wb()),2&e){const e=c.nc(2);c.wc("ngClass",c.Cc(2,r,e.bgClass,e.classSize)),c.Cb(2),c.ad(e.initials)}}function b(e,t){if(1&e&&c.Xc(0,l,3,5,"div",3),2&e){const e=c.nc();c.wc("ngIf",e.initials)}}let d=(()=>{class e{constructor(){this.classes=["cl-bg-red","cl-bg-pink","cl-bg-purple","cl-bg-deep-purple","cl-bg-indigo","cl-bg-blue","cl-bg-cyan","cl-bg-teal","cl-bg-green","cl-bg-light-green","cl-bg-amber","cl-bg-orange","cl-bg-deep-orange","cl-bg-brown","cl-bg-yellow"],this.classSize="cl-no-image-wrapper-md"}set src(e){this._src=e,this.checkForUpdates&&this.checkAvatart()}get src(){return this._src}set name(e){e&&(e=e.trim()),this._name=e,this.checkForUpdates&&this.checkAvatart()}get name(){return this._name}ngOnInit(){this.checkAvatart(),this.checkForUpdates=!0}checkAvatart(){if(this.name&&(!this.src||this.src.indexOf(i.t)>-1))return this.initials=Object(s.l)(this.name),void(this.bgClass=this.setColor(this.initials));this.initials=null}setColor(e){const t=this.getHashCode(e),n=this.getKey(t);return this.classes[n]}getHashCode(e){let t=0;for(let n=0,i=e.length;n<i;n++)t=e.charCodeAt(n)+((t<<5)-t);return t}getKey(e,t=0,n=this.classes.length-1){let i=e%100;if(i<t)return t;for(;i>n;)i/=10;return i=Math.ceil(i),i=i>n?n:i,i}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Lb({type:e,selectors:[["avatar"],["","avatar",""]],inputs:{src:"src",name:"name",classSize:"classSize"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["lettersTemplate",""],[1,"cl-avatar-image",3,"src"],[3,"ngClass",4,"ngIf"],[3,"ngClass"]],template:function(e,t){if(1&e&&(c.Xc(0,o,2,1,"ng-container",0),c.Xc(1,b,1,1,"ng-template",null,1,c.Yc)),2&e){const e=c.Lc(2);c.wc("ngIf",!t.initials)("ngIfElse",e)}},directives:[a.u,a.r],encapsulation:2,changeDetection:0}),e})()},"83av":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return e.CONTAINS="CONTAINS",e.DOES_NOT_CONTAIN="DOES_NOT_CONTAIN",e.CONTAINS_ONLY="CONTAINS_ONLY",e}({})},"8N2M":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("fXoL");let s=(()=>{class e{}return e.\u0275mod=i.Pb({type:e}),e.\u0275inj=i.Ob({factory:function(t){return new(t||e)}}),e})()},"9WzS":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return e.ALL="ALL",e.ACTIVE="ACTIVE",e.INACTIVE="INACTIVE",e.INVITED="PENDING",e}({})},GK8k:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var i=n("tQGB"),s=n("PW4C"),c=n("lvCY"),a=n("XNiG"),o=n("2Vo4"),r=n("1G5W"),l=n("fXoL");let b=(()=>{class e{constructor(e,t){this.browserService=e,this.uiSettingsService=t,this.unsubscribe$=new a.a,this.sidebarState$=new o.a(null),this.initState(),this.browserService.isBreakpointLg$.pipe(Object(r.a)(this.unsubscribe$)).subscribe(e=>this.isDesktop=e)}get isSidebarOpen(){return this._isSidebarOpen}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initState(){let e;if(this.isDesktop=window.innerWidth>=c.h,this.isDesktop){e=this.uiSettingsService.getSettings(s.b.IS_SIDEBAR_OPEN);const t=!0;e=void 0===e?t:e}else e=!1;this.setSidebar(e)}setSidebar(e){this._isSidebarOpen=e,this.sidebarState$.next(e),this.isDesktop&&this.uiSettingsService.setSettings(s.b.IS_SIDEBAR_OPEN,e)}}return e.\u0275fac=function(t){return new(t||e)(l.fc(i.a),l.fc(s.a))},e.\u0275prov=l.Nb({token:e,factory:e.\u0275fac}),e})()},K5US:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("8N2M"),s=n("fXoL");let c=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.a]]}),e})()},MjqS:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("wd/R"),s=n("B4wx"),c=n("lNpb"),a=n("fXoL");let o=(()=>{class e{getDays(e){const t=[];let n=i(e.start).clone();for(;n.isSameOrBefore(e.end);)t.push(n),n=n.clone().add(1,"day");return t}createHolidaysAndRequests(e,t,n,a){const o=[];return this.getDays(n).forEach(n=>{const r=a.settings.timeFormat===s.a.HOUR24?"HH:mm":"hh:mmA";t.forEach((e,t)=>{(n.isSame(e.timeOffPeriod.period.start,"day")||n.isSame(e.timeOffPeriod.period.end,"day")||n.isBetween(e.timeOffPeriod.period.start,e.timeOffPeriod.period.end))&&o.push({id:"r_"+t,name:e.policyName,period:{start:e.timeUnit===c.a.DAYS?n.clone().startOf("day"):i(e.timeOffPeriod.period.start),end:e.timeUnit===c.a.DAYS?n.clone().endOf("day"):i(e.timeOffPeriod.period.end)},hours:e.timeUnit===c.a.DAYS?null:i(e.timeOffPeriod.period.start).format(r)+" - "+i(e.timeOffPeriod.period.end).format(r),type:"REQUEST",timeUnit:e.timeUnit,isHalfDay:e.timeOffPeriod.isHalfDay})}),e.forEach((e,t)=>{(n.isSame(e.period.start,"day")||n.isSame(e.period.end,"day")||n.isBetween(e.period.start,e.period.end))&&o.push({id:"h_"+t,name:e.name,period:{start:n.clone().startOf("day"),end:n.clone().endOf("day")},type:"HOLIDAY",timeUnit:c.a.DAYS})})}),o}calculateDailyTimeOffs(e,t,n){const s=[];return e.sort((e,t)=>{const n=e.timeUnit,i=t.timeUnit;return n>i?1:n<i?-1:0}),t.forEach(t=>{const c=e.filter(e=>{const s=i.tz(e.period.start,n),c=i.tz(e.period.end,n);return t.isBetween(s,c,"day","[]")});s.push(c.length>0?c:[])}),s}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=a.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},MxRx:function(e,t,n){"use strict";n.d(t,"c",(function(){return k})),n.d(t,"b",(function(){return W})),n.d(t,"a",(function(){return X}));var i=n("fXoL"),s=n("wd/R"),c=n("wHJU"),a=n("y+xF"),o=n("JBiw"),r=n("8+Zx"),l=n("hkzH"),b=n("cGux"),d=n("+yX9"),u=n("1Tmk"),p=n("QTBk"),h=n("3Pt+"),m=n("twZS"),g=n("lGQG"),E=n("ePBx"),f=n("Y9WU"),S=n("SvJf"),C=n("ofXK"),A=n("2rWG"),O=n("sbmM"),v=n("qUN8"),T=n("/DYx"),I=n("D0uv"),w=n("sYmb");function L(e,t){1&e&&(i.Xb(0,"h1",24),i.Zc(1),i.oc(2,"translate"),i.Wb()),2&e&&(i.Cb(1),i.ad(i.pc(2,1,"PTO.CREATE_HOLIDAY.TITLE")))}function R(e,t){1&e&&(i.Xb(0,"h1",24),i.Zc(1),i.oc(2,"translate"),i.Wb()),2&e&&(i.Cb(1),i.ad(i.pc(2,1,"PTO.CREATE_EDIT_HOLIDAY.TITLE_EDIT")))}function y(e,t){if(1&e&&(i.Xb(0,"span",25),i.Zc(1),i.Wb()),2&e){const e=i.nc();i.Cb(1),i.ad(e.userSize)}}function _(e,t){if(1&e){const e=i.Yb();i.Xb(0,"dropdown-checkbox",26),i.jc("loadMore",(function(){return i.Oc(e),i.nc().getMoreUsers()}))("onChange",(function(t){return i.Oc(e),i.nc().onAssigneeFilterChanged(t)}))("onCloseFilter",(function(t){return i.Oc(e),i.nc().onAssigneeFilterChanged(t)}))("onFilterOptionChange",(function(t){return i.Oc(e),i.nc().onFilterOptionChange(t)}))("onSearchChange",(function(t){return i.Oc(e),i.nc().onAssigneeFilterSearchChanged(t)})),i.oc(1,"translate"),i.Wb()}if(2&e){const e=i.nc();i.wc("placeholder",i.pc(1,11,"TEAMS.MEMBERS.INFO.GROUP.PLACEHOLDER"))("preventOfflineFiltering",!0)("showSelectAll",!0)("isResizeable",!1)("filterOptions",e.userFilterOptions)("checkboxValues",e.checkboxValuesDataDummy)("selectableMaps",e.filterMaps)("searchValue",e.userQuery.name)("countMap",e.userCount)("isIncludingNew",e.form.get("everyoneIncludingNew").value)("showIncludeNew",e.showIncludingNew)}}const k="users",W="userGroups";let X=(()=>{class e{constructor(e,t,n,c,a){this.ptoService=e,this.userGroupService=t,this.workspaceService=n,this.authService=c,this.analyticsService=a,this.form=new h.j({name:new h.g(null,[h.G.required]),users:new h.j({contains:new h.g(null),ids:new h.g(null),status:new h.g(null)}),everyoneIncludingNew:new h.g(!1),userGroups:new h.j({contains:new h.g(null),ids:new h.g(null),status:new h.g(null)}),period:new h.j({start:new h.g(null,[h.G.required]),end:new h.g(null,[h.G.required])}),occursAnnually:new h.g(!1)},[m.a]),this.dateRange={start:s(),end:s()},this.reachedLimit={},this.closeEmit=new i.n,this.create=new i.n,this.edit=new i.n,this.userFilterOptions=p.b,this.userCount=new b.a,this.userQuery={page:1,limit:50,statuses:[l.l.ACTIVE,l.l.PENDING],email:"",name:""},this.userGroupsQuery={page:1,limit:50,name:""},this.checkboxValuesDataDummy=new r.a({options:{status:"ACTIVE"}}),this.userSize=0,this.showIncludingNew=!0}set holiday(e){this._holiday=e||null,this.holidayId=(null==e?void 0:e.id)||null}ngOnInit(){var e,t;if(this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.timeZone=this.authService.getUser().settings.timeZone,"edit"===this.type){this.setInitialFormData(this._holiday),this.checkboxValuesDataDummy=new r.a({options:{status:"ALL"}}),this.userQuery.statuses.push(l.l.INACTIVE),this.checkboxValuesDataDummy.pushIds(k,this._holiday.userIds),this.checkboxValuesDataDummy.pushIds(W,this._holiday.userGroupIds);const e=s(this._holiday.period.start).format("YYYY-MM-DDT00:00:00.000")+"Z",t=s(this._holiday.period.end).format("YYYY-MM-DDT23:59:59.999")+"Z";this.dateRange.start=s(e),this.dateRange.end=s(t),this.form.get("period.start").setValue(e.substring(0,10)),this.form.get("period.end").setValue(t.substring(0,10))}"create"===this.type&&(this.form.get("period.start").setValue(s(this.dateRange.start).format("YYYY-MM-DD")),this.form.get("period.end").setValue(s(this.dateRange.end).format("YYYY-MM-DD")),this.form.markAllAsTouched()),this.fetchUsersAndGroups(),this.filterMaps=new o.a([new a.a(W,null,{label:"GLOBAL.GROUPS_LABEL"}),new a.a(k,null,{label:"GLOBAL.USERS_LABEL"})]),this.userSize=this._holiday?(null===(e=this._holiday.userIds)||void 0===e?void 0:e.length)+(null===(t=this._holiday.userGroupIds)||void 0===t?void 0:t.length):0}close(){this.closeEmit.emit()}onDateChanged(e){this.dateRange.start=s(e.dateRange.start),this.dateRange.end=s(e.dateRange.end),this.form.get("period.start").setValue(s(e.dateRange.start).format("YYYY-MM-DD")),this.form.get("period.start").markAsTouched(),this.form.get("period.start").markAsDirty(),this.form.get("period.end").setValue(s(e.dateRange.end).format("YYYY-MM-DD")),this.form.get("period.end").markAsTouched(),this.form.get("period.end").markAsDirty(),this.form.updateValueAndValidity()}onSubmit(){this.form.valid&&("create"===this.type?this.ptoService.createHoliday(this.form.value):this.ptoService.editHoliday(this.form.value,this.holidayId)).subscribe(e=>{Object.assign({},e),this.sendAnalyticsEvent(e.name,"change"),this.sendAnalyticsEvent(`${e.datePeriod.startDate}-${e.datePeriod.endDate}`,"change"),this.sendAnalyticsEvent("Submit","chaSubmitnge"),"create"===this.type?this.create.emit(e):this.edit.emit(e)})}sendAnalyticsEvent(e,t){this.analyticsService.addEvent(new S.a({event:t,value:e,section:"Time Off",section2:"Manage Holiday",section3:"Create holiday"}))}createNewHolidayObject(e){const t={name:e.name,userIds:e.userIds,userGroupIds:e.userGroupIds,everyoneIncludingNew:e.everyoneIncludingNew,period:{start:e.period.start,end:e.period.end},occursAnnually:e.occursAnnually};return"edit"===this.type&&(t.id=this.holidayId),new c.a(Object.assign({},t))}assigneeDropdownClosed(e){this.resetQuery(),this.fetchUsersAndGroups()}onAssigneeFilterSearchChanged(e){this.resetQuery(),this.userQuery.email=e,this.userGroupsQuery.name=e,this.fetchUsersAndGroups()}getMoreUsers(){this.userGroupsQuery.page++,this.userQuery.page++,this.fetchUsersAndGroups()}fetchUsersAndGroups(){this.getUsers(),this.getUserGroups()}getUsers(){this.reachedLimit[k]||this.workspaceService.getReportsFilterTeamMembers(this.userQuery).subscribe(({count:e,users:t})=>{!!this.userQuery.name||this.userCount.set(k,e),1===this.userQuery.page&&this.filterMaps.resetMap(k),this.filterMaps.pushToMap(k,t,{label:"GLOBAL.USERS_LABEL"});const n=this.filterMaps.countSelectablesOf(k);this.reachedLimit[k]=n>=e||t.length<this.userQuery.limit})}getUserGroups(){1===this.userQuery.statuses.length&&this.userQuery.statuses.includes(l.l.INACTIVE)?this.filterMaps.removeMap(W):this.reachedLimit[W]||this.userGroupService.getUserGroups(this.userGroupsQuery).subscribe(({groups:e,count:t})=>{if(0===t)return void this.filterMaps.removeMap(W);const n=e.length,i=e.filter(e=>"Admins"!==e.name);e=i,!!this.userGroupsQuery.name||this.userCount.set(W,t),1===this.userGroupsQuery.page&&this.filterMaps.resetMap(W),this.filterMaps.unshiftToMap(W,e,{label:"GLOBAL.GROUPS_LABEL"});const s=this.filterMaps.countSelectablesOf(W);this.reachedLimit[W]=s>=t||n<this.userGroupsQuery.limit})}onFilterOptionChange(e){e.value===l.l.ALL?(this.userQuery.statuses=[l.l.ACTIVE,l.l.INACTIVE,l.l.PENDING],this.showIncludingNew=!0):e.value===l.l.ACTIVE?(this.userQuery.statuses=[l.l.ACTIVE,l.l.PENDING],this.showIncludingNew=!0):(this.userQuery.statuses=[e.value],this.showIncludingNew=!1),this.resetQuery(),this.fetchUsersAndGroups(),this.form.get("everyoneIncludingNew").setValue(!1)}onAssigneeFilterChanged(e){this.userLabel=e.label,this.userSize=e.numberOfSelected,this.form.get("users.status").setValue(e.checkboxValues.options.status),this.form.get("users.contains").setValue(e.checkboxValues.exclude?l.d.DOES_NOT_CONTAIN:l.d.CONTAINS),this.form.get("users.ids").setValue(e.checkboxValues.map.users||[]),this.form.get("users").markAllAsTouched(),this.form.get("users").markAsDirty(),this.form.get("userGroups.status").setValue(e.checkboxValues.options.status),this.form.get("userGroups.contains").setValue(e.checkboxValues.exclude&&e.checkboxValues.options.status!=l.l.INACTIVE?l.d.DOES_NOT_CONTAIN:l.d.CONTAINS),this.form.get("userGroups.ids").setValue(e.checkboxValues.map.userGroups||[]),this.form.get("userGroups").markAllAsTouched(),this.form.get("userGroups").markAsDirty(),this.form.get("everyoneIncludingNew").setValue(e.includingNew)}resetQuery(){this.userQuery.name="",this.userQuery.email="",this.userGroupsQuery.name="",this.userQuery.page=1,this.userGroupsQuery.page=1,this.reachedLimit[k]=!1,this.reachedLimit[W]=!1}setInitialFormData(e){this.form.get("name").setValue(e.name),this.form.get("everyoneIncludingNew").setValue(e.everyoneIncludingNew),this.form.get("users.contains").setValue(l.d.CONTAINS),this.form.get("users.ids").setValue(e.userIds),this.form.get("users.status").setValue(l.l.ALL),this.form.get("userGroups.contains").setValue(l.d.CONTAINS),this.form.get("userGroups.ids").setValue(e.userGroupIds),this.form.get("userGroups.status").setValue(l.l.ALL),this.form.get("period.start").setValue(s(e.period.start).format("YYYY-MM-DDT00:00:00.000")+"Z"),this.form.get("period.end").setValue(s(e.period.end).format("YYYY-MM-DDT23:59:59.000")+"Z"),this.form.get("occursAnnually").setValue(e.occursAnnually)}}return e.\u0275fac=function(t){return new(t||e)(i.Rb(d.b),i.Rb(E.a),i.Rb(u.a),i.Rb(g.a),i.Rb(f.a))},e.\u0275cmp=i.Lb({type:e,selectors:[["app-create-holiday"]],inputs:{holiday:"holiday",type:"type"},outputs:{closeEmit:"closeEmit",create:"create",edit:"edit"},decls:49,vars:39,consts:[[1,"cl-modal-header"],["class","cl-modal-title",4,"ngIf"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body",3,"formGroup"],[1,"cl-mb-3"],[1,"cl-color-red","cl-ml-1"],["ngbAutofocus","","formControlName","name",1,"cl-form-control",3,"placeholder"],[1,"cl-form-group"],[1,"cl-d-block"],["dropdownKey","",1,"cl-dropdown","cl-dropdown-large","cl-d-inline-block",3,"onClose"],["dropdownKeyButton","","tabindex","0","placement","bottom",1,"cl-dropdown-item-label","cl-btn","cl-btn-outline-light","cl-text-left","cl-dropdown-toggle","pointer"],[1,"cl-dropdown-prefix","cl-d-inline-block"],["class","cl-badge cl-badge-filter",4,"ngIf"],[3,"placeholder","preventOfflineFiltering","showSelectAll","isResizeable","filterOptions","checkboxValues","selectableMaps","searchValue","countMap","isIncludingNew","showIncludeNew","loadMore","onChange","onCloseFilter","onFilterOptionChange","onSearchChange",4,"dropdownKeyContent"],[1,"cl-mb-3","create-holiday-period"],[3,"cssClass","getOfUtc","noInitialDateRange","removeArrows","timeEntriesDateRange","disableRanges","dateRangeOut"],[1,"cl-custom-control","cl-custom-checkbox"],["formControlName","occursAnnually","type","checkbox","id","annually",1,"cl-custom-control-input"],["for","annually",1,"cl-custom-control-label"],[1,"cl-modal-footer"],[3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[1,"cl-modal-title"],[1,"cl-badge","cl-badge-filter"],[3,"placeholder","preventOfflineFiltering","showSelectAll","isResizeable","filterOptions","checkboxValues","selectableMaps","searchValue","countMap","isIncludingNew","showIncludeNew","loadMore","onChange","onCloseFilter","onFilterOptionChange","onSearchChange"]],template:function(e,t){1&e&&(i.Xb(0,"div",0),i.Xc(1,L,3,3,"h1",1),i.Xc(2,R,3,3,"h1",1),i.Xb(3,"button",2),i.jc("click",(function(){return t.close()})),i.Xb(4,"span",3),i.Sb(5,"img",4),i.Wb(),i.Wb(),i.Wb(),i.Xb(6,"div",5),i.Xb(7,"div",6),i.Xb(8,"label"),i.Zc(9),i.oc(10,"translate"),i.Xb(11,"span",7),i.Zc(12,"*"),i.Wb(),i.Wb(),i.Sb(13,"input",8),i.oc(14,"translate"),i.Wb(),i.Xb(15,"div",6),i.Xb(16,"div",9),i.Xb(17,"label",10),i.Zc(18),i.oc(19,"translate"),i.Xb(20,"span",7),i.Zc(21,"*"),i.Wb(),i.Wb(),i.Xb(22,"div",11),i.jc("onClose",(function(e){return t.assigneeDropdownClosed(e)})),i.Xb(23,"div",12),i.Xb(24,"span",13),i.Zc(25),i.oc(26,"translate"),i.oc(27,"translate"),i.Wb(),i.Xc(28,y,2,1,"span",14),i.Wb(),i.Xc(29,_,2,13,"dropdown-checkbox",15),i.Wb(),i.Wb(),i.Wb(),i.Xb(30,"div",16),i.Xb(31,"label"),i.Zc(32),i.oc(33,"translate"),i.Wb(),i.Xb(34,"datepicker-range",17),i.jc("dateRangeOut",(function(e){return t.onDateChanged(e)})),i.Wb(),i.Wb(),i.Xb(35,"div",9),i.Xb(36,"div",18),i.Sb(37,"input",19),i.Xb(38,"label",20),i.Zc(39),i.oc(40,"translate"),i.Wb(),i.Wb(),i.Wb(),i.Wb(),i.Xb(41,"div",21),i.Xb(42,"a",22),i.jc("click",(function(){return t.close()})),i.Zc(43),i.oc(44,"translate"),i.Wb(),i.Xb(45,"button",23),i.jc("click",(function(){return t.onSubmit()})),i.Zc(46),i.oc(47,"translate"),i.oc(48,"translate"),i.Wb(),i.Wb()),2&e&&(i.Cb(1),i.wc("ngIf","create"===t.type),i.Cb(1),i.wc("ngIf","edit"===t.type),i.Cb(4),i.wc("formGroup",t.form),i.Cb(3),i.bd("",i.pc(10,19,"PTO.CREATE_EDIT_HOLIDAY.HOLIDAY_NAME")," "),i.Cb(4),i.wc("placeholder",i.pc(14,21,"GLOBAL.NAME_LABEL")),i.Cb(5),i.ad(i.pc(19,23,"PROJECTS.SHARED.ASSIGNEES_LABEL")),i.Cb(7),i.bd(" ",t.userSize?i.pc(26,25,"TEAMS.MEMBERS.STATUS_LABELS.ACTIVE_LABEL"):i.pc(27,27,"PROJECTS.DROPDOWN.SELECT_MEMBERS")," "),i.Cb(3),i.wc("ngIf",t.userSize>0),i.Cb(4),i.ad(i.pc(33,29,"GLOBAL.PERIOD_LABEL")),i.Cb(2),i.wc("cssClass","range-picker-visible")("getOfUtc",!0)("noInitialDateRange","create"===t.type)("removeArrows",!0)("timeEntriesDateRange",t.dateRange)("disableRanges",!0),i.Cb(5),i.ad(i.pc(40,31,"PTO.OCCURS_ANNUALLY_CHECKBOX")),i.Cb(4),i.ad(i.pc(44,33,"GLOBAL.CANCEL_BTN")),i.Cb(2),i.wc("disabled",t.form.invalid||t.form.pristine&&"edit"===t.type),i.Cb(1),i.bd(" ","create"===t.type?i.pc(47,35,"GLOBAL.CREATE_LABEL"):i.pc(48,37,"GLOBAL.SAVE_LABEL")," "))},directives:[C.u,h.t,h.k,h.c,h.s,h.i,A.a,O.a,v.a,T.a,h.a,I.a],pipes:[w.e],encapsulation:2}),e})()},PsR6:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("lNpb"),s=n("fXoL");let c=(()=>{class e{constructor(e){this.el=e,this.specialKeys=["Backspace","Tab","End","Home","ArrowLeft","ArrowRight","Del","Delete"]}onKeyDown(e){let t;if(this.timeUnit===i.a.DAYS?t=new RegExp(/^\d{1,3}(\.\d{0,2})?$/g):this.timeUnit===i.a.HOURS&&(t=new RegExp(/^\d{1,4}(\.\d{0,2})?$/g)),-1!==this.specialKeys.indexOf(e.key))return;const n="Caret"===document.getSelection().type?this.el.nativeElement.value:"",s=this.el.nativeElement.selectionStart,c=[n.slice(0,s),"Decimal"==e.key?".":e.key,n.slice(s)].join("");c&&!String(c).match(t)&&e.preventDefault()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.l))},e.\u0275dir=s.Mb({type:e,selectors:[["","limitBalanceDigit",""]],hostBindings:function(e,t){1&e&&s.jc("keydown",(function(e){return t.onKeyDown(e)}))},inputs:{timeUnit:"timeUnit"}}),e})()},QTBk:function(e,t,n){"use strict";n.d(t,"a",(function(){return $})),n.d(t,"b",(function(){return K}));var i=n("fXoL"),s=n("3Pt+"),c=n("K785"),a=n("8+Zx"),o=n("cGux"),r=n("y+xF"),l=n("JBiw"),b=n("1Tmk"),d=n("hkzH"),u=new Map([["days","DAYS"],["hours","HOURS"]]),p=n("+yX9"),h=n("pCw1"),m=n("lNpb"),g=n("OmiP"),E=n("Ymxs"),f=n("twZS"),S=n("unEv"),C=n("9WzS"),A=function(e){return e.YEAR="YEAR",e.MONTH="MONTH",e}({}),O=n("ePBx"),v=n("SvJf"),T=n("Y9WU"),I=n("sYmb"),w=n("2rWG"),L=n("sbmM"),R=n("ofXK"),y=n("qUN8"),_=n("1kSV"),k=n("D0uv"),W=n("PsR6");function X(e,t){if(1&e&&(i.Xb(0,"span",51),i.Zc(1),i.Wb()),2&e){const e=i.nc();i.Cb(1),i.ad(e.userSize)}}function N(e,t){if(1&e){const e=i.Yb();i.Xb(0,"dropdown-checkbox",52),i.jc("loadMore",(function(){return i.Oc(e),i.nc().getMoreUsers()}))("onChange",(function(t){return i.Oc(e),i.nc().onAssigneeFilterChanged(t)}))("onFilterOptionChange",(function(t){return i.Oc(e),i.nc().onAssigneeFilterOptionChanged(t)}))("onSearchChange",(function(t){return i.Oc(e),i.nc().onAssigneeFilterSearchChanged(t)})),i.oc(1,"translate"),i.Wb()}if(2&e){const e=i.nc();i.wc("placeholder",i.pc(1,11,"TEAMS.MEMBERS.INFO.GROUP.PLACEHOLDER"))("preventOfflineFiltering",!0)("isResizeable",!1)("showSelectAll",!0)("filterOptions",e.userFilterOptions)("checkboxValues",e.initialValueUsersAndGroups)("selectableMaps",e.filterMaps)("searchValue",e.userQuery.name)("countMap",e.userCount)("isIncludingNew",e.form.get("everyoneIncludingNew").value)("showIncludeNew",e.showIncludeNew)}}function D(e,t){1&e&&(i.Xb(0,"div"),i.Xb(1,"div",53),i.Xb(2,"div",54),i.Zc(3),i.oc(4,"translate"),i.Wb(),i.Xb(5,"div"),i.Zc(6),i.oc(7,"translate"),i.Wb(),i.Wb(),i.Wb()),2&e&&(i.Cb(3),i.ad(i.pc(4,2,"PTO.REQUIRES_APPROVAL_CHECKBOX")),i.Cb(3),i.ad(i.pc(7,4,"PTO.REQUIRES_APPROVAL_CHECKBOX_INFO")))}function P(e,t){if(1&e&&(i.Xb(0,"span",51),i.Zc(1),i.Wb()),2&e){const e=i.nc(3);i.Cb(1),i.ad(e.specUserSize)}}function M(e,t){if(1&e){const e=i.Yb();i.Xb(0,"dropdown-checkbox",67),i.jc("loadMore",(function(){return i.Oc(e),i.nc(3).getMoreUsersSpecific()}))("onChange",(function(t){return i.Oc(e),i.nc(3).onFilterChangeSpecific(t)}))("onSearchChange",(function(t){return i.Oc(e),i.nc(3).onFilterSearchChangeSpecific(t)})),i.oc(1,"translate"),i.Wb()}if(2&e){const e=i.nc(3);i.wc("placeholder",i.pc(1,11,"PTO.USERS.FIND"))("preventOfflineFiltering",!0)("showSelectAll",!1)("filterOptions",e.userFilterOptionsSpecific)("isIncludingNew",!1)("searchValue",e.userQuerySpecific.email)("showIncludeNew",!1)("checkboxValues",e.initialValueSpecificUsers)("selectableMaps",e.filterMapsSpecific)("countMap",e.userCountSpecific)("isResizeable",!1)}}function B(e,t){if(1&e&&(i.Xb(0,"div",65),i.Xb(1,"div",11),i.Xb(2,"span",12),i.Zc(3),i.oc(4,"translate"),i.oc(5,"translate"),i.Wb(),i.Xc(6,P,2,1,"span",13),i.Wb(),i.Xc(7,M,2,13,"dropdown-checkbox",66),i.Wb()),2&e){const e=i.nc(2);i.Cb(3),i.bd(" ",e.specUserSize?i.pc(4,2,"GLOBAL.MEMBERS_LABEL"):i.pc(5,4,"PTO.CREATE_POLICY.SPECIFIC_MEMBER_SELECT")," "),i.Cb(3),i.wc("ngIf",e.specUserSize>0)}}function U(e,t){if(1&e){const e=i.Yb();i.Xb(0,"div",55),i.Xb(1,"div",56),i.Zc(2),i.oc(3,"translate"),i.Wb(),i.Xb(4,"div",57),i.Sb(5,"input",58),i.Xb(6,"label",59),i.Zc(7),i.oc(8,"translate"),i.Wb(),i.Wb(),i.Xb(9,"div",57),i.Sb(10,"input",60),i.Xb(11,"label",61),i.Zc(12),i.oc(13,"translate"),i.Wb(),i.Wb(),i.Xb(14,"div",57),i.Xb(15,"input",62),i.jc("change",(function(t){return i.Oc(e),i.nc().selectSpecificMembers(t)})),i.Wb(),i.Xb(16,"label",63),i.Zc(17),i.oc(18,"translate"),i.Wb(),i.Wb(),i.Xc(19,B,8,6,"div",64),i.Wb()}if(2&e){const e=i.nc();i.Cb(2),i.bd(" ",i.pc(3,5,"PTO.CREATE_POLICY.WHO_CAN_APPROVE"),""),i.Cb(5),i.ad(i.pc(8,7,"GLOBAL.ADMINS_LABEL")),i.Cb(5),i.bd(" ",i.pc(13,9,"TEAMS.MEMBERS.INFO.ROLE_TYPE.TM.PLURAL")," "),i.Cb(5),i.bd(" ",i.pc(18,11,"PTO.SPECIFIC_MEMBERS")," "),i.Cb(2),i.wc("ngIf",e.specificMembersInput.value)}}const G=function(){return{left:"auto"}};function x(e,t){if(1&e){const e=i.Yb();i.Xb(0,"div",68),i.Xb(1,"div",69),i.Xb(2,"input",70,71),i.jc("change",(function(t){return i.Oc(e),i.nc().onAccrualAmountChange(t.target.value)}))("keyup.enter",(function(){return i.Oc(e),i.Lc(3).blur()})),i.Wb(),i.Wb(),i.Wb()}if(2&e){const e=i.nc();i.wc("ngStyle",i.Ac(2,G)),i.Cb(2),i.wc("timeUnit",e.timeUnitInput.value)}}function F(e,t){if(1&e){const e=i.Yb();i.Xb(0,"div",68),i.Xb(1,"a",72),i.jc("click",(function(){i.Oc(e);const t=i.nc();return t.setAccrualPeriod(t.AutomaticAccrualPeriod.MONTH)})),i.Zc(2),i.oc(3,"lowercase"),i.oc(4,"translate"),i.Wb(),i.Xb(5,"a",72),i.jc("click",(function(){i.Oc(e);const t=i.nc();return t.setAccrualPeriod(t.AutomaticAccrualPeriod.YEAR)})),i.Zc(6),i.oc(7,"translate"),i.Wb(),i.Sb(8,"span",73),i.Wb()}2&e&&(i.wc("ngStyle",i.Ac(9,G)),i.Cb(2),i.ad(i.pc(3,3,i.pc(4,5,"GLOBAL.MONTH_LABEL"))),i.Cb(4),i.ad(i.pc(7,7,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.PAY_PER_YEAR_PART")))}function j(e,t){1&e&&(i.Xb(0,"div"),i.Xb(1,"div",53),i.Xb(2,"div",54),i.Zc(3),i.oc(4,"translate"),i.Wb(),i.Xb(5,"div"),i.Zc(6),i.oc(7,"translate"),i.Wb(),i.Wb(),i.Wb()),2&e&&(i.Cb(3),i.ad(i.pc(4,2,"PTO.CREATE_POLICY.AUTOMATIC_ACCRUAL")),i.Cb(3),i.ad(i.pc(7,4,"PTO.CREATE_POLICY.AUTOMATIC_ACCRUAL_INFO")))}function Z(e,t){1&e&&(i.Xb(0,"div"),i.Xb(1,"div",53),i.Xb(2,"div",54),i.Zc(3),i.oc(4,"translate"),i.Wb(),i.Xb(5,"div"),i.Zc(6),i.oc(7,"translate"),i.Wb(),i.Wb(),i.Wb()),2&e&&(i.Cb(3),i.ad(i.pc(4,2,"PTO.CREATE_POLICY.ALLOW_NEGATIVE_BALANCE")),i.Cb(3),i.ad(i.pc(7,4,"PTO.CREATE_POLICY.ALLOW_NEGATIVE_BALANCE_INFO")))}function V(e,t){1&e&&(i.Xb(0,"div",32),i.Sb(1,"input",74),i.Xb(2,"label",75),i.Zc(3),i.oc(4,"translate"),i.Wb(),i.Wb()),2&e&&(i.Cb(3),i.ad(i.pc(4,1,"PTO.CREATE_POLICY.ALLOW_HALF_DAY")))}const Y=function(e,t,n){return{"disable-area":e,"cl-hover-no-underline":t,"cl-cursor-default":n}},H=[];let $=(()=>{class e{constructor(e,t,n,s,c,r){this.ptoService=e,this.workspaceService=t,this.userGroupService=n,this.toaster=s,this.analyticsService=c,this.translateService=r,this.users=[],this.userCount=new o.a,this.userCountSpecific=new o.a,this.usersPage=1,this.userFilterOptions=K,this.userFilterOptionsSpecific=H,this.userQuery={page:1,limit:50,name:"",email:"",statuses:[C.a.ACTIVE,C.a.INVITED]},this.userGroupsQuery={page:1,limit:50,name:""},this.userQuerySpecific={page:1,limit:50,name:"",email:"",statuses:[C.a.ACTIVE,C.a.INVITED]},this.initialValueUsersAndGroups=new a.a({options:{status:C.a.ACTIVE}}),this.initialValueSpecificUsers=new a.a({options:{status:C.a.ACTIVE}}),this.reachedLimit={},this.reachedLimitSpecific={},this.policyTimeUnits=u,this.allSelected=!1,this.userSize=0,this.specUserSize=0,this.emitClose=new i.n,this.create=new i.n,this.edit=new i.n,this.showIncludeNew=!0,this.AutomaticAccrualPeriod=A}set policy(e){var t,n,i,s;this._policy=e?new h.a(e):null,this.userSize=e?(null===(t=null==e?void 0:e.userIds)||void 0===t?void 0:t.length)+(null===(n=null==e?void 0:e.userGroupIds)||void 0===n?void 0:n.length):0,this.specUserSize=e&&(null===(i=e.approve)||void 0===i?void 0:i.requiresApproval)&&(null===(s=e.approve)||void 0===s?void 0:s.specificMembers)?e.approve.userIds.length:0}get timeUnitInput(){return this.form.get("timeUnit")}get requiresApprovalInput(){return this.form.get("approve.requiresApproval")}get specificMembersInput(){return this.form.get("approve.specificMembers")}get specificUsersInput(){return this.form.get("approve.userIds")}get allowNegativeBalanceInput(){return this.form.get("allowNegativeBalance")}get allowHalfDayInput(){return this.form.get("allowHalfDay")}get automaticAccrualInput(){return this.form.get("automaticAccrual")}get accrualActiveInput(){return this.form.get("automaticAccrual.active")}get accrualAmountInput(){return this.form.get("automaticAccrual.amount")}get accrualPeriodInput(){return this.form.get("automaticAccrual.period")}ngOnInit(){this.initializeForm(),this._policy?(this.mode=S.a.EDIT,this.initializeFormData(this._policy),this.initializeDropdownData(this._policy)):this.mode=S.a.CREATE,this.workspaceId=this.workspaceService.getDefaultWorkspaceId(),this.filterMaps=new l.a([new r.a("userGroups",null,{label:"GLOBAL.GROUPS_LABEL"}),new r.a("users",null,{label:"GLOBAL.USERS_LABEL"})]),this.filterMapsSpecific=new l.a([new r.a("users",null,{label:"GLOBAL.USERS_LABEL"})]),this.getUsersAndGroups(),this.getUsersSpecific()}initializeForm(){this.form=new s.j({name:new s.g("",[s.G.required]),users:new s.j({contains:new s.g(""),ids:new s.g([]),status:new s.g("")},[s.G.required]),userGroups:new s.j({contains:new s.g(""),ids:new s.g([]),status:new s.g("")},[s.G.required]),timeUnit:new s.g(m.a.DAYS,[s.G.required]),approve:new s.j({requiresApproval:new s.g(!1),teamManagers:new s.g(!1),specificMembers:new s.g(!1),userIds:new s.g([])}),allowNegativeBalance:new s.g(!1),allowHalfDay:new s.g(!1),everyoneIncludingNew:new s.g(!1),automaticAccrual:new s.j({active:new s.g(!1,[s.G.required]),amount:new s.g({value:"0",disabled:!0},[s.G.minLength(1),s.G.min(.01)]),period:new s.g({value:A.YEAR,disabled:!0})})},[f.a]),this.form.get("approve.userIds").disable()}initializeFormData(e){this.form.get("name").setValue(e.name),this.form.get("users.contains").setValue(d.d.CONTAINS),this.form.get("users.ids").setValue(e.userIds),this.form.get("users.status").setValue(C.a.ALL),this.form.get("userGroups.contains").setValue(d.d.CONTAINS),this.form.get("userGroups.ids").setValue(e.userGroupIds),this.form.get("userGroups.status").setValue(C.a.ALL),this.timeUnitInput.setValue(e.timeUnit),this.requiresApprovalInput.setValue(e.approve.requiresApproval),this.form.get("approve.teamManagers").setValue(e.approve.teamManagers),e.approve.specificMembers&&(this.form.get("approve.userIds").enable(),this.form.get("approve.specificMembers").setValue(e.approve.specificMembers),this.form.get("approve.userIds").setValue(e.approve.userIds),this.form.get("approve.userIds").setValidators([s.G.required]),this.form.get("approve.userIds").updateValueAndValidity()),this.form.get("everyoneIncludingNew").setValue(e.everyoneIncludingNew),this.allowNegativeBalanceInput.setValue(e.allowNegativeBalance),this.allowHalfDayInput.setValue(e.allowHalfDay),e.automaticAccrual.period&&e.automaticAccrual.timeUnit&&(this.form.get("automaticAccrual.active").setValue(!0),this.accrualActiveStatusChanged(!0),this.accrualAmountInput.setValue(e.automaticAccrual.amount),this.accrualPeriodInput.setValue(e.automaticAccrual.period))}initializeDropdownData(e){this.mode===S.a.EDIT&&(this.initialValueUsersAndGroups=new a.a({options:{status:C.a.ALL}}),this.userQuery.statuses.push(C.a.INACTIVE)),e.userIds&&e.userIds.length>0&&this.initialValueUsersAndGroups.pushIds("users",[...e.userIds]),e.userGroupIds&&e.userGroupIds.length>0&&this.initialValueUsersAndGroups.pushIds("userGroups",[...e.userGroupIds]),e.approve.userIds&&e.approve.userIds.length>0&&this.initialValueSpecificUsers.pushIds("users",[...e.approve.userIds])}onSubmit(){this.form.valid&&(this.mode===S.a.CREATE?this.ptoService.createTimeOffPolicy(this.form.value):this.ptoService.editTimeOffPolicy(this._policy.id,this.form.value,this._policy.archived)).subscribe(e=>{if(this.mode===S.a.CREATE){const t=new h.a(e);this.create.emit(t),this.analyticsService.addEvent(new v.a({event:"change",value:t.name,section:"Time Off",section2:"Manage Policies",section3:"Create policy"})),this.analyticsService.addEvent(new v.a({event:"switch",value:t.allowNegativeBalance?"On":"Off",section:"Time Off",section2:"Manage Policies",section3:"Create policy",section4:"Allow negative balance"})),this.analyticsService.addEvent(new v.a({event:"switch",value:t.allowNegativeBalance?"On":"Off",section:"Time Off",section2:"Manage Policies",section3:"Create policy",section4:"Allow negative balance"})),this.analyticsService.addEvent(new v.a({event:"switch",value:t.allowHalfDay?"On":"Off",section:"Time Off",section2:"Manage Policies",section3:"Create policy",section4:"Allow half day"})),this.analyticsService.addEvent(new v.a({event:"switch",value:this.requiresApprovalInput.value?"On":"Off",section:"Time Off",section2:"Manage Policies",section3:"Create policy",section4:"Requires approval"})),this.analyticsService.addEvent(new v.a({event:"select",value:t.timeUnit,section:"Time Off",section2:"Manage Policies",section3:"Create policy",section4:"Time unit"})),this.accrualAmountInput.enabled&&this.analyticsService.addEvent(new v.a({event:"switch",value:t.automaticAccrual.amount+" days per "+t.automaticAccrual.period,section:"Time Off",section2:"Manage Policies",section3:"Create policy",section4:"Automatically accrues"}))}this.mode===S.a.EDIT&&(this.toaster.success(this.translateService.instant("PTO.POLICY.UPDATE_POLICY_SUCCESS")),this.edit.emit(new h.a(e)))})}closeModal(){this.emitClose.emit()}onAssigneeFilterChanged(e){this.userSize=e.numberOfSelected,this.updateSelectedUsers(this.form.get("users"),e),this.updateSelectedUserGroups(this.form.get("userGroups"),e),this.form.get("everyoneIncludingNew").setValue(e.includingNew)}updateSelectedUsers(e,t){e.get("status").setValue(t.checkboxValues.options.status),e.get("contains").setValue(t.checkboxValues.exclude?d.d.DOES_NOT_CONTAIN:d.d.CONTAINS),e.get("ids").setValue(t.checkboxValues.map.users||[]),e.markAllAsTouched(),e.markAsDirty()}updateSelectedUserGroups(e,t){e.get("status").setValue(t.checkboxValues.options.status),e.get("contains").setValue(t.checkboxValues.exclude&&t.checkboxValues.options.status!=C.a.INACTIVE?d.d.DOES_NOT_CONTAIN:d.d.CONTAINS),e.get("ids").setValue(t.checkboxValues.map.userGroups||[]),e.markAllAsTouched(),e.markAsDirty()}onFilterChangeSpecific(e){this.specUserSize=e.numberOfSelected,this.specificUsersInput.setValue(e.checkboxValues.map.users&&e.checkboxValues.map.users.length>0?e.checkboxValues.map.users:[]),this.specificUsersInput.markAsDirty()}onAssigneeFilterOptionChanged(e){this.resetQuery(),e.value===C.a.ALL?(this.userQuery.statuses=[C.a.ACTIVE,C.a.INACTIVE,C.a.INVITED],this.showIncludeNew=!0):e.value===C.a.ACTIVE?(this.userQuery.statuses=[C.a.ACTIVE,C.a.INVITED],this.showIncludeNew=!0):(this.userQuery.statuses=[e.value],this.showIncludeNew=!1),this.getUsersAndGroups(),this.form.get("everyoneIncludingNew").setValue(!1)}onAssigneeFilterSearchChanged(e){this.resetQuery(),this.userQuery.email=e,this.userQuery.name=e,this.userGroupsQuery.name=e,this.getUsersAndGroups()}onFilterSearchChangeSpecific(e){this.resetQuerySpecific(),this.userQuerySpecific.email=e,this.userQuerySpecific.name=e,this.getUsersSpecific()}resetQuery(){this.userQuery.name="",this.userQuery.email="",this.userGroupsQuery.name="",this.userQuery.page=1,this.userGroupsQuery.page=1,this.reachedLimit.userGroups=!1,this.reachedLimit.users=!1}resetQuerySpecific(){this.reachedLimitSpecific.users=!1,this.userQuerySpecific.page=1,this.userQuerySpecific.name="",this.userQuerySpecific.email=""}selectSpecificMembers(e){e.target.checked?(this.form.get("approve.userIds").enable(),this.form.get("approve.userIds").setValidators([s.G.required]),this.form.get("approve.userIds").updateValueAndValidity()):this.form.get("approve.userIds").disable()}getUsersAndGroups(){this.getUserGroups(),this.getUsers()}getMoreUsers(){this.userGroupsQuery.page++,this.userQuery.page++,this.getUsersAndGroups()}getMoreUsersSpecific(){this.userQuerySpecific.page++,this.getUsersSpecific()}getUsers(){this.reachedLimit.users||this.workspaceService.getReportsFilterTeamMembers(this.userQuery).subscribe(({count:e,users:t})=>{!!this.userQuery.name||this.userCount.set("users",e),1===this.userQuery.page&&this.filterMaps.resetMap("users"),this.filterMaps.pushToMap("users",t,{label:"GLOBAL.USERS_LABEL"});const n=this.filterMaps.countSelectablesOf("users");this.reachedLimit.users=n>=e||t.length<this.userQuery.limit})}getUserGroups(){var e;1===(null===(e=this.userQuery.statuses)||void 0===e?void 0:e.length)&&this.userQuery.statuses.includes(C.a.INACTIVE)?this.filterMaps.removeMap("userGroups"):this.reachedLimit.userGroups||this.userGroupService.getUserGroups(this.userGroupsQuery).subscribe(({groups:e,count:t})=>{if(0===t)return void this.filterMaps.removeMap("userGroups");const n=e.length,i=e.filter(e=>"Admins"!==e.name);e=i,!!this.userGroupsQuery.name||this.userCount.set("userGroups",t),1===this.userGroupsQuery.page&&this.filterMaps.resetMap("userGroups"),this.filterMaps.unshiftToMap("userGroups",e,{label:"GLOBAL.GROUPS_LABEL"});const s=this.filterMaps.countSelectablesOf("userGroups");this.reachedLimit.userGroups=s>=t||n<this.userGroupsQuery.limit})}getUsersSpecific(){this.reachedLimitSpecific.users||this.workspaceService.getReportsFilterTeamMembers(this.userQuerySpecific).subscribe(({count:e,users:t})=>{!!this.userQuerySpecific.name||this.userCountSpecific.set("users",e),1===this.userQuerySpecific.page&&this.filterMapsSpecific.resetMap("users"),this.filterMapsSpecific.pushToMap("users",t,{label:"GLOBAL.USERS_LABEL"});const n=this.filterMapsSpecific.countSelectablesOf("users");this.reachedLimitSpecific.users=n>=e||t.length<this.userQuerySpecific.limit})}setAllSelected(e){this.allSelected=e}openPopup(e){e.open()}closePopup(e){e.close()}accrualActiveStatusChanged(e){e?(this.accrualAmountInput.enable(),this.accrualAmountInput.setValidators([s.G.required,s.G.minLength(1),s.G.min(.01)]),this.accrualAmountInput.updateValueAndValidity(),this.accrualPeriodInput.enable(),this.accrualPeriodInput.setValidators([s.G.required]),this.accrualActiveInput.updateValueAndValidity()):(this.accrualAmountInput.clearValidators(),this.accrualActiveInput.updateValueAndValidity(),this.accrualPeriodInput.clearValidators(),this.accrualActiveInput.updateValueAndValidity(),this.accrualAmountInput.disable(),this.accrualPeriodInput.disable()),this.form.updateValueAndValidity()}setAccrualAmount(e){this.form.get("automaticAccrual.amount").setValue(e)}setAccrualPeriod(e){this.accrualPeriodInput.setValue(e),this.accrualPeriodInput.markAsDirty(),this.form.updateValueAndValidity()}onAccrualAmountChange(e){const[t,n]=e.split(".");let i=t.replace(/^0+/,"");i||(i="0"),n&&(i+=".",i+=n),this.accrualAmountInput.setValue(Number.parseFloat(i))}translateAccrualPeriodInput(e){return this.translateService.instant(e===A.YEAR?"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.PAY_PER_YEAR_PART":"GLOBAL.MONTH_LABEL")}}return e.\u0275fac=function(t){return new(t||e)(i.Rb(p.b),i.Rb(b.a),i.Rb(O.a),i.Rb(E.a),i.Rb(T.a),i.Rb(I.f))},e.\u0275cmp=i.Lb({type:e,selectors:[["app-pto-create-policy"]],inputs:{policy:"policy"},outputs:{emitClose:"emitClose",create:"create",edit:"edit"},decls:104,vars:88,consts:[[3,"formGroup","ngSubmit"],[1,"cl-modal-header"],[1,"cl-h1","cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group"],[1,"cl-color-red","cl-ml-1"],["formControlName","name","type","text","ngbAutofocus","",1,"cl-form-control",3,"placeholder"],[1,"cl-d-block"],["dropdownKey","",1,"cl-dropdown","cl-dropdown-large","cl-d-inline-block"],["dropdownKeyButton","","tabindex","0","placement","bottom",1,"cl-dropdown-item-label","cl-btn","cl-btn-outline-light","cl-text-left","cl-dropdown-toggle","pointer"],[1,"cl-dropdown-prefix","cl-d-inline"],["class","cl-badge cl-badge-filter",4,"ngIf"],[3,"placeholder","preventOfflineFiltering","isResizeable","showSelectAll","filterOptions","checkboxValues","selectableMaps","searchValue","countMap","isIncludingNew","showIncludeNew","loadMore","onChange","onFilterOptionChange","onSearchChange",4,"dropdownKeyContent"],[1,"cl-form-group","cl-border-top","cl-border-bottom","cl-py-2","cl-z-index-0"],[1,"cl-mr-3","cl-mb-0"],[1,"cl-custom-control","cl-custom-radio","cl-custom-control-inline"],["formControlName","timeUnit","type","radio","id","days","name","timeUnit",1,"cl-custom-control-input",3,"value"],["for","days",1,"cl-custom-control-label"],["formControlName","timeUnit","type","radio","id","hours","name","timeUnit",1,"cl-custom-control-input",3,"value"],["for","hours",1,"cl-custom-control-label"],["formGroupName","approve"],[1,"cl-custom-control","cl-custom-checkbox","cl-mb-2"],["formControlName","requiresApproval","type","checkbox","id","requiresApproval",1,"cl-custom-control-input",3,"change"],["for","requiresApproval",1,"cl-custom-control-label"],["popContent",""],["triggers","manual","popoverClass","popover-dark","placement","top","container","body",1,"cl-ml-1","cl-d-inline-flex",3,"ngbPopover","mouseover","mouseleave"],["popup","ngbPopover"],["src","assets/ui-icons/info-9.svg"],["class","cl-form-group cl-border-bottom cl-pb-3 cl-pt-2",4,"ngIf"],["formGroupName","automaticAccrual",1,"cl-relative","cl-d-flex","cl-flex-row","cl-align-items-start","cl-justify-content-start","cl-mb-2"],[1,"cl-custom-control","cl-custom-checkbox"],["formControlName","active","type","checkbox","id","automaticAccrualActive",1,"cl-custom-control-input","cl-checkbox-custom-state",3,"change"],["for","automaticAccrualActive",1,"cl-custom-control-label"],["dropdownKey","",1,"cl-d-inline-block",3,"dropdownKey"],["dropdownKeyButton","","tabindex","0","ngDefaultControl","",1,"cl-btn-link","cl-mx-1",3,"ngClass"],["class","cl-dropdown-menu",3,"ngStyle",4,"dropdownKeyContent"],[1,"cl-d-inline-block",3,"dropdownKey"],["dropdownKeyButton","","tabindex","0",1,"cl-btn-link","cl-mx-1",3,"ngClass"],["popContentAutomaticAccrual",""],["triggers","manual","popoverClass","popover-dark","placement","top","container","body",1,"cl-ml-1","cl-align-self-center",3,"ngbPopover","mouseover","mouseleave"],["popAutomaticAccrual","ngbPopover"],["formControlName","allowNegativeBalance","type","checkbox","id","allowNegativeBalance",1,"cl-custom-control-input","cl-checkbox-custom-state"],["for","allowNegativeBalance",1,"cl-custom-control-label"],["popContentNegativeBalance",""],["popupBalance","ngbPopover"],["class","cl-custom-control cl-custom-checkbox",4,"ngIf"],[1,"cl-modal-footer"],["type","button",1,"cl-btn","cl-text-primary","cl-text-capitalize","cl-mr-0",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary","cl-ml-1",3,"disabled"],[1,"cl-badge","cl-badge-filter"],[3,"placeholder","preventOfflineFiltering","isResizeable","showSelectAll","filterOptions","checkboxValues","selectableMaps","searchValue","countMap","isIncludingNew","showIncludeNew","loadMore","onChange","onFilterOptionChange","onSearchChange"],[1,"cl-text-white"],[1,"cl-font-weight-bolder"],[1,"cl-form-group","cl-border-bottom","cl-pb-3","cl-pt-2"],[1,"cl-mb-1"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline"],["type","checkbox","disabled","true","checked","true","id","requiresAdminApproval",1,"cl-custom-control-input","cl-checkbox-custom-state"],["for","requiresAdminApproval",1,"cl-custom-control-label"],["formControlName","teamManagers","type","checkbox","id","teamManagers",1,"cl-custom-control-input","cl-checkbox-custom-state"],["for","teamManagers",1,"cl-custom-control-label"],["formControlName","specificMembers","type","checkbox","id","specificMembers",1,"cl-custom-control-input","cl-checkbox-custom-state",3,"change"],["for","specificMembers",1,"cl-custom-control-label","cl-d-block"],["dropdownKey","","class","cl-w-100 cl-dropdown cl-mt-3 cl-dropdown-large cl-d-inline-block",4,"ngIf"],["dropdownKey","",1,"cl-w-100","cl-dropdown","cl-mt-3","cl-dropdown-large","cl-d-inline-block"],[3,"placeholder","preventOfflineFiltering","showSelectAll","filterOptions","isIncludingNew","searchValue","showIncludeNew","checkboxValues","selectableMaps","countMap","isResizeable","loadMore","onChange","onSearchChange",4,"dropdownKeyContent"],[3,"placeholder","preventOfflineFiltering","showSelectAll","filterOptions","isIncludingNew","searchValue","showIncludeNew","checkboxValues","selectableMaps","countMap","isResizeable","loadMore","onChange","onSearchChange"],[1,"cl-dropdown-menu",3,"ngStyle"],[1,"cl-p-3","cl-mx-n1"],["limitBalanceDigit","","formControlName","amount","type","text","name","amount","autocomplete","off",1,"cl-form-control",3,"timeUnit","change","keyup.enter"],["amountInput",""],["clickCloseDropdown","",1,"cl-dropdown-item",3,"click"],["dropdownClose","","tabindex","0"],["formControlName","allowHalfDay","type","checkbox","id","allowHalfDay",1,"cl-custom-control-input","cl-checkbox-custom-state"],["for","allowHalfDay",1,"cl-custom-control-label"]],template:function(e,t){if(1&e){const e=i.Yb();i.Xb(0,"form",0),i.jc("ngSubmit",(function(){return t.onSubmit()})),i.Xb(1,"div",1),i.Xb(2,"h3",2),i.Zc(3),i.oc(4,"translate"),i.oc(5,"translate"),i.Wb(),i.Xb(6,"button",3),i.jc("click",(function(){return t.closeModal()})),i.Xb(7,"span"),i.Sb(8,"img",4),i.Wb(),i.Wb(),i.Wb(),i.Xb(9,"div",5),i.Xb(10,"div",6),i.Xb(11,"label"),i.Zc(12),i.oc(13,"translate"),i.Xb(14,"span",7),i.Zc(15,"*"),i.Wb(),i.Wb(),i.Sb(16,"input",8),i.oc(17,"translate"),i.Wb(),i.Xb(18,"div",6),i.Xb(19,"label",9),i.Zc(20),i.oc(21,"translate"),i.Xb(22,"span",7),i.Zc(23,"*"),i.Wb(),i.Wb(),i.Xb(24,"div",10),i.Xb(25,"div",11),i.Xb(26,"span",12),i.Zc(27),i.oc(28,"translate"),i.oc(29,"translate"),i.Wb(),i.Xc(30,X,2,1,"span",13),i.Wb(),i.Xc(31,N,2,13,"dropdown-checkbox",14),i.Wb(),i.Wb(),i.Xb(32,"div",15),i.Xb(33,"label",16),i.Zc(34),i.oc(35,"translate"),i.Wb(),i.Xb(36,"div",17),i.Sb(37,"input",18),i.Xb(38,"label",19),i.Zc(39),i.oc(40,"translate"),i.Wb(),i.Wb(),i.Xb(41,"div",17),i.Sb(42,"input",20),i.Xb(43,"label",21),i.Zc(44),i.oc(45,"translate"),i.Wb(),i.Wb(),i.Wb(),i.Xb(46,"div",22),i.Xb(47,"div"),i.Xb(48,"div",23),i.Xb(49,"input",24),i.jc("change",(function(e){return e})),i.Wb(),i.Xb(50,"label",25),i.Zc(51),i.oc(52,"translate"),i.Wb(),i.Xc(53,D,8,6,"ng-template",null,26,i.Yc),i.Xb(55,"a",27,28),i.jc("mouseover",(function(){i.Oc(e);const n=i.Lc(56);return t.openPopup(n)}))("mouseleave",(function(){i.Oc(e);const n=i.Lc(56);return t.closePopup(n)})),i.Sb(57,"img",29),i.Wb(),i.Wb(),i.Wb(),i.Xc(58,U,20,13,"div",30),i.Wb(),i.Xb(59,"div",31),i.Xb(60,"div",32),i.Xb(61,"input",33),i.jc("change",(function(e){return t.accrualActiveStatusChanged(e.target.checked)})),i.Wb(),i.Xb(62,"label",34),i.Zc(63),i.oc(64,"translate"),i.Wb(),i.Wb(),i.Xb(65,"div",35),i.Xb(66,"a",36),i.Zc(67),i.Wb(),i.Xc(68,x,4,3,"div",37),i.Wb(),i.Xb(69,"div"),i.Zc(70),i.oc(71,"lowercase"),i.oc(72,"translate"),i.oc(73,"translate"),i.oc(74,"translate"),i.Wb(),i.Xb(75,"div",38),i.Xb(76,"a",39),i.Zc(77),i.oc(78,"lowercase"),i.Wb(),i.Xc(79,F,9,10,"div",37),i.Wb(),i.Xc(80,j,8,6,"ng-template",null,40,i.Yc),i.Xb(82,"a",41,42),i.jc("mouseover",(function(){i.Oc(e);const n=i.Lc(83);return t.openPopup(n)}))("mouseleave",(function(){i.Oc(e);const n=i.Lc(83);return t.closePopup(n)})),i.Sb(84,"img",29),i.Wb(),i.Wb(),i.Xb(85,"div",23),i.Sb(86,"input",43),i.Xb(87,"label",44),i.Zc(88),i.oc(89,"translate"),i.Wb(),i.Xc(90,Z,8,6,"ng-template",null,45,i.Yc),i.Xb(92,"a",27,46),i.jc("mouseover",(function(){i.Oc(e);const n=i.Lc(93);return t.openPopup(n)}))("mouseleave",(function(){i.Oc(e);const n=i.Lc(93);return t.closePopup(n)})),i.Sb(94,"img",29),i.Wb(),i.Wb(),i.Xc(95,V,5,3,"div",47),i.Wb(),i.Xb(96,"div",48),i.Xb(97,"button",49),i.jc("click",(function(){return t.closeModal()})),i.Zc(98),i.oc(99,"translate"),i.Wb(),i.Xb(100,"button",50),i.Zc(101),i.oc(102,"translate"),i.oc(103,"translate"),i.Wb(),i.Wb(),i.Wb()}if(2&e){const e=i.Lc(54),n=i.Lc(81),s=i.Lc(91);i.wc("formGroup",t.form),i.Cb(3),i.bd(" ","CREATE"===t.mode?i.pc(4,38,"PTO.CREATE_POLICY_BUTTON"):i.pc(5,40,"PTO.EDIT_POLICY_BUTTON")," "),i.Cb(9),i.bd("",i.pc(13,42,"PTO.CREATE_POLICY.POLICY_NAME")," "),i.Cb(4),i.wc("placeholder",i.pc(17,44,"GLOBAL.NAME_LABEL")),i.Cb(4),i.bd("",i.pc(21,46,"PROJECTS.SHARED.ASSIGNEES_LABEL")," "),i.Cb(7),i.bd(" ",t.userSize?i.pc(28,48,"TEAMS.MEMBERS.STATUS_LABELS.ACTIVE_LABEL"):i.pc(29,50,"PROJECTS.DROPDOWN.SELECT_MEMBERS")," "),i.Cb(3),i.wc("ngIf",t.userSize>0),i.Cb(2),i.Hb("disable-area","EDIT"===t.mode),i.Cb(2),i.ad(i.pc(35,52,"PTO.CREATE_POLICY.TIME_UNIT")),i.Cb(3),i.wc("value",t.policyTimeUnits.get("days")),i.Cb(2),i.ad(i.pc(40,54,"GLOBAL.DAYS_LABEL")),i.Cb(3),i.wc("value",t.policyTimeUnits.get("hours")),i.Cb(2),i.ad(i.pc(45,56,"GLOBAL.HOURS_LABEL")),i.Cb(7),i.bd(" ",i.pc(52,58,"PTO.REQUIRES_APPROVAL_CHECKBOX")," "),i.Cb(4),i.wc("ngbPopover",e),i.Cb(3),i.wc("ngIf",t.requiresApprovalInput.value),i.Cb(5),i.bd(" ",i.pc(64,60,"PTO.REQUIRES_AUTOMATICALLY_ACCRUES_CHECKBOX")," "),i.Cb(2),i.wc("dropdownKey",t.accrualAmountInput.disabled),i.Cb(1),i.Hb("disable-area",t.accrualAmountInput.disabled)("cl-hover-no-underline",t.accrualAmountInput.disabled)("cl-cursor-default",t.accrualAmountInput.disabled),i.wc("ngClass",i.Dc(80,Y,t.accrualAmountInput.disabled,t.accrualAmountInput.disabled,t.accrualAmountInput.disabled)),i.Cb(1),i.ad(t.accrualAmountInput.value),i.Cb(3),i.ad(i.pc(71,62,"DAYS"===t.timeUnitInput.value?i.pc(72,64,"GLOBAL.DAYS_LABEL"):i.pc(73,66,"GLOBAL.HOURS_LABEL"))+" "+i.pc(74,68,"EXPENSES.CATEGORIES.TABLE.ROWS.PER")+" "),i.Cb(5),i.wc("dropdownKey",t.accrualPeriodInput.disabled),i.Cb(1),i.wc("ngClass",i.Dc(84,Y,t.accrualAmountInput.disabled,t.accrualAmountInput.disabled,t.accrualAmountInput.disabled)),i.Cb(1),i.ad(i.pc(78,70,t.translateAccrualPeriodInput(t.accrualPeriodInput.value))),i.Cb(5),i.wc("ngbPopover",n),i.Cb(6),i.bd(" ",i.pc(89,72,"PTO.CREATE_POLICY.ALLOW_NEGATIVE_BALANCE")," "),i.Cb(4),i.wc("ngbPopover",s),i.Cb(3),i.wc("ngIf","DAYS"===t.timeUnitInput.value),i.Cb(3),i.bd("",i.pc(99,74,"GLOBAL.CANCEL_BTN")," "),i.Cb(2),i.wc("disabled",t.form.invalid||t.form.pristine&&"EDIT"===t.mode),i.Cb(1),i.bd(" ","CREATE"===t.mode?i.pc(102,76,"GLOBAL.CREATE_LABEL"):i.pc(103,78,"GLOBAL.SAVE_LABEL")," ")}},directives:[s.I,s.t,s.k,s.c,s.s,s.i,w.a,L.a,R.u,y.a,s.A,s.l,s.a,_.M,R.r,k.a,R.x,W.a],pipes:[I.e,R.q],encapsulation:2}),e})();const K=[new c.a({key:"status",options:[new g.a(C.a.ALL,"GLOBAL.ALL_LABEL"),new g.a(C.a.ACTIVE,"GLOBAL.ACTIVE_LABEL"),new g.a(C.a.INACTIVE,"GLOBAL.INACTIVE_LABEL")]})]},QzXH:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("ofXK"),s=n("3Pt+"),c=n("fXoL");let a=(()=>{class e{}return e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,s.m]]}),e})()},TuBP:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("s07H"),s=n("ofXK"),c=n("tyNb"),a=n("sYmb"),o=n("fXoL");let r=(()=>{class e{}return e.\u0275mod=o.Pb({type:e}),e.\u0275inj=o.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.a,s.c,c.h,a.d]]}),e})()},"U5k/":function(e,t,n){"use strict";n.r(t),n.d(t,"DefaultLayoutModule",(function(){return oK}));var i=n("ofXK"),s=n("fXoL");let c=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c]]}),e})();var a=n("DVUX");let o=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var r=n("Ymxs"),l=n("1Tmk"),b=n("8v23"),d=n("lJxs"),u=n("vkgz"),p=n("XNiG"),h=n("Jzhb"),m=n("tk/3"),g=n("sYmb");let E=(()=>{class e{constructor(e,t,n,i){this.http=e,this.toaster=t,this.workspaceService=n,this.translateService=i,this.roles$=new p.a}updateRoles(e,t){e=e||[];const n=this.workspaceService.getDefaultWorkspaceId(),i={roles:e.map(e=>e.asBodyParam())};return this.http.put(`/workspaces/${n}/users/${t}/roles`,i).pipe(Object(d.a)(e=>(e.userRoles||[]).map(e=>new b.a(e))),Object(u.a)(()=>{const e=this.translateService.instant("SHARED_MODULES.ROLE_SERVICE.UPDATE_SUCCESSFUL");this.toaster.pop("success",e)},e=>{var t;const n=this.translateService.instant("GLOBAL.UPDATE_FAILED_ERROR_MESSAGE");this.toaster.pop("error",(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||n)}))}giveAdminRole(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.post(`v1/workspaces/${t}/users/${e}/roles`,{role:h.a.ADMIN,entityId:t}).pipe(Object(d.a)(e=>(e.userRoles||[]).map(e=>new b.a(e))),Object(u.a)(()=>{const e=this.translateService.instant("SHARED_MODULES.ROLE_SERVICE.UPDATE_SUCCESSFUL");this.toaster.pop("success",e)},e=>{var t;const n=this.translateService.instant("GLOBAL.UPDATE_FAILED_ERROR_MESSAGE");this.toaster.pop("error",(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||n)}))}removeAdminRole(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`v1/workspaces/${t}/users/${e}/roles`,{headers:null,body:{role:h.a.ADMIN,entityId:t}}).pipe(Object(d.a)(e=>null),Object(u.a)(()=>{const e=this.translateService.instant("SHARED_MODULES.ROLE_SERVICE.UPDATE_SUCCESSFUL");this.toaster.pop("success",e)},e=>{var t;const n=this.translateService.instant("GLOBAL.UPDATE_FAILED_ERROR_MESSAGE");this.toaster.pop("error",(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||n)}))}getRolesForUser(e){const t=this.workspaceService.getDefaultWorkspaceId();if(!t)return;const n=new p.a;return this.http.get(`/workspaces/${t}/users/${e}/roles`).pipe(Object(d.a)(e=>e.userRoles.map(e=>new b.a(e)))).subscribe(e=>{this.roles$.next(e)},e=>{const t=this.translateService.instant("GLOBAL.GET_PERMISSIONS_ERROR_MESSAGE");this.toaster.pop("error",t),n.error(e)}),n}}return e.\u0275fac=function(t){return new(t||e)(s.fc(m.c),s.fc(r.a),s.fc(l.a),s.fc(g.f))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var f=n("LPYB"),S=n("EONh"),C=n("VucA"),A=n("NDhe"),O=n("iTUp"),v=n("3Pt+");let T=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c]]}),e})();var I=n("Dfhc"),w=n("1kSV"),L=n("9Trn"),R=n("QzXH"),y=n("jJjg");let _=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,f.b,C.a,A.a,S.a,O.a,v.m,T,I.a,w.db,L.a,w.r,R.a,y.a,g.d]]}),e})();var k=n("tyNb"),W=n("8N2M"),X=n("K5US");let N=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c]]}),e})(),D=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c]]}),e})(),P=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c]]}),e})();var M=n("liYL"),B=n("LM6y");let U=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,v.C,g.d]]}),e})(),G=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,O.a,M.a,B.a,g.d,U]]}),e})(),x=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},imports:[[i.c,k.h,O.a,v.m,w.db,G,W.a,X.a,N,D,L.a,P,R.a,g.d]]}),e})();var F=n("1Mzi"),j=n("MtJD"),Z=n("vwXn");class V{constructor(e){this._id=e&&e.id,this._userId=e&&e.userId,this._apiKey=e&&e.apiKey,this._active=e&&e.active}get id(){return this._id}set id(e){this._id=e}get userId(){return this._userId}set userId(e){this._userId=e}get apiKey(){return this._apiKey}set apiKey(e){this._apiKey=e}get active(){return this._active}set active(e){this._active=e}}class Y{constructor(e={}){this.id=e.id||null,this.countOfWorkspaces=e.countOfWorkspaces||null,this.email=e.email||null,this.name=e.name||null,this.status=e.status||null,this.apiKey=new V(e.apiKey)}}let H=(()=>{class e{constructor(e,t,n,i){this.http=e,this.workspaceService=t,this.toaster=n,this.translateService=i}getUsers(e){const t=this.workspaceService.getDefaultWorkspaceId(),n=(new m.h).append("page",(e.page-1).toString()).append("pageSize",e.pageSize).append("sortOrder",e.sortOrder).append("sortColumn",e.sortColumn).append("searchEmail",e.searchEmail.trim());return this.http.get(`/users/workspaces/${t}/`,{params:n}).pipe(Object(d.a)(e=>(e.users=e.users.map(e=>new Y(e)),e)),Object(u.a)(null,()=>this.toaster.pop("error",this.translateService.instant("WORKSPACE.ACCOUNTS_USER_SERVICE.GET_USERS_ERROR_MSG"))))}resetPassword(e,t){return this.http.post("/password-reset-tokens/",{email:e}).pipe(Object(u.a)(()=>this.toaster.pop("success",t||this.translateService.instant("WORKSPACE.ACCOUNTS_USER_SERVICE.PASSWORD_RESET_SUCCESS")),e=>this.toaster.pop("error",e&&e.error&&e.error.message||this.translateService.instant("WORKSPACE.ACCOUNTS_USER_SERVICE.PASWORD_RESET_FAILED"))))}removeUserAccount(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`/workspaces/${t}/user/${e}`).pipe(Object(u.a)(()=>this.toaster.pop("success",this.translateService.instant("WORKSPACE.ACCOUNTS_USER_SERVICE.REMOVE_USER_SUCCESS")),e=>this.toaster.pop("error",e&&e.error&&e.error.message||this.translateService.instant("WORKSPACE.ACCOUNTS_USER_SERVICE.REMOVE_USER_FAILED"))))}renameUser(e,t){const n=this.workspaceService.getDefaultWorkspaceId();return this.http.put(`/users/${t}/name/workspaces/${n}/`,{name:e}).pipe(Object(u.a)(()=>this.toaster.pop("success",this.translateService.instant("WORKSPACE.ACCOUNTS_USER_SERVICE.USER_NAME_UPDATE_SUCCESS")),e=>this.toaster.pop("error",e&&e.error&&e.error.message||this.translateService.instant("WORKSPACE.ACCOUNTS_USER_SERVICE.USER_NAME_UPDATE_FAILED"))))}deactivateApiKey(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.put(`/apiKey/deactivateApiKey/${e}/workspaces/${t}/`,null).pipe(Object(d.a)(e=>new V(e)),Object(u.a)(()=>this.toaster.pop("success",this.translateService.instant("WORKSPACE.ACCOUNTS_USER_SERVICE.DEACTIVATE_API_KEY_SUCCESS")),e=>this.toaster.pop("error",e&&e.error&&e.error.message||this.translateService.instant("WORKSPACE.ACCOUNTS_USER_SERVICE.DEACTIVATE_API_KEY_FAILED"))))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(m.c),s.fc(l.a),s.fc(r.a),s.fc(g.f))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var $=n("0Gvx"),K=n("sjCC"),q=n("Qyj8"),z=n("tZA+"),Q=n("8pWl"),J=n("s07H"),ee=n("9lpP"),te=n("49HY");let ne=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,g.d]]}),e})();var ie=n("6FRn");let se=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,g.d]]}),e})(),ce=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,g.d]]}),e})(),ae=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,O.a,L.a,g.d]]}),e})();var oe=n("E10L"),re=n("lGQG");let le=(()=>{class e{constructor(e,t,n,i){this.http=e,this.toaster=t,this.authService=n,this.translateService=i,this.error=new p.a,this.apiKey$=new p.a}generateApiKey(){const e=this.authService.getUser().id;this.http.post(`/apiKey/${e}/generateApiKey`,{}).pipe(Object(d.a)(e=>new V(e))).subscribe(e=>{this.apiKey$.next(e),this.toaster.pop("success",this.translateService.instant("SERVICES.API_KEY.SUCCESS_MESSAGE.GENERATED"))},e=>{this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("SERVICES.API_KEY.ERROR_MESSAGE.GENERATE_FAILED"))})}getApiKeyForUser(){const e=this.authService.getUser().id;this.http.get("/apiKey/"+e).pipe(Object(d.a)(e=>new V(e))).subscribe(e=>this.apiKey$.next(e))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(m.c),s.fc(r.a),s.fc(re.a),s.fc(g.f))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var be=n("ogL9");let de=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,g.d]]}),e})(),ue=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[v.m,i.c,v.C,g.d]]}),e})();var pe=n("WQ+v");let he=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[pe.a],imports:[[i.c,v.m]]}),e})(),me=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[le],imports:[[v.m,i.c,O.a,M.a,B.a,w.db,w.O,L.a,v.C,oe.a,S.a,R.a,be.a,de,ue,he,k.h,g.d]]}),e})(),ge=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[H,q.a,ie.a],imports:[[i.c,v.m,L.a,k.h,y.a,Z.a,M.a,$.a,v.C,F.a,w.db,j.a,ee.a,te.a,O.a,K.a,z.a,ce,S.a,v.m,v.C,Q.a,J.a,ne,se,ae,g.d,oe.a,me]]}),e})();var Ee=n("B01t"),fe=n("s4Bo"),Se=n("RH5C");let Ce=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[Ee.a,i.c,v.m,fe.a,X.a,L.a,be.a,Se.a,w.db,g.d]]}),e})();var Ae=n("dlKe"),Oe=n("gr2/"),ve=n("1ROj"),Te=n("qcnj"),Ie=n("9O0/"),we=n("qvXw"),Le=n("QAEb");let Re=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,O.a,g.d]]}),e})();var ye=n("Qd9e"),_e=n("jtSf"),ke=n("wd/R"),We=n("fV9S");let Xe=(()=>{class e{constructor(e){this.authService=e}updateWeekStatusToGroups(e,t,n=!1){if(!e.length)return;const i=this.authService.getUser().settings.weekStart,s=[];e.forEach(e=>{const n=Object(_e.h)(ke(e.date),i).format("YYYY-MM-DD");if(s.includes(n))e.weekStatus=null;else{if(s.push(n),!t[n]){const e={dateRange:{start:ke(n).startOf("day").toISOString(),end:ke(n).add(6,"day").endOf("day").toISOString()},startDayOfWeek:n};t[n]=new We.a(e)}e.weekStatus=new We.a(t[n])}});let c=!0,a=0,o=0;for(let r=e.length-1;r>-1;r--){const i=e[r];a+=i.timeEntries.length,o+=i.timeEntries.filter(e=>!!e.approvalRequestId).length,a>o&&(c=!1),i.weekStatus&&(i.weekStatus.isApprovedAllOnCurrentPage=c,n&&(t[i.weekStatus.startDayOfWeek].initIsApprovedOnOtherPages(a,o),i.weekStatus.initIsApprovedOnOtherPages(a,o)),c=!0,a=0,o=0)}}getTotalsOfWeek(e,t){const n=e.findIndex((e,n)=>{var i;return(null===(i=e.weekStatus)||void 0===i?void 0:i.startDayOfWeek)===t});let i=0,s=0;if(n<0)return console.warn("Week status missing for "+t),{entriesCount:i,approvedCount:s};for(let c=n;c<e.length;c++){const n=e[c];if(i+=n.timeEntries.length,s+=n.timeEntries.filter(e=>!!e.approvalRequestId).length,n.weekStatus&&n.weekStatus.startDayOfWeek!==t)return{entriesCount:i,approvedCount:s}}return{entriesCount:i,approvedCount:s}}refreshIsWeekApproved(e,t){let n;const i=e.find((e,i)=>{var s;const c=(null===(s=e.weekStatus)||void 0===s?void 0:s.startDayOfWeek)===t;return c&&(n=i),c});let s=!0,c=0,a=0;for(let o=n;o<e.length;o++){const n=e[o];if(c+=i.timeEntries.length,a+=i.timeEntries.filter(e=>!!e.approvalRequestId).length,c>a&&(s=!1),n.weekStatus&&n.weekStatus.startDayOfWeek!==t)return i.weekStatus.isApprovedAllOnCurrentPage=s,void(i.weekStatus=new We.a(i.weekStatus))}i.weekStatus.isApprovedAllOnCurrentPage=s,i.weekStatus=new We.a(i.weekStatus)}}return e.\u0275fac=function(t){return new(t||e)(s.fc(re.a))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var Ne=n("LNDd"),De=n("Kj3r"),Pe=n("1G5W");let Me=(()=>{class e{constructor(){this.debouncer$=new p.a,this._debouncer$=new p.a,this.unsubscribe$=new p.a,this._debouncer$.pipe(Object(De.a)(200),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.debouncer$.next(e)})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}reset(){this.debouncer$.next(!0),this.debouncer$.complete(),this.debouncer$=new p.a}next(e){this._debouncer$.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var Be=n("brRw"),Ue=n("zJCG"),Ge=n("2Vo4");let xe=(()=>{class e{constructor(){this.selectAllChanged$=new p.a,this.numberOfSelected$=new Ge.a(0),this.numberOfEntries$=new Ge.a(0),this.numberOfSelected=0,this.numberOfEntries=0}recalculateBulkCheckboxes(e=this._entriesReference){this._entriesReference=e;let t=0,n=0;e.forEach(e=>{e.children?e.children.forEach(e=>{e.approvalRequestId||n++,e.bulkEdit&&t++}):(e.approvalRequestId||n++,e.bulkEdit&&t++)}),this.numberOfSelected=t,this.numberOfEntries=n,this.numberOfSelected$.next(this.numberOfSelected),this.numberOfEntries$.next(this.numberOfEntries)}setSelectAll(e){this.numberOfSelected=e?this.numberOfEntries:0,this.numberOfSelected$.next(this.numberOfSelected),this.selectAllChanged$.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})(),Fe=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[Me,xe],imports:[[i.c,v.m,w.db,Le.a,L.a,fe.a,Re,S.a,ye.a,w.O,w.db,k.h,Oe.a,Be.a,Ue.a,Ne.a,g.d]]}),e})();var je=n("mMUe"),Ze=n("ksGH"),Ve=n("Gajk");let Ye=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,L.a,Ze.a,Ve.a,w.db]]}),e})();var He=n("v95T");let $e=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},imports:[[i.c,g.d,v.m,L.a,S.a,j.a,$.a,v.C]]}),e})(),Ke=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},imports:[[i.c,w.O,$.a,v.C,R.a,$e,g.d]]}),e})(),qe=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[Xe,Me,xe],imports:[[i.c,v.m,Ye,Oe.a,B.a,L.a,y.a,Ce,fe.a,Be.a,O.a,Ae.b,He.a,ve.a,Te.a,w.r,Ie.a,we.a,k.h,$.a,Le.a,Re,ye.a,w.db,Ne.a,Fe,M.a,S.a,Ue.a,je.a,g.d,Ke]]}),e})();var ze=n("VFot");let Qe=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[v.m,i.c,ze.a,v.C,g.d]]}),e})(),Je=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[v.m,i.c,ze.a,v.C,S.a,g.d]]}),e})(),et=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,g.d]]}),e})(),tt=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,g.d]]}),e})(),nt=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,g.d]]}),e})(),it=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,g.d,L.a,S.a]]}),e})(),st=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,g.d,v.C,L.a,S.a]]}),e})(),ct=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,g.d,v.C,S.a]]}),e})(),at=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[Qe,v.m,k.h,i.c,Je,ne,et,tt,ce,O.a,w.db,se,g.d,nt,it,st,ct,g.d,$e,j.a]]}),e})(),ot=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,g.d]]}),e})(),rt=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[Qe,v.m,i.c,$.a,Je,ne,tt,se,g.d]]}),e})(),lt=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[v.m,i.c,rt,g.d]]}),e})(),bt=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[v.m,i.c,J.a,at,ot,lt,g.d]]}),e})();var dt=n("fkOE");let ut=(()=>{class e{constructor(e,t,n,i,s){this.http=e,this.workspaceService=t,this.authService=n,this.toaster=i,this.translateService=s}isQuickbooksConnected(e){return this.http.get(`${dt.h}/authentication/workspaces/${e}/is-connected`).pipe(Object(d.a)(e=>e),Object(u.a)(()=>{},e=>{var t;this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translateService.instant("SERVICES.INTEGRATION.QUICKBOOK.GET.ERROR_MESSAGE"))}))}isTokenValid(e){return this.http.get(`${dt.h}/authentication/workspaces/${e}/isTokenValid`).pipe(Object(d.a)(e=>e),Object(u.a)(()=>{},e=>{var t;this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translateService.instant("SERVICES.INTEGRATION.QUICKBOOK.CHECK_TOKEN.ERROR_MESSAGE"))}))}getQuickbooksConnectUrl(e){return this.http.get(`${dt.h}/authentication/workspaces/${e}/auth-code-url`).pipe(Object(d.a)(e=>e.obtainAuthTokenUrl),Object(u.a)(()=>{},e=>{var t;this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translateService.instant("SERVICES.INTEGRATION.CONNECT.ERROR_MESSAGE"))}))}connectConfirmQuickbooks(e,t,n,i){const s=(new m.h).append("code",e).append("state",t).append("realmId",n);return this.http.get(`${dt.h}/authentication/workspaces/${i}/obtain-access-token`,{params:s}).pipe(Object(d.a)(e=>null),Object(u.a)(()=>{this.toaster.success(this.translateService.instant("SERVICES.INTEGRATION.CONNECT.SUCCESS_MESSAGE"))},e=>{var t;this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translateService.instant("SERVICES.INTEGRATION.CONNECT.ERROR_MESSAGE"))}))}disconnectQuickbooks(e){return this.http.delete(`${dt.h}/authentication/workspaces/${e}/disconnect`,{}).pipe(Object(d.a)(e=>null),Object(u.a)(()=>{this.toaster.success(this.translateService.instant("SERVICES.INTEGRATION.DISCONNECT.SUCCESS_MESSAGE"))},e=>{var t;this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translateService.instant("SERVICES.INTEGRATION.DISCONNECT.ERROR_MESSAGE"))}))}checkSyncData(e){return this.http.get(`${dt.h}/workspaces/${e}/sync`).pipe(Object(d.a)(e=>e),Object(u.a)(()=>{},e=>{var t;this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translateService.instant("SERVICES.INTEGRATION.SYNC.GET.ERROR_MESSAGE"))}))}doSync(e,t){return this.http.post(`${dt.h}/workspaces/${e}/sync`,{usersSyncId:t.usersSyncId,clientsSyncId:t.clientsSyncId,projectsSyncId:t.projectsSyncId,relationsSyncId:t.relationsSyncId}).pipe(Object(u.a)(()=>{this.toaster.success(this.translateService.instant("SERVICES.INTEGRATION.SYNC.DO.SUCCESS_MESSAGE"))},e=>{var t;this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translateService.instant("SERVICES.INTEGRATION.SYNC.DO.ERROR_MESSAGE"))}))}doUsersSync(e,t){return this.http.post(`${dt.h}/workspaces/${e}/sync/users`,{usersIds:t}).pipe(Object(u.a)(()=>{this.toaster.success(this.translateService.instant("SERVICES.INTEGRATION.SYNC.DO.SUCCESS_MESSAGE_ONLY_USERS"))},e=>{var t;this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translateService.instant("SERVICES.INTEGRATION.SYNC.DO.ERROR_MESSAGE"))}))}disconnectFromPumble(e){this.http.delete(`/workspaces/${e}/pumble-integration`)}getIntegrationToken(e){const t=localStorage.getItem("refreshToken");return this.http.post(`/auth/workspaces/${e}/token/integration`,{refreshToken:t}).pipe(Object(d.a)(e=>e),Object(u.a)(()=>{},e=>console.log(e)))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(m.c),s.fc(l.a),s.fc(re.a),s.fc(r.a),s.fc(g.f))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})(),pt=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[ut],imports:[[v.m,i.c,v.C,k.h,F.a,$.a,g.d,L.a,S.a,j.a,$e]]}),e})(),ht=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,v.C,g.d]]}),e})(),mt=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[ie.a],imports:[[i.c,v.m,v.C,L.a,Q.a,oe.a,de,M.a,ue,F.a,$.a,ht,k.h,g.d]]}),e})(),gt=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[H],imports:[[i.c,v.m,v.C,L.a,y.a,F.a,L.a,Z.a,M.a,$.a,k.h,g.d]]}),e})();var Et=n("cpn4"),ft=n("OG4e"),St=n("FpXt");let Ct=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,v.C,S.a,St.a]]}),e})(),At=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[Et.a,ft.a],imports:[[i.c,v.m,$.a,v.C,Ee.a,de,R.a,S.a,L.a,F.a,w.db,Ct,Oe.a,z.a,k.h,ee.a,te.a,g.d,B.a]]}),e})(),Ot=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,S.a,$.a,k.h,g.d]]}),e})();class vt{constructor(e){this._id=e&&e.id,this._workspaceId=e&&e.workspaceId,this._alertType=e&&e.alertType,this._percentage=e&&e.percentage,this._alertPerson=e&&e.alertPerson}get id(){return this._id}set id(e){this._id=e}get workspaceId(){return this._workspaceId}set workspaceId(e){this._workspaceId=e}get alertType(){return this._alertType}set alertType(e){this._alertType=e}get percentage(){return this._percentage}set percentage(e){this._percentage=e}get alertPerson(){return this._alertPerson}set alertPerson(e){this._alertPerson=e}}let Tt=(()=>{class e{constructor(e,t,n){this.http=e,this.toaster=t,this.translateService=n,this.error=new p.a,this.alert=new p.a,this.updatedAlert=new p.a,this.alerts=new p.a}createAlert(e,t){return this.http.post(`/workspaces/${t}/alerts/`,{alertType:e.alertType,percentage:e.percentage,alertPerson:e.alertPerson}).pipe(Object(d.a)(e=>new vt(e)),Object(u.a)(()=>{this.toaster.pop("success",this.translateService.instant("SERVICES.ALERT.SUCCESS_MESSAGE.CREATED"))},e=>{this.error.next(e),this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("SERVICES.ALERT.ERROR_MESSAGE.EXISTS"))}))}updateAlert(e,t){this.http.put(`/workspaces/${t}/alerts/${e.id}`,{alertType:e.alertType,percentage:e.percentage,alertPerson:e.alertPerson}).subscribe(e=>{this.updatedAlert.next(new vt(e)),this.toaster.pop("success",this.translateService.instant("SERVICES.ALERT.SUCCESS_MESSAGE.UPDATED"))},e=>{this.error.next(e),this.getAllAlertsForWorkspace(t),this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("SERVICES.ALERT.ERROR_MESSAGE.EXISTS"))})}deleteAlert(e,t){return this.http.delete(`/workspaces/${t}/alerts/${e}`).pipe(Object(d.a)(e=>new vt(e)),Object(u.a)(()=>{this.toaster.pop("success",this.translateService.instant("SERVICES.ALERT.SUCCESS_MESSAGE.DELETED"))},e=>{this.error.next(e),this.toaster.pop("error",this.translateService.instant("SERVICES.ALERT.ERROR_MESSAGE.NOT_DELETED"))}))}getAllAlertsForWorkspace(e){this.http.get(`/workspaces/${e}/alerts/`).pipe(Object(d.a)(e=>e.map(e=>new vt(e)))).subscribe(e=>{this.alerts.next(e)},e=>{this.error.next(e)})}}return e.\u0275fac=function(t){return new(t||e)(s.fc(m.c),s.fc(r.a),s.fc(g.f))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var It=n("DeEi"),wt=n("5lh1");let Lt=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,v.C,k.h,g.d]]}),e})(),Rt=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[v.m,i.c,v.C,k.h,de,Lt,$.a,g.d]]}),e})(),yt=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[Et.a,ft.a],imports:[[i.c,v.m,v.C,Ee.a,de,R.a,S.a,L.a,F.a,w.db,w.O,Ct,Oe.a,z.a,k.h,ee.a,te.a,g.d]]}),e})(),_t=(()=>{class e{constructor(){this._expandAllRows$=new Ge.a(!1),this._expandRow$=new p.a}setExpandAllRows(e){this._expandAllRows$.next(e)}get expandAllRows(){return this._expandAllRows$}setExpandRow(e,t){this._expandRow$.next({id:e,expand:t})}get expandRow(){return this._expandRow$}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var kt=n("BmE8");let Wt=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[_t,kt.a],imports:[[i.c,L.a,S.a,j.a,I.a,Z.a,y.a,g.d,M.a,B.a,He.a]]}),e})(),Xt=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[ft.a,Tt],imports:[[pt,i.c,At,yt,v.m,Ot,mt,gt,Rt,J.a,It.a,wt.a,k.h,g.d,Wt,St.a]]}),e})();var Nt=n("CMn/"),Dt=n("+Two"),Pt=n("txdI"),Mt=n("gZQK");let Bt=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,L.a,w.O,k.h,g.d]]}),e})();var Ut=n("QG2T"),Gt=n("Fn+O"),xt=n("Zco2");let Ft=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,$.a,L.a,B.a,C.a,y.a,z.a,S.a,oe.a,Dt.a,A.a,j.a,Fe,M.a,k.h,w.db,Ae.b,O.a,Pt.a,w.O,Re,Ne.a,v.C,je.a,a.c,Mt.a,F.a,Bt,g.d,Ut.a,Gt.a,xt.ExpensesModule]]}),e})();var jt=n("l1Fo"),Zt=n("pLZG"),Vt=n("JIr8"),Yt=n("LRne"),Ht=function(e){return e.PENDING="PENDING",e.APPROVED="APPROVED",e.WITHDRAWN_APPROVAL="WITHDRAWN_APPROVAL",e.WITHDRAWN_SUBMISSION="WITHDRAWN_SUBMISSION",e.REJECTED="REJECTED",e.UNSUBMITTED="UNSUBMITTED",e}({});class $t{constructor(e,t,n,i,s,c){this.approvalRequestId=e,this.userId=t,this.userManagers=n,this.approvalState=i,this.label=s,this.total=c,this.approvalRequestId=e||"",this.userId=t||"",this.approvalState=i||Ht.PENDING,this.label=s||"",this.total=c||"",this.userManagers=n||[]}}class Kt{constructor(e,t){this.title=e||"",this.items=(t||[]).map(e=>new $t(e.id||e.approvalRequestId,e.userId,e.userManagers,e.approvalState,e.label,e.total))}}class qt{constructor(e){this.userId=(e=e||{}).userId,this.userName=e.userName,this.timeZone=e.timeZone,this.strartOfWeek=e.strartOfWeek}}class zt{constructor(e){this.state=(e=e||{}).state,this.updatedBy=e.updatedBy,this.updatedByUserName=e.updatedByUserName,this.updatedAt=e.updatedAt,this.note=e.note}}class Qt{constructor(e){this.userId=(e=e||{}).userId,this.userName=e.userName}}class Jt{constructor(e){if(this.id=e.id,this.workspaceId=e.workspaceId,this.dateRange=e.dateRange,this.owner=new qt(e.owner),this.creator=new Qt(e.creator),this.status=new zt(e.status),!e.id)return;const t=1e3*parseInt(e.id.substring(0,8),16);this.date=ke(t).toISOString()}}var en=n("5Iok"),tn=n("f0Wu"),nn=n("5pgj"),sn=n("xoOP");class cn{constructor(e,t,n,i){this.userId=e,this.userName=t,this.dateRange=n,this.total=i}}class an{constructor(e,t){this.title=e||"",this.items=(t||[]).map(e=>new cn(e.userId,e.userName,e.dateRange,e.total))}}var on=n("hkzH");let rn=(()=>{class e{constructor(e,t,n,i,s){this.http=e,this.toaster=t,this.authService=n,this.workspaceService=i,this.translate=s,this.pendingCount$=new p.a,this.subscribeToPermission()}subscribeToPermission(){this.authService.permissionData$.pipe(Object(Zt.a)(e=>null!==e)).subscribe(e=>{const t=this.authService.getUser().id,n=e.isTeamManagerFor(t);this.canApproveMyApprovals=e.isAdminOrOwner||n})}setPendingCount(e){!Object(sn.u)(e)||e<0||(this.pendingCount=e,this.pendingCount$.next(e))}getApprovalCount(e){const t=this.workspaceService.getDefaultWorkspaceId(),n=(new m.h).append("states",(null==e?void 0:e.toString())||[Ht.PENDING].toString()),i=new p.a;return this.http.get(`/workspaces/${t}/approval-requests/count`,{params:n}).subscribe(t=>{e.includes(Ht.PENDING)&&this.setPendingCount(t),i.next(t)},e=>i.error(e)),i}getFilteredApprovalCount(e){const t=this.workspaceService.getDefaultWorkspaceId(),n=this.getApprovalFilterBody(e);return this.http.post(`/workspaces/${t}/approval-requests/count`,n).pipe(Object(Vt.a)(e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.APPROVAL_FAIL")),Object(Yt.a)(0)}))}createSubmitRequest(e){const t=this.workspaceService.getDefaultWorkspaceId(),n=this.authService.getUser().id,i={weekTime:ke.utc(e).startOf("day").toISOString()};return this.http.post(`/workspaces/${t}/users/${n}/approval-requests/`,i).pipe(Object(d.a)(e=>new Jt(e)),Object(u.a)(()=>{this.canApproveMyApprovals&&this.setPendingCount(this.pendingCount+1),this.toaster.pop("success",this.translate.instant("APPROVAL.MESSAGES.SUBMIT_SUCCESS"))},e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.SUBMIT_FAIL"))}))}getAllApprovalGroups(e){const t=this.workspaceService.getDefaultWorkspaceId(),n=this.getApprovalFilterBody(e);return this.http.post(`/workspaces/${t}/approval-requests/stats`,n).pipe(Object(d.a)(e=>e.map(e=>new Kt(e.title,e.items))),Object(u.a)(e=>{},e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.APPROVAL_FAIL"))}))}getApprovalDetails(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.get(`/workspaces/${t}/approval-requests/${e}/details`).pipe(Object(d.a)(e=>{const t=e.approvalRequest.owner.timeZone,n={};e.entries=e.entries.map(e=>new en.a(e));const i=e.entries.every(e=>e.approvalRequestId);e.entries.forEach(e=>{const i=tn.tz(e.timeInterval.start,t).format("YYYY-MM-DD");n[i]||(n[i]=new nn.a(i,"",[])),n[i].timeEntries.push(e)});const s=[];for(const c in n){const e=n[c];e.time=Object(sn.d)(e.timeEntries),s.push(e)}return s.sort((e,t)=>{const n=new Date(e.date),i=new Date(t.date);return n>i?-1:n<i?1:0}),{approvalRequest:new Jt(e.approvalRequest),entryGroups:s,tableInfo:{trackedTime:e.trackedTime,pendingTime:e.pendingTime,approvedTime:e.approvedTime,billableTime:e.billableTime,billableAmount:e.billableAmount,costAmount:e.costAmount},equalStatus:i}})).pipe(Object(u.a)(()=>null,e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.APPROVAL_DASHBOARD_FAIL"))}))}getApprovalDashboard(e){const t=this.workspaceService.getDefaultWorkspaceId(),n=(new m.h).append("approvalRequestId",e);return this.http.get(`/workspaces/${t}/approval-requests/${e}/dashboard`,{params:n}).pipe(Object(u.a)(()=>null,e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.APPROVAL_DASHBOARD_FAIL"))}))}approveAll(e,t){const n=this.workspaceService.getDefaultWorkspaceId(),i={};return e&&(i.userFilter={contains:this.getContains(e,t),statuses:this.getStatuses(e.status||on.l.ACTIVE),ids:e.ids||[]}),t&&(i.userGroupFilter={contains:this.getContains(e,t),status:on.l.ACTIVE,ids:t.ids||[]}),this.http.patch(`/workspaces/${n}/approval-requests?state=APPROVED`,i).pipe(Object(d.a)(()=>null),Object(u.a)(()=>{this.setPendingCount(0),this.toaster.pop("success",this.translate.instant("APPROVAL.MESSAGES.APPROVED_SUCCESS"))},e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.APPROVED_FAIL"))}))}approve(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${t}/approval-requests/${e}`,{state:Ht.APPROVED}).pipe(Object(d.a)(e=>new Jt(e)),Object(u.a)(()=>{this.setPendingCount(this.pendingCount-1),this.toaster.pop("success",this.translate.instant("APPROVAL.MESSAGES.TIMESHEET_SUCCESS"))},e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.TIMESHEET_FAIL"))}))}reject(e,t){const n=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${n}/approval-requests/${e}`,{state:Ht.REJECTED,note:t}).pipe(Object(d.a)(e=>new Jt(e)),Object(u.a)(()=>{this.setPendingCount(this.pendingCount-1),this.toaster.pop("success",this.translate.instant("APPROVAL.MESSAGES.REJECT_SUCCESS"))},e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.REJECT_FAIL"))}))}withdrawSubmission(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${t}/approval-requests/${e}`,{state:Ht.WITHDRAWN_SUBMISSION}).pipe(Object(d.a)(e=>new Jt(e)),Object(u.a)(()=>{this.canApproveMyApprovals&&this.setPendingCount(this.pendingCount-1),this.toaster.pop("success",this.translate.instant("APPROVAL.MESSAGES.WITHDRAW_SUCCESS"))},e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.WITHDRAW_FAIL"))}))}withdrawApproval(e,t){const n=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${n}/approval-requests/${e}`,{state:Ht.WITHDRAWN_APPROVAL,note:t}).pipe(Object(d.a)(e=>new Jt(e)),Object(u.a)(()=>this.toaster.pop("success",this.translate.instant("APPROVAL.MESSAGES.WITHDRAW_SUCCESS")),e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.WITHDRAW_FAIL"))}))}getWeekStatus(e,t){const n=this.workspaceService.getDefaultWorkspaceId(),i=this.authService.getUser().id,s=(new m.h).append("start",e||"");return this.http.get(`/workspaces/${n}/users/${i}/approval-requests/week-status`,{params:s}).pipe(Object(d.a)(n=>new We.a(Object.assign(Object.assign({},n),{startDayOfWeek:t||ke(e).format("YYYY-MM-DD")}))),Object(u.a)(()=>null,e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.WEEK_STATUS_FAIL"))}))}getAllPendingRequestsForAllWorkspaces(){const e=this.workspaceService.getDefaultWorkspaceId(),t=this.authService.getUser().id;return this.http.get(`/workspaces/${e}/users/${t}/approval-requests/all-pending`).pipe(Object(d.a)(e=>{const t={};for(const i in e){const n=e[i];t[n.workspaceName]||(t[n.workspaceName]=[]),t[n.workspaceName].push(n.dateRange)}const n=[];for(const i in t)n.push({name:i,ranges:t[i]});return n.sort((e,t)=>{const n=e.name,i=t.name;return n>i?-1:n<i?1:0}),n})).pipe(Object(u.a)(()=>null,e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.PENDING_FAIL"))}))}withdrawAllRequestsForAllWorkspaces(){const e=this.workspaceService.getDefaultWorkspaceId(),t=this.authService.getUser().id;return this.http.patch(`/workspaces/${e}/users/${t}/approval-requests/withdraw-all`,{}).pipe(Object(d.a)(()=>null),Object(u.a)(null,e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.WITHDRAW_ALL_FAIL"))}))}getUnsubmittedDurations(e,t,n,i){const s=this.workspaceService.getDefaultWorkspaceId(),c={start:e,end:t};return n&&(c.userFilter={contains:this.getContains(n,i),ids:n.ids||[],statuses:this.getStatuses(n.status||on.l.ACTIVE)}),i&&(c.userGroupFilter={contains:this.getContains(n,i),ids:i.ids||[],status:on.l.ACTIVE}),this.http.post(`/workspaces/${s}/approval-requests/stats/unsubmitted`,c).pipe(Object(d.a)(e=>e.map(e=>new an(e.weekRange,e.users))),Object(u.a)(()=>{},e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.APPROVAL_FAIL"))}))}remindToSubmit(e,t,n,i){const s=`/workspaces/${this.workspaceService.getDefaultWorkspaceId()}/approval-requests/remind/submit`,c={start:e,end:t};return n&&(c.userFilter={contains:this.getContains(n,i),ids:n.ids||[],statuses:this.getStatuses(n.status||on.l.ACTIVE)}),i&&(c.userGroupFilter={contains:this.getContains(n,i),ids:i.ids||[],status:on.l.ACTIVE}),this.http.patch(s,c).pipe(Object(d.a)(()=>null),Object(u.a)(()=>this.toaster.pop("success",this.translate.instant("APPROVAL.MESSAGES.REMINDERS.SUCCESS_MESSAGE")),e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.REMINDERS.ERROR_MESSAGE"))}))}remindToApprove(e,t){const n=`/workspaces/${this.workspaceService.getDefaultWorkspaceId()}/approval-requests/remind/approve`,i={};return e&&(i.userFilter={contains:this.getContains(e,t),ids:e.ids||[],statuses:this.getStatuses(e.status||on.l.ACTIVE)}),t&&(i.userGroupFilter={contains:this.getContains(e,t),ids:t.ids||[],status:on.l.ACTIVE}),this.http.patch(n,i).pipe(Object(d.a)(()=>null),Object(u.a)(()=>this.toaster.pop("success",this.translate.instant("APPROVAL.MESSAGES.REMINDERS.SUCCESS_MESSAGE")),e=>{var t;return this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translate.instant("APPROVAL.MESSAGES.REMINDERS.ERROR_MESSAGE"))}))}getApprovalFilterBody(e){const t={page:e.page,"page-size":e.pageSize,"group-by":e.groupBy,states:e.states};return e.userFilter&&(t.userFilter={contains:this.getContains(e.userFilter,e.userGroupFilter),ids:e.userFilter.ids||[],statuses:this.getStatuses(e.userFilter.status||on.l.ACTIVE)}),e.userGroupFilter&&(t.userGroupFilter={contains:this.getContains(e.userFilter,e.userGroupFilter),ids:e.userGroupFilter.ids||[],status:on.l.ACTIVE}),t}getContains(e,t){return e.ids&&0!==e.ids.length||t.ids&&0!==t.ids.length?e.contains:on.d.DOES_NOT_CONTAIN}getStatuses(e){return e===on.l.ACTIVE_WITH_PENDING?[on.l.ACTIVE,on.l.PENDING]:e===on.l.ALL?[on.l.ACTIVE,on.l.PENDING,on.l.INACTIVE]:[e]}submitApproval(e,t){const n=this.workspaceService.getDefaultWorkspaceId(),i={weekTime:t.toISOString()};return this.http.post(`workspaces/${n}/users/${e}/approval-requests/for-other`,i)}}return e.\u0275fac=function(t){return new(t||e)(s.fc(m.c),s.fc(r.a),s.fc(re.a),s.fc(l.a),s.fc(g.f))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var ln=n("IzEk"),bn=n("HApq");let dn=(()=>{class e{constructor(e,t){this.router=e,this.systemSettingsService=t}canActivate(){const e=this.systemSettingsService.systemSettings$.pipe(Object(Zt.a)(e=>!!e));return this.systemSettingsService.getSystemSettings(),e.pipe(Object(ln.a)(1),Object(d.a)(()=>!0))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(k.d),s.fc(bn.a))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var un=n("hT48");let pn=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,L.a,un.a,O.a,Ae.b,Ne.a]]}),e})();class hn{constructor(e){this._id=e.id,this._name=e.name,this._workspaceId=e.workspaceId,this._url=e.url,this._authToken=e.authToken,this._webhookEvent=e.webhookEvent,this._triggerSourceType=e.triggerSourceType,this._triggerSource=e.triggerSource,this._enabled=e.enabled,this._webhookEventLabel=e.webhookEventLabel}get id(){return this._id}set id(e){this._id=e}get name(){return this._name}set name(e){this._name=e}get workspaceId(){return this._workspaceId}set workspaceId(e){this._workspaceId=e}get url(){return this._url}set url(e){this._url=e}get authToken(){return this._authToken}set authToken(e){this._authToken=e}get webhookEvent(){return this._webhookEvent}set webhookEvent(e){this._webhookEvent=e}get triggerSourceType(){return this._triggerSourceType}set triggerSourceType(e){this._triggerSourceType=e}get triggerSource(){return this._triggerSource}set triggerSource(e){this._triggerSource=e}get enabled(){return this._enabled}set enabled(e){this._enabled=e}get webhookEventLabel(){return this._webhookEventLabel}set webhookEventLabel(e){this._webhookEventLabel=e}}class mn{constructor(e){this._id=e.id,this._webhookId=e.webhookId,this.statusCode=e.statusCode,this._requestBody=e.requestBody,this._responseBody=e.responseBody,this._respondedAt=e.respondedAt}get id(){return this._id}set id(e){this._id=e}get webhookId(){return this._webhookId}set webhookId(e){this._webhookId=e}get statusCode(){return this._statusCode}set statusCode(e){this._statusCode=e}get requestBody(){return this._requestBody}set requestBody(e){this._requestBody=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}get respondedAt(){return this._respondedAt}set respondedAt(e){this._respondedAt=e}}var gn=function(e){return e.SUCCEEDED="SUCCEEDED",e.FAILED="FAILED",e.ALL="ALL",e}({});class En{constructor(e=gn.ALL,t,n,i){this.status=e,this.from=t,this.to=n,this.sortByNewest=i}}var fn=function(e){return e.NEW_TIMER_STARTED="NEW_TIMER_STARTED",e.TIMER_STOPPED="TIMER_STOPPED",e.NEW_TIME_ENTRY="NEW_TIME_ENTRY",e.TIME_ENTRY_UPDATED="TIME_ENTRY_UPDATED",e.TIME_ENTRY_DELETED="TIME_ENTRY_DELETED",e.NEW_CLIENT="NEW_CLIENT",e.NEW_PROJECT="NEW_PROJECT",e.NEW_TASK="NEW_TASK",e.NEW_TAG="NEW_TAG",e.NEW_INVOICE="NEW_INVOICE",e.INVOICE_UPDATED="INVOICE_UPDATED",e.USER_DELETED_FROM_WORKSPACE="USER_DELETED_FROM_WORKSPACE",e.USER_JOINED_WORKSPACE="USER_JOINED_WORKSPACE",e.USER_DEACTIVATED_ON_WORKSPACE="USER_DEACTIVATED_ON_WORKSPACE",e.USER_ACTIVATED_ON_WORKSPACE="USER_ACTIVATED_ON_WORKSPACE",e.USER_EMAIL_CHANGED="USER_EMAIL_CHANGED",e.USER_UPDATED="USER_UPDATED",e.NEW_APPROVAL_REQUEST="NEW_APPROVAL_REQUEST",e.APPROVAL_REQUEST_STATUS_UPDATED="APPROVAL_REQUEST_STATUS_UPDATED",e}({});const Sn={[fn.NEW_TIMER_STARTED]:"WEBHOOKS.EVENTS.TIMER_STARTED_LABEL",[fn.TIMER_STOPPED]:"WEBHOOKS.EVENTS.TIMER_STOPPED_LABEL",[fn.NEW_TIME_ENTRY]:"WEBHOOKS.EVENTS.ENTRY_MANUALLY_CREATED_LABEL",[fn.TIME_ENTRY_UPDATED]:"WEBHOOKS.EVENTS.ENTRY_UPDATED_LABEL",[fn.TIME_ENTRY_DELETED]:"WEBHOOKS.EVENTS.ENTRY_DELETED_LABEL",[fn.NEW_CLIENT]:"WEBHOOKS.EVENTS.CLIENT_CREATE_LABEL",[fn.NEW_PROJECT]:"WEBHOOKS.EVENTS.PROJECT_CREATED_LABEL",[fn.NEW_TASK]:"WEBHOOKS.EVENTS.TASK_CREATED_LABEL",[fn.NEW_TAG]:"WEBHOOKS.EVENTS.TAG_CREATED_LABEL",[fn.NEW_INVOICE]:"WEBHOOKS.EVENTS.NEW_INVOICE_LABEL",[fn.INVOICE_UPDATED]:"WEBHOOKS.EVENTS.INVOICE_UPDATED_LABEL",[fn.USER_DELETED_FROM_WORKSPACE]:"WEBHOOKS.EVENTS.USER_DELETED_FROM_WORKSPACE",[fn.USER_JOINED_WORKSPACE]:"WEBHOOKS.EVENTS.USER_JOINED_WORKSPACE",[fn.USER_DEACTIVATED_ON_WORKSPACE]:"WEBHOOKS.EVENTS.USER_DEACTIVATED_ON_WORKSPACE",[fn.USER_ACTIVATED_ON_WORKSPACE]:"USER_ACTIVATED_ON_WORKSPACE",[fn.USER_EMAIL_CHANGED]:"WEBHOOKS.EVENTS.USER_EMAIL_CHANGED",[fn.USER_UPDATED]:"WEBHOOKS.EVENTS.USER_UPDATED",[fn.NEW_APPROVAL_REQUEST]:"WEBHOOKS.EVENTS.NEW_APPROVAL_REQUEST",[fn.APPROVAL_REQUEST_STATUS_UPDATED]:"WEBHOOKS.EVENTS.APPROVAL_REQUEST_STATUS_UPDATED"},Cn=[fn.NEW_TIMER_STARTED,fn.TIMER_STOPPED,fn.NEW_TIME_ENTRY,fn.TIME_ENTRY_UPDATED,fn.TIME_ENTRY_DELETED,fn.NEW_APPROVAL_REQUEST,fn.APPROVAL_REQUEST_STATUS_UPDATED];var An=function(e){return e.WORKSPACE_ID="WORKSPACE_ID",e.USER_ID="USER_ID",e.PROJECT_ID="PROJECT_ID",e.TAG_ID="TAG_ID",e.TASK_ID="TASK_ID",e}({});new Map([[An.PROJECT_ID,"on project"],[An.USER_ID,"by user"],[An.TAG_ID,"with tag"],[An.TASK_ID,"on task"],[An.WORKSPACE_ID,"on workspace"]]);let On=(()=>{class e{constructor(e,t,n){this.http=e,this.toaster=t,this.translateService=n}getForWorkspace(e){return this.http.get(`/workspaces/${e}/webhooks/`).pipe(Object(d.a)(e=>({workspaceWebhookCount:e.workspaceWebhookCount,webhooks:e.webhooks.map(e=>new hn(Object.assign(Object.assign({},e),{webhookEventLabel:this.generateWebhooksLabel(e.webhookEvent,e.triggerSourceType)})))})),Object(u.a)(null,e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("WEBHOOKS.WEBHOOKS_SERVICE.GET_WEBHOOKS_FAILED"))))}getById(e,t){return this.http.get(`/workspaces/${e}/webhooks/${t}`).pipe(Object(d.a)(e=>new hn(Object.assign(Object.assign({},e),{webhookEventLabel:this.generateWebhooksLabel(e.webhookEvent,e.triggerSourceType)}))),Object(u.a)(null,e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("WEBHOOKS.WEBHOOKS_SERVICE.GET_WEBHOOK_FAILED"))))}delete(e,t){return this.http.delete(`/workspaces/${e}/webhooks/${t}`).pipe(Object(d.a)(e=>e),Object(u.a)(()=>this.toaster.pop("success",this.translateService.instant("WEBHOOKS.WEBHOOKS_SERVICE.DELETE_SUCCESS")),e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("WEBHOOKS.WEBHOOKS_SERVICE.DELETE_FAILED"))))}getLogs(e,t,n,i,s=gn.ALL){n-=1;const c=new En(s),a=(new m.h).append("page",n.toString()).append("size",i.toString());return this.http.post(`/workspaces/${e}/webhooks/${t}/logs`,c,{params:a}).pipe(Object(d.a)(e=>e.map(e=>new mn(e))),Object(u.a)(null,e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("WEBHOOKS.WEBHOOKS_SERVICE.GET_LOGS_FAILED"))))}getLogCount(e,t,n=gn.ALL){const i=(new m.h).append("status",n);return this.http.get(`/workspaces/${e}/webhooks/${t}/logs/count`,{params:i}).pipe(Object(d.a)(e=>e),Object(u.a)(null,e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("WEBHOOKS.WEBHOOKS_SERVICE.GET_LOG_COUNT_FAILED"))))}create(e,t){return this.http.post(`/workspaces/${e}/webhooks/`,t).pipe(Object(d.a)(e=>new hn(Object.assign(Object.assign({},e),{webhookEventLabel:this.generateWebhooksLabel(e.webhookEvent,e.triggerSourceType)}))),Object(u.a)(()=>this.toaster.pop("success",this.translateService.instant("WEBHOOKS.WEBHOOK_CREATED")),e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("WEBHOOKS.WEBHOOKS_SERVICE.CREATE_WEBHOOK_FAILED"))))}update(e,t,n){return this.http.put(`/workspaces/${e}/webhooks/${t}`,n).pipe(Object(d.a)(e=>new hn(Object.assign(Object.assign({},e),{webhookEventLabel:this.generateWebhooksLabel(e.webhookEvent,e.triggerSourceType)}))),Object(u.a)(()=>this.toaster.pop("success",this.translateService.instant("WEBHOOKS.WEBHOOKS_SERVICE.WEBHOOK_UPDATE_SUCCESS")),e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("WEBHOOKS.WEBHOOKS_SERVICE.WEBHOOK_UPDATE_FAILED"))))}generateNewToken(e,t){return this.http.patch(`/workspaces/${e}/webhooks/${t}/token`,new Object).pipe(Object(d.a)(e=>new hn(Object.assign(Object.assign({},e),{webhookEventLabel:this.generateWebhooksLabel(e.webhookEvent,e.triggerSourceType)}))),Object(u.a)(null,e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("WEBHOOKS.WEBHOOKS_SERVICE.GENERATE_SECRET_FAILED"))))}test(e,t){return this.http.get(`/workspaces/${e}/webhooks/${t}/test`).pipe(Object(d.a)(e=>e),Object(u.a)(()=>this.toaster.pop("success","Test sent."),e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("WEBHOOKS.WEBHOOKS_SERVICE.SEND_TEST_FAILED"))))}resend(e,t,n){return this.http.get(`/workspaces/${e}/webhooks/${t}/resend/${n}`).pipe(Object(d.a)(e=>e),Object(u.a)(()=>this.toaster.pop("success",this.translateService.instant("WEBHOOKS.WEBHOOKS_SERVICE.RESEND_SUCCESS")),e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("WEBHOOKS.WEBHOOKS_SERVICE.RESEND_FAILED"))))}generateWebhooksLabel(e,t){const n=Cn.includes(e),i=this.translateService.instant(Sn[e]);let s;return n&&t===An.WORKSPACE_ID?(s=this.translateService.instant("PROJECTS.PROJECTS_TABLE.ANYONE_LABEL"),`${i} (${s.toLowerCase()})`):n&&t===An.USER_ID?(s=this.translateService.instant("PAGES.DASHBOARD.ME"),`${i} (${s.toLowerCase()})`):i}}return e.\u0275fac=function(t){return new(t||e)(s.fc(m.c),s.fc(a.d),s.fc(g.f))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var vn=n("lBcp"),Tn=n("JBiw"),In=n("lvCY"),wn=n("8+Zx");class Ln{constructor(e){this.hasParameters=e,this.query={page:1,limit:In.f,name:""},this.parameterValues=new Tn.a([]),this.selectedValues=new wn.a,this.label="Choose parameters..."}get hasParameters(){return this._hasParameters}set hasParameters(e){this._hasParameters=e}get parameterValues(){return this._parameterValues}set parameterValues(e){this._parameterValues=e}get query(){return this._query}set query(e){this._query=e}get selectedValues(){return this._selectedValues}set selectedValues(e){this._selectedValues=e}get label(){return this._label}set label(e){this._label=e}selectValues(e){this.selectedValues=e.checkboxValues,this.label=""!=e.label?e.label:"Choose parameters..."}}var Rn=n("LfE4");let yn=(()=>{class e extends Ln{constructor(){super(!0),this.unsubscribe$=new p.a}itemsGetter(){this.tagService.getAllTagsV1(Rn.a.ACTIVE,null,{page:this.query.page,pageSize:this.query.limit}).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.parameterValues.resetAll(),this.parameterValues.pushToMap("values",e)})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=s.Mb({type:e,features:[s.zb]}),e})();var _n=n("VTb6");let kn=(()=>{class e extends Ln{constructor(){super(!0),this.unsubscribe$=new p.a}itemsGetter(){this.projectService.getProjects({status:"ACTIVE",page:this.query.page,pageSize:this.query.limit}).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.parameterValues.resetAll(),this.parameterValues.pushToMap("values",e)})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=s.Mb({type:e,features:[s.zb]}),e})();class Wn extends Ln{constructor(){super(!1)}itemsGetter(){}}let Xn=(()=>{class e extends Ln{constructor(){super(!0),this.unsubscribe$=new p.a}itemsGetter(){const e={page:1,limit:50,statuses:["ACTIVE"]};this.workspaceService.getUsers(e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(({users:t})=>{1===e.page&&this.parameterValues.resetMap("values"),this.parameterValues.pushToMap("values",t)})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=s.Mb({type:e,features:[s.zb]}),e})(),Nn=(()=>{class e{constructor(e,t,n){this.tagService=e,this.projectService=t,this.workspaceService=n}getForTags(){const e=new yn;return e.tagService=this.tagService,e}getForProjects(){const e=new kn;return e.projectService=this.projectService,e}getForWorkspace(){return new Wn}getForUsers(){const e=new Xn;return e.workspaceService=this.workspaceService,e}getForTasks(){return new Wn}}return e.\u0275fac=function(t){return new(t||e)(s.fc(vn.a),s.fc(_n.a),s.fc(l.a))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})(),Dn=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[On,Nn],imports:[[i.c,v.m,v.C,w.s,pn,j.a,L.a,g.d]]}),e})(),Pn=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[On],imports:[[i.c,v.m,k.h,Dn,S.a,L.a,$.a,y.a,Z.a,w.O,w.db,O.a,g.d]]}),e})(),Mn=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[g.d,k.h,i.c,v.m,F.a]]}),e})(),Bn=(()=>{class e{constructor(e,t){this.route=e,this.router=t}ngOnInit(){window.opener?(window.opener.postMessage({type:"message",result:this.route.snapshot.queryParams},"*"),window.close()):this.router.navigate(["/tracker"])}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.a),s.Rb(k.d))},e.\u0275cmp=s.Lb({type:e,selectors:[["redirect-integration"]],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();var Un=n("OmiP"),Gn=n("tQGB"),xn=n("PW4C"),Fn=n("NHP+"),jn=n("Vp8r");class Zn{constructor(e,t){this.order=e.order,this.description=e.description||"",this.itemType=e.itemType||"",this.quantity=e.quantity||0,this.unitPrice=e.unitPrice||0,this.amount=e.amount||0,this.timeEntryIds=[...e.timeEntryIds||[]],t&&this.divideValuesBy100()}static clone(e){return new Zn(e,!1)}static areSame(e,t){return e.order===t.order&&e.description.trim()===t.description.trim()&&e.itemType===t.itemType&&e.quantity===t.quantity&&e.unitPrice===t.unitPrice&&e.amount===t.amount}patchValues(e){Object.entries(e).forEach(([e,t])=>{this.hasOwnProperty(e)&&(this[e]=t)})}toApiParameters(){return{description:this.description.trim(),itemType:this.itemType.trim(),quantity:Object(sn.C)(this.quantity,100),unitPrice:Object(sn.C)(this.unitPrice,100)}}divideValuesBy100(){this.quantity&&(this.quantity/=100),this.unitPrice&&(this.unitPrice/=100)}}var Vn=function(e){return e.TAX="TAX",e.TAX_2="TAX_2",e.DISCOUNT="DISCOUNT",e}({});class Yn{constructor(e,t){this.id=e.id,this.number=e.number,this.status=e.status,this.issuedDate=e.issuedDate,this.dueDate=e.dueDate,this.subtotal=e.subtotal,this.discount=e.discount||0,this.discountAmount=e.discountAmount||0,this.tax=e.tax||0,this.tax2=e.tax2||0,this.taxAmount=e.taxAmount||0,this.tax2Amount=e.tax2Amount||0,this.amount=e.amount||0,this.currency=e.currency,this.subject=e.subject,this.note=e.note,this.clientId=e.clientId,this.clientName=e.clientName,this.clientAddress=e.clientAddress,this.userId=e.userId,t&&this.divideValuesBy100(),this.items=(e.items||[]).map(e=>new Zn(e,t)),this.visibleZeroFields=(e.visibleZeroFields||[]).map(e=>Vn[e])}static clone(e){return new Yn(e,!1)}get statusLabel(){return this.status.toLowerCase()||""}get color(){return In.D[this.status]}generatePdfFilename(e){return(e=e||"")?`${e}_Invoice_${this.number}.pdf`:`Invoice_${this.number}.pdf`}getAvailableStatuses(){return this.status===jn.a.SENT?[{id:jn.a.PAID,label:"INVOICES.SHARED.PAID_LABEL"},{id:jn.a.UNSENT,label:"INVOICES.SHARED.UNSENT_LABEL"},{id:jn.a.VOID,label:"INVOICES.SHARED.VOID_LABEL"}]:this.status===jn.a.PAID?[{id:jn.a.UNSENT,label:"INVOICES.SHARED.UNSENT_LABEL"},{id:jn.a.VOID,label:"INVOICES.SHARED.VOID_LABEL"}]:this.status===jn.a.UNSENT?[{id:jn.a.SENT,label:"INVOICES.SHARED.SENT_LABEL"},{id:jn.a.PAID,label:"INVOICES.SHARED.PAID_LABEL"},{id:jn.a.VOID,label:"INVOICES.SHARED.VOID_LABEL"}]:this.status===jn.a.VOID?[{id:jn.a.SENT,label:"INVOICES.SHARED.SENT_LABEL"},{id:jn.a.UNSENT,label:"INVOICES.SHARED.UNSENT_LABEL"},{id:jn.a.PAID,label:"INVOICES.SHARED.PAID_LABEL"}]:[]}toApiParameters(){return{number:this.number,status:this.status,issuedDate:this.issuedDate,dueDate:this.dueDate,subtotal:this.subtotal,discount:Object(sn.C)(this.discount,100),tax:Object(sn.C)(this.tax,100),tax2:Object(sn.C)(this.tax2,100),currency:this.currency,subject:this.subject,note:this.note,visibleZeroFields:this.visibleZeroFields}}patchValues(e,t){t=t||[],Object.entries(e).forEach(([e,n])=>{t.includes(e)||this.hasOwnProperty(e)&&(this[e]=n)})}divideValuesBy100(){this.discount&&(this.discount=parseFloat((this.discount/=100).toPrecision(8))),this.tax&&(this.tax=parseFloat((this.tax/=100).toPrecision(8))),this.tax2&&(this.tax2=parseFloat((this.tax2/=100).toPrecision(8)))}}var Hn=n("hl/z"),$n=n("kGbF"),Kn=function(e){return e.SINGLE_ITEM="SINGLE_ITEM",e.GROUPED="GROUPED",e.DETAILED="DETAILED",e}({});class qn{constructor(e){this.tax=(null==e?void 0:e.tax)/100||0,this.tax2=(null==e?void 0:e.tax2)/100||0,this.subject=(null==e?void 0:e.subject)||"",this.notes=(null==e?void 0:e.notes)||"",this.taxType=null==e?void 0:e.taxType,this.dueDays=(null==e?void 0:e.dueDays)||0,this.itemTypeId=(null==e?void 0:e.itemTypeId)||"",this.defaultImportExpenseItemTypeId=(null==e?void 0:e.defaultImportExpenseItemTypeId)||"",this.defaultImportTimeItemTypeId=(null==e?void 0:e.defaultImportTimeItemTypeId)||""}}class zn{constructor(e){this.quantity=null==e?void 0:e.quantity,this.unitPrice=null==e?void 0:e.unitPrice,this.itemType=null==e?void 0:e.itemType,this.RTL=null==e?void 0:e.rtl}}class Qn{constructor(e){this.itemType=e.itemType||"",this.issueDate=e.issueDate||"",this.dueDate=e.dueDate||"",this.billFrom=e.billFrom||"",this.billTo=e.billTo||"",this.description=e.description||"",this.quantity=e.quantity||"",this.unitPrice=e.unitPrice||"",this.amount=e.amount||"",this.subtotal=e.subtotal||"",this.discount=e.discount||"",this.tax=e.tax||"",this.tax2=e.tax2||"",this.totalAmount=e.totalAmount||"",this.notes=e.notes||""}toApiParameters(){return{itemType:this.itemType,issueDate:this.issueDate,dueDate:this.dueDate,billFrom:this.billFrom,billTo:this.dueDate,quantity:this.quantity,description:this.description,unitPrice:this.unitPrice,amount:this.amount,subtotal:this.subtotal,discount:this.discount,tax:this.tax,tax2:this.tax2,totalAmount:this.totalAmount,notes:this.notes}}}class Jn{constructor(e){this.defaults=new qn(e.defaults),this.exportFields=new zn(e.exportFields),this.labels=new Qn(e.labels)}}var ei=function(e){return e.DETAILED="DETAILED",e.PROJECT="PROJECT",e.USER="USER",e.CATEGORY="CATEGORY",e}({});let ti=(()=>{class e{constructor(e,t,n,i,s){this.http=e,this.toaster=t,this.loader=n,this.workspaceService=i,this.translate=s,this.invoice$=new p.a,this.unsubscribe$=new p.a,this._refreshSettings$=new p.a}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}setRefreshSettings(){this._refreshSettings$.next()}refreshSettings(){return this._refreshSettings$}getInvoices(e){const t=this.workspaceService.getDefaultWorkspaceId(),n=(new m.h).append("page",e.page.toString()).append("page-size",e.pageSize).append("statuses",e.statuses).append("sort-column",e.sortColumn).append("sort-order",e.sortOrder);return this.http.get(`/workspaces/${t}/invoices/info`,{params:n}).pipe(Object(d.a)(e=>({count:e.total,invoices:e.invoices.map(e=>new Yn(e,!0))})),Object(u.a)(()=>{},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("INVOICES.MESSAGES.GET_FAIL",{count:2}))}))}getInvoice(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.get(`/workspaces/${t}/invoices/${e}`).pipe(Object(d.a)(e=>new Yn(e,!0)),Object(u.a)(()=>{},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("INVOICES.MESSAGES.GET_FAIL",{count:1}))}))}createInvoice(e){var t,n,i;const s=this.workspaceService.getDefaultWorkspaceId(),c={clientId:null===(t=e.clientId)||void 0===t?void 0:t.trim(),currency:null===(n=e.currency)||void 0===n?void 0:n.trim(),number:null===(i=e.number)||void 0===i?void 0:i.trim(),issuedDate:e.issuedDate,dueDate:e.dueDate};return this.http.post(`/workspaces/${s}/invoices`,c).pipe(Object(d.a)(e=>new Yn(e,!0)),Object(u.a)(()=>this.toaster.success(this.translate.instant("INVOICES.MESSAGES.CREATE_SUCCESS")),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("INVOICES.MESSAGES.CREATE_FAIL"))}))}editInvoice(e,t){const n=this.workspaceService.getDefaultWorkspaceId(),i=e.toApiParameters();return t&&(i.clientId=e.clientId),this.http.put(`/workspaces/${n}/invoices/${e.id}`,i).pipe(Object(d.a)(e=>new Yn(e,!0)),Object(u.a)(()=>this.toaster.success(this.translate.instant("INVOICES.MESSAGES.EDIT_SUCCESS")),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("INVOICES.MESSAGES.EDIT_FAIL"))}))}markAs(e,t){const n=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${n}/invoices/${e}/status`,{invoiceStatus:t}).pipe(Object(u.a)(e=>{this.toaster.success(this.translate.instant("INVOICES.MESSAGES.CHANGE_STATUS_SUCCESS"))},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("INVOICES.MESSAGES.CHANGE_STATUS_FAIL"))}))}deleteInvoice(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`/workspaces/${t}/invoices/${e}`).pipe(Object(u.a)(e=>{this.toaster.success(this.translate.instant("INVOICES.MESSAGES.DELETE_SUCCESS"))},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("INVOICES.MESSAGES.DELETE_FAIL"))}))}importTime(e,t){var n;const i=this.workspaceService.getDefaultWorkspaceId(),s=e.displayItems===Kn.DETAILED&&(null===(n=e.fieldsForDetailed)||void 0===n?void 0:n.length)?e.fieldsForDetailed:null;return this.http.put(`/workspaces/${i}/invoices/${t}/import`,{from:e.from,to:e.to,projectsFilter:e.projectsFilter,groupEntries:e.displayItems,primaryGroupBy:e.firstLevelGrouping,secondaryGroupBy:e.secondLevelGrouping,roundEntries:e.roundEntries,fieldsForDetailed:s,includeExpenses:e.includeExpenses,expensesGroupType:e.expensesGroupType,expensesGroupBy:e.displayItemsForExpenses===ei.DETAILED?ei.PROJECT:e.displayItemsForExpenses,expenseDescriptionConfig:e.expensesForDetailed}).pipe(Object(d.a)(e=>new Yn(e,!0)),Object(u.a)(()=>this.toaster.success(this.translate.instant("INVOICES.MESSAGES.IMPORT_SUCCESS")),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("INVOICES.MESSAGES.IMPORT_FAIL"))}))}downloadInvoicePdf(e,t){const n=this.workspaceService.getDefaultWorkspaceId(),i=navigator.languages&&navigator.languages[0]||navigator.language||"",s=(new m.h).append("userLocale",i.replace(/\-/g,"_"));this.download(`/workspaces/${n}/invoices/${e}/export`,t,s)}download(e,t,n,i="application/pdf"){this.loader.show(this.translate.instant("INVOICES.SHARED.DOWNLOAD_AS",{value:t}),null,{enableClose:!0}).pipe(Object(Pe.a)(this.unsubscribe$),Object(Zt.a)(e=>e)).subscribe(()=>window.stop()),this.http.get(e,{params:n,responseType:"blob"}).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{const n=new Blob([e],{type:i||e.type});this.loader.hide(),Object($n.b)(n,t)},e=>{var t;this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("GLOBAL.DOWNLOAD_FAIL_MESSAGE")),this.loader.hide()})}createInvoiceItem(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.post(`/workspaces/${t}/invoices/${e}/invoiceItem`,null).pipe(Object(d.a)(e=>new Zn(e,!0)),Object(u.a)(e=>{this.toaster.success(this.translate.instant("INVOICES.MESSAGES.CREATE_ITEM_SUCCESS"))},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("INVOICES.MESSAGES.CREATE_ITEM_FAIL"))}))}editInvoiceItem(e,t){const n=this.workspaceService.getDefaultWorkspaceId(),i=t.toApiParameters(),s=new p.a;return this.http.put(`/workspaces/${n}/invoices/${e}/invoiceItem/${t.order}`,i).pipe(Object(d.a)(e=>new Yn(e,!0)),Object(u.a)(()=>this.toaster.success(this.translate.instant("INVOICES.MESSAGES.EDIT_ITEM_SUCCESS")),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("INVOICES.MESSAGES.EDIT_ITEM_FAIL"))})).subscribe(e=>{this.invoice$.next({action:"edit",invoice:e}),s.next(e)},e=>s.error(e)),s}deleteInvoiceItem(e,t){const n=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`/workspaces/${n}/invoices/${e}/invoiceItem/${t}`).pipe(Object(d.a)(e=>new Yn(e,!0)),Object(u.a)(e=>{this.invoice$.next({action:"delete",invoice:e}),this.toaster.success(this.translate.instant("INVOICES.MESSAGES.DELETE_ITEM_SUCCESS"))},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("INVOICES.MESSAGES.DELETE_ITEM_FAIL"))}))}bulkEntriesInvoiceStatus(e,t){const n=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${n}/timeEntries/invoiced`,{timeEntries:e,invoiced:t}).pipe(Object(d.a)(()=>null),Object(u.a)(()=>this.toaster.success(this.translate.instant("INVOICES.MESSAGES.CHANGE_SUCCESS")),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("INVOICES.MESSAGES.CHANGE_FAIL"))}))}bulkExpenseEntriesInvoiceStatus(e,t){const n=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${n}/expenses/invoiced`,{expenses:e,invoiced:t}).pipe(Object(d.a)(()=>null),Object(u.a)(()=>this.toaster.success(this.translate.instant(t?"EXPENSES.EDIT.MODAL.INVOICED":"EXPENSES.EDIT.MODAL.UNINVOICED")),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("INVOICES.MESSAGES.CHANGE_FAIL"))}))}getInvoiceSettings(){const e=this.workspaceService.getDefaultWorkspaceId();return this.http.get(`/workspaces/${e}/invoices/settings`).pipe(Object(d.a)(e=>new Jn(e)),Object(u.a)(()=>{},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("INVOICES.MESSAGES.SETTING_FAILED"))}))}editInvoiceSettings(e){const t=this.workspaceService.getDefaultWorkspaceId(),n={tax:Object(sn.C)(e.defaults.tax,100),tax2:Object(sn.C)(e.defaults.tax2,100),subject:e.defaults.subject,notes:e.defaults.notes,taxType:e.defaults.taxType,dueDays:e.defaults.dueDays,itemTypeId:e.defaults.itemTypeId,defaultImportExpenseItemTypeId:e.defaults.defaultImportExpenseItemTypeId,defaultImportTimeItemTypeId:e.defaults.defaultImportTimeItemTypeId};return this.http.put(`/workspaces/${t}/invoices/settings`,{labels:e.labels,defaults:n,exportFields:e.exportFields}).pipe(Object(d.a)(e=>null),Object(u.a)(()=>this.toaster.success(this.translate.instant("INVOICES.MESSAGES.EDIT_SETTING_SUCCESS")),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("INVOICES.MESSAGES.EDIT_SETTING_FAIL"))}))}reorderInvoiceItem(e,t,n){const i=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${i}/invoices/${e}/invoiceItem/order`,{currentPosition:t,newPosition:n}).pipe(Object(d.a)(e=>e.map(e=>new Zn(e,!0))),Object(u.a)(()=>this.toaster.success(this.translate.instant("INVOICES.ITEM_ORDER_CHANGED")),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translate.instant("INVOICES.ITEM_ORDER_CANT_BE_CHANGED"))}))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(m.c),s.fc(r.a),s.fc(Hn.a),s.fc(l.a),s.fc(g.f))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var ni=n("2rWG"),ii=n("sbmM"),si=n("qUN8");function ci(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",7),s.Xb(1,"div",8),s.Xb(2,"input",9),s.jc("ngModelChange",(function(n){return s.Oc(e),t.$implicit.value=n})),s.Wb(),s.Xb(3,"label",10),s.Zc(4),s.oc(5,"translate"),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit,n=t.index,i=s.nc(2);s.Cb(2),s.wc("disabled",0==n&&i.disableFirst)("ngModel",e.value)("id",n),s.Cb(1),s.wc("for",n),s.Cb(1),s.bd(" ",i.showPlaceholder?s.pc(5,5,e.placeholder):s.pc(6,7,e.label)," ")}}function ai(e,t){if(1&e&&(s.Xb(0,"div",3),s.Xb(1,"div",4),s.Xc(2,ci,7,9,"div",5),s.Sb(3,"span",6),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.wc("ngForOf",e.list)}}var oi=function(e){return e.TEXT="TEXT",e.BUTTON="BUTTON",e}({});let ri=(()=>{class e{constructor(e,t){this.translate=e,this.cd=t,this.configClasses={[oi.BUTTON]:"cl-dropdown-item-label cl-btn cl-btn-outline-light cl-w-100 cl-text-left cl-dropdown-toggle cl-cut-text pointer",[oi.TEXT]:"cl-dropdown-link-text"},this.type=oi.BUTTON,this.titlePrefix="",this.titleSufix="",this.verboseTitle=!1,this.lowercaseTitle=!0,this.showPlaceholder=!1,this.onChange=new s.n,this.unsubscribe$=new p.a}set list(e){this._list=e,this.listBackup=e.map(e=>new Un.a(e.value,e.label,e.placeholder)),this.title=this.generateTitle()}get list(){return this._list}ngOnInit(){this.classes=this.configClasses[this.type]}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}generateTitle(){return this.list.filter(e=>e.value).length!==this.list.length||this.verboseTitle?this.lowercaseTitle?this.list.filter(e=>e.value).map(e=>this.translate.instant(e.label).toLowerCase()).join(", "):this.list.filter(e=>e.value).map(e=>this.translate.instant(e.label)).join(", "):this.translate.instant("GLOBAL.ALL_LABEL").toLowerCase()}onDropdownClose(){if(this.title=this.generateTitle(),!this.list.filter(e=>e.value).length&&(this.list.forEach(e=>e.value=!0),this.title=this.generateTitle()),Un.a.areSame(this.listBackup,this.list))return;const e=this.list.map(e=>new Un.a(e.value,e.label,e.placeholder));this.onChange.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(g.f),s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["dropdown-checkbox-list"]],inputs:{disableFirst:"disableFirst",list:"list",type:"type",titlePrefix:"titlePrefix",titleSufix:"titleSufix",verboseTitle:"verboseTitle",lowercaseTitle:"lowercaseTitle",showPlaceholder:"showPlaceholder"},outputs:{onChange:"onChange"},decls:6,vars:8,consts:[["dropdownKey","",1,"cl-dropdown",3,"onClose"],["tabindex","0","dropdownKeyButton","",3,"ngClass"],["class","cl-dropdown-menu","openUpAtBottom","",4,"dropdownKeyContent"],["openUpAtBottom","",1,"cl-dropdown-menu"],[1,"cl-scroll-area"],["class","cl-dropdown-item cl-dropdown-item-checkbox",4,"ngFor","ngForOf"],["dropdownClose","","tabindex","0"],[1,"cl-dropdown-item","cl-dropdown-item-checkbox"],[1,"cl-custom-control","cl-custom-checkbox","cl-cut-text-wrapper"],["type","checkbox",1,"cl-custom-control-input",3,"disabled","ngModel","id","ngModelChange"],[1,"cl-custom-control-label","cl-cut-text",3,"for"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.jc("onClose",(function(){return t.onDropdownClose()})),s.Xb(1,"span",1),s.Zc(2),s.oc(3,"translate"),s.oc(4,"translate"),s.Wb(),s.Xc(5,ai,4,1,"div",2),s.Wb()),2&e&&(s.Cb(1),s.wc("ngClass",t.classes),s.Cb(1),s.dd(" ",s.pc(3,4,t.titlePrefix)," ",t.title," ",s.pc(4,6,t.titleSufix)," "))},directives:[ni.a,ii.a,i.r,si.a,i.t,v.a,v.s,v.v],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var li=n("KAau"),bi=n("rsZi");function di(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"th",2),s.Xb(2,"a",3),s.jc("click",(function(){return s.Oc(e),s.nc().changeSort("ID")})),s.Zc(3),s.Wb(),s.Wb(),s.Xb(4,"th",4),s.Xb(5,"div",5),s.Xb(6,"div",6),s.Zc(7),s.Wb(),s.Wb(),s.Wb(),s.Xb(8,"th",7),s.Xb(9,"div",5),s.Xb(10,"div",6),s.Zc(11),s.Wb(),s.Wb(),s.Wb(),s.Xb(12,"th",8),s.Xb(13,"div",5),s.Xb(14,"div",9),s.Zc(15),s.Wb(),s.Wb(),s.Wb(),s.Xb(16,"th",10),s.Xb(17,"div",5),s.Xb(18,"div",11),s.Zc(19),s.Wb(),s.Wb(),s.Wb(),s.Xb(20,"th",12),s.Xb(21,"div",11),s.Zc(22),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc();s.Cb(2),s.Hb("cl-up","ID"==e.sortColumn&&"ASCENDING"==e.sortOrder)("cl-down","ID"==e.sortColumn&&"DESCENDING"==e.sortOrder),s.Cb(1),s.bd(" ",e.labels[0]," "),s.Cb(4),s.ad(e.labels[1]),s.Cb(4),s.ad(e.labels[2]),s.Cb(4),s.ad(e.labels[3]),s.Cb(4),s.ad(e.labels[4]),s.Cb(3),s.ad(e.labels[5])}}function ui(e,t){if(1&e){const e=s.Yb();s.Xb(0,"th",13),s.Xb(1,"div",14),s.Xb(2,"div",6),s.Zc(3),s.Wb(),s.Xb(4,"a",15),s.jc("click",(function(){return s.Oc(e),s.nc().expandAll()})),s.Xb(5,"span",16),s.Sb(6,"img",17),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.bd(" ",e.labels[0]," "),s.Cb(3),s.wc("src",e.isExpandAll?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",s.Qc)}}var pi=function(e){return e.ID="ID",e.CLIENT="CLIENT",e.DUE="DUE",e.AMOUNT="AMOUNT",e}({});let hi=(()=>{class e{constructor(e,t){this.router=e,this.uiSettingsService=t,this.onExpandAll=new s.n,this.onSortChange=new s.n,this.isExpandAll=!1}ngOnInit(){this.getSort()}expandAll(){this.isExpandAll=!this.isExpandAll,this.onExpandAll.emit(this.isExpandAll)}getSort(){const e=this.uiSettingsService.getSettings(xn.b.INVOICE_SORT)||{};this.sortColumn=pi[e.sortColumn]||pi.ID,this.sortOrder=bi.a[e.sortOrder]||bi.a.ASCENDING}changeSort(e){e==this.sortColumn?this.sortOrder=this.sortOrder==bi.a.ASCENDING?bi.a.DESCENDING:bi.a.ASCENDING:(this.sortColumn=e,this.sortOrder=bi.a.ASCENDING),this.emit()}emit(){const e={sortOrder:this.sortOrder,sortColumn:this.sortColumn};this.uiSettingsService.setSettings(xn.b.INVOICE_SORT,e),this.onSortChange.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.d),s.Rb(xn.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["invoice-table-header"],["","invoice-table-header",""]],inputs:{isDesktop:"isDesktop",labels:"labels"},outputs:{onExpandAll:"onExpandAll",onSortChange:"onSortChange"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["mobileTemplate",""],[1,"cl-h6","cl-mb-0","cl-pl-lg-3","cl-responsive-table-td-0"],[1,"cl-text-gray-6","cl-sort-by","cl-d-none","cl-d-lg-inline-flex",3,"click"],[1,"cl-d-none","cl-d-lg-table-cell","cl-responsive-table-td-1"],[1,"cl-ml-lg-custom-n2"],[1,"cl-h5","cl-mb-0"],[1,"cl-d-none","cl-d-lg-table-cell","cl-responsive-table-td-2"],[1,"cl-d-none","cl-d-lg-table-cell","cl-responsive-table-td-3"],[1,"cl-h5","cl-mb-0","cl-text-left"],[1,"cl-d-none","cl-d-lg-table-cell","cl-responsive-table-td-4"],[1,"cl-h5","cl-mb-0","cl-d-lg-none"],[1,"cl-d-none","cl-d-lg-table-cell","cl-lh-0","cl-responsive-table-td-5"],[1,"cl-pl-lg-3"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-ml-auto",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"]],template:function(e,t){if(1&e&&(s.Xc(0,di,23,10,"ng-container",0),s.Xc(1,ui,7,2,"ng-template",null,1,s.Yc)),2&e){const e=s.Lc(2);s.wc("ngIf",t.isDesktop)("ngIfElse",e)}},directives:[i.u],encapsulation:2}),e})();const mi=[{id:jn.a.PAID,label:"INVOICES.SHARED.PAID_LABEL"},{id:jn.a.UNSENT,label:"INVOICES.SHARED.UNSENT_LABEL"},{id:jn.a.SENT,label:"INVOICES.SHARED.SENT_LABEL"},{id:jn.a.VOID,label:"INVOICES.SHARED.VOID_LABEL"}];function gi(e){return mi.find(t=>t.id===e).label}var Ei=n("5SNR"),fi=n("6GAr"),Si=n("AHJ+"),Ci=n("TxvX"),Ai=n("rg2B"),Oi=n("Lwft");function vi(e,t){1&e&&s.Tb(0)}function Ti(e,t){if(1&e&&(s.Xb(0,"div",10),s.Xb(1,"a",11),s.Xb(2,"span"),s.Zc(3),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.yc("routerLink","/invoices/",e.invoice.id,""),s.Cb(2),s.ad(e.invoice.number)}}function Ii(e,t){if(1&e&&(s.Xb(0,"a",12),s.Xb(1,"div",13),s.Xb(2,"span",14),s.Zc(3),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.yc("routerLink","/invoices/",e.invoice.id,""),s.Cb(3),s.bd(" ",e.invoice.clientName||"-"," ")}}function wi(e,t){if(1&e&&(s.Xb(0,"a",12),s.Xb(1,"div",13),s.Xb(2,"span",14),s.Zc(3),s.oc(4,"formatDateSimple"),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.yc("routerLink","/invoices/",e.invoice.id,""),s.Cb(3),s.bd(" ",s.pc(4,2,e.invoice.dueDate)," ")}}function Li(e,t){if(1&e&&(s.Xb(0,"a",12),s.Xb(1,"div",15),s.Xb(2,"b",14),s.Zc(3),s.oc(4,"roundIfWholeNumber"),s.oc(5,"centsToDollars"),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.yc("routerLink","/invoices/",e.invoice.id,""),s.Cb(3),s.cd(" ",s.pc(4,3,s.pc(5,5,e.invoice.amount))," ",e.invoice.currency," ")}}function Ri(e,t){if(1&e&&(s.Xb(0,"a",12),s.Xb(1,"div",13),s.Xb(2,"span",16),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.yc("routerLink","/invoices/",e.invoice.id,""),s.Cb(2),s.wc("ngClass","cl-badge-status-"+e.invoice.color),s.Cb(1),s.bd(" ",s.pc(4,3,e.invoiceStatusLabel)," ")}}function yi(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",25),s.jc("keyup.enter",(function(){s.Oc(e);const n=t.$implicit;return s.nc(3).markAs(n.id)}))("keyup.space",(function(){s.Oc(e);const n=t.$implicit;return s.nc(3).markAs(n.id)}))("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc(3).markAs(n.id)})),s.Zc(1),s.oc(2,"translate"),s.oc(3,"lowercase"),s.oc(4,"translate"),s.Wb()}if(2&e){const e=t.$implicit;s.Cb(1),s.cd(" ",s.pc(2,2,"INVOICES.SHARED.MARK_AS")," ",s.pc(3,4,s.pc(4,6,e.label))," ")}}function _i(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",23),s.Xb(1,"list-items"),s.Xc(2,yi,5,8,"a",24),s.Xb(3,"a",25),s.jc("keyup.enter",(function(){return s.Oc(e),s.nc(2).downloadPdf()}))("keyup.space",(function(){return s.Oc(e),s.nc(2).downloadPdf()}))("click",(function(){return s.Oc(e),s.nc(2).downloadPdf()})),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"a",25),s.jc("keyup.enter",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(16);return t.openModal(n)}))("keyup.space",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(16);return t.openModal(n)}))("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(16);return t.openModal(n)})),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.wc("ngForOf",e.availableStatuses),s.Cb(2),s.bd(" ",s.pc(5,3,"SUBSCRIPTION_TABS.INVOICES.DOWNLOAD_INVOICE_BTN")," "),s.Cb(3),s.bd(" ",s.pc(8,5,"GLOBAL.DELETE_BTN")," ")}}function ki(e,t){1&e&&(s.Xb(0,"div",17),s.Xb(1,"div",18),s.Sb(2,"img",19),s.Wb(),s.Xc(3,_i,9,7,"div",20),s.Sb(4,"span",21,22),s.Wb())}function Wi(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",26),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().confirmDelete(n)}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Zc(3),s.oc(4,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,5,"INVOICES.TABLE.DELETE_MODAL_HEADER"))("inProgress",e.inProgress)("isDanger",!0)("btnText",s.pc(2,7,"GLOBAL.DELETE_BTN")),s.Cb(3),s.bd(" ",s.pc(4,9,"INVOICES.TABLE.DELETE_MODAL_TEXT"),". ")}}const Xi=function(e){return{labels:e}},Ni=function(e,t,n,i,s,c){return[e,t,n,i,s,c]};let Di=(()=>{class e{constructor(e,t,n){this.cd=e,this.modalService=t,this.invoiceService=n,this.onDelete=new s.n,this.InvoiceStatus=jn.a,this.unsubscribe$=new p.a}ngOnInit(){this.availableStatuses=this.invoice.getAvailableStatuses(),this.invoiceStatusLabel=gi(this.invoice.status)}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}ngAfterViewInit(){this.cd.detectChanges()}openModal(e){this.modalService.open(e,{centered:!0})}confirmDelete(e){this.inProgress=!0,this.invoiceService.deleteInvoice(this.invoice.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{e.close(),this.inProgress=!1,this.onDelete.emit()},()=>{this.inProgress=!1})}markAs(e){this.inProgress||(this.inProgress=!0,this.invoiceService.markAs(this.invoice.id,e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.inProgress=!1,this.invoice.status=e,this.availableStatuses=this.invoice.getAvailableStatuses(),this.invoiceStatusLabel=gi(this.invoice.status),this.cd.markForCheck()},()=>{this.inProgress=!1}))}downloadPdf(){const e=this.invoice.generatePdfFilename(this.invoice.clientName);this.invoiceService.downloadInvoicePdf(this.invoice.id,e)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.h),s.Rb(w.q),s.Rb(ti))},e.\u0275cmp=s.Lb({type:e,selectors:[["invoice-table-row"],["","invoice-table-row",""]],inputs:{isDesktop:"isDesktop",labels:"labels",expandAll:"expandAll",invoice:"invoice"},outputs:{onDelete:"onDelete"},decls:17,vars:14,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cl-d-none",3,"isDesktop","templates","isExpanded"],["responsive",""],["col1",""],["col2",""],["col3",""],["col4",""],["col5",""],["col6",""],["deleteModal",""],[1,"cl-d-inline-flex","cl-cut-text-wrapper","cl-w-100","cl-py-0","cl-py-lg-custom-2","cl-pr-3"],[1,"cl-cut-text","cl-project-name","cl-project-name-colored","cl-brown","cl-text-dark","cl-text-decoration-none",3,"routerLink"],[1,"cl-component-divided-left","cl-d-flex","cl-text-dark","cl-text-decoration-none",3,"routerLink"],[1,"cl-cut-text-wrapper","cl-w-100","cl-d-flex","cl-justify-content-center","cl-justify-content-lg-start"],[1,"cl-cut-text"],[1,"cl-cut-text-wrapper","cl-w-100","cl-d-flex","cl-justify-content-center","cl-justify-content-lg-end"],[1,"cl-badge-approve","cl-text-capitalize",3,"ngClass"],["dropdownKey","","tabCell","",1,"cl-dropdown"],["dropdownKeyButton","","tabindex","0",1,"pointer","cl-non-selectable","cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow"],["src","assets/images/ui-icons/menu-dots-vertical.svg"],["openUpAtBottom","","class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["tabFocus","","tabindex","0"],["tabFocusDuplicate",""],["openUpAtBottom","",1,"cl-dropdown-menu","cl-dropdown-menu-right"],["class","cl-dropdown-item","tabindex","-1","clickCloseDropdown","",3,"keyup.enter","keyup.space","click",4,"ngFor","ngForOf"],["tabindex","-1","clickCloseDropdown","",1,"cl-dropdown-item",3,"keyup.enter","keyup.space","click"],[3,"title","inProgress","isDanger","btnText","confirmed","close"]],template:function(e,t){if(1&e&&(s.Xc(0,vi,1,0,"ng-container",0),s.Sb(1,"responsive-row",1,2),s.Xc(3,Ti,4,2,"ng-template",null,3,s.Yc),s.Xc(5,Ii,4,2,"ng-template",null,4,s.Yc),s.Xc(7,wi,5,4,"ng-template",null,5,s.Yc),s.Xc(9,Li,6,7,"ng-template",null,6,s.Yc),s.Xc(11,Ri,5,5,"ng-template",null,7,s.Yc),s.Xc(13,ki,6,0,"ng-template",null,8,s.Yc),s.Xc(15,Wi,5,11,"ng-template",null,9,s.Yc)),2&e){const e=s.Lc(2),n=s.Lc(4),i=s.Lc(6),c=s.Lc(8),a=s.Lc(10),o=s.Lc(12),r=s.Lc(14);s.wc("ngTemplateOutlet",e.template)("ngTemplateOutletContext",s.Bc(5,Xi,t.labels)),s.Cb(1),s.wc("isDesktop",t.isDesktop)("templates",s.Gc(7,Ni,n,i,c,a,o,r))("isExpanded",t.expandAll)}},directives:[i.B,Ei.a,k.g,i.r,ni.a,ii.a,si.a,fi.a,i.t,Si.a],pipes:[Ci.a,Ai.a,Oi.a,g.e,i.q],encapsulation:2,changeDetection:0}),e})();var Pi=n("aDua"),Mi=n("Jmk/"),Bi=n("AY7I"),Ui=n("6t6a"),Gi=n("Fruv"),xi=n("Y9WU"),Fi=n("SvJf"),ji=n("kKK/");const Zi=["dropdown"],Vi=["dueDateComponent"];function Yi(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",18),s.Xb(1,"div",19),s.Xb(2,"dropdown-items",20,21),s.jc("onOpen",(function(){s.Oc(e);const t=s.nc();return 1===t.clientQuery.page&&t.fetchClients()}))("loadMore",(function(){return s.Oc(e),s.nc().fetchClients()}))("onFilterOptionChange",(function(t){return s.Oc(e),s.nc().onFilterChange(t)}))("onChanged",(function(t){return s.Oc(e),s.nc().onClientSelect(t)})),s.oc(4,"translate"),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.wc("enableSearch",!0)("offlineSearch",!1)("filterOptions",e.clientFilterOptions)("filterQuery",e.clientQuery)("placeholder",s.pc(4,10,"INVOICES.SHARED.SEARCH")+" "+e.clientLabel)("title",e.clientLabel)("list",e.clients)("itemLabel",e.clientName||s.pc(5,12,"SHARED_MODULES.CUSTOM_FIELD.TYPE_SELECT_LABEL")+" "+e.clientLabel)("value",e.form.value.clientId)("type","STANDARD")}}let Hi=(()=>{class e{constructor(e,t,n,i,c,a,o,r){this.workspaceService=e,this.clientService=t,this.formBuilder=n,this.invoiceService=i,this.cd=c,this.router=a,this.translate=o,this.analyticsService=r,this.onClose=new s.n,this.isSavingChange=new s.n,this.onSave=new s.n,this.clients=[],this.clientFilterOptions=on.n,this.clientQuery={},this.unsubscribe$=new p.a}set invoiceSettings(e){e&&(this._invoiceSettings=e)}get invoiceSettings(){return this._invoiceSettings}ngOnInit(){var e,t,n,i,s;this.isEditing=!!(null===(e=this.invoice)||void 0===e?void 0:e.id),this.invoice=this.invoice?Yn.clone(this.invoice):this.invoice,this.clientWasDeleted=this.isEditing&&!this.invoice.clientId;const c=this.workspaceService.getLocalDefaultWorkspace(),a=(null===(t=this.invoice)||void 0===t?void 0:t.issuedDate)||this.toUtcDate(ke().toISOString()),o=(null===(n=this.invoice)||void 0===n?void 0:n.dueDate)||this.toUtcDate(ke(a).add(this.invoiceSettings.defaults.dueDays,"d").toISOString()),r=(null===(i=this.invoice)||void 0===i?void 0:i.clientId)||null,l=this.generateInvoiceNumber();this.form=this.formBuilder.group({clientId:[r,[v.G.required]],currency:[(null===(s=this.invoice)||void 0===s?void 0:s.currency)||c.hourlyRate.currency||"",[Bi.a.required,Bi.a.minLength(1),Bi.a.maxLength(100)]],number:[l,[Bi.a.required]],issuedDate:[a,[v.G.required]],dueDate:[o,[v.G.required]]});const b=this.workspaceService.generateClientLabel(c.projectGroupingLabel)||this.translate.instant("GLOBAL.CLINENT_LABEL").toLowerCase();this.clientLabel=Object(sn.k)(b),r||(this.clients=[new Un.a(null,this.translate.instant("GLOBAL.SELECT_LABEL",{label:b}))]);const{label:d}=Object(_e.b)(ke(o),ke(a));this.dueDateLabel=d,this.resetQuery()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}toUtcDate(e){const t=ke().utcOffset();return ke.utc(e).add(t,"m").startOf("day").toISOString()}onFilterChange(e){this.resetQuery(),this.clientQuery.name=e.searchTerm,this.clientQuery.status=e.status,this.clientsReachedLimit=!1,this.fetchClients()}resetQuery(){this.clientQuery={page:1,limit:In.f,name:"",sortColumn:"name",status:Rn.a.ACTIVE},this.clientsReachedLimit=!1}generateInvoiceNumber(){if(this.isEditing)return this.invoice.number;let e=this.lastInvoiceId||"Invoice";if(e){let t=e.length;for(;Object(sn.u)(e[t-1]);)e=e.slice(0,-1),t--}return`${e}${(this.totalCount||0)+1}`}submitForm(){this.saveInProgress||(this.isSavingChange.emit(!0),this.isEditing?this.editInvoice():this.createInvoice())}editInvoice(){const e=this.invoice.clientId!==this.form.value.clientId;this.invoice.currency=this.form.value.currency,this.invoice.number=this.form.value.number,this.invoice.issuedDate=this.form.value.issuedDate,this.invoice.dueDate=this.form.value.dueDate,this.invoice.clientId=this.form.value.clientId,this.invoiceService.editInvoice(this.invoice,e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isSavingChange.emit(!1),this.onSave.emit(e)},()=>{this.isSavingChange.emit(!1)})}createInvoice(){const e=Un.a.getLabelOf(this.clients,this.form.value.clientId);this.invoiceService.createInvoice(this.form.value).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{t.clientName=e,t.status=jn.a.UNSENT,this.isSavingChange.emit(!1),this.onSave.emit(t)},()=>{this.isSavingChange.emit(!1)})}closeModal(){this.onClose.emit(!1)}onClientSelect(e){this.form.patchValue({clientId:e}),e?(this.clientName=this.clients.find(t=>t.value===e).label,this.clients=this.clients.filter(e=>!!e.value)):this.clientName=""}onIssuedDateChange({date:e}){this.form.patchValue({issuedDate:e}),this.updateDueDate()}onDueDateChange({label:e,date:t}){if(ke(t).isBefore(ke(this.form.value.issuedDate)))return console.warn("*** Due date is before issue date ***"),void this.dueDateComponent.applyDate(this.form.value.dueDate);this.dueDateLabel=e,this.form.patchValue({dueDate:t})}fetchClients(){if(this.clientsReachedLimit)return;const e={name:this.clientQuery.name,status:this.clientQuery.status,page:this.clientQuery.page,limit:this.clientQuery.limit};this.clientService.getClientList(e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{1===e.page&&(this.clients=[]),this.clientsReachedLimit=t.length<In.j,this.clients=[...this.clients,...t.map(e=>new Un.a(e.id,e.name))],this.clientQuery.page++,this.cd.markForCheck(),this.dropdownItems&&this.dropdownItems.triggerDetection()})}updateDueDate(){if(this.dueDateLabel){const e=this.form.value.issuedDate;if(this.dueDateLabel===Ui.a.AFTER_10){const t=ke.utc(e).add(10,"days").toISOString();this.onDueDateChange({label:this.dueDateLabel,date:t})}else if(this.dueDateLabel===Ui.a.AFTER_15){const t=ke.utc(e).add(15,"days").toISOString();this.onDueDateChange({label:this.dueDateLabel,date:t})}else if(this.dueDateLabel===Ui.a.AFTER_30){const t=ke.utc(e).add(30,"days").toISOString();this.onDueDateChange({label:this.dueDateLabel,date:t})}else if(this.dueDateLabel===Ui.a.AFTER_60){const t=ke.utc(e).add(60,"days").toISOString();this.onDueDateChange({label:this.dueDateLabel,date:t})}else if(this.dueDateLabel===Ui.a.AFTER_90){const t=ke.utc(e).add(90,"days").toISOString();this.onDueDateChange({label:this.dueDateLabel,date:t})}else if(this.dueDateLabel===Ui.a.UPON_RECEIPT){const t=ke.utc(e).toISOString();this.onDueDateChange({label:this.dueDateLabel,date:t})}}else ke(this.form.value.dueDate).isBefore(ke(this.form.value.issuedDate))&&this.onDueDateChange({label:Ui.a.UPON_RECEIPT,date:this.form.value.issuedDate})}addEventToDataLayer(e){var t;this.analyticsService.addEvent(new Fi.a({event:"change",value:null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value,section:"Invoices",section2:"Create invoice",section3:"Currency"}))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(Mi.a),s.Rb(v.f),s.Rb(ti),s.Rb(s.h),s.Rb(k.d),s.Rb(g.f),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["create-invoice"]],viewQuery:function(e,t){var n;1&e&&(s.gd(Zi,!0),s.gd(Vi,!0)),2&e&&(s.Kc(n=s.kc())&&(t.dropdownItems=n.first),s.Kc(n=s.kc())&&(t.dueDateComponent=n.first))},inputs:{invoice:"invoice",saveInProgress:"saveInProgress",totalCount:"totalCount",lastInvoiceId:"lastInvoiceId",invoiceSettings:"invoiceSettings"},outputs:{onClose:"onClose",isSavingChange:"isSavingChange",onSave:"onSave"},decls:39,vars:33,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],["novalidate","",3,"formGroup","ngSubmit"],[1,"cl-modal-body"],["class","cl-form-row cl-mb-2",4,"ngIf"],[1,"cl-form-group"],["formControlName","currency","type","text","ngbAutofocus","","autocomplete","off",1,"cl-form-control",3,"blur"],["formControlName","number","type","text","autocomplete","off",1,"cl-form-control"],[1,"cl-form-row"],[1,"cl-col-sm-6"],[3,"isUtc","hideRanges","date","onDateSelect"],[3,"isUtc","cssClass","minDate","referenceDay","date","invoiceDate","onDateSelect"],["dueDateComponent",""],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"],[1,"cl-form-row","cl-mb-2"],[1,"cl-col-sm-12","cl-text-break"],[3,"enableSearch","offlineSearch","filterOptions","filterQuery","placeholder","title","list","itemLabel","value","type","onOpen","loadMore","onFilterOptionChange","onChanged"],["dropdown",""]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.closeModal()})),s.Xb(5,"span"),s.Sb(6,"img",3),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"form",4),s.jc("ngSubmit",(function(){return t.submitForm()})),s.Xb(8,"div",5),s.Xc(9,Yi,6,14,"div",6),s.Xb(10,"div",7),s.Xb(11,"label"),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xb(14,"input",8),s.jc("blur",(function(e){return t.addEventToDataLayer(e)})),s.Wb(),s.Wb(),s.Xb(15,"div",7),s.Xb(16,"label"),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Sb(19,"input",9),s.Wb(),s.Xb(20,"div",10),s.Xb(21,"div",11),s.Xb(22,"label"),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Xb(25,"datepicker-single-with-list",12),s.jc("onDateSelect",(function(e){return t.onIssuedDateChange(e)})),s.Wb(),s.Wb(),s.Xb(26,"div",11),s.Xb(27,"label"),s.Zc(28),s.oc(29,"translate"),s.Wb(),s.Xb(30,"datepicker-single-with-list",13,14),s.jc("onDateSelect",(function(e){return t.onDueDateChange(e)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(32,"div",15),s.Xb(33,"a",16),s.jc("click",(function(){return t.closeModal()})),s.Zc(34),s.oc(35,"translate"),s.Wb(),s.Xb(36,"button",17),s.Zc(37),s.oc(38,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,19,t.isEditing?"INVOICES.EDIT_HEADER":"INVOICES.SHARED.CREATE_INVOICE")),s.Cb(5),s.wc("formGroup",t.form),s.Cb(2),s.wc("ngIf",!t.isEditing||t.clientWasDeleted),s.Cb(3),s.ad(s.pc(13,21,"GLOBAL.CURRENCY_TITLE")),s.Cb(5),s.ad(s.pc(18,23,"GLOBAL.INVOICE_ID_LABEL")),s.Cb(6),s.ad(s.pc(24,25,"INVOICES.SHARED.ISSUE_DATE")),s.Cb(2),s.wc("isUtc",!0)("hideRanges",!0)("date",t.form.value.issuedDate),s.Cb(3),s.ad(s.pc(29,27,"INVOICES.SHARED.DUE_DATE")),s.Cb(2),s.wc("isUtc",!0)("cssClass","range-picker-visible")("minDate",t.form.value.issuedDate)("referenceDay",t.form.value.issuedDate)("date",t.form.value.dueDate)("invoiceDate",!0),s.Cb(4),s.ad(s.pc(35,29,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",t.saveInProgress||t.form.invalid),s.Cb(1),s.bd(" ",s.pc(38,31,t.isEditing?"GLOBAL.EDIT_LABEL":"GLOBAL.CREATE_LABEL")," "))},directives:[v.I,v.t,v.k,i.u,v.c,v.s,v.i,Gi.a,ji.a],pipes:[g.e],encapsulation:2}),e})();function $i(e,t){if(1&e&&(s.Sb(0,"message-entries",16),s.oc(1,"translate")),2&e){const e=s.nc();s.wc("title",s.pc(1,5,"INVOICES.NO_INVOICES_LABEL"))("subtitle",e.subtitle)("imagePath","assets/images/no_results_illustration.svg")("isError",e.isError)("loadInProgress",e.loadInProgress)}}function Ki(e,t){if(1&e){const e=s.Yb();s.Xb(0,"tr",25),s.jc("onDelete",(function(n){s.Oc(e);const i=t.index;return s.nc(2).removeInvoice(n,i)})),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc(2);s.wc("invoice",e)("isDesktop",n.isDesktop)("labels",n.labels)("expandAll",n.expandAll)}}function qi(e,t){if(1&e){const e=s.Yb();s.Xb(0,"pager",26),s.jc("pageChanged",(function(t){return s.Oc(e),s.nc(2).onPaginationChange(t)}))("limitChanged",(function(t){return s.Oc(e),s.nc(2).onPaginationChange(t)})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("page",e.page)("limit",e.pageSize)("total",e.totalCount)}}const zi=function(){return{count:2}};function Qi(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",17),s.Xb(2,"div",18),s.Xb(3,"span",19),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(6,"table",20),s.Xb(7,"thead"),s.Xb(8,"tr",21),s.jc("onExpandAll",(function(t){return s.Oc(e),s.nc().expandAllRows(t)}))("onSortChange",(function(t){return s.Oc(e),s.nc().sortChanged(t)})),s.Wb(),s.Wb(),s.Xb(9,"tbody"),s.Xc(10,Ki,1,4,"tr",22),s.Wb(),s.Wb(),s.Xb(11,"div",23),s.Xc(12,qi,1,3,"pager",24),s.Wb(),s.Ub()}if(2&e){const e=s.nc();s.Cb(4),s.ad(s.qc(5,5,"INVOICES.INVOICE",s.Ac(8,zi))),s.Cb(4),s.wc("isDesktop",e.isDesktop)("labels",e.labels),s.Cb(2),s.wc("ngForOf",e.invoices),s.Cb(2),s.wc("ngIf",e.totalCount>e.pageSize||e.pageSize>50)}}function Ji(e,t){if(1&e){const e=s.Yb();s.Xb(0,"create-invoice",27),s.jc("isSavingChange",(function(t){return s.Oc(e),s.nc().createInProgress=t}))("onSave",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().onInvoiceCreate(n),i.close()}))("onClose",(function(n){s.Oc(e);const i=t.$implicit;return!s.nc().createInProgress&&i.close(n)})),s.Wb()}if(2&e){const e=s.nc();s.wc("saveInProgress",e.createInProgress)("totalCount",e.totalCountPlaceholder)("lastInvoiceId",e.lastInvoiceId)("invoiceSettings",e.invoiceSettings)}}const es=function(){return{label:""}},ts=function(){return{count:1}};let ns=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r){this.cd=e,this.modalService=t,this.activatedRoute=n,this.browserService=i,this.invoiceService=s,this.uiSettingsService=c,this.router=a,this.workspaceService=o,this.translate=r,this.fetchDataDebouncer$=new p.a,this.unsubscribe$=new Fn.a}ngOnInit(){var e;const t=this.workspaceService.getLocalDefaultWorkspace(),n=(null===(e=this.workspaceService.generateClientLabel(t.projectGroupingLabel))||void 0===e?void 0:e.toLowerCase())||"client";this.labels=["Invoice Id",n,"Due on","Amount","Status","Edit"],this.getInvoiceSettings(),this.initTranslation(t),this.initParams(),this.fetchData(),this.setBrowserWidth(),this.subscribeToChanges()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}getInvoiceSettings(){this.invoiceService.getInvoiceSettings().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.invoiceSettings=e,this.createEnabled=!0,this.cd.detectChanges()})}initTranslation(e){var t;const n=(null===(t=this.workspaceService.generateClientLabel(e.projectGroupingLabel))||void 0===t?void 0:t.toLowerCase())||this.translate.instant("GLOBAL.CLINENT_LABEL").toLowerCase(),i=this.translate.instant(["GLOBAL.INVOICE_ID_LABEL","INVOICES.TABLE.DUE","GLOBAL.AMOUNT_LABEL","GLOBAL.STATUS_LABEL","GLOBAL.EDIT_LABEL"]);this.labels=Object.values(i),this.labels.splice(1,0,n),this.subtitleWithoutStatus=this.translate.instant("INVOICES.TABLE.SUBTITLE_WITHOUT_STATUS")}get subtitle(){if(this.statuses.length<3){const e=this.statuses.map(e=>e.toLowerCase()).join(" and ");return this.translate.instant("INVOICES.TABLE.SUBTITLE_WITH_STATUS",{status:e})}return this.subtitleWithoutStatus}subscribeToChanges(){this.fetchDataDebouncer$.pipe(Object(De.a)(400),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>this.fetchData())}initParams(){const e=this.activatedRoute.snapshot.queryParams||{},t=this.uiSettingsService.getSettings(xn.b.INVOICE_PARAMS)||{};this.page=Number(e.page)||1,this.pageSize=Number(e.pageSize)||Number(t.pageSize)||In.j;const n=this.uiSettingsService.getSettings(xn.b.INVOICE_SORT);this.sortColumn=(null==e?void 0:e.sortColumn)||(null==n?void 0:n.sortColumn)||"ID",this.sortOrder=(null==e?void 0:e.sortOrder)||(null==n?void 0:n.sortOrder)||"ASCENDING";let i=e.statuses||t.statuses||[];i=Array.isArray(i)?i:[i],i=i.filter(e=>!!jn.a[e]),this.statuses=i.length?i:[jn.a.PAID,jn.a.SENT,jn.a.UNSENT,jn.a.VOID],this.statusesCheckboxList=this.generateStatusesCheckboxes()}generateStatusesCheckboxes(){const e=[];for(const t in jn.a){const n=this.statuses.includes(jn.a[t]),i="INVOICES.SHARED.SHOW_LABEL";let s;switch(t){case jn.a.PAID:s="INVOICES.SHARED.PAID_LABEL";break;case jn.a.SENT:s="INVOICES.SHARED.SENT_LABEL";break;case jn.a.UNSENT:s="INVOICES.SHARED.UNSENT_LABEL";break;case jn.a.VOID:s="INVOICES.SHARED.VOID_LABEL"}const c=this.translate.instant(s),a=this.translate.instant(i,{label:c.toLowerCase()}),o=new Un.a(n,c,a);e.push(o)}return e}onStatusChange(e){this.statusesCheckboxList=e;const t=new Map([[jn.a.PAID,this.translate.instant("INVOICES.SHARED.PAID_LABEL")],[jn.a.SENT,this.translate.instant("INVOICES.SHARED.SENT_LABEL")],[jn.a.UNSENT,this.translate.instant("INVOICES.SHARED.UNSENT_LABEL")],[jn.a.VOID,this.translate.instant("INVOICES.SHARED.VOID_LABEL")]]);this.statuses=[jn.a.PAID,jn.a.SENT,jn.a.UNSENT,jn.a.VOID].filter(e=>Un.a.getValueOf(this.statusesCheckboxList,t.get(e))),this.setLocalStorageAndUrl(),this.fetchData()}expandAllRows(e){this.expandAll=e,this.cd.detectChanges()}sortChanged(e){this.sortColumn=e.sortColumn,this.sortOrder=e.sortOrder,this.fetchData()}openCreateModal(e){this.modalService.open(e,{beforeDismiss:()=>!this.createInProgress,centered:!0})}openInvoiceSettings(){this.router.navigate(["invoices/settings"])}onPaginationChange(e){this.page=e.page||this.page,this.pageSize=e.limit||this.pageSize,this.setLocalStorageAndUrl(),this.fetchDataDebouncer$.next()}setLocalStorageAndUrl(){const e={page:this.page,pageSize:this.pageSize,statuses:this.statuses};this.uiSettingsService.setSettings(xn.b.INVOICE_PARAMS,e);const t=this.router.createUrlTree([],{queryParams:e}),n=this.router.serializeUrl(t);this.router.navigateByUrl(n)}removeInvoice(e,t){this.invoices.splice(t,1)}fetchData(){const e={page:this.page,pageSize:this.pageSize,statuses:this.statuses,sortColumn:this.sortColumn,sortOrder:this.sortOrder};this.loadInProgress=!0,this.invoiceService.getInvoices(e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(({invoices:e,count:t})=>{var n;e.length||1==this.page||this.onPaginationChange({page:1}),this.invoices=e,this.totalCount=t,this.totalCountPlaceholder=t,this.lastInvoiceId=null===(n=e[e.length-1])||void 0===n?void 0:n.number,this.isError=!1,this.loadInProgress=!1,this.cd.detectChanges()},()=>{this.isError=!0,this.loadInProgress=!1,this.cd.markForCheck()})}onInvoiceCreate(e){this.invoices.unshift(e),this.totalCountPlaceholder++,this.lastInvoiceId=e.number,this.router.navigate(["/invoices",e.id])}setBrowserWidth(){this.browserService.isBreakpointLg$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e,this.cd.detectChanges()})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.h),s.Rb(w.q),s.Rb(k.a),s.Rb(Gn.a),s.Rb(ti),s.Rb(xn.a),s.Rb(k.d),s.Rb(l.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["invoice-list"]],decls:26,vars:25,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center"],[1,"cl-col-md-6","cl-mb-3","cl-mb-md-0"],[1,"cl-col-md-6"],[1,"cl-d-print-none","cl-d-flex","cl-flex-row","cl-justify-content-md-end","cl-align-items-center"],[3,"list","showPlaceholder","titlePrefix","titleSufix","onChange"],[1,"cl-d-flex","cl-align-items-center","cl-padding"],[1,"cl-btn","cl-btn-outline-light",3,"click"],["src","assets/nav-icons/settings.svg"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end"],[1,"cl-btn","cl-btn-primary",3,"disabled","click"],["noInvoicesTemplate",""],[4,"ngIf","ngIfElse"],["newInvoiceListModal",""],[3,"title","subtitle","imagePath","isError","loadInProgress"],[1,"cl-card","cl-border-bottom-0","cl-mb-0","cl-d-print-none"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],[1,"cl-invoice-list-table","cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6"],["invoice-table-header","",3,"isDesktop","labels","onExpandAll","onSortChange"],["invoice-table-row","",3,"invoice","isDesktop","labels","expandAll","onDelete",4,"ngFor","ngForOf"],[1,"cl-mt-3"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],["invoice-table-row","",3,"invoice","isDesktop","labels","expandAll","onDelete"],[3,"page","limit","total","pageChanged","limitChanged"],[3,"saveInProgress","totalCount","lastInvoiceId","invoiceSettings","isSavingChange","onSave","onClose"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"main",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"h1"),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xb(8,"div",5),s.Xb(9,"div",6),s.Xb(10,"dropdown-checkbox-list",7),s.jc("onChange",(function(e){return t.onStatusChange(e)})),s.oc(11,"translate"),s.oc(12,"lowercase"),s.oc(13,"translate"),s.Wb(),s.Xb(14,"div",8),s.Xb(15,"button",9),s.jc("click",(function(){return t.openInvoiceSettings()})),s.Sb(16,"img",10),s.Wb(),s.Wb(),s.Xb(17,"div",11),s.Xb(18,"button",12),s.jc("click",(function(){s.Oc(e);const n=s.Lc(25);return t.openCreateModal(n)})),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(21,$i,2,7,"ng-template",null,13,s.Yc),s.Xc(23,Qi,13,9,"ng-container",14),s.Wb(),s.Wb(),s.Xc(24,Ji,1,4,"ng-template",null,15,s.Yc)}if(2&e){const e=s.Lc(22);s.Cb(6),s.ad(s.qc(7,9,"INVOICES.INVOICE",s.Ac(22,zi))),s.Cb(4),s.wc("list",t.statusesCheckboxList)("showPlaceholder",!0)("titlePrefix",s.qc(11,12,"INVOICES.SHARED.SHOW_LABEL",s.Ac(23,es)))("titleSufix",s.pc(12,15,s.qc(13,17,"INVOICES.INVOICE",s.Ac(24,ts)))),s.Cb(8),s.wc("disabled",!t.createEnabled),s.Cb(1),s.bd(" ",s.pc(20,20,"GLOBAL.CREATE_LABEL")," "),s.Cb(4),s.wc("ngIf",null==t.invoices?null:t.invoices.length)("ngIfElse",e)}},directives:[ri,i.u,li.a,hi,i.t,Di,Pi.a,Hi],pipes:[g.e,i.q],encapsulation:2,changeDetection:0}),e})();var is=n("i/9y"),ss=n("j4ir"),cs=n("z6cu");class as{constructor(e){this._id=(null==e?void 0:e.id)||null,this._name=null==e?void 0:e.name,this._workspaceId=null==e?void 0:e.workspaceId}get id(){return this._id}get name(){return this._name}get workspaceId(){return this._workspaceId}set name(e){this._name=e}}let os=(()=>{class e{constructor(e,t,n,i){this.http=e,this.toaster=t,this.workspaceService=n,this.translateService=i,this.newItem=new p.a,this.updateItem=new p.a,this.deletedItem=new p.a}create(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.post(`/workspaces/${t}/invoices/itemType`,{name:e}).pipe(Object(d.a)(e=>(this.toaster.pop("success",this.translateService.instant("INVOICES.ITEM_TYPE.CREATE.MODAL.SUCCESS_MESSAGE")),{item:new as(e)})),Object(u.a)(e=>{this.newItem.next(e.item)},e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("INVOICES.ITEM_TYPE.CREATE.MODAL.FAILED_MESSAGE"))))}update(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.put(`/workspaces/${t}/invoices/itemType/${e.id}`,{name:e.name}).pipe(Object(d.a)(e=>(this.toaster.pop("success",this.translateService.instant("INVOICES.ITEM_TYPE.EDIT.MODAL.SUCCESS_MESSAGE")),{item:new as(e)})),Object(u.a)(e=>{this.updateItem.next(e.item)},e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("INVOICES.ITEM_TYPE.EDIT.MODAL.FAILED_MESSAGE"))))}getItemTypes(){const e=this.workspaceService.getDefaultWorkspaceId();return this.http.get(`/workspaces/${e}/invoices/itemType`).pipe(Object(d.a)(e=>({items:e.map(e=>new as(e))}),e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("INVOICES.ITEM_TYPE.GET.FAILED_MESSAGE"))))}delete(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`/workspaces/${t}/invoices/itemType/${e.id}`).pipe(Object(u.a)(t=>{this.deletedItem.next(e),this.toaster.pop("success",this.translateService.instant("INVOICES.ITEM_TYPE.DELETE.MODAL.SUCCESS_MESSAGE"))}),Object(Vt.a)(e=>(this.toaster.pop("error",(null==e?void 0:e.error)&&(null==e?void 0:e.error.message)||this.translateService.instant("INVOICES.ITEM_TYPE.DELETE.MODAL.FAILED_MESSAGE")),Object(cs.a)(e))))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(m.c),s.fc(a.d),s.fc(l.a),s.fc(g.f))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var rs=n("5+WD");let ls=(()=>{class e{constructor(e,t){this.element=e,this.model=t,this.decimals=2,this.maxNumber=21474836,this.minNumber=0,this.inputChange=new s.n}get hasDecimals(){return!!this.decimals}onInput(e){let t;this.minNumber<0&&e.startsWith("-")&&(t=!0),e=(e=e.replace(/,/g,".")).replace(this.hasDecimals?/[^0-9.]/g:/[^0-9]/g,""),t&&(e="-"+e);const n=e.indexOf(".");if(-1!=n){const t=(e=e.substring(0,n+this.decimals+1)).lastIndexOf(".");n!=t&&(e=e.substring(0,t))}e&&Object(sn.u)(e)&&Number(e)>this.maxNumber&&(e=e.substring(0,e.length-1)),this.writeValue(e)}onChange(){let e=this.element.nativeElement.value||"0";if(!this.isValid(e))return void this.writeValue(this.ngModel);const t=Number(e);Number(e)%1!=0&&(e=this.hasDecimals?Number(e).toString():Math.floor(t).toString());const n=Number(e);this.emitOnChange(n)}writeValue(e){this.model.valueAccessor.writeValue(e)}emitOnChange(e){e||this.writeValue(this.hasDecimals?"0.00":"0"),Number(this.ngModel)!==Number(e)&&this.inputChange.emit(e)}isValid(e){if(!Object(sn.u)(e))return!1;const t=Number(e);return!(t<this.minNumber||t>this.maxNumber)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.l),s.Rb(v.v))},e.\u0275dir=s.Mb({type:e,selectors:[["","numericInput",""]],hostBindings:function(e,t){1&e&&s.jc("input",(function(e){return t.onInput(e.target.value)}))("change",(function(){return t.onChange()}))},inputs:{decimals:"decimals",maxNumber:"maxNumber",minNumber:"minNumber",ngModel:"ngModel"},outputs:{inputChange:"inputChange"}}),e})();function bs(e,t){if(1&e){const e=s.Yb();s.Xb(0,"td",17),s.jc("mousedown",(function(t){return s.Oc(e),t.stopPropagation()})),s.Xb(1,"div",18),s.Xb(2,"dropdown-items",19),s.jc("onChanged",(function(t){return s.Oc(e),s.nc().editInvoiceItem(t)})),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.wc("isDisabled",e.disableEdit)("list",e.itemsDropdown)("initLabel",null==e.selected?null:e.selected.label)("value",e.invoiceItem.itemType)}}function ds(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",25),s.Xb(1,"div",26),s.Xb(2,"div",27),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"button",28),s.jc("click",(function(){return s.Oc(e),s.nc(2).onDelete.emit()})),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(3),s.bd("",s.pc(4,3,"INVOICES.TABLE.CONFIRM_QUESTION"),"?"),s.Cb(2),s.wc("disabled",e.disableEdit),s.Cb(1),s.bd(" ",s.pc(7,5,"GLOBAL.DELETE_BTN")," ")}}function us(e,t){if(1&e){const e=s.Yb();s.Xb(0,"td",20),s.jc("mousedown",(function(t){return s.Oc(e),t.stopPropagation()})),s.Xb(1,"div",21),s.Xb(2,"button",22),s.Sb(3,"img",23),s.Wb(),s.Xc(4,ds,8,7,"div",24),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.wc("dropdownKey",e.disableEdit)}}const ps=function(e){return{"cl-w-50":e}},hs=["*"];let ms=(()=>{class e{constructor(e,t,n){this.loader=e,this.cd=t,this.invoiceService=n,this.itemsDropdown=[],this.onDelete=new s.n,this.debouncer$=new p.a,this.unsubscribe$=new Fn.a}set invoiceItem(e){this._invoiceItem=e,this.invoiceBackup=Zn.clone(e)}get invoiceItem(){return this._invoiceItem}set settings(e){e&&(this._settings=e)}get settings(){return this._settings}set itemTypes(e){e&&(this._itemTypes=e,this.fetchItemTypes())}get itemTypes(){return this._itemTypes}set workspace(e){e&&(this._workspace=e,this.hasExpensesFeature=this._workspace.hasFeature(is.a.EXPENSES))}ngOnInit(){this.debouncer$.pipe(Object(De.a)(100),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{"blur"===this.eventType&&this.editInvoiceItem()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete(),this.editInvoiceItem()}onEvent(e){this.eventType=e,this.debouncer$.next()}editInvoiceItem(e){const t=this.itemsDropdown.find(t=>t.value===e);null!=t&&(this.invoiceItem.itemType=t.label),Zn.areSame(this.invoiceBackup,this.invoiceItem)||this.invoiceService.editInvoiceItem(this.invoiceId,this.invoiceItem).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{const t=this.invoiceItem.order,n=e.items.find(e=>e.order===t);this.invoiceItem.amount=n.amount,this.invoiceItem.itemType=n.itemType,this.invoiceBackup=Zn.clone(this.invoiceItem),this.cd.markForCheck()},e=>{})}fetchItemTypes(){var e;this.itemsDropdown=this.itemTypes.map(e=>new Un.a(e.id,e.name)),this.selected=this.itemsDropdown.find(e=>{var t;return e.label==(null===(t=this._invoiceItem)||void 0===t?void 0:t.itemType)}),null==this.selected&&(this.selected=new Un.a("",null===(e=this._invoiceItem)||void 0===e?void 0:e.itemType)),this.cd.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Hn.a),s.Rb(s.h),s.Rb(ti))},e.\u0275cmp=s.Lb({type:e,selectors:[["invoice-items-row"],["","invoice-items-row",""]],inputs:{invoiceItem:"invoiceItem",settings:"settings",invoiceId:"invoiceId",disableEdit:"disableEdit",itemTypes:"itemTypes",workspace:"workspace"},outputs:{onDelete:"onDelete"},ngContentSelectors:hs,decls:26,vars:25,consts:[[1,"cl-p-0","cl-py-lg-2",2,"cursor","move"],["cdkDragHandle","",1,"cl-component-divided-left","cl-no-divider-border","cl-d-flex"],["src","assets/images/nav-icons/three-lines.svg"],["class","cl-p-0 cl-py-lg-2 cl-cut-text-wrapper-td",3,"mousedown",4,"ngIf"],[1,"cl-p-0","cl-py-lg-2",3,"ngClass","mousedown"],[1,"cl-no-divider-border-up-lg","cl-component-divided-left","cl-d-flex","cl-p-0","cl-px-lg-1","cl-px-xl-3"],["type","text","data-cy","invoice-descriptions",1,"cl-form-control","cl-style-disabled-inputs","cl-invoice-item-input",3,"placeholder","disabled","ngModel","blur","focus","ngModelChange"],[1,"cl-p-0","cl-py-lg-2",3,"mousedown"],[1,"cl-no-divider-border-up-lg","cl-component-divided-left","cl-d-flex","cl-align-self-end","cl-p-0","cl-px-lg-1","cl-px-xl-3"],["type","text","numericInput","","data-cy","item-quantity",1,"cl-form-control","cl-text-right","cl-style-disabled-inputs","cl-invoice-item-input",3,"disabled","minNumber","ngModel","keyup.enter","inputChange","blur","focus"],["quantityInput",""],["type","text","numericInput","","data-cy","item-unit-price",1,"cl-form-control","cl-text-right","cl-style-disabled-inputs","cl-invoice-item-input",3,"disabled","minNumber","ngModel","keyup.enter","inputChange","blur","focus"],["unitPriceInput",""],[1,"cl-p-0","cl-py-lg-2","cl-text-right",3,"mousedown"],[1,"cl-no-divider-border-up-lg","cl-component-divided-left","cl-d-flex","cl-text-right"],[1,"cl-w-100"],["class","cl-px-0 cl-relative","style","overflow: visible;",3,"mousedown",4,"ngIf"],[1,"cl-p-0","cl-py-lg-2","cl-cut-text-wrapper-td",3,"mousedown"],[1,"cl-no-divider-border-up-lg","cl-component-divided-left","cl-d-flex","cl-p-0","cl-px-lg-1","cl-px-xl-2"],[3,"isDisabled","list","initLabel","value","onChanged"],[1,"cl-px-0","cl-relative",2,"overflow","visible",3,"mousedown"],[1,"cl-relative",3,"dropdownKey"],["dropdownKeyButton","",1,"cl-component-divided-left","cl-d-flex"],["src","assets/images/ui-icons/close.svg"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-d-flex","cl-align-items-center","cl-px-3","cl-py-2"],[1,"cl-cut-text","cl-mr-3"],["tabindex","0",1,"cl-btn","cl-btn-primary",3,"disabled","click"]],template:function(e,t){if(1&e){const e=s.Yb();s.vc(),s.Xb(0,"td",0),s.uc(1),s.Xb(2,"div",1),s.Sb(3,"img",2),s.Wb(),s.Wb(),s.Xc(4,bs,3,4,"td",3),s.Xb(5,"td",4),s.jc("mousedown",(function(e){return e.stopPropagation()})),s.Xb(6,"div",5),s.Xb(7,"input",6),s.jc("blur",(function(){return t.onEvent("blur")}))("focus",(function(){return t.onEvent("focus")}))("ngModelChange",(function(e){return t.invoiceItem.description=e})),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(9,"td",7),s.jc("mousedown",(function(e){return e.stopPropagation()})),s.Xb(10,"div",8),s.Xb(11,"input",9,10),s.jc("keyup.enter",(function(){return s.Oc(e),s.Lc(12).blur()}))("inputChange",(function(e){return t.invoiceItem.quantity=e}))("blur",(function(){return t.onEvent("blur")}))("focus",(function(){return t.onEvent("focus")})),s.oc(13,"roundIfWholeNumber"),s.Wb(),s.Wb(),s.Wb(),s.Xb(14,"td",7),s.jc("mousedown",(function(e){return e.stopPropagation()})),s.Xb(15,"div",5),s.Xb(16,"input",11,12),s.jc("keyup.enter",(function(){return s.Oc(e),s.Lc(17).blur()}))("inputChange",(function(e){return t.invoiceItem.unitPrice=e}))("blur",(function(){return t.onEvent("blur")}))("focus",(function(){return t.onEvent("focus")})),s.oc(18,"roundIfWholeNumber"),s.Wb(),s.Wb(),s.Wb(),s.Xb(19,"td",13),s.jc("mousedown",(function(e){return e.stopPropagation()})),s.Xb(20,"div",14),s.Xb(21,"span",15),s.Zc(22),s.oc(23,"roundIfWholeNumber"),s.oc(24,"centsToDollars"),s.Wb(),s.Wb(),s.Wb(),s.Xc(25,us,5,1,"td",16)}2&e&&(s.Cb(4),s.wc("ngIf",t.hasExpensesFeature&&t._workspace.expensesEnabled),s.Cb(1),s.wc("ngClass",s.Bc(23,ps,!(t.hasExpensesFeature&&t._workspace.expensesEnabled))),s.Cb(2),s.xc("placeholder",s.pc(8,13,"INVOICES.TABLE.DESCRIPTION_PLACEHOLDER")),s.wc("disabled",t.disableEdit)("ngModel",t.invoiceItem.description),s.Cb(4),s.wc("disabled",t.disableEdit)("minNumber",-21474836)("ngModel",s.pc(13,15,t.invoiceItem.quantity)),s.Cb(5),s.wc("disabled",t.disableEdit)("minNumber",-21474836)("ngModel",s.pc(18,17,t.invoiceItem.unitPrice)),s.Cb(6),s.bd(" ",s.pc(23,19,s.pc(24,21,t.invoiceItem.amount))," "),s.Cb(3),s.wc("ngIf",!t.disableEdit))},directives:[rs.b,i.u,i.r,v.c,v.s,v.v,ls,ji.a,ni.a,ii.a,si.a],pipes:[g.e,Ai.a,Oi.a],encapsulation:2,changeDetection:0}),e})();var gs=n("ps2d");function Es(e,t){1&e&&(s.Xb(0,"th",8),s.Xb(1,"span",6),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,1,"INVOICES.ITEM_TYPE.TITLE")))}function fs(e,t){1&e&&s.Sb(0,"th",13)}function Ss(e,t){if(1&e){const e=s.Yb();s.Xb(0,"tr",14),s.jc("onDelete",(function(){s.Oc(e);const n=t.$implicit;return s.nc().deleteItem(n)}))("cdkDragStarted",(function(){return s.Oc(e),s.nc().disableDrag=!0})),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc();s.wc("invoiceItem",e)("workspace",n._workspace)("itemTypes",n.itemTypes)("settings",n.settings)("disableEdit",n.disableEdit)("invoiceId",n.invoiceId)}}const Cs=function(e){return{"cl-invoice-th-fw":e}};let As=(()=>{class e{constructor(e,t,n,i){this.loader=e,this.cd=t,this.invoiceService=n,this.itemTypeService=i,this.unsubscribe$=new p.a,this.disableDrag=!1,this.sortByOrderMapper=e=>e.order}set workspace(e){e&&(this._workspace=e,this.hasExpensesFeature=this._workspace.hasFeature(is.a.EXPENSES))}ngOnInit(){this.getSettings(),this.getItemTypes()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}deleteItem(e){this.loader.showBarAndDisable(),this.invoiceService.deleteInvoiceItem(this.invoiceId,e.order).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.loader.hide(),this.cd.markForCheck()},()=>this.loader.hide())}addNewItem(){this.loader.showBarAndDisable(),this.invoiceService.createInvoiceItem(this.invoiceId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.invoiceItems.push(e),this.triggerNumber=new Date,this.loader.hide(),this.cd.detectChanges()},()=>this.loader.hide())}reorder(e){e.previousIndex!==e.currentIndex?this.invoiceService.reorderInvoiceItem(this.invoiceId,e.previousIndex+1,e.currentIndex+1).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.invoiceItems=e,this.triggerNumber=new Date,this.disableDrag=!1,this.cd.detectChanges()}):this.disableDrag=!1}getSettings(){this.invoiceService.getInvoiceSettings().subscribe(e=>{this.settings=e,this.cd.detectChanges()})}getItemTypes(){this.itemTypeService.getItemTypes().subscribe(({items:e})=>{this.itemTypes=e,this.cd.detectChanges()})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Hn.a),s.Rb(s.h),s.Rb(ti),s.Rb(os))},e.\u0275cmp=s.Lb({type:e,selectors:[["invoice-items-table"]],inputs:{disableEdit:"disableEdit",invoiceItems:"invoiceItems",invoiceId:"invoiceId",workspace:"workspace"},decls:36,vars:36,consts:[[1,"cl-card","cl-border-bottom-0","cl-mb-0"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],[1,"cl-table-responsive"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6"],[1,"cl-pl-lg-3",2,"width","46px"],[1,"cl-h5"],["class","cl-pl-lg-3",4,"ngIf"],[1,"cl-pl-lg-3"],[1,"cl-pr-lg-3","cl-text-right",2,"width","150px",3,"ngClass"],["style","width: 46px;",4,"ngIf"],["cdkDropList","",3,"cdkDropListDisabled","cdkDropListData","cdkDropListDropped"],["cdkDrag","","invoice-items-row","",3,"invoiceItem","workspace","itemTypes","settings","disableEdit","invoiceId","onDelete","cdkDragStarted",4,"ngFor","ngForOf"],[2,"width","46px"],["cdkDrag","","invoice-items-row","",3,"invoiceItem","workspace","itemTypes","settings","disableEdit","invoiceId","onDelete","cdkDragStarted"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"span",2),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(5,"div",3),s.Xb(6,"table",4),s.Xb(7,"thead"),s.Xb(8,"tr"),s.Xb(9,"th",5),s.Sb(10,"span",6),s.Wb(),s.Xc(11,Es,4,3,"th",7),s.Xb(12,"th",8),s.Xb(13,"span",6),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Wb(),s.Xb(16,"th",9),s.Xb(17,"span",6),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Wb(),s.Xb(20,"th",9),s.Xb(21,"span",6),s.Zc(22),s.oc(23,"translate"),s.Wb(),s.Wb(),s.Xb(24,"th",9),s.Xb(25,"span",6),s.Zc(26),s.oc(27,"translate"),s.Wb(),s.Wb(),s.Xc(28,fs,1,0,"th",10),s.Wb(),s.Wb(),s.Xb(29,"tbody",11),s.jc("cdkDropListDropped",(function(e){return t.reorder(e)})),s.Xc(30,Ss,1,6,"tr",12),s.oc(31,"sortByNumber"),s.Wb(),s.Wb(),s.Xb(32,"div",1),s.Xb(33,"span",2),s.Zc(34),s.oc(35,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.ad(s.pc(4,14,"INVOICES.TABLE.ITEMS_HEADER")),s.Cb(8),s.wc("ngIf",t.hasExpensesFeature&&t._workspace.expensesEnabled),s.Cb(3),s.ad(s.pc(15,16,"GLOBAL.DESCRIPTION_LABEL")),s.Cb(2),s.wc("ngClass",s.Bc(30,Cs,!(t.hasExpensesFeature&&t._workspace.expensesEnabled))),s.Cb(2),s.ad(s.pc(19,18,"INVOICES.SHARED.QUANTITY")),s.Cb(2),s.wc("ngClass",s.Bc(32,Cs,!(t.hasExpensesFeature&&t._workspace.expensesEnabled))),s.Cb(2),s.ad(s.pc(23,20,"INVOICES.SHARED.UNIT_PRICE")),s.Cb(2),s.wc("ngClass",s.Bc(34,Cs,!(t.hasExpensesFeature&&t._workspace.expensesEnabled))),s.Cb(2),s.ad(s.pc(27,22,"GLOBAL.AMOUNT_LABEL")),s.Cb(2),s.wc("ngIf",!t.disableEdit),s.Cb(1),s.wc("cdkDropListDisabled",t.disableEdit||t.disableDrag)("cdkDropListData",t.invoiceItems),s.Cb(1),s.wc("ngForOf",s.rc(31,24,t.invoiceItems,t.sortByOrderMapper,t.triggerNumber)),s.Cb(4),s.ad(s.pc(35,28,"INVOICES.TABLE.ITEMS_HEADER")))},directives:[i.u,i.r,rs.e,i.t,rs.a,ms],pipes:[g.e,gs.a],encapsulation:2,changeDetection:0}),e})();class Os{constructor(e){this._round=e&&e.round,this._minutes=e&&e.minutes}get round(){return this._round}set round(e){this._round=e}get minutes(){return this._minutes}set minutes(e){this._minutes=e}}var vs=function(e){return e.PROJECT="PROJECT",e.USER="USER",e.DATE="DATE",e.DESCRIPTION="DESCRIPTION",e.TASK="TASK",e.NONE="NONE",e}({}),Ts=n("Fcjm"),Is=n("rf9C"),ws=n("/DYx");const Ls=["dropdownSecondaryGrouping"];function Rs(e,t){1&e&&(s.Xb(0,"h1",24),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"INVOICES.SHARED.IMPORT_TIME_AND_EXPENSES"),""))}function ys(e,t){1&e&&(s.Xb(0,"h1",24),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"INVOICES.SHARED.IMPORT_TIME")))}function _s(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",25),s.Xb(1,"div",26),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"dropdown-items",27),s.jc("onChanged",(function(t){return s.Oc(e),s.nc().onPrimaryGroupingSelect(t)})),s.Wb(),s.Xb(5,"dropdown-items",27,28),s.jc("onChanged",(function(t){return s.Oc(e),s.nc().onSecondaryGroupingSelect(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,7,"INVOICES.IMPORT.GROUP_BY")),s.Cb(2),s.wc("list",e.primaryGroupingList)("value",e.form.value.firstLevelGrouping)("type","STANDARD"),s.Cb(1),s.wc("list",e.secondaryGroupingList)("value",e.form.value.secondLevelGrouping)("type","STANDARD")}}const ks=function(){return{standalone:!0}};function Ws(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",32),s.Xb(1,"input",33),s.jc("ngModelChange",(function(n){s.Oc(e);const i=t.$implicit;return s.nc(2).modelChanged(n,i.value)})),s.Wb(),s.Xb(2,"label",34),s.Zc(3),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc(2);s.Cb(1),s.yc("id","timeEntryDetails_",e.value,""),s.yc("name","timeEntryDetails_",e.value,""),s.wc("ngModel",n.form.value.fieldsForDetailed.includes(e.value))("ngModelOptions",s.Ac(6,ks)),s.Cb(1),s.yc("for","timeEntryDetails_",e.value,""),s.Cb(1),s.ad(e.label)}}function Xs(e,t){if(1&e&&(s.Xb(0,"div",29),s.Xb(1,"span",30),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,Ws,4,7,"div",31),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.bd(" ",s.pc(3,2,"INVOICES.IMPORT.ENTRY_DETAILS")," "),s.Cb(2),s.wc("ngForOf",e.timEntryDetailsCheckboxes)}}function Ns(e,t){1&e&&s.Sb(0,"hr")}function Ds(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",8),s.Xb(1,"dropdown-items",13),s.jc("onChanged",(function(t){return s.Oc(e),s.nc(2).onDisplayExpenseItemsSelect(t)})),s.oc(2,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(1),s.wc("title",s.pc(2,4,"INVOICES.IMPORT.DISPLAY_EXPENSES"))("list",e.displayItemsForExpenses)("value",e.form.value.displayItemsForExpenses)("type","STANDARD")}}function Ps(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",32),s.Xb(1,"input",33),s.jc("ngModelChange",(function(n){s.Oc(e);const i=t.$implicit;return s.nc(3).modelChangedExpenses(n,i.value)})),s.Wb(),s.Xb(2,"label",34),s.Zc(3),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc(3);s.Cb(1),s.yc("id","expensesDetails_",e.value,""),s.yc("name","expensesDetails_",e.value,""),s.wc("ngModel",n.form.value.expensesForDetailed.includes(e.value))("ngModelOptions",s.Ac(6,ks)),s.Cb(1),s.yc("for","expensesDetails_",e.value,""),s.Cb(1),s.ad(e.label)}}function Ms(e,t){if(1&e&&(s.Xb(0,"div",29),s.Xb(1,"span",30),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,Ps,4,7,"div",31),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.bd(" ",s.pc(3,2,"INVOICES.IMPORT.EXPENSES_DETAILS")," "),s.Cb(2),s.wc("ngForOf",e.expensesDetailsCheckboxes)}}function Bs(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"div",8),s.Xb(2,"span",9),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"div",16),s.Xb(6,"input",35),s.jc("change",(function(t){return s.Oc(e),s.nc().includeExpenses(t.target)})),s.Wb(),s.Xb(7,"label",36),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xc(10,Ds,3,6,"div",37),s.Xc(11,Ms,5,4,"div",15),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.ad(s.pc(4,5,"EXPENSES.TITLE")),s.Cb(3),s.wc("checked",e.displayExpensesDetails),s.Cb(2),s.bd(" ",s.pc(9,7,"INVOICES.IMPORT.EXPENSES.LABEL")," "),s.Cb(2),s.wc("ngIf",e.displayExpensesDetails),s.Cb(1),s.wc("ngIf",e.form.value.displayItemsForExpenses===e.expensesDisplayItems.DETAILED&&e.displayExpensesDetails)}}let Us=(()=>{class e{constructor(e,t,n,i,c,a){this.formBuilder=e,this.invoiceService=t,this.router=n,this.loader=i,this.translate=c,this.analyticsService=a,this.onClose=new s.n,this.isSavingChange=new s.n,this.onImport=new s.n,this.invoiceDisplayItems=Kn,this.expensesDisplayItems=ei,this.displayExpensesDetails=!1,this.WorkspaceRoundTranslateEnum=Ts.a,this.projectFilterOptions=on.r,this.ReportFilter=on.i,this.projectValuesData=new wn.a,this.unsubscribe$=new p.a,this.showDetailedGrouping=!1}set workspace(e){e&&(this._workspace=e,this.hasExpensesFeature=this._workspace.hasFeature(is.a.EXPENSES))}ngOnInit(){this.initTranslations(),this.dateRange={start:ke.utc().subtract(1,"month").startOf("month"),end:ke.utc().subtract(1,"month").endOf("month")},this.form=this.formBuilder.group({projectsFilter:[null,[v.G.required]],from:[this.dateRange.start.toISOString(),[v.G.required]],to:[this.dateRange.end.toISOString(),[v.G.required]],displayItems:[Kn.SINGLE_ITEM,[v.G.required]],firstLevelGrouping:[vs.NONE,[]],secondLevelGrouping:[vs.NONE,[]],roundEntries:!1,includeExpenses:!1,expensesGroupType:Kn.GROUPED,displayItemsForExpenses:[ei.CATEGORY,[v.G.required]],expensesForDetailed:[["PROJECT","CATEGORY","NOTE","DATE","USER"],[]],fieldsForDetailed:[["PROJECT","TASK","DESCRIPTION","TAGS","DATE","USER"],[]]}),this.clientFilter={contains:on.d.CONTAINS,ids:[this.clientId],status:"ALL"},this.clientId||console.error("Import time: missing clientId"),this.secondaryGroupingList=this.allGroupingOptionsList,this.setRoundingMinutes()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initTranslations(){const e=this.translate.instant("GLOBAL.PROJECT_LABEL"),t=this.translate.instant("WORKSPACE.SETTINGS.CATEGORY_LABEL"),n=this.translate.instant("GLOBAL.NOTE_LABEL"),i=this.translate.instant("GLOBAL.USER_LABEL"),s=this.translate.instant("GLOBAL.DATE_LABEL"),c=this.translate.instant("GLOBAL.DESCRIPTION_LABEL"),a=this.translate.instant("GLOBAL.TASK_LABEL"),o=this.translate.instant("GLOBAL.TAGS_LABEL");this.displayItemsList=[new Un.a(Kn.SINGLE_ITEM,this.translate.instant("INVOICES.DROPDOWNVALUES.GROUPING_HOURS_SINGLE")),new Un.a(Kn.DETAILED,this.translate.instant("INVOICES.DROPDOWNVALUES.GROUPING_HOURS_DETAILED")),new Un.a(Kn.GROUPED,this.translate.instant("INVOICES.DROPDOWNVALUES.GROUPING_HOURS_GROUPED"))],this.displayItemsForExpenses=[new Un.a(ei.DETAILED,this.translate.instant("INVOICES.DROPDOWNVALUES.GROUPING_DETAILED")),new Un.a(ei.PROJECT,this.translate.instant("INVOICES.DROPDOWNVALUES.GROUPING_PROJECT")),new Un.a(ei.USER,this.translate.instant("INVOICES.DROPDOWNVALUES.GROUPING_USER")),new Un.a(ei.CATEGORY,this.translate.instant("INVOICES.DROPDOWNVALUES.GROUPING_CATEGORY"))],this.primaryGroupingList=[new Un.a(vs.PROJECT,e),new Un.a(vs.USER,i),new Un.a(vs.DATE,s)],this.allGroupingOptionsList=[new Un.a(vs.NONE,this.translate.instant("INVOICES.SHARED.NONE")),new Un.a(vs.PROJECT,e),new Un.a(vs.TASK,a),new Un.a(vs.DATE,s),new Un.a(vs.USER,i),new Un.a(vs.DESCRIPTION,c)],this.timEntryDetailsCheckboxes=[{label:e,value:"PROJECT"},{label:a,value:"TASK"},{label:c,value:"DESCRIPTION"},{label:o,value:"TAGS"},{label:s,value:"DATE"},{label:i,value:"USER"}],this.expensesDetailsCheckboxes=[{label:e,value:"PROJECT"},{label:t,value:"CATEGORY"},{label:n,value:"NOTE"},{label:s,value:"DATE"},{label:i,value:"USER"}],this.optionsTime=[new Un.a("1",this.translate.instant("INVOICES.DROPDOWNVALUES.MINUTES",{count:1})),new Un.a("5",this.translate.instant("INVOICES.DROPDOWNVALUES.MINUTES",{count:5})),new Un.a("6",this.translate.instant("INVOICES.DROPDOWNVALUES.MINUTES",{count:6})),new Un.a("10",this.translate.instant("INVOICES.DROPDOWNVALUES.MINUTES",{count:10})),new Un.a("12",this.translate.instant("INVOICES.DROPDOWNVALUES.MINUTES",{count:12})),new Un.a("15",this.translate.instant("INVOICES.DROPDOWNVALUES.MINUTES",{count:15})),new Un.a("30",this.translate.instant("INVOICES.DROPDOWNVALUES.MINUTES",{count:30})),new Un.a("60",this.translate.instant("INVOICES.DROPDOWNVALUES.HOURS",{count:1})),new Un.a("240",this.translate.instant("INVOICES.DROPDOWNVALUES.HOURS",{count:4}))]}onProjectChange(e){this.form.patchValue({projectsFilter:e.isDirty()?e.getContainsFilter(on.i.PROJECTS):null})}updateDateRange({dateRange:e}){var t,n;this.form.patchValue({from:e.start.toISOString(),to:e.end.toISOString()}),this.analyticsService.addEvent(new Fi.a({event:"change",value:(null===(t=null==e?void 0:e.start)||void 0===t?void 0:t.toLocaleString())+" - "+(null===(n=null==e?void 0:e.end)||void 0===n?void 0:n.toLocaleString()),section:"Invoices",section2:"Import time and expenses",section3:"Date range",section4:"Date range"}))}onDisplayItemsSelect(e){this.form.patchValue({displayItems:e}),e===Kn.GROUPED&&this.onPrimaryGroupingSelect(vs.PROJECT),this.displayItemsList=this.displayItemsList.filter(e=>!!e.value),this.analyticsService.addEvent(new Fi.a({event:"select",value:e,section:"Invoices",section2:"Import time and expenses",section3:"Display items",section4:"Display time"}))}onDisplayExpenseItemsSelect(e){this.form.patchValue({displayItemsForExpenses:e}),this.form.patchValue({expensesGroupType:Kn.GROUPED}),e===ei.DETAILED&&this.form.patchValue({expensesGroupType:Kn.DETAILED}),this.displayItemsForExpenses=this.displayItemsForExpenses.filter(e=>!!e.value)}updateRoundEntryDuration(e){this.form.patchValue({roundEntries:e.checked})}includeExpenses(e){this.displayExpensesDetails=e.checked,this.form.patchValue({includeExpenses:e.checked}),this.analyticsService.addEvent(new Fi.a({event:"switch",value:this.displayExpensesDetails,section:"Invoices",section2:"Import time and expenses",section3:"Expenses",section4:"Include billable expenses"}))}modelChanged(e,t){let n=[...this.form.value.fieldsForDetailed];e?n.push(t):n=n.filter(e=>e!==t),this.form.patchValue({fieldsForDetailed:n})}modelChangedExpenses(e,t){let n=[...this.form.value.expensesForDetailed];if(e){n.push(t);const e=[];n.forEach(t=>{const n=this.expensesDetailsCheckboxes.findIndex(e=>e.value==t);e.push(n)}),e.sort();const i=[];e.forEach(e=>{i.push(this.expensesDetailsCheckboxes[e].value)}),n=i}else n=n.filter(e=>e!==t);this.form.patchValue({expensesForDetailed:n})}submitForm(){setTimeout(()=>{this.saveInProgress||this.form.invalid||(this.isSavingChange.emit(!0),this.loader.show(),this.invoiceService.importTime(this.form.value,this.invoiceId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isSavingChange.emit(!1),this.loader.hide(),this.onImport.emit(e),this.analyticsService.addEvent(new Fi.a({event:"submit",section:"Invoices",section2:"Import time and expenses"}))},()=>{this.loader.hide(),this.isSavingChange.emit(!1)}))})}closeModal(){this.onClose.emit(!1)}onPrimaryGroupingSelect(e){this.form.patchValue({firstLevelGrouping:e}),this.secondaryGroupingList=this.allGroupingOptionsList.filter(t=>t.value!=e),this.form.patchValue({secondLevelGrouping:vs.NONE})}onSecondaryGroupingSelect(e){this.form.patchValue({secondLevelGrouping:e})}setRoundingMinutes(){try{const e=this.roundSetting.minutes;this.roundingMinutes=this.optionsTime.filter(t=>t.value===e)[0].label}catch(e){}}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(v.f),s.Rb(ti),s.Rb(k.d),s.Rb(Hn.a),s.Rb(g.f),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["import-invoice-time"]],viewQuery:function(e,t){var n;1&e&&s.gd(Ls,!0),2&e&&s.Kc(n=s.kc())&&(t.dropdownSecondaryGrouping=n.first)},inputs:{saveInProgress:"saveInProgress",invoiceId:"invoiceId",clientId:"clientId",roundSetting:"roundSetting",workspace:"workspace"},outputs:{onClose:"onClose",isSavingChange:"isSavingChange",onImport:"onImport"},decls:47,vars:46,consts:[[1,"cl-modal-header"],["class","cl-modal-title",4,"ngIf","ngIfElse"],["onlyTime",""],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],["novalidate","",3,"formGroup","ngSubmit"],[1,"cl-modal-body"],["ngbAutofocus","","tabindex","0",1,"cl-no-outline",2,"width","0","height","0"],[1,"cl-form-group","cl-mb-3"],[1,"cl-mb-1","cl-d-inline-block"],[3,"type","title","filterName","placeholder","constrainContainsFilter","valuesData","filterOptions","onChange"],[1,"cl-form-group","cl-mb-3","cl-d-flex","cl-justify-content-start","cl-align-items-start","cl-flex-column"],[1,"cl-w-100",3,"timeEntriesDateRange","removeArrows","dateRangeOut"],[1,"cl-dropdown-full-width",3,"title","list","value","type","onChanged"],["class","cl-row cl-mt-0 cl-mb-3",4,"ngIf"],["class","cl-form-group",4,"ngIf"],[1,"cl-custom-control","cl-custom-switch","cl-form-group"],["type","checkbox","name","roundEntries","id","roundEntries",1,"cl-custom-control-input",3,"change"],["for","roundEntries",1,"cl-custom-control-label"],[4,"ngIf"],["tabindex","0",1,"cl-no-outline",2,"width","0","height","0"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"],[1,"cl-modal-title"],[1,"cl-row","cl-mt-0","cl-mb-3"],[1,"cl-col-form-label","cl-col-sm-2"],[1,"cl-dropdown","cl-col-sm-5",3,"list","value","type","onChanged"],["dropdownSecondaryGrouping",""],[1,"cl-form-group"],[1,"cl-mb-1","cl-d-block"],["class","cl-custom-control cl-custom-checkbox cl-custom-control-inline",4,"ngFor","ngForOf"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline"],["type","checkbox",1,"cl-custom-control-input",3,"id","ngModel","ngModelOptions","name","ngModelChange"],[1,"cl-custom-control-label",3,"for"],["type","checkbox","name","includeExpenses","id","includeExpenses",1,"cl-custom-control-input",3,"checked","change"],["for","includeExpenses",1,"cl-custom-control-label"],["class","cl-form-group cl-mb-3",4,"ngIf"]],template:function(e,t){if(1&e&&(s.Xb(0,"div",0),s.Xc(1,Rs,3,3,"h1",1),s.Xc(2,ys,3,3,"ng-template",null,2,s.Yc),s.Xb(4,"button",3),s.jc("click",(function(){return t.closeModal()})),s.Xb(5,"span"),s.Sb(6,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"form",5),s.jc("ngSubmit",(function(){return t.submitForm()})),s.Xb(8,"div",6),s.Sb(9,"span",7),s.Xb(10,"div",8),s.Xb(11,"span",9),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xb(14,"dropdown-checkbox-wrapper",10),s.jc("onChange",(function(e){return t.onProjectChange(e)})),s.oc(15,"translate"),s.oc(16,"translate"),s.Wb(),s.Wb(),s.Xb(17,"div",11),s.Xb(18,"span",9),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Xb(21,"datepicker-range",12),s.jc("dateRangeOut",(function(e){return t.updateDateRange(e)})),s.Wb(),s.Wb(),s.Sb(22,"hr"),s.Xb(23,"div",8),s.Xb(24,"dropdown-items",13),s.jc("onChanged",(function(e){return t.onDisplayItemsSelect(e)})),s.oc(25,"translate"),s.Wb(),s.Wb(),s.Xc(26,_s,7,9,"div",14),s.Xc(27,Xs,5,4,"div",15),s.Xb(28,"div",8),s.Xb(29,"span",9),s.Zc(30),s.oc(31,"translate"),s.Wb(),s.Xb(32,"div",16),s.Xb(33,"input",17),s.jc("change",(function(e){return t.updateRoundEntryDuration(e.target)})),s.Wb(),s.Xb(34,"label",18),s.Zc(35),s.oc(36,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xc(37,Ns,1,0,"hr",19),s.Xc(38,Bs,12,9,"div",19),s.Wb(),s.Sb(39,"span",20),s.Xb(40,"div",21),s.Xb(41,"a",22),s.jc("click",(function(){return t.closeModal()})),s.Zc(42),s.oc(43,"translate"),s.Wb(),s.Xb(44,"button",23),s.Zc(45),s.oc(46,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.Lc(3);s.Cb(1),s.wc("ngIf",t.hasExpensesFeature&&t._workspace.expensesEnabled)("ngIfElse",e),s.Cb(6),s.wc("formGroup",t.form),s.Cb(5),s.ad(s.pc(13,28,"GLOBAL.PROJECTS_LABEL")),s.Cb(2),s.wc("type",t.ReportFilter.PROJECTS)("title",s.pc(15,30,"INVOICES.TABLE.PROJECT_SELECT_TOOLTIP"))("filterName","projects")("placeholder",s.pc(16,32,"GLOBAL.PROJECT_FIND"))("constrainContainsFilter",t.clientFilter)("valuesData",t.projectValuesData)("filterOptions",t.projectFilterOptions),s.Cb(5),s.ad(s.pc(20,34,"GLOBAL.DATE_RANGE")),s.Cb(2),s.wc("timeEntriesDateRange",t.dateRange)("removeArrows",!0),s.Cb(3),s.wc("title",s.pc(25,36,"INVOICES.TABLE.GROUPS_TOOLTIP"))("list",t.displayItemsList)("value",t.form.value.displayItems)("type","STANDARD"),s.Cb(2),s.wc("ngIf",t.form.value.displayItems===t.invoiceDisplayItems.GROUPED),s.Cb(1),s.wc("ngIf",t.form.value.displayItems===t.invoiceDisplayItems.DETAILED),s.Cb(3),s.ad(s.pc(31,38,"GLOBAL.TIME_ROUNDING_TITLE")),s.Cb(5),s.cd(" ",s.pc(36,40,t.WorkspaceRoundTranslateEnum[t.roundSetting.round])," ",t.roundingMinutes," "),s.Cb(2),s.wc("ngIf",t.hasExpensesFeature&&t._workspace.expensesEnabled),s.Cb(1),s.wc("ngIf",t.hasExpensesFeature&&t._workspace.expensesEnabled),s.Cb(4),s.ad(s.pc(43,42,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",t.saveInProgress||t.form.invalid),s.Cb(1),s.bd(" ",s.pc(46,44,"GLOBAL.IMPORT_TITLE")," ")}},directives:[i.u,v.I,v.t,v.k,Is.a,ws.a,ji.a,i.t,v.a,v.s,v.v],pipes:[g.e],encapsulation:2}),e})(),Gs=(()=>{class e{constructor(e,t){this.formBuilder=e,this.workspaceService=t,this.clientLabel="",this.onEdit=new s.n,this.onClose=new s.n}ngOnInit(){this.initName=this.item.name,this.initAddress=this.item.address,this.form=this.formBuilder.group({name:[this.initName,[Bi.a.required]],address:[this.initAddress,[]]}),this.clientLabel=this.workspaceService.generateClientLabel(this.clientLabel)}get areSame(){const e=this.form.value.name,t=this.form.value.address;return this.initName.trim()===e.trim()&&this.initAddress.trim()===(null==t?void 0:t.trim())}editValue(){var e;this.onEdit.emit({name:this.form.value.name.trim(),address:null===(e=this.form.value.address)||void 0===e?void 0:e.trim()})}closeEditModalWindow(){this.onClose.emit(!1)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(v.f),s.Rb(l.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["edit-client-modal"]],inputs:{title:"title",item:"item",clientLabel:"clientLabel"},outputs:{onEdit:"onEdit",onClose:"onClose"},decls:31,vars:20,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[3,"formGroup","ngSubmit"],[1,"cl-modal-body"],[1,"cl-form-group"],["for","editClientName"],[1,"cl-text-capitalize"],["id","editClientName","formControlName","name","type","text","ngbAutofocus","","preventMultipleSpaces","","autocomplete","off",1,"cl-form-control"],["for","editClientAddress"],["id","editClientAddress","formControlName","address","type","text","cols","30","rows","5","autocomplete","off",1,"cl-form-control",3,"placeholder"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.Wb(),s.Xb(3,"button",2),s.jc("click",(function(){return t.closeEditModalWindow()})),s.Xb(4,"span"),s.Sb(5,"img",3),s.Wb(),s.Wb(),s.Wb(),s.Xb(6,"form",4),s.jc("ngSubmit",(function(){return t.editValue()})),s.Xb(7,"div",5),s.Xb(8,"div",6),s.Xb(9,"label",7),s.Xb(10,"span",8),s.Zc(11),s.Wb(),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Sb(14,"input",9),s.Wb(),s.Xb(15,"div",6),s.Xb(16,"label",10),s.Xb(17,"span",8),s.Zc(18),s.Wb(),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Xb(21,"textarea",11),s.oc(22,"translate"),s.Zc(23,"      "),s.Wb(),s.Wb(),s.Wb(),s.Xb(24,"div",12),s.Xb(25,"a",13),s.jc("click",(function(){return t.closeEditModalWindow()})),s.Zc(26),s.oc(27,"translate"),s.Wb(),s.Xb(28,"button",14),s.Zc(29),s.oc(30,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(t.title),s.Cb(4),s.wc("formGroup",t.form),s.Cb(5),s.ad(t.clientLabel),s.Cb(1),s.bd(" ",s.pc(13,10,"GLOBAL.NAME_LABEL")," "),s.Cb(6),s.ad(t.clientLabel),s.Cb(1),s.bd(" ",s.pc(20,12,"GLOBAL.ADDRESS_LABEL")," "),s.Cb(2),s.xc("placeholder",s.pc(22,14,"WORKSPACE.CLIENT.EDIT.PLACEHOLDER")),s.Cb(5),s.ad(s.pc(27,16,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",t.form.invalid||t.areSame),s.Cb(1),s.ad(s.pc(30,18,"GLOBAL.SAVE_LABEL")))},directives:[v.I,v.t,v.k,v.c,v.s,v.i],pipes:[g.e],encapsulation:2}),e})();function xs(e,t){if(1&e&&(s.Xb(0,"span",12),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.wc("ngClass","cl-badge-status-"+e.invoice.color),s.Cb(1),s.bd(" ",s.pc(2,2,e.invoiceStatusLabel)," ")}}function Fs(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",78),s.jc("keyup.enter",(function(){s.Oc(e);const n=t.$implicit;return s.nc(3).markAs(n)}))("keyup.space",(function(){s.Oc(e);const n=t.$implicit;return s.nc(3).markAs(n.id)}))("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc(3).markAs(n.id)})),s.Zc(1),s.oc(2,"translate"),s.oc(3,"lowercase"),s.oc(4,"translate"),s.Wb()}if(2&e){const e=t.$implicit;s.Cb(1),s.cd(" ",s.pc(2,2,"INVOICES.SHARED.MARK_AS")," ",s.pc(3,4,s.pc(4,6,e.label))," ")}}function js(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",75),s.Xb(1,"list-items"),s.Xc(2,Fs,5,8,"button",76),s.Xb(3,"button",77),s.jc("keyup.enter",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(14);return t.openBlockedModal(n)}))("keyup.space",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(14);return t.openBlockedModal(n)}))("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(14);return t.openBlockedModal(n)})),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"button",78),s.jc("keyup.enter",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(12);return t.openModal(n)}))("keyup.space",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(12);return t.openModal(n)}))("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(12);return t.openModal(n)})),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.wc("ngForOf",e.availableStatuses),s.Cb(1),s.wc("disabled",e.disableEdit),s.Cb(1),s.bd(" ",s.pc(5,4,"GLOBAL.EDIT_LABEL")," "),s.Cb(3),s.bd(" ",s.pc(8,6,"GLOBAL.DELETE_BTN")," ")}}function Zs(e,t){if(1&e&&s.Sb(0,"img",79),2&e){const e=s.nc(2);s.wc("src",e.workspace.image,s.Qc)}}function Vs(e,t){if(1&e&&(s.Xb(0,"div",40),s.Xb(1,"strong",80),s.Zc(2),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.ad(e.clientData.name)}}function Ys(e,t){if(1&e&&(s.Xb(0,"div",42),s.Zc(1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",e.clientData.address," ")}}const Hs=function(e){return{"cl-disabled":e}};function $s(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",83),s.jc("click",(function(){s.Oc(e);const t=s.nc(3),n=s.Lc(18);return t.fetchAndEditClient(n)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc(3);s.wc("ngClass",s.Bc(4,Hs,e.editInProgress)),s.Cb(1),s.bd(" ",s.pc(2,2,"INVOICES.DETAILS.ADD_ADRESS")," ")}}const Ks=function(e){return{label:e}};function qs(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",84),s.jc("click",(function(){s.Oc(e);const t=s.nc(3),n=s.Lc(14);return t.openBlockedModal(n)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc(3);s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.DETAILS.ADD_LABEL",s.Bc(4,Ks,e.clientLabelTranslated))," ")}}function zs(e,t){if(1&e&&(s.Vb(0),s.Xc(1,$s,3,6,"button",81),s.Xc(2,qs,3,6,"button",82),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",e.invoice.clientId&&!e.clientData.address),s.Cb(1),s.wc("ngIf",!e.invoice.clientId)}}function Qs(e,t){1&e&&(s.Xb(0,"div"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"INVOICES.SHARED.IMPORT_TIME_AND_EXPENSES")))}function Js(e,t){1&e&&(s.Zc(0),s.oc(1,"translate")),2&e&&s.ad(s.pc(1,1,"INVOICES.SHARED.IMPORT_TIME"))}function ec(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",85),s.jc("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(16);return t.openBlockedModal(n)})),s.Xc(1,Qs,3,3,"div",60),s.Xc(2,Js,2,3,"ng-template",null,86,s.Yc),s.Wb()}if(2&e){const e=s.Lc(3),t=s.nc(2);s.Cb(1),s.wc("ngIf",t.hasExpensesFeature&&t.workspace.expensesEnabled)("ngIfElse",e)}}function tc(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",87),s.jc("click",(function(){return s.Oc(e),s.nc(),s.Lc(73).addNewItem()})),s.Sb(1,"img",88),s.Xb(2,"span",89),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()}2&e&&(s.Cb(3),s.ad(s.pc(4,1,"INVOICES.DETAILS.ADD_NEW")))}function nc(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",94),s.jc("click",(function(){s.Oc(e);const t=s.nc(3);return t.removeDiscount(),t.showDiscount=!1})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.REMOVE_LABEL")))}function ic(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",90),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div"),s.Xb(5,"input",91,92),s.jc("keyup.enter",(function(){return s.Oc(e),s.Lc(6).blur()}))("inputChange",(function(t){s.Oc(e);const n=s.nc(2);return n.invoice.discount=t,n.modelChanged()})),s.Wb(),s.Wb(),s.Xc(7,nc,3,3,"button",93),s.Ub()}if(2&e){const e=s.nc(2);s.Cb(2),s.bd("",s.pc(3,7,"INVOICES.SHARED.DISCOUNT")," (%)"),s.Cb(3),s.wc("disabled",e.disableEdit)("decimals",6)("ngModel",e.invoice.discount)("minNumber",-100)("maxNumber",100),s.Cb(2),s.wc("ngIf",!e.disableEdit)}}function sc(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",96),s.jc("click",(function(){return s.Oc(e),s.nc(3).updateShowDiscount()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.ad(s.pc(2,1,"INVOICES.DETAILS.ADD_DISCOUNT")))}function cc(e,t){if(1&e&&s.Xc(0,sc,3,3,"button",95),2&e){const e=s.nc(2);s.wc("ngIf",!e.disableEdit)}}function ac(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",94),s.jc("click",(function(){return s.Oc(e),s.nc(3).removeTax()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.REMOVE_LABEL")))}function oc(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",90),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div"),s.Xb(5,"input",97,98),s.jc("keyup.enter",(function(){return s.Oc(e),s.Lc(6).blur()}))("inputChange",(function(t){s.Oc(e);const n=s.nc(2);return n.invoice.tax=t,n.modelChanged()})),s.Wb(),s.Wb(),s.Xc(7,ac,3,3,"button",93),s.Ub()}if(2&e){const e=s.nc(2);s.Cb(2),s.bd("",s.pc(3,7,"INVOICES.SHARED.TAX")," (%)"),s.Cb(3),s.wc("disabled",e.disableEdit)("decimals",6)("minNumber",-100)("maxNumber",100)("ngModel",e.invoice.tax),s.Cb(2),s.wc("ngIf",!e.disableEdit)}}function rc(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",96),s.jc("click",(function(){return s.Oc(e),s.nc(3).updateShowTax()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.ad(s.pc(2,1,"INVOICES.DETAILS.ADD_TAX")))}function lc(e,t){if(1&e&&s.Xc(0,rc,3,3,"button",95),2&e){const e=s.nc(2);s.wc("ngIf",!e.disableEdit)}}function bc(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"button",96),s.jc("click",(function(){return s.Oc(e),s.nc(2).updateShowTax2()})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Ub()}2&e&&(s.Cb(2),s.ad(s.pc(3,1,"INVOICES.DETAILS.ADD_TAX")))}function dc(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",94),s.jc("click",(function(){return s.Oc(e),s.nc(3).removeTax2()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.REMOVE_LABEL")))}function uc(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",90),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div"),s.Xb(5,"input",97,98),s.jc("keyup.enter",(function(){return s.Oc(e),s.Lc(6).blur()}))("inputChange",(function(t){s.Oc(e);const n=s.nc(2);return n.invoice.tax2=t,n.modelChanged()})),s.Wb(),s.Wb(),s.Xc(7,dc,3,3,"button",93),s.Ub()}if(2&e){const e=s.nc(2);s.Cb(2),s.bd("",s.pc(3,7,"INVOICES.SHARED.TAX2")," (%)"),s.Cb(3),s.wc("disabled",e.disableEdit)("decimals",6)("minNumber",-100)("maxNumber",100)("ngModel",e.invoice.tax2),s.Cb(2),s.wc("ngIf",!e.disableEdit)}}function pc(e,t){if(1&e&&(s.Xb(0,"div",66),s.Xb(1,"span",67),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"span"),s.Zc(5),s.oc(6,"roundIfWholeNumber"),s.oc(7,"centsToDollars"),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.ad(s.pc(3,3,"INVOICES.SHARED.DISCOUNT")),s.Cb(3),s.cd("",s.pc(6,5,s.pc(7,7,e.invoice.discountAmount))," ",e.invoice.currency,"")}}function hc(e,t){if(1&e&&(s.Xb(0,"div",66),s.Xb(1,"span",67),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"span"),s.Zc(5),s.oc(6,"roundIfWholeNumber"),s.oc(7,"centsToDollars"),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.ad(s.pc(3,3,"INVOICES.SHARED.TAX")),s.Cb(3),s.cd("",s.pc(6,5,s.pc(7,7,e.invoice.taxAmount))," ",e.invoice.currency,"")}}function mc(e,t){if(1&e&&(s.Xb(0,"div",66),s.Xb(1,"span",67),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"span"),s.Zc(5),s.oc(6,"roundIfWholeNumber"),s.oc(7,"centsToDollars"),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.ad(s.pc(3,3,"INVOICES.SHARED.TAX2")),s.Cb(3),s.cd("",s.pc(6,5,s.pc(7,7,e.invoice.tax2Amount))," ",e.invoice.currency,"")}}function gc(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",13),s.Xb(1,"div",14),s.Xb(2,"div",15),s.Xb(3,"button",16,17),s.jc("click",(function(){s.Oc(e);const t=s.Lc(4);return s.nc().downloadPdf(),t.blur()})),s.Zc(5),s.oc(6,"uppercase"),s.oc(7,"translate"),s.Wb(),s.Xb(8,"div",18),s.Xb(9,"a",19),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Xc(12,js,9,8,"div",20),s.Sb(13,"span",21,22),s.Wb(),s.Wb(),s.Xb(15,"div",23),s.Xb(16,"div",14),s.Xb(17,"div",24),s.Xb(18,"div"),s.Xb(19,"div",25),s.Xb(20,"strong",26),s.Zc(21),s.Wb(),s.Wb(),s.Xb(22,"div",27),s.Zc(23),s.oc(24,"translate"),s.oc(25,"formatDateSimple"),s.Wb(),s.Xb(26,"div",28),s.Zc(27),s.oc(28,"translate"),s.oc(29,"formatDateSimple"),s.Wb(),s.Wb(),s.Xb(30,"div",29),s.Xc(31,Zs,1,1,"img",30),s.Wb(),s.Wb(),s.Xb(32,"div",31),s.Xb(33,"div",32),s.Xb(34,"span",33),s.Zc(35),s.oc(36,"translate"),s.Wb(),s.Wb(),s.Xb(37,"div",34),s.Xb(38,"span",33),s.Zc(39),s.oc(40,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(41,"div",35),s.Xb(42,"div",36),s.Xb(43,"div",37),s.Xb(44,"div",38),s.Xb(45,"span",39),s.Zc(46),s.oc(47,"translate"),s.Wb(),s.Wb(),s.Xb(48,"div",40),s.Xb(49,"strong",41),s.Zc(50),s.Wb(),s.Wb(),s.Xb(51,"div",42),s.Zc(52),s.Wb(),s.Wb(),s.Wb(),s.Xb(53,"div",43),s.Xb(54,"div",37),s.Xb(55,"div",38),s.Xb(56,"span",39),s.Zc(57),s.oc(58,"translate"),s.Wb(),s.Wb(),s.Xc(59,Vs,3,1,"div",44),s.Xc(60,Ys,2,1,"div",45),s.Xc(61,zs,3,2,"ng-container",46),s.Wb(),s.Wb(),s.Wb(),s.Xb(62,"div",47),s.Xb(63,"label",48),s.Zc(64),s.oc(65,"translate"),s.Xb(66,"span",49),s.Zc(67),s.oc(68,"translate"),s.Wb(),s.Wb(),s.Xb(69,"input",50),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().invoice.subject=t}))("change",(function(){return s.Oc(e),s.nc().modelChanged()})),s.oc(70,"translate"),s.Wb(),s.Wb(),s.Xb(71,"div",51),s.Sb(72,"invoice-items-table",52,53),s.Wb(),s.Xb(74,"div",54),s.Xb(75,"div",55),s.Xc(76,ec,4,2,"button",56),s.Xc(77,tc,5,3,"button",57),s.Wb(),s.Xb(78,"div",58),s.Xb(79,"div",59),s.Xc(80,ic,8,9,"ng-container",60),s.Xc(81,cc,1,1,"ng-template",null,61,s.Yc),s.Wb(),s.Wb(),s.Wb(),s.Xb(83,"div",62),s.Xb(84,"div",63),s.Xb(85,"div",64),s.Xc(86,oc,8,9,"ng-container",60),s.Xc(87,lc,1,1,"ng-template",null,65,s.Yc),s.Wb(),s.Xb(89,"div",64),s.Xc(90,bc,4,3,"ng-container",46),s.Xc(91,uc,8,9,"ng-container",46),s.Wb(),s.Xb(92,"div",66),s.Xb(93,"span",67),s.Zc(94),s.oc(95,"translate"),s.Wb(),s.Xb(96,"span",68),s.Zc(97),s.oc(98,"roundIfWholeNumber"),s.oc(99,"centsToDollars"),s.Wb(),s.Wb(),s.Xc(100,pc,8,9,"div",69),s.Xc(101,hc,8,9,"div",69),s.Xc(102,mc,8,9,"div",69),s.Xb(103,"div",70),s.Xb(104,"strong",67),s.Zc(105),s.oc(106,"translate"),s.Wb(),s.Xb(107,"strong",71),s.Zc(108),s.oc(109,"roundIfWholeNumber"),s.oc(110,"centsToDollars"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(111,"div",72),s.Xb(112,"label",73),s.Zc(113),s.oc(114,"translate"),s.Xb(115,"span",49),s.Zc(116),s.oc(117,"translate"),s.Wb(),s.Wb(),s.Xb(118,"textarea",74),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().invoice.note=t}))("change",(function(){return s.Oc(e),s.nc().modelChanged()})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.Lc(82),t=s.Lc(88),n=s.nc();s.Cb(5),s.bd(" ",s.pc(6,47,s.pc(7,49,"SUBSCRIPTION_TABS.INVOICES.DOWNLOAD_INVOICE_BTN"))," "),s.Cb(5),s.bd(" ",s.pc(11,51,"INVOICES.DETAILS.ACTIONS")," "),s.Cb(11),s.ad(n.invoice.number),s.Cb(2),s.cd("",s.pc(24,53,"INVOICES.SHARED.ISSUE_DATE"),": ",s.pc(25,55,null==n.invoice?null:n.invoice.issuedDate),""),s.Cb(4),s.cd("",s.pc(28,57,"INVOICES.SHARED.DUE_DATE"),": ",s.pc(29,59,null==n.invoice?null:n.invoice.dueDate),""),s.Cb(4),s.wc("ngIf",n.workspace.image),s.Cb(4),s.bd("",s.pc(36,61,"INVOICES.SHARED.BILL_FROM"),":"),s.Cb(4),s.bd("",s.pc(40,63,"INVOICES.SHARED.BILL_TO"),":"),s.Cb(7),s.bd("",s.pc(47,65,"INVOICES.SHARED.BILL_FROM"),":"),s.Cb(4),s.ad(n.workspace.name),s.Cb(2),s.bd(" ",n.workspace.companyAddress," "),s.Cb(5),s.bd("",s.pc(58,67,"INVOICES.SHARED.BILL_TO"),":"),s.Cb(2),s.wc("ngIf",n.clientData.name),s.Cb(1),s.wc("ngIf",n.clientData.address),s.Cb(1),s.wc("ngIf",!n.disableEdit),s.Cb(3),s.bd("",s.pc(65,69,"INVOICES.DETAILS.SUBJECT")," "),s.Cb(3),s.bd("(",s.pc(68,71,"INVOICES.SHARED.OPTIONAL"),")"),s.Cb(2),s.xc("placeholder",s.pc(70,73,"INVOICES.DETAILS.SUBJECT_QUESTION_PLACEHOLDER")),s.wc("disabled",n.disableEdit)("ngModel",n.invoice.subject),s.Cb(3),s.wc("invoiceItems",n.invoice.items)("invoiceId",n.invoice.id)("disableEdit",n.disableEdit)("workspace",n.workspace),s.Cb(4),s.wc("ngIf",!n.disableEdit&&n.invoice.clientId&&n.activeBillable),s.Cb(1),s.wc("ngIf",!n.disableEdit),s.Cb(3),s.wc("ngIf",n.checkShowDiscount())("ngIfElse",e),s.Cb(6),s.wc("ngIf",n.checkShowTax())("ngIfElse",t),s.Cb(4),s.wc("ngIf",n.checkShowTax()&&!n.checkShowTax2()),s.Cb(1),s.wc("ngIf",n.checkShowTax2()),s.Cb(3),s.ad(s.pc(95,75,"INVOICES.SHARED.SUBTOTAL")),s.Cb(3),s.cd("",s.pc(98,77,s.pc(99,79,n.invoice.subtotal))," ",n.invoice.currency,""),s.Cb(3),s.wc("ngIf",n.invoice.discountAmount),s.Cb(1),s.wc("ngIf",n.invoice.taxAmount),s.Cb(1),s.wc("ngIf",n.invoice.tax2Amount),s.Cb(3),s.ad(s.pc(106,81,"INVOICES.SHARED.TOTAL_AMOUNT")),s.Cb(3),s.cd("",s.pc(109,83,s.pc(110,85,n.invoice.amount))," ",n.invoice.currency,""),s.Cb(5),s.bd("",s.pc(114,87,"INVOICES.SHARED.NOTES")," "),s.Cb(3),s.bd("(",s.pc(117,89,"INVOICES.SHARED.OPTIONAL"),")"),s.Cb(2),s.wc("disabled",n.disableEdit)("ngModel",n.invoice.note)}}function Ec(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",99),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().confirmDelete(n)}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Zc(3),s.oc(4,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,5,"INVOICES.TABLE.DELETE_MODAL_HEADER"))("inProgress",e.inProgress)("isDanger",!0)("btnText",s.pc(2,7,"GLOBAL.DELETE_BTN")),s.Cb(3),s.bd(" ",s.pc(4,9,"INVOICES.TABLE.DELETE_MODAL_TEXT"),". ")}}function fc(e,t){if(1&e){const e=s.Yb();s.Xb(0,"create-invoice",100),s.jc("onSave",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().updateInvoice(n),i.close()}))("isSavingChange",(function(t){return s.Oc(e),s.nc().editInProgress=t}))("onClose",(function(n){s.Oc(e);const i=t.$implicit;return!s.nc().editInProgress&&i.close(n)})),s.Wb()}if(2&e){const e=s.nc();s.wc("invoice",e.invoice)("saveInProgress",e.editInProgress)}}function Sc(e,t){if(1&e){const e=s.Yb();s.Xb(0,"import-invoice-time",101),s.jc("isSavingChange",(function(t){return s.Oc(e),s.nc().editInProgress=t}))("onImport",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().updateInvoice(n),i.close()}))("onClose",(function(n){s.Oc(e);const i=t.$implicit;return!s.nc().editInProgress&&i.close(n)})),s.Wb()}if(2&e){const e=s.nc();s.wc("invoiceId",e.invoice.id)("clientId",e.invoice.clientId)("roundSetting",e.workspace.round)("workspace",e.workspace)("saveInProgress",e.editInProgress)}}function Cc(e,t){if(1&e){const e=s.Yb();s.Xb(0,"edit-client-modal",102),s.jc("onEdit",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().confirmEditClient(n.name,n.address,i)}))("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,3,"GLOBAL.EDIT_LABEL")+" "+e.clientLabelTranslated)("item",e.client)("clientLabel",e.clientLabel)}}const Ac=function(){return{count:2}};let Oc=(()=>{class e{constructor(e,t,n,i,s,c,a){this.route=e,this.invoiceService=t,this.worksapceService=n,this.cd=i,this.clientService=s,this.modalService=c,this.router=a,this.InvoiceStatus=jn.a,this.unsubscribe$=new Fn.a}set invoice(e){this._invoice=e,this.taxBackup=null==e?void 0:e.tax,this.tax2Backup=null==e?void 0:e.tax2,this.discountBackup=null==e?void 0:e.discount,(null==e?void 0:e.tax)&&(this.showTax=!0),(null==e?void 0:e.tax2)&&(this.showTax2=!0),(null==e?void 0:e.discount)&&(this.showDiscount=!0)}get invoice(){return this._invoice}ngOnInit(){this.workspace=this.worksapceService.getLocalDefaultWorkspace(),this.clientLabel=this.workspace.projectGroupingLabel.toLowerCase(),this.clientLabelTranslated=this.worksapceService.generateClientLabel(this.workspace.projectGroupingLabel),this.getInvoice(),this.subscribeToInvoiceChanges(),this.hasExpensesFeature=this.workspace.hasFeature(is.a.EXPENSES),this.activeBillable=this.workspace.activeBillableHours}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}subscribeToInvoiceChanges(){this.invoiceService.invoice$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(({action:e,invoice:t})=>{"delete"===e?this.invoice=t:this.invoice.patchValues(t,["items"]),this.taxBackup=t.tax,this.tax2Backup=t.tax2,this.discountBackup=t.discount,this.cd.detectChanges()})}checkShowDiscount(){return this.invoice.discount||this.invoice.visibleZeroFields.indexOf(Vn.DISCOUNT)>-1}updateShowDiscount(){this.invoice.visibleZeroFields.push(Vn.DISCOUNT),this.modelChanged()}updateShowTax(){this.invoice.visibleZeroFields.push(Vn.TAX),this.modelChanged()}updateShowTax2(){this.invoice.visibleZeroFields.push(Vn.TAX_2),this.modelChanged()}checkShowTax(){return this.invoice.tax||this.invoice.visibleZeroFields.indexOf(Vn.TAX)>-1}checkShowTax2(){return this.invoice.visibleZeroFields.indexOf(Vn.TAX_2)>-1}openModal(e){this.modalService.open(e,{centered:!0})}openBlockedModal(e){this.modalService.open(e,{beforeDismiss:()=>!this.editInProgress,centered:!0})}updateInvoice(e){const t=this.invoice.clientId!==e.clientId;this.invoice=e,this.cd.detectChanges(),t&&this.getInvoice()}getInvoice(){this.invoiceService.getInvoice(this.route.snapshot.params.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.invoice=e,this.clientData={name:e.clientName,address:e.clientAddress},this.availableStatuses=this.invoice.getAvailableStatuses(),this.invoiceStatusLabel=gi(this.invoice.status),this.cd.markForCheck()})}get disableEdit(){var e;return(null===(e=this.invoice)||void 0===e?void 0:e.status)===jn.a.PAID}downloadPdf(){const e=this.invoice.generatePdfFilename(this.clientData.name);this.invoiceService.downloadInvoicePdf(this.invoice.id,e)}markAs(e){this.inProgress||(this.inProgress=!0,this.invoiceService.markAs(this.invoice.id,e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.inProgress=!1,this.invoice.status=e,this.availableStatuses=this.invoice.getAvailableStatuses(),this.invoiceStatusLabel=gi(this.invoice.status),this.cd.markForCheck()},()=>{this.inProgress=!1}))}confirmDelete(e){this.inProgress=!0,this.invoiceService.deleteInvoice(this.invoice.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{e.close(),this.inProgress=!1,this.router.navigate(["/invoices"])},()=>{this.inProgress=!1})}removeDiscount(){this.invoice.discount=0,this.invoice.visibleZeroFields=this.invoice.visibleZeroFields.filter(e=>e!==Vn.DISCOUNT),this.modelChanged()}removeTax(){this.invoice.tax=0,this.invoice.visibleZeroFields=this.invoice.visibleZeroFields.filter(e=>e!==Vn.TAX),this.modelChanged()}removeTax2(){this.invoice.tax2=0,this.invoice.visibleZeroFields=this.invoice.visibleZeroFields.filter(e=>e!==Vn.TAX_2),this.modelChanged()}modelChanged(){this.invoiceService.editInvoice(this.invoice,!1).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>this.updateInvoice(e))}fetchAndEditClient(e){this.editInProgress=!0,this.clientService.getClient(this.invoice.clientId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.editInProgress=!1,this.client=t,this.openModal(e)},()=>{this.editInProgress=!1,this.cd.markForCheck()})}confirmEditClient(e,t,n){this.client.name=e,this.client.address=t,this.editInProgress=!0,this.clientService.update(this.client,!1,this.clientLabel).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.editInProgress=!1,this.clientData={name:e.name,address:e.address},n.close(),this.cd.markForCheck()},e=>{this.editInProgress=!1,this.cd.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.a),s.Rb(ti),s.Rb(l.a),s.Rb(s.h),s.Rb(Mi.a),s.Rb(w.q),s.Rb(k.d))},e.\u0275cmp=s.Lb({type:e,selectors:[["invoice-details"]],decls:19,vars:8,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],["routerLink","/invoices",1,"cl-d-inline-block","cl-mb-2","cl-d-print-none"],[1,"cl-d-flex","cl-align-items-center"],["data-cy","invoice-name"],["class","cl-badge-approve cl-text-capitalize cl-ml-2",3,"ngClass",4,"ngIf"],["class","cl-card cl-border-bottom",4,"ngIf"],["deleteModal",""],["editModal",""],["importTimeModal",""],["editClientModal",""],[1,"cl-badge-approve","cl-text-capitalize","cl-ml-2",3,"ngClass"],[1,"cl-card","cl-border-bottom"],[1,"cl-card-body"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-mb-3"],[1,"cl-btn","cl-btn-outline-primary",3,"click"],["downloadBtn",""],["dropdownKey","","tabCell","",1,"cl-dropdown"],["dropdownKeyButton","","tabindex","0",1,"cl-btn","cl-btn-outline-light","cl-text-left","cl-dropdown-toggle"],["openUpAtBottom","","class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["tabFocus","","tabindex","0"],["tabFocusDuplicate",""],[1,"cl-card","cl-border-bottom","cl-add-shadow-default"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-py-3","cl-mb-3"],[1,"cl-h1","cl-mb-2","cl-text-dark"],["data-cy","invoice-number"],["data-cy","invoice-issue-date",1,"cl-h2","cl-mb-0","cl-text-gray-6"],["data-cy","invoice-due-date",1,"cl-h2","cl-mb-0","cl-text-gray-6"],[1,"cl-invoice-logo"],["alt","Workspace image","class","cl-w-100",3,"src",4,"ngIf"],[1,"cl-row","cl-no-gutters","cl-mx-n3","cl-border-top","cl-border-bottom","cl-mb-3","cl-d-none","cl-d-lg-flex"],[1,"cl-col-lg-6","cl-mb-3","cl-mb-lg-0","cl-card-header","cl-border-0"],[1,"cl-h6","cl-mb-0","cl-px-3"],[1,"cl-col-lg-6","cl-card-header","cl-border-left","cl-border-bottom-0"],[1,"cl-row","cl-no-gutters","cl-mx-n3","cl-mb-3"],[1,"cl-col-lg-6","cl-mb-3","cl-mb-lg-0"],[1,"cl-px-3"],[1,"cl-mx-n2","cl-mb-3","cl-card-header","cl-px-2","cl-border-top","cl-d-flex","cl-d-lg-none"],[1,"cl-h6","cl-mb-0"],[1,"cl-h2","cl-mb-0"],["data-cy","bill-from"],[1,"cl-whitespace-pre-line"],[1,"cl-col-lg-6"],["class","cl-h2 cl-mb-0",4,"ngIf"],["class","cl-whitespace-pre-line",4,"ngIf"],[4,"ngIf"],[1,"cl-form-group","cl-mb-3"],["for","subject"],[1,"cl-text-lowercase"],["type","text","id","subject",1,"cl-form-control",3,"disabled","placeholder","ngModel","ngModelChange","change"],[1,"cl-mb-2"],[3,"invoiceItems","invoiceId","disableEdit","workspace"],["itemsTable",""],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-start","cl-justify-content-lg-between","cl-flex-column","cl-flex-lg-row","cl-mb-3"],[1,"cl-mb-2","cl-mb-lg-0","cl-w-100"],["class","cl-btn cl-btn-primary cl-mr-2","data-cy","import-time",3,"click",4,"ngIf"],["class","cl-btn cl-btn-outline-light",3,"click",4,"ngIf"],[1,"cl-w-100"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-lg-end"],[4,"ngIf","ngIfElse"],["addDiscountTemplate",""],[1,"cl-row"],[1,"cl-col-lg-4","cl-ml-auto"],[1,"cl-mb-2","cl-d-flex","cl-justify-content-end","cl-align-items-center"],["addTaxTemplate",""],[1,"cl-d-flex","cl-border-bottom","cl-py-2","cl-justify-content-between"],[1,"cl-text-uppercase"],["data-cy","invoice-subtotal"],["class","cl-d-flex cl-border-bottom cl-py-2 cl-justify-content-between",4,"ngIf"],[1,"cl-d-flex","cl-py-2","cl-justify-content-between"],["data-cy","invoice-total"],[1,"cl-form-group","cl-mb-0"],["for","note"],["name","note","id","note","cols","30","rows","6",1,"cl-form-control",3,"disabled","ngModel","ngModelChange","change"],["openUpAtBottom","",1,"cl-dropdown-menu","cl-dropdown-menu-right"],["class","cl-dropdown-item","tabindex","-1","clickCloseDropdown","",3,"keyup.enter","keyup.space","click",4,"ngFor","ngForOf"],["tabindex","-1","clickCloseDropdown","",1,"cl-dropdown-item",3,"disabled","keyup.enter","keyup.space","click"],["tabindex","-1","clickCloseDropdown","",1,"cl-dropdown-item",3,"keyup.enter","keyup.space","click"],["alt","Workspace image",1,"cl-w-100",3,"src"],["data-cy","bill-to"],["class","cl-btn cl-btn-outline-primary cl-d-print-none cl-mt-2",3,"ngClass","click",4,"ngIf"],["class","cl-btn cl-btn-outline-primary cl-d-print-none cl-mt-2",3,"click",4,"ngIf"],[1,"cl-btn","cl-btn-outline-primary","cl-d-print-none","cl-mt-2",3,"ngClass","click"],[1,"cl-btn","cl-btn-outline-primary","cl-d-print-none","cl-mt-2",3,"click"],["data-cy","import-time",1,"cl-btn","cl-btn-primary","cl-mr-2",3,"click"],["noExpenses",""],[1,"cl-btn","cl-btn-outline-light",3,"click"],["src","assets/images/ui-icons/plus-blue.svg"],[1,"cl-ml-2"],[1,"cl-w-100","cl-text-right","cl-text-gray-6"],["numericInput","","type","text",1,"cl-form-control","cl-ml-2","cl-text-right","cl-style-disabled-inputs",2,"width","110px",3,"disabled","decimals","ngModel","minNumber","maxNumber","keyup.enter","inputChange"],["discountInput",""],["class","cl-btn-link cl-ml-3",3,"click",4,"ngIf"],[1,"cl-btn-link","cl-ml-3",3,"click"],["class","cl-btn-link",3,"click",4,"ngIf"],[1,"cl-btn-link",3,"click"],["numericInput","","type","text",1,"cl-form-control","cl-ml-2","cl-text-right","cl-style-disabled-inputs",2,"width","110px",3,"disabled","decimals","minNumber","maxNumber","ngModel","keyup.enter","inputChange"],["taxInput",""],[3,"title","inProgress","isDanger","btnText","confirmed","close"],[3,"invoice","saveInProgress","onSave","isSavingChange","onClose"],[3,"invoiceId","clientId","roundSetting","workspace","saveInProgress","isSavingChange","onImport","onClose"],[3,"title","item","clientLabel","onEdit","onClose"]],template:function(e,t){1&e&&(s.Xb(0,"main",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"a",3),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"h1",4),s.Xb(7,"span",5),s.Zc(8),s.Wb(),s.Xc(9,xs,3,4,"span",6),s.Wb(),s.Wb(),s.Xc(10,gc,119,91,"div",7),s.Wb(),s.Wb(),s.Xc(11,Ec,5,11,"ng-template",null,8,s.Yc),s.Xc(13,fc,1,2,"ng-template",null,9,s.Yc),s.Xc(15,Sc,1,5,"ng-template",null,10,s.Yc),s.Xc(17,Cc,2,5,"ng-template",null,11,s.Yc)),2&e&&(s.Cb(4),s.bd(" ",s.qc(5,4,"INVOICES.INVOICE",s.Ac(7,Ac))," "),s.Cb(4),s.ad(null==t.invoice?null:t.invoice.number),s.Cb(1),s.wc("ngIf",t.invoice),s.Cb(1),s.wc("ngIf",t.invoice))},directives:[k.g,i.u,i.r,ni.a,ii.a,si.a,v.c,v.s,v.v,As,fi.a,i.t,ls,Si.a,Hi,Us,Gs],pipes:[g.e,i.I,Ci.a,Ai.a,Oi.a,i.q],encapsulation:2,changeDetection:0}),e})();var vc=n("+EM1"),Tc=n("KY19"),Ic=n("5Ra6"),wc=n("ZHjv"),Lc=n("qfBg"),Rc=n("JuMI"),yc=n("OPDC");class _c{constructor(e,t){this._data=e,this._label=t}toChartReadable(){return{data:this.data,label:this.label}}get data(){return this._data}set data(e){this._data=e}get label(){return this._label}set label(e){this._label=e}}var kc=n("jy+1"),Wc=function(e){return e.LATEST_ACTIVITY="LATEST_ACTIVITY",e.TEAM_MEMBER="TEAM_MEMBER",e.TOTAL="TOTAL",e}({}),Xc=n("FwEu"),Nc=n("QKuU"),Dc=n("eGqU"),Pc=(n("10sm"),n("0Mwv"));const Mc=function(e,t){return{"background-color":e,width:t}};function Bc(e,t){if(1&e&&s.Sb(0,"div",2),2&e){const e=t.$implicit;s.wc("ngStyle",s.Cc(1,Mc,e.color,e.percentage))}}const Uc=function(e){return{width:e}};let Gc=(()=>{class e{constructor(e){this.translateService=e,this.dashboardViewType=yc.a,this.BILLABLE_COLOR="#8BC34A",this.NON_BILLABLE_COLOR="#AED581"}ngOnInit(){if(this.isChart&&this.latestActivityItems&&this.latestActivityItems.length>0){const e=this.latestActivityItems[0];if(this.type===yc.a.BILLABILITY&&e.duration!==e.billableDuration){const t=Object(ke.duration)(e.duration).subtract(Object(ke.duration)(e.billableDuration)),n=Object(ke.duration)(e.billableDuration).asSeconds()/this.largestDuration*100,i=Object(ke.duration)(t).asSeconds()/this.largestDuration*100,s=[];s.push({label:this.translateService.instant("GLOBAL.BILLABLE_LABEL"),projectName:e.projectName,clientName:e.clientName,color:this.BILLABLE_COLOR,duration:e.billableDuration,earned:e.earned,percentage:+Number(n).toFixed(2)+"%"}),s.push({label:this.translateService.instant("GLOBAL.NON_BILLABLE_LABEL"),projectName:e.projectName,clientName:e.clientName,color:this.NON_BILLABLE_COLOR,duration:t,earned:0,percentage:+Number(i).toFixed(2)+"%"}),this.latestActivityItems=s}}}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["horizontal-bar-chart"]],inputs:{latestActivityItems:"latestActivityItems",largestDuration:"largestDuration",currencySymbol:"currencySymbol",type:"type",totalPercentage:"totalPercentage",isChart:"isChart"},decls:2,vars:4,consts:[[1,"cl-horizontal-chart--progress",3,"ngStyle"],["class","cl-horizontal-chart--progress--item",3,"ngStyle",4,"ngFor","ngForOf"],[1,"cl-horizontal-chart--progress--item",3,"ngStyle"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xc(1,Bc,1,4,"div",1),s.Wb()),2&e&&(s.wc("ngStyle",s.Bc(2,Uc,t.totalPercentage+"%")),s.Cb(1),s.wc("ngForOf",t.latestActivityItems))},directives:[i.x,i.t],encapsulation:2}),e})();var xc=n("n0VX"),Fc=n("N2Ql"),jc=n("DCUz"),Zc=n("9G2T"),Vc=n("4jLH");const Yc=["tooltip"];function Hc(e,t){if(1&e&&s.Sb(0,"i",32),2&e){const e=s.nc(2);s.Wc("background",e.activity.projectColor,s.Kb)}}function $c(e,t){1&e&&s.Sb(0,"span",33)}function Kc(e,t){if(1&e&&(s.Xb(0,"div",26),s.Xb(1,"div",27),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",27),s.Xb(5,"span",28),s.Xc(6,Hc,1,2,"i",29),s.Xb(7,"span"),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Xc(10,$c,1,0,"span",30),s.Xb(11,"span",31),s.Zc(12),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.Db("title",e.activity.description),s.Cb(1),s.bd(" ",s.pc(3,7,e.activity.description||"PAGES.DASHBOARD.TEAM_ACTIVITIES.ACTIVITY.NO_DESCRIPTION")," "),s.Cb(2),s.Db("title",null!=e.activity&&null!=e.activity.clientName&&e.activity.clientName.length?(null==e.activity?null:e.activity.titleWithoutClient)+" - "+(null==e.activity?null:e.activity.clientName):null==e.activity?null:e.activity.titleWithoutClient),s.Cb(2),s.wc("ngIf",e.activity.projectColor),s.Cb(2),s.ad(s.pc(9,9,e.activity.titleWithoutClient)),s.Cb(2),s.wc("ngIf",e.activity.clientName),s.Cb(2),s.ad(e.activity.clientName)}}function qc(e,t){1&e&&(s.Xb(0,"div",26),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"PAGES.DASHBOARD.TEAM_ACTIVITIES.ACTIVITY.NO")," "))}function zc(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"stringDurationToTime"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.qc(2,1,e.activity.duration,e.format)," ")}}function Qc(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"secondsToDuration"),s.Sb(3,"img",36),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.qc(2,1,e.activity.timer,"HH:mm:ss")," ")}}function Jc(e,t){if(1&e&&(s.Xb(0,"div",34),s.Xc(1,zc,3,4,"span",35),s.Xc(2,Qc,4,4,"span",35),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.activity.duration),s.Cb(1),s.wc("ngIf",!e.activity.duration)}}function ea(e,t){1&e&&(s.Xb(0,"div",37),s.Xb(1,"span"),s.Zc(2,"--"),s.Wb(),s.Wb())}function ta(e,t){if(1&e&&(s.Xb(0,"div",38),s.oc(1,"formatStart"),s.Xb(2,"span"),s.Zc(3),s.oc(4,"durationToHumanize"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Db("title",s.rc(1,2,e.activity.start,e.timeFormat,e.currentLanguage)),s.Cb(3),s.ad(s.qc(4,6,e.activity.end,e.activity.start))}}function na(e,t){1&e&&(s.Xb(0,"div",38),s.Xb(1,"span"),s.Zc(2,"--"),s.Wb(),s.Wb())}function ia(e,t){if(1&e&&s.Sb(0,"span",32),2&e){const e=s.nc(2).$implicit;s.Wc("background",e.color,s.Kb)}}function sa(e,t){1&e&&s.Sb(0,"span",33)}function ca(e,t){if(1&e&&(s.Xb(0,"div",20),s.Xb(1,"div",27),s.Xb(2,"span",40),s.Xc(3,ia,1,2,"span",29),s.Xb(4,"span"),s.Zc(5),s.Wb(),s.Xc(6,sa,1,0,"span",30),s.Xb(7,"span",31),s.Zc(8),s.Wb(),s.Wb(),s.Wb(),s.Xb(9,"div",41),s.Xb(10,"span"),s.Zc(11),s.oc(12,"stringDurationToTime"),s.Wb(),s.Xb(13,"span"),s.Zc(14),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc().$implicit,t=s.nc();s.Cb(3),s.wc("ngIf",t.type===t.dashboardViewType.PROJECT),s.Cb(2),s.ad(e.projectName),s.Cb(1),s.wc("ngIf",e.clientName),s.Cb(2),s.ad(e.clientName),s.Cb(3),s.ad(s.qc(12,6,e.duration,t.format)),s.Cb(3),s.ad(e.percentage)}}function aa(e,t){if(1&e&&(s.Vb(0),s.Xc(1,ca,15,9,"div",39),s.Ub()),2&e){const e=t.index;s.Cb(1),s.wc("ngIf",e<10)}}function oa(e,t){1&e&&(s.Xb(0,"div",42),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,1,"GLOBAL.CLICK_TO_SEE_ALL")))}function ra(e,t){if(1&e&&s.Sb(0,"i",32),2&e){const e=s.nc().$implicit;s.Wc("background",e.color,s.Kb)}}function la(e,t){1&e&&s.Sb(0,"span",33)}function ba(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"tr"),s.Xb(2,"td"),s.Xb(3,"span",52),s.Xc(4,ra,1,2,"i",29),s.Xb(5,"span"),s.Zc(6),s.Wb(),s.Xc(7,la,1,0,"span",30),s.Xb(8,"span",31),s.Zc(9),s.Wb(),s.Wb(),s.Wb(),s.Xb(10,"td",51),s.Zc(11),s.oc(12,"stringDurationToTime"),s.Wb(),s.Xb(13,"td",53),s.Zc(14),s.Wb(),s.Wb(),s.Ub()),2&e){const e=t.$implicit,n=s.nc(2);s.Cb(4),s.wc("ngIf",n.type===n.dashboardViewType.PROJECT),s.Cb(2),s.ad(e.projectName),s.Cb(1),s.wc("ngIf",e.clientName),s.Cb(2),s.ad(e.clientName),s.Cb(2),s.ad(s.qc(12,6,e.duration,n.format)),s.Cb(3),s.ad(e.percentage)}}function da(e,t){if(1&e&&(s.Xb(0,"div",43),s.Xb(1,"h1",44),s.Zc(2),s.Wb(),s.Xb(3,"button",45),s.jc("click",(function(){return t.$implicit.dismiss()})),s.Xb(4,"span",46),s.Sb(5,"img",47),s.Wb(),s.Wb(),s.Wb(),s.Xb(6,"div",48),s.Xb(7,"table",49),s.Xb(8,"tr"),s.Xb(9,"th",50),s.Xb(10,"b"),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb(),s.Xb(13,"th",51),s.Xb(14,"b"),s.Zc(15),s.oc(16,"stringDurationToTime"),s.Wb(),s.Wb(),s.Xb(17,"th",21),s.Zc(18),s.oc(19,"localizeEarningWithCurrency"),s.Wb(),s.Wb(),s.Xc(20,ba,15,9,"ng-container",23),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(e.activity.user.name),s.Cb(9),s.ad(s.pc(12,5,"GLOBAL.PROJECTS_LABEL")),s.Cb(4),s.bd(" ",s.qc(16,7,e.activity.totalTime,e.format)," "),s.Cb(3),s.bd(" ",e.type===e.dashboardViewType.BILLABILITY&&e.canSeeRates?s.qc(19,10,e.activity.earning,e.currency):""," "),s.Cb(2),s.wc("ngForOf",e.activity.latestActivityItems)}}let ua=(()=>{class e{constructor(e){this.modalService=e,this.dashboardViewType=yc.a}ngOnInit(){this.currencySymbol=Object(i.L)(this.currency,"narrow");const e=Object(ke.duration)(this.activity.totalTime).asSeconds();this.totalPercentage=e/this.largestDuration*100}openLatestModal(e){this.modalService.open(e,{centered:!0})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q))},e.\u0275cmp=s.Lb({type:e,selectors:[["dashboard-latest-activity-row"]],viewQuery:function(e,t){var n;1&e&&s.gd(Yc,!0),2&e&&s.Kc(n=s.kc())&&(t.tooltip=n.first)},inputs:{activity:"activity",format:"format",currency:"currency",largestDuration:"largestDuration",type:"type",timeFormat:"timeFormat",pinToTop:"pinToTop",canSeeRates:"canSeeRates",currentLanguage:"currentLanguage"},decls:43,vars:36,consts:[[1,"cl-component-row","cl-flex-column","cl-flex-lg-row"],[1,"cl-dashboard-table-col-1"],[1,"cl-avatar",3,"classSize","src","name"],[1,"cl-mx-2","cl-cut-text",3,"title"],[1,"cl-d-flex","cl-d-lg-none","cl-ml-auto"],[1,"cl-dashboard-table-col-2"],[1,"cl-d-flex","cl-align-items-center"],["class","cl-dashboard-table-col-2-1 cl-add-border-left-lg",4,"ngIf"],[1,"cl-dashboard-table-col-2-2"],["class","cl-dashboard-table-col-2-2-1 cl-text-right",4,"ngIf"],["class","cl-dashboard-table-col-2-2-1",4,"ngIf"],["class","cl-dashboard-table-col-2-2-2",4,"ngIf"],[1,"cl-dashboard-table-col-3","cl-d-none","cl-d-lg-flex"],[1,"cl-d-flex","cl-align-items-center","cl-horizontal-chart"],[1,"cl-dashboard-table-col-3-1","cl-add-border-left-lg","cl-align-items-center"],[1,"cl-text-dark"],[1,"cl-dashboard-table-col-3-2","cl-main-horizontal-chart-container--progress",3,"click"],[1,"cl-main-horizontal-chart-container--progress--bar",3,"latestActivityItems","largestDuration","currencySymbol","type","totalPercentage","isChart"],[1,"cl-custom-tooltip"],[1,"cl-top"],[1,"cl-custom-tooltip-row"],[1,"cl-text-right"],[1,"cl-custom-tooltip-currency"],[4,"ngFor","ngForOf"],["class","cl-custom-tooltip-footer",4,"ngIf"],["content",""],[1,"cl-dashboard-table-col-2-1","cl-add-border-left-lg"],[1,"cl-cut-text"],[1,"cl-project-name","cl-text-dark","cl-listing-project-client"],["class","cl-entry__project__dot",3,"background",4,"ngIf"],["class","cl-h-line-divider",4,"ngIf"],[1,"cl-listing-client"],[1,"cl-entry__project__dot"],[1,"cl-h-line-divider"],[1,"cl-dashboard-table-col-2-2-1","cl-text-right"],[4,"ngIf"],["src","assets/images/ui-icons/recording.svg",1,"cl-recording"],[1,"cl-dashboard-table-col-2-2-1"],[1,"cl-dashboard-table-col-2-2-2"],["class","cl-custom-tooltip-row",4,"ngIf"],[1,"cl-project-name","cl-listing-project-client"],[1,"cl-custom-tooltip-col-right"],[1,"cl-custom-tooltip-footer"],[1,"cl-modal-header"],[1,"cl-modal-title","cl-text-break"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body","cl-overflow-auto"],[1,"cl-m-0","tr-table-reset","cl-w-100"],["ngbAutofocus","",1,"cl-pb-2"],[1,"cl-text-right","cl-px-2"],[1,"cl-project-name"],[1,"cl-text-gray-9","cl-text-right"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Sb(2,"avatar",2),s.Xb(3,"div",3),s.Zc(4),s.Wb(),s.Xb(5,"div",4),s.Xb(6,"span"),s.Zc(7),s.oc(8,"stringDurationToTime"),s.Wb(),s.Wb(),s.Wb(),s.Xb(9,"div",5),s.Xb(10,"div",6),s.Xc(11,Kc,13,11,"div",7),s.Xc(12,qc,3,3,"div",7),s.Xb(13,"div",8),s.Xc(14,Jc,3,2,"div",9),s.Xc(15,ea,3,0,"div",10),s.Xc(16,ta,5,9,"div",11),s.Xc(17,na,3,0,"div",11),s.Wb(),s.Wb(),s.Wb(),s.Xb(18,"div",12),s.Xb(19,"div",13),s.Xb(20,"div",14),s.Xb(21,"span",15),s.Zc(22),s.oc(23,"stringDurationToTime"),s.Wb(),s.Wb(),s.Xb(24,"div",16),s.jc("click",(function(){s.Oc(e);const n=s.Lc(42);return t.openLatestModal(n)})),s.Sb(25,"horizontal-bar-chart",17),s.Xb(26,"span",18),s.Xb(27,"div",19),s.Xb(28,"div",20),s.Xb(29,"div"),s.Zc(30),s.Wb(),s.Xb(31,"div",21),s.Xb(32,"span"),s.Zc(33),s.oc(34,"stringDurationToTime"),s.Wb(),s.Xb(35,"span",22),s.Zc(36),s.oc(37,"localizeEarningWithCurrency"),s.Wb(),s.Wb(),s.Wb(),s.Xc(38,aa,2,1,"ng-container",23),s.Xc(39,oa,4,3,"div",24),s.Sb(40,"i"),s.Wb(),s.Wb(),s.Wb(),s.Xc(41,da,21,13,"ng-template",null,25,s.Yc),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.wc("classSize","cl-no-image-wrapper-md")("src",t.activity.user.profilePicture)("name",t.activity.user.name),s.Cb(1),s.xc("title",t.activity.user.name),s.Cb(1),s.ad(t.activity.user.name),s.Cb(3),s.ad(s.qc(8,24,t.activity.totalTime,t.format)),s.Cb(4),s.wc("ngIf",t.activity.start),s.Cb(1),s.wc("ngIf",!t.activity.start),s.Cb(2),s.wc("ngIf",t.activity.start),s.Cb(1),s.wc("ngIf",!t.activity.start),s.Cb(1),s.wc("ngIf",t.activity.start),s.Cb(1),s.wc("ngIf",!t.activity.start),s.Cb(5),s.bd(" ",s.qc(23,27,t.activity.totalTime,t.format)," "),s.Cb(3),s.wc("latestActivityItems",t.activity.latestActivityItems)("largestDuration",t.largestDuration)("currencySymbol",t.currencySymbol)("type",t.type)("totalPercentage",t.totalPercentage)("isChart",!1),s.Cb(5),s.ad(t.activity.user.name),s.Cb(3),s.ad(s.qc(34,30,t.activity.totalTime,t.format)),s.Cb(3),s.bd(" ",t.type===t.dashboardViewType.BILLABILITY&&t.canSeeRates?s.qc(37,33,t.activity.earning,t.currency):""," "),s.Cb(2),s.wc("ngForOf",t.activity.latestActivityItems),s.Cb(1),s.wc("ngIf",t.activity.latestActivityItems&&t.activity.latestActivityItems.length>10))},directives:[Pc.a,i.u,Gc,i.t],pipes:[xc.a,Fc.a,g.e,jc.a,Zc.a,Vc.a],encapsulation:2}),e})();function pa(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",19),s.Xb(1,"a",20),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.sortActivities(t.LatestSortBy.TEAM_MEMBER)})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"a",20),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.sortActivities(t.LatestSortBy.TEAM_MEMBER)})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"a",20),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.sortActivities(t.LatestSortBy.LATEST_ACTIVITY)})),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Xb(10,"a",20),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.sortActivities(t.LatestSortBy.LATEST_ACTIVITY)})),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xb(13,"a",20),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.sortActivities(t.LatestSortBy.TOTAL)})),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Xb(16,"a",20),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.sortActivities(t.LatestSortBy.TOTAL)})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.Hb("cl-active",e.sort.column===e.LatestSortBy.TEAM_MEMBER&&e.sort.order===e.SortOrder.ASCENDING),s.Cb(1),s.bd(" ",s.pc(3,18,"PAGES.DASHBOARD.TEAM_ACTIVITIES.SORT.MEMBER.ASCENDING")," "),s.Cb(2),s.Hb("cl-active",e.sort.column===e.LatestSortBy.TEAM_MEMBER&&e.sort.order===e.SortOrder.DESCENDING),s.Cb(1),s.bd(" ",s.pc(6,20,"PAGES.DASHBOARD.TEAM_ACTIVITIES.SORT.MEMBER.DESCENDING")," "),s.Cb(2),s.Hb("cl-active",e.sort.column===e.LatestSortBy.LATEST_ACTIVITY&&e.sort.order===e.SortOrder.ASCENDING),s.Cb(1),s.bd(" ",s.pc(9,22,"PAGES.DASHBOARD.TEAM_ACTIVITIES.SORT.LATEST_ACTIVITY.ASCENDING")," "),s.Cb(2),s.Hb("cl-active",e.sort.column===e.LatestSortBy.LATEST_ACTIVITY&&e.sort.order===e.SortOrder.DESCENDING),s.Cb(1),s.bd(" ",s.pc(12,24,"PAGES.DASHBOARD.TEAM_ACTIVITIES.SORT.LATEST_ACTIVITY.DESCENDING")," "),s.Cb(2),s.Hb("cl-active",e.sort.column===e.LatestSortBy.TOTAL&&e.sort.order===e.SortOrder.ASCENDING),s.Cb(1),s.bd(" ",s.pc(15,26,"PAGES.DASHBOARD.TEAM_ACTIVITIES.SORT.TOTAL_TRACKED.ASCENDING")," "),s.Cb(2),s.Hb("cl-active",e.sort.column===e.LatestSortBy.TOTAL&&e.sort.order===e.SortOrder.DESCENDING),s.Cb(1),s.bd(" ",s.pc(18,28,"PAGES.DASHBOARD.TEAM_ACTIVITIES.SORT.TOTAL_TRACKED.DESCENDING")," ")}}function ha(e,t){if(1&e&&(s.Vb(0),s.Sb(1,"dashboard-latest-activity-row",21),s.Ub()),2&e){const e=t.$implicit,n=s.nc();s.Cb(1),s.wc("activity",e)("format",n.format)("currency",n.currency)("largestDuration",n.largestDuration)("type",n.dashboardViewType)("timeFormat",n.timeFormat)("pinToTop",n.pinToTop)("canSeeRates",n.canSeeRates)("currentLanguage",n.currentLanguage)}}function ma(e,t){if(1&e){const e=s.Yb();s.Xb(0,"pager",22),s.jc("pageChanged",(function(t){return s.Oc(e),s.nc().setPagination(t)}))("limitChanged",(function(t){return s.Oc(e),s.nc().setPagination(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("page",null==e.pager?null:e.pager.page)("limit",null==e.pager?null:e.pager.limit)("total",e.usersCount)}}let ga=(()=>{class e{constructor(e,t,n){this.reportService=e,this.userService=t,this.authService=n,this.pinToTopEmitter=new s.n,this.sort={column:Wc.LATEST_ACTIVITY,order:bi.a.DESCENDING},this.SortOrder=bi.a,this.LatestSortBy=Wc,this.unsubscribe$=new Fn.a}set earningByUser(e){e&&(this._earningByUser=e,this.latestActivity&&this.addEarningByUser(e))}get earningByUser(){return this._earningByUser}ngOnInit(){this.user=this.authService.getUser(),this.timeFormat=this.user.settings.timeFormat,this.getUsersCount()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete(),clearInterval(this.activityTimers)}getLatestActivity(){this.reportService.getLatestActivityOfWorkspace(this.dateRange,this.dashboardViewType,this.sort.column,this.sort.order,this.pager?this.pager.page:1,this.pager?this.pager.limit:In.j).subscribe(e=>{this.latestActivity=e,this.getLargestDuration(e.map(e=>e)),this.updateTimers(e),this.earningByUser&&this.addEarningByUser(this.earningByUser)})}getUsersCount(){this.userService.getUsersCount(Xc.a.ACTIVE).subscribe(e=>{this.usersCount=e,e>In.j&&setTimeout(()=>{this.setDefaultPager()})})}setDefaultPager(){this.pager.setPaginationManually({page:1,limit:In.j,total:this.usersCount})}addEarningByUser(e){this.latestActivity&&this.latestActivity.forEach(t=>{t.earning=e[t.user.id]?e[t.user.id]:0})}getLargestDuration(e){const t=e.sort(Object(kc.b)(!0,e=>Object(ke.duration)(e.totalTime).asSeconds()));if(t.length>0){const e=t[0];this.largestDuration=Object(ke.duration)(e.totalTime).asSeconds()}else this.largestDuration=0}updateTimers(e){const t=e.filter(e=>!e.end);t.length>0&&(this.activityTimers=setInterval(()=>{t.forEach(e=>{e.timer=Object(ke.duration)(ke().diff(ke(e.start))).asSeconds()})},1e3))}pinTeamActivity(){this.pinToTop=!this.pinToTop,this.user.settings.dashboardPinToTop=this.pinToTop,this.pinToTopEmitter.emit(this.pinToTop),this.userService.updateSettings(this.user).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{})}sortActivities(e){this.usersCount>In.j&&this.setDefaultPager(),this.sort=this.getSort(e),this.getLatestActivity()}getSort(e){return e===this.sort.column?(this.sort.order=this.sort.order==bi.a.ASCENDING?bi.a.DESCENDING:bi.a.ASCENDING,this.sort):e===Wc.TEAM_MEMBER?(this.sort={column:Wc.TEAM_MEMBER,order:bi.a.ASCENDING},this.sort):(this.sort={column:e,order:bi.a.DESCENDING},this.sort)}setPagination(e){this.pager.setPaginationManually(e),this.getLatestActivity()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Tc.a),s.Rb(Lc.a),s.Rb(re.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["dashboard-latest-activity"]],viewQuery:function(e,t){var n;1&e&&s.gd(Pi.a,!0),2&e&&s.Kc(n=s.kc())&&(t.pager=n.first)},inputs:{earningByUser:"earningByUser",dateRange:"dateRange",pinToTop:"pinToTop",format:"format",dashboardViewType:"dashboardViewType",currency:"currency",currentLanguage:"currentLanguage",canSeeRates:"canSeeRates"},outputs:{pinToTopEmitter:"pinToTopEmitter"},decls:33,vars:38,consts:[[1,"cl-card"],[1,"cl-card-header","cl-px-2","cl-px-lg-3"],[1,"cl-d-flex","cl-w-100","cl-align-items-center","cl-justify-content-between"],[1,"cl-h6","cl-mb-0"],[3,"click"],[3,"src"],[1,"cl-card-header","cl-bg-white","cl-pl-0","cl-d-flex","cl-d-lg-none"],["dropdown","",1,"cl-dropdown"],["id","dropdownMenuButton","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"cl-component-divided-left","cl-small","cl-no-divider-border","cl-dropdown-toggle"],["class","cl-dropdown-menu cl-prevent-close","aria-labelledby","dropdownMenuButton",4,"dropdownContent"],[1,"cl-card-header","cl-bg-white","cl-d-none","cl-d-lg-flex","cl-small"],[1,"cl-dashboard-table-col-1"],[1,"cl-text-gray-6","cl-sort-by","cl-down",3,"click"],[1,"cl-dashboard-table-col-2"],[1,"cl-text-gray-6","cl-sort-by","cl-up",3,"click"],[1,"cl-dashboard-table-col-3"],[1,"cl-text-gray-6","cl-sort-by",3,"click"],[4,"ngFor","ngForOf"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],["aria-labelledby","dropdownMenuButton",1,"cl-dropdown-menu","cl-prevent-close"],["closeDropdown","",1,"cl-dropdown-item",3,"click"],[1,"cl-border-bottom","cl-hover-shadow",3,"activity","format","currency","largestDuration","type","timeFormat","pinToTop","canSeeRates","currentLanguage"],[3,"page","limit","total","pageChanged","limitChanged"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"span",3),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"span"),s.Xb(7,"a",4),s.jc("click",(function(){return t.pinTeamActivity()})),s.Sb(8,"img",5),s.oc(9,"translate"),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(11,"div",6),s.Xb(12,"div",7),s.Xb(13,"div",8),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Xc(16,pa,19,30,"div",9),s.Wb(),s.Wb(),s.Xb(17,"div",10),s.Xb(18,"div",11),s.Xb(19,"a",12),s.jc("click",(function(){return t.sortActivities(t.LatestSortBy.TEAM_MEMBER)})),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Wb(),s.Xb(22,"div",13),s.Xb(23,"a",14),s.jc("click",(function(){return t.sortActivities(t.LatestSortBy.LATEST_ACTIVITY)})),s.Zc(24),s.oc(25,"translate"),s.Wb(),s.Wb(),s.Xb(26,"div",15),s.Xb(27,"a",16),s.jc("click",(function(){return t.sortActivities(t.LatestSortBy.TOTAL)})),s.Zc(28),s.oc(29,"translate"),s.oc(30,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xc(31,ha,2,9,"ng-container",17),s.Wb(),s.Xc(32,ma,1,3,"pager",18)),2&e&&(s.Cb(4),s.ad(s.pc(5,22,"PAGES.DASHBOARD.TEAM_ACTIVITIES.TITLE")),s.Cb(4),s.wc("src",t.pinToTop?"assets/images/ui-icons/pin-active.svg":"assets/images/ui-icons/pin-inactive.svg",s.Qc),s.Db("title",t.pinToTop?s.pc(9,24,"PAGES.DASHBOARD.TEAM_ACTIVITIES.UNPIN"):s.pc(10,26,"PAGES.DASHBOARD.TEAM_ACTIVITIES.PIN")),s.Cb(6),s.bd("",s.pc(15,28,"SORT")," "),s.Cb(5),s.Hb("cl-up",t.sort.column===t.LatestSortBy.TEAM_MEMBER&&t.sort.order===t.SortOrder.ASCENDING)("cl-down",t.sort.column===t.LatestSortBy.TEAM_MEMBER&&t.sort.order===t.SortOrder.DESCENDING),s.Cb(1),s.bd(" ",s.pc(21,30,"PAGES.DASHBOARD.TEAM_ACTIVITIES.HEADER.MEMBER")," "),s.Cb(3),s.Hb("cl-up",t.sort.column===t.LatestSortBy.LATEST_ACTIVITY&&t.sort.order===t.SortOrder.ASCENDING)("cl-down",t.sort.column===t.LatestSortBy.LATEST_ACTIVITY&&t.sort.order===t.SortOrder.DESCENDING),s.Cb(1),s.bd(" ",s.pc(25,32,"PAGES.DASHBOARD.TEAM_ACTIVITIES.HEADER.LATEST_ACTIVITY")," "),s.Cb(3),s.Hb("cl-up",t.sort.column===t.LatestSortBy.TOTAL&&t.sort.order===t.SortOrder.ASCENDING)("cl-down",t.sort.column===t.LatestSortBy.TOTAL&&t.sort.order===t.SortOrder.DESCENDING),s.Cb(1),s.cd(" ",s.pc(29,34,"PAGES.DASHBOARD.TEAM_ACTIVITIES.HEADER.TOTAL_TRACKED")," (",s.pc(30,36,t.dateRange.label),") "),s.Cb(3),s.wc("ngForOf",t.latestActivity),s.Cb(1),s.wc("ngIf",t.usersCount>50))},directives:[Nc.a,Dc.a,i.t,i.u,ua,Pi.a],pipes:[g.e],encapsulation:2}),e})();var Ea=n("VHTt"),fa=n("ddZv"),Sa=n("kZ14"),Ca=n("Tj/N");function Aa(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.Wb()),2&e){const e=s.nc().$implicit;s.Db("title",e.title),s.Cb(1),s.bd(": ",e.taskName," ")}}function Oa(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.Wb()),2&e){const e=s.nc().$implicit;s.Db("title",e.title),s.Cb(1),s.bd(" - ",e.clientName," ")}}function va(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",12),s.Xb(1,"div",13),s.Zc(2),s.oc(3,"stringDurationToTime"),s.Wb(),s.Xb(4,"a",14),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().playEntry(t)})),s.Sb(5,"img",15),s.Wb(),s.Wb()}if(2&e){const e=s.nc().$implicit,t=s.nc();s.Hb("data-panel-item-action-show-play",t.workspace.canSeeTracker),s.Cb(2),s.bd(" ",s.qc(3,3,e.duration,t.format)," ")}}function Ta(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"div",6),s.Xb(2,"div",7),s.Xb(3,"div",8),s.oc(4,"translate"),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"div",8),s.Sb(8,"i",9),s.Xb(9,"span"),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Xc(12,Aa,2,2,"span",10),s.Xc(13,Oa,2,2,"span",10),s.Wb(),s.Wb(),s.Xc(14,va,6,6,"div",11),s.Wb(),s.Ub()),2&e){const e=t.$implicit,n=s.nc();s.Cb(3),s.Db("title",e.description?e.description:s.pc(4,9,"PAGES.DASHBOARD.TEAM_ACTIVITIES.ACTIVITY.NO_DESCRIPTION")),s.Cb(2),s.bd(" ",e.description?e.description:s.pc(6,11,"PAGES.DASHBOARD.TEAM_ACTIVITIES.ACTIVITY.NO_DESCRIPTION")," "),s.Cb(3),s.Wc("background",e.projectColor?e.projectColor:"#C6D2D9",s.Kb),s.Cb(1),s.Db("title",e.title),s.Cb(1),s.bd(" ",e.projectName?e.projectName:s.pc(11,13,"PAGES.DASHBOARD.TEAM_ACTIVITIES.ACTIVITY.NO_PROJECT"),""),s.Cb(2),s.wc("ngIf",e.taskName),s.Cb(1),s.wc("ngIf",e.clientName),s.Cb(1),s.wc("ngIf",n.workspace.canSeeTracker)}}let Ia=(()=>{class e{constructor(e,t,n,i){this.reportService=e,this.trackerService=t,this.toaster=n,this.translateService=i,this.mostTrackedDropdownValues=[new Ea.a("TOP_10",this.translateService.instant("PAGES.DASHBOARD.DROPDOWN.TOP_10")),new Ea.a("ALL",this.translateService.instant("GLOBAL.ALL_LABEL"))],this.unsubscribe$=new Fn.a}ngOnInit(){this.mostTrackedItemsCount=this.mostTrackedDropdownValues[0].value}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}getMostTrackedActivities(){this.reportService.getMostTracked(this.mostTrackedItemsCount,this.dateRange).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.mostTracked=e})}playEntry(e){const t=new Sa.a({description:e.description,tagIds:e.tagIds,userId:this.user.id,billable:e.billable,projectId:e.projectId,taskId:e.taskId});this.trackerService.endStartedTimeEntry().subscribe(()=>{this.trackerService.addStartedTimeEntry(t)})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Tc.a),s.Rb(fa.a),s.Rb(r.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["dashboard-most-tracked"]],inputs:{format:"format",dateRange:"dateRange",user:"user",workspace:"workspace"},decls:8,vars:8,consts:[[1,"cl-card"],[1,"cl-card-header","cl-px-0","cl-py-2"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-w-100","cl-px-2","cl-py-1"],[1,"cl-ml-lg-2","cl-h6","cl-mb-0"],[1,"cl-small",3,"positionRight","type","list","value","onChanged"],[4,"ngFor","ngForOf"],[1,"cl-component-row"],[1,"cl-cut-text-wrapper"],[1,"cl-cut-text"],[1,"entry__project__dot"],[4,"ngIf"],["class","cl-dashboard-most-tracked-action",3,"data-panel-item-action-show-play",4,"ngIf"],[1,"cl-dashboard-most-tracked-action"],[1,"cl-dashboard-most-tracked-time"],[1,"cl-dashboard-most-tracked-start",3,"click"],["src","assets/play.svg"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"dropdown-items",4),s.jc("onChanged",(function(e){return t.mostTrackedItemsCount=e,t.getMostTrackedActivities()})),s.Wb(),s.Wb(),s.Wb(),s.Xc(7,Ta,15,15,"ng-container",5),s.Wb()),2&e&&(s.Cb(4),s.ad(s.pc(5,6,"PAGES.DASHBOARD.TEAM_ACTIVITIES.ACTIVITY.MOST_TRACKED")),s.Cb(2),s.wc("positionRight",!0)("type","DROPDOWN")("list",t.mostTrackedDropdownValues)("value",t.mostTrackedItemsCount),s.Cb(1),s.wc("ngForOf",t.mostTracked))},directives:[ji.a,i.t,i.u],pipes:[g.e,xc.a],encapsulation:2}),e})();var wa=n("RWlN"),La=n("YnOA"),Ra=n("hV/V"),ya=n("kRDX"),_a=n("wlsK");function ka(e,t){if(1&e&&(s.Xb(0,"div",8),s.Xb(1,"div",4),s.Zc(2),s.oc(3,"translate"),s.oc(4,"translate"),s.Wb(),s.Xb(5,"div",5),s.Xb(6,"div",9),s.Xb(7,"span"),s.Zc(8),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.bd(" ",e.viewType===e.dashboardViewType.BILLABILITY?s.pc(3,2,"GLOBAL.AMOUNT_LABEL"):s.pc(4,4,"PAGES.DASHBOARD.CHART.HEADER.TOP_PROJECT")," "),s.Cb(6),s.ad(e.topProjectOrEarning)}}function Wa(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",13),s.Xb(1,"bar-chart",21),s.jc("showAllBarValues",(function(t){return s.Oc(e),s.nc().openModalForBar(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.wc("barChartLabels",e.barChartLabels)("barChartAllLabels",e.barChartAllLabels)("barChartData",e.barChartData)("barChartColors",e.barChartColors)("barChartEarnings",e.barChartEarnings)("totalDurationByDate",e.totalDurationByDate)("billableTimes",e.totalTimeByDate)("format",e.format)("currency",e.currency)("canSeeRates",e.canSeeRates)("isBillabilityType",e.viewType===e.dashboardViewType.BILLABILITY)("projectCountByDate",e.projectCountByDate)}}function Xa(e,t){if(1&e&&s.Sb(0,"doughnut-chart",22),2&e){const e=s.nc();s.wc("doughnutChart",e.pieChartValues)("doughnutChartColors",e.doughnutChartColors)("doughnutChartData",e.doughnutChartData)("doughnutChartLabels",e.doughnutChartLabels)("currency",e.currency)("format",e.format)("totalTime",e.totalTime)("canSeeRates",e.canSeeRates)("isBillabilityType",e.viewType===e.dashboardViewType.BILLABILITY)("tooltipToLeft",!1)}}function Na(e,t){if(1&e&&(s.Xb(0,"span",28),s.Zc(1),s.Wb()),2&e){const e=s.nc().$implicit;s.Cb(1),s.bd(" - ",e.clientName," ")}}function Da(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.Wb()),2&e){const e=s.nc(3).$implicit;s.Cb(1),s.bd(" - ",e.clientName,"")}}function Pa(e,t){if(1&e&&(s.Xb(0,"div",33),s.Sb(1,"i",34),s.Xb(2,"span"),s.Zc(3),s.Xc(4,Da,2,1,"span",35),s.Wb(),s.Wb(),s.Xb(5,"span",36),s.Zc(6),s.oc(7,"stringDurationToTime"),s.Wb(),s.Xb(8,"span",37),s.Zc(9),s.Wb()),2&e){const e=s.nc(2).$implicit,t=s.nc();s.Cb(1),s.Wc("background",e.color,s.Kb),s.Cb(2),s.ad(e.label),s.Cb(1),s.wc("ngIf",e.clientName),s.Cb(2),s.bd(" ",s.qc(7,6,e.duration,t.format)," "),s.Cb(3),s.ad(e.percentage)}}function Ma(e,t){if(1&e&&(s.Xb(0,"th",39),s.Zc(1),s.oc(2,"localizeEarningWithCurrency"),s.Wb()),2&e){const e=s.nc(3).$implicit,t=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,e.earned,t.currency)," ")}}function Ba(e,t){if(1&e&&(s.Xb(0,"table"),s.Xb(1,"tr"),s.Xb(2,"th",33),s.Xb(3,"b"),s.Zc(4),s.Wb(),s.Wb(),s.Xb(5,"th"),s.Xb(6,"b"),s.Zc(7),s.oc(8,"stringDurationToTime"),s.Wb(),s.Wb(),s.Xc(9,Ma,3,4,"th",38),s.Wb(),s.Xb(10,"tr"),s.Xb(11,"td"),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xb(14,"td"),s.Zc(15),s.oc(16,"stringDurationToTime"),s.Wb(),s.Xb(17,"td",39),s.Zc(18),s.Wb(),s.Wb(),s.Xb(19,"tr"),s.Xb(20,"td"),s.Zc(21),s.oc(22,"translate"),s.Wb(),s.Xb(23,"td"),s.Zc(24),s.oc(25,"stringDurationToTime"),s.Wb(),s.Xb(26,"td",39),s.Zc(27),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc(2).$implicit,t=s.nc();s.Cb(4),s.ad(e.label),s.Cb(3),s.ad(s.qc(8,9,e.duration,t.format)),s.Cb(2),s.wc("ngIf",t.canSeeRates),s.Cb(3),s.ad(s.pc(13,12,"GLOBAL.BILLABLE_LABEL")),s.Cb(3),s.ad(s.qc(16,14,e.billableDuration,t.format)),s.Cb(3),s.bd(" ",e.billablePercentage," "),s.Cb(3),s.ad(s.pc(22,17,"GLOBAL.NON_BILLABLE_LABEL")),s.Cb(3),s.ad(s.qc(25,19,e.nonBillableDuration,t.format)),s.Cb(3),s.bd(" ",e.nonBillablePercentage," ")}}const Ua=function(e){return[e]};function Ga(e,t){if(1&e&&(s.Xb(0,"td",29),s.Sb(1,"horizontal-bar-chart",30),s.Xc(2,Pa,10,9,"ng-template",null,31,s.Yc),s.Xc(4,Ba,28,22,"ng-template",null,32,s.Yc),s.Wb()),2&e){const e=s.Lc(3),t=s.Lc(5),n=s.nc().$implicit,i=s.nc();s.Cb(1),s.wc("latestActivityItems",s.Bc(7,Ua,n))("largestDuration",i.totalTimeInSeconds)("currencySymbol",i.currencySymbol)("type",i.viewType)("totalPercentage",100)("isChart",!0)("ngbTooltip",i.viewType===i.dashboardViewType.PROJECT?e:t)}}function xa(e,t){if(1&e&&(s.Xb(0,"td",40),s.Xb(1,"span"),s.Zc(2),s.oc(3,"localizeEarningWithCurrency"),s.Wb(),s.Wb()),2&e){const e=s.nc().$implicit,t=s.nc();s.Cb(2),s.bd(" ",t.viewType===t.dashboardViewType.PROJECT?e.percentage:s.qc(3,1,e.earned,t.currency)," ")}}function Fa(e,t){if(1&e&&(s.Xb(0,"tr"),s.Xb(1,"td",23),s.Xb(2,"span"),s.Zc(3),s.Xc(4,Na,2,1,"span",24),s.Wb(),s.Wb(),s.Xb(5,"td",25),s.Xb(6,"span"),s.Zc(7),s.oc(8,"stringDurationToTime"),s.Wb(),s.Wb(),s.Xc(9,Ga,6,9,"td",26),s.Xc(10,xa,4,4,"td",27),s.Wb()),2&e){const e=t.$implicit,n=s.nc();s.Cb(2),s.Db("title",e.clientName?e.label+" - "+e.clientName:e.label),s.Cb(1),s.bd(" ",e.label," "),s.Cb(1),s.wc("ngIf",e.clientName),s.Cb(3),s.bd(" ",s.qc(8,6,e.duration,n.format)," "),s.Cb(2),s.wc("ngIf",e),s.Cb(1),s.wc("ngIf",n.viewType===n.dashboardViewType.PROJECT||n.canSeeRates)}}const ja=function(e){return{value:e}};function Za(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",41),s.Xb(1,"span"),s.Xb(2,"button",42),s.jc("click",(function(){return s.Oc(e),s.nc().loadMore()})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.bd(" ",s.qc(4,1,"PAGES.DASHBOARD.CHART.LOAD_MORE",s.Bc(4,ja,e.itemsLeftToLoad))," ")}}let Va=(()=>{class e{constructor(){this.showAllBarValues=new s.n,this.doughnutChartLabels=[],this.doughnutChartData=[],this.doughnutChartColors=[{backgroundColor:[],hoverBackgroundColor:[]}],this.dashboardViewType=yc.a,this.numberOfItemsShown=10,this.unsubscribe$=new Fn.a}set totalTime(e){this._totalTime=e||"0",this.totalTimeInSeconds=Object(ke.duration)(this._totalTime).asSeconds()}set horizontalChartData(e){e&&(this._horizontalChartData=e,this.projectListValues=e.slice(0,10),this.itemsLeftToLoad=e.length-this.projectListValues.length,this.viewType===yc.a.BILLABILITY&&this.fillChartWithBillabilityPercentage(this.projectListValues))}set doughnutChart(e){e&&(this._doughnutChart=e,this.pieChartValues=e.slice(0,10),this.updateDoughnutChart(this.pieChartValues))}get totalTime(){return this._totalTime}get horizontalChartData(){return this._horizontalChartData}get doughnutChart(){return this._doughnutChart}ngOnInit(){this.currencySymbol=Object(i.L)(this.currency,"narrow")}loadMore(){this.numberOfItemsShown+=10,this.projectListValues=this.horizontalChartData.slice(0,this.numberOfItemsShown),this.pieChartValues=this.doughnutChart.slice(0,this.numberOfItemsShown),this.itemsLeftToLoad=this.horizontalChartData.length-this.projectListValues.length,this.updateDoughnutChart(this.pieChartValues),this.fillChartWithBillabilityPercentage(this.projectListValues)}openModalForBar(e){this.showAllBarValues.emit(e)}updateDoughnutChart(e){this.showDoughnut=!1;let t=[],n=[],i=[];if(e&&e.length>0)for(const s of e)t.push(s.color),n.push(s.label),i.push(Number(Object(ke.duration)(s.duration).asHours()));else i=[0],n=[""],t=["#000000"];this.doughnutChartData=i,this.doughnutChartLabels=n,this.doughnutChartColors[0].backgroundColor=t,this.doughnutChartColors[0].hoverBackgroundColor=t,this.showDoughnut=!0}fillChartWithBillabilityPercentage(e){e.forEach(e=>{const t=Object(ke.duration)(e.duration).subtract(Object(ke.duration)(e.billableDuration));e.billablePercentage=this.getPercentageOfValues(Object(ke.duration)(e.billableDuration).asSeconds(),Object(ke.duration)(e.duration).asSeconds()),e.nonBillablePercentage=this.getPercentageOfValues(t.asSeconds(),Object(ke.duration)(e.duration).asSeconds()),e.billableDuration=Object(ke.duration)(e.billableDuration),e.nonBillableDuration=Object(ke.duration)(e.duration).subtract(Object(ke.duration)(e.billableDuration))})}getPercentageOfValues(e,t){let n;return n=0===t?0:e/t*100,Number(n).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+"%"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["dashboard-charts"]],inputs:{totalTime:"totalTime",horizontalChartData:"horizontalChartData",doughnutChart:"doughnutChart",totalBillable:"totalBillable",billablePercentage:"billablePercentage",currency:"currency",totalTimeByDate:"totalTimeByDate",totalDurationByDate:"totalDurationByDate",format:"format",barChartLabels:"barChartLabels",barChartAllLabels:"barChartAllLabels",barChartData:"barChartData",barChartColors:"barChartColors",barChartEarnings:"barChartEarnings",viewType:"viewType",topProjectOrEarning:"topProjectOrEarning",topClientOrBillable:"topClientOrBillable",projectGroupingLabel:"projectGroupingLabel",canSeeRates:"canSeeRates",projectCountByDate:"projectCountByDate"},outputs:{showAllBarValues:"showAllBarValues"},decls:32,vars:18,consts:[[1,"cl-card"],[1,"cl-card-header","cl-px-0"],[1,"cl-d-flex","cl-flex-column","cl-flex-md-row","cl-w-100"],[1,"cl-flex-md-fill","cl-dashboard-card-header-item"],[1,"cl-h4","cl-mb-0"],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-end","cl-d-md-block"],[1,"cl-h1"],["class","cl-flex-md-fill cl-dashboard-card-header-item cl-cut-text-wrapper",4,"ngIf"],[1,"cl-flex-md-fill","cl-dashboard-card-header-item","cl-cut-text-wrapper"],[1,"cl-h1","cl-cut-text"],[1,"cl-card-body","cl-p-0"],[1,"cl-main-chart-wrapper"],["class","cl-main-chart-container",4,"ngIf"],[1,"cl-main-chart-container"],[1,"cl-row"],[1,"cl-col-md-4","cl-mb-3","cl-mb-md-0"],[3,"doughnutChart","doughnutChartColors","doughnutChartData","doughnutChartLabels","currency","format","totalTime","canSeeRates","isBillabilityType","tooltipToLeft",4,"ngIf"],[1,"cl-col-md-8"],[1,"cl-main-horizontal-chart-container","cl-w-100"],[4,"ngFor","ngForOf"],["class","cl-or-divider cl-mt-3",4,"ngIf"],[3,"barChartLabels","barChartAllLabels","barChartData","barChartColors","barChartEarnings","totalDurationByDate","billableTimes","format","currency","canSeeRates","isBillabilityType","projectCountByDate","showAllBarValues"],[3,"doughnutChart","doughnutChartColors","doughnutChartData","doughnutChartLabels","currency","format","totalTime","canSeeRates","isBillabilityType","tooltipToLeft"],[1,"cl-text-truncate","cl-main-horizontal-chart-container--label","cl-text-right"],["class","cl-listing-client",4,"ngIf"],[1,"cl-w-10","cl-text-right"],["class","cl-w-50 cl-main-horizontal-chart-container--progress",4,"ngIf"],["class","cl-w-10 cl-text-nowrap cl-text-gray-9 cl-text-right",4,"ngIf"],[1,"cl-listing-client"],[1,"cl-w-50","cl-main-horizontal-chart-container--progress"],["placement","bottom-left",1,"cl-main-horizontal-chart-container--progress--bar",3,"latestActivityItems","largestDuration","currencySymbol","type","totalPercentage","isChart","ngbTooltip"],["projectTooltip",""],["billableTooltip",""],[1,"cl-tooltip-label","cl-text-truncate","cl-text-left"],[1,"cl-entry__project__dot"],[4,"ngIf"],[1,"cl-tooltip-duration"],[1,"cl-text-right","cl-text-gray-9"],["class","cl-text-nowrap cl-text-gray-9 cl-text-right",4,"ngIf"],[1,"cl-text-nowrap","cl-text-gray-9","cl-text-right"],[1,"cl-w-10","cl-text-nowrap","cl-text-gray-9","cl-text-right"],[1,"cl-or-divider","cl-mt-3"],[1,"cl-btn","cl-btn-sm","cl-btn-outline-light","cl-w-max-content",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"div",5),s.Xb(8,"div",6),s.Zc(9),s.oc(10,"stringDurationToTime"),s.Wb(),s.Wb(),s.Wb(),s.Xc(11,ka,9,6,"div",7),s.Xb(12,"div",8),s.Xb(13,"div",4),s.Zc(14),s.oc(15,"translate"),s.oc(16,"translate"),s.Wb(),s.Xb(17,"div",5),s.Xb(18,"div",9),s.Zc(19),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(20,"div",10),s.Xb(21,"div",11),s.Xc(22,Wa,2,12,"div",12),s.Wb(),s.Xb(23,"div",11),s.Xb(24,"div",13),s.Xb(25,"div",14),s.Xb(26,"div",15),s.Xc(27,Xa,1,10,"doughnut-chart",16),s.Wb(),s.Xb(28,"div",17),s.Xb(29,"table",18),s.Xc(30,Fa,11,9,"tr",19),s.Wb(),s.Xc(31,Za,5,6,"div",20),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(5),s.ad(s.pc(6,9,"PAGES.DASHBOARD.CHART.HEADER.TOTAL_TIME")),s.Cb(4),s.ad(s.qc(10,11,t.totalTime,t.format)),s.Cb(2),s.wc("ngIf",t.viewType===t.dashboardViewType.PROJECT||t.canSeeRates),s.Cb(3),s.bd(" ",t.viewType===t.dashboardViewType.BILLABILITY?s.pc(15,14,"GLOBAL.BILLABLE_LABEL"):s.pc(16,16,"PAGES.DASHBOARD.CHART.HEADER.TOP")+" "+t.projectGroupingLabel," "),s.Cb(5),s.ad(t.topClientOrBillable),s.Cb(3),s.wc("ngIf",t.barChartData),s.Cb(5),s.wc("ngIf",t.showDoughnut),s.Cb(3),s.wc("ngForOf",t.projectListValues),s.Cb(1),s.wc("ngIf",t.itemsLeftToLoad>0))},directives:[i.u,i.t,ya.a,_a.a,Gc,w.bb],pipes:[g.e,xc.a,Fc.a],encapsulation:2}),e})();function Ya(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",15),s.Xb(1,"button",16),s.jc("click",(function(){return s.Oc(e),s.nc().toggleShowTeam(!1)})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",16),s.jc("click",(function(){return s.Oc(e),s.nc().toggleShowTeam(!0)})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.Hb("cl-btn-primary",e.dashboardSelection==e.DashboardSelection.ME)("cl-btn-outline-primary",e.dashboardSelection==e.DashboardSelection.TEAM),s.Cb(1),s.bd(" ",s.pc(3,10,"PAGES.DASHBOARD.ME")," "),s.Cb(2),s.Hb("cl-btn-primary",e.dashboardSelection==e.DashboardSelection.TEAM)("cl-btn-outline-primary",e.dashboardSelection==e.DashboardSelection.ME),s.Cb(1),s.bd(" ",s.pc(6,12,"GLOBAL.TEAM_LABEL")," ")}}function Ha(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",21),s.Xb(1,"a",22),s.jc("click",(function(){s.Oc(e);const t=s.nc(2);return t.changeViewType(t.DashboardViewType.PROJECT)})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"a",22),s.jc("click",(function(){s.Oc(e);const t=s.nc(2);return t.changeViewType(t.DashboardViewType.BILLABILITY)})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(1),s.Hb("cl-active",e.dashboardViewType===e.DashboardViewType.PROJECT),s.Cb(1),s.bd(" ",s.pc(3,6,"GLOBAL.PROJECT_LABEL"),""),s.Cb(2),s.Hb("cl-active",e.dashboardViewType===e.DashboardViewType.BILLABILITY),s.Cb(1),s.bd(" ",s.pc(6,8,"PAGES.DASHBOARD.CHART.CHOOSE.BILLABILITY"),"")}}function $a(e,t){if(1&e&&(s.Xb(0,"div",17),s.Xb(1,"div",18),s.Xb(2,"button",19),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xc(5,Ha,7,10,"div",20),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(3),s.bd(" ",s.pc(4,1,e.dashboardViewType===e.DashboardViewType.PROJECT?"GLOBAL.PROJECT_LABEL":"PAGES.DASHBOARD.CHART.CHOOSE.BILLABILITY")," ")}}function Ka(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",27),s.Xb(1,"a",28),s.jc("click",(function(){return s.Oc(e),s.nc(2).toggleShowTeam(!1)})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"a",28),s.jc("click",(function(){return s.Oc(e),s.nc(2).toggleShowTeam(!0)})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(1),s.Hb("cl-active",e.dashboardSelection==e.DashboardSelection.ME),s.Cb(1),s.bd(" ",s.pc(3,6,"PAGES.DASHBOARD.CHART.CHOOSE.MY_ACTIVITIES")," "),s.Cb(2),s.Hb("cl-active",e.dashboardSelection==e.DashboardSelection.TEAM),s.Cb(1),s.bd(" ",s.pc(6,8,"GLOBAL.TEAM_LABEL")," ")}}function qa(e,t){if(1&e&&(s.Xb(0,"div",23),s.Xb(1,"div",24),s.Xb(2,"button",25),s.Zc(3),s.oc(4,"translate"),s.oc(5,"translate"),s.Wb(),s.Xc(6,Ka,7,10,"div",26),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(3),s.bd(" ",e.dashboardSelection==e.DashboardSelection.ME?s.pc(4,1,"PAGES.DASHBOARD.CHART.CHOOSE.MY_ACTIVITIES"):s.pc(5,3,"GLOBAL.TEAM_LABEL")," ")}}function za(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",29),s.Xb(1,"div",30),s.Xb(2,"dashboard-charts",31),s.jc("showAllBarValues",(function(t){s.Oc(e);const n=s.nc(),i=s.Lc(18);return n.openModalForBar(t,i)})),s.Wb(),s.Wb(),s.Xb(3,"div",32),s.Sb(4,"dashboard-most-tracked",33),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.wc("totalTime",e.mainReport&&e.mainReport.totalTime)("horizontalChartData",e.horizontalChartData)("doughnutChart",e.doughnutChart)("totalBillable",e.totalBillable)("billablePercentage",e.billablePercentage)("currency",e.currency)("barChartLabels",e.barChartLabels)("barChartData",e.barChartData)("barChartColors",e.barChartColors)("barChartEarnings",e.barChartEarnings)("barChartAllLabels",e.barChartAllLabels)("totalTimeByDate",e.totalTimeByDate)("totalDurationByDate",e.totalDurationByDate)("format",e.format)("viewType",e.dashboardViewType)("topProjectOrEarning",e.topProjectOrEarning)("topClientOrBillable",e.topClientOrBillable)("projectGroupingLabel",e.projectGroupingLabel)("canSeeRates",e.canSeeRates)("projectCountByDate",e.projectCountByDate),s.Cb(2),s.wc("format",e.format)("dateRange",e.dateRange)("user",e.user)("workspace",e.workspace)}}function Qa(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",34),s.Xb(1,"dashboard-latest-activity",36),s.jc("pinToTopEmitter",(function(t){return s.Oc(e),s.nc(2).pinToTopChanged(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Hb("cl-order-first",e.pinToTop),s.Cb(1),s.wc("dateRange",e.dateRange)("pinToTop",e.pinToTop)("format",e.format)("dashboardViewType",e.dashboardViewType)("currency",e.currency)("canSeeRates",e.canSeeRates)("currentLanguage",e.currentLanguage)("earningByUser",e.mainReport&&e.mainReport.earningByUserMap)}}function Ja(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",29),s.Xb(1,"div",34),s.Xb(2,"dashboard-charts",31),s.jc("showAllBarValues",(function(t){s.Oc(e);const n=s.nc(),i=s.Lc(18);return n.openModalForBar(t,i)})),s.Wb(),s.Wb(),s.Xc(3,Qa,2,10,"div",35),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.Hb("cl-order-first",!e.pinToTop),s.Cb(1),s.wc("totalTime",e.mainReport&&e.mainReport.totalTime)("horizontalChartData",e.horizontalChartData)("doughnutChart",e.doughnutChart)("totalBillable",e.totalBillable)("billablePercentage",e.billablePercentage)("currency",e.currency)("barChartLabels",e.barChartLabels)("barChartData",e.barChartData)("barChartColors",e.barChartColors)("barChartEarnings",e.barChartEarnings)("barChartAllLabels",e.barChartAllLabels)("totalTimeByDate",e.totalTimeByDate)("totalDurationByDate",e.totalDurationByDate)("format",e.format)("viewType",e.dashboardViewType)("topProjectOrEarning",e.topProjectOrEarning)("topClientOrBillable",e.topClientOrBillable)("projectGroupingLabel",e.projectGroupingLabel)("canSeeRates",e.canSeeRates)("projectCountByDate",e.projectCountByDate),s.Cb(1),s.wc("ngIf",e.adminOrOwner||e.teamManager||!e.workspace.onlyAdminsSeeAllTimeEntries)}}function eo(e,t){if(1&e&&(s.Xb(0,"span",52),s.Zc(1),s.Wb()),2&e){const e=s.nc(2).$implicit;s.Cb(1),s.bd(" - ",e.clientName,"")}}function to(e,t){if(1&e&&(s.Xb(0,"span",49),s.Sb(1,"i",50),s.Xb(2,"span"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xc(5,eo,2,1,"span",51),s.Wb()),2&e){const e=s.nc().$implicit;s.Cb(1),s.Wc("background",e.color,s.Kb),s.Cb(2),s.ad(e.projectName?e.projectName:s.pc(4,4,"GLOBAL.WITHOUT_PROJECT_LABEL")),s.Cb(2),s.wc("ngIf",e.clientName)}}function no(e,t){if(1&e&&(s.Xb(0,"span",49),s.Xb(1,"span"),s.Zc(2),s.Wb(),s.Wb()),2&e){const e=s.nc().$implicit;s.Cb(2),s.ad(e.label)}}function io(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"tr"),s.Xb(2,"td"),s.Xc(3,to,6,6,"span",47),s.Xc(4,no,3,1,"span",47),s.Wb(),s.Xb(5,"td",45),s.Zc(6),s.oc(7,"stringDurationToTime"),s.Wb(),s.Xb(8,"td",48),s.Zc(9),s.Wb(),s.Wb(),s.Ub()),2&e){const e=t.$implicit,n=s.nc(2);s.Cb(3),s.wc("ngIf",n.dashboardViewType===n.DashboardViewType.PROJECT),s.Cb(1),s.wc("ngIf",n.dashboardViewType===n.DashboardViewType.BILLABILITY),s.Cb(2),s.ad(s.qc(7,4,e.duration,n.format)),s.Cb(3),s.ad(e.percentage)}}function so(e,t){if(1&e&&(s.Xb(0,"div",37),s.Xb(1,"h1",38),s.Zc(2),s.Wb(),s.Xb(3,"button",39),s.jc("click",(function(){return t.$implicit.dismiss()})),s.Xb(4,"span",40),s.Sb(5,"img",41),s.Wb(),s.Wb(),s.Wb(),s.Xb(6,"div",42),s.Xb(7,"table",43),s.Xb(8,"tr"),s.Xb(9,"th",44),s.Xb(10,"b"),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb(),s.Xb(13,"th",45),s.Xb(14,"b"),s.Zc(15),s.Wb(),s.Wb(),s.Sb(16,"th"),s.Wb(),s.Xc(17,io,10,7,"ng-container",46),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(e.labelForBar),s.Cb(9),s.ad(s.pc(12,4,"GLOBAL.PROJECTS_LABEL")),s.Cb(4),s.ad(e.totalTimeByBar),s.Cb(2),s.wc("ngForOf",e.modalValues)}}let co=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r,l,b,d){this.reportService=e,this.authService=t,this.workspaceService=n,this.userService=i,this.uiSettingsService=s,this.loader=c,this.timezoneConverter=a,this.cd=o,this.modalService=r,this.translateService=l,this.translationStore=b,this.analyticsService=d,this.DashboardSelection=Rc.a,this.DashboardViewType=yc.a,this.zoomLevel="week",this.totalTimeByDate=[],this.totalDurationByDate=[],this.teamPermission=!1,this.barChartEarnings=[],this.labelsForTopTen=[],this.projectCountByDate=[],this.updateDebouncer=new p.a,this.unsubscribe$=new Fn.a}ngOnInit(){this.currentLanguage=this.translationStore.getCurrentLang(),this.authService.permissionData$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(({isTeamManager:e,isAdminOrOwner:t})=>{this.teamManager=e,this.adminOrOwner=t}),this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.user=this.authService.getUser(),this.format=this.workspace.getTimeFormat(),this.currency=this.workspace.hourlyRate.currency,this.projectGroupingLabel=this.workspaceService.generateClientLabel(this.workspace.getProjectGroupingLabel()),this.teamPermission=!this.workspace.onlyAdminsSeeTeamsDashboard||this.adminOrOwner||this.teamManager,this.canSeeRates=!this.workspace.onlyAdminsSeeBillableRates||this.adminOrOwner,this.dashboardViewType=this.user.settings.dashboardViewType,this.dashboardSelection=this.teamPermission?this.user.settings.dashboardSelection:Rc.a.ME,this.pinToTop=this.user.settings.dashboardPinToTop,this.initDateRange(),this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.format=e.getTimeFormat(),this.currency=e.hourlyRate.currency,this.workspace=e;const t=!this.workspace.onlyAdminsSeeTeamsDashboard||this.adminOrOwner||this.teamManager;this.teamPermission!==t&&(this.teamPermission=t,this.dashboardSelection=this.teamPermission?this.user.settings.dashboardSelection:Rc.a.ME,this.getReport())}),this.onlyAdminCanSeeAndChangeBillable=this.workspace.onlyAdminsCanChangeBillableStatus,this.activeBillableHours=this.workspace.activeBillableHours,(!this.workspace.activeBillableHours||this.workspace.activeBillableHours&&this.onlyAdminCanSeeAndChangeBillable&&!this.adminOrOwner)&&this.changeViewTypeWithoutSave(yc.a.PROJECT),this.reportService.dashboardUpdate.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.updateDebouncer.next()}),this.updateDebouncer.pipe(Object(De.a)(6e4),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.getReport()}),this.getReport()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initDateRange(){const e=this.uiSettingsService.getSettings(xn.b.DASHBOARD_DATE);if(!e||!ke(e.start).isValid())return this.dateRange=Object(wc.d)(this.user.settings.weekStart,this.timezoneConverter),void(this.zoomLevel="week");const t=Object(_e.f)(e.label,this.user.settings.weekStart);this.dateRange=t||{start:ke(e.start),end:ke(e.end)},this.zoomLevel=e.zoomLevel,this.dateRange.label=e.label}getReport(){this.loader.show("GLOBAL.LOADER_LOADING"),this.latest&&this.mostTracked||this.cd.detectChanges(),this.dashboardSelection===this.DashboardSelection.TEAM?(this.adminOrOwner||this.teamManager||!this.workspace.onlyAdminsSeeAllTimeEntries)&&this.latest.getLatestActivity():this.mostTracked.getMostTrackedActivities(),this.reportService.getMainReport(this.dashboardSelection,this.dashboardViewType,this.dateRange,this.zoomLevel).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.wait=!1,this.mainReport=e;const t=e=>Object(ke.duration)(e.duration).asSeconds(),n=Object.keys(this.mainReport.projectAndTotalTime);this.horizontalChartData=n.length>0?n.map(e=>this.mainReport.projectAndTotalTime[e]).sort(Object(kc.b)(!0,t)):[{clientName:"",color:"#C6D2D9",duration:Object(ke.duration)(0),earned:0,label:Object(sn.e)(this.translateService.instant("GLOBAL.NO_PROJECT_LABEL")),projectName:"",percentage:Number(0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+"%",billableDuration:Object(ke.duration)(0)}];const i=Object.keys(this.mainReport.billableAndTotalTime);if(this.doughnutChart=i.length>0?i.map(e=>this.mainReport.billableAndTotalTime[e]).sort(Object(kc.b)(!0,t)):[{clientName:"",color:"#C6D2D9",duration:Object(ke.duration)(0),earned:0,label:Object(sn.e)(this.translateService.instant("GLOBAL.NO_PROJECT_LABEL")),projectName:""}],this.labelsForTopTen=[],this.dashboardViewType===yc.a.PROJECT)this.trimDataForChart();else{this.topTenByDate=this.mainReport.dateAndTotalTime;const e=Object.keys(this.mainReport.projectAndTotalTime);this.labelsForTopTen=e.length>0?[...this.horizontalChartData]:[],this.initChart()}},e=>{this.loader.hide()})}updateDateRange(e){var t,n;this.areDatesEqual(e.dateRange,this.dateRange)||(this.dateRange.start=e.dateRange.start,this.dateRange.end=e.dateRange.end,this.dateRange.label=e.dateRange.label,this.zoomLevel=e.zoomLevel,this.getReport(),this.setLocalStorageData(e),this.analyticsService.addEvent(new Fi.a({event:"change",value:(null===(t=this.dateRange)||void 0===t?void 0:t.start)+" - "+(null===(n=this.dateRange)||void 0===n?void 0:n.end),section:"Dashboard"})))}setLocalStorageData(e){if(!Object(sn.y)(e.dateRange.start,e.dateRange.end))return void this.uiSettingsService.setSettings(xn.b.DASHBOARD_DATE,null);const t={start:e.dateRange.start.toISOString(),end:e.dateRange.end.toISOString(),zoomLevel:e.zoomLevel,label:e.dateRange.label};this.uiSettingsService.setSettings(xn.b.DASHBOARD_DATE,t)}areDatesEqual(e,t){return e.start.toISOString()===t.start.toISOString()&&e.end.toISOString()===t.end.toISOString()}toggleShowTeam(e){this.dashboardSelection=e?Rc.a.TEAM:Rc.a.ME,this.userService.updateDashboardMeSelection(this.dashboardSelection),setTimeout(()=>{this.getReport()},100)}changeViewType(e){e!==this.dashboardViewType&&(this.dashboardViewType=e==yc.a.BILLABILITY?yc.a.BILLABILITY:yc.a.PROJECT,this.user.settings.dashboardViewType=this.dashboardViewType,this.userService.updateSettingsWithoutToast(this.user),setTimeout(()=>{this.getReport()},100),this.analyticsService.addEvent(new Fi.a({event:"select",value:e,section:"Dashboard"})))}changeViewTypeWithoutSave(e){e!==this.dashboardViewType&&(this.dashboardViewType=e==yc.a.BILLABILITY?yc.a.BILLABILITY:yc.a.PROJECT,this.user.settings.dashboardViewType=this.dashboardViewType,setTimeout(()=>{this.getReport()},100))}pinToTopChanged(e){this.pinToTop=e}openModalForBar(e,t){this.modalValues=this.mainReport.dateAndTotalTime[this.daysBetweenDateRange[e]].sort(Object(kc.b)(!0,e=>Object(ke.duration)(e.duration).asSeconds()));const n=Object(ke.duration)(this.totalDurationByDate[e],"s");this.totalTimeByBar=Object(La.a)(n,this.format);const i=ke(this.daysBetweenDateRange[e]);i.locale(this.currentLanguage),this.labelForBar=i.format("year"===this.zoomLevel?"MMMM":"ddd, MMM D"),this.modalValues.forEach(e=>{e.percentage=Number(Object(ke.duration)(e.duration).asSeconds()/n.asSeconds()*100).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+"%"}),this.modalService.open(t,{centered:!0})}initTotals(){this.barColors=[],this.totalTime=this.mainReport.totalTime,this.totalBillableTime=Object(wc.b)(this.mainReport.totalBillable,this.format),this.totalBillable=this.mainReport.totalEarned/100;const e=Object(ke.duration)(this.mainReport.totalTime).asSeconds(),t=Object(ke.duration)(this.mainReport.totalBillable).asSeconds();this.billablePercentage=0!=e?Math.round(t/e*100).toString().concat("%"):"--",this.dashboardViewType===yc.a.BILLABILITY?(this.topProjectOrEarning=Number(this.totalBillable).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+" "+this.currency,this.topClientOrBillable=this.billablePercentage):(this.topClientOrBillable=this.mainReport.topClient,this.topProjectOrEarning=this.findTopProject())}findTopProject(){for(let e=0;e<this.horizontalChartData.length;e++)if(this.horizontalChartData[e]&&""!==this.horizontalChartData[e].projectName)return this.horizontalChartData[e].projectName;return"--"}initLabels(){let e=[];if(this.dashboardViewType===yc.a.PROJECT){const t=this.labelsForTopTen.map(e=>e.label).indexOf("Without_project");if(t>-1){const n=this.labelsForTopTen[t];e.push(n),this.barColors.push(new vc.a(n.color).toChartReadable()),this.labelsForTopTen.splice(t,1)}if(this.labelsForTopTen.length>0)for(let n=0;n<this.labelsForTopTen.length;n++){const t=this.labelsForTopTen[n];e.push(t),this.barColors.push(new vc.a(t.color).toChartReadable())}}else e=[{label:this.translateService.instant("GLOBAL.BILLABLE_LABEL")},{label:this.translateService.instant("GLOBAL.NON_BILLABLE_LABEL")}],this.barColors=[new vc.a("rgba(139,195,74, 1)").toChartReadable(),new vc.a("rgba(174,213,129, 1)").toChartReadable()];return e}initChart(){this.barChartData=[],this.barChartLabels=[],this.barChartAllLabels=[],this.barChartColors=[],this.barChartEarnings=[],this.projectCountByDate=[],this.daysBetweenDateRange=Object(wc.a)(wa.a[this.zoomLevel.toUpperCase()],this.dateRange),this.initTotals();const e=this.initLabels(),t=[];this.totalTimeByDate=[],this.totalDurationByDate=[],this.daysBetweenDateRange.forEach((n,i)=>{const s=Object(ke.utc)(n);s.locale(this.currentLanguage),"month"===this.zoomLevel?(this.barChartAllLabels.push(s.format("ddd, MMM D")),this.barChartLabels.push(i%3==0?s.format("ddd, MMM D"):"")):"year"===this.zoomLevel?(this.barChartLabels.push(s.format("MMM")),this.barChartAllLabels.push(s.format("MMM"))):(this.barChartLabels.push(s.format("ddd, MMM D")),this.barChartAllLabels.push(s.format("ddd, MMM D")));const c=[],a=this.mainReport.dateAndTotalTime[n];if(e.forEach(e=>{const t=a?a.filter(t=>t.label===e.label&&(this.dashboardViewType===yc.a.BILLABILITY||t.clientName===e.clientName))[0]:null;c.push(t?Number(Number(Object(ke.duration)(t.duration).asHours())):0)}),t.push(c),a){let e=0;a.forEach(t=>{e+=t.earned}),this.barChartEarnings.push(e)}else this.barChartEarnings.push(0);const o=Object(ke.duration)(0);if(a)for(let e=0;e<a.length;e++)o.add(Object(ke.duration)(a[e].duration));this.totalDurationByDate.push(o.asSeconds()),this.totalTimeByDate.push(window.innerWidth>500?Object(La.a)(o,this.format).concat("h"):Object(La.a)(o,this.format)),this.projectCountByDate.push(this.mainReport.dateAndTotalTime[n]?this.mainReport.dateAndTotalTime[n].length:0)});const n=[];for(let i=0;i<e.length;i++){const s=[];for(let e=0;e<this.daysBetweenDateRange.length;e++)s.push(t[e][i]);let c=e[i].label;e[i].clientName&&(c+=" - "+e[i].clientName),n.push(new _c(s,c).toChartReadable())}n.length>0?(this.barChartData=n,this.barChartColors=this.barColors):this.fillChartForNoData(),this.wait=!0,this.loader.hide()}fillChartForNoData(){const e=[];e.fill(0,0,this.daysBetweenDateRange.length),this.barChartData=[{data:e,label:""}],this.barChartColors=["#C6D2D9"]}trimDataForChart(){const e=Object.keys(this.mainReport.dateAndTotalTime);this.topTenByDate=JSON.parse(JSON.stringify(this.mainReport.dateAndTotalTime)),e.forEach(e=>{const t=this.mainReport.dateAndTotalTime[e].map(e=>e);if(t.length>10){const n=e=>Object(ke.duration)(e.duration).asSeconds();this.topTenByDate[e]=t.sort(Object(kc.b)(!0,n)).slice(0,10)}this.topTenByDate[e].forEach(e=>{0!=this.labelsForTopTen.length&&0!==this.labelsForTopTen.filter(t=>t.label===e.label&&(this.dashboardViewType===yc.a.BILLABILITY||e.clientName===t.clientName)).length||this.labelsForTopTen.push({label:e.label,color:e.color,clientName:e.clientName})})}),this.initChart()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Tc.a),s.Rb(re.a),s.Rb(l.a),s.Rb(Lc.a),s.Rb(xn.a),s.Rb(Hn.a),s.Rb(Ic.a),s.Rb(s.h),s.Rb(w.q),s.Rb(g.f),s.Rb(Ra.a),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["dashboard"]],viewQuery:function(e,t){var n;1&e&&(s.gd(ga,!0),s.gd(Ia,!0)),2&e&&(s.Kc(n=s.kc())&&(t.latest=n.first),s.Kc(n=s.kc())&&(t.mostTracked=n.first))},decls:19,vars:9,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center"],[1,"cl-col-md-4","cl-mb-3","cl-mb-md-0","cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-justify-content-md-start"],[1,"cl-float-left"],[1,"cl-col-md-8"],["class","cl-btn-group cl-w-100 cl-d-flex cl-mb-3 cl-d-md-none",4,"ngIf"],[1,"cl-d-flex","cl-align-items-sm-center","cl-justify-content-sm-end","cl-flex-column","cl-flex-sm-row"],["class","cl-page-header-action cl-w-md-auto cl-mr-0 cl-mr-sm-2 cl-mb-3 cl-mb-sm-0",4,"ngIf"],["class","cl-page-header-action cl-d-none cl-d-md-block",4,"ngIf"],[1,"cl-page-header-action","cl-w-100","cl-w-md-auto"],[3,"timeEntriesDateRange","dateRangeOut"],["class","cl-row",4,"ngIf"],["content",""],[1,"cl-btn-group","cl-w-100","cl-d-flex","cl-mb-3","cl-d-md-none"],["type","button",1,"cl-btn","cl-w-50",3,"click"],[1,"cl-page-header-action","cl-w-md-auto","cl-mr-0","cl-mr-sm-2","cl-mb-3","cl-mb-sm-0"],["dropdownKey","",1,"cl-dropdown","cl-btn-group","cl-d-flex"],["dropdownKeyButton","",1,"cl-btn","cl-btn-outline-light","cl-text-left","cl-dropdown-toggle"],["class","cl-dropdown-menu",4,"dropdownKeyContent"],[1,"cl-dropdown-menu"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"click"],[1,"cl-page-header-action","cl-d-none","cl-d-md-block"],["dropdown","",1,"cl-dropdown"],["type","button","id","dropdownMenuButton","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"cl-btn","cl-btn-outline-light","cl-dropdown-toggle"],["class","cl-dropdown-menu","aria-labelledby","dropdownMenuButton",4,"dropdownContent"],["aria-labelledby","dropdownMenuButton",1,"cl-dropdown-menu"],["closeDropdown","",1,"cl-dropdown-item",3,"click"],[1,"cl-row"],[1,"cl-col-lg-8","cl-col-xl-9"],[3,"totalTime","horizontalChartData","doughnutChart","totalBillable","billablePercentage","currency","barChartLabels","barChartData","barChartColors","barChartEarnings","barChartAllLabels","totalTimeByDate","totalDurationByDate","format","viewType","topProjectOrEarning","topClientOrBillable","projectGroupingLabel","canSeeRates","projectCountByDate","showAllBarValues"],[1,"cl-col-lg-4","cl-col-xl-3"],[3,"format","dateRange","user","workspace"],[1,"cl-col-12"],["class","cl-col-12",3,"cl-order-first",4,"ngIf"],[3,"dateRange","pinToTop","format","dashboardViewType","currency","canSeeRates","currentLanguage","earningByUser","pinToTopEmitter"],[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body","cl-overflow-auto"],[1,"cl-m-0","tr-table-reset","cl-w-100"],["ngbAutofocus","",1,"cl-pb-2"],[1,"cl-text-right","cl-px-2"],[4,"ngFor","ngForOf"],["class","cl-project-name",4,"ngIf"],[1,"cl-text-gray-9","cl-text-right"],[1,"cl-project-name"],[1,"cl-entry__project__dot"],["class","cl-text-gray-9",4,"ngIf"],[1,"cl-text-gray-9"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"h1",5),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xb(8,"div",6),s.Xc(9,Ya,7,14,"div",7),s.Xb(10,"div",8),s.Xc(11,$a,6,3,"div",9),s.Xc(12,qa,7,5,"div",10),s.Xb(13,"div",11),s.Xb(14,"datepicker-range",12),s.jc("dateRangeOut",(function(e){return t.updateDateRange(e)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(15,za,5,24,"div",13),s.Xc(16,Ja,4,23,"div",13),s.Wb(),s.Wb(),s.Xc(17,so,18,6,"ng-template",null,14,s.Yc)),2&e&&(s.Cb(6),s.ad(s.pc(7,7,"GLOBAL.DASHBOARD_LABEL")),s.Cb(3),s.wc("ngIf",t.teamPermission),s.Cb(2),s.wc("ngIf",t.activeBillableHours&&(!t.onlyAdminCanSeeAndChangeBillable||t.adminOrOwner)),s.Cb(1),s.wc("ngIf",t.teamPermission),s.Cb(2),s.wc("timeEntriesDateRange",t.dateRange),s.Cb(1),s.wc("ngIf",t.dashboardSelection==t.DashboardSelection.ME),s.Cb(1),s.wc("ngIf",t.dashboardSelection==t.DashboardSelection.TEAM))},directives:[i.u,ws.a,ni.a,ii.a,si.a,Nc.a,Dc.a,Va,Ia,ga,i.t],pipes:[g.e,xc.a],encapsulation:2}),e})();var ao=n("+NYR");let oo=(()=>{class e{constructor(e){this.authService=e}canActivate(e,t){return this.authService.isLoggedIn()?!!this.authService.getUser()||this.authService.fetchUser().pipe(Object(ln.a)(1),Object(d.a)(()=>!0,()=>(this.noPermission(t.url),!1))):(this.noPermission(t.url),!1)}noPermission(e){this.authService.logout(),ao.a.setRedirectUrl(e)}}return e.\u0275fac=function(t){return new(t||e)(s.fc(re.a))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var ro=n("ujiw"),lo=n("33WN"),bo=n("KBaq"),uo=function(e){return e.INTEGRATIONS="INTEGRATIONS",e.SETTINGS="SETTINGS",e.PERMISSIONS="PERMISSIONS",e.USER_GROUPS="USER_GROUPS",e.REMINDERS="REMINDERS",e.ALERTS="ALERTS",e.ACCOUNTS="ACCOUNTS",e.AUTH="AUTH",e.CUSTOM_FIELDS="CUSTOM_FIELDS",e.IMPORT="IMPORT",e.AUDIT_LOG="AUDIT_LOG",e}({}),po=n("BO2n"),ho=n("bGsH"),mo=n("aQ9k"),go=n("hfeU"),Eo=n("qEcx"),fo=n("/2Gs");const So=["labelInput"];function Co(e,t){if(1&e){const e=s.Yb();s.Xb(0,"input",4,5),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().customLabel=t}))("change",(function(){return s.Oc(e),s.nc().onValueChanges()}))("keyup.enter",(function(){return s.Oc(e),s.Lc(1).blur()})),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc();s.xc("placeholder",s.pc(2,2,"GLOBAL.LABEL_NAME")),s.wc("ngModel",e.customLabel)}}let Ao=(()=>{class e{constructor(e,t,n){this.cd=e,this.toaster=t,this.translateService=n,this.onUpdate=new s.n,this.groupingLabel=go.a,this.customLabel=""}set projectGroupingLabel(e){e&&(this.projectType=Object.values(go.a).includes(e.toLowerCase())?e:go.a.custom,this.customLabel=this.projectType===go.a.custom?e:"")}ngOnInit(){this.projectOptions=[new Un.a(go.a.client,"GLOBAL.CLINENT_LABEL"),new Un.a(go.a.department,"GLOBAL.DEPARTMENT_LABEL"),new Un.a(go.a.category,"WORKSPACE.SETTINGS.CATEGORY_LABEL"),new Un.a(go.a.custom,"WORKSPACE.SETTINGS.MAKE_CUSTOM_LABEL")]}onValueChanges(e=!1){if(this.customLabel=this.customLabel.trim(),e&&this.projectType===go.a.custom){this.labelInput||this.cd.detectChanges();try{this.labelInput.nativeElement.focus()}catch(t){}}this.isValid()&&this.onUpdate.emit(this.projectType===go.a.custom?this.customLabel:this.projectType)}isValid(){return!(this.projectType===go.a.custom&&(this.customLabel.length>200?(this.toaster.pop("error",this.translateService.instant("GLOBAL.CLIENT_NAME_LENGTH_ERROR_MESSAGE")),1):this.customLabel.length<1))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.h),s.Rb(a.d),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["client-label"]],viewQuery:function(e,t){var n;1&e&&s.gd(So,!0),2&e&&s.Kc(n=s.kc())&&(t.labelInput=n.first)},inputs:{projectGroupingLabel:"projectGroupingLabel"},outputs:{onUpdate:"onUpdate"},decls:5,vars:3,consts:[[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-6"],[3,"list","value","onChanged"],["class","cl-form-control","type","text","autocomplete","off",3,"ngModel","placeholder","ngModelChange","change","keyup.enter",4,"ngIf"],["type","text","autocomplete","off",1,"cl-form-control",3,"ngModel","placeholder","ngModelChange","change","keyup.enter"],["labelInput",""]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"dropdown-items",2),s.jc("onChanged",(function(e){return t.projectType=e,t.onValueChanges(!0)})),s.Wb(),s.Wb(),s.Xb(3,"div",1),s.Xc(4,Co,3,4,"input",3),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.wc("list",t.projectOptions)("value",t.projectType),s.Cb(2),s.wc("ngIf",t.projectType===t.groupingLabel.custom))},directives:[ji.a,i.u,v.c,v.s,v.v],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var Oo=n("B1Fc");let vo=(()=>{class e extends Oo.a{constructor(e,t,n,i,c,a){super(e,t,n,i,c),this.element=e,this.renderer=t,this.viewContainer=n,this.toaster=i,this.model=c,this.translateService=a,this.maxLength=100,this.required=!0,this.inputChange=new s.n}onChange(){const e=this.element.nativeElement.value.trim();this.validate(e)?(this.templateError&&this.viewContainer.clear(),this.renderer.removeClass(this.element.nativeElement,this.errorClass),this.model.valueAccessor.writeValue(e),this.inputChange.emit(e)):this.model.valueAccessor.writeValue(this.ngModel)}validate(e){if(e.length>this.maxLength){const e=this.translateService.instant("SHARED_MODULES.INPUT_STRING.VALUE_TOO_LONG_ERROR_MSG",{maxLength:this.maxLength});return this.handleError(e),!1}if(this.required&&!e){const e=this.translateService.instant("SHARED_MODULES.INPUT_STRING.VALUE_REQUIRED_ERROR_MESSAGE");return this.handleError(e),!1}return!0}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.l),s.Rb(s.F),s.Rb(s.P),s.Rb(r.a),s.Rb(v.v),s.Rb(g.f))},e.\u0275dir=s.Mb({type:e,selectors:[["","inputString",""]],hostBindings:function(e,t){1&e&&s.jc("change",(function(){return t.onChange()}))},inputs:{maxLength:"maxLength",required:"required"},outputs:{inputChange:"inputChange"},features:[s.zb]}),e})();var To=n("FsCY");let Io=(()=>{class e{constructor(){this.onClose=new s.n,this.onChange=new s.n}set roundData(e){this.round=e.round,this.minutes=e.minutes,this.initData=new Os(e)}ngOnInit(){this.optionsRound=[new Un.a("Round up to","Round up to"),new Un.a("Round to nearest","Round to nearest"),new Un.a("Round down to","Round down to")]}save(){const e=new Os({round:this.round,minutes:this.minutes});e.round!==this.initData.round||e.minutes!==this.initData.minutes?this.onChange.emit(e):this.close()}close(){this.onClose.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["rounding-modal"]],inputs:{roundData:"roundData",optionsTime:"optionsTime"},outputs:{onClose:"onClose",onChange:"onChange"},decls:47,vars:32,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group"],[1,"cl-custom-control","cl-custom-radio"],["type","radio","id","rounding1","name","timeRounding","value","Round up to",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","rounding1",1,"cl-custom-control-label"],[1,"cl-text-gray-9"],[1,"cl-mt-0"],["type","radio","id","rounding2","name","timeRounding","value","Round to nearest",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","rounding2",1,"cl-custom-control-label"],["type","radio","id","rounding3","name","timeRounding","value","Round down to",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","rounding3",1,"cl-custom-control-label"],[3,"list","value","onChanged"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.close()})),s.Xb(5,"span"),s.Sb(6,"img",3),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",4),s.Xb(8,"div"),s.Xb(9,"div",5),s.Xb(10,"div",6),s.Xb(11,"input",7),s.jc("ngModelChange",(function(e){return t.round=e})),s.Wb(),s.Xb(12,"label",8),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Xb(15,"div",9),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Wb(),s.Sb(18,"hr",10),s.Xb(19,"div",5),s.Xb(20,"div",6),s.Xb(21,"input",11),s.jc("ngModelChange",(function(e){return t.round=e})),s.Wb(),s.Xb(22,"label",12),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Wb(),s.Xb(25,"div",9),s.Zc(26),s.oc(27,"translate"),s.Wb(),s.Wb(),s.Sb(28,"hr",10),s.Xb(29,"div",5),s.Xb(30,"div",6),s.Xb(31,"input",13),s.jc("ngModelChange",(function(e){return t.round=e})),s.Wb(),s.Xb(32,"label",14),s.Zc(33),s.oc(34,"translate"),s.Wb(),s.Wb(),s.Xb(35,"div",9),s.Zc(36),s.oc(37,"translate"),s.Wb(),s.Wb(),s.Sb(38,"hr",10),s.Xb(39,"dropdown-items",15),s.jc("onChanged",(function(e){return t.minutes=e})),s.Wb(),s.Wb(),s.Wb(),s.Xb(40,"div",16),s.Xb(41,"a",17),s.jc("click",(function(){return t.close()})),s.Zc(42),s.oc(43,"translate"),s.Wb(),s.Xb(44,"button",18),s.jc("click",(function(){return t.save()})),s.Zc(45),s.oc(46,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,14,"WORKSPACE.TIME_ROUNDING_MODAL.TITLE")),s.Cb(9),s.wc("ngModel",t.round),s.Cb(2),s.ad(s.pc(14,16,"WORKSPACE.TIME_ROUNDING_MODAL.RADIO_BUTTONS.OPTION_1.TITLE")),s.Cb(3),s.bd(" ",s.pc(17,18,"WORKSPACE.TIME_ROUNDING_MODAL.RADIO_BUTTONS.OPTION_1.INFO_MESSAGE")," "),s.Cb(5),s.wc("ngModel",t.round),s.Cb(2),s.ad(s.pc(24,20,"WORKSPACE.TIME_ROUNDING_MODAL.RADIO_BUTTONS.OPTION_2.TITLE")),s.Cb(3),s.bd(" ",s.pc(27,22,"WORKSPACE.TIME_ROUNDING_MODAL.RADIO_BUTTONS.OPTION_2.INFO_MESSAGE")," "),s.Cb(5),s.wc("ngModel",t.round),s.Cb(2),s.ad(s.pc(34,24,"WORKSPACE.TIME_ROUNDING_MODAL.RADIO_BUTTONS.OPTION_3.TITLE")),s.Cb(3),s.bd(" ",s.pc(37,26,"WORKSPACE.TIME_ROUNDING_MODAL.RADIO_BUTTONS.OPTION_3.INFO_MESSAGE")," "),s.Cb(3),s.wc("list",t.optionsTime)("value",t.minutes),s.Cb(3),s.ad(s.pc(43,28,"GLOBAL.CANCEL_BTN")),s.Cb(3),s.bd(" ",s.pc(46,30,"GLOBAL.SAVE_LABEL")," "))},directives:[v.A,v.c,v.s,v.v,ji.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var wo=n("gzhl"),Lo=n("/b/a"),Ro=n("psuR");function yo(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",77),s.jc("click",(function(){return s.Oc(e),s.nc().saveImage("")})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.REMOVE_IMAGE_LABEL")))}function _o(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",78),s.Xb(1,"div",30),s.Xb(2,"info",79),s.jc("dismissed",(function(){return s.Oc(e),s.nc().showTimesheetInfo=!1})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.wc("dismiss",!0),s.Cb(1),s.bd(" ",s.pc(4,2,"WORKSPACE.GENERAL_SETTINGS.TIMESHEET_SETTING.ACTIVATED_MESSAGE")," "))}function ko(e,t){1&e&&s.Sb(0,"hr",10)}function Wo(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",15),s.Xb(1,"input",80),s.jc("change",(function(){return s.Oc(e),s.nc().changeTracker()}))("ngModelChange",(function(t){return s.Oc(e),s.nc().hideTracker=t})),s.Wb(),s.Xb(2,"label",81),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.wc("ngModel",e.hideTracker),s.Cb(2),s.bd(" ",s.pc(4,2,"WORKSPACE.GENERAL_SETTINGS.TIMESHEET_SETTING.HIDE_TRACKER")," ")}}function Xo(e,t){1&e&&(s.Xb(0,"div",4),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.GENERAL_SETTINGS.NEW_PROJECT_DEFAULT.INFO_MESSAGE")," "))}function No(e,t){1&e&&(s.Xb(0,"div",4),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.GENERAL_SETTINGS.NEW_PROJECT_DEFAULT.INFO_MESSAGE_INACTIVE_BILLING")," "))}function Do(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",1),s.Xb(1,"div",22),s.Xb(2,"input",82),s.jc("change",(function(){return s.Oc(e),s.nc().modelChanged(!1,"defaultBillableProjects","Billable")}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.defaultBillableProjects=t})),s.Wb(),s.Xb(3,"label",83),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Xb(6,"div",22),s.Xb(7,"input",84),s.jc("change",(function(){return s.Oc(e),s.nc().modelChanged(!1,"defaultBillableProjects","Non billable")}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.defaultBillableProjects=t})),s.Wb(),s.Xb(8,"label",85),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.wc("value",!1)("ngModel",e.workspace.defaultBillableProjects),s.Cb(2),s.ad(s.pc(5,6,"GLOBAL.NON_BILLABLE_LABEL")),s.Cb(3),s.wc("value",!0)("ngModel",e.workspace.defaultBillableProjects),s.Cb(2),s.ad(s.pc(10,8,"GLOBAL.BILLABLE_LABEL"))}}function Po(e,t){1&e&&s.Sb(0,"hr",10)}function Mo(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",78),s.Xb(1,"div",30),s.Xb(2,"info",86),s.jc("dismissed",(function(){return s.Oc(e),s.nc().showDurationInfo=!1})),s.Zc(3),s.oc(4,"translate"),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.wc("dismiss",!0),s.Cb(1),s.bd(" ",e.workspace.trackTimeDownToSecond?s.pc(4,2,"WORKSPACE.GENERAL_SETTINGS.DURATION_FORMAT.NO_ROUNDED"):s.pc(5,4,"WORKSPACE.GENERAL_SETTINGS.DURATION_FORMAT.ROUNDED_ONE_MIN")," ")}}function Bo(e,t){1&e&&(s.Xb(0,"span"),s.Zc(1),s.Wb()),2&e&&(s.Cb(1),s.ad(", "))}function Uo(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.Xc(2,Bo,2,1,"span",69),s.Wb()),2&e){const e=t.$implicit,n=t.index,i=s.nc(2);s.Cb(1),s.bd(" ",e.placeholder,""),s.Cb(1),s.wc("ngIf",i.activeDaysOfWeek.length>n+1)}}function Go(e,t){if(1&e&&(s.Xb(0,"a",87),s.Xc(1,Uo,3,2,"span",88),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngForOf",e.activeDaysOfWeek)}}function xo(e,t){1&e&&(s.Xb(0,"a",87),s.Xb(1,"span"),s.Zc(2," Select days "),s.Wb(),s.Wb())}function Fo(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",92),s.Xb(1,"div",93),s.Xb(2,"input",94),s.jc("ngModelChange",(function(n){return s.Oc(e),t.$implicit.value=n})),s.Wb(),s.Xb(3,"label",95),s.Xb(4,"div",96),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc(2);s.Cb(2),s.wc("ngModel",e.value)("id",e.label),s.Cb(1),s.wc("for",e.label),s.Cb(2),s.ad(s.pc(6,4,n.weekDays.get(e.label.toUpperCase())))}}function jo(e,t){if(1&e&&(s.Xb(0,"div",89),s.Xb(1,"div",90),s.Xc(2,Fo,7,6,"div",91),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.wc("ngForOf",e.dayOfWeekDropdown)}}function Zo(e,t){1&e&&s.Sb(0,"hr",10)}function Vo(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",3),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"div",4),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xb(8,"div",97),s.Xb(9,"div",0),s.Xb(10,"div",98),s.Xb(11,"div",99),s.Sb(12,"input",100),s.Xb(13,"div",101),s.Xb(14,"span",102),s.Xb(15,"a",103,104),s.jc("click",(function(){s.Oc(e);const t=s.Lc(16),n=s.nc(),i=s.Lc(282);return t.blur(),n.openModal(i)}))("keyup.enter",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(282);return t.openModal(n)})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.ad(s.pc(4,4,"WORKSPACE.GENERAL_SETTINGS.WORKSPACE_BILLABLE_RATE.TITLE")),s.Cb(3),s.bd(" ",s.pc(7,6,"WORKSPACE.GENERAL_SETTINGS.WORKSPACE_BILLABLE_RATE.INFO_MESSAGE")," "),s.Cb(6),s.wc("ngModel",e.hourlyRateLabel),s.Cb(5),s.bd(" ",s.pc(18,8,"GLOBAL.CHANGE_LABEL")," ")}}const Yo=function(){return["/upgrade"]},Ho=function(){return{plan:"basic"}};function $o(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",105),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",106),s.jc("click",(function(){return s.Oc(e),s.nc().addEventOnSettingsChanged("Basic","Upgrade")})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,4,"WORKSPACE.FEATURE.MANY.BASIC"),""),s.Cb(2),s.wc("routerLink",s.Ac(8,Yo))("queryParams",s.Ac(9,Ho)),s.Cb(1),s.ad(s.pc(6,6,"GLOBAL.UPGRADE_BTN")))}const Ko=function(){return{plan:"standard"}};function qo(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",107),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",106),s.jc("click",(function(){return s.Oc(e),s.nc().addEventOnSettingsChanged("Standard","Upgrade")})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,4,"WORKSPACE.FEATURE.MANY.STANDARD")," "),s.Cb(2),s.wc("routerLink",s.Ac(8,Yo))("queryParams",s.Ac(9,Ko)),s.Cb(1),s.ad(s.pc(6,6,"GLOBAL.UPGRADE_BTN")))}function zo(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(", ",e.roundingMinutes," ")}}function Qo(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Xc(3,zo,2,1,"span",69),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.pc(2,2,e.WorkspaceRoundTranslateEnum[e.workspace.round.round]),""),s.Cb(2),s.wc("ngIf",e.workspace.round.minutes)}}function Jo(e,t){1&e&&(s.Zc(0),s.oc(1,"translate")),2&e&&s.bd(" ",s.pc(1,1,"WORKSPACE.GENERAL_SETTINGS.TIME_ROUNDING.SET")," ")}function er(e,t){1&e&&s.Sb(0,"hr",10)}function tr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",107),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",106),s.jc("click",(function(){return s.Oc(e),s.nc().addEventOnSettingsChanged("Standard","Upgrade")})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,4,"WORKSPACE.FEATURE.MANY.STANDARD")," "),s.Cb(2),s.wc("routerLink",s.Ac(8,Yo))("queryParams",s.Ac(9,Ko)),s.Cb(1),s.ad(s.pc(6,6,"GLOBAL.UPGRADE_BTN")))}function nr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"div",0),s.Xb(2,"div",1),s.Xb(3,"div",3),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"div",4),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(9,"div",60),s.Xb(10,"input",108),s.jc("change",(function(){s.Oc(e);const t=s.nc();return t.modelChanged(!1,"taskRateEnabled",t.workspace.taskRateEnabled)}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.taskRateEnabled=t})),s.Wb(),s.Xb(11,"label",109),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Xb(14,"div",60),s.Xb(15,"input",110),s.jc("change",(function(){s.Oc(e);const t=s.nc();return t.modelChanged(!1,"taskBillableEnabled",t.workspace.taskBillableEnabled)}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.taskBillableEnabled=t})),s.Wb(),s.Xb(16,"label",111),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Hb("disable-area",!e.hasFeature(e.Features.TASK_RATES)),s.Cb(4),s.ad(s.pc(5,8,"GLOBAL.TASK_RATES_TITLE")),s.Cb(3),s.bd(" ",s.pc(8,10,"WORKSPACE.GENERAL_SETTINGS.TASK_RATES.INFO_MESSAGE")," "),s.Cb(3),s.wc("ngModel",e.workspace.taskRateEnabled),s.Cb(2),s.bd(" ",s.pc(13,12,"WORKSPACE.GENERAL_SETTINGS.TASK_RATES.TOGGLE_ONE")," "),s.Cb(3),s.wc("ngModel",e.workspace.taskBillableEnabled),s.Cb(2),s.bd(" ",s.pc(18,14,"WORKSPACE.GENERAL_SETTINGS.TASK_RATES.TOGGLE_TWO")," ")}}function ir(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",60),s.Xb(1,"input",115),s.jc("change",(function(){s.Oc(e);const t=s.nc(2);return t.modelChanged(!1,"regularUserCanSeeOtherUsersTimeOff",t.workspace.timeOff.regularUserCanSeeOtherUsersTimeOff)}))("ngModelChange",(function(t){return s.Oc(e),s.nc(2).workspace.timeOff.regularUserCanSeeOtherUsersTimeOff=t})),s.Wb(),s.Xb(2,"label",116),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(1),s.wc("ngModel",e.workspace.timeOff.regularUserCanSeeOtherUsersTimeOff),s.Cb(2),s.bd(" ",s.pc(4,2,"WORKSPACE.PTO.REGULAR_USER_FLAG")," ")}}function sr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"div",0),s.Xb(2,"div",1),s.Xb(3,"div",3),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"div",4),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(9,"div",60),s.Xb(10,"input",112),s.jc("change",(function(){s.Oc(e);const t=s.nc();return t.modelChanged(!1,"timeOffActive",t.workspace.timeOff.active)}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.timeOff.active=t})),s.Wb(),s.Xb(11,"label",113),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Xc(14,ir,5,4,"div",114),s.Wb()}if(2&e){const e=s.nc();s.Hb("disable-area",!e.hasFeature(e.Features.TIME_OFF)),s.Cb(4),s.ad(s.pc(5,7,"WORKSPACE.PTO.TITLE")),s.Cb(3),s.bd(" ",s.pc(8,9,"WORKSPACE.PTO.EXPLANATION")," "),s.Cb(3),s.wc("ngModel",e.workspace.timeOff.active),s.Cb(2),s.bd(" ",s.pc(13,11,"WORKSPACE.PTO.ACTIVATE_LABEL")," "),s.Cb(2),s.wc("ngIf",e.workspace.timeOff.active)}}function cr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",3),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"div",4),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xb(8,"div",11),s.Xb(9,"textarea",117),s.jc("change",(function(){return s.Oc(e),s.nc().modelChanged(!0)}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.companyAddress=t})),s.oc(10,"translate"),s.Zc(11,"          "),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.ad(s.pc(4,4,"WORKSPACE.GENERAL_SETTINGS.INVOICING.COMPANY_ADDRESS.TITLE")),s.Cb(3),s.bd(" ",s.pc(7,6,"WORKSPACE.GENERAL_SETTINGS.INVOICING.COMPANY_ADDRESS.INFO_MESSAGE")," "),s.Cb(3),s.xc("placeholder",s.pc(10,8,"WORKSPACE.GENERAL_SETTINGS.INVOICING.COMPANY_ADDRESS.TITLE")),s.wc("ngModel",e.workspace.companyAddress)}}const ar=function(){return{plan:"pro"}};function or(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",107),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",106),s.jc("click",(function(){return s.Oc(e),s.nc().addEventOnSettingsChanged("Pro","Upgrade")})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,4,"WORKSPACE.FEATURE.MANY.PRO")," "),s.Cb(2),s.wc("routerLink",s.Ac(8,Yo))("queryParams",s.Ac(9,ar)),s.Cb(1),s.ad(s.pc(6,6,"GLOBAL.UPGRADE_BTN")))}function rr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"div",0),s.Xb(2,"div",1),s.Xb(3,"div",3),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"div",4),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(9,"div",60),s.Xb(10,"input",118),s.jc("change",(function(){s.Oc(e);const t=s.nc();return t.modelChanged(!1,"expensesEnabled",t.workspace.expensesEnabled)}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.expensesEnabled=t})),s.Wb(),s.Xb(11,"label",119),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Hb("disable-area",!e.hasFeature(e.Features.EXPENSES)),s.Cb(4),s.ad(s.pc(5,6,"EXPENSES.TITLE")),s.Cb(3),s.bd(" ",s.pc(8,8,"WORKSPACE.GENERAL_SETTINGS.EXPENSES.INFO_MESSAGE")," "),s.Cb(3),s.wc("ngModel",e.workspace.expensesEnabled),s.Cb(2),s.bd(" ",s.pc(13,10,"WORKSPACE.GENERAL_SETTINGS.EXPENSES.TOGGLE")," ")}}function lr(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Sb(1,"hr",10),s.Xb(2,"div",0),s.Xb(3,"div",1),s.Xb(4,"div",3),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"div",4),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Xb(10,"div",122),s.Xb(11,"div",0),s.Xb(12,"div",98),s.Xb(13,"div",99),s.Sb(14,"input",123),s.Xb(15,"div",101),s.Xb(16,"span",102),s.Xb(17,"button",103,124),s.jc("click",(function(){s.Oc(e);const t=s.Lc(18),n=s.nc(2),i=s.Lc(284);return t.blur(),n.openModal(i)}))("keyup.enter",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(284);return t.openModal(n)})),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc(2);s.Cb(5),s.ad(s.pc(6,4,"WORKSPACE.GENERAL_SETTINGS.COST_PROFIT.WORKSPACE_RATE.TITLE")),s.Cb(3),s.bd(" ",s.pc(9,6,"WORKSPACE.GENERAL_SETTINGS.COST_PROFIT.WORKSPACE_RATE.INFO_MESSAGE")," "),s.Cb(6),s.wc("ngModel",e.costRateLabel),s.Cb(5),s.bd(" ",s.pc(20,8,"GLOBAL.CHANGE_LABEL")," ")}}function br(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Sb(1,"hr",10),s.Xb(2,"div",0),s.Xb(3,"div",1),s.Xb(4,"div",3),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"div",4),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(10,"div",60),s.Xb(11,"input",120),s.jc("change",(function(){s.Oc(e);const t=s.nc();return t.modelChanged(!1,"isCostRateActive",t.workspace.isCostRateActive)}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.isCostRateActive=t})),s.Wb(),s.Xb(12,"label",121),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Xc(15,lr,21,10,"ng-container",69),s.Wb()}if(2&e){const e=s.nc();s.Hb("disable-area",!e.hasFeature(e.Features.LABOR_COST)),s.Cb(5),s.ad(s.pc(6,7,"WORKSPACE.GENERAL_SETTINGS.COST_PROFIT.TITLE")),s.Cb(3),s.bd(" ",s.pc(9,9,"WORKSPACE.GENERAL_SETTINGS.COST_PROFIT.INFO_MESSAGE")," "),s.Cb(3),s.wc("ngModel",e.workspace.isCostRateActive),s.Cb(2),s.bd(" ",s.pc(14,11,"WORKSPACE.GENERAL_SETTINGS.COST_PROFIT.TOGGLE")," "),s.Cb(2),s.wc("ngIf",e.isCostRateActiveBackup&&e.workspace.isCostRateActive)}}function dr(e,t){1&e&&s.Sb(0,"hr",10)}function ur(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"div",0),s.Xb(2,"div",1),s.Xb(3,"div",3),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"div",4),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(9,"div",60),s.Xb(10,"input",125),s.jc("change",(function(){s.Oc(e);const t=s.nc();return t.modelChanged(!1,"scheduling",t.workspace.schedulingEnabled)}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.schedulingEnabled=t})),s.Wb(),s.Xb(11,"label",126),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Hb("disable-area",!e.hasFeature(e.Features.SCHEDULING)),s.Cb(4),s.ad(s.pc(5,6,"SCHEDULING.TITLE")),s.Cb(3),s.bd(" ",s.pc(8,8,"WORKSPACE.GENERAL_SETTINGS.SCHEDULING.INFO_MESSAGE")," "),s.Cb(3),s.wc("ngModel",e.workspace.schedulingEnabled),s.Cb(2),s.bd(" ",s.pc(13,10,"WORKSPACE.GENERAL_SETTINGS.SCHEDULING.TOGGLE")," ")}}function pr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"input",127),s.jc("change",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(286);return t.confirmCheckboxChange("locationsEnabled",n)})),s.Wb()}if(2&e){const e=s.nc();s.wc("ngModel",e.workspace.locationsEnabled)}}function hr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"input",128),s.jc("change",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(288);return t.confirmCheckboxChange("screenshotsEnabled",n)})),s.Wb()}if(2&e){const e=s.nc();s.wc("ngModel",e.workspace.screenshotsEnabled)}}function mr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",129),s.jc("click",(function(){return s.Oc(e),s.nc().addEventOnSettingsChanged("Enterprise","Upgrade")})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Xb(7,"div",130),s.Xb(8,"div",0),s.Xb(9,"div",1),s.Xb(10,"div",3),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xb(13,"div",4),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(16,"div",60),s.Xb(17,"input",112),s.jc("change",(function(){return s.Oc(e),s.nc().modelChanged()}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.timeOff.active=t})),s.Wb(),s.Xb(18,"label",113),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Wb(),s.Xb(21,"div"),s.Xb(22,"div",0),s.Xb(23,"div",1),s.Xb(24,"div",3),s.Zc(25),s.oc(26,"translate"),s.Wb(),s.Xb(27,"div",4),s.Zc(28),s.oc(29,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(30,"div",60),s.Xb(31,"input",118),s.jc("change",(function(){return s.Oc(e),s.nc().modelChanged()}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.expensesEnabled=t})),s.Wb(),s.Xb(32,"label",119),s.Zc(33),s.oc(34,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(35,"div"),s.Xb(36,"div"),s.Xb(37,"div",0),s.Xb(38,"div",1),s.Xb(39,"div",3),s.Zc(40),s.oc(41,"translate"),s.Wb(),s.Xb(42,"div",4),s.Zc(43),s.oc(44,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(45,"div",60),s.Xb(46,"input",125),s.jc("change",(function(){s.Oc(e);const t=s.nc();return t.modelChanged(!1,"scheduling",t.workspace.schedulingEnabled)}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.schedulingEnabled=t})),s.Wb(),s.Xb(47,"label",126),s.Zc(48),s.oc(49,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.bd(" ",s.pc(3,19,"WORKSPACE.PTO.UPGRADE_MESSAGE.PART1")," "),s.Cb(2),s.wc("routerLink",s.Ac(41,Yo)),s.Cb(1),s.ad(s.pc(6,21,"WORKSPACE.PTO.UPGRADE_MESSAGE.PART2")),s.Cb(6),s.ad(s.pc(12,23,"WORKSPACE.PTO.TITLE")),s.Cb(3),s.bd(" ",s.pc(15,25,"WORKSPACE.PTO.EXPLANATION")," "),s.Cb(3),s.wc("ngModel",e.workspace.timeOff.active),s.Cb(2),s.bd(" ",s.pc(20,27,"WORKSPACE.PTO.ACTIVATE_LABEL")," "),s.Cb(2),s.Hb("disable-area",!e.hasFeature(e.Features.EXPENSES)),s.Cb(4),s.ad(s.pc(26,29,"EXPENSES.TITLE")),s.Cb(3),s.bd(" ",s.pc(29,31,"WORKSPACE.GENERAL_SETTINGS.EXPENSES.INFO_MESSAGE")," "),s.Cb(3),s.wc("ngModel",e.workspace.expensesEnabled),s.Cb(2),s.bd(" ",s.pc(34,33,"WORKSPACE.GENERAL_SETTINGS.EXPENSES.TOGGLE")," "),s.Cb(3),s.Hb("disable-area",!e.hasFeature(e.Features.SCHEDULING)),s.Cb(4),s.ad(s.pc(41,35,"SCHEDULING.TITLE")),s.Cb(3),s.bd(" ",s.pc(44,37,"WORKSPACE.GENERAL_SETTINGS.SCHEDULING.INFO_MESSAGE")," "),s.Cb(3),s.wc("ngModel",e.workspace.schedulingEnabled),s.Cb(2),s.bd(" ",s.pc(49,39,"WORKSPACE.GENERAL_SETTINGS.SCHEDULING.TOGGLE")," ")}}const gr=function(){return{plan:"enterprise"}};function Er(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",107),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",106),s.jc("click",(function(){return s.Oc(e),s.nc().addEventOnSettingsChanged("Enterprise","Upgrade")})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,4,"WORKSPACE.FEATURE.TYPES.ENTERPRISE")," "),s.Cb(2),s.wc("routerLink",s.Ac(8,Yo))("queryParams",s.Ac(9,gr)),s.Cb(1),s.ad(s.pc(6,6,"GLOBAL.UPGRADE_BTN")))}function fr(e,t){1&e&&(s.Xb(0,"div"),s.Sb(1,"hr"),s.Xb(2,"div",131),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"AUDIT_LOG.OLD_LOGS_AUTO_DELETED_LABEL")," "))}function Sr(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",132),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"AUDIT_LOG.RECORD_ALL_CHANGES")," "))}function Cr(e,t){if(1&e&&(s.Xb(0,"span",137),s.Zc(1),s.oc(2,"translate"),s.oc(3,"momentFormat"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.cd(" ",s.pc(2,2,"AUDIT_LOG.ENABLED_ON_LABEL"),": ",s.qc(3,4,null==e.workspace.auditLogSettings?null:e.workspace.auditLogSettings.timeEntryStartedRecording,e.user.settings.dateFormat)," ")}}function Ar(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",133),s.Xb(3,"input",134),s.jc("change",(function(t){return s.Oc(e),s.nc().auditLogSettingsChanged("timeEntry",t.target.checked)})),s.Wb(),s.Xb(4,"label",135),s.Zc(5),s.oc(6,"translate"),s.Xc(7,Cr,4,7,"span",136),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.wc("checked",e.workspace.auditLogSettings.timeEntryAuditing),s.Cb(2),s.bd(" ",s.pc(6,3,"WORKSPACE.IMPORT.TIME_ENTRIES")," "),s.Cb(2),s.wc("ngIf",null==e.workspace.auditLogSettings?null:e.workspace.auditLogSettings.timeEntryStartedRecording)}}function Or(e,t){if(1&e&&(s.Xb(0,"span",137),s.Zc(1),s.oc(2,"translate"),s.oc(3,"momentFormat"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.cd(" ",s.pc(2,2,"AUDIT_LOG.ENABLED_ON_LABEL"),": ",s.qc(3,4,null==e.workspace.auditLogSettings?null:e.workspace.auditLogSettings.projectStartedRecording,e.user.settings.dateFormat)," ")}}function vr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",133),s.Xb(3,"input",138),s.jc("change",(function(t){return s.Oc(e),s.nc().auditLogSettingsChanged("project",t.target.checked)})),s.Wb(),s.Xb(4,"label",139),s.Zc(5),s.oc(6,"translate"),s.Xc(7,Or,4,7,"span",136),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.wc("checked",null==e.workspace.auditLogSettings?null:e.workspace.auditLogSettings.projectAuditing),s.Cb(2),s.bd(" ",s.pc(6,3,"GLOBAL.PROJECTS_LABEL")," "),s.Cb(2),s.wc("ngIf",null==e.workspace.auditLogSettings?null:e.workspace.auditLogSettings.projectStartedRecording)}}function Tr(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.pc(2,1,e.predefinedGroupingLabels.get(e.workspace.projectGroupingLabel))," ")}}function Ir(e,t){if(1&e&&s.Zc(0),2&e){const e=s.nc(2);s.bd(" ",e.workspace.projectGroupingLabel," ")}}function wr(e,t){if(1&e&&(s.Xb(0,"span",137),s.Zc(1),s.oc(2,"translate"),s.oc(3,"momentFormat"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.cd(" ",s.pc(2,2,"AUDIT_LOG.ENABLED_ON_LABEL"),": ",s.qc(3,4,null==e.workspace.auditLogSettings?null:e.workspace.auditLogSettings.clientStartedRecording,e.user.settings.dateFormat)," ")}}function Lr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",133),s.Xb(3,"input",140),s.jc("change",(function(t){return s.Oc(e),s.nc().auditLogSettingsChanged("client",t.target.checked)})),s.Wb(),s.Xb(4,"label",141),s.Xc(5,Tr,3,3,"ng-container",57),s.Xc(6,Ir,1,1,"ng-template",null,142,s.Yc),s.Xc(8,wr,4,7,"span",136),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.Lc(7),t=s.nc();s.Cb(3),s.wc("checked",null==t.workspace.auditLogSettings?null:t.workspace.auditLogSettings.clientStartedRecording),s.Cb(2),s.wc("ngIf","client"===t.workspace.projectGroupingLabel||"department"===t.workspace.projectGroupingLabel||"category"===t.workspace.projectGroupingLabel)("ngIfElse",e),s.Cb(3),s.wc("ngIf",null==t.workspace.auditLogSettings?null:t.workspace.auditLogSettings.clientStartedRecording)}}function Rr(e,t){if(1&e&&(s.Xb(0,"span",137),s.Zc(1),s.oc(2,"translate"),s.oc(3,"momentFormat"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.cd(" ",s.pc(2,2,"AUDIT_LOG.ENABLED_ON_LABEL"),": ",s.qc(3,4,null==e.workspace.auditLogSettings?null:e.workspace.auditLogSettings.tagStartedRecording,e.user.settings.dateFormat)," ")}}function yr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",133),s.Xb(3,"input",143),s.jc("change",(function(t){return s.Oc(e),s.nc().auditLogSettingsChanged("tag",t.target.checked)})),s.Wb(),s.Xb(4,"label",144),s.Zc(5),s.oc(6,"translate"),s.Xc(7,Rr,4,7,"span",136),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.wc("checked",null==e.workspace.auditLogSettings?null:e.workspace.auditLogSettings.tagAuditing),s.Cb(2),s.bd(" ",s.pc(6,3,"GLOBAL.TAGS_LABEL")," "),s.Cb(2),s.wc("ngIf",null==e.workspace.auditLogSettings?null:e.workspace.auditLogSettings.tagStartedRecording)}}function _r(e,t){if(1&e){const e=s.Yb();s.Xb(0,"rounding-modal",145),s.jc("onClose",(function(){return t.$implicit.close()}))("onChange",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().roundingSettingsChanged(n),i.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("optionsTime",e.optionsTime)("roundData",e.workspace.round)}}function kr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"hourly-rate",146),s.jc("onClose",(function(){return t.$implicit.close()}))("saveRate",(function(n){s.Oc(e);const i=t.$implicit,c=s.nc();return c.hourlyRateChanged(n),c.addEventOnSettingsChanged(n.amount,"hourlyRateAmount"),i.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("type",e.rateType.WORKSPACE)("hourlyRate",e.workspace.hourlyRate)("hasHistoricRateFeature",e.hasHistoricRateFeature)}}function Wr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"cost-rate",147),s.jc("onClose",(function(){return t.$implicit.close()}))("saveRate",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().costRateChanged(n),i.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("type",e.rateType.WORKSPACE)("costRate",e.workspace.costRate)("hasHistoricRateFeature",e.hasHistoricRateFeature)}}function Xr(e,t){1&e&&(s.Xb(0,"simple-modal",148),s.jc("confirmed",(function(){return t.$implicit.close(!0)}))("close",(function(){return t.$implicit.close(!1)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"div",149),s.Xb(4,"div",150),s.Zc(5),s.oc(6,"translate"),s.Xb(7,"a",151),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Zc(10,". "),s.Wb(),s.Xb(11,"div",150),s.Xb(12,"strong",152),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Zc(15),s.oc(16,"translate"),s.Xb(17,"a",151),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Zc(20),s.oc(21,"translate"),s.Xb(22,"a",153),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Zc(25,", "),s.Xb(26,"a",154),s.Zc(27),s.oc(28,"translate"),s.Wb(),s.Zc(29),s.oc(30,"translate"),s.Wb(),s.Wb()),2&e&&(s.wc("title",s.pc(1,11,"GLOBAL.EMAIL_CONFIRM_LABEL"))("btnText",s.pc(2,13,"WORKSPACE.I_AGREE")),s.Cb(5),s.bd(" ",s.pc(6,15,"WORKSPACE.GENERAL_SETTINGS.PRIVACY_CONFIRM_MODAL.TEXT.ACTIVATE")," "),s.Cb(3),s.ad(s.pc(9,17,"GLOBAL.GPS_TITLE")),s.Cb(5),s.bd(" ",s.pc(14,19,"WORKSPACE.GENERAL_SETTINGS.PRIVACY_CONFIRM_MODAL.TEXT.BOLDED_PRIVACY_CONFIRM")," "),s.Cb(2),s.bd(" ",s.pc(16,21,"WORKSPACE.SETTINGS.CONSENT_MSG_PART1")," "),s.Cb(3),s.ad(s.pc(19,23,"WORKSPACE.SETTINGS.CONSENT_MSG_PART2")),s.Cb(2),s.bd(" ",s.pc(21,25,"WORKSPACE.SETTINGS.CONSENT_MSG_PART3")," "),s.Cb(3),s.ad(s.pc(24,27,"WORKSPACE.SETTINGS.CONSENT_MSG_PART4")),s.Cb(4),s.ad(s.pc(28,29,"WORKSPACE.SETTINGS.CONSENT_MSG_PART5")),s.Cb(2),s.bd(" ",s.pc(30,31,"WORKSPACE.SETTINGS.CONSENT_MSG_PART6")," "))}function Nr(e,t){1&e&&(s.Xb(0,"simple-modal",148),s.jc("confirmed",(function(){return t.$implicit.close(!0)}))("close",(function(){return t.$implicit.close(!1)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"div",149),s.Xb(4,"div",150),s.Zc(5),s.oc(6,"translate"),s.Xb(7,"a",155),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Zc(10,". "),s.Wb(),s.Xb(11,"div",150),s.Xb(12,"strong",152),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Zc(15),s.oc(16,"translate"),s.Xb(17,"a",155),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Zc(20),s.oc(21,"translate"),s.Xb(22,"a",153),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Zc(25,", "),s.Xb(26,"a",154),s.Zc(27),s.oc(28,"translate"),s.Wb(),s.Zc(29),s.oc(30,"translate"),s.Wb(),s.Wb()),2&e&&(s.wc("title",s.pc(1,11,"GLOBAL.EMAIL_CONFIRM_LABEL"))("btnText",s.pc(2,13,"WORKSPACE.I_AGREE")),s.Cb(5),s.bd(" ",s.pc(6,15,"WORKSPACE.GENERAL_SETTINGS.PRIVACY_CONFIRM_MODAL.TEXT.ACTIVATE")," "),s.Cb(3),s.ad(s.pc(9,17,"GLOBAL.SCREENSHOT_TITLE")),s.Cb(5),s.bd(" ",s.pc(14,19,"WORKSPACE.GENERAL_SETTINGS.PRIVACY_CONFIRM_MODAL.TEXT.BOLDED_PRIVACY_CONFIRM")," "),s.Cb(2),s.bd(" ",s.pc(16,21,"WORKSPACE.SETTINGS.CONSENT_MSG_PART1")," "),s.Cb(3),s.ad(s.pc(19,23,"WORKSPACE.SETTINGS.CONSENT_MSG_PART2")),s.Cb(2),s.bd(" ",s.pc(21,25,"WORKSPACE.SETTINGS.CONSENT_MSG_PART3")," "),s.Cb(3),s.ad(s.pc(24,27,"WORKSPACE.SETTINGS.CONSENT_MSG_PART4")),s.Cb(4),s.ad(s.pc(28,29,"WORKSPACE.SETTINGS.CONSENT_MSG_PART5")),s.Cb(2),s.bd(" ",s.pc(30,31,"WORKSPACE.SETTINGS.CONSENT_MSG_PART6")," "))}let Dr=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r){this.workspaceService=e,this.authService=t,this.toaster=n,this.loader=i,this.cd=s,this.modalService=c,this.systemSettingsService=a,this.translateService=o,this.analyticsService=r,this.PaymentType=mo.b,this.rateType=po.a,this.dayOfWeekDropdown=[new Un.a(!1,ho.b.MONDAY.toString(),this.translateService.instant("TEAMS.REMINDERS.WEEKDAYS.MONDAY").substring(0,3)),new Un.a(!1,ho.b.TUESDAY.toString(),this.translateService.instant("TEAMS.REMINDERS.WEEKDAYS.TUESDAY").substring(0,3)),new Un.a(!1,ho.b.WEDNESDAY.toString(),this.translateService.instant("TEAMS.REMINDERS.WEEKDAYS.WEDNESDAY").substring(0,3)),new Un.a(!1,ho.b.THURSDAY.toString(),this.translateService.instant("TEAMS.REMINDERS.WEEKDAYS.THURSDAY").substring(0,3)),new Un.a(!1,ho.b.FRIDAY.toString(),this.translateService.instant("TEAMS.REMINDERS.WEEKDAYS.FRIDAY").substring(0,3)),new Un.a(!1,ho.b.SATURDAY.toString(),this.translateService.instant("TEAMS.REMINDERS.WEEKDAYS.SATURDAY").substring(0,3)),new Un.a(!1,ho.b.SUNDAY.toString(),this.translateService.instant("TEAMS.REMINDERS.WEEKDAYS.SUNDAY").substring(0,3))],this.legacyPlans=[mo.b.SPECIAL,mo.b.ENTERPRISE,mo.b.PREMIUM,mo.b.SPECIAL_YEAR,mo.b.ENTERPRISE_YEAR,mo.b.PREMIUM_YEAR],this.weekDays=new Map([[ho.b.MONDAY.toUpperCase(),"TEAMS.REMINDERS.WEEKDAYS.MONDAY"],[ho.b.TUESDAY.toUpperCase(),"TEAMS.REMINDERS.WEEKDAYS.TUESDAY"],[ho.b.WEDNESDAY.toUpperCase(),"TEAMS.REMINDERS.WEEKDAYS.WEDNESDAY"],[ho.b.THURSDAY.toUpperCase(),"TEAMS.REMINDERS.WEEKDAYS.THURSDAY"],[ho.b.FRIDAY.toUpperCase(),"TEAMS.REMINDERS.WEEKDAYS.FRIDAY"],[ho.b.SATURDAY.toUpperCase(),"TEAMS.REMINDERS.WEEKDAYS.SATURDAY"],[ho.b.SUNDAY.toUpperCase(),"TEAMS.REMINDERS.WEEKDAYS.SUNDAY"]]),this.optionsTime=[new Un.a("1",this.translateService.instant("INVOICES.DROPDOWNVALUES.MINUTES",{count:1})),new Un.a("5",this.translateService.instant("INVOICES.DROPDOWNVALUES.MINUTES",{count:5})),new Un.a("6",this.translateService.instant("INVOICES.DROPDOWNVALUES.MINUTES",{count:6})),new Un.a("10",this.translateService.instant("INVOICES.DROPDOWNVALUES.MINUTES",{count:10})),new Un.a("12",this.translateService.instant("INVOICES.DROPDOWNVALUES.MINUTES",{count:12})),new Un.a("15",this.translateService.instant("INVOICES.DROPDOWNVALUES.MINUTES",{count:15})),new Un.a("30",this.translateService.instant("INVOICES.DROPDOWNVALUES.MINUTES",{count:30})),new Un.a("60",this.translateService.instant("INVOICES.DROPDOWNVALUES.HOURS",{count:1})),new Un.a("240",this.translateService.instant("INVOICES.DROPDOWNVALUES.HOURS",{count:4}))],this.durationFormats=[new Un.a("full",this.translateService.instant("WORKSPACE.GENERAL_SETTINGS.DURATION_FORMAT.FORMATS.FULL")),new Un.a("compact",this.translateService.instant("WORKSPACE.GENERAL_SETTINGS.DURATION_FORMAT.FORMATS.COMPACT"))],this.renderCheckbox=!0,this.unsubscribe$=new Fn.a,this.debouncerWorkspace$=new p.a,this.backupWorkspace="",this.Features=is.a,this.WorkspaceRoundTranslateEnum=Ts.a,this.predefinedGroupingLabels=new Map([[go.a.client,"GLOBAL.CLIENTS_LABEL"],[go.a.department,"GLOBAL.DEPARTMENT_LABEL"],[go.a.category,"WORKSPACE.SETTINGS.CATEGORY_LABEL"]])}set workspace(e){e&&(this.isCostRateActiveBackup=e.isCostRateActive,this.backupWorkspace=e.toJson(),this._workspace=ss.a.clone(e),this.durationFormat=this.decideFormat(this._workspace),this.setRoundingMinutes(),this.setDaysOfWeek())}get workspace(){return this._workspace}ngOnInit(){this.durationFormats.push(new Un.a("decimal",this.translateService.instant("WORKSPACE.GENERAL_SETTINGS.DURATION_FORMAT.FORMATS.DECIMAL"),this.translateService.instant("WORKSPACE.GENERAL_SETTINGS.DURATION_FORMAT.FORMATS.DECIMAL"),!this.workspace.hasFeature(is.a.DECIMAL_FORMAT),this.workspace.hasFeature(is.a.DECIMAL_FORMAT)?null:this.translateService.instant("WORKSPACE.GENERAL_SETTINGS.DURATION_FORMAT.UPGRADE_TO_USE_DECIMAL_FORMAT_MESSAGE"))),this.hideTracker=!this.workspace.canSeeTracker,this.debouncerWorkspace$.pipe(Object(De.a)(600),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.save(null==e?void 0:e.prop,null==e?void 0:e.value)}),this.currency=this.workspace.hourlyRate.currency,this.setRoundingMinutes(),this.systemSettingsService.systemSettings$.pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isSelfHosted=!e.specialFeaturesActivated}),this.user=this.authService.getUser()}ngOnDestroy(){this.save(),this.unsubscribe$.next(!0),this.unsubscribe$.complete(),this.loader.hide()}get costRateLabel(){return Object(sn.m)(this.workspace.costRate)}get hourlyRateLabel(){return this.workspace.hourlyRate&&this.workspace.hourlyRate.amount||0}openModal(e){this.modalService.open(e,{centered:!0})}saveImage(e){this.workspace.image=e,this.modelChanged(!0,"image","Company logo")}roundingSettingsChanged(e){this.workspace.round.minutes=e.minutes,this.workspace.round.round=e.round,this.setRoundingMinutes(),this.modelChanged(!1,"timeRounding",e.minutes.concat(" ").concat(e.round))}changeTimeSheet(){const e=this.workspace.canSeeTimeSheet;e?this.workspace.forceProjects=!0:this.hasFeature(is.a.REQUIRED_FIELDS)||(this.workspace.forceProjects=!1),this.showTimesheetInfo=e,this.modelChanged(!1,"canSeeTimeSheet",this.workspace.canSeeTimeSheet)}changeTracker(){this.workspace.canSeeTracker=!this.hideTracker,this.modelChanged(!1,"canSeeTracker",!this.workspace.canSeeTracker)}durationFormatChanged(e){this.showDurationInfo=!0,this.durationFormat=e,this.workspace.trackTimeDownToSecond="compact"!==e,this.workspace.decimalFormat="decimal"===e,this.modelChanged(!1,"durationFormat",e)}changedForceProject(){this.workspace.forceProjects||(this.workspace.forceTasks=!1),this.modelChanged(!1,"forceProjects",this.workspace.forceProjects)}changedForceTasks(){this.workspace.forceTasks&&(this.workspace.forceProjects=!0),this.modelChanged(!1,"forceTasks",this.workspace.forceTasks)}setFirstCostRate(){const e={amount:0,currency:this.currency,since:ke().toISOString()};this.costRateChanged(e)}rerenderInputs(){this.renderCheckbox=!1,this.cd.detectChanges(),this.renderCheckbox=!0,this.cd.detectChanges()}confirmCheckboxChange(e,t){const n=this.workspace[e],i=!n;if(!i)return this.workspace[e]=i,void this.modelChanged(!1,e,!1);this.modalService.open(t,{centered:!0}).result.then(t=>{t?(this.workspace[e]=i,this.modelChanged(!0,e,!0)):(this.workspace[e]=n,this.rerenderInputs())},t=>{this.workspace[e]=n,this.rerenderInputs()})}modelChanged(e=!1,t,n){e?this.save(t,n):this.debouncerWorkspace$.next({prop:t,value:n})}hourlyRateChanged(e){this.loader.show("WORKSPACE.SETTINGS.LOADER_TITLE","GLOBAL.LOADER_WAIT_MOMENT",{minDuration:1e3}),this.workspaceService.setHourlyRate(e.amount,e.currency,e.since).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.addEventOnSettingsChanged(e.currency,"hourlyRateCurrency"),this.loader.hide()},()=>this.loader.hide()),this.currency=e.currency}costRateChanged(e){this.loader.show("WORKSPACE.SETTINGS.LOADER_TITLE","GLOBAL.LOADER_WAIT_MOMENT",{minDuration:1e3}),this.workspaceService.setCostRate(e.amount,this.currency,e.since).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.addEventOnSettingsChanged(`${null==e?void 0:e.amount}${null==e?void 0:e.since}`,"costRate"),this.loader.hide()},()=>this.loader.hide())}setRoundingMinutes(){try{const e=this.workspace.round.minutes;this.roundingMinutes=this.optionsTime.filter(t=>t.value===e)[0].label}catch(e){}}save(e,t){!this.workspace.hasFeature(is.a.LABOR_COST)||null!==this.workspace.costRate&&null!==this.workspace.costRate.amount||this.setFirstCostRate();const n=this.workspace.toJson();this.backupWorkspace!==n&&(this.workspaceService.updateWorkspaceSettings(this.workspace),this.addEventOnSettingsChanged(t,e))}hasFeature(e){return!!this.isSelfHosted||this.workspace.features.includes(e)}decideFormat(e){return e.decimalFormat?"decimal":e.trackTimeDownToSecond?"full":"compact"}setDaysOfWeek(){this.dayOfWeekDropdown=this.dayOfWeekDropdown.map(e=>{var t;const n=null===(t=this.workspace.workingDays)||void 0===t?void 0:t.map(e=>e.toString());return e.value=null==n?void 0:n.includes(e.label.toString()),e}),this.activeDaysOfWeek=this.dayOfWeekDropdown.filter(e=>e.value)}updateWorkingDays(){const e=this.dayOfWeekDropdown.filter(e=>e.value);if(0===e.length)return this.toaster.error("Must have at least one working days"),void this.setDaysOfWeek();this.workspace.workingDays=e.map(e=>ho.b[e.label]),this.debouncerWorkspace$.next({prop:"workingDays",value:this.workspace.workingDays.join(",")})}auditLogStatusChanged(e){var t;this.workspace.auditLogSettings.auditEnabled=e,e&&null===(null===(t=this.workspace.auditLogSettings)||void 0===t?void 0:t.timeEntryAuditing)&&(this.workspace.auditLogSettings.timeEntryAuditing=e),this.modelChanged(!1,"auditEnabled",this.workspace.auditLogSettings.auditEnabled)}auditLogSettingsChanged(e,t){switch(sessionStorage.removeItem(Eo.c),e){case"timeEntry":this.workspace.auditLogSettings.timeEntryAuditing=t;break;case"project":this.workspace.auditLogSettings.projectAuditing=t;break;case"client":this.workspace.auditLogSettings.clientAuditing=t;break;case"tag":this.workspace.auditLogSettings.tagAuditing=t}this.workspace.auditLogSettings.timeEntryAuditing||this.workspace.auditLogSettings.projectAuditing||this.workspace.auditLogSettings.clientAuditing||this.workspace.auditLogSettings.tagAuditing?this.modelChanged(!1,"audit"+e,t):(this.workspace.auditLogSettings.auditEnabled=!1,this.modelChanged(!1,"auditEnabled",this.workspace.auditLogSettings.auditEnabled))}addEventOnSettingsChanged(e,t){if(void 0===e||void 0===t)return;let n,i,s,c,a="";"image"==t&&(n="submit",i="General",s="Company logo"),"canSeeTimeSheet"==t&&(n="switch",i="General",s="Timesheet",c="Timesheet"),"canSeeTracker"==t&&(n="switch",i="General",s="Timesheet",c="Tracker"),"defaultBillableProjects"==t&&(n="switch",i="General",s="New projects are by default"),"isProjectPublicByDefault"==t&&(n="switch",i="General",s="New projects are by default"),"projectGroupingLabel"==t&&(n="select",i="General",s="Group projects by",c="Group projects by"),"durationFormat"==t&&(n="select",i="General",s="Duration format"),"workingDays"==t&&(n="select",i="General",s="Working days",c="Working days"),"projectFavorites"==t&&(n="switch",i="General",s="Project and task favorites",c="Activate project and task favorites"),"hourlyRateAmount"==t&&(n="change",a=e,i="General",s="Workspace billable rate",c="Workspace billable rate"),"hourlyRateCurrency"==t&&(n="change",i="General",s="Currency",c="Currency"),"forceTasks"==t&&(n="switch",i="General",s="Do not allow saving time without",c="Required Task"),"forceProjects"==t&&(n="switch",i="General",s="Do not allow saving time without",c="Required Project"),"forceTags"==t&&(n="switch",i="General",s="Do not allow saving time without",c="Required Tag"),"forceDescription"==t&&(n="switch",i="General",s="Do not allow saving time without",c="Required Description"),"timeRounding"==t&&(n="select",i="General",s="Time rounding",c="Time rounding"),"taskBillableEnabled"==t&&(n="select",i="General",s="Task rates",c="Enable billable and non-billable tasks"),"taskRateEnabled"==t&&(n="switch",i="General",s="Task rates",c="Enable hourly rates for task"),"timeRounding"==t&&(n="switch",i="General",s="Time rounding",c="Time rounding"),"timeApprovalEnabled"==t&&(n="switch",i="General",s="Time approval",c="Enable time approval"),"timeOffActive"==t&&(n="switch",i="General",s="Time off",c="Activate time off"),"regularUserCanSeeOtherUsersTimeOff"==t&&(n="switch",i="General",s="Time off",c="Regular user can see other peoples time off"),"invoicingEnabled"==t&&(n="switch",i="General",s="invoicing",c="Enable invoicing"),"invoicingEnabled"==t&&(n="switch",i="General",s="invoicing",c="Enable invoicing"),"expensesEnabled"==t&&(n="switch",i="General",s="Activate expense tracking",c="Expenses"),"isCostRateActive"==t&&(n="switch",i="General",s="Cost and profit analysis",c="Activate cost rate"),"costRate"==t&&(n="change",i="General",s="Workspace cost rate",c="Cost rate"),"locationsEnabled"==t&&(n="switch",i="General",s="Track location",c="Activate GPS tracking"),"screenshotsEnabled"==t&&(n="switch",i="General",s="Capture screenshots",c="Activate screenshot capturing"),"auditEnabled"==t&&(n="switch",i="General",s="Audit log",c="Activate audit log"),"audittimeEntry"==t&&(n="switch",i="General",s="Audit log",c="timeEntry"),"audittag"==t&&(n="switch",i="General",s="Audit log",c="tag"),"auditproject"==t&&(n="switch",i="General",s="Audit log",c="project"),"auditclient"==t&&(n="switch",i="General",s="Audit log",c="client"),"Upgrade"==t&&(n="submit",i="General",c="Upgrade"),"scheduling"==t&&(n="switch",i="General",s="Cost and profit analysis",c="Activate project and team scheduling"),this.analyticsService.addEvent(new Fi.a({event:n,uevent:n,value:e,amount:a,section:"Workspace settings",section2:i,section3:s,section4:c}))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(re.a),s.Rb(r.a),s.Rb(Hn.a),s.Rb(s.h),s.Rb(w.q),s.Rb(bn.a),s.Rb(g.f),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["settings-tab"]],inputs:{workspace:"workspace",hasHistoricRateFeature:"hasHistoricRateFeature"},decls:289,vars:214,consts:[[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-12"],[1,"cl-mb-3"],[1,"cl-h2","cl-mb-0"],[1,"cl-text-gray-9","cl-w-lg-75"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-avatar","cl-upload-img",3,"classSize","src","name"],[1,"cl-upload-btn-wrapper"],["name","Company logo",1,"cl-mr-3",3,"text","onUploaded"],["class","cl-color-blue cl-d-inline-block cl-mt-2",3,"click",4,"ngIf"],[1,"cl-mt-0"],[1,"cl-form-group","cl-col-md-12","cl-col-lg-8","cl-col-lg-custom-5"],["type","text","autocomplete","off","spellcheck","false",1,"cl-form-control",3,"ngModel","placeholder","change","keyup.enter","ngModelChange"],["nameInput",""],["class","cl-form-row cl-w-100",4,"ngIf"],[1,"cl-custom-control","cl-custom-switch"],["type","checkbox","name","activateTimesheet","id","activateTimesheet",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","activateTimesheet",1,"cl-custom-control-label"],["class","cl-mt-0",4,"ngIf"],["class","cl-custom-control cl-custom-switch",4,"ngIf"],["class","cl-text-gray-9 cl-w-lg-75",4,"ngIf"],["class","cl-form-group cl-col-md-12",4,"ngIf"],[1,"cl-custom-control","cl-custom-radio","cl-custom-control-inline"],["type","radio","id","statusPublic","name","isProjectPublicByDefault",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","statusPublic",1,"cl-custom-control-label"],["type","radio","id","statusPrivate","name","isProjectPublicByDefault",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","statusPrivate",1,"cl-custom-control-label"],[1,"cl-form-group","cl-mb-0","cl-col-md-12","cl-col-lg-5"],[3,"projectGroupingLabel","onUpdate"],[1,"cl-text-gray-9","cl-w-lg-100"],[1,"cl-form-group","cl-col-md-12","cl-col-lg-5"],[1,"cl-form-group","cl-mb-0","cl-col-md-6"],[3,"list","value","onChanged"],["dropdownKey","",1,"cl-dropdown","cl-mb-2",3,"onClose"],["class","cl-mb-2 cl-ml-1","dropdownKeyButton","",4,"ngIf","ngIfElse"],["selectDays",""],["class","cl-dropdown-menu cl-mw-100 cl-prevent-close",4,"dropdownKeyContent"],["type","checkbox","id","projectFavorites",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","projectFavorites",1,"cl-custom-control-label"],["class","cl-form-row",4,"ngIf"],[1,"cl-form-group","cl-mb-0","cl-col-md-12","cl-col-lg-8","cl-col-lg-custom-4"],[1,"cl-form-group","cl-col-md-3"],["type","text","id","currency","autocomplete","off","inputString","","spellcheck","false",1,"cl-form-control",3,"ngModel","placeholder","keyup.enter","inputChange"],["currencyInput",""],["class","cl-form-group",4,"ngIf"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline","cl-checkbox-with-tooltip"],["type","checkbox","id","forceProjects",1,"cl-custom-control-input",3,"ngModel","disabled","ngModelChange","change"],["placement","right","for","forceProjects",1,"cl-custom-control-label",3,"ngbTooltip"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-checkbox-unset-z-index","cl-custom-control-inline"],["type","checkbox","id","forceTasks",1,"cl-custom-control-input",3,"ngModel","ngModelChange","change"],["for","forceTasks",1,"cl-custom-control-label"],["type","checkbox","id","forceTags",1,"cl-custom-control-input",3,"ngModel","ngModelChange","change"],["for","forceTags",1,"cl-custom-control-label"],["type","checkbox","id","forceDescription",1,"cl-custom-control-input",3,"ngModel","ngModelChange","change"],["for","forceDescription",1,"cl-custom-control-label"],["class","cl-form-group cl-mt-2 cl-mt-lg-0",4,"ngIf"],[3,"click"],[4,"ngIf","ngIfElse"],["noRounding",""],[3,"disable-area",4,"ngIf"],[1,"cl-custom-control","cl-custom-switch","cl-form-group"],["type","checkbox","id","timeApprovalEnabled",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","timeApprovalEnabled",1,"cl-custom-control-label"],["type","checkbox","id","invoicingEnabled",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","invoicingEnabled",1,"cl-custom-control-label"],["type","checkbox","class","cl-custom-control-input","name","activateGpsTrackingOption","id","activateGpsTrackingOption",3,"ngModel","change",4,"ngIf"],["for","activateGpsTrackingOption",1,"cl-custom-control-label"],["type","checkbox","class","cl-custom-control-input","id","screenshotsEnabled",3,"ngModel","change",4,"ngIf"],["for","screenshotsEnabled",1,"cl-custom-control-label"],[4,"ngIf"],["type","checkbox","id","auditlogEnabled",1,"cl-custom-control-input",3,"checked","change"],["for","auditlogEnabled",1,"cl-custom-control-label"],["timeRoundingModal",""],["hourlyRateModal",""],["costRateModal",""],["confirmGpsModal",""],["confirmScreenshotsModal",""],[1,"cl-color-blue","cl-d-inline-block","cl-mt-2",3,"click"],[1,"cl-form-row","cl-w-100"],[3,"dismiss","dismissed"],["type","checkbox","name","activateTimesheet2","id","activateTimesheet2",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","activateTimesheet2",1,"cl-custom-control-label"],["type","radio","id","nonBillable","name","defaultBillableProjects",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","nonBillable",1,"cl-custom-control-label"],["type","radio","id","billable","name","defaultBillableProjects",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","billable",1,"cl-custom-control-label"],[1,"cl-d-block","cl-ml-1","cl-mr-n1",3,"dismiss","dismissed"],["dropdownKeyButton","",1,"cl-mb-2","cl-ml-1"],[4,"ngFor","ngForOf"],[1,"cl-dropdown-menu","cl-mw-100","cl-prevent-close"],[1,"cl-scroll-area"],["class","cl-dropdown-item cl-dropdown-item-checkbox cl-cut-text-wrapper",4,"ngFor","ngForOf"],[1,"cl-dropdown-item","cl-dropdown-item-checkbox","cl-cut-text-wrapper"],[1,"cl-custom-control","cl-custom-checkbox"],["type","checkbox",1,"cl-custom-control-input",3,"ngModel","id","ngModelChange"],[1,"cl-custom-control-label",3,"for"],[1,"cl-cut-text","cl-text-capitalize"],["data-cy","billable-rate",1,"cl-form-group","cl-mb-0","cl-col-md-12","cl-col-lg-8","cl-col-lg-custom-5"],[1,"cl-form-group","cl-col-md-6"],[1,"cl-input-group"],["type","text","readonly","",1,"cl-form-control","cl-cut-text","cl-cursor-disabled",3,"ngModel"],[1,"cl-input-group-append"],[1,"cl-input-group-text","cl-bg-white"],["tabindex","0",1,"cl-color-blue",3,"click","keyup.enter"],["hourlyRateBtn",""],[1,"cl-form-group"],[1,"cl-btn",3,"routerLink","queryParams","click"],[1,"cl-form-group","cl-mt-2","cl-mt-lg-0"],["type","checkbox","id","taskRateEnabled",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","taskRateEnabled",1,"cl-custom-control-label"],["type","checkbox","id","taskBillableEnabled",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","taskBillableEnabled",1,"cl-custom-control-label"],["type","checkbox","id","timeOff",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","timeOff",1,"cl-custom-control-label"],["class","cl-custom-control cl-custom-switch cl-form-group",4,"ngIf"],["type","checkbox","id","timeOffRegularUser",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","timeOffRegularUser",1,"cl-custom-control-label"],["rows","3","type","text","autocomplete","off","spellcheck","false",1,"cl-form-control",3,"ngModel","placeholder","change","ngModelChange"],["type","checkbox","id","expensesEnabled",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","expensesEnabled",1,"cl-custom-control-label"],["type","checkbox","name","activateCostRate","id","activateCostRate",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","activateCostRate",1,"cl-custom-control-label"],["data-cy","cost-rate",1,"cl-form-group","cl-mb-0","cl-col-md-12","cl-col-lg-8","cl-col-lg-custom-5"],["type","text","readonly","",1,"cl-form-control","cl-cut-text",3,"ngModel"],["costRateBtn",""],["type","checkbox","id","schedulingEnabled",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","schedulingEnabled",1,"cl-custom-control-label"],["type","checkbox","name","activateGpsTrackingOption","id","activateGpsTrackingOption",1,"cl-custom-control-input",3,"ngModel","change"],["type","checkbox","id","screenshotsEnabled",1,"cl-custom-control-input",3,"ngModel","change"],[1,"cl-btn",3,"routerLink","click"],[1,"disable-area","cl-mt-2"],[1,"cl-alert","cl-alert-info","cl-fade","cl-show","cl-text-break","cl-d-inline-block"],[1,"cl-w-lg-100"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline"],["type","checkbox","id","auditTimeEntry",1,"cl-custom-control-input",3,"checked","change"],["for","auditTimeEntry",1,"cl-custom-control-label"],["class","cl-ml-3 cl-small cl-text-gray-9",4,"ngIf"],[1,"cl-ml-3","cl-small","cl-text-gray-9"],["type","checkbox","id","auditProjects",1,"cl-custom-control-input",3,"checked","change"],["for","auditProjects",1,"cl-custom-control-label"],["type","checkbox","id","auditClients",1,"cl-custom-control-input",3,"checked","change"],["for","auditClients",1,"cl-custom-control-label"],["customGroupingLabel",""],["type","checkbox","id","auditTags",1,"cl-custom-control-input",3,"checked","change"],["for","auditTags",1,"cl-custom-control-label"],[3,"optionsTime","roundData","onClose","onChange"],[3,"type","hourlyRate","hasHistoricRateFeature","onClose","saveRate"],[3,"type","costRate","hasHistoricRateFeature","onClose","saveRate"],[3,"title","btnText","confirmed","close"],[1,"cl-text-dark","cl-mb-0"],[1,"cl-mb-2"],["href","https://clockify.me/help/extra-features/gps-tracking","target","_blank"],[1,"cl-uppercase"],["href","https://clockify.me/terms","target","_blank"],["href","https://clockify.me/privacy","target","_blank"],["href","https://clockify.me/help/extra-features/screenshots","target","_blank"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"div",4),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Xb(9,"div",5),s.Sb(10,"avatar",6),s.Xb(11,"div",7),s.Xb(12,"btn-upload-file",8),s.jc("onUploaded",(function(e){return t.saveImage(e)})),s.Wb(),s.Xc(13,yo,3,3,"a",9),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(14,"hr",10),s.Xb(15,"div",0),s.Xb(16,"div",1),s.Xb(17,"div",3),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Wb(),s.Xb(20,"div",11),s.Xb(21,"input",12,13),s.jc("change",(function(){return t.modelChanged()}))("keyup.enter",(function(){return s.Oc(e),s.Lc(22).blur()}))("ngModelChange",(function(e){return t.workspace.name=e})),s.oc(23,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Sb(24,"hr",10),s.Xb(25,"div",0),s.Xb(26,"div",1),s.Xb(27,"div",3),s.Zc(28),s.oc(29,"translate"),s.Wb(),s.Xb(30,"div",4),s.Zc(31),s.oc(32,"translate"),s.Wb(),s.Wb(),s.Xc(33,_o,5,4,"div",14),s.Xb(34,"div",1),s.Xb(35,"div",15),s.Xb(36,"input",16),s.jc("change",(function(){return t.changeTimeSheet()}))("ngModelChange",(function(e){return t.workspace.canSeeTimeSheet=e})),s.Wb(),s.Xb(37,"label",17),s.Zc(38),s.oc(39,"translate"),s.Wb(),s.Wb(),s.Xc(40,ko,1,0,"hr",18),s.Xc(41,Wo,5,4,"div",19),s.Wb(),s.Wb(),s.Sb(42,"hr",10),s.Xb(43,"div",0),s.Xb(44,"div",1),s.Xb(45,"div",3),s.Zc(46),s.oc(47,"translate"),s.Wb(),s.Xc(48,Xo,3,3,"div",20),s.Xc(49,No,3,3,"div",20),s.Wb(),s.Xc(50,Do,11,10,"div",21),s.Wb(),s.Xc(51,Po,1,0,"hr",18),s.Xb(52,"div",0),s.Xb(53,"div",1),s.Xb(54,"div",22),s.Xb(55,"input",23),s.jc("change",(function(){return t.modelChanged(!1,"isProjectPublicByDefault","Public")}))("ngModelChange",(function(e){return t.workspace.isProjectPublicByDefault=e})),s.Wb(),s.Xb(56,"label",24),s.Zc(57),s.oc(58,"translate"),s.Wb(),s.Wb(),s.Xb(59,"div",22),s.Xb(60,"input",25),s.jc("change",(function(){return t.modelChanged(!1,"isProjectPublicByDefault","Private")}))("ngModelChange",(function(e){return t.workspace.isProjectPublicByDefault=e})),s.Wb(),s.Xb(61,"label",26),s.Zc(62),s.oc(63,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(64,"hr",10),s.Xb(65,"div",0),s.Xb(66,"div",1),s.Xb(67,"div",3),s.Zc(68),s.oc(69,"translate"),s.Wb(),s.Xb(70,"div",4),s.Zc(71),s.oc(72,"translate"),s.Wb(),s.Wb(),s.Xb(73,"div",27),s.Xb(74,"client-label",28),s.jc("onUpdate",(function(e){return t.workspace.projectGroupingLabel=e,t.modelChanged(!1,"projectGroupingLabel",t.workspace.projectGroupingLabel)})),s.Wb(),s.Wb(),s.Wb(),s.Sb(75,"hr",10),s.Xb(76,"div",0),s.Xb(77,"div",1),s.Xb(78,"div",3),s.Zc(79),s.oc(80,"translate"),s.Wb(),s.Xb(81,"div",29),s.Zc(82),s.oc(83,"translate"),s.Wb(),s.Wb(),s.Xc(84,Mo,6,6,"div",14),s.Xb(85,"div",30),s.Xb(86,"div",0),s.Xb(87,"div",31),s.Xb(88,"dropdown-items",32),s.jc("onChanged",(function(e){return t.durationFormatChanged(e)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(89,"hr",10),s.Xb(90,"div",0),s.Xb(91,"div",1),s.Xb(92,"div",3),s.Zc(93),s.oc(94,"translate"),s.Wb(),s.Xb(95,"div",29),s.Zc(96),s.oc(97,"translate"),s.Wb(),s.Wb(),s.Xb(98,"div",33),s.jc("onClose",(function(){return t.updateWorkingDays()})),s.Xc(99,Go,2,1,"a",34),s.Xc(100,xo,3,0,"ng-template",null,35,s.Yc),s.Xc(102,jo,3,1,"div",36),s.Wb(),s.Wb(),s.Sb(103,"hr",10),s.Xb(104,"div",0),s.Xb(105,"div",1),s.Xb(106,"div",3),s.Zc(107),s.oc(108,"translate"),s.Wb(),s.Xb(109,"div",4),s.Zc(110),s.oc(111,"translate"),s.Wb(),s.Wb(),s.Xb(112,"div",30),s.Xb(113,"div",15),s.Xb(114,"input",37),s.jc("change",(function(){return t.modelChanged(!1,"projectFavorites",t.workspace.projectFavorites)}))("ngModelChange",(function(e){return t.workspace.projectFavorites=e})),s.Wb(),s.Xb(115,"label",38),s.Zc(116),s.oc(117,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(118,Zo,1,0,"hr",18),s.Xc(119,Vo,19,10,"div",39),s.Xb(120,"div",0),s.Xb(121,"div",1),s.Xb(122,"div",3),s.Zc(123),s.oc(124,"translate"),s.Wb(),s.Xb(125,"div",4),s.Zc(126),s.oc(127,"translate"),s.Wb(),s.Wb(),s.Xb(128,"div",40),s.Xb(129,"div",0),s.Xb(130,"div",41),s.Xb(131,"input",42,43),s.jc("keyup.enter",(function(){return s.Oc(e),s.Lc(132).blur()}))("inputChange",(function(e){return t.workspace.hourlyRate.currency=e,t.hourlyRateChanged(t.workspace.hourlyRate)})),s.oc(133,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(134,"hr",10),s.Xc(135,$o,7,10,"div",44),s.Xb(136,"div",0),s.Xb(137,"div",1),s.Xb(138,"div",3),s.Zc(139),s.oc(140,"translate"),s.Wb(),s.Xb(141,"div",4),s.Zc(142),s.oc(143,"translate"),s.Wb(),s.Wb(),s.Xb(144,"div",1),s.Xb(145,"div",45),s.Xb(146,"input",46),s.jc("ngModelChange",(function(e){return t.workspace.forceProjects=e}))("change",(function(){return t.changedForceProject()})),s.Wb(),s.Xb(147,"label",47),s.oc(148,"translate"),s.Zc(149),s.oc(150,"translate"),s.Wb(),s.Wb(),s.Xb(151,"div",48),s.Xb(152,"input",49),s.jc("ngModelChange",(function(e){return t.workspace.forceTasks=e}))("change",(function(){return t.changedForceTasks()})),s.Wb(),s.Xb(153,"label",50),s.Zc(154),s.oc(155,"translate"),s.Wb(),s.Wb(),s.Xb(156,"div",48),s.Xb(157,"input",51),s.jc("ngModelChange",(function(e){return t.workspace.forceTags=e}))("change",(function(){return t.modelChanged(!1,"forceTags",t.workspace.forceTags)})),s.Wb(),s.Xb(158,"label",52),s.Zc(159),s.oc(160,"translate"),s.Wb(),s.Wb(),s.Xb(161,"div",48),s.Xb(162,"input",53),s.jc("ngModelChange",(function(e){return t.workspace.forceDescription=e}))("change",(function(){return t.modelChanged(!1,"forceDescription",t.workspace.forceDescription)})),s.Wb(),s.Xb(163,"label",54),s.Zc(164),s.oc(165,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(166,"hr",10),s.Xc(167,qo,7,10,"div",55),s.Xb(168,"div"),s.Xb(169,"div",0),s.Xb(170,"div",1),s.Xb(171,"div",3),s.Zc(172),s.oc(173,"translate"),s.Wb(),s.Xb(174,"div",4),s.Zc(175),s.oc(176,"translate"),s.Wb(),s.Wb(),s.Xb(177,"div",1),s.Xb(178,"a",56),s.jc("click",(function(){s.Oc(e);const n=s.Lc(280);return t.openModal(n)})),s.Xc(179,Qo,4,4,"ng-container",57),s.Xc(180,Jo,2,3,"ng-template",null,58,s.Yc),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(182,er,1,0,"hr",18),s.Xc(183,tr,7,10,"div",55),s.Xc(184,nr,19,16,"div",59),s.Sb(185,"hr",10),s.Xb(186,"div"),s.Xb(187,"div",0),s.Xb(188,"div",1),s.Xb(189,"div",3),s.Zc(190),s.oc(191,"translate"),s.Wb(),s.Xb(192,"div",4),s.Zc(193),s.oc(194,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(195,"div",60),s.Xb(196,"input",61),s.jc("change",(function(){return t.modelChanged(!1,"timeApprovalEnabled",t.workspace.timeApprovalEnabled)}))("ngModelChange",(function(e){return t.workspace.timeApprovalEnabled=e})),s.Wb(),s.Xb(197,"label",62),s.Zc(198),s.oc(199,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Sb(200,"hr",10),s.Xc(201,sr,15,13,"div",59),s.Sb(202,"hr",10),s.Xb(203,"div"),s.Xb(204,"div",0),s.Xb(205,"div",1),s.Xb(206,"div",3),s.Zc(207),s.oc(208,"translate"),s.Wb(),s.Xb(209,"div",4),s.Zc(210),s.oc(211,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(212,"div",60),s.Xb(213,"input",63),s.jc("change",(function(){return t.modelChanged(!1,"invoicingEnabled",t.workspace.invoicingEnabled)}))("ngModelChange",(function(e){return t.workspace.invoicingEnabled=e})),s.Wb(),s.Xb(214,"label",64),s.Zc(215),s.oc(216,"translate"),s.Wb(),s.Wb(),s.Xc(217,cr,12,10,"div",39),s.Wb(),s.Sb(218,"hr",10),s.Xc(219,or,7,10,"div",55),s.Xc(220,rr,14,12,"div",59),s.Sb(221,"hr",10),s.Xc(222,br,16,13,"div",59),s.Xc(223,dr,1,0,"hr",18),s.Xb(224,"div"),s.Xc(225,ur,14,12,"div",59),s.Wb(),s.Sb(226,"hr",10),s.Xb(227,"div"),s.Xb(228,"div",0),s.Xb(229,"div",1),s.Xb(230,"div",3),s.Zc(231),s.oc(232,"translate"),s.Wb(),s.Xb(233,"div",4),s.Zc(234),s.oc(235,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(236,"div",60),s.Xc(237,pr,1,1,"input",65),s.Xb(238,"label",66),s.Zc(239),s.oc(240,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Sb(241,"hr",10),s.Xb(242,"div"),s.Xb(243,"div",0),s.Xb(244,"div",1),s.Xb(245,"div",3),s.Zc(246),s.oc(247,"translate"),s.Wb(),s.Xb(248,"div",29),s.Zc(249),s.oc(250,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(251,"div",60),s.Xc(252,hr,1,1,"input",67),s.Xb(253,"label",68),s.Zc(254),s.oc(255,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xc(256,mr,50,42,"div",69),s.Sb(257,"hr",10),s.Xc(258,Er,7,10,"div",55),s.Xb(259,"div"),s.Xb(260,"div",0),s.Xb(261,"div",1),s.Xb(262,"div",3),s.Zc(263),s.oc(264,"translate"),s.Wb(),s.Xb(265,"div",29),s.Zc(266),s.oc(267,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(268,"div",60),s.Xb(269,"input",70),s.jc("change",(function(e){return t.auditLogStatusChanged(e.target.checked)})),s.Wb(),s.Xb(270,"label",71),s.Zc(271),s.oc(272,"translate"),s.Wb(),s.Wb(),s.Xc(273,fr,5,3,"div",69),s.Xc(274,Sr,5,3,"div",39),s.Xc(275,Ar,8,5,"div",39),s.Xc(276,vr,8,5,"div",39),s.Xc(277,Lr,9,4,"div",39),s.Xc(278,yr,8,5,"div",39),s.Wb(),s.Xc(279,_r,1,2,"ng-template",null,72,s.Yc),s.Xc(281,kr,1,3,"ng-template",null,73,s.Yc),s.Xc(283,Wr,1,3,"ng-template",null,74,s.Yc),s.Xc(285,Xr,31,33,"ng-template",null,75,s.Yc),s.Xc(287,Nr,31,33,"ng-template",null,76,s.Yc)}if(2&e){const e=s.Lc(101),n=s.Lc(181);s.Cb(4),s.ad(s.pc(5,122,"WORKSPACE.GENERAL_SETTINGS.LOGO.TITLE")),s.Cb(3),s.bd(" ",s.pc(8,124,"WORKSPACE.GENERAL_SETTINGS.LOGO.INFO_MESSAGE")," "),s.Cb(3),s.wc("classSize","cl-no-image-wrapper-lg")("src",t.workspace.image)("name",t.workspace.name),s.Cb(2),s.wc("text","SHARED_MODULES.BTN_UPLOAD_FILE_CONTENT.UPLOAD_IMG_BTN_DEFAULT"),s.Cb(1),s.wc("ngIf",t.workspace.image),s.Cb(5),s.ad(s.pc(19,126,"WORKSPACE.GENERAL_SETTINGS.WORKSPACE_NAME.TITLE")),s.Cb(3),s.xc("placeholder",s.pc(23,128,"WORKSPACE.GENERAL_SETTINGS.WORKSPACE_NAME.TITLE")),s.wc("ngModel",t.workspace.name),s.Cb(7),s.ad(s.pc(29,130,"GLOBAL.TIMESHEET_LABEL")),s.Cb(3),s.bd(" ",s.pc(32,132,"WORKSPACE.GENERAL_SETTINGS.TIMESHEET_SETTING.INFO_MESSAGE")," "),s.Cb(2),s.wc("ngIf",t.showTimesheetInfo),s.Cb(2),s.Hb("cl-form-group",t.workspace.canSeeTimeSheet),s.Cb(1),s.wc("ngModel",t.workspace.canSeeTimeSheet),s.Cb(2),s.bd(" ",s.pc(39,134,"WORKSPACE.GENERAL_SETTINGS.TIMESHEET_SETTING.ACTIVATE")," "),s.Cb(2),s.wc("ngIf",t.workspace.canSeeTimeSheet),s.Cb(1),s.wc("ngIf",t.workspace.canSeeTimeSheet),s.Cb(5),s.ad(s.pc(47,136,"WORKSPACE.GENERAL_SETTINGS.NEW_PROJECT_DEFAULT.TITLE")),s.Cb(2),s.wc("ngIf",t.workspace.activeBillableHours),s.Cb(1),s.wc("ngIf",!t.workspace.activeBillableHours),s.Cb(1),s.wc("ngIf",t.workspace.activeBillableHours),s.Cb(1),s.wc("ngIf",t.workspace.activeBillableHours),s.Cb(4),s.wc("value",!0)("ngModel",t.workspace.isProjectPublicByDefault),s.Cb(2),s.ad(s.pc(58,138,"GLOBAL.PUBLIC_LABEL")),s.Cb(3),s.wc("value",!1)("ngModel",t.workspace.isProjectPublicByDefault),s.Cb(2),s.ad(s.pc(63,140,"GLOBAL.PRIVATE_LABEL")),s.Cb(6),s.ad(s.pc(69,142,"WORKSPACE.GENERAL_SETTINGS.GROUP_PROJECT_BY.TITLE")),s.Cb(3),s.bd(" ",s.pc(72,144,"WORKSPACE.GENERAL_SETTINGS.GROUP_PROJECT_BY.INFO_MESSAGE")," "),s.Cb(3),s.wc("projectGroupingLabel",t.workspace.projectGroupingLabel),s.Cb(5),s.ad(s.pc(80,146,"WORKSPACE.GENERAL_SETTINGS.DURATION_FORMAT.TITLE")),s.Cb(3),s.bd(" ",s.pc(83,148,"WORKSPACE.GENERAL_SETTINGS.DURATION_FORMAT.INFO_MESSAGE")," "),s.Cb(2),s.wc("ngIf",t.showDurationInfo),s.Cb(4),s.wc("list",t.durationFormats)("value",t.durationFormat),s.Cb(5),s.ad(s.pc(94,150,"SCHEDULING.ASSIGNMENTS.CREATE_MODAL.WORKING_DAYS")),s.Cb(3),s.bd(" ",s.pc(97,152,"WORKSPACE.GENERAL_SETTINGS.WORKING_DAYS_INFO_MESSAGE")," "),s.Cb(3),s.wc("ngIf",t.activeDaysOfWeek.length>0)("ngIfElse",e),s.Cb(8),s.ad(s.pc(108,154,"WORKSPACE.GENERAL_SETTINGS.PROJECT_AND_TASK_FAVORITES.TITLE")),s.Cb(3),s.bd(" ",s.pc(111,156,"WORKSPACE.GENERAL_SETTINGS.PROJECT_AND_TASK_FAVORITES.INFO_MESSAGE")," "),s.Cb(4),s.wc("ngModel",t.workspace.projectFavorites),s.Cb(2),s.bd(" ",s.pc(117,158,"WORKSPACE.GENERAL_SETTINGS.PROJECT_AND_TASK_FAVORITES.TOGGLE")," "),s.Cb(2),s.wc("ngIf",t.workspace.activeBillableHours),s.Cb(1),s.wc("ngIf",t.workspace.activeBillableHours),s.Cb(4),s.ad(s.pc(124,160,"GLOBAL.CURRENCY_TITLE")),s.Cb(3),s.bd(" ",s.pc(127,162,"WORKSPACE.GENERAL_SETTINGS.CURRENCY.INFO_MESSAGE")," "),s.Cb(5),s.xc("placeholder",s.pc(133,164,"GLOBAL.CURRENCY_TITLE")),s.wc("ngModel",t.workspace.hourlyRate.currency),s.Cb(4),s.wc("ngIf",!t.hasFeature(t.Features.REQUIRED_FIELDS)),s.Cb(1),s.Hb("disable-area",!t.hasFeature(t.Features.REQUIRED_FIELDS)),s.Cb(3),s.ad(s.pc(140,166,"WORKSPACE.GENERAL_SETTINGS.SAVING_TIME.TITLE")),s.Cb(3),s.bd("",s.pc(143,168,"WORKSPACE.GENERAL_SETTINGS.SAVING_TIME.INFO_MESSAGE")," "),s.Cb(4),s.wc("ngModel",t.workspace.forceProjects)("disabled",t.workspace.canSeeTimeSheet),s.Cb(1),s.wc("ngbTooltip",t.workspace.canSeeTimeSheet?s.pc(148,170,"WORKSPACE.GENERAL_SETTINGS.SAVING_TIME.DISABLE_PROJECT_TOOLTIP"):""),s.Cb(2),s.ad(s.pc(150,172,"GLOBAL.PROJECT_LABEL")),s.Cb(3),s.wc("ngModel",t.workspace.forceTasks),s.Cb(2),s.ad(s.pc(155,174,"GLOBAL.TASKS_LABEL")),s.Cb(3),s.wc("ngModel",t.workspace.forceTags),s.Cb(2),s.ad(s.pc(160,176,"GLOBAL.TAG_LABEL")),s.Cb(3),s.wc("ngModel",t.workspace.forceDescription),s.Cb(2),s.ad(s.pc(165,178,"GLOBAL.DESCRIPTION_LABEL")),s.Cb(3),s.wc("ngIf",!t.hasFeature(t.Features.TASK_RATES)&&!t.hasFeature(t.Features.WORKSPACE_TIME_ROUNDING)),s.Cb(1),s.Hb("disable-area",!t.hasFeature(t.Features.WORKSPACE_TIME_ROUNDING)),s.Cb(4),s.ad(s.pc(173,180,"GLOBAL.TIME_ROUNDING_TITLE")),s.Cb(3),s.bd("",s.pc(176,182,"WORKSPACE.GENERAL_SETTINGS.TIME_ROUNDING.INFO_MESSAGE")," "),s.Cb(4),s.wc("ngIf",t.workspace.round.round)("ngIfElse",n),s.Cb(3),s.wc("ngIf",t.workspace.activeBillableHours),s.Cb(1),s.wc("ngIf",!t.hasFeature(t.Features.TASK_RATES)&&t.hasFeature(t.Features.WORKSPACE_TIME_ROUNDING)),s.Cb(1),s.wc("ngIf",t.workspace.activeBillableHours),s.Cb(2),s.Hb("disable-area",!t.hasFeature(t.Features.APPROVAL)),s.Cb(4),s.ad(s.pc(191,184,"GLOBAL.TIME_APPROVAL_TITLE")),s.Cb(3),s.bd(" ",s.pc(194,186,"WORKSPACE.GENERAL_SETTINGS.TIME_APPROVAL.INFO_MESSAGE")," "),s.Cb(3),s.wc("ngModel",t.workspace.timeApprovalEnabled),s.Cb(2),s.bd(" ",s.pc(199,188,"WORKSPACE.GENERAL_SETTINGS.TIME_APPROVAL.TOGGLE")," "),s.Cb(3),s.wc("ngIf",t.workspace.featureSubscriptionType!==t.PaymentType.ENTERPRISE&&t.workspace.featureSubscriptionType!==t.PaymentType.ENTERPRISE_YEAR),s.Cb(2),s.Hb("disable-area",!t.hasFeature(t.Features.INVOICING)),s.Cb(4),s.ad(s.pc(208,190,"GLOBAL.INVOICING_TITLE")),s.Cb(3),s.bd(" ",s.pc(211,192,"WORKSPACE.GENERAL_SETTINGS.INVOICING.INFO_MESSAGE")," "),s.Cb(3),s.wc("ngModel",t.workspace.invoicingEnabled),s.Cb(2),s.bd(" ",s.pc(216,194,"WORKSPACE.GENERAL_SETTINGS.INVOICING.TOGGLE")," "),s.Cb(2),s.wc("ngIf",t.workspace.invoicingEnabled),s.Cb(2),s.wc("ngIf",!t.hasFeature(t.Features.SCREENSHOTS)),s.Cb(1),s.wc("ngIf",t.workspace.featureSubscriptionType!==t.PaymentType.ENTERPRISE&&t.workspace.featureSubscriptionType!==t.PaymentType.ENTERPRISE_YEAR),s.Cb(2),s.wc("ngIf",t.workspace.activeBillableHours),s.Cb(1),s.wc("ngIf",t.workspace.featureSubscriptionType!==t.PaymentType.ENTERPRISE&&t.workspace.featureSubscriptionType!==t.PaymentType.ENTERPRISE_YEAR),s.Cb(2),s.wc("ngIf",t.workspace.featureSubscriptionType!==t.PaymentType.ENTERPRISE&&t.workspace.featureSubscriptionType!==t.PaymentType.ENTERPRISE_YEAR),s.Cb(2),s.Hb("disable-area",!t.hasFeature(t.Features.LOCATIONS)),s.Cb(4),s.ad(s.pc(232,196,"WORKSPACE.GENERAL_SETTINGS.TRACK_LOCATION.TITLE")),s.Cb(3),s.bd(" ",s.pc(235,198,"WORKSPACE.GENERAL_SETTINGS.TRACK_LOCATION.INFO_MESSAGE")," "),s.Cb(3),s.wc("ngIf",t.renderCheckbox),s.Cb(2),s.bd(" ",s.pc(240,200,"WORKSPACE.GENERAL_SETTINGS.TRACK_LOCATION.TOGGLE")," "),s.Cb(3),s.Hb("disable-area",!t.hasFeature(t.Features.SCREENSHOTS)),s.Cb(4),s.ad(s.pc(247,202,"WORKSPACE.GENERAL_SETTINGS.CAPTURE_SCREENSHOT.TITLE")),s.Cb(3),s.bd(" ",s.pc(250,204,"WORKSPACE.GENERAL_SETTINGS.CAPTURE_SCREENSHOT.INFO_MESSAGE")," "),s.Cb(3),s.wc("ngIf",t.renderCheckbox),s.Cb(2),s.bd(" ",s.pc(255,206,"WORKSPACE.GENERAL_SETTINGS.CAPTURE_SCREENSHOT.TOGGLE")," "),s.Cb(2),s.wc("ngIf",t.workspace.featureSubscriptionType===t.PaymentType.ENTERPRISE||t.workspace.featureSubscriptionType===t.PaymentType.ENTERPRISE_YEAR),s.Cb(2),s.wc("ngIf",!t.hasFeature(t.Features.AUDIT_LOG)),s.Cb(1),s.Hb("disable-area",!t.hasFeature(t.Features.AUDIT_LOG)),s.Cb(4),s.bd(" ",s.pc(264,208,"AUDIT_LOG.AUDIT_LOG_LABEL")," "),s.Cb(3),s.bd(" ",s.pc(267,210,"AUDIT_LOG.DESCRIPTION")," "),s.Cb(3),s.wc("checked",t.workspace.auditLogSettings.auditEnabled),s.Cb(2),s.bd(" ",s.pc(272,212,"AUDIT_LOG.ACTIVATE_AUDIT_LOG_LABEL")," "),s.Cb(2),s.wc("ngIf",t.workspace.auditLogSettings.auditEnabled&&!t.isSelfHosted),s.Cb(1),s.wc("ngIf",t.workspace.auditLogSettings.auditEnabled),s.Cb(1),s.wc("ngIf",t.workspace.auditLogSettings.auditEnabled),s.Cb(1),s.wc("ngIf",t.workspace.auditLogSettings.auditEnabled),s.Cb(1),s.wc("ngIf",t.workspace.auditLogSettings.auditEnabled),s.Cb(1),s.wc("ngIf",t.workspace.auditLogSettings.auditEnabled)}},directives:[Pc.a,fo.a,i.u,v.c,v.s,v.v,v.a,v.A,Ao,ji.a,ni.a,si.a,vo,w.bb,To.a,ii.a,i.t,k.g,Io,wo.a,Lo.a,Si.a],pipes:[g.e,Ro.a],styles:[".cl-custom-control.cl-custom-checkbox.cl-checkbox-with-tooltip[_ngcontent-%COMP%]{z-index:auto}"],changeDetection:0}),e})();var Pr=function(e){return e.PROJECT="PROJECT",e.TEAM="TEAM",e.REPORTS="REPORTS",e}({}),Mr=n("Jl2N"),Br=function(e){return e[e.ALL=0]="ALL",e[e.PUBLIC=1]="PUBLIC",e[e.OWN=2]="OWN",e}({});let Ur=(()=>{class e{constructor(){this.onChanged=new s.n,this.userCanSee=Br}set onlyAdminsSeeAllTimeEntries(e){const t=this.onlyAdminsSeeAllTimeEntries!==e;this._onlyAdminsSeeAllTimeEntries=e,this.isInitialized&&t&&this.setInitValues()}get onlyAdminsSeeAllTimeEntries(){return this._onlyAdminsSeeAllTimeEntries}set onlyAdminsSeePublicProjectsEntries(e){const t=this.onlyAdminsSeePublicProjectsEntries!==e;this._onlyAdminsSeePublicProjectsEntries=e,this.isInitialized&&t&&this.setInitValues()}get onlyAdminsSeePublicProjectsEntries(){return this._onlyAdminsSeePublicProjectsEntries}ngOnInit(){this.setInitValues(),this.isInitialized=!0}modelChanged(){this.regularUserCanSee===Br.ALL?this.onlyAdminsSeeAllTimeEntries=!1:this.regularUserCanSee===Br.PUBLIC?(this.onlyAdminsSeeAllTimeEntries=!0,this.onlyAdminsSeePublicProjectsEntries=!1):this.regularUserCanSee===Br.OWN&&(this.onlyAdminsSeeAllTimeEntries=!0,this.onlyAdminsSeePublicProjectsEntries=!0),this.onChanged.emit({onlyAdminsSeeAllTimeEntries:this.onlyAdminsSeeAllTimeEntries,onlyAdminsSeePublicProjectsEntries:this.onlyAdminsSeePublicProjectsEntries})}setInitValues(){this.regularUserCanSee=this.onlyAdminsSeeAllTimeEntries?this.onlyAdminsSeePublicProjectsEntries?Br.OWN:Br.PUBLIC:Br.ALL}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["regular-user-permission"]],inputs:{onlyAdminsSeeAllTimeEntries:"onlyAdminsSeeAllTimeEntries",onlyAdminsSeePublicProjectsEntries:"onlyAdminsSeePublicProjectsEntries",isExpansesEnabled:"isExpansesEnabled"},outputs:{onChanged:"onChanged"},decls:15,vars:15,consts:[[1,"cl-custom-control","cl-custom-radio","cl-custom-control-inline"],["type","radio","id","allTrackedTime","name","allTrackedTime",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","allTrackedTime",1,"cl-custom-control-label"],["type","radio","id","onlyTimeOnPublic","name","onlyTimeOnPublic",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","onlyTimeOnPublic",1,"cl-custom-control-label"],["type","radio","id","onlyOwnTime","name","onlyOwnTime",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","onlyOwnTime",1,"cl-custom-control-label"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"input",1),s.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.regularUserCanSee=e})),s.Wb(),s.Xb(2,"label",2),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Xb(5,"div",0),s.Xb(6,"input",3),s.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.regularUserCanSee=e})),s.Wb(),s.Xb(7,"label",4),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Xb(10,"div",0),s.Xb(11,"input",5),s.jc("change",(function(){return t.modelChanged()}))("ngModelChange",(function(e){return t.regularUserCanSee=e})),s.Wb(),s.Xb(12,"label",6),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(1),s.wc("value",t.userCanSee.ALL)("ngModel",t.regularUserCanSee),s.Cb(2),s.bd("",s.pc(4,9,t.isExpansesEnabled?"WORKSPACE.PERMISSIONS.CAN_SEE.CHECKBOX_OPTIONS_EXPENSES.ALL":"WORKSPACE.PERMISSIONS.CAN_SEE.CHECKBOX_OPTIONS.ALL")," "),s.Cb(3),s.wc("value",t.userCanSee.PUBLIC)("ngModel",t.regularUserCanSee),s.Cb(2),s.ad(s.pc(9,11,t.isExpansesEnabled?"WORKSPACE.PERMISSIONS.CAN_SEE.CHECKBOX_OPTIONS_EXPENSES.ONLY":"WORKSPACE.PERMISSIONS.CAN_SEE.CHECKBOX_OPTIONS.ONLY")),s.Cb(3),s.wc("value",t.userCanSee.OWN)("ngModel",t.regularUserCanSee),s.Cb(2),s.ad(s.pc(14,13,t.isExpansesEnabled?"WORKSPACE.PERMISSIONS.CAN_SEE.CHECKBOX_OPTIONS_EXPENSES.OWN_TIME":"WORKSPACE.PERMISSIONS.CAN_SEE.CHECKBOX_OPTIONS.OWN_TIME")))},directives:[v.A,v.c,v.s,v.v],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();class Gr{constructor(e){this._type=e&&e.type,this._changeDay=e&&e.changeDay,this._firstDay=e&&e.firstDay,this._dayOfMonth=e&&Number(e.dayOfMonth)>0?Number(e.dayOfMonth):0,this._olderThanPeriod=e&&e.olderThanPeriod,this._olderThanValue=e&&e.olderThanValue,this._changeHour=e&&e.changeHour}get type(){return this._type}set type(e){this._type=e}get changeDay(){return this._changeDay}set changeDay(e){this._changeDay=e}get changeHour(){return this._changeHour}get changeHourString(){return String(this._changeHour||0)}set changeHour(e){this._changeHour=e}get firstDay(){return this._firstDay}set firstDay(e){this._firstDay=e}get dayOfMonth(){return this._dayOfMonth}set dayOfMonth(e){this._dayOfMonth=e}get olderThanPeriod(){return this._olderThanPeriod}set olderThanPeriod(e){this._olderThanPeriod=e}get olderThanValue(){return this._olderThanValue}set olderThanValue(e){this._olderThanValue=e}}var xr=function(e){return e.WEEKLY="WEEKLY",e.MONTHLY="MONTHLY",e.OLDER_THAN="OLDER_THAN",e}({}),Fr=function(e){return e.DAYS="DAYS",e.WEEKS="WEEKS",e.MONTHS="MONTHS",e}({}),jr=n("+dED");function Zr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"dropdown-items",11),s.jc("onChanged",(function(t){s.Oc(e);const n=s.nc(2);return n.automaticLock.changeDay=t,n.valueChanged()})),s.Wb(),s.Zc(5," at "),s.Xb(6,"dropdown-items",12),s.jc("onChanged",(function(t){s.Oc(e);const n=s.nc(2);return n.setChangeHour(t),n.valueChanged()})),s.Wb(),s.Zc(7),s.Xb(8,"span"),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Xb(11,"dropdown-items",11),s.jc("onChanged",(function(t){s.Oc(e);const n=s.nc(2);return n.automaticLock.firstDay=t,n.valueChanged()})),s.Wb(),s.Zc(12,". "),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.bd("",s.pc(3,12,"WORKSPACE.LOCK_DATE_FOR_TIME_ENTRIES.WEEKLY.EVERY_CHOOSEN_DAY")," "),s.Cb(2),s.wc("type","TEXT")("list",e.weekDays)("value",e.automaticLock.changeDay),s.Cb(2),s.wc("type","TEXT")("list",e.timeDropdownValues)("value",e.automaticLock.changeHourString),s.Cb(1),s.bd(" ",e.offset," "),s.Cb(2),s.bd("",s.pc(10,14,"WORKSPACE.LOCK_DATE_FOR_TIME_ENTRIES.WEEKLY.LOCK_CHOOSEN_WEEK")," "),s.Cb(2),s.wc("type","TEXT")("list",e.weekDays)("value",e.automaticLock.firstDay)}}function Vr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"dropdown-items",11),s.jc("onChanged",(function(t){s.Oc(e);const n=s.nc(2);return n.automaticLock.dayOfMonth=t,n.valueChanged()})),s.Wb(),s.Zc(5," at "),s.Xb(6,"dropdown-items",12),s.jc("onChanged",(function(t){s.Oc(e);const n=s.nc(2);return n.setChangeHour(t),n.valueChanged()})),s.Wb(),s.Zc(7),s.Xb(8,"span"),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Zc(11,". "),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.bd("",s.pc(3,9,"WORKSPACE.LOCK_DATE_FOR_TIME_ENTRIES.MONTHLY.ON_THE_DAY")," "),s.Cb(2),s.wc("type","TEXT")("list",e.monthDates)("value",e.automaticLock.dayOfMonth),s.Cb(2),s.wc("type","TEXT")("list",e.timeDropdownValues)("value",e.automaticLock.changeHourString),s.Cb(1),s.bd(" ",e.offset," "),s.Cb(2),s.bd(" ",s.pc(10,11,"WORKSPACE.LOCK_DATE_FOR_TIME_ENTRIES.MONTHLY.LOCK_MONTH"),"")}}function Yr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",13),s.Xb(1,"div",14),s.Xb(2,"input",15),s.jc("inputChange",(function(t){s.Oc(e);const n=s.nc(2);return n.automaticLock.olderThanValue=t,n.valueChanged()})),s.Wb(),s.Wb(),s.Xb(3,"dropdown-items",16),s.jc("onChanged",(function(t){s.Oc(e);const n=s.nc(2);return n.automaticLock.olderThanPeriod=t,n.valueChanged()})),s.Wb(),s.Zc(4," at \xa0 "),s.Xb(5,"dropdown-items",12),s.jc("onChanged",(function(t){s.Oc(e);const n=s.nc(2);return n.setChangeHour(t),n.valueChanged()})),s.Wb(),s.Zc(6),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.wc("maxNumber",999)("minNumber",1)("decimal",!1)("ngModel",e.automaticLock.olderThanValue),s.Cb(1),s.wc("type","TEXT")("list",e.periods)("value",e.automaticLock.olderThanPeriod),s.Cb(2),s.wc("type","TEXT")("list",e.timeDropdownValues)("value",e.automaticLock.changeHourString),s.Cb(1),s.bd("\xa0 ",e.offset," ")}}const Hr=function(e,t,n){return{date:e,nextLockScheduledDate:t,time:n}};function $r(e,t){if(1&e&&(s.Xb(0,"span",17),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.qc(2,1,"WORKSPACE.LOCK_DATE_FOR_TIME_ENTRIES.SCHEDULE_EXPLANATION",s.Dc(4,Hr,e.date,e.nextLockScheduledDate,e.timeString))," ")}}function Kr(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",6),s.Xb(1,"dropdown-items",7),s.jc("onChanged",(function(t){s.Oc(e);const n=s.nc();return n.automaticLock.type=t,n.setType()})),s.Wb(),s.Xc(2,Zr,13,16,"div",8),s.Xc(3,Vr,12,13,"div",8),s.Xc(4,Yr,7,11,"div",9),s.Xc(5,$r,3,8,"span",10),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.wc("type","SMALL")("list",e.lockTypes)("value",e.automaticLock.type),s.Cb(1),s.wc("ngIf",e.automaticLock.type===e.automaticLockTypeEnum.WEEKLY),s.Cb(1),s.wc("ngIf",e.automaticLock.type===e.automaticLockTypeEnum.MONTHLY),s.Cb(1),s.wc("ngIf",e.automaticLock.type===e.automaticLockTypeEnum.OLDER_THAN),s.Cb(1),s.wc("ngIf",e.automaticLock.type!==e.automaticLockTypeEnum.OLDER_THAN)}}let qr=(()=>{class e{constructor(e,t,n){this.authService=e,this.workspaceService=t,this.cd=n,this.onLockChanged=new s.n,this.automaticLockTypeEnum=xr,this.weekDays=[new Un.a("MONDAY","TEAMS.REMINDERS.WEEKDAYS.MONDAY"),new Un.a("TUESDAY","TEAMS.REMINDERS.WEEKDAYS.TUESDAY"),new Un.a("WEDNESDAY","TEAMS.REMINDERS.WEEKDAYS.WEDNESDAY"),new Un.a("THURSDAY","TEAMS.REMINDERS.WEEKDAYS.THURSDAY"),new Un.a("FRIDAY","TEAMS.REMINDERS.WEEKDAYS.FRIDAY"),new Un.a("SATURDAY","TEAMS.REMINDERS.WEEKDAYS.SATURDAY"),new Un.a("SUNDAY","TEAMS.REMINDERS.WEEKDAYS.SUNDAY")],this.periods=[new Un.a(Fr.DAYS,"GLOBAL.DAYS_LABEL"),new Un.a(Fr.WEEKS,"GLOBAL.WEEKS_LABEL"),new Un.a(Fr.MONTHS,"GLOBAL.MONTHS_LABEL")],this.lockTypes=[new Un.a(xr.WEEKLY,"GLOBAL.WEEKLY_REPORTS_LABEL"),new Un.a(xr.MONTHLY,"GLOBAL.MONTHLY_LABEL"),new Un.a(xr.OLDER_THAN,"GLOBAL.OLDER_THAN_LABEL")],this.unsubscribe$=new p.a,this.monthDates=[];for(let i=1;i<=31;i++)this.monthDates.push(new Un.a(i,Object(sn.b)(i)))}set automaticLock(e){this.hasLockedData=!!e,e?(this._automaticLock=new Gr(e),this.backupLock=new Gr(e)):this._automaticLock=null}get automaticLock(){return this._automaticLock}set lockDate(e){this._lockDate=e,this.isInitialized&&this.updateDateForAutomaticLock()}get lockDate(){return this._lockDate}ngOnInit(){this.initTimeDropdown(),this.setOwnerTimeZone(),this.dateFormat=this.authService.getUser().settings.dateFormat,this.updateDateForAutomaticLock(),this.isInitialized=!0}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}setOwnerTimeZone(){this.workspaceService.getWorkspaceOwnerTimeZone().pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.ownersZone=e,this.offset=`(UTC${tn.tz(this.ownersZone).format("Z")})`||"",this.cd.detectChanges()})}initTimeDropdown(){const e="HOUR24"===this.authService.getUser().settings.timeFormat;this.timeDropdownValues=[new Un.a("0",e?"00:00":"12:00 AM"),new Un.a("1",e?"01:00":"1:00 AM"),new Un.a("2",e?"02:00":"2:00 AM"),new Un.a("3",e?"03:00":"3:00 AM"),new Un.a("4",e?"04:00":"4:00 AM"),new Un.a("5",e?"05:00":"5:00 AM"),new Un.a("6",e?"06:00":"6:00 AM"),new Un.a("7",e?"07:00":"7:00 AM"),new Un.a("8",e?"08:00":"8:00 AM"),new Un.a("9",e?"09:00":"9:00 AM"),new Un.a("10",e?"10:00":"10:00 AM"),new Un.a("11",e?"11:00":"11:00 AM"),new Un.a("12",e?"12:00":"12:00 PM"),new Un.a("13",e?"13:00":"1:00 PM"),new Un.a("14",e?"14:00":"2:00 PM"),new Un.a("15",e?"15:00":"3:00 PM"),new Un.a("16",e?"16:00":"4:00 PM"),new Un.a("17",e?"17:00":"5:00 PM"),new Un.a("18",e?"18:00":"6:00 PM"),new Un.a("19",e?"19:00":"7:00 PM"),new Un.a("20",e?"20:00":"8:00 PM"),new Un.a("21",e?"21:00":"9:00 PM"),new Un.a("22",e?"22:00":"10:00 PM"),new Un.a("23",e?"23:00":"11:00 PM")]}automaticLockChange(){if(!this.hasLockedData)return this.automaticLock=null,void this.onLockChanged.emit(null);this.automaticLock||(this.automaticLock=this.backupLock||new Gr({type:xr.WEEKLY,changeDay:this.weekDays[2].value,firstDay:this.weekDays[0].value,dayOfMonth:this.monthDates[0].value,olderThanPeriod:Fr.DAYS,olderThanValue:1})),this.emit()}setType(){const e=this.automaticLock.type;(e===xr.MONTHLY&&!this.automaticLock.dayOfMonth||isNaN(Number(this.automaticLock.dayOfMonth)))&&(this.automaticLock.dayOfMonth=this.monthDates[0].value),e!==xr.OLDER_THAN||this.automaticLock.olderThanValue||(this.automaticLock.olderThanValue="1"),this.updateDateForAutomaticLock(),this.emit()}setChangeHour(e){this.automaticLock.changeHour=+e}valueChanged(){this.updateDateForAutomaticLock(),this.emit()}updateDateForAutomaticLock(){if(this.automaticLock)switch(this.automaticLock.type){case xr.WEEKLY:this.setDatesForWeeklyAutomaticLock();break;case xr.MONTHLY:this.setDatesForMonthlyAutomaticLock();break;case xr.OLDER_THAN:this.setDatesForOlderThanAutomaticLock()}}setDatesForWeeklyAutomaticLock(){var e;const t=tn().isoWeekday(this.automaticLock.changeDay),n=tn(this.lockDate).add(1,"week");this.timeString=null===(e=this.timeDropdownValues.filter(e=>e.value===this.automaticLock.changeHourString)[0])||void 0===e?void 0:e.label,t.isBefore(n,"day")&&t.add(1,"week"),this.nextLockScheduledDate=t.format(this.dateFormat),this.date=n.format(this.dateFormat)}setDatesForMonthlyAutomaticLock(){var e;if(this.timeString=null===(e=this.timeDropdownValues.filter(e=>e.value===this.automaticLock.changeHourString)[0])||void 0===e?void 0:e.label,isNaN(Number(this.automaticLock.dayOfMonth)))return;const t=tn().date(Number(this.automaticLock.dayOfMonth));t.isSameOrBefore(tn(),"day")&&t.add(1,"month"),this.nextLockScheduledDate=t.format(this.dateFormat),this.date=t.clone().startOf("month").format(this.dateFormat)}setDatesForOlderThanAutomaticLock(){var e;switch(this.timeString=null===(e=this.timeDropdownValues.filter(e=>e.value===this.automaticLock.changeHourString)[0])||void 0===e?void 0:e.label,this.automaticLock.olderThanPeriod){case Fr.DAYS:this.date=tn().subtract(this.automaticLock.olderThanValue,"days").format(this.dateFormat);break;case Fr.WEEKS:this.date=tn().subtract(this.automaticLock.olderThanValue,"weeks").format(this.dateFormat);break;case Fr.MONTHS:this.date=tn().subtract(this.automaticLock.olderThanValue,"months").format(this.dateFormat)}}emit(){const e=new Gr(this.automaticLock);this.onLockChanged.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(re.a),s.Rb(l.a),s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["automatic-lock"]],inputs:{user:"user",automaticLock:"automaticLock",lockDate:"lockDate",disabled:"disabled"},outputs:{onLockChanged:"onLockChanged"},decls:10,vars:9,consts:[[1,"cl-form-group","cl-col-md-12"],[1,"cl-custom-control","cl-custom-switch","cl-mb-1"],["type","checkbox","name","automaticallyLock","id","automaticallyLock",1,"cl-custom-control-input",3,"disabled","ngModel","ngModelChange","change"],["for","automaticallyLock",1,"cl-custom-control-label","cl-custom-control-label-bg-white"],[1,"cl-text-gray-9","cl-w-lg-75"],["class","cl-form-group cl-col-12 cl-d-flex cl-align-items-center",4,"ngIf"],[1,"cl-form-group","cl-col-12","cl-d-flex","cl-align-items-center"],[1,"cl-mr-2",3,"type","list","value","onChanged"],[4,"ngIf"],["class","cl-d-flex cl-align-items-center",4,"ngIf"],["class","cl-ml-1 cl-text-gray-9",4,"ngIf"],[1,"cl-d-inline-block",3,"type","list","value","onChanged"],[3,"type","list","value","onChanged"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-col-2","cl-px-0","cl-mr-2"],["type","text","inputNumber","",1,"cl-form-control","cl-form-control-sm","cl-text-center",3,"maxNumber","minNumber","decimal","ngModel","inputChange"],[1,"cl-mx-1","cl-d-inline-block",3,"type","list","value","onChanged"],[1,"cl-ml-1","cl-text-gray-9"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"input",2),s.jc("ngModelChange",(function(e){return t.hasLockedData=e}))("change",(function(){return t.automaticLockChange()})),s.Wb(),s.Xb(3,"label",3),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Xb(6,"div",4),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Xc(9,Kr,6,7,"div",5)),2&e&&(s.Cb(2),s.wc("disabled",t.disabled)("ngModel",t.hasLockedData),s.Cb(2),s.bd(" ",s.pc(5,5,"WORKSPACE.LOCK_DATE_FOR_TIME_ENTRIES.UPDATE.TOGGLE")," "),s.Cb(3),s.bd(" ",s.pc(8,7,"WORKSPACE.LOCK_DATE_FOR_TIME_ENTRIES.UPDATE.INFO")," "),s.Cb(2),s.wc("ngIf",t.hasLockedData))},directives:[v.a,v.s,v.v,i.u,ji.a,v.c,jr.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var zr=n("62PR");const Qr=function(e){return{start:e}};let Jr=(()=>{class e{constructor(){this.onPickedDate=new s.n}set lockTimeEntries(e){this.hasLockedDate=!!e,this._lockTimeEntries=tn(e).startOf("day").toISOString()}get lockTimeEntries(){return this._lockTimeEntries}ngOnInit(){this.maxDate=tn(),this.backupValue=tn().startOf("day").toISOString()}pickedDate({start:e}){this.backupValue=e,this.emit(e)}lockChanged(){this.emit(this.hasLockedDate?this.lockTimeEntries||this.backupValue:null)}emit(e){this.isFeatureEnabled&&this.onPickedDate.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["manual-lock"]],inputs:{lockTimeEntries:"lockTimeEntries",automaticLock:"automaticLock",isFeatureEnabled:"isFeatureEnabled"},outputs:{onPickedDate:"onPickedDate"},decls:7,vars:16,consts:[[1,"cl-custom-control","cl-custom-switch","cl-custom-control-inline"],["type","checkbox","id","manualLockSwitch",1,"cl-custom-control-input",3,"disabled","ngModel","change","ngModelChange"],["for","manualLockSwitch",1,"cl-custom-control-label"],["placement","right",1,"cl-d-inline-flex","cl-align-items-center",2,"position","relative","top","-5px",3,"ngbTooltip","disableEdit","maxDate","debounce","mode","textualDate","dateTime","pickedDate"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"input",1),s.jc("change",(function(){return t.lockChanged()}))("ngModelChange",(function(e){return t.hasLockedDate=e})),s.Wb(),s.Xb(2,"label",2),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Xb(5,"single-date-picker2",3),s.jc("pickedDate",(function(e){return t.pickedDate(e)})),s.oc(6,"translate"),s.Wb()),2&e&&(s.Cb(1),s.wc("disabled",t.automaticLock&&!t.hasLockedDate)("ngModel",t.hasLockedDate),s.Cb(2),s.ad(s.pc(4,10,"WORKSPACE.LOCK_DATE_FOR_TIME_ENTRIES.LOCK_BEFORE_DAY")),s.Cb(2),s.wc("ngbTooltip",t.automaticLock?s.pc(6,12,"WORKSPACE.LOCK_DATE_FOR_TIME_ENTRIES.MANUAL_EDIT_TOOLTIP"):"")("disableEdit",!t.hasLockedDate||t.automaticLock)("maxDate",t.maxDate)("debounce",!1)("mode","date_only")("textualDate",!0)("dateTime",s.Bc(14,Qr,t.lockTimeEntries||t.backupValue)))},directives:[v.a,v.s,v.v,zr.a,w.bb],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function el(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Sb(1,"hr",44),s.Xb(2,"div",1),s.Xb(3,"div"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Xb(6,"div",4),s.Xb(7,"div",25),s.Xb(8,"input",45),s.jc("change",(function(){return s.Oc(e),s.nc().modelChanged(!1,"permissions.billable","Admins")}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.onlyAdminsSeeBillableRates=t})),s.Wb(),s.Xb(9,"label",46),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Wb(),s.Xb(12,"div",25),s.Xb(13,"input",47),s.jc("change",(function(){return s.Oc(e),s.nc().modelChanged(!1,"permissions.billable","Everyone")}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.onlyAdminsSeeBillableRates=t})),s.Wb(),s.Xb(14,"label",48),s.Zc(15),s.oc(16,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(4),s.ad(s.pc(5,7,"WORKSPACE.PERMISSIONS.BILLABLE_RATES.INFO")),s.Cb(4),s.wc("value",!0)("ngModel",e.workspace.onlyAdminsSeeBillableRates),s.Cb(2),s.ad(s.pc(11,9,"GLOBAL.ADMINS_LABEL")),s.Cb(3),s.wc("value",!1)("ngModel",e.workspace.onlyAdminsSeeBillableRates),s.Cb(2),s.ad(s.pc(16,11,"GLOBAL.EVERYONE_LABEL"))}}function tl(e,t){1&e&&s.Sb(0,"hr",44)}function nl(e,t){1&e&&(s.Xb(0,"div",49),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",50),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,2,"WORKSPACE.PTO.UPGRADE_MESSAGE.PART1")," "),s.Cb(3),s.ad(s.pc(6,4,"GLOBAL.UPGRADE_BTN")))}function il(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Xb(5,"div",4),s.Xb(6,"div",51,52),s.jc("click",(function(){s.Oc(e);const t=s.Lc(7),n=s.nc();return"FREE"!==n.currentPaymentType.value||n.isSelfHostedCheck?"":n.openPopup(t)})),s.Xb(8,"input",53),s.jc("change",(function(){s.Oc(e);const t=s.nc();return t.modelChanged(),t.addEventOnSettingsChanged("Admins","permissions.status")}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.onlyAdminsCanChangeBillableStatus=t})),s.Wb(),s.Xb(9,"label",54),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Wb(),s.Xb(12,"div",25),s.Xb(13,"input",55),s.jc("change",(function(){s.Oc(e);const t=s.nc();return t.modelChanged(),t.addEventOnSettingsChanged("Everyone","permissions.status")}))("ngModelChange",(function(t){return s.Oc(e),s.nc().workspace.onlyAdminsCanChangeBillableStatus=t})),s.Wb(),s.Xb(14,"label",56),s.Zc(15),s.oc(16,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc(),t=s.Lc(19);s.Hb("disable-area",e.currentPlan&&e.currentPlan.legacy&&!e.isSelfHostedCheck),s.Cb(3),s.ad(s.pc(4,15,"WORKSPACE.PERMISSIONS.BILLABLE_STATUS.INFO")),s.Cb(3),s.Hb("disable-label","FREE"===e.currentPaymentType.value&&!e.isSelfHostedCheck)("pointer","FREE"===e.currentPaymentType.value&&!e.isSelfHostedCheck),s.wc("popoverClass","cl-popover-lg-single-line")("ngbPopover",t),s.Cb(2),s.wc("value",!0)("ngModel",e.workspace.onlyAdminsCanChangeBillableStatus),s.Cb(2),s.bd(" ",s.pc(11,17,"GLOBAL.ADMINS_LABEL")," "),s.Cb(3),s.wc("value",!1)("ngModel",e.workspace.onlyAdminsCanChangeBillableStatus),s.Cb(2),s.ad(s.pc(16,19,"GLOBAL.EVERYONE_LABEL"))}}const sl=function(){return["/upgrade"]};function cl(e,t){if(1&e){const e=s.Yb();s.Xb(0,"span",57),s.Xb(1,"a",58),s.jc("click",(function(){return s.Oc(e),s.nc().sendBasicUpgradePlan()})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Zc(4),s.oc(5,"translate"),s.Wb()}2&e&&(s.Cb(1),s.wc("routerLink",s.Ac(7,sl)),s.Cb(1),s.bd(" ",s.pc(3,3,"GLOBAL.UPGRADE_BTN"),""),s.Cb(2),s.bd(" ",s.pc(5,5,"WORKSPACE.PERMISSIONS.UPGRADE_BTN_PART_2")," "))}const al=function(){return{plan:"basic"}};function ol(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",59),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",60),s.jc("click",(function(){return s.Oc(e),s.nc().addEventOnSettingsChanged("Basic","Upgrade")})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,4,"WORKSPACE.FEATURE.MANY.BASIC"),""),s.Cb(2),s.wc("routerLink",s.Ac(8,sl))("queryParams",s.Ac(9,al)),s.Cb(1),s.ad(s.pc(6,6,"GLOBAL.UPGRADE_BTN")))}function rl(e,t){1&e&&s.Sb(0,"hr",13)}function ll(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",5),s.Xb(3,"input",61),s.jc("ngModelChange",(function(){s.Oc(e);const t=s.nc();return t.workspace.onlyAdminsSeeTeamsDashboard=!t.workspace.onlyAdminsSeeTeamsDashboard,t.modelChanged(!1,"onlyAdminsSeePublicProjectsEntries",!t.workspace.onlyAdminsSeeTeamsDashboard)})),s.Wb(),s.Xb(4,"label",62),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Hb("disable-area",!e.hasFeature(e.Features.WHO_CAN_SEE_TEAMS_DASHBOARD)),s.Cb(3),s.wc("ngModel",!e.workspace.onlyAdminsSeeTeamsDashboard),s.Cb(2),s.bd(" ",s.pc(6,4,"WORKSPACE.PERMISSIONS.ACCESS_TEAM_DASHBOARD.RULE_TITLE")," ")}}function bl(e,t){1&e&&s.Tb(0)}function dl(e,t){if(1&e&&(s.Vb(0),s.Xc(1,bl,1,0,"ng-container",63),s.Sb(2,"hr",13),s.Ub()),2&e){s.nc();const e=s.Lc(115);s.Cb(1),s.wc("ngTemplateOutlet",e)}}function ul(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",59),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",60),s.jc("click",(function(){return s.Oc(e),s.nc().addEventOnSettingsChanged("Basic","Upgrade")})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,4,"WORKSPACE.FEATURE.MANY.BASIC"),""),s.Cb(2),s.wc("routerLink",s.Ac(8,sl))("queryParams",s.Ac(9,al)),s.Cb(1),s.ad(s.pc(6,6,"GLOBAL.UPGRADE_BTN")))}function pl(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",14),s.Xb(1,"input",64),s.jc("change",(function(){s.Oc(e);const n=t.$implicit;return s.nc().modelChanged(!1,n.label,n.protected)}))("ngModelChange",(function(n){return s.Oc(e),t.$implicit.protected=n})),s.Wb(),s.Xb(2,"label",65),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit;s.Cb(1),s.yc("id","hide_",e.label,""),s.yc("name","hide_",e.label,""),s.wc("ngModel",e.protected),s.Cb(1),s.yc("for","hide_",e.label,""),s.Cb(1),s.ad(s.pc(4,5,e.key))}}const hl=function(){return{plan:"standard"}};function ml(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",49),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",60),s.jc("click",(function(){return s.Oc(e),s.nc().addEventOnSettingsChanged("Standard","Upgrade")})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,4,"WORKSPACE.FEATURE.MANY.STANDARD")," "),s.Cb(2),s.wc("routerLink",s.Ac(8,sl))("queryParams",s.Ac(9,hl)),s.Cb(1),s.ad(s.pc(6,6,"GLOBAL.UPGRADE_BTN")))}function gl(e,t){1&e&&(s.Xb(0,"div",2),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"WORKSPACE.PERMISSIONS.EDIT_TIME_AND_EXPENSES.RULE_TITLE")))}function El(e,t){1&e&&(s.Xb(0,"div",2),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"WORKSPACE.PERMISSIONS.EDIT_TIME.RULE_TITLE")))}function fl(e,t){1&e&&(s.Xb(0,"div",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.PERMISSIONS.EDIT_TIME_AND_EXPENSES.INFO_MESSAGE")," "))}function Sl(e,t){1&e&&(s.Xb(0,"div",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.PERMISSIONS.EDIT_TIME.INFO_MESSAGE")," "))}function Cl(e,t){1&e&&s.Tb(0)}function Al(e,t){if(1&e&&(s.Vb(0),s.Xc(1,Cl,1,0,"ng-container",63),s.Ub()),2&e){s.nc();const e=s.Lc(115);s.Cb(1),s.wc("ngTemplateOutlet",e)}}function Ol(e,t){1&e&&(s.Xb(0,"div",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.PERMISSIONS.LOCK_TIME.INFO_MESSAGE")," "))}function vl(e,t){1&e&&(s.Xb(0,"div",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.PERMISSIONS.LOCK_TIME.INFO_MESSAGE_WITH_EXPENSES")," "))}function Tl(e,t){if(1&e){const e=s.Yb();s.Sb(0,"hr",13),s.Xb(1,"div",0),s.Xb(2,"div",66),s.Xb(3,"div",2),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,Ol,3,3,"div",33),s.Xc(7,vl,3,3,"ng-template",null,67,s.Yc),s.Wb(),s.Xb(9,"div",68),s.Xb(10,"div",0),s.Xb(11,"div",69),s.Xb(12,"manual-lock",70),s.jc("onPickedDate",(function(t){return s.Oc(e),s.nc().manualLockChanged(t)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.Lc(8),t=s.nc();s.Cb(1),s.Hb("disable-area",!t.hasFeature(t.Features.WORKSPACE_LOCK_TIMEENTRIES)),s.Cb(3),s.ad(s.pc(5,8,"GLOBAL.LOCK_TIME_TITLE")),s.Cb(2),s.wc("ngIf",!t.workspace.expensesEnabled)("ngIfElse",e),s.Cb(6),s.wc("automaticLock",t.workspace.automaticLock)("isFeatureEnabled",t.hasFeature(t.Features.WORKSPACE_LOCK_TIMEENTRIES))("lockTimeEntries",t.workspace.lockTimeEntries)}}const Il=function(){return{plan:"pro"}};function wl(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",49),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",60),s.jc("click",(function(){return s.Oc(e),s.nc().addEventOnSettingsChanged("Pro","Upgrade")})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,4,"WORKSPACE.FEATURE.MANY.PRO")," "),s.Cb(2),s.wc("routerLink",s.Ac(8,sl))("queryParams",s.Ac(9,Il)),s.Cb(1),s.ad(s.pc(6,6,"GLOBAL.UPGRADE_BTN")))}let Ll=(()=>{class e{constructor(e,t,n,i,s,c){this.workspaceService=e,this.authService=t,this.toaster=n,this.loader=i,this.systemSettingsService=s,this.analyticsService=c,this.PaymentTypeEnum=mo.b,this.adminOnlyPages=[{label:"Projects",value:Pr.PROJECT,protected:!1,key:"GLOBAL.PROJECTS_LABEL"},{label:"Team",value:Pr.TEAM,protected:!1,key:"GLOBAL.TEAM_LABEL"},{label:"Reports",value:Pr.REPORTS,protected:!1,key:"GLOBAL.REPORTS_LABEL"}],this.unsubscribe$=new Fn.a,this.debouncerWorkspace$=new p.a,this.backupWorkspace="",this.Features=is.a,this.isSelfHostedCheck=bo.a.environment.selfHosted}set workspace(e){e&&(this.disableManualMode=e.timeTrackingMode===Mr.a.STOPWATCH_ONLY,this.backupWorkspace=e.toJson(),this._workspace=ss.a.clone(e),this.clientLabel=this.workspaceService.generateClientsLabel(e.projectGroupingLabel))}get workspace(){return this._workspace}ngOnInit(){this.adminOnlyPages=this.adminOnlyPages.map(e=>(e.protected=this.workspace.adminOnlyPages.indexOf(e.value)>-1,e)),this.debouncerWorkspace$.pipe(Object(De.a)(600),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.save(null==e?void 0:e.prop,null==e?void 0:e.value)}),this.systemSettingsService.systemSettings$.pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isSelfHosted=!e.specialFeaturesActivated}),this.currentPaymentType=Object(mo.c)(this.workspace.featureSubscriptionType),this.currentPlan=this.workspace.featureSubscriptionType&&mo.a[this.workspace.featureSubscriptionType.replace("SPECIAL","PLUS")]}sendBasicUpgradePlan(){this.isBasic="Basic",this.addEventOnSettingsChanged("Basic","upgrade.billableStatus"),this.workspaceService.getBasicPlanUpgrade(this.isBasic)}ngOnDestroy(){this.save(),this.unsubscribe$.next(!0),this.unsubscribe$.complete(),this.loader.hide()}get moveUpManualLockFeature(){return this.hasFeature(is.a.WORKSPACE_LOCK_TIMEENTRIES)&&!this.hasFeature(is.a.AUTOMATIC_LOCK)}manualLockChanged(e){this.workspace.lockTimeEntries=e,e||(this.workspace.automaticLock=null),this.modelChanged(!1,"manualLock",e)}disableManualModeChange(){let e=!1;this.disableManualMode?(this.workspace.timeTrackingMode=Mr.a.STOPWATCH_ONLY,e=!0):this.workspace.timeTrackingMode=Mr.a.DEFAULT,this.modelChanged(!1,"forceTimer",e)}openPopup(e){e.open()}modelChanged(e=!1,t,n){e?this.save(t,n):this.debouncerWorkspace$.next({prop:t,value:n})}save(e,t){this.workspace.adminOnlyPages=this.adminOnlyPages.filter(e=>e.protected).map(e=>e.value);const n=this.workspace.toJson();this.backupWorkspace!==n&&(this.workspaceService.updateWorkspaceSettings(this.workspace),this.addEventOnSettingsChanged(t,e))}hasFeature(e){return!!this.isSelfHosted||this.workspace.features.includes(e)}addEventOnSettingsChanged(e,t){if(void 0===e||void 0===t)return;let n,i,s,c=e;"boolean"==typeof e&&(c=e?"ON":"OFF"),"activeBillableHours"==t&&(n="switch",i="Activate billable hours"),"permissions.status"==t&&(c=e,n="select",i="Who can see and change billable status of time entries"),"permissions.billable"==t&&(n="select",c=e,i="Who can see hourly rates and amounts"),"onlyAdminsCreateProject"==t&&(n="switch",i="Regular users can create",s="Projects and clients"),"onlyAdminsCreateTag"==t&&(n="switch",i="Regular users can create",s="Tag"),"onlyAdminsCreateTask"==t&&(n="switch",i="Regular users can create",s="Task"),"Can see"==t&&(c=this.workspace.onlyAdminsSeeAllTimeEntries?this.workspace.onlyAdminsSeePublicProjectsEntries?"Only their own time and expenses":"Only time and expenses on public projects":"All tracked time and expenses",n="switch",i="Regular users can see",s="Regular users can see"),"onlyAdminsSeePublicProjectsEntries"==t&&(n="switch",i="Regular users can see",s="Users can access Team Dashboard"),"onlyAdminsSeeProjectStatus"==t&&(n="select",c=e?"Admin":"Everyone",i="Who can see project status",s=""),"Projects"==t&&(n="switch",i="Hide pages from regular users",s=t),"Team"==t&&(n="switch",i="Hide pages from regular users",s=t),"Reports"==t&&(n="switch",i="Hide pages from regular users",s=t),"canManagerEditUsersTime"==t&&(n="select",c=e?"Admins and team":"Admins",i="Regular users can create",s="Projects and clients"),"Lock time"==t&&(n="switch",i="Lock time",s="Lock time before"),"forceTimer"==t&&(n="switch",i="forceTimer",s="Disable adding and editing time manually"),"Upgrade"==t&&(n="submit",i="",s="Upgrade"),"upgrade.billableStatus"==t&&(n="submit",i="Who can see and change billable status of time entries",s="Upgrade"),"manualLock"==t&&(c?("ON"==c&&this.addEventOnSettingsChanged("ON","amanualLockEvent"),n="switch"):(n="switch",c="OFF"),i="Lock time",s="Lock time before"),"amanualLockEvent"==t&&(n="switch",i="Lock time",s="Lock time before"),"automaticLock"==t&&(c?("ON"==c&&this.addEventOnSettingsChanged("ON","automaticLockEvent"),n="switch"):(n="switch",c="OFF"),i="Lock time",s="Automatically update lock date"),"automaticLockEvent"==t&&(n="switch",i="Lock time",s="Automatically update lock date"),this.analyticsService.addEvent(new Fi.a({event:n,value:c,section:"Workspace settings",section2:"Permissions",section3:i,section4:s}))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(re.a),s.Rb(r.a),s.Rb(Hn.a),s.Rb(bn.a),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["permissions-tab"]],inputs:{user:"user",workspace:"workspace"},decls:134,vars:113,consts:[[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-12"],[1,"cl-h2","cl-mb-0"],[1,"cl-text-gray-9","cl-w-lg-75"],[1,"cl-form-group","col-md-12"],[1,"cl-custom-control","cl-custom-switch"],["type","checkbox","name","activeBillableHours","id","activeBillableHours",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","activeBillableHours",1,"cl-custom-control-label"],["class","cl-form-row",4,"ngIf"],["class","cl-mt-0 cl-w-100",4,"ngIf"],["class","cl-form-group cl-mt-2 cl-mt-lg-0",4,"ngIf"],["class","cl-form-row",3,"disable-area",4,"ngIf"],["popContent",""],[1,"cl-mt-0"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline"],["type","checkbox","id","onlyAdminsCreateProject","name","onlyAdminsCreateProject",1,"cl-custom-control-input",3,"ngModel","change"],["for","onlyAdminsCreateProject",1,"cl-custom-control-label"],["type","checkbox","id","onlyAdminsCreateTag","name","onlyAdminsCreateTag",1,"cl-custom-control-input",3,"ngModel","change"],["for","onlyAdminsCreateTag",1,"cl-custom-control-label"],["type","checkbox","id","onlyAdminsCreateTask","name","onlyAdminsCreateTask",1,"cl-custom-control-input",3,"ngModel","change"],["for","onlyAdminsCreateTask",1,"cl-custom-control-label"],["class","cl-form-group",4,"ngIf"],[3,"isExpansesEnabled","onlyAdminsSeeAllTimeEntries","onlyAdminsSeePublicProjectsEntries","onChanged"],["class","cl-mt-0",4,"ngIf"],[4,"ngIf"],[1,"cl-custom-control","cl-custom-radio","cl-custom-control-inline"],["type","radio","id","projectStatusAdmins","name","projectStatusAdmins",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","projectStatusAdmins",1,"cl-custom-control-label"],["type","radio","id","projectStatusEveryone","name","projectStatusEveryone",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","projectStatusEveryone",1,"cl-custom-control-label"],["class","cl-custom-control cl-custom-checkbox cl-custom-control-inline",4,"ngFor","ngForOf"],["class","cl-h2 cl-mb-0",4,"ngIf","ngIfElse"],["noExpenses",""],["class","cl-text-gray-9 cl-w-lg-75",4,"ngIf","ngIfElse"],["noExpensesDesc",""],["type","radio","id","onlyAdminEditsUserTime","name","onlyAdminEditsUserTime",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","onlyAdminEditsUserTime",1,"cl-custom-control-label"],["type","radio","id","adminAndManagerEditsUserTime","name","adminAndManagerEditsUserTime",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","adminAndManagerEditsUserTime",1,"cl-custom-control-label"],["manualLockTemplate",""],[1,"cl-form-row","cl-relative",3,"disabled","lockDate","user","automaticLock","onLockChanged"],[1,"cl-custom-control","cl-custom-switch","cl-form-group"],["type","checkbox","name","disableManualModeOption","id","disableManualModeOption",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","disableManualModeOption",1,"cl-custom-control-label"],[1,"cl-mt-0","cl-w-100"],["type","radio","id","billableRatesAdmins","name","billableRatesAdmins",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","billableRatesAdmins",1,"cl-custom-control-label"],["type","radio","id","billableRatesEveryone","name","billableRatesEveryone",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","billableRatesEveryone",1,"cl-custom-control-label"],[1,"cl-form-group","cl-mt-2","cl-mt-lg-0"],["routerLink","/upgrade",1,"cl-btn"],["placement","right","container","body","triggers","manual",1,"cl-custom-control","cl-custom-radio","cl-custom-control-inline",3,"popoverClass","ngbPopover","click"],["popup","ngbPopover"],["type","radio","id","onlyAdminsCanChangeBillableStatus","name","onlyAdminsCanChangeBillableStatus",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","onlyAdminsCanChangeBillableStatus",1,"cl-custom-control-label"],["type","radio","id","everyoneCanChangeBillableStatus","name","everyoneCanChangeBillableStatus",1,"cl-custom-control-input",3,"value","ngModel","change","ngModelChange"],["for","everyoneCanChangeBillableStatus",1,"cl-custom-control-label"],[1,"cl-popover-wrapper"],[3,"routerLink","click"],[1,"cl-form-group"],[1,"cl-btn",3,"routerLink","queryParams","click"],["type","checkbox","id","teamDashboardCheckbox",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","teamDashboardCheckbox",1,"cl-custom-control-label"],[4,"ngTemplateOutlet"],["type","checkbox",1,"cl-custom-control-input",3,"id","ngModel","name","change","ngModelChange"],[1,"cl-custom-control-label",3,"for"],[1,"cl-form-group","cl-col-md-12","cl-mb-0"],["infoWithExpenses",""],[1,"cl-form-group","cl-mb-0","cl-col-md-12","cl-d-flex"],[1,"cl-form-group","cl-col-md-12","cl-d-flex","cl-mb-0"],[3,"automaticLock","isFeatureEnabled","lockTimeEntries","onPickedDate"]],template:function(e,t){if(1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"div",3),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xb(8,"div",4),s.Xb(9,"div",5),s.Xb(10,"input",6),s.jc("change",(function(){return t.modelChanged(!1,"activeBillableHours",t.workspace.activeBillableHours)}))("ngModelChange",(function(e){return t.workspace.activeBillableHours=e})),s.Wb(),s.Xb(11,"label",7),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(14,el,17,13,"div",8),s.Xc(15,tl,1,0,"hr",9),s.Xc(16,nl,7,6,"div",10),s.Xc(17,il,17,21,"div",11),s.Xc(18,cl,6,8,"ng-template",null,12,s.Yc),s.Sb(20,"hr",13),s.Xb(21,"div",0),s.Xb(22,"div",1),s.Xb(23,"div",2),s.Zc(24),s.oc(25,"translate"),s.Wb(),s.Xb(26,"div",3),s.Zc(27),s.oc(28,"translate"),s.Wb(),s.Wb(),s.Xb(29,"div",1),s.Xb(30,"div",14),s.Xb(31,"input",15),s.jc("change",(function(){return t.workspace.onlyAdminsCreateProject=!t.workspace.onlyAdminsCreateProject,t.modelChanged(!1,"onlyAdminsCreateProject",!t.workspace.onlyAdminsCreateProject)})),s.Wb(),s.Xb(32,"label",16),s.Zc(33),s.oc(34,"translate"),s.Wb(),s.Wb(),s.Xb(35,"div",14),s.Xb(36,"input",17),s.jc("change",(function(){return t.workspace.onlyAdminsCreateTag=!t.workspace.onlyAdminsCreateTag,t.modelChanged(!1,"onlyAdminsCreateTag",!t.workspace.onlyAdminsCreateTag)})),s.Wb(),s.Xb(37,"label",18),s.Zc(38),s.oc(39,"translate"),s.Wb(),s.Wb(),s.Xb(40,"div",14),s.Xb(41,"input",19),s.jc("change",(function(){return t.workspace.onlyAdminsCreateTask=!t.workspace.onlyAdminsCreateTask,t.modelChanged(!1,"onlyAdminsCreateTask",!t.workspace.onlyAdminsCreateTask)})),s.Wb(),s.Xb(42,"label",20),s.Zc(43),s.oc(44,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(45,"hr",13),s.Xc(46,ol,7,10,"div",21),s.Xb(47,"div",0),s.Xb(48,"div",1),s.Xb(49,"div",2),s.Zc(50),s.oc(51,"translate"),s.Wb(),s.Xb(52,"div",3),s.Zc(53),s.oc(54,"translate"),s.Wb(),s.Wb(),s.Xb(55,"div",1),s.Xb(56,"regular-user-permission",22),s.jc("onChanged",(function(e){return t.workspace.onlyAdminsSeeAllTimeEntries=e.onlyAdminsSeeAllTimeEntries,t.workspace.onlyAdminsSeePublicProjectsEntries=e.onlyAdminsSeePublicProjectsEntries,t.modelChanged(!1,"Can see","Can see")})),s.Wb(),s.Wb(),s.Wb(),s.Xc(57,rl,1,0,"hr",23),s.Xc(58,ll,7,6,"div",11),s.Sb(59,"hr",13),s.Xc(60,dl,3,1,"ng-container",24),s.Xb(61,"div",0),s.Xb(62,"div",1),s.Xb(63,"div",2),s.Zc(64),s.oc(65,"translate"),s.Wb(),s.Xb(66,"div",3),s.Zc(67),s.oc(68,"translate"),s.Wb(),s.Wb(),s.Xb(69,"div",1),s.Xb(70,"div",25),s.Xb(71,"input",26),s.jc("change",(function(){return t.modelChanged(!1,"onlyAdminsSeeProjectStatus",t.workspace.onlyAdminsSeeProjectStatus)}))("ngModelChange",(function(e){return t.workspace.onlyAdminsSeeProjectStatus=e})),s.Wb(),s.Xb(72,"label",27),s.Zc(73),s.oc(74,"translate"),s.Wb(),s.Wb(),s.Xb(75,"div",25),s.Xb(76,"input",28),s.jc("change",(function(){return t.modelChanged(!1,"onlyAdminsSeeProjectStatus",t.workspace.onlyAdminsSeeProjectStatus)}))("ngModelChange",(function(e){return t.workspace.onlyAdminsSeeProjectStatus=e})),s.Wb(),s.Xb(77,"label",29),s.Zc(78),s.oc(79,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(80,"hr",13),s.Xc(81,ul,7,10,"div",21),s.Xb(82,"div",0),s.Xb(83,"div",1),s.Xb(84,"div",2),s.Zc(85),s.oc(86,"translate"),s.Wb(),s.Xb(87,"div",3),s.Zc(88),s.oc(89,"translate"),s.Wb(),s.Wb(),s.Xb(90,"div",1),s.Xc(91,pl,5,7,"div",30),s.Wb(),s.Wb(),s.Sb(92,"hr",13),s.Xc(93,ml,7,10,"div",10),s.Xb(94,"div",0),s.Xb(95,"div",1),s.Xc(96,gl,3,3,"div",31),s.Xc(97,El,3,3,"ng-template",null,32,s.Yc),s.Xc(99,fl,3,3,"div",33),s.Xc(100,Sl,3,3,"ng-template",null,34,s.Yc),s.Wb(),s.Xb(102,"div",1),s.Xb(103,"div",25),s.Xb(104,"input",35),s.jc("change",(function(){return t.modelChanged(!1,"canManagerEditUsersTime",t.workspace.canManagerEditUsersTime)}))("ngModelChange",(function(e){return t.workspace.canManagerEditUsersTime=e})),s.Wb(),s.Xb(105,"label",36),s.Zc(106),s.oc(107,"translate"),s.Wb(),s.Wb(),s.Xb(108,"div",25),s.Xb(109,"input",37),s.jc("change",(function(){return t.modelChanged(!1,"canManagerEditUsersTime",t.workspace.canManagerEditUsersTime)}))("ngModelChange",(function(e){return t.workspace.canManagerEditUsersTime=e})),s.Wb(),s.Xb(110,"label",38),s.Zc(111),s.oc(112,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(113,Al,2,1,"ng-container",24),s.Xc(114,Tl,13,10,"ng-template",null,39,s.Yc),s.Xb(116,"div"),s.Xb(117,"automatic-lock",40),s.jc("onLockChanged",(function(e){return t.workspace.automaticLock=e,t.modelChanged(!1,"automaticLock",null==t.workspace||null==t.workspace.automaticLock?null:t.workspace.automaticLock.type)})),s.Wb(),s.Wb(),s.Sb(118,"hr",13),s.Xc(119,wl,7,10,"div",10),s.Xb(120,"div"),s.Xb(121,"div",0),s.Xb(122,"div",1),s.Xb(123,"div",2),s.Zc(124),s.oc(125,"translate"),s.Wb(),s.Xb(126,"div",3),s.Zc(127),s.oc(128,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(129,"div",41),s.Xb(130,"input",42),s.jc("change",(function(){return t.disableManualModeChange()}))("ngModelChange",(function(e){return t.disableManualMode=e})),s.Wb(),s.Xb(131,"label",43),s.Zc(132),s.oc(133,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.Lc(98),n=s.Lc(101);s.Cb(3),s.ad(s.pc(4,71,"WORKSPACE.PERMISSIONS.BILLABLE_HOURS.TITLE")),s.Cb(3),s.bd(" ",s.pc(7,73,"WORKSPACE.PERMISSIONS.BILLABLE_HOURS.INFO")," "),s.Cb(4),s.wc("ngModel",t.workspace.activeBillableHours),s.Cb(2),s.bd(" ",s.pc(13,75,"WORKSPACE.PERMISSIONS.BILLABLE_HOURS.LABEL")," "),s.Cb(2),s.wc("ngIf",t.workspace.activeBillableHours),s.Cb(1),s.wc("ngIf",t.workspace.activeBillableHours),s.Cb(1),s.wc("ngIf",t.currentPlan&&t.currentPlan.legacy&&t.workspace.activeBillableHours&&!t.isSelfHostedCheck),s.Cb(1),s.wc("ngIf",t.workspace.activeBillableHours),s.Cb(7),s.bd(" ",s.pc(25,77,"WORKSPACE.PERMISSIONS.CAN_CREATE.RULE_TITLE")," "),s.Cb(3),s.bd(" ",s.pc(28,79,"WORKSPACE.PERMISSIONS.CAN_CREATE.INFO")," "),s.Cb(4),s.wc("ngModel",!t.workspace.onlyAdminsCreateProject),s.Cb(2),s.cd("",s.pc(34,81,"WORKSPACE.PERMISSIONS.CAN_CREATE.CHECKBOX.PROJECTS")," ",t.clientLabel,""),s.Cb(3),s.wc("ngModel",!t.workspace.onlyAdminsCreateTag),s.Cb(2),s.ad(s.pc(39,83,"GLOBAL.TAGS_LABEL")),s.Cb(3),s.wc("ngModel",!t.workspace.onlyAdminsCreateTask),s.Cb(2),s.ad(s.pc(44,85,"GLOBAL.TASKS_LABEL")),s.Cb(3),s.wc("ngIf",!t.hasFeature(t.Features.HIDE_PAGES)&&!t.hasFeature(t.Features.WHO_CAN_SEE_ALL_TIME_ENTRIES)),s.Cb(1),s.Hb("disable-area",!t.hasFeature(t.Features.WHO_CAN_SEE_ALL_TIME_ENTRIES)),s.Cb(3),s.ad(s.pc(51,87,"WORKSPACE.PERMISSIONS.CAN_SEE.RULE_TITLE")),s.Cb(3),s.bd("",s.pc(54,89,t.workspace.expensesEnabled?"WORKSPACE.PERMISSIONS.CAN_SEE.INFO_MESSAGE_EXPENSES":"WORKSPACE.PERMISSIONS.CAN_SEE.INFO_MESSAGE")," "),s.Cb(3),s.wc("isExpansesEnabled",t.workspace.expensesEnabled)("onlyAdminsSeeAllTimeEntries",t.workspace.onlyAdminsSeeAllTimeEntries)("onlyAdminsSeePublicProjectsEntries",t.workspace.onlyAdminsSeePublicProjectsEntries),s.Cb(1),s.wc("ngIf",!t.workspace.onlyAdminsSeeAllTimeEntries||!t.workspace.onlyAdminsSeePublicProjectsEntries),s.Cb(1),s.wc("ngIf",!t.workspace.onlyAdminsSeeAllTimeEntries||!t.workspace.onlyAdminsSeePublicProjectsEntries),s.Cb(2),s.wc("ngIf",t.moveUpManualLockFeature),s.Cb(1),s.Hb("disable-area",!t.hasFeature(t.Features.WHO_CAN_SEE_PROJECT_STATUS)),s.Cb(3),s.ad(s.pc(65,91,"WORKSPACE.PERMISSIONS.CAN_SEE_PROJECT_STATUS.RULE_TITLE")),s.Cb(3),s.bd("",s.pc(68,93,"WORKSPACE.PERMISSIONS.CAN_SEE_PROJECT_STATUS.INFO_MESSAGE")," "),s.Cb(4),s.wc("value",!0)("ngModel",t.workspace.onlyAdminsSeeProjectStatus),s.Cb(2),s.ad(s.pc(74,95,"GLOBAL.ADMINS_LABEL")),s.Cb(3),s.wc("value",!1)("ngModel",t.workspace.onlyAdminsSeeProjectStatus),s.Cb(2),s.ad(s.pc(79,97,"GLOBAL.EVERYONE_LABEL")),s.Cb(3),s.wc("ngIf",!t.hasFeature(t.Features.HIDE_PAGES)&&t.hasFeature(t.Features.WHO_CAN_SEE_ALL_TIME_ENTRIES)),s.Cb(1),s.Hb("disable-area",!t.hasFeature(t.Features.HIDE_PAGES)),s.Cb(3),s.ad(s.pc(86,99,"WORKSPACE.PERMISSIONS.HIDE_PAGES.RULE_TITLE")),s.Cb(3),s.bd(" ",s.pc(89,101,"WORKSPACE.PERMISSIONS.HIDE_PAGES.INFO_MESSAGE")," "),s.Cb(3),s.wc("ngForOf",t.adminOnlyPages),s.Cb(2),s.wc("ngIf",!t.hasFeature(t.Features.AUTOMATIC_LOCK)),s.Cb(1),s.Hb("disable-area",!t.hasFeature(t.Features.MANAGER_ROLE)),s.Cb(2),s.wc("ngIf",t.hasFeature(t.Features.EXPENSES)&&t.workspace.expensesEnabled)("ngIfElse",e),s.Cb(3),s.wc("ngIf",t.hasFeature(t.Features.EXPENSES)&&t.workspace.expensesEnabled)("ngIfElse",n),s.Cb(5),s.wc("value",!1)("ngModel",t.workspace.canManagerEditUsersTime),s.Cb(2),s.ad(s.pc(107,103,"GLOBAL.ADMINS_LABEL")),s.Cb(3),s.wc("value",!0)("ngModel",t.workspace.canManagerEditUsersTime),s.Cb(2),s.ad(s.pc(112,105,"WORKSPACE.PERMISSIONS.ROLES.ADMINS_AND_MANAGERS")),s.Cb(2),s.wc("ngIf",!t.moveUpManualLockFeature),s.Cb(4),s.Hb("disable-area",!t.hasFeature(t.Features.AUTOMATIC_LOCK)),s.wc("disabled",!t.hasFeature(t.Features.AUTOMATIC_LOCK))("lockDate",t.workspace.lockTimeEntries)("user",t.user)("automaticLock",t.workspace.automaticLock),s.Cb(2),s.wc("ngIf",!t.hasFeature(t.Features.DISABLE_MANUAL_MODE)),s.Cb(1),s.Hb("disable-area",!t.hasFeature(t.Features.DISABLE_MANUAL_MODE)),s.Cb(4),s.ad(s.pc(125,107,"GLOBAL.FORCE_TIMER_TITLE")),s.Cb(3),s.bd(" ",s.pc(128,109,"WORKSPACE.PERMISSIONS.FORCE_TIMER.INFO_MESSAGE")," "),s.Cb(3),s.wc("ngModel",t.disableManualMode),s.Cb(2),s.bd(" ",s.pc(133,111,"WORKSPACE.PERMISSIONS.FORCE_TIMER.TOGGLE")," ")}},directives:[v.a,v.s,v.v,i.u,Ur,v.A,v.c,i.t,qr,To.a,k.g,w.M,i.B,Jr],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var Rl=function(e){return e.PROJECT="PROJECT",e.TASK="TASK",e}({}),yl=function(e){return e.WORKSPACE_ADMIN="WORKSPACE_ADMIN",e.PROJECT_MANAGER="PROJECT_MANAGER",e.TEAM_MEMBERS="TEAM_MEMBERS",e.PROJECT_MEMBERS="PROJECT_MEMBERS",e.TASK_MEMBERS="TASK_MEMBERS",e}({});const _l=[new Un.a(Rl.PROJECT,"GLOBAL.PROJECT_LABEL"),new Un.a(Rl.TASK,"GLOBAL.TASK_LABEL")],kl=[new Un.a(50,"50%"),new Un.a(75,"75%"),new Un.a(100,"100%")],Wl=[new Un.a(yl.TEAM_MEMBERS,"WORKSPACE.ALERT.DROPDOWN_OPTIONS.PROJECT_MEMBERS_LABEL"),new Un.a(yl.PROJECT_MANAGER,"WORKSPACE.ALERT.DROPDOWN_OPTIONS.PROJECT_MANAGER_LABEL"),new Un.a(yl.WORKSPACE_ADMIN,"WORKSPACE.ALERT.DROPDOWN_OPTIONS.WORKSPACE_ADMIN_LABEL")],Xl=[new Un.a(yl.TEAM_MEMBERS,"WORKSPACE.ALERT.DROPDOWN_OPTIONS.ASSIGNEES_LABEL"),new Un.a(yl.PROJECT_MANAGER,"WORKSPACE.ALERT.DROPDOWN_OPTIONS.PROJECT_MANAGER_LABEL"),new Un.a(yl.WORKSPACE_ADMIN,"WORKSPACE.ALERT.DROPDOWN_OPTIONS.WORKSPACE_ADMIN_LABEL")];let Nl=(()=>{class e{constructor(e){this.alertService=e,this.createdAlert=new s.n,this.alertTypes=_l,this.percentages=kl,this.alertGroups=Wl,this.newAlert=new vt,this.inProgress=!1,this.unsubscribe$=new p.a}ngOnInit(){this.resetAlert()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}resetAlert(){this.newAlert=new vt({id:null,workspaceId:null,alertType:Rl.PROJECT,percentage:50,alertPerson:yl.WORKSPACE_ADMIN})}addAlert(){this.inProgress=!0,this.alertService.createAlert(this.newAlert,this.workspaceId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.resetAlert(),this.createdAlert.emit(e),this.inProgress=!1},()=>this.inProgress=!1)}changeAlertGroups(e){this.alertGroups=e===Rl.PROJECT?Wl:Xl}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Tt))},e.\u0275cmp=s.Lb({type:e,selectors:[["new-alert"]],inputs:{workspaceId:"workspaceId"},outputs:{createdAlert:"createdAlert"},decls:23,vars:22,consts:[[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-row"],[1,"cl-col-12"],[1,"cl-form-group","cl-mb-0"],[1,"cl-form-row","cl-align-items-center","cl-justify-content-lg-end"],[1,"cl-col-auto","cl-mb-2","cl-mb-lg-0"],[1,"cl-mx-1","cl-d-inline-block",3,"type","list","value","onChanged"],[1,"cl-col-auto"],["type","submit","name","addAlert",1,"cl-btn","cl-btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"div",5),s.Xb(6,"div"),s.Xb(7,"span"),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Xb(10,"dropdown-items",6),s.jc("onChanged",(function(e){return t.newAlert.alertType=e,t.changeAlertGroups(e)})),s.Wb(),s.Xb(11,"span"),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xb(14,"dropdown-items",6),s.jc("onChanged",(function(e){return t.newAlert.percentage=e})),s.Wb(),s.Xb(15,"span"),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Xb(18,"dropdown-items",6),s.jc("onChanged",(function(e){return t.newAlert.alertPerson=e})),s.Wb(),s.Wb(),s.Wb(),s.Xb(19,"div",7),s.Xb(20,"button",8),s.jc("click",(function(){return t.addAlert()})),s.Zc(21),s.oc(22,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(8),s.ad(s.pc(9,14,"GLOBAL.PART_OF_SENTENCE")),s.Cb(2),s.wc("type","TEXT")("list",t.alertTypes)("value",t.newAlert.alertType),s.Cb(2),s.ad(s.pc(13,16,"WORKSPACE.ALERT.UPDATE_SENTENCE.REACHES")),s.Cb(2),s.wc("type","TEXT")("list",t.percentages)("value",t.newAlert.percentage),s.Cb(2),s.ad(s.pc(17,18,"WORKSPACE.ALERT.UPDATE_SENTENCE.ESTIMATE")),s.Cb(2),s.wc("type","TEXT")("list",t.alertGroups)("value",t.newAlert.alertPerson),s.Cb(2),s.wc("disabled",t.inProgress),s.Cb(1),s.ad(s.pc(22,20,"GLOBAL.ADD_LABEL")))},directives:[ji.a],pipes:[g.e],encapsulation:2}),e})();function Dl(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",8),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().deleteAlert(n)}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",9),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,5,"WORKSPACE.ALERT.DELETE.TITLE"))("btnText",s.pc(2,7,"GLOBAL.DELETE_BTN"))("isDanger",!0)("inProgress",e.inProgress),s.Cb(4),s.ad(s.pc(5,9,"WORKSPACE.ALERT.DELETE.CONFIRM"))}}let Pl=(()=>{class e{constructor(e,t){this.alertService=e,this.modalService=t,this.deletedAlert=new s.n,this.alertTypes=_l,this.percentages=kl,this.unsubscribe$=new p.a,this.alerts=[],this.inProgress=!1}set alert(e){this._alert=e,this.alertGroups=this.alert.alertType===Rl.PROJECT?Wl:Xl}get alert(){return this._alert}ngOnInit(){}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}updateAlert(){this.alertService.updateAlert(this.alert,this.workspaceId)}deleteAlert(e){this.inProgress=!0,this.alertService.deleteAlert(this.alert.id,this.workspaceId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.deletedAlert.emit(t.id),this.inProgress=!1,e.close()},()=>this.inProgress=!1)}openDeleteModal(e){this.modalService.open(e,{centered:!0})}changeAlertGroups(e){this.alertGroups=e===Rl.PROJECT?Wl:Xl}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Tt),s.Rb(w.q))},e.\u0275cmp=s.Lb({type:e,selectors:[["alert-row"]],inputs:{workspaceId:"workspaceId",alert:"alert"},outputs:{deletedAlert:"deletedAlert"},decls:20,vars:18,consts:[[1,"cl-component-row","cl-px-0"],[1,"cl-d-flex","cl-flex-column","cl-flex-lg-row","cl-w-100","cl-align-items-start","cl-align-items-lg-center"],[1,"cl-px-2","cl-px-lg-3","cl-py-3"],[1,"cl-mx-1","cl-d-inline-block",3,"type","list","value","onChanged"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end","cl-template-separator-mob","cl-min-height-40","cl-w-100","cl-w-lg-auto","cl-ml-auto",3,"click"],[1,"cl-component-divided-left"],["src","assets/images/ui-icons/close.svg"],["deleteModal",""],[3,"title","btnText","isDanger","inProgress","confirmed","close"],[1,"cl-mb-0"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"span"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"dropdown-items",3),s.jc("onChanged",(function(e){return t.alert.alertType=e,t.updateAlert(),t.changeAlertGroups(e)})),s.Wb(),s.Xb(7,"span"),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Xb(10,"dropdown-items",3),s.jc("onChanged",(function(e){return t.alert.percentage=e,t.updateAlert()})),s.Wb(),s.Xb(11,"span"),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xb(14,"dropdown-items",3),s.jc("onChanged",(function(e){return t.alert.alertPerson=e,t.updateAlert()})),s.Wb(),s.Wb(),s.Xb(15,"div",4),s.jc("click",(function(){s.Oc(e);const n=s.Lc(19);return t.openDeleteModal(n)})),s.Xb(16,"a",5),s.Sb(17,"img",6),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(18,Dl,6,11,"ng-template",null,7,s.Yc)}2&e&&(s.Cb(4),s.ad(s.pc(5,12,"GLOBAL.PART_OF_SENTENCE")),s.Cb(2),s.wc("type","TEXT")("list",t.alertTypes)("value",t.alert.alertType),s.Cb(2),s.ad(s.pc(9,14,"WORKSPACE.ALERT.UPDATE_SENTENCE.REACHES")),s.Cb(2),s.wc("type","TEXT")("list",t.percentages)("value",t.alert.percentage),s.Cb(2),s.ad(s.pc(13,16,"WORKSPACE.ALERT.UPDATE_SENTENCE.ESTIMATE")),s.Cb(2),s.wc("type","TEXT")("list",t.alertGroups)("value",t.alert.alertPerson))},directives:[ji.a,Si.a],pipes:[g.e],encapsulation:2}),e})();const Ml=function(){return["/upgrade"]},Bl=function(){return{plan:"pro"}};function Ul(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",8),s.Xb(1,"div",9),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",10),s.jc("click",(function(){return s.Oc(e),s.nc().addEventOnSettingsChanged("Pro","Upgrade")})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,4,"WORKSPACE.FEATURE.TYPES.PRO")," "),s.Cb(2),s.wc("routerLink",s.Ac(8,Ml))("queryParams",s.Ac(9,Bl)),s.Cb(1),s.ad(s.pc(6,6,"GLOBAL.UPGRADE_BTN")))}function Gl(e,t){1&e&&s.Sb(0,"div",11)}function xl(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"alert-row",12),s.jc("deletedAlert",(function(){s.Oc(e);const n=t.index;return s.nc().deleteAlert(n)})),s.Wb(),s.Ub()}if(2&e){const e=t.$implicit,n=s.nc();s.Cb(1),s.wc("workspaceId",n.workspaceId)("alert",e)}}let Fl=(()=>{class e{constructor(e,t){this.alertService=e,this.analyticsService=t,this.unsubscribe$=new p.a,this.alerts=[]}set hasAlertsFeature(e){this._hasAlertsFeature=e,e&&this.isInitialized&&this.initialize()}get hasAlertsFeature(){return this._hasAlertsFeature}ngOnInit(){this.alertService.alerts.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>this.alerts=e),this.initialize()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initialize(){this.workspaceId&&this.hasAlertsFeature&&(this.isInitialized=!0,this.alertService.getAllAlertsForWorkspace(this.workspaceId))}deleteAlert(e){this.alerts.splice(e,1)}addNewAlert(e){this.addEventOnSettingsChanged("addAlert","addAlert"),this.alerts.unshift(e)}addEventOnSettingsChanged(e,t){let n,i;"Upgrade"==t&&(i="Upgrade"),"addAlert"==t&&(n="Add alert"),this.analyticsService.addEvent(new Fi.a({event:"submit",value:e,section:"Workspace settings",section2:"Alerts",section3:n,section4:i}))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Tt),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["alerts"]],inputs:{workspaceId:"workspaceId",hasAlertsFeature:"hasAlertsFeature"},decls:10,vars:7,consts:[["class","cl-form-group",4,"ngIf"],[1,"cl-relative"],["class","cl-blocker",4,"ngIf"],[3,"workspaceId","createdAlert"],[1,"cl-card","cl-border-bottom","cl-mb-1","cl-mb-lg-2"],[1,"cl-card-header","cl-px-2","cl-px-lg-3"],[1,"cl-h6","cl-mb-0"],[4,"ngFor","ngForOf"],[1,"cl-form-group"],[1,"cl-alert","cl-alert-info","cl-mb-0"],[1,"cl-btn",3,"routerLink","queryParams","click"],[1,"cl-blocker"],[3,"workspaceId","alert","deletedAlert"]],template:function(e,t){1&e&&(s.Xc(0,Ul,7,10,"div",0),s.Xb(1,"div",1),s.Xc(2,Gl,1,0,"div",2),s.Xb(3,"new-alert",3),s.jc("createdAlert",(function(e){return t.addNewAlert(e)})),s.Wb(),s.Xb(4,"div",4),s.Xb(5,"div",5),s.Xb(6,"span",6),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Xc(9,xl,2,2,"ng-container",7),s.Wb(),s.Wb()),2&e&&(s.wc("ngIf",!1===t.hasAlertsFeature),s.Cb(2),s.wc("ngIf",!t.hasAlertsFeature),s.Cb(1),s.wc("workspaceId",t.workspaceId),s.Cb(4),s.ad(s.pc(8,5,"GLOBAL.ALERTS_TITLE")),s.Cb(2),s.wc("ngForOf",t.alerts))},directives:[i.u,Nl,i.t,k.g,Pl],pipes:[g.e],encapsulation:2}),e})();function jl(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"th",2),s.Xb(2,"a",3),s.jc("click",(function(){return s.Oc(e),s.nc().changeSort("name")})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Xb(5,"th"),s.Xb(6,"div",4),s.Xb(7,"a",3),s.jc("click",(function(){return s.Oc(e),s.nc().changeSort("email")})),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(10,"th"),s.Xb(11,"div",4),s.Xb(12,"a",3),s.jc("click",(function(){return s.Oc(e),s.nc().changeSort("_id")})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(15,"th"),s.Xb(16,"div",4),s.Xb(17,"div",5),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(20,"th",6),s.Xb(21,"div",4),s.Xb(22,"div",5),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc();s.Cb(2),s.Hb("cl-up","name"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","name"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING),s.Cb(1),s.ad(s.pc(4,17,"GLOBAL.NAME_LABEL")),s.Cb(4),s.Hb("cl-up","email"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","email"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING),s.Cb(1),s.ad(s.pc(9,19,"GLOBAL.EMAIL_LABEL")),s.Cb(4),s.Hb("cl-up","_id"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","_id"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING),s.Cb(1),s.ad(s.pc(14,21,"WORKSPACE.ACCOUNT.USER.REGISTRATION")),s.Cb(5),s.ad(s.pc(19,23,"GLOBAL.API_KEY_TITLE")),s.Cb(5),s.ad(s.pc(24,25,"GLOBAL.LOGIN_LABEL"))}}function Zl(e,t){if(1&e){const e=s.Yb();s.Xb(0,"th",7),s.Xb(1,"div",8),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"div",9),s.Xb(5,"a",10),s.jc("click",(function(){return s.Oc(e),s.nc().expandAll()})),s.Xb(6,"span",11),s.Sb(7,"img",12),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.bd(" ",s.pc(3,2,"GLOBAL.NAME_LABEL")," "),s.Cb(5),s.wc("src",e.isExpandAll?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",s.Qc)}}let Vl=(()=>{class e{constructor(e){this.cd=e,this.onChangeSortOrder=new s.n,this.onChangeSortColumn=new s.n,this.onExpandAll=new s.n,this.isExpandAll=!1,this.SortOrder=bi.a,this.unsubscribe$=new p.a}ngOnInit(){}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}expandAll(){this.isExpandAll=!this.isExpandAll,this.onExpandAll.emit(this.isExpandAll)}changeSort(e){e!==this.sortColumn?this.onChangeSortColumn.emit(e):this.onChangeSortOrder.emit()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["account-header"],["","account-header",""]],inputs:{isDesktop:"isDesktop",sortColumn:"sortColumn",sortOrder:"sortOrder"},outputs:{onChangeSortOrder:"onChangeSortOrder",onChangeSortColumn:"onChangeSortColumn",onExpandAll:"onExpandAll"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["mobileTemplate",""],[1,"cl-pl-lg-3"],[1,"cl-text-gray-6","cl-sort-by",3,"click"],[1,"cl-ml-lg-custom-n2"],[1,"cl-h5","cl-mb-0","cl-text-gray-6-dark-mode"],["colspan","2"],["colspan","6",1,"cl-pl-lg-custom-3"],[1,"cl-h5","cl-mb-0","cl-d-flex","cl-justify-content-between","cl-align-items-center"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-ml-auto",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"]],template:function(e,t){if(1&e&&(s.Xc(0,jl,25,27,"ng-container",0),s.Xc(1,Zl,8,4,"ng-template",null,1,s.Yc)),2&e){const e=s.Lc(2);s.wc("ngIf",t.isDesktop)("ngIfElse",e)}},directives:[i.u],pipes:[g.e],encapsulation:2,changeDetection:0}),e})(),Yl=(()=>{class e{constructor(e){this.authService=e,this.format="DD-MM-YYYY";try{this.format=this.authService.getUser().settings.dateFormat}catch(t){}}transform(e){return ke(1e3*parseInt(e.substring(0,8),16)).format(this.format)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(re.a))},e.\u0275pipe=s.Qb({name:"dateFromObjectId",type:e,pure:!0}),e})();function Hl(e,t){1&e&&s.Tb(0)}function $l(e,t){if(1&e){const e=s.Yb();s.Xb(0,"input",10,11),s.jc("change",(function(){return s.Oc(e),s.nc().onNameChange()}))("keyup.enter",(function(){return s.Oc(e),s.Lc(1).blur()}))("ngModelChange",(function(t){return s.Oc(e),s.nc().user.name=t})),s.Wb()}if(2&e){const e=s.nc();s.wc("ngModel",e.user.name)}}function Kl(e,t){if(1&e&&(s.Xb(0,"div",12),s.Xb(1,"span",13),s.Zc(2),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.xc("title",e.user.email),s.Cb(1),s.ad(e.user.email)}}function ql(e,t){if(1&e&&(s.Xb(0,"div",14),s.Zc(1),s.oc(2,"dateFromObjectId"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.pc(2,1,e.user.id)," ")}}function zl(e,t){if(1&e&&(s.Xb(0,"span",17),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",e.user.apiKey.active?e.user.apiKey.apiKey:s.pc(2,1,"WORKSPACE.ACCOUNT.USER.API_KEY.DEACTIVATED")," ")}}function Ql(e,t){1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.ACCOUNT.USER.API_KEY.NOT_GENERATED")," "))}function Jl(e,t){if(1&e&&(s.Xb(0,"div",14),s.Xc(1,zl,3,3,"span",15),s.Xc(2,Ql,3,3,"ng-template",null,16,s.Yc),s.Wb()),2&e){const e=s.Lc(3),t=s.nc();s.Cb(1),s.wc("ngIf",t.user.apiKey.id)("ngIfElse",e)}}function eb(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",21),s.jc("click",(function(){return s.Oc(e),s.nc(2).loginAs()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.ad(s.pc(2,1,"WORKSPACE.ACCOUNT.USER.LOGIN_AS")))}function tb(e,t){1&e&&(s.Xb(0,"span",22),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.ACCOUNT.USER.ACTIVE")," "))}function nb(e,t){if(1&e&&(s.Xb(0,"div",18),s.Xc(1,eb,3,3,"a",19),s.Xc(2,tb,3,3,"ng-template",null,20,s.Yc),s.Wb()),2&e){const e=s.Lc(3),t=s.nc();s.Cb(1),s.wc("ngIf",t.ownerId!==t.user.id)("ngIfElse",e)}}function ib(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",33),s.jc("click",(function(){return s.Oc(e),s.nc(3).deactivateApiKey()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc(3);s.wc("disabled",!e.user.apiKey.active),s.Cb(1),s.bd(" ",s.pc(2,2,"WORKSPACE.ACCOUNT.USER.API_KEY.DEACTIVATE")," ")}}function sb(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Sb(1,"div",34),s.Xb(2,"button",35),s.jc("click",(function(){s.Oc(e);const t=s.nc(3),n=s.Lc(16);return t.openModal(n)})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Ub()}2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"WORKSPACE.ACCOUNT.USER.REMOVE_ACCOUNT.TITLE")," "))}function cb(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",28),s.Xb(1,"div",29),s.Xb(2,"button",30),s.jc("click",(function(){return s.Oc(e),s.nc(2).resetPassword()})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xc(5,ib,3,4,"button",31),s.Xc(6,sb,5,3,"ng-container",32),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(3),s.bd(" ",s.pc(4,3,"GLOBAL.RESET_PASSWORD_LABEL")," "),s.Cb(2),s.wc("ngIf",e.user.apiKey.id),s.Cb(1),s.wc("ngIf",e.ownerId!==e.user.id)}}function ab(e,t){1&e&&(s.Xb(0,"div",23),s.Xb(1,"div",24),s.Sb(2,"img",25),s.Wb(),s.Xc(3,cb,7,5,"div",26),s.Sb(4,"span",27),s.Wb())}function ob(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",36),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().removeConfirmed(n)}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,5,"WORKSPACE.ACCOUNT.USER.REMOVE_ACCOUNT.TITLE"))("btnText",s.pc(2,7,"GLOBAL.REMOVE_LABEL"))("isDanger",!0)("inProgress",e.inProgress),s.Cb(4),s.ad(s.pc(5,9,"GLOBAL.REMOVE_INFO_MESSAGE"))}}const rb=function(e){return{labels:e}},lb=function(e,t,n,i,s,c){return[e,t,n,i,s,c]};let bb=(()=>{class e{constructor(e,t,n,i,c){this.modalService=e,this.authService=t,this.accountsUsersService=n,this.cd=i,this.translateService=c,this.onDeleted=new s.n,this.unsubscribe$=new p.a}ngOnInit(){}ngAfterViewInit(){this.cd.detectChanges()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}resetPassword(){const e=this.translateService.instant("WORKSPACE.ACCOUNTS_USER_SERVICE.PASSWORD_RESET_LINK_SENT",{email:this.user.email});this.accountsUsersService.resetPassword(this.user.email,e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{})}deactivateApiKey(){this.accountsUsersService.deactivateApiKey(this.user.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.user.apiKey=e,this.cd.detectChanges()})}openModal(e){this.modalService.open(e,{centered:!0})}removeConfirmed(e){this.inProgress||(this.inProgress=!0,this.accountsUsersService.removeUserAccount(this.user.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.onDeleted.emit(),this.inProgress=!1,e.close()},()=>{this.inProgress=!1,this.cd.detectChanges()}))}onNameChange(){this.accountsUsersService.renameUser(this.user.name,this.user.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{})}loginAs(){this.loginInProgress||(this.loginInProgress=!0,this.authService.loginAs(this.user.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>this.loginInProgress=!1,()=>this.loginInProgress=!1))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q),s.Rb(re.a),s.Rb(H),s.Rb(s.h),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["account-row"],["","account-row",""]],inputs:{isDesktop:"isDesktop",user:"user",labels:"labels",ownerId:"ownerId",expandAll:"expandAll"},outputs:{onDeleted:"onDeleted"},decls:17,vars:14,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cl-d-none",3,"isDesktop","templates","isExpanded"],["responsive",""],["col1",""],["col2",""],["col3",""],["col4",""],["col5",""],["col6",""],["removeModal",""],["type","text","autocomplete","off",1,"cl-form-control","cl-input-description","cl-py-2","cl-ml-n2","tr-reset-min-h",3,"ngModel","change","keyup.enter","ngModelChange"],["name",""],[1,"cl-component-divided-left","cl-cursor-default","cl-d-flex"],[1,"cl-cut-text",3,"title"],[1,"cl-component-divided-left","cl-cursor-default"],["class","cl-text-break",4,"ngIf","ngIfElse"],["notGenerated",""],[1,"cl-text-break"],[1,"cl-component-divided-left"],[3,"click",4,"ngIf","ngIfElse"],["activeTemplate",""],[3,"click"],[1,"cl-cursor-default"],["dropdownKey","",1,"cl-dropdown","cl-d-flex","cl-justify-content-lg-custom-end"],["dropdownKeyButton","","tabindex","0",1,"cl-no-focus-tabindex","cl-component-divided-left","cl-d-flex","cl-w-100","cl-w-lg-auto","cl-dropdown-toggle","cl-no-arrow","pointer"],["src","assets/images/ui-icons/menu-dots-vertical.svg"],["class","cl-dropdown-menu cl-dropdown-menu-right","openUpAtBottom","",4,"dropdownKeyContent"],["dropdownClose","","tabindex","0",1,"cl-no-focus-tabindex"],["openUpAtBottom","",1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-scroll-area"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"click"],["class","cl-dropdown-item","clickCloseDropdown","",3,"disabled","click",4,"ngIf"],[4,"ngIf"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"disabled","click"],[1,"cl-dropdown-divider"],["clickCloseDropdown","",1,"cl-dropdown-item","cl-text-danger",3,"click"],[3,"title","btnText","isDanger","inProgress","confirmed","close"]],template:function(e,t){if(1&e&&(s.Xc(0,Hl,1,0,"ng-container",0),s.Sb(1,"responsive-row",1,2),s.Xc(3,$l,2,1,"ng-template",null,3,s.Yc),s.Xc(5,Kl,3,2,"ng-template",null,4,s.Yc),s.Xc(7,ql,3,3,"ng-template",null,5,s.Yc),s.Xc(9,Jl,4,2,"ng-template",null,6,s.Yc),s.Xc(11,nb,4,2,"ng-template",null,7,s.Yc),s.Xc(13,ab,5,0,"ng-template",null,8,s.Yc),s.Xc(15,ob,6,11,"ng-template",null,9,s.Yc)),2&e){const e=s.Lc(2),n=s.Lc(4),i=s.Lc(6),c=s.Lc(8),a=s.Lc(10),o=s.Lc(12),r=s.Lc(14);s.wc("ngTemplateOutlet",e.template)("ngTemplateOutletContext",s.Bc(5,rb,t.labels)),s.Cb(1),s.wc("isDesktop",t.isDesktop)("templates",s.Gc(7,lb,n,i,c,a,o,r))("isExpanded",t.expandAll)}},directives:[i.B,Ei.a,v.c,v.s,v.v,i.u,ni.a,ii.a,si.a,Si.a],pipes:[Yl,g.e],encapsulation:2,changeDetection:0}),e})();function db(e,t){1&e&&(s.Xb(0,"div",16),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,1,"WORKSPACE.ACCOUNT.MANAGE.OWNER.INFO_MESSAGE")))}const ub=function(){return["/upgrade"]},pb=function(){return{plan:"enterprise"}};function hb(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",16),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",17),s.jc("click",(function(){return s.Oc(e),s.nc().addAnalyticsEvent()})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,4,"WORKSPACE.FEATURE.TYPES.ENTERPRISE"),""),s.Cb(2),s.wc("routerLink",s.Ac(8,ub))("queryParams",s.Ac(9,pb)),s.Cb(1),s.ad(s.pc(6,6,"GLOBAL.UPGRADE_BTN")))}function mb(e,t){1&e&&s.Sb(0,"div",18)}function gb(e,t){if(1&e){const e=s.Yb();s.Xb(0,"tr",19),s.jc("onDeleted",(function(){s.Oc(e);const n=t.index;return s.nc().onDeleted(n)})),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc();s.wc("labels",n.labels)("user",e)("ownerId",n.ownerId)("isDesktop",n.isDesktop)("expandAll",n.expandAll)}}function Eb(e,t){if(1&e){const e=s.Yb();s.Xb(0,"pager",20,21),s.jc("pageChanged",(function(t){return s.Oc(e),s.nc().setPaginationUrl(t)}))("limitChanged",(function(t){return s.Oc(e),s.nc().setPaginationUrl(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("page",null==e.pagination?null:e.pagination.page)("limit",null==e.pagination?null:e.pagination.pageSize)("total",e.totalUserCount)}}let fb=(()=>{class e{constructor(e,t,n,i,s,c,a,o){this.activatedRoute=e,this.browserService=t,this.router=n,this.accountsUsersService=i,this.authService=s,this.uiSettingsService=c,this.cd=a,this.analyticsService=o,this.labels=["Name","Email","Registration","Api Key","Workspaces","Login","Edit"],this.unsubscribe$=new p.a,this.pageDebouncer$=new p.a}set isOwner(e){const t=this.isOwner;this._isOwner=e,!t&&this.isOwner&&this.isInitialized&&this.subscribeToData()}get isOwner(){return this._isOwner}ngOnInit(){this.initPagination(),this.setBrowserWidth(),this.subscribeToData(),this.isInitialized=!0}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}subscribeToData(){this.isOwner&&this.hasControlAccountFeature&&(this.subscribeToRouteParams(),this.subscribeToRouteDebouncer(),this.ownerId=this.authService.getUser().id)}changeSortColumn(e){this.pagination.sortColumn=e,this.pagination.sortOrder=bi.a.ASCENDING,this.pageDebouncer$.next(),this.setLocalStorageData()}changeSortOrder(){this.pagination.sortOrder=this.pagination.sortOrder===bi.a.ASCENDING?bi.a.DESCENDING:bi.a.ASCENDING,this.pageDebouncer$.next(),this.setLocalStorageData()}onSearchChange(){this.initPagination(),this.pageDebouncer$.next()}setPaginationUrl(e){this.pagination.page=e.page||this.pagination.page,this.pagination.pageSize=e.limit||this.pagination.pageSize,this.setLocalStorageData(),this.pageDebouncer$.next()}onDeleted(e){this.users.splice(e,1),this.cd.detectChanges()}initPagination(){const e=this.uiSettingsService.getSettings(xn.b.USER_ACCOUNTS_PAGESIZE)||{};this.pagination={page:1,pageSize:e.pageSize||In.y,sortOrder:bi.a[e.sortOrder]||bi.a.ASCENDING,sortColumn:e.sortColumn||"name"}}setLocalStorageData(){this.uiSettingsService.setSettings(xn.b.USER_ACCOUNTS_PAGESIZE,{pageSize:this.pagination.pageSize,sortOrder:this.pagination.sortOrder,sortColumn:this.pagination.sortColumn})}subscribeToRouteDebouncer(){this.pageDebouncer$.pipe(Object(De.a)(350)).subscribe(()=>{this.router.navigate([],{queryParams:this.pagination,relativeTo:this.activatedRoute,fragment:"accounts"})})}subscribeToRouteParams(){this.activatedRoute.queryParams.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.pagination.searchEmail=e.searchEmail||"",Object(sn.u)(e.page)&&e.page>0&&(this.pagination.page=Number(e.page)),Object(sn.u)(e.pageSize)&&e.pageSize>0&&e.pageSize<=200&&(this.pagination.pageSize=Number(e.pageSize)),bi.a[e.sortOrder]&&(this.pagination.sortOrder=e.sortOrder),this.getUsers()})}expandAllRows(e){this.expandAll=e}getUsers(){this.accountsUsersService.getUsers(this.pagination).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(({users:e,count:t})=>{this.totalUserCount=t,this.isMultiplePages=t>In.y||t>this.pagination.pageSize,this.users=e,0===e.length&&this.pagination.page>1&&(this.pagination.page=1,this.router.navigate([],{relativeTo:this.activatedRoute,fragment:"accounts"})),this.cd.detectChanges()})}setBrowserWidth(){this.browserService.isBreakpointLgCustom$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e,this.cd.detectChanges()})}addAnalyticsEvent(){this.analyticsService.addEvent(new Fi.a({event:"submit",value:"Enterprise",section:"Workspace settings",section2:"Accounts",section4:"Upgrade"}))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.a),s.Rb(Gn.a),s.Rb(k.d),s.Rb(H),s.Rb(re.a),s.Rb(xn.a),s.Rb(s.h),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["accounts-tab"]],inputs:{isOwner:"isOwner",hasControlAccountFeature:"hasControlAccountFeature"},decls:22,vars:15,consts:[["class","cl-form-group",4,"ngIf"],[1,"cl-relative"],["class","cl-blocker",4,"ngIf"],[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-form-row","cl-align-items-center"],[1,"cl-col-lg-custom-3"],[1,"cl-form-group","cl-mb-0"],["type","text","tabindex","0",1,"cl-form-control",3,"ngModel","placeholder","ngModelChange"],[1,"cl-card","cl-border-bottom-0","cl-mb-0"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-custom-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6"],["account-header","",3,"sortOrder","sortColumn","isDesktop","onChangeSortOrder","onChangeSortColumn","onExpandAll"],["account-row","","class","account-row",3,"labels","user","ownerId","isDesktop","expandAll","onDeleted",4,"ngFor","ngForOf"],[1,"cl-mt-2","cl-mt-lg-3"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],[1,"cl-form-group"],[1,"cl-btn",3,"routerLink","queryParams","click"],[1,"cl-blocker"],["account-row","",1,"account-row",3,"labels","user","ownerId","isDesktop","expandAll","onDeleted"],[3,"page","limit","total","pageChanged","limitChanged"],["pager",""]],template:function(e,t){1&e&&(s.Xc(0,db,4,3,"div",0),s.Xc(1,hb,7,10,"div",0),s.Xb(2,"div",1),s.Xc(3,mb,1,0,"div",2),s.Xb(4,"div",3),s.Xb(5,"div",4),s.Xb(6,"div",5),s.Xb(7,"div",6),s.Xb(8,"input",7),s.jc("ngModelChange",(function(){return t.onSearchChange()}))("ngModelChange",(function(e){return t.pagination.searchEmail=e})),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(10,"div",8),s.Xb(11,"div",9),s.Xb(12,"span",10),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(15,"table",11),s.Xb(16,"thead"),s.Xb(17,"tr",12),s.jc("onChangeSortOrder",(function(){return t.changeSortOrder()}))("onChangeSortColumn",(function(e){return t.changeSortColumn(e)}))("onExpandAll",(function(e){return t.expandAllRows(e)})),s.Wb(),s.Wb(),s.Xb(18,"tbody"),s.Xc(19,gb,1,5,"tr",13),s.Wb(),s.Wb(),s.Xb(20,"div",14),s.Xc(21,Eb,2,3,"pager",15),s.Wb(),s.Wb()),2&e&&(s.wc("ngIf",!1===t.isOwner),s.Cb(1),s.wc("ngIf",!t.hasControlAccountFeature),s.Cb(2),s.wc("ngIf",!t.isOwner||!t.hasControlAccountFeature),s.Cb(5),s.xc("placeholder",s.pc(9,11,"WORKSPACE.ACCOUNT.USER.SEARCH_BY.EMAIL")),s.wc("ngModel",t.pagination.searchEmail),s.Cb(5),s.ad(s.pc(14,13,"GLOBAL.ACCOUNTS_TITLE")),s.Cb(4),s.wc("sortOrder",t.pagination.sortOrder)("sortColumn",t.pagination.sortColumn)("isDesktop",t.isDesktop),s.Cb(2),s.wc("ngForOf",t.users),s.Cb(2),s.wc("ngIf",t.isMultiplePages))},directives:[i.u,v.c,v.s,v.v,Vl,i.t,To.a,k.g,bb,Pi.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var Sb=n("1uah"),Cb=function(e){return e.NATIVE_LOGIN="NATIVE_LOGIN",e.LDAP="LDAP",e.SAML2="SAML2",e.OAUTH2="OAUTH2",e}({});class Ab{constructor(e={}){this.id=e.id||null,this.domainName=e.domainName||null,this.automaticJoinOnWorkspace=e.automaticJoinOnWorkspace||!1,this.workspaceId=e.workspaceId||null,this.autoLogin=e.autoLogin||null,this.customSupportLinksSettings=e.customSupportLinksSettings||null,this.logoURL=e.logoURL||null,this.loginPreferences=e.loginPreferences||[Cb.NATIVE_LOGIN],this.auth=e.auth||null}}class Ob{constructor(e={}){this.relyingPartyIdentifier=e.relyingPartyIdentifier||"",this.assertionConsumerServiceUrl=e.assertionConsumerServiceUrl||"",this.metadataUrl=e.metadataUrl||"",this.logoutUrl=e.logoutUrl||"",this.loginUrl=e.loginUrl||"",this.certificates=e.certificates||[]}}class vb{constructor(e={}){this.accessTokenPath=e.accessTokenPath||"",this.clientId=e.clientId||"",this.clientSecret=e.clientSecret||"",this.authorizationCodePath=e.authorizationCodePath||"",this.emailTokenField=e.emailTokenField||"",this.usernameTokenField=e.usernameTokenField||"",this.userInfoOpenIdPath=e.userInfoOpenIdPath||"",this.scope=e.scope||"",this.firstNameTokenField=e.firstNameTokenField||"",this.lastNameTokenField=e.lastNameTokenField||""}}class Tb{constructor(e={}){this.emailAttribute=e.emailAttribute||"",this.initialContextFactory=e.initialContextFactory||"",this.providerURI=e.providerURI||"",this.searchBases=e.searchBases||"",this.securityAuthentication=e.securityAuthentication||"",this.securityCredentials=e.securityCredentials||"",this.securityPrincipal=e.securityPrincipal||"",this.userSearchFilter=e.userSearchFilter||""}}let Ib=(()=>{class e{constructor(e,t,n,i){this.toaster=e,this.workspaceService=t,this.http=n,this.translateService=i,this.subdomain$=new p.a,this.enpoints={[Cb.LDAP]:"ldap-configuration",[Cb.OAUTH2]:"o-auth2-configuration",[Cb.SAML2]:"saml2-configuration"}}checkIsValidDomain(e){const t=(new m.h).append("domain-name",e.toLowerCase()),n=this.workspaceService.getDefaultWorkspaceId();return this.http.get(`/workspaces/${n}/organization/subdomain-name/`,{params:t}).pipe(Object(d.a)(e=>e),Object(u.a)(null,()=>this.toaster.pop("error",this.translateService.instant("SERVICES.SUBDOMAIN.CHECK.ERROR_MESSAGE"))))}createSubdomain(e){e=e.toLowerCase();const t=this.workspaceService.getDefaultWorkspaceId();return this.http.post(`/v1/workspaces/${t}/organization`,{organizationName:e}).pipe(Object(d.a)(e=>new Ab(e)),Object(u.a)(t=>{this.subdomainSystemSettingsId=t.id,this.toaster.pop("success",this.translateService.instant("SERVICES.SUBDOMAIN.CREATE.SUCCESS_MESSAGE",{domainName:e}))},t=>this.toaster.pop("error",t.error&&t.error.message||this.translateService.instant("SERVICES.SUBDOMAIN.CREATE.ERROR_MESSAGE",{domainName:e}))))}getSubdomain(){const e=this.workspaceService.getDefaultWorkspaceId();return this.http.get(`/v1/workspaces/${e}/organization/`).pipe(Object(d.a)(e=>new Ab(e)),Object(u.a)(e=>this.subdomainSystemSettingsId=e.id,e=>{e.error&&404===e.error.code||this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("SERVICES.SUBDOMAIN.GET.ERROR_MESSAGE"))}))}editDomainData(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/v1/workspaces/${t}/organization/`+this.subdomainSystemSettingsId,e).pipe(Object(d.a)(e=>new Ab(e)),Object(u.a)(()=>this.toaster.pop("success",this.translateService.instant("SERVICES.EDIT.SUCCESS_MESSAGE")),e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("SERVICES.EDIT.ERROR_MESSAGE"))))}patchConfiguration(e,t){const n=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/v1/workspaces/${n}/organization/`+this.subdomainSystemSettingsId+"/"+this.enpoints[t],e).pipe(Object(d.a)(e=>t===Cb.SAML2?new Ob(e):t===Cb.OAUTH2?new vb(e):t===Cb.LDAP?new Tb(e):void 0),Object(u.a)(()=>this.toaster.pop("success",this.translateService.instant("SERVICES.SUBDOMAIN.EDIT.SUCCESS_MESSAGE",{type:t})),e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("SERVICES.SAVE.ERROR_MESSAGE"))))}getConfigurations(){const e=`/v1/workspaces/${this.workspaceService.getDefaultWorkspaceId()}/organization/`+this.subdomainSystemSettingsId+"/",t=this.http.get(e+this.enpoints[Cb.LDAP]+"/"),n=this.http.get(e+this.enpoints[Cb.OAUTH2]+"/"),i=this.http.get(e+this.enpoints[Cb.SAML2]+"/");return Object(Sb.a)(t,n,i).pipe(Object(d.a)(e=>{const t={},n=e[0],i=e[1],s=e[2];return n&&(t[Cb.LDAP]=new Tb(n)),i&&(t[Cb.OAUTH2]=new vb(i)),s&&(t[Cb.SAML2]=new Ob(s)),t}),Object(u.a)(null,e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("SERVICES.SUBDOMAIN.CONFIGURATION.GET.ERROR_MESSAGE"))))}deleteConfiguration(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`/v1/workspaces/${t}/organization/`+this.subdomainSystemSettingsId+"/"+this.enpoints[e]+"/").pipe(Object(u.a)(()=>this.toaster.pop("success",this.translateService.instant("SERVICES.SUBDOMAIN.DELETE.SUCCESS_MESSAGE")),t=>this.toaster.pop("error",t.error&&t.error.message||this.translateService.instant("SERVICES.SUBDOMAIN.CONFIGURATION.DELETE.ERROR_MESSAGE",{type:e}))))}deleteSubdomain(){const e=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`/v1/workspaces/${e}/organization/`+this.subdomainSystemSettingsId+"/").pipe(Object(u.a)(()=>{this.toaster.pop("success",this.translateService.instant("SERVICES.SUBDOMAIN.DELETE.SUCCESS_MESSAGE")),this.subdomainSystemSettingsId=null},e=>this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("GLOBAL.DELETE_ERROR_MESSAGE"))))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(r.a),s.fc(l.a),s.fc(m.c),s.fc(g.f))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const wb=[{value:Cb.LDAP,label:"LDAP"},{value:Cb.SAML2,label:"SAML2"},{value:Cb.OAUTH2,label:"OAuth2"}];var Lb=n("huA5");let Rb=(()=>{class e{constructor(){this.subdomainName=""}setSubdomainName(e){this.subdomainName=e?e.domainName:""}getSubdomainName(){return this.subdomainName}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var yb=n("eIep"),_b=n("DoKE");let kb=(()=>{class e{constructor(){}onKeyDown(e){(e.keyCode?e.keyCode:e.which)==_b.h&&e.preventDefault()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=s.Mb({type:e,selectors:[["","preventSpace",""]],hostBindings:function(e,t){1&e&&s.jc("keydown",(function(e){return t.onKeyDown(e)}))}}),e})();const Wb=["input"],Xb=function(e){return{MAX_LENGTH:e}};function Nb(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.qc(2,1,"WORKSPACE.SUBDOMAIN.NAME_TOO_LONG",s.Bc(4,Xb,e.MAX_LENGTH))," ")}}function Db(e,t){if(1&e&&(s.Xb(0,"small",9),s.Zc(1),s.oc(2,"translate"),s.Xc(3,Nb,3,6,"ng-container",10),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.pc(2,2,"WORKSPACE.SUBDOMAIN.ENTER_NAME")," "),s.Cb(2),s.wc("ngIf",e.domainName.errors.maxlength)}}const Pb=function(e){return{checkedDomainName:e}};function Mb(e,t){if(1&e&&(s.Xb(0,"small",13),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.bd(" ",s.qc(2,1,"WORKSPACE.SUBDOMAIN.NAME_AVAILABLE",s.Bc(4,Pb,e.checkedDomainName))," ")}}function Bb(e,t){if(1&e&&(s.Xb(0,"small",9),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.bd(" ",s.qc(2,1,"WORKSPACE.SUBDOMAIN.NAME_UNAVAILABLE",s.Bc(4,Pb,e.checkedDomainName))," ")}}function Ub(e,t){if(1&e&&(s.Vb(0),s.Xc(1,Mb,3,6,"small",11),s.Xc(2,Bb,3,6,"small",12),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",e.isAvailable),s.Cb(1),s.wc("ngIf",!e.isAvailable)}}function Gb(e,t){if(1&e&&s.Xc(0,Ub,3,2,"ng-container",10),2&e){const e=s.nc();s.wc("ngIf",e.checkedDomainName)}}let xb=(()=>{class e{constructor(e,t){this.formBuilder=e,this.authSSOService=t,this.onAvailableName=new s.n,this.onEnter=new s.n,this._name="",this.autofocus=!1,this.domainDebouncer$=new p.a,this.MAX_LENGTH=30,this.unsubscribe$=new p.a}set name(e){const t=!e&&!!this.name;this._name=e,t&&(this.onAvailableName.emit(""),this.initForm(),this.subscribeToChanges()),e&&(this.checkedDomainName=null,this.domainForm&&(this.nameChangeSub.unsubscribe(),this.domainForm.updateValueAndValidity(),this.domainForm.patchValue({domainName:e})))}get name(){return this._name}get domainName(){return this.domainForm.get("domainName")}get isDomainNameInvalid(){return this.domainName.dirty&&!!this.domainName.errors}ngOnInit(){this.initForm(),this.subscribeToDebouncer(),this.subscribeToChanges()}ngAfterViewInit(){this.autofocus&&this.input&&setTimeout(()=>{this.input.nativeElement.focus()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}onEnterPressed(){this.onEnter.emit()}initForm(){this.domainForm=this.formBuilder.group({domainName:[this.name||"",[Bi.a.required,Bi.a.domain(),Bi.a.maxLength(this.MAX_LENGTH)]]})}subscribeToChanges(){this.nameChangeSub=this.domainForm.get("domainName").valueChanges.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.checkedDomainName=null,this.onAvailableName.emit(""),this.domainDebouncer$.next(e)})}subscribeToDebouncer(){let e;this.checkIsAvailableSub=this.domainDebouncer$.pipe(Object(De.a)(250),Object(Zt.a)(()=>this.domainForm.valid),Object(yb.a)(t=>(e=t.trim(),this.authSSOService.checkIsValidDomain(e))),Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.isAvailable=t,this.checkedDomainName=e,this.onAvailableName.emit(t?e:"")},()=>{this.checkIsAvailableSub&&this.checkIsAvailableSub.unsubscribe(),this.subscribeToDebouncer()})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(v.f),s.Rb(Ib))},e.\u0275cmp=s.Lb({type:e,selectors:[["domain-input"]],viewQuery:function(e,t){var n;1&e&&s.gd(Wb,!0),2&e&&s.Kc(n=s.kc())&&(t.input=n.first)},inputs:{disable:"disable",name:"name",autofocus:"autofocus"},outputs:{onAvailableName:"onAvailableName",onEnter:"onEnter"},decls:14,vars:11,consts:[[3,"formGroup"],[1,"cl-input-group"],[1,"cl-input-group-prepend"],[1,"cl-input-group-text"],["type","text","preventSpace","","tabindex","0","spellcheck","false","formControlName","domainName","autocomplete","off",1,"cl-form-control",3,"readonly","placeholder","keyup.enter"],["input",""],[1,"cl-input-group-append"],["class","cl-form-text cl-text-danger",4,"ngIf","ngIfElse"],["inputIsValidTemplate",""],[1,"cl-form-text","cl-text-danger"],[4,"ngIf"],["class","cl-form-text cl-text-success",4,"ngIf"],["class","cl-form-text cl-text-danger",4,"ngIf"],[1,"cl-form-text","cl-text-success"]],template:function(e,t){if(1&e&&(s.Xb(0,"form",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"span",3),s.Zc(4,"https://"),s.Wb(),s.Wb(),s.Xb(5,"input",4,5),s.jc("keyup.enter",(function(){return t.onEnterPressed()})),s.oc(7,"translate"),s.Wb(),s.Xb(8,"div",6),s.Xb(9,"span",3),s.Zc(10,".clockify.me"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(11,Db,4,4,"small",7),s.Xc(12,Gb,1,1,"ng-template",null,8,s.Yc)),2&e){const e=s.Lc(13);s.wc("formGroup",t.domainForm),s.Cb(5),s.Hb("cl-is-valid",t.checkedDomainName&&t.isAvailable)("cl-is-invalid",t.isDomainNameInvalid||t.checkedDomainName&&!t.isAvailable),s.wc("readonly",t.disable)("placeholder",s.pc(7,9,"WORKSPACE.SUBDOMAIN.PLACEHOLDER_FOR_NAME")),s.Cb(6),s.wc("ngIf",t.isDomainNameInvalid)("ngIfElse",e)}},directives:[v.I,v.t,v.k,v.c,kb,v.s,v.i,i.u],pipes:[g.e],encapsulation:2}),e})();function Fb(e,t){1&e&&(s.Xb(0,"small",19),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.LDAP_FORM.PROVIDER_URI.ENTER")," "))}function jb(e,t){1&e&&(s.Xb(0,"small",19),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SECURITY.ENTER")," "))}function Zb(e,t){1&e&&(s.Xb(0,"small",19),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SECURITY.PRINCIPAL.ENTER")," "))}function Vb(e,t){1&e&&(s.Xb(0,"small",19),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SECURITY.CREDENTIALS.ENTER")," "))}function Yb(e,t){1&e&&(s.Xb(0,"small",19),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SECURITY.SEARCH_BASES.ENTER")," "))}function Hb(e,t){1&e&&(s.Xb(0,"small",19),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SECURITY.SEARCH_FILTER.ENTER")," "))}function $b(e,t){1&e&&(s.Xb(0,"small",19),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SECURITY.EMAIL_ATTRIBUTE.ENTER")," "))}function Kb(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",20),s.Xb(1,"a",21),s.jc("click",(function(){return s.Oc(e),s.nc().onClose.emit()})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",22),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,3,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",e.form.invalid||e.inProgress),s.Cb(1),s.bd(" ",s.pc(6,5,"WORKSPACE.CONFIGURATION.FINISH")," ")}}let qb=(()=>{class e{constructor(e){this.formBuilder=e,this.isReadonly=!1,this.isModal=!0,this.onClose=new s.n,this.onSubmit=new s.n,this.unsubscribe$=new p.a}set configuration(e){e&&this.initConfig(e)}ngOnInit(){this.form||this.initConfig(new Tb)}initConfig(e){this.form=this.formBuilder.group({emailAttribute:[e.emailAttribute,[Bi.a.required]],providerURI:[e.providerURI,[Bi.a.required]],searchBases:[e.searchBases,[Bi.a.required]],securityAuthentication:[e.securityAuthentication,[Bi.a.required]],securityCredentials:[e.securityCredentials,[]],securityPrincipal:[e.securityPrincipal,[]],userSearchFilter:[e.userSearchFilter,[Bi.a.required]]})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}submit(){if(this.inProgress)return;const e=Object.assign({},this.form.value);Object.keys(e).map(t=>e[t]="string"==typeof e[t]?e[t].trim():e[t]);const t=new Tb(e);this.onSubmit.emit(t)}isValid(e){const t=this.form.get(e);return!!t&&t.dirty&&t.touched&&!!t.errors}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(v.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["form-ldap"]],inputs:{configuration:"configuration",isReadonly:"isReadonly",isModal:"isModal",inProgress:"inProgress"},outputs:{onClose:"onClose",onSubmit:"onSubmit"},decls:55,vars:53,consts:[[3,"formGroup","ngSubmit"],[1,"cl-form-group"],["for","providerURI"],[1,"cl-text-danger","cl-ml-1"],["type","text","id","providerURI","autocomplete","off","formControlName","providerURI",1,"cl-form-control",3,"readonly"],["class","cl-form-text cl-text-danger",4,"ngIf"],["for","securityAuthentication"],["type","text","id","securityAuthentication","autocomplete","off","formControlName","securityAuthentication",1,"cl-form-control",3,"readonly"],["for","securityPrincipal"],["type","text","id","securityPrincipal","autocomplete","off","formControlName","securityPrincipal",1,"cl-form-control",3,"readonly"],["for","securityCredentials"],["type","text","id","securityCredentials","autocomplete","off","formControlName","securityCredentials",1,"cl-form-control",3,"readonly"],["for","searchBases"],["type","text","id","searchBases","autocomplete","off","formControlName","searchBases",1,"cl-form-control",3,"readonly"],["for","userSearchFilter"],["type","text","id","userSearchFilter","autocomplete","off","formControlName","userSearchFilter",1,"cl-form-control",3,"readonly"],["for","emailAttribute"],["type","text","ngbAutofocus","","id","emailAttribute","autocomplete","off","formControlName","emailAttribute",1,"cl-form-control",3,"readonly"],["class","modal-footer",4,"ngIf"],[1,"cl-form-text","cl-text-danger"],[1,"modal-footer"],["tabindex","0",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"]],template:function(e,t){1&e&&(s.Xb(0,"form",0),s.jc("ngSubmit",(function(){return t.submit()})),s.Xb(1,"div"),s.Xb(2,"div",1),s.Xb(3,"label",2),s.Zc(4),s.oc(5,"translate"),s.Xb(6,"span",3),s.Zc(7,"*"),s.Wb(),s.Wb(),s.Sb(8,"input",4),s.Xc(9,Fb,3,3,"small",5),s.Wb(),s.Xb(10,"div",1),s.Xb(11,"label",6),s.Zc(12),s.oc(13,"translate"),s.Xb(14,"span",3),s.Zc(15,"*"),s.Wb(),s.Wb(),s.Sb(16,"input",7),s.Xc(17,jb,3,3,"small",5),s.Wb(),s.Xb(18,"div",1),s.Xb(19,"label",8),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Sb(22,"input",9),s.Xc(23,Zb,3,3,"small",5),s.Wb(),s.Xb(24,"div",1),s.Xb(25,"label",10),s.Zc(26),s.oc(27,"translate"),s.Wb(),s.Sb(28,"input",11),s.Xc(29,Vb,3,3,"small",5),s.Wb(),s.Xb(30,"div",1),s.Xb(31,"label",12),s.Zc(32),s.oc(33,"translate"),s.Xb(34,"span",3),s.Zc(35,"*"),s.Wb(),s.Wb(),s.Sb(36,"input",13),s.Xc(37,Yb,3,3,"small",5),s.Wb(),s.Xb(38,"div",1),s.Xb(39,"label",14),s.Zc(40),s.oc(41,"translate"),s.Xb(42,"span",3),s.Zc(43,"*"),s.Wb(),s.Wb(),s.Sb(44,"input",15),s.Xc(45,Hb,3,3,"small",5),s.Wb(),s.Xb(46,"div",1),s.Xb(47,"label",16),s.Zc(48),s.oc(49,"translate"),s.Xb(50,"span",3),s.Zc(51,"*"),s.Wb(),s.Wb(),s.Sb(52,"input",17),s.Xc(53,$b,3,3,"small",5),s.Wb(),s.Wb(),s.Xc(54,Kb,7,7,"div",18),s.Wb()),2&e&&(s.wc("formGroup",t.form),s.Cb(1),s.Hb("modal-body",t.isModal),s.Cb(3),s.ad(s.pc(5,39,"WORKSPACE.CONFIGURATION.AUTHENTICATION.LDAP_FORM.PROVIDER_URI.LABEL")),s.Cb(4),s.Hb("cl-border-danger",t.isValid("providerURI")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("providerURI")),s.Cb(3),s.bd(" ",s.pc(13,41,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SECURITY.LABEL")," "),s.Cb(4),s.Hb("cl-border-danger",t.isValid("securityAuthentication")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("securityAuthentication")),s.Cb(3),s.ad(s.pc(21,43,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SECURITY.PRINCIPAL.LABEL")),s.Cb(2),s.Hb("cl-border-danger",t.isValid("securityPrincipal")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("securityPrincipal")),s.Cb(3),s.ad(s.pc(27,45,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SECURITY.CREDENTIALS.LABEL")),s.Cb(2),s.Hb("cl-border-danger",t.isValid("securityCredentials")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("securityCredentials")),s.Cb(3),s.ad(s.pc(33,47,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SECURITY.SEARCH_BASES.LABEL")),s.Cb(4),s.Hb("cl-border-danger",t.isValid("searchBases")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("searchBases")),s.Cb(3),s.bd(" ",s.pc(41,49,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SECURITY.SEARCH_FILTER.LABEL")," "),s.Cb(4),s.Hb("cl-border-danger",t.isValid("userSearchFilter")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("userSearchFilter")),s.Cb(3),s.ad(s.pc(49,51,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SECURITY.EMAIL_ATTRIBUTE.LABEL")),s.Cb(4),s.Hb("cl-border-danger",t.isValid("emailAttribute")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("emailAttribute")),s.Cb(1),s.wc("ngIf",t.isModal))},directives:[v.I,v.t,v.k,v.c,v.s,v.i,i.u],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function zb(e,t){1&e&&(s.Xb(0,"small",26),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.CLIENT.ENTER")," "))}function Qb(e,t){1&e&&(s.Xb(0,"small",26),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.CLIENT.SECRET.ENTER")," "))}function Jb(e,t){1&e&&(s.Xb(0,"small",26),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.CODE_PATH.INFO_MESSAGE")," "))}function ed(e,t){1&e&&(s.Xb(0,"small",26),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.TOKEN_PATH.ENTER")," "))}function td(e,t){1&e&&(s.Xb(0,"small",26),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.USER_INFO.ENTER")," "))}function nd(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",27),s.Xb(1,"label",28),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Sb(4,"input",29,30),s.Xb(6,"div",31),s.Xb(7,"button",32),s.jc("click",(function(){s.Oc(e);const t=s.Lc(5);return s.nc().copyToClipboard(t)})),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,3,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.URL.REDIRECT.LABEL")),s.Cb(2),s.wc("value",e.baseURL+"/login"),s.Cb(4),s.ad(s.pc(9,5,"GLOBAL.COPY_LABEL"))}}function id(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",27),s.Xb(1,"label",28),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Sb(4,"input",29,33),s.Xb(6,"div",31),s.Xb(7,"button",32),s.jc("click",(function(){s.Oc(e);const t=s.Lc(5);return s.nc().copyToClipboard(t)})),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,3,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.URL.REDIRECT.ANDROID")),s.Cb(2),s.wc("value",e.baseURL+"/login/android/oauth2"),s.Cb(4),s.ad(s.pc(9,5,"GLOBAL.COPY_LABEL"))}}function sd(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",27),s.Xb(1,"label",28),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Sb(4,"input",29,34),s.Xb(6,"div",31),s.Xb(7,"button",32),s.jc("click",(function(){s.Oc(e);const t=s.Lc(5);return s.nc().copyToClipboard(t)})),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,3,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.URL.REDIRECT.APPLE")),s.Cb(2),s.wc("value",e.baseURL+"/login/ios/oauth2"),s.Cb(4),s.ad(s.pc(9,5,"GLOBAL.COPY_LABEL"))}}function cd(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",27),s.Xb(1,"label",28),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Sb(4,"input",29,35),s.Xb(6,"div",31),s.Xb(7,"button",32),s.jc("click",(function(){s.Oc(e);const t=s.Lc(5);return s.nc().copyToClipboard(t)})),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,3,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.URL.REDIRECT.CHROME_EXTENSION")),s.Cb(2),s.wc("value",e.baseURL+"/login/extension/chrome/oauth2"),s.Cb(4),s.ad(s.pc(9,5,"GLOBAL.COPY_LABEL"))}}function ad(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",27),s.Xb(1,"label",28),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Sb(4,"input",29,36),s.Xb(6,"div",31),s.Xb(7,"button",32),s.jc("click",(function(){s.Oc(e);const t=s.Lc(5);return s.nc().copyToClipboard(t)})),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,3,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.URL.REDIRECT.FIREFOX_EXTENSION")),s.Cb(2),s.wc("value",e.baseURL+"/login/extension/firefox/oauth2"),s.Cb(4),s.ad(s.pc(9,5,"GLOBAL.COPY_LABEL"))}}function od(e,t){1&e&&(s.Xb(0,"small",26),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.TOKEN_FIELD.EMAIL.ENTER")," "))}function rd(e,t){1&e&&(s.Xb(0,"small",26),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.TOKEN_FIELD.USERNAME.ENTER")," "))}function ld(e,t){1&e&&(s.Xb(0,"small",26),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.TOKEN_FIELD.FIRST_NAME.ENTER")," "))}function bd(e,t){1&e&&(s.Xb(0,"small",26),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.TOKEN_FIELD.LAST_NAME.ENTER")," "))}function dd(e,t){1&e&&(s.Xb(0,"small",26),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.SCOPE.ENTER")," "))}function ud(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",37),s.Xb(1,"a",38),s.jc("click",(function(){return s.Oc(e),s.nc().onClose.emit()})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",39),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,3,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",e.form.invalid||e.inProgress),s.Cb(1),s.bd(" ",s.pc(6,5,"WORKSPACE.CONFIGURATION.FINISH")," ")}}let pd=(()=>{class e{constructor(e,t,n){this.formBuilder=e,this.copyService=t,this.subdomainNameService=n,this.isReadonly=!1,this.isModal=!0,this.onClose=new s.n,this.onSubmit=new s.n,this.unsubscribe$=new p.a}set configuration(e){e&&this.initConfig(e)}ngOnInit(){this.form||this.initConfig(new vb),this.baseURL=`${window.location.protocol}//${window.location.host}`}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initConfig(e){this.form=this.formBuilder.group({accessTokenPath:[e.accessTokenPath,[Bi.a.required]],clientId:[e.clientId,[Bi.a.required]],clientSecret:[e.clientSecret,[Bi.a.required]],authorizationCodePath:[e.authorizationCodePath,[Bi.a.required]],emailTokenField:[e.emailTokenField,[Bi.a.required]],usernameTokenField:[e.usernameTokenField,[]],userInfoOpenIdPath:[e.userInfoOpenIdPath,[Bi.a.required]],scope:[e.scope,[Bi.a.required]],firstNameTokenField:[e.firstNameTokenField,[]],lastNameTokenField:[e.lastNameTokenField,[]]})}submit(){if(this.inProgress)return;const e=Object.assign({},this.form.value);Object.keys(e).map(t=>e[t]="string"==typeof e[t]?e[t].trim():e[t]);const t=new vb(e);this.onSubmit.emit(t)}isValid(e){const t=this.form.get(e);return!!t&&t.dirty&&t.touched&&!!t.errors}copyToClipboard(e){this.copyService.copyToClipboard(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(v.f),s.Rb(ie.a),s.Rb(Rb))},e.\u0275cmp=s.Lb({type:e,selectors:[["form-oauth"]],inputs:{configuration:"configuration",inProgress:"inProgress",isReadonly:"isReadonly",isModal:"isModal"},outputs:{onClose:"onClose",onSubmit:"onSubmit"},decls:82,vars:79,consts:[[3,"formGroup","ngSubmit"],[1,"cl-form-group"],["for","clientId"],[1,"cl-text-danger","cl-ml-1"],["type","text","autocomplete","off","id","clientId","formControlName","clientId",1,"cl-form-control",3,"readonly"],["class","cl-form-text cl-text-danger",4,"ngIf"],["for","clientSecret"],["type","text","id","clientSecret","autocomplete","off","formControlName","clientSecret",1,"cl-form-control",3,"readonly"],["for","authorizationCodePath"],["type","text","autocomplete","off","id","authorizationCodePath","formControlName","authorizationCodePath",1,"cl-form-control",3,"readonly"],["for","accessTokenPath"],["type","text","ngbAutofocus","","autocomplete","off","id","accessTokenPath","formControlName","accessTokenPath",1,"cl-form-control",3,"readonly"],["for","userInfoOpenIdPath"],["type","text","autocomplete","off","id","userInfoOpenIdPath","formControlName","userInfoOpenIdPath",1,"cl-form-control",3,"readonly"],["class","cl-input-group cl-mb-3",4,"ngIf"],["for","emailTokenField"],["type","text","id","emailTokenField","autocomplete","off","formControlName","emailTokenField",1,"cl-form-control",3,"readonly"],["for","usernameTokenField"],["type","text","autocomplete","off","id","usernameTokenField","formControlName","usernameTokenField",1,"cl-form-control",3,"readonly"],["for","firstNameTokenField"],["type","text","autocomplete","off","id","firstNameTokenField","formControlName","firstNameTokenField",1,"cl-form-control",3,"readonly"],["for","lastNameTokenField"],["type","text","id","lastNameTokenField","autocomplete","off","formControlName","lastNameTokenField",1,"cl-form-control",3,"readonly"],["for","scope"],["type","text","id","scope","autocomplete","off","formControlName","scope",1,"cl-form-control",3,"readonly"],["class","modal-footer",4,"ngIf"],[1,"cl-form-text","cl-text-danger"],[1,"cl-input-group","cl-mb-3"],[1,"cl-w-100"],["type","text","readonly","",1,"cl-form-control",3,"value"],["redirectUrlInput",""],[1,"cl-input-group-append"],["type","button",1,"cl-btn","cl-btn-outline-light",3,"click"],["androidUrlInput",""],["appleUrlInput",""],["chromeExtRedirectUrlInput",""],["firefoxExtRedirectUrlInput",""],[1,"modal-footer"],["tabindex","0",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"]],template:function(e,t){1&e&&(s.Xb(0,"form",0),s.jc("ngSubmit",(function(){return t.submit()})),s.Xb(1,"div"),s.Xb(2,"div",1),s.Xb(3,"label",2),s.Zc(4),s.oc(5,"translate"),s.Xb(6,"span",3),s.Zc(7,"*"),s.Wb(),s.Wb(),s.Sb(8,"input",4),s.Xc(9,zb,3,3,"small",5),s.Wb(),s.Xb(10,"div",1),s.Xb(11,"label",6),s.Zc(12),s.oc(13,"translate"),s.Xb(14,"span",3),s.Zc(15,"*"),s.Wb(),s.Wb(),s.Sb(16,"input",7),s.Xc(17,Qb,3,3,"small",5),s.Wb(),s.Xb(18,"div",1),s.Xb(19,"label",8),s.Zc(20),s.oc(21,"translate"),s.Xb(22,"span",3),s.Zc(23,"*"),s.Wb(),s.Wb(),s.Sb(24,"input",9),s.Xc(25,Jb,3,3,"small",5),s.Wb(),s.Xb(26,"div",1),s.Xb(27,"label",10),s.Zc(28),s.oc(29,"translate"),s.Xb(30,"span",3),s.Zc(31,"*"),s.Wb(),s.Wb(),s.Sb(32,"input",11),s.Xc(33,ed,3,3,"small",5),s.Wb(),s.Xb(34,"div",1),s.Xb(35,"label",12),s.Zc(36),s.oc(37,"translate"),s.Xb(38,"span",3),s.Zc(39,"*"),s.Wb(),s.Wb(),s.Sb(40,"input",13),s.Xc(41,td,3,3,"small",5),s.Wb(),s.Xc(42,nd,10,7,"div",14),s.Xc(43,id,10,7,"div",14),s.Xc(44,sd,10,7,"div",14),s.Xc(45,cd,10,7,"div",14),s.Xc(46,ad,10,7,"div",14),s.Xb(47,"div",1),s.Xb(48,"label",15),s.Zc(49),s.oc(50,"translate"),s.Xb(51,"span",3),s.Zc(52,"*"),s.Wb(),s.Wb(),s.Sb(53,"input",16),s.Xc(54,od,3,3,"small",5),s.Wb(),s.Xb(55,"div",1),s.Xb(56,"label",17),s.Zc(57),s.oc(58,"translate"),s.Wb(),s.Sb(59,"input",18),s.Xc(60,rd,3,3,"small",5),s.Wb(),s.Xb(61,"div",1),s.Xb(62,"label",19),s.Zc(63),s.oc(64,"translate"),s.Wb(),s.Sb(65,"input",20),s.Xc(66,ld,3,3,"small",5),s.Wb(),s.Xb(67,"div",1),s.Xb(68,"label",21),s.Zc(69),s.oc(70,"translate"),s.Wb(),s.Sb(71,"input",22),s.Xc(72,bd,3,3,"small",5),s.Wb(),s.Xb(73,"div",1),s.Xb(74,"label",23),s.Zc(75),s.oc(76,"translate"),s.Xb(77,"span",3),s.Zc(78,"*"),s.Wb(),s.Wb(),s.Sb(79,"input",24),s.Xc(80,dd,3,3,"small",5),s.Wb(),s.Wb(),s.Xc(81,ud,7,7,"div",25),s.Wb()),2&e&&(s.wc("formGroup",t.form),s.Cb(1),s.Hb("modal-body",t.isModal),s.Cb(3),s.ad(s.pc(5,59,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.CLIENT.LABEL")),s.Cb(4),s.Hb("cl-border-danger",t.isValid("clientId")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("clientId")),s.Cb(3),s.ad(s.pc(13,61,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.CLIENT.SECRET.LABEL")),s.Cb(4),s.Hb("cl-border-danger",t.isValid("clientSecret")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("clientSecret")),s.Cb(3),s.ad(s.pc(21,63,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.CODE_PATH.LABEL")),s.Cb(4),s.Hb("cl-border-danger",t.isValid("authorizationCodePath")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("authorizationCodePath")),s.Cb(3),s.ad(s.pc(29,65,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.TOKEN_PATH.LABEL")),s.Cb(4),s.Hb("cl-border-danger",t.isValid("accessTokenPath")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("accessTokenPath")),s.Cb(3),s.ad(s.pc(37,67,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.USER_INFO.LABEL")),s.Cb(4),s.Hb("cl-border-danger",t.isValid("userInfoOpenIdPath")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("userInfoOpenIdPath")),s.Cb(1),s.wc("ngIf",t.baseURL),s.Cb(1),s.wc("ngIf",t.baseURL),s.Cb(1),s.wc("ngIf",t.baseURL),s.Cb(1),s.wc("ngIf",t.baseURL),s.Cb(1),s.wc("ngIf",t.baseURL),s.Cb(3),s.ad(s.pc(50,69,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.TOKEN_FIELD.EMAIL.LABEL")),s.Cb(4),s.Hb("cl-border-danger",t.isValid("emailTokenField")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("emailTokenField")),s.Cb(3),s.ad(s.pc(58,71,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.TOKEN_FIELD.USERNAME.LABEL")),s.Cb(2),s.Hb("cl-border-danger",t.isValid("usernameTokenField")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("usernameTokenField")),s.Cb(3),s.ad(s.pc(64,73,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.TOKEN_FIELD.FIRST_NAME.LABEL")),s.Cb(2),s.Hb("cl-border-danger",t.isValid("firstNameTokenField")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("firstNameTokenField")),s.Cb(3),s.ad(s.pc(70,75,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.TOKEN_FIELD.LAST_NAME.LABEL")),s.Cb(2),s.Hb("cl-border-danger",t.isValid("lastNameTokenField")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("lastNameTokenField")),s.Cb(3),s.ad(s.pc(76,77,"WORKSPACE.CONFIGURATION.AUTHENTICATION.OAUTH.SCOPE.LABEL")),s.Cb(4),s.Hb("cl-border-danger",t.isValid("scope")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("scope")),s.Cb(1),s.wc("ngIf",t.isModal))},directives:[v.I,v.t,v.k,v.c,v.s,v.i,i.u],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var hd=n("EcEN");const md=["fileInput"];let gd=(()=>{class e{constructor(e,t){this.toaster=e,this.translateService=t,this.accept=["text/xml"],this.onUploaded=new s.n}ngOnInit(){this.uid=Object(hd.v4)(),this.acceptExtensions||(this.acceptExtensions=this.accept.join(", "))}uploadFile(){const e=this.inputEl.nativeElement;if(!e.files.length||!e.files.item(0))return void this.clearInput();const t=e.files.item(0);this.validate(t.type)?this.readFile(t):this.clearInput()}validate(e){if(!e)return!0;if(this.accept.indexOf(e)<0){const t=this.translateService.instant("GLOBAL.UPLOAD_TYPE_ERROR_MESSAGE",{accept:this.accept,type:e});return this.toaster.pop("error",t),!1}return!0}readFile(e){const t=new FileReader;t.onload=e=>{const t=e.target&&e.target.result||"";if(t&&"string"==typeof t)this.onUploaded.emit(t);else{const e=this.translateService.instant("SHARED_MODULES.BTN_UPLOAD_FILE_CONTENT.EMPTY_FILE_ERROR_MSG");this.toaster.pop("error",e)}},t.readAsText(e),this.clearInput()}clearInput(){try{this.inputEl.nativeElement.value=""}catch(e){}}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(r.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["btn-upload-file-content"]],viewQuery:function(e,t){var n;1&e&&s.gd(md,!0),2&e&&s.Kc(n=s.kc())&&(t.inputEl=n.first)},inputs:{disabled:"disabled",accept:"accept",acceptExtensions:"acceptExtensions"},outputs:{onUploaded:"onUploaded"},decls:5,vars:8,consts:[[1,"cl-btn","cl-btn-outline-light","cl-btn-primary","cl-color-gray",3,"for"],["type","file","tabindex","0",1,"pointer",2,"width","0",3,"id","disabled","name","accept","change"],["fileInput",""]],template:function(e,t){1&e&&(s.Xb(0,"label",0),s.Zc(1),s.oc(2,"translate"),s.Wb(),s.Xb(3,"input",1,2),s.jc("change",(function(){return t.uploadFile()})),s.Wb()),2&e&&(s.xc("for",t.uid),s.Cb(1),s.bd(" ",s.pc(2,6,"SHARED_MODULES.BTN_UPLOAD_FILE.CHOOSE_FILE_TEXT"),"\n"),s.Cb(2),s.xc("id",t.uid),s.xc("name",t.uid),s.wc("disabled",t.disabled)("accept",t.acceptExtensions))},pipes:[g.e],encapsulation:2}),e})();function Ed(e,t){1&e&&(s.Xb(0,"small",20),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SAML2.PARTY_IDENTIFIER.ENTER")," "))}function fd(e,t){if(1&e&&(s.Xb(0,"div",1),s.Xb(1,"label",21),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"span",3),s.Zc(5,"*"),s.Wb(),s.Wb(),s.Sb(6,"input",22),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,4,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SAML2.METADATA.LABEL")),s.Cb(4),s.Hb("cl-border-danger",e.isValid("metadataUrl")),s.wc("readonly",e.isReadonly)}}function Sd(e,t){1&e&&(s.Xb(0,"small",20),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SAML2.METADATA.ENTER")," "))}function Cd(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",30,31),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1);return s.nc(2).onUploadedFile("","metadataUrl"),t.blur()}))("keyup.enter",(function(){return s.Oc(e),s.nc(2).onUploadedFile("","metadataUrl")}))("keyup.space",(function(){return s.Oc(e),s.nc(2).onUploadedFile("","metadataUrl")})),s.Zc(2),s.oc(3,"translate"),s.Wb()}2&e&&(s.Cb(2),s.ad(s.pc(3,1,"GLOBAL.REMOVE_LABEL")))}function Ad(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",23),s.Xb(1,"div",1),s.Xb(2,"label",21),s.Zc(3),s.oc(4,"translate"),s.Xb(5,"span",3),s.Zc(6,"*"),s.Wb(),s.Wb(),s.Sb(7,"input",22),s.Xc(8,Sd,3,3,"small",5),s.Wb(),s.Xb(9,"div",1),s.Xb(10,"div",24),s.Xb(11,"span"),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(14,"div",25),s.Xb(15,"label"),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Xb(18,"div",26),s.Xb(19,"div",27),s.Xb(20,"btn-upload-file",28),s.jc("onUploaded",(function(t){return s.Oc(e),s.nc().onUploadedFile(t,"metadataUrl")})),s.Wb(),s.Wb(),s.Xc(21,Cd,4,3,"a",29),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.ad(s.pc(4,11,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SAML2.METADATA.LABEL")),s.Cb(4),s.Hb("cl-border-danger",e.isValid("metadataUrl")),s.wc("readonly",e.isReadonly),s.Cb(1),s.wc("ngIf",e.isValid("metadataUrl")),s.Cb(4),s.ad(s.pc(13,13,"GLOBAL.OR_LABEL")),s.Cb(4),s.ad(s.pc(17,15,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SAML2.XML_FILE.UPLOAD")),s.Cb(4),s.wc("text","SHARED_MODULES.BTN_UPLOAD_FILE.CHOOSE_FILE_TEXT")("accept","text/xml")("btnClasses","cl-btn cl-btn-outline-light cl-btn-primary cl-color-gray"),s.Cb(1),s.wc("ngIf",e.form.get("metadataUrl").value)}}function Od(e,t){1&e&&(s.Xb(0,"small",20),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SAML2.URL.LOGIN.ENTER")," "))}function vd(e,t){1&e&&(s.Xb(0,"small",20),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SAML2.URL.LOGOUT.ENTER")," "))}function Td(e,t){if(1&e&&(s.Xb(0,"div",1),s.Xb(1,"label",32),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"textarea",33),s.Zc(5,"            "),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,4,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SAML2.CERTIFICATE.LABEL")),s.Cb(2),s.Hb("cl-border-danger",e.isValid("certificates")),s.wc("readonly",e.isReadonly)}}function Id(e,t){1&e&&(s.Xb(0,"small",20),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SAML2.CERTIFICATE.ENTER")," "))}function wd(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",30,41),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1);return s.nc(3).onUploadedFile("","certificates"),t.blur()}))("keyup.enter",(function(){return s.Oc(e),s.nc(3).onUploadedFile("","certificates")}))("keyup.space",(function(){return s.Oc(e),s.nc(3).onUploadedFile("","certificates")})),s.Zc(2),s.oc(3,"translate"),s.Wb()}2&e&&(s.Cb(2),s.ad(s.pc(3,1,"GLOBAL.REMOVE_LABEL")))}const Ld=function(){return["application/x-x509-ca-cert"]};function Rd(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",23),s.Xb(1,"div",1),s.Xb(2,"label",32),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"textarea",39),s.Zc(6,"                    "),s.Wb(),s.Xc(7,Id,3,3,"small",5),s.Wb(),s.Xb(8,"div",1),s.Xb(9,"div",24),s.Xb(10,"span"),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(13,"div",25),s.Xb(14,"label"),s.Zc(15),s.oc(16,"translate"),s.Wb(),s.Xb(17,"div",26),s.Xb(18,"div",27),s.Xb(19,"btn-upload-file-content",40),s.jc("onUploaded",(function(t){return s.Oc(e),s.nc(2).onUploadedFile(t,"certificates")})),s.Wb(),s.Wb(),s.Xc(20,wd,4,3,"a",29),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(3),s.ad(s.pc(4,10,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SAML2.CERTIFICATE.LABEL")),s.Cb(2),s.Hb("cl-border-danger",e.isValid("certificates")),s.wc("readonly",e.isReadonly),s.Cb(2),s.wc("ngIf",e.isValid("certificates")),s.Cb(4),s.ad(s.pc(12,12,"GLOBAL.OR_LABEL")),s.Cb(4),s.ad(s.pc(16,14,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SAML2.CERTIFICATE.UPLOAD")),s.Cb(4),s.wc("accept",s.Ac(16,Ld))("acceptExtensions",".pem, .cer, .crt, .der"),s.Cb(1),s.wc("ngIf",e.form.get("certificates").value)}}function yd(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"div",34),s.Xb(2,"a",35),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.isExpanded=!t.isExpanded})),s.Xb(3,"span",36),s.Sb(4,"img",37),s.Wb(),s.Wb(),s.Xb(5,"span",38),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.isExpanded=!t.isExpanded})),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xc(8,Rd,21,17,"div",7),s.Wb()}if(2&e){const e=s.nc();s.Cb(4),s.wc("src",e.isExpanded?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",s.Qc),s.Cb(2),s.ad(s.pc(7,3,"WORKSPACE.CONFIGURATION.ADVANCED")),s.Cb(2),s.wc("ngIf",e.isExpanded)}}function _d(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",42),s.Xb(1,"a",43),s.jc("click",(function(){return s.Oc(e),s.nc().onClose.emit()})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",44),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,3,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",e.form.invalid||e.inProgress),s.Cb(1),s.bd(" ",s.pc(6,5,"WORKSPACE.CONFIGURATION.FINISH")," ")}}let kd=(()=>{class e{constructor(e,t){this.formBuilder=e,this.copyService=t,this.isModal=!0,this.isReadonly=!1,this.onClose=new s.n,this.onSubmit=new s.n,this.unsubscribe$=new p.a}set configuration(e){e&&this.initConfig(e)}ngOnInit(){this.form||this.initConfig(new Ob)}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}onUploadedFile(e,t){this.form.patchValue({[t]:e})}initConfig(e){var t,n,i;const s=e.certificates?e.certificates[0]:"";let c;c=(null===(n=null===(t=bo.a.environment)||void 0===t?void 0:t.endpoint)||void 0===n?void 0:n.startsWith("http"))?null===(i=bo.a.environment)||void 0===i?void 0:i.endpoint:`${window.location.protocol}//${window.location.host}/api`,this.form=this.formBuilder.group({relyingPartyIdentifier:[e.relyingPartyIdentifier,[Bi.a.required]],assertionConsumerServiceUrl:[e.assertionConsumerServiceUrl||c+"/auth/saml2",[Bi.a.required]],metadataUrl:[e.metadataUrl,[Bi.a.required]],logoutUrl:[e.logoutUrl,[]],loginUrl:[e.loginUrl,[Bi.a.required]],certificates:[s,[]]})}submit(){if(this.inProgress)return;const e=Object.assign({},this.form.value);e.certificates=[e.certificates?e.certificates.trim():""],Object.keys(e).map(t=>e[t]="string"==typeof e[t]?e[t].trim():e[t]);const t=new Ob(e);this.onSubmit.emit(t)}isValid(e){const t=this.form.get(e);return!!t&&t.dirty&&t.touched&&!!t.errors}copyToClipboard(e){this.copyService.copyToClipboard(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(v.f),s.Rb(ie.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["form-saml2"]],inputs:{configuration:"configuration",inProgress:"inProgress",isModal:"isModal",isReadonly:"isReadonly"},outputs:{onClose:"onClose",onSubmit:"onSubmit"},decls:39,vars:35,consts:[[3,"formGroup","ngSubmit"],[1,"cl-form-group"],["for","relyingPartyIdentifier"],[1,"cl-text-danger","cl-ml-1"],["type","text","ngbAutofocus","","id","relyingPartyIdentifier","formControlName","relyingPartyIdentifier","autocomplete","off",1,"cl-form-control",3,"readonly"],["class","cl-form-text cl-text-danger",4,"ngIf"],["class","cl-form-group",4,"ngIf"],["class","cl-rounded cl-form-group cl-p-3 cl-border",4,"ngIf"],["for","loginUrl"],["type","text","id","loginUrl","formControlName","loginUrl","autocomplete","off",1,"cl-form-control",3,"readonly"],["for","logoutUrl"],["type","text","id","logoutUrl","formControlName","logoutUrl","autocomplete","off",1,"cl-form-control",3,"readonly"],[1,"cl-input-group","cl-mb-3"],[1,"cl-w-100"],["type","text","readonly","","formControlName","assertionConsumerServiceUrl",1,"cl-form-control"],["redirectUrlInput",""],[1,"cl-input-group-append"],["type","button",1,"cl-btn","cl-btn-outline-light",3,"click"],[4,"ngIf"],["class","modal-footer",4,"ngIf"],[1,"cl-form-text","cl-text-danger"],["for","metadataUrl"],["type","text","id","metadataUrl","formControlName","metadataUrl","autocomplete","off",1,"cl-form-control",3,"readonly"],[1,"cl-rounded","cl-form-group","cl-p-3","cl-border"],[1,"cl-or-divider"],[1,"cl-form-group","cl-mb-0"],[1,"cl-upload-file-wrapper"],[1,"cl-upload-btn-wrapper","cl-mr-3"],[3,"text","accept","btnClasses","onUploaded"],["tabindex","0","class","cl-color-blue",3,"click","keyup.enter","keyup.space",4,"ngIf"],["tabindex","0",1,"cl-color-blue",3,"click","keyup.enter","keyup.space"],["metadataUrlBtn",""],["for","certificates"],["formControlName","certificates","autocomplete","off","id","certificates","rows","3",1,"cl-form-control",3,"readonly"],[1,"cl-h2","cl-mb-0","cl-d-flex","cl-align-items-center"],[1,"cl-mr-2",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"],[1,"pointer",3,"click"],["formControlName","certificates","autocomplete","off","id","certificates","rows","5",1,"cl-form-control",3,"readonly"],[3,"accept","acceptExtensions","onUploaded"],["certificatesBtn",""],[1,"modal-footer"],["tabindex","0",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"form",0),s.jc("ngSubmit",(function(){return t.submit()})),s.Xb(1,"div"),s.Xb(2,"div",1),s.Xb(3,"label",2),s.Zc(4),s.oc(5,"translate"),s.Xb(6,"span",3),s.Zc(7,"*"),s.Wb(),s.Wb(),s.Sb(8,"input",4),s.Xc(9,Ed,3,3,"small",5),s.Wb(),s.Xc(10,fd,7,6,"div",6),s.Xc(11,Ad,22,17,"div",7),s.Xb(12,"div",1),s.Xb(13,"label",8),s.Zc(14),s.oc(15,"translate"),s.Xb(16,"span",3),s.Zc(17,"*"),s.Wb(),s.Wb(),s.Sb(18,"input",9),s.Xc(19,Od,3,3,"small",5),s.Wb(),s.Xb(20,"div",1),s.Xb(21,"label",10),s.Zc(22),s.oc(23,"translate"),s.Wb(),s.Sb(24,"input",11),s.Xc(25,vd,3,3,"small",5),s.Wb(),s.Xb(26,"div",12),s.Xb(27,"label",13),s.Zc(28),s.oc(29,"translate"),s.Wb(),s.Sb(30,"input",14,15),s.Xb(32,"div",16),s.Xb(33,"button",17),s.jc("click",(function(){s.Oc(e);const n=s.Lc(31);return t.copyToClipboard(n)})),s.Zc(34),s.oc(35,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xc(36,Td,6,6,"div",6),s.Xc(37,yd,9,5,"div",18),s.Wb(),s.Xc(38,_d,7,7,"div",19),s.Wb()}2&e&&(s.wc("formGroup",t.form),s.Cb(1),s.Hb("modal-body",t.isModal),s.Cb(3),s.ad(s.pc(5,25,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SAML2.PARTY_IDENTIFIER.LABEL")),s.Cb(4),s.Hb("cl-border-danger",t.isValid("relyingPartyIdentifier")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("relyingPartyIdentifier")),s.Cb(1),s.wc("ngIf",!t.isModal),s.Cb(1),s.wc("ngIf",t.isModal),s.Cb(3),s.ad(s.pc(15,27,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SAML2.URL.LOGIN.LABEL")),s.Cb(4),s.Hb("cl-border-danger",t.isValid("loginUrl")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("loginUrl")),s.Cb(3),s.ad(s.pc(23,29,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SAML2.URL.LOGOUT.LABEL")),s.Cb(2),s.Hb("cl-border-danger",t.isValid("logoutUrl")),s.wc("readonly",t.isReadonly),s.Cb(1),s.wc("ngIf",t.isValid("logoutUrl")),s.Cb(3),s.ad(s.pc(29,31,"WORKSPACE.CONFIGURATION.AUTHENTICATION.SAML2.URL.REPLY")),s.Cb(6),s.ad(s.pc(35,33,"GLOBAL.COPY_LABEL")),s.Cb(2),s.wc("ngIf",!t.isModal),s.Cb(1),s.wc("ngIf",t.isModal),s.Cb(1),s.wc("ngIf",t.isModal))},directives:[v.I,v.t,v.k,v.c,v.s,v.i,i.u,fo.a,gd],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var Wd=n("AHy6"),Xd=n("kojQ");function Nd(e,t){1&e&&(s.Xb(0,"span",14),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.INACTIVE_LABEL")," "))}function Dd(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",15),s.Xb(1,"div",16),s.Xb(2,"a",17),s.jc("click",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(16);return t.openModal(n)})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"a",18),s.jc("click",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(18);return t.openModal(n)})),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(3),s.ad(s.pc(4,2,"WORKSPACE.CONFIGURATION.EDIT")),s.Cb(3),s.ad(s.pc(7,4,"GLOBAL.DELETE_BTN")))}function Pd(e,t){if(1&e&&s.Sb(0,"form-ldap",21),2&e){const e=s.nc(2);s.wc("isReadonly",!0)("isModal",!1)("configuration",e.configuration)}}function Md(e,t){if(1&e&&s.Sb(0,"form-oauth",21),2&e){const e=s.nc(2);s.wc("isReadonly",!0)("isModal",!1)("configuration",e.configuration)}}function Bd(e,t){if(1&e&&s.Sb(0,"form-saml2",21),2&e){const e=s.nc(2);s.wc("isReadonly",!0)("isModal",!1)("configuration",e.configuration)}}function Ud(e,t){if(1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",19),s.Xc(2,Pd,1,3,"form-ldap",20),s.Xc(3,Md,1,3,"form-oauth",20),s.Xc(4,Bd,1,3,"form-saml2",20),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.wc("ngIf",e.type===e.authTypes.LDAP),s.Cb(1),s.wc("ngIf",e.type===e.authTypes.OAUTH2),s.Cb(1),s.wc("ngIf",e.type===e.authTypes.SAML2)}}function Gd(e,t){if(1&e){const e=s.Yb();s.Xb(0,"form-ldap",24),s.jc("onSubmit",(function(t){s.Oc(e);const n=s.nc().$implicit;return s.nc().editConfiguration(t,n)}))("onClose",(function(){return s.Oc(e),s.nc().$implicit.close()})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("configuration",e.configuration)("inProgress",e.inProgress)}}function xd(e,t){if(1&e){const e=s.Yb();s.Xb(0,"form-oauth",24),s.jc("onSubmit",(function(t){s.Oc(e);const n=s.nc().$implicit;return s.nc().editConfiguration(t,n)}))("onClose",(function(){return s.Oc(e),s.nc().$implicit.close()})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("configuration",e.configuration)("inProgress",e.inProgress)}}function Fd(e,t){if(1&e){const e=s.Yb();s.Xb(0,"form-saml2",24),s.jc("onSubmit",(function(t){s.Oc(e);const n=s.nc().$implicit;return s.nc().editConfiguration(t,n)}))("onClose",(function(){return s.Oc(e),s.nc().$implicit.close()})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("configuration",e.configuration)("inProgress",e.inProgress)}}const jd=function(e){return{authType:e}};function Zd(e,t){if(1&e&&(s.Xb(0,"modal-header",22),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xc(2,Gd,1,2,"form-ldap",23),s.Xc(3,xd,1,2,"form-oauth",23),s.Xc(4,Fd,1,2,"form-saml2",23)),2&e){const e=s.nc();s.wc("title",s.qc(1,4,"WORKSPACE.CREATE_CONFIGURATION_MODAL.AUTH_TYPE_LABEL",s.Bc(7,jd,e.label))),s.Cb(2),s.wc("ngIf",e.type===e.authTypes.LDAP),s.Cb(1),s.wc("ngIf",e.type===e.authTypes.OAUTH2),s.Cb(1),s.wc("ngIf",e.type===e.authTypes.SAML2)}}const Vd=function(e){return{label:e}};function Yd(e,t){if(1&e){const e=s.Yb();s.Xb(0,"delete-confirm-modal",25),s.jc("onClose",(function(){return t.$implicit.close()}))("onDelete",(function(){s.Oc(e);const n=t.$implicit;return s.nc().deleteConfirmed(n)})),s.oc(1,"translate"),s.Xb(2,"p"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("inProgress",e.inProgress)("title",s.pc(1,3,"WORKSPACE.CONFIGURATION.DELETE.TITLE")),s.Cb(3),s.bd("",s.qc(4,5,"WORKSPACE.CONFIGURATION.DELETE.CONFIRM_MESSAGE",s.Bc(8,Vd,e.labelValue))," ")}}let Hd=(()=>{class e{constructor(e,t,n){this.modalService=e,this.authSSOService=t,this.cd=n,this.onDelete=new s.n,this.unsubscribe$=new p.a,this.isExpanded=!0,this.authTypes=Cb}ngOnInit(){try{this.label=wb.filter(e=>e.value===this.type)[0].label,this.labelValue=this.label}catch(e){}}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}toggle(){this.isExpanded=!this.isExpanded}openModal(e){this.modalService.open(e,{centered:!0})}editConfiguration(e,t){this.inProgress=!0,this.authSSOService.patchConfiguration(e,this.type).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.configuration=e,this.inProgress=!1,t.close(),this.cd.detectChanges()},()=>{this.inProgress=!1,this.cd.detectChanges()})}deleteConfirmed(e){this.inProgress=!0,this.authSSOService.deleteConfiguration(this.type).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.onDelete.emit(this.type),this.inProgress=!1,e.close()},()=>{this.inProgress=!1,this.cd.detectChanges()})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q),s.Rb(Ib),s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["config-row"]],inputs:{configuration:"configuration",active:"active",type:"type"},outputs:{onDelete:"onDelete"},decls:19,vars:7,consts:[[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-12","cl-relative"],[1,"cl-h2","cl-mb-0","cl-d-flex","cl-align-items-center"],[1,"cl-mr-2",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"],["class","cl-badge cl-badge-dark cl-ml-2 cl-text-uppercase",4,"ngIf"],["dropdownKey","",1,"cl-dropdown","cl-absolute","cl-t-0","cl-r-0"],["dropdownKeyButton","",1,"cl-btn","cl-btn-primary","cl-btn-fixed-40","cl-dropdown-toggle","cl-no-arrow"],["src","assets/images/ui-icons/menu-dots-vertical-white.svg"],["class","cl-dropdown-menu cl-dropdown-menu-right","openUpAtBottom","",4,"dropdownKeyContent"],["class","cl-form-row",4,"ngIf"],["editSSOModal",""],["deleteModal",""],[1,"cl-badge","cl-badge-dark","cl-ml-2","cl-text-uppercase"],["openUpAtBottom","",1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-scroll-area"],[1,"cl-dropdown-item",3,"click"],[1,"cl-dropdown-item","cl-text-danger",3,"click"],[1,"cl-form-group","cl-col-md-12","cl-col-lg-10","cl-col-lg-custom-6"],[3,"isReadonly","isModal","configuration",4,"ngIf"],[3,"isReadonly","isModal","configuration"],[3,"title","onClose"],[3,"configuration","inProgress","onSubmit","onClose",4,"ngIf"],[3,"configuration","inProgress","onSubmit","onClose"],[3,"inProgress","title","onClose","onDelete"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"a",3),s.jc("click",(function(){return t.toggle()})),s.Xb(4,"span",4),s.Sb(5,"img",5),s.Wb(),s.Wb(),s.Xb(6,"span"),s.Zc(7),s.oc(8,"translate"),s.Xc(9,Nd,3,3,"span",6),s.Wb(),s.Wb(),s.Xb(10,"div",7),s.Xb(11,"a",8),s.Sb(12,"img",9),s.Wb(),s.Xc(13,Dd,8,6,"div",10),s.Wb(),s.Wb(),s.Wb(),s.Xc(14,Ud,5,3,"div",11),s.Xc(15,Zd,5,9,"ng-template",null,12,s.Yc),s.Xc(17,Yd,5,10,"ng-template",null,13,s.Yc)),2&e&&(s.Cb(5),s.wc("src",t.isExpanded?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",s.Qc),s.Cb(2),s.cd(" ",t.label," ",s.pc(8,5,"WORKSPACE.CONFIGURATION.LABEL")," "),s.Cb(2),s.wc("ngIf",!t.active),s.Cb(5),s.wc("ngIf",t.isExpanded))},directives:[i.u,ni.a,ii.a,si.a,qb,pd,kd,Wd.a,Xd.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function $d(e,t){if(1&e){const e=s.Yb();s.Xb(0,"domain-input",6),s.jc("onEnter",(function(){return s.Oc(e),s.nc().rename()}))("onAvailableName",(function(t){return s.Oc(e),s.nc().availabilityChanged(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("autofocus",!0)("name",e.subdomain.domainName)}}function Kd(e,t){1&e&&(s.Xb(0,"div",7),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.SUBDOMAIN.CHANGE.CONFIRM_MESSAGE")," "))}let qd=(()=>{class e{constructor(e,t,n){this.authSSOService=e,this.subdomainService=t,this.translateService=n,this.onClose=new s.n,this.onRenamed=new s.n,this.unsubscribe$=new p.a,this.isConfirmed=!1}get btnLabel(){return this.translateService.instant(this.isConfirmed&&this.isSubdomain?"WORKSPACE.RENAME_DOMAIN.CHANGE_AND_MOVE_BTN":"GLOBAL.CHANGE_LABEL")}get isDisabled(){return!this.availableName||this.inProgress}ngOnInit(){this.isSubdomain=this.subdomainService.isSubdomainNotSelfhosted()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}availabilityChanged(e){this.availableName=e}rename(){this.isDisabled||(this.isConfirmed?(this.inProgress=!0,this.authSSOService.editDomainData({domainName:this.availableName}).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.onRenamed.emit(e)},()=>{this.inProgress=!1})):this.isConfirmed=!0)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Ib),s.Rb(Lb.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["rename-domain"]],inputs:{subdomain:"subdomain"},outputs:{onClose:"onClose",onRenamed:"onRenamed"},decls:10,vars:7,consts:[[1,"cl-modal-body"],[3,"autofocus","name","onEnter","onAvailableName",4,"ngIf","ngIfElse"],["confirmTemplate",""],[1,"cl-modal-footer"],[3,"click"],["type","button",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[3,"autofocus","name","onEnter","onAvailableName"],[1,"cl-form-group"]],template:function(e,t){if(1&e&&(s.Xb(0,"div",0),s.Xc(1,$d,1,2,"domain-input",1),s.Xc(2,Kd,3,3,"ng-template",null,2,s.Yc),s.Wb(),s.Xb(4,"div",3),s.Xb(5,"a",4),s.jc("click",(function(){return t.onClose.emit()})),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"button",5),s.jc("click",(function(){return t.rename()})),s.Zc(9),s.Wb(),s.Wb()),2&e){const e=s.Lc(3);s.Cb(1),s.wc("ngIf",!t.isConfirmed)("ngIfElse",e),s.Cb(5),s.ad(s.pc(7,5,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",t.isDisabled),s.Cb(1),s.bd(" ",t.btnLabel," ")}},directives:[i.u,xb],pipes:[g.e],encapsulation:2}),e})();const zd=["typesCheckbox"];function Qd(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",10),s.Xb(1,"input",11,12),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().authType=t})),s.Wb(),s.Xb(3,"label",13),s.Zc(4),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc();s.Cb(1),s.xc("value",e.value),s.yc("id","authentication-",e.value,""),s.wc("ngModel",n.authType),s.Cb(2),s.yc("for","authentication-",e.value,""),s.Cb(1),s.bd(" ",e.label," ")}}let Jd=(()=>{class e{constructor(){this.onClose=new s.n,this.onChooseType=new s.n,this.unsubscribe$=new p.a}ngOnInit(){1===this.options.length&&(this.authType=this.options[0].value)}ngAfterViewInit(){this.typesCheckbox&&this.typesCheckbox.first&&this.typesCheckbox.first.nativeElement.focus()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}next(){this.onChooseType.emit(this.authType)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["configure-sso-type"]],viewQuery:function(e,t){var n;1&e&&s.gd(zd,!0),2&e&&s.Kc(n=s.kc())&&(t.typesCheckbox=n)},inputs:{options:["availableTypes","options"]},outputs:{onClose:"onClose",onChooseType:"onChooseType"},decls:21,vars:14,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"modal-body"],[1,"cl-form-group","cl-mb-0"],["class","cl-custom-control cl-custom-radio",4,"ngFor","ngForOf"],[1,"modal-footer"],["tabindex","0",3,"click"],["type","button",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[1,"cl-custom-control","cl-custom-radio"],["type","radio","tabindex","0","name","authentication",1,"cl-custom-control-input",3,"ngModel","value","id","ngModelChange"],["typesCheckbox",""],[1,"cl-custom-control-label",3,"for"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.onClose.emit()})),s.Xb(5,"span"),s.Sb(6,"img",3),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",4),s.Xb(8,"form"),s.Xb(9,"label"),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Xb(12,"div",5),s.Xc(13,Qd,5,5,"div",6),s.Wb(),s.Wb(),s.Wb(),s.Xb(14,"div",7),s.Xb(15,"a",8),s.jc("click",(function(){return t.onClose.emit()})),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Xb(18,"button",9),s.jc("click",(function(){return t.next()})),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,6,"WORKSPACE.CONFIGURATION.AUTHENTICATION.TYPE.TITLE")),s.Cb(8),s.ad(s.pc(11,8,"WORKSPACE.CONFIGURATION.AUTHENTICATION.TYPE.SELECT")),s.Cb(3),s.wc("ngForOf",t.options),s.Cb(3),s.ad(s.pc(17,10,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",!t.authType),s.Cb(1),s.ad(s.pc(20,12,"GLOBAL.NEXT_LABEL")))},directives:[v.I,v.t,v.u,i.t,v.A,v.c,v.s,v.v],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function eu(e,t){if(1&e){const e=s.Yb();s.Xb(0,"configure-sso-type",2),s.jc("onChooseType",(function(t){return s.Oc(e),s.nc().onChooseType(t)}))("onClose",(function(){return s.Oc(e),s.nc().onClose.emit()})),s.Wb()}if(2&e){const e=s.nc();s.wc("availableTypes",e.availableTypes)}}function tu(e,t){if(1&e){const e=s.Yb();s.Xb(0,"form-saml2",5),s.jc("onSubmit",(function(t){s.Oc(e);const n=s.nc(2);return n.onSubmit(t,n.authTypes.SAML2)}))("onClose",(function(){return s.Oc(e),s.nc(2).onClose.emit()})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("inProgress",e.inProgress)}}function nu(e,t){if(1&e){const e=s.Yb();s.Xb(0,"form-oauth",5),s.jc("onSubmit",(function(t){s.Oc(e);const n=s.nc(2);return n.onSubmit(t,n.authTypes.OAUTH2)}))("onClose",(function(){return s.Oc(e),s.nc(2).onClose.emit()})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("inProgress",e.inProgress)}}function iu(e,t){if(1&e){const e=s.Yb();s.Xb(0,"form-ldap",5),s.jc("onSubmit",(function(t){s.Oc(e);const n=s.nc(2);return n.onSubmit(t,n.authTypes.LDAP)}))("onClose",(function(){return s.Oc(e),s.nc(2).onClose.emit()})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("inProgress",e.inProgress)}}function su(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"modal-header",3),s.jc("onClose",(function(){return s.Oc(e),s.nc().onClose.emit()})),s.Wb(),s.Xc(2,tu,1,1,"form-saml2",4),s.Xc(3,nu,1,1,"form-oauth",4),s.Xc(4,iu,1,1,"form-ldap",4),s.Ub()}if(2&e){const e=s.nc();s.Cb(1),s.wc("title",e.label),s.Cb(1),s.wc("ngIf",e.authType===e.authTypes.SAML2),s.Cb(1),s.wc("ngIf",e.authType===e.authTypes.OAUTH2),s.Cb(1),s.wc("ngIf",e.authType===e.authTypes.LDAP)}}let cu=(()=>{class e{constructor(e,t,n){this.authSSOService=e,this.cd=t,this.translateService=n,this.onClose=new s.n,this.onCreated=new s.n,this.unsubscribe$=new p.a,this.authTypes=Cb}ngOnInit(){}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}onChooseType(e){this.authType=e;try{const t=this.availableTypes.filter(t=>t.value===e)[0].label;this.label=this.translateService.instant("WORKSPACE.CREATE_CONFIGURATION_MODAL.AUTH_TYPE_LABEL",{authType:t})}catch(t){this.label=this.translateService.instant("WORKSPACE.SHARED.AUTH_LABEL")}}onSubmit(e,t){this.inProgress||(this.inProgress=!0,this.authSSOService.patchConfiguration(e,t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.onCreated.emit(e),this.inProgress=!1},()=>{this.inProgress=!1,this.cd.detectChanges()}))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Ib),s.Rb(s.h),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["create-configuration-modal"]],inputs:{availableTypes:"availableTypes"},outputs:{onClose:"onClose",onCreated:"onCreated"},decls:2,vars:2,consts:[[3,"availableTypes","onChooseType","onClose",4,"ngIf"],[4,"ngIf"],[3,"availableTypes","onChooseType","onClose"],[3,"title","onClose"],[3,"inProgress","onSubmit","onClose",4,"ngIf"],[3,"inProgress","onSubmit","onClose"]],template:function(e,t){1&e&&(s.Xc(0,eu,1,1,"configure-sso-type",0),s.Xc(1,su,5,4,"ng-container",1)),2&e&&(s.wc("ngIf",!t.authType),s.Cb(1),s.wc("ngIf",t.authType))},directives:[i.u,Jd,Wd.a,kd,pd,qb],encapsulation:2,changeDetection:0}),e})();const au=function(e){return{min:e}};function ou(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.qc(2,1,"SHARED_MODULES.SET_PASSWORD.PASS_MIN_INFO",s.Bc(4,au,e.minLength))," ")}}function ru(e,t){if(1&e&&(s.Xb(0,"div",9),s.Xc(1,ou,3,6,"ng-container",10),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.password.errors.required||e.password.errors.minlength)}}function lu(e,t){1&e&&(s.Xb(0,"div",9),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.PASSWORD_MATCH_ERROR_MSG")," "))}let bu=(()=>{class e{constructor(e,t){this.formBuilder=e,this.authService=t,this.unsubscribe$=new p.a,this.onClose=new s.n,this.onSetPassword=new s.n}ngOnInit(){this.minLength=In.s,this.maxLength=In.r,this.setPasswordForm=this.formBuilder.group({password:["",[v.G.required,v.G.minLength(this.minLength),v.G.maxLength(this.maxLength)]],passwordRepeated:["",[v.G.required]]},{validator:Object(sn.B)("password","passwordRepeated")})}get password(){return this.setPasswordForm.get("password")}get passwordRepeated(){return this.setPasswordForm.get("passwordRepeated")}get isPasswordInvalid(){return this.password.dirty&&this.password.touched&&!!this.password.errors}get isPasswordRepeatedInvalid(){return this.passwordRepeated.dirty&&this.passwordRepeated.touched&&!!this.passwordRepeated.errors}onSubmit(){this.setPasswordForm.invalid||(this.inProgress=!0,this.authService.setPassword(this.password.value,this.passwordRepeated.value).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>this.onSetPassword.emit(!0),()=>this.closeModal()))}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}closeModal(){this.onClose.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(v.f),s.Rb(re.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["set-password"]],outputs:{onClose:"onClose",onSetPassword:"onSetPassword"},decls:21,vars:20,consts:[["novalidate","",3,"formGroup","ngSubmit"],[1,"cl-modal-body"],[1,"cl-form-group"],["formControlName","password","type","password","ngbAutofocus","","autocomplete","new-password",1,"cl-form-control"],["class","cl-invalid-feedback",4,"ngIf"],["type","password","autocomplete","new-password","formControlName","passwordRepeated",1,"cl-form-control"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"click","keyup.enter"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"],[1,"cl-invalid-feedback"],[4,"ngIf"]],template:function(e,t){1&e&&(s.Xb(0,"form",0),s.jc("ngSubmit",(function(){return t.onSubmit()})),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"label"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Sb(6,"input",3),s.Xc(7,ru,2,1,"div",4),s.Wb(),s.Xb(8,"div",2),s.Xb(9,"label"),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Sb(12,"input",5),s.Xc(13,lu,3,3,"div",4),s.Wb(),s.Wb(),s.Xb(14,"div",6),s.Xb(15,"a",7),s.jc("click",(function(){return t.closeModal()}))("keyup.enter",(function(){return t.closeModal()})),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Xb(18,"button",8),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.wc("formGroup",t.setPasswordForm),s.Cb(4),s.ad(s.pc(5,12,"GLOBAL.PASSWORD_LABEL")),s.Cb(2),s.Hb("cl-is-invalid",t.isPasswordInvalid),s.Cb(1),s.wc("ngIf",t.isPasswordInvalid),s.Cb(3),s.ad(s.pc(11,14,"SHARED_MODULES.SET_PASSWORD.RETYPE_PASS_LABEL")),s.Cb(2),s.Hb("cl-is-invalid",t.isPasswordRepeatedInvalid),s.Cb(1),s.wc("ngIf",t.isPasswordRepeatedInvalid),s.Cb(3),s.bd(" ",s.pc(17,16,"GLOBAL.CANCEL_BTN")," "),s.Cb(2),s.wc("disabled",t.inProgress||t.setPasswordForm.invalid),s.Cb(1),s.ad(s.pc(20,18,"GLOBAL.SAVE_LABEL")))},directives:[v.I,v.t,v.k,v.c,v.s,v.i,i.u],pipes:[g.e],encapsulation:2}),e})();function du(e,t){1&e&&(s.Xb(0,"div",44),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.MANAGE.OWNER.ERROR_MESSAGE")," "))}const uu=function(){return["/upgrade"]},pu=function(){return{plan:"enterprise"}};function hu(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",44),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",45),s.jc("click",(function(){return s.Oc(e),s.nc().addAnalyticsEvent()})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,4,"WORKSPACE.FEATURE.TYPES.ENTERPRISE")," "),s.Cb(2),s.wc("routerLink",s.Ac(8,uu))("queryParams",s.Ac(9,pu)),s.Cb(1),s.ad(s.pc(6,6,"GLOBAL.UPGRADE_BTN")))}function mu(e,t){1&e&&s.Sb(0,"div",46)}function gu(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",44),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",47),s.jc("click",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(93);return t.openModal(n)})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,2,"WORKSPACE.SUBDOMAIN.CREATE.ERROR_MESSAGE")," "),s.Cb(3),s.ad(s.pc(6,4,"GLOBAL.SET_TITLE")))}function Eu(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",52),s.Xb(1,"div",53),s.Xb(2,"a",54,55),s.jc("keyup.enter",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(87);return t.openModal(n)}))("keyup.space",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(87);return t.openModal(n)}))("click",(function(){s.Oc(e);const t=s.Lc(3),n=s.nc(2),i=s.Lc(87);return t.blur(),n.openModal(i)})),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Sb(6,"div",56),s.Xb(7,"a",57,58),s.jc("keyup.enter",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(89);return t.openModal(n)}))("keyup.space",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(89);return t.openModal(n)}))("click",(function(){s.Oc(e);const t=s.Lc(8),n=s.nc(2),i=s.Lc(89);return t.blur(),n.openModal(i)})),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(4),s.bd(" ",s.pc(5,2,"WORKSPACE.SUBDOMAIN.CHANGE.TITLE"),""),s.Cb(5),s.ad(s.pc(10,4,"GLOBAL.DELETE_BTN")))}function fu(e,t){1&e&&(s.Xb(0,"div",48),s.Xb(1,"a",49),s.Sb(2,"img",50),s.Wb(),s.Xc(3,Eu,11,6,"div",51),s.Wb())}function Su(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",59,60),s.jc("keyup.enter",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(85);return t.openModal(n)}))("keyup.space",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(85);return t.openModal(n)}))("click",(function(){s.Oc(e);const t=s.Lc(1),n=s.nc(),i=s.Lc(85);return t.blur(),n.openModal(i)})),s.Zc(2),s.oc(3,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("disabled",e.isCreateDisabled),s.Cb(2),s.bd(" ",s.pc(3,2,"WORKSPACE.SUBDOMAIN.CREATE.TITLE")," ")}}function Cu(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",61),s.jc("keyup.enter",(function(){return s.Oc(e),s.nc().moveToSubdomain()}))("keyup.space",(function(){return s.Oc(e),s.nc().moveToSubdomain()}))("click",(function(){return s.Oc(e),s.nc().moveToSubdomain()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.SUBDOMAIN.MOVE.TITLE")," "))}function Au(e,t){if(1&e&&(s.Xb(0,"div",62),s.Sb(1,"img",63),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("src",e.subdomain.logoURL,s.Qc)}}function Ou(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",64),s.jc("click",(function(){return s.Oc(e),s.nc().setLogo()}))("keyup.enter",(function(){return s.Oc(e),s.nc().setLogo()}))("keyup.space",(function(){return s.Oc(e),s.nc().setLogo()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.REMOVE_IMAGE_LABEL")," "))}function vu(e,t){1&e&&(s.Xb(0,"div",5),s.Xb(1,"div",6),s.Xb(2,"div",67),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"div",8),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.ad(s.pc(4,2,"WORKSPACE.CONFIGURATION.AUTHENTICATION.TYPE.CONFIGURE")),s.Cb(3),s.bd(" ",s.pc(7,4,"WORKSPACE.CONFIGURATION.AUTHENTICATION.TYPE.SUPPORTED_SSO")," "))}function Tu(e,t){if(1&e){const e=s.Yb();s.Xb(0,"config-row",68),s.jc("onDelete",(function(){s.Oc(e);const n=t.$implicit;return s.nc(2).onDeletedConfiguration(n)})),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc(2);s.wc("type",e)("active",n.isConfigActive(e))("configuration",n.configurations[e])}}function Iu(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",44),s.Xb(1,"button",69,70),s.jc("click",(function(){s.Oc(e);const t=s.Lc(2),n=s.nc(2),i=s.Lc(91);return t.blur(),n.openModal(i)}))("keyup.enter",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(91);return t.openModal(n)}))("keyup.space",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(91);return t.openModal(n)})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()}2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"WORKSPACE.CONFIGURATION.AUTHENTICATION.TYPE.ADD")," "))}function wu(e,t){if(1&e&&(s.Vb(0),s.Sb(1,"hr",22),s.Xc(2,vu,8,6,"div",65),s.Xc(3,Tu,1,3,"config-row",66),s.Xc(4,Iu,5,3,"div",0),s.Ub()),2&e){const e=s.nc();s.Cb(2),s.wc("ngIf",!(null!=e.configurations&&e.configurations.length)),s.Cb(1),s.wc("ngForOf",e.objectKeys(e.configurations)),s.Cb(1),s.wc("ngIf",e.availableConfigurations.length)}}function Lu(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",71),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().createSubdomain(n)}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p"),s.Zc(4),s.oc(5,"translate"),s.Xb(6,"span"),s.Zc(7),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,5,"WORKSPACE.SUBDOMAIN.CREATE.TITLE"))("btnText",s.pc(2,7,"GLOBAL.CREATE_LABEL"))("inProgress",e.creatingInprogress),s.Cb(4),s.bd(" ",s.pc(5,9,"WORKSPACE.SUBDOMAIN.CREATE.CONFIRM_MESSAGE")," "),s.Cb(3),s.ad(e.subdomainUrl)}}function Ru(e,t){if(1&e){const e=s.Yb();s.Xb(0,"modal-header",72),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"rename-domain",73),s.jc("onRenamed",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().onRenamed(n),i.close()}))("onClose",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,2,"WORKSPACE.SUBDOMAIN.CHANGE.TITLE")),s.Cb(2),s.wc("subdomain",e.subdomain)}}function yu(e,t){if(1&e){const e=s.Yb();s.Xb(0,"delete-confirm-modal",74),s.jc("onClose",(function(n){return s.Oc(e),t.$implicit.close(n)}))("onDelete",(function(){s.Oc(e);const n=t.$implicit;return s.nc().deleteSubdomainConfirmed(n)})),s.oc(1,"translate"),s.Xb(2,"p"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("inProgress",e.deletingInProgress)("title",s.pc(1,3,"WORKSPACE.SUBDOMAIN.DELETE.TITLE")),s.Cb(3),s.bd(" ",s.pc(4,5,"WORKSPACE.SUBDOMAIN.DELETE.MESSAGE")," ")}}function _u(e,t){if(1&e){const e=s.Yb();s.Xb(0,"create-configuration-modal",75),s.jc("onCreated",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().onCreateSSOConfig(n),i.close()}))("onClose",(function(){return t.$implicit.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("availableTypes",e.availableConfigurations)}}function ku(e,t){if(1&e){const e=s.Yb();s.Xb(0,"modal-header",72),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"set-password",76),s.jc("onClose",(function(){return t.$implicit.close()}))("onSetPassword",(function(){s.Oc(e);const n=t.$implicit;return s.nc().onSetPassword(),n.close()})),s.Wb()}2&e&&s.wc("title",s.pc(1,1,"GLOBAL.SET_TITLE"))}let Wu=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r){this.modalService=e,this.authSSOService=t,this.authService=n,this.subdomainService=i,this.subdomainNameService=s,this.loader=c,this.cd=a,this.translateService=o,this.analyticsService=r,this.unsubscribe$=new p.a,this.updateSettingsDebouncer$=new p.a,this._subdomain=new Ab,this.authType=Cb,this.logins={[this.authType.NATIVE_LOGIN]:!0},this.objectKeys=Object.keys,this.configurations={}}set isOwner(e){const t=this.isOwner;this._isOwner=e,!t&&this.isOwner&&this.isInitialized&&this.getAllData()}get isOwner(){return this._isOwner}set subdomain(e){this._subdomain=e,this.subdomainNameService.setSubdomainName(e),this.setLoginData()}get subdomain(){return this._subdomain}ngOnInit(){this.isSubdomain=this.subdomainService.isSubdomainNotSelfhosted(),this.getAllData(),this.isInitialized=!0}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}getAllData(){this.isOwner&&this.hasCustomSubdomainFeature&&(this.checkUserHasPassword(),this.subscribeToSaveSettings(),this.authSSOService.getSubdomain().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.subdomain=e,this.getConfigurations()}))}get availableConfigurations(){return wb.filter(e=>!this.configurations[e.value])}get isCreateDisabled(){return!this.availableName||this.creatingInprogress||!this.userHasPassword}get hasImage(){return!!this.subdomain.logoURL}get subdomainUrl(){const e=bo.a.environment.frontendUrl.replace("app.","");return`${window.location.protocol}//${this.availableName}.${e}`}availabilityChanged(e){this.availableName=e}createSubdomain(e){this.creatingInprogress=!0,this.authSSOService.createSubdomain(this.availableName).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.subdomain=t,this.creatingInprogress=!1,this.availableName=null,this.moveToSubdomain(!0,{token:t.auth&&t.auth.token,refreshToken:t.auth&&t.auth.refreshToken}),e.close()},()=>{this.creatingInprogress=!1,this.cd.detectChanges()})}setLogo(e=""){this.subdomain.logoURL=e,this.updateSettings()}moveToSubdomain(e=!1,t){e&&this.loader.show("WORKSPACE.AUTH_TAB.LOADER_MESSAGE"),setTimeout(()=>{this.subdomainService.moveToSubdomain(this.subdomain.domainName,t)},e?3e3:0)}deleteSubdomainConfirmed(e){this.deletingInProgress=!0,this.authSSOService.deleteSubdomain().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.isSubdomain&&this.subdomainService.moveBackToClockifyDomain({token:t.auth&&t.auth.token,refreshToken:t.auth&&t.auth.refreshToken}),this.deletingInProgress=!1,this.subdomain=new Ab,this.configurations={},e.close()},()=>{this.deletingInProgress=!1,this.cd.detectChanges()})}updateLoginData(e,t){if(!e&&this.subdomain.loginPreferences.length<2)setTimeout(()=>{this.setLoginData(),this.cd.detectChanges()});else{if(e)this.subdomain.loginPreferences.indexOf(t)<0&&this.subdomain.loginPreferences.push(t);else{const e=this.subdomain.loginPreferences.indexOf(t);-1!==e&&this.subdomain.loginPreferences.splice(e,1)}setTimeout(()=>{this.setLoginData(),this.cd.detectChanges(),this.updateSettingsDebouncer$.next()})}}isConfigActive(e){return this.subdomain.loginPreferences.indexOf(e)>-1}updateSettingsDebounce(){this.updateSettingsDebouncer$.next()}onSetPassword(){this.userHasPassword=!0,this.cd.detectChanges()}onDeletedConfiguration(e){delete this.configurations[e],this.logins[e]=!1;const t=this.subdomain.loginPreferences.indexOf(e);t>-1&&this.subdomain.loginPreferences.splice(t,1),0===this.subdomain.loginPreferences.length&&this.subdomain.loginPreferences.push(Cb.NATIVE_LOGIN),this.setLoginData()}onRenamed(e){if(this.subdomain=e,this.isSubdomain){const e={token:localStorage.getItem("token"),refreshToken:localStorage.getItem("refreshToken")};this.moveToSubdomain(!1,e)}}onCreateSSOConfig(e){const t=this.getConfigType(e);t?this.configurations[t]=e:this.getConfigurations()}subscribeToSaveSettings(){this.updateSettingsDebouncer$.pipe(Object(De.a)(500),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>this.updateSettings())}updateSettings(){this.subdomain.id&&this.authSSOService.editDomainData(this.subdomain).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.subdomain=e})}setLoginData(){this.logins={},this.subdomain.loginPreferences.forEach(e=>this.logins[e]=!0)}checkUserHasPassword(){this.authService.canChangePassword.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.userHasPassword=e,this.cd.detectChanges()}),this.authService.canChange()}getConfigurations(){this.authSSOService.getConfigurations().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.configurations=e,this.cd.detectChanges()})}openModal(e){this.isModalOpen||(this.isModalOpen=!0,this.modalService.open(e,{centered:!0}).result.then(()=>setTimeout(()=>this.isModalOpen=!1,150),()=>setTimeout(()=>this.isModalOpen=!1,150)))}addAnalyticsEvent(){this.analyticsService.addEvent(new Fi.a({event:"submit",value:"Enterprise",section:"Workspace settings",section2:"Authentication",section4:"Upgrade"}))}getConfigType(e){return e instanceof Tb?Cb.LDAP:e instanceof vb?Cb.OAUTH2:e instanceof Ob?Cb.SAML2:null}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q),s.Rb(Ib),s.Rb(re.a),s.Rb(Lb.a),s.Rb(Rb),s.Rb(Hn.a),s.Rb(s.h),s.Rb(g.f),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["auth-tab"]],inputs:{isOwner:"isOwner",hasCustomSubdomainFeature:"hasCustomSubdomainFeature"},decls:94,vars:64,consts:[["class","cl-form-group",4,"ngIf"],[1,"cl-relative"],["class","cl-blocker",4,"ngIf"],[1,"cl-row"],[1,"cl-col-lg-custom-12"],[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-12","cl-relative"],[1,"cl-h2","cl-mb-0"],[1,"cl-text-gray-9","cl-pr-4","cl-pr-lg-custom-0"],["class","cl-dropdown cl-absolute cl-t-0 cl-r-0","dropdownKey","",4,"ngIf"],[1,"cl-form-group","cl-col-md-12","cl-col-lg-10","cl-col-lg-custom-6"],[1,"cl-form-row","cl-align-items-start"],[1,"cl-form-group","cl-mb-3","cl-mb-md-0","cl-col-md-8"],[3,"disable","name","onEnter","onAvailableName"],[1,"cl-form-group","cl-mb-0","cl-col-md-4"],["tabindex","0","class","cl-btn cl-btn-primary cl-btn-block",3,"disabled","keyup.enter","keyup.space","click",4,"ngIf"],["tabindex","0","class","cl-btn cl-btn-primary cl-btn-block",3,"keyup.enter","keyup.space","click",4,"ngIf"],[1,"cl-form-group","cl-col-md-12"],[1,"cl-custom-control","cl-custom-switch"],["type","checkbox","id","customSwitchJoin",1,"cl-custom-control-input",3,"disabled","ngModel","ngModelChange"],["for","customSwitchJoin",1,"cl-custom-control-label"],[1,"cl-text-gray-9"],[1,"cl-mt-0"],[1,"cl-custom-control","cl-custom-checkbox"],["type","checkbox","id","login-native",1,"cl-custom-control-input",3,"ngModel","disabled","ngModelChange"],["for","login-native",1,"cl-custom-control-label"],["type","checkbox","id","login-ldap",1,"cl-custom-control-input",3,"ngModel","disabled","ngModelChange"],["for","login-ldap",1,"cl-custom-control-label"],["type","checkbox","id","login-oauth",1,"cl-custom-control-input",3,"ngModel","disabled","ngModelChange"],["for","login-oauth",1,"cl-custom-control-label"],["type","checkbox","id","login-saml2",1,"cl-custom-control-input",3,"ngModel","disabled","ngModelChange"],["for","login-saml2",1,"cl-custom-control-label"],[1,"cl-d-flex","cl-align-items-center"],["class","cl-border cl-min-width-40 cl-min-height-40 cl-d-flex cl-align-items-center cl-justify-content-center cl-mr-2",4,"ngIf"],[1,"cl-upload-file-wrapper"],[1,"cl-upload-btn-wrapper","cl-mr-3"],[3,"disabled","btnClasses","text","onUploaded"],["tabindex","0",3,"click","keyup.enter","keyup.space",4,"ngIf"],[4,"ngIf"],["createSubdomainModal",""],["renameModal",""],["deleteModal",""],["configureSSOModal",""],["setPasswordModal",""],[1,"cl-form-group"],[1,"cl-btn",3,"routerLink","queryParams","click"],[1,"cl-blocker"],[1,"cl-btn",3,"click"],["dropdownKey","",1,"cl-dropdown","cl-absolute","cl-t-0","cl-r-0"],["dropdownKeyButton","",1,"cl-btn","cl-btn-primary","cl-btn-fixed-40","cl-dropdown-toggle","cl-no-arrow"],["src","assets/images/ui-icons/menu-dots-vertical-white.svg"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-scroll-area"],["tabindex","0","clickCloseDropdown","",1,"cl-dropdown-item",3,"keyup.enter","keyup.space","click"],["changeBtn",""],[1,"cl-dropdown-divider"],["tabindex","0","clickCloseDropdown","",1,"cl-dropdown-item","cl-text-danger",3,"keyup.enter","keyup.space","click"],["deleteBtn",""],["tabindex","0",1,"cl-btn","cl-btn-primary","cl-btn-block",3,"disabled","keyup.enter","keyup.space","click"],["createBtn",""],["tabindex","0",1,"cl-btn","cl-btn-primary","cl-btn-block",3,"keyup.enter","keyup.space","click"],[1,"cl-border","cl-min-width-40","cl-min-height-40","cl-d-flex","cl-align-items-center","cl-justify-content-center","cl-mr-2"],[1,"cl-signup-logo","cl-relative",3,"src"],["tabindex","0",3,"click","keyup.enter","keyup.space"],["class","cl-form-row",4,"ngIf"],["class","cl-mb-2 cl-d-block",3,"type","active","configuration","onDelete",4,"ngFor","ngForOf"],[1,"cl-h2","cl-mb-0","cl-d-flex","cl-align-items-center"],[1,"cl-mb-2","cl-d-block",3,"type","active","configuration","onDelete"],["tabindex","0",1,"cl-btn","cl-btn-primary",3,"click","keyup.enter","keyup.space"],["addSSOBtn",""],[3,"title","btnText","inProgress","confirmed","close"],[3,"title","onClose"],[3,"subdomain","onRenamed","onClose"],[3,"inProgress","title","onClose","onDelete"],[3,"availableTypes","onCreated","onClose"],[3,"onClose","onSetPassword"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xc(0,du,4,3,"div",0),s.Xc(1,hu,7,10,"div",0),s.Xb(2,"div",1),s.Xc(3,mu,1,0,"div",2),s.Xb(4,"div",3),s.Xb(5,"div",4),s.Xb(6,"div"),s.Xc(7,gu,7,6,"div",0),s.Xb(8,"div",5),s.Xb(9,"div",6),s.Xb(10,"div",7),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xb(13,"div",8),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Xc(16,fu,4,0,"div",9),s.Wb(),s.Xb(17,"div",10),s.Xb(18,"label"),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Xb(21,"div",11),s.Xb(22,"div",12),s.Xb(23,"domain-input",13),s.jc("onEnter",(function(){s.Oc(e);const n=s.Lc(85);return!t.isCreateDisabled&&t.openModal(n)}))("onAvailableName",(function(e){return t.availabilityChanged(e)})),s.Wb(),s.Wb(),s.Xb(24,"div",14),s.Xc(25,Su,4,4,"button",15),s.Xc(26,Cu,3,3,"button",16),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(27,"div",5),s.Xb(28,"div",17),s.Xb(29,"div",18),s.Xb(30,"input",19),s.jc("ngModelChange",(function(){return t.updateSettingsDebounce()}))("ngModelChange",(function(e){return t.subdomain.automaticJoinOnWorkspace=e})),s.Wb(),s.Xb(31,"label",20),s.Zc(32),s.oc(33,"translate"),s.Wb(),s.Wb(),s.Xb(34,"div",21),s.Zc(35),s.oc(36,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Sb(37,"hr",22),s.Xb(38,"div",5),s.Xb(39,"div",17),s.Xb(40,"div",7),s.Zc(41),s.oc(42,"translate"),s.Wb(),s.Xb(43,"div",21),s.Zc(44),s.oc(45,"translate"),s.Wb(),s.Wb(),s.Xb(46,"div",17),s.Xb(47,"div",23),s.Xb(48,"input",24),s.jc("ngModelChange",(function(e){return t.updateLoginData(e,t.authType.NATIVE_LOGIN)}))("ngModelChange",(function(e){return t.logins[t.authType.NATIVE_LOGIN]=e})),s.Wb(),s.Xb(49,"label",25),s.Zc(50),s.oc(51,"translate"),s.Wb(),s.Wb(),s.Xb(52,"div",23),s.Xb(53,"input",26),s.jc("ngModelChange",(function(e){return t.updateLoginData(e,t.authType.LDAP)}))("ngModelChange",(function(e){return t.logins[t.authType.LDAP]=e})),s.Wb(),s.Xb(54,"label",27),s.Zc(55),s.oc(56,"translate"),s.Wb(),s.Wb(),s.Xb(57,"div",23),s.Xb(58,"input",28),s.jc("ngModelChange",(function(e){return t.updateLoginData(e,t.authType.OAUTH2)}))("ngModelChange",(function(e){return t.logins[t.authType.OAUTH2]=e})),s.Wb(),s.Xb(59,"label",29),s.Zc(60),s.oc(61,"translate"),s.Wb(),s.Wb(),s.Xb(62,"div",23),s.Xb(63,"input",30),s.jc("ngModelChange",(function(e){return t.updateLoginData(e,t.authType.SAML2)}))("ngModelChange",(function(e){return t.logins[t.authType.SAML2]=e})),s.Wb(),s.Xb(64,"label",31),s.Zc(65),s.oc(66,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(67,"hr",22),s.Xb(68,"div",5),s.Xb(69,"div",17),s.Xb(70,"div",7),s.Zc(71),s.oc(72,"translate"),s.Wb(),s.Xb(73,"div",21),s.Zc(74),s.oc(75,"translate"),s.Wb(),s.Wb(),s.Xb(76,"div",17),s.Xb(77,"div",32),s.Xc(78,Au,2,1,"div",33),s.Xb(79,"div",34),s.Xb(80,"form",35),s.Xb(81,"btn-upload-file",36),s.jc("onUploaded",(function(e){return t.setLogo(e)})),s.Wb(),s.Wb(),s.Xc(82,Ou,3,3,"a",37),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(83,wu,5,3,"ng-container",38),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(84,Lu,8,11,"ng-template",null,39,s.Yc),s.Xc(86,Ru,3,4,"ng-template",null,40,s.Yc),s.Xc(88,yu,5,7,"ng-template",null,41,s.Yc),s.Xc(90,_u,1,1,"ng-template",null,42,s.Yc),s.Xc(92,ku,3,3,"ng-template",null,43,s.Yc)}2&e&&(s.wc("ngIf",!1===t.isOwner),s.Cb(1),s.wc("ngIf",!t.hasCustomSubdomainFeature),s.Cb(2),s.wc("ngIf",!t.isOwner||!t.hasCustomSubdomainFeature),s.Cb(4),s.wc("ngIf",!1===t.userHasPassword),s.Cb(4),s.ad(s.pc(12,38,"WORKSPACE.SUBDOMAIN.TITLE")),s.Cb(3),s.bd(" ",s.pc(15,40,"WORKSPACE.SUBDOMAIN.INFO_MESSAGE")," "),s.Cb(2),s.wc("ngIf",t.subdomain.id),s.Cb(3),s.ad(s.pc(20,42,"WORKSPACE.SUBDOMAIN.YOUR")),s.Cb(4),s.wc("disable",t.creatingInprogress||(null==t.subdomain?null:t.subdomain.id)||!t.userHasPassword)("name",t.subdomain.domainName),s.Cb(2),s.wc("ngIf",!t.subdomain.id),s.Cb(1),s.wc("ngIf",t.subdomain.id&&!t.isSubdomain),s.Cb(4),s.wc("disabled",!t.subdomain.id||!t.isSubdomain)("ngModel",t.subdomain.automaticJoinOnWorkspace),s.Cb(2),s.bd(" ",s.pc(33,44,"WORKSPACE.SUBDOMAIN.USER.JOIN.TOGGLE")," "),s.Cb(3),s.bd(" ",s.pc(36,46,"WORKSPACE.SUBDOMAIN.USER.JOIN.INFO_MESSAGE")," "),s.Cb(6),s.ad(s.pc(42,48,"WORKSPACE.SUBDOMAIN.USER.LOGIN_SETUP.TITLE")),s.Cb(3),s.bd(" ",s.pc(45,50,"WORKSPACE.SUBDOMAIN.USER.LOGIN_SETUP.INFO_MESSAGE")," "),s.Cb(4),s.wc("ngModel",t.logins[t.authType.NATIVE_LOGIN])("disabled",!t.subdomain.id||!t.isSubdomain),s.Cb(2),s.ad(s.pc(51,52,"WORKSPACE.SUBDOMAIN.USER.LOGIN_SETUP.OPTIONS.EMAIL_AND_PASSWORD")),s.Cb(3),s.wc("ngModel",t.logins[t.authType.LDAP])("disabled",!t.configurations[t.authType.LDAP]||!t.isSubdomain),s.Cb(2),s.ad(s.pc(56,54,"WORKSPACE.SUBDOMAIN.USER.LOGIN_SETUP.OPTIONS.LDAP")),s.Cb(3),s.wc("ngModel",t.logins[t.authType.OAUTH2])("disabled",!t.configurations[t.authType.OAUTH2]||!t.isSubdomain),s.Cb(2),s.ad(s.pc(61,56,"WORKSPACE.SUBDOMAIN.USER.LOGIN_SETUP.OPTIONS.OAUTH")),s.Cb(3),s.wc("ngModel",t.logins[t.authType.SAML2])("disabled",!t.configurations[t.authType.SAML2]||!t.isSubdomain),s.Cb(2),s.ad(s.pc(66,58,"WORKSPACE.SUBDOMAIN.USER.LOGIN_SETUP.OPTIONS.SAML2")),s.Cb(6),s.ad(s.pc(72,60,"WORKSPACE.SUBDOMAIN.LOGO.TITLE")),s.Cb(3),s.bd(" ",s.pc(75,62,"WORKSPACE.SUBDOMAIN.LOGO.INFO_MESSAGE")," "),s.Cb(4),s.wc("ngIf",null==t.subdomain?null:t.subdomain.logoURL),s.Cb(3),s.wc("disabled",!t.subdomain.id||!t.isSubdomain)("btnClasses","cl-btn-outline-light cl-btn-primary cl-color-gray")("text","SHARED_MODULES.BTN_UPLOAD_FILE_CONTENT.UPLOAD_IMG_BTN_DEFAULT"),s.Cb(1),s.wc("ngIf",t.hasImage),s.Cb(1),s.wc("ngIf",t.subdomain.id&&t.isSubdomain))},directives:[i.u,xb,v.a,v.s,v.v,v.I,v.t,v.u,fo.a,To.a,k.g,ni.a,ii.a,si.a,i.t,Hd,Si.a,Wd.a,qd,Xd.a,cu,bu],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var Xu=n("wxL3");class Nu{constructor(e){this.type=e.type,this.name=e.name,this.title=e.title,this.text=e.text,this.bulletsList=e.bulletsList,this.isFree=e.isFree,this.connectionExist=e.connectionExist,this.tokenExpired=e.tokenExpired,this.logoUrl=e.logoUrl,this.links=e.links,this.showConnect=e.showConnect,this.isExpanded=e.isExpanded}}const Du=["successModal"],Pu=["syncModal"];let Mu=(()=>{class e{constructor(e,t,n){this.modalService=e,this.integrationService=t,this.loader=n,this.unsubscribe$=new p.a,this.onCheckSyncData$=new p.a,this.onCloseWindow=e=>{if("message"!==e.data.type)return;if(!e.data.result)return;const{code:t,state:n,realmId:i}=e.data.result;t&&n&&i&&this.connectConfirm(t,n,i)}}get integration(){return this._integration}set integration(e){e&&(this._integration=e)}ngOnInit(){window.opener&&(window.opener.postMessage(window.location.search),window.close())}ngOnDestroy(){var e;null===(e=this.windowRef)||void 0===e||e.close(),window.removeEventListener("message",this.onCloseWindow),this.unsubscribe$.next(!0),this.unsubscribe$.complete()}openWindow(){var e,t,n;window.removeEventListener("message",this.onCloseWindow);const i="toolbar=no, menubar=no,width=700, height=700,left=100";null===this.windowRef||(null===(e=this.windowRef)||void 0===e?void 0:e.closed)?this.windowRef=window.open(this.connectUrl,"Clockify",i):this.windowRef!==this.connectUrl?(this.windowRef=window.open(this.connectUrl,"Clockify",i),null===(t=this.windowRef)||void 0===t||t.focus()):null===(n=this.windowRef)||void 0===n||n.focus(),window.addEventListener("message",this.onCloseWindow,!1)}connectToIntegration(){}connectConfirm(e,t,n){}sync(e){}openModal(e){this.modalService.open(e,{centered:!0})}expandEntireComponent(){this.integration.isExpanded||(this.integration.isExpanded=!0)}disconnect(){}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q),s.Rb(ut),s.Rb(Hn.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;1&e&&(s.gd(Du,!0),s.gd(Pu,!0)),2&e&&(s.Kc(n=s.kc())&&(t.successModal=n.first),s.Kc(n=s.kc())&&(t.syncModal=n.first))},inputs:{integration:"integration",workspaceId:"workspaceId"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();var Bu=n("jhN1");let Uu=(()=>{class e{constructor(e){this.authService=e,this.close=new s.n}closeModal(){this.close.emit(!0)}resendEmail(){this.authService.resendVerifyEmail()}ngOnInit(){this.email=this.authService.getUser().email}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(re.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["verify-email-modal"]],outputs:{close:"close"},decls:18,vars:13,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["src","assets/ui-icons/close.svg",3,"click"],[1,"cl-modal-body"],[1,"cl-text-break","cl-text-color"],[1,"margin"],[3,"click"],[1,"cl-modal-footer"],["type","submit",1,"cl-btn","cl-btn-primary",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"img",2),s.jc("click",(function(){return t.closeModal()})),s.Wb(),s.Wb(),s.Xb(5,"div",3),s.Xb(6,"div",4),s.Xb(7,"div",5),s.Zc(8),s.oc(9,"translate"),s.oc(10,"translate"),s.Wb(),s.Xb(11,"div"),s.Xb(12,"a",6),s.jc("click",(function(){return t.resendEmail(),t.closeModal()})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(15,"div",7),s.Xb(16,"button",8),s.jc("click",(function(){return t.closeModal()})),s.Zc(17,"OK"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,5,"LAYOUT.NOTIFICATIONS.VERIFY_EMAIL_LABEL")),s.Cb(6),s.dd(" ",s.pc(9,7,"WORKSPACE.INTEGRATION.PUMBLE.VERIFY_EMAIL_MSG_1")," ",t.email," ",s.pc(10,9,"WORKSPACE.INTEGRATION.PUMBLE.VERIFY_EMAIL_MSG_2")," "),s.Cb(5),s.bd(" ",s.pc(14,11,"EMAIL_PREFERENCES.INFO_VERIFY.LINK")," "))},pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var Gu=n("RDRF");class xu{constructor(){this._hasPumbleAccount=!1,this._isPumbleAdmin=!1,this._pumbleWorkspaces=[]}get hasPumbleAccount(){return this._hasPumbleAccount}set hasPumbleAccount(e){this._hasPumbleAccount=e}get isPumbleAdmin(){return this._isPumbleAdmin}set isPumbleAdmin(e){this._isPumbleAdmin=e}get pumbleWorkspaces(){return this._pumbleWorkspaces}set pumbleWorkspaces(e){this._pumbleWorkspaces=e}}const Fu=["startChatting"],ju=["connectModal"],Zu=["pumblePermission"];function Vu(e,t){1&e&&(s.Xb(0,"div"),s.Xb(1,"div",19),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"WORKSPACE.INTEGRATION.PUMBLE.ONLY_ADMINS_MSG")," "))}function Yu(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",20),s.Xb(1,"dropdown-items",21),s.jc("onChanged",(function(t){return s.Oc(e),s.nc(2).selectedWorkspace=t})),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(1),s.wc("list",e.pumbleWorkspaces)("value",e.selectedWorkspace)}}const Hu=function(e){return{"cl-disabled":e}};function $u(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"div",3),s.Xb(2,"h1",4),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"img",5),s.jc("click",(function(){return s.Oc(e),s.nc().closeModal()})),s.Wb(),s.Wb(),s.Xb(6,"div",6),s.Xc(7,Vu,4,3,"div",7),s.Xb(8,"div",8),s.Xb(9,"form"),s.Xb(10,"div",9),s.Xb(11,"input",10),s.jc("ngModelChange",(function(){return s.Oc(e),s.nc().changeUseExisting(!0)}))("ngModelChange",(function(t){return s.Oc(e),s.nc().useExisting=t})),s.Wb(),s.Xb(12,"label",11),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Xc(15,Yu,2,2,"div",12),s.Xb(16,"div",13),s.Xb(17,"input",14),s.jc("ngModelChange",(function(){return s.Oc(e),s.nc().changeUseExisting(!1)}))("ngModelChange",(function(t){return s.Oc(e),s.nc().useExisting=t}))("click",(function(){return s.Oc(e),s.nc().changeUseExisting(!1)})),s.Wb(),s.Xb(18,"label",15),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(21,"div",16),s.Xb(22,"a",17),s.jc("click",(function(){return s.Oc(e),s.nc().closeModal()})),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Xb(25,"button",18),s.jc("click",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(2);return t.closeModal(),t.openModal(n)})),s.Zc(26,"Connect"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.bd(" ",s.pc(4,11,"WORKSPACE.INTEGRATION.PUMBLE.CONNECT_HEADER")," "),s.Cb(4),s.wc("ngIf",!e.pumbleSettings.isPumbleAdmin),s.Cb(3),s.wc("ngClass",s.Bc(19,Hu,!e.pumbleSettings.isPumbleAdmin)),s.Cb(1),s.wc("value",!0)("ngModel",e.useExisting),s.Cb(2),s.bd(" ",s.pc(14,13,"WORKSPACE.INTEGRATION.PUMBLE.CONNECT.EXISTING")," "),s.Cb(2),s.wc("ngIf",e.pumbleSettings.isPumbleAdmin&&e.pumbleSettings.pumbleWorkspaces.length>0),s.Cb(2),s.wc("value",!1)("ngModel",e.useExisting),s.Cb(2),s.bd(" ",s.pc(20,15,"WORKSPACE.INTEGRATION.PUMBLE.CONNECT.NEW")," "),s.Cb(4),s.ad(s.pc(24,17,"GLOBAL.CANCEL_BTN"))}}function Ku(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",3),s.Xb(1,"h1",4),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"img",5),s.jc("click",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return i.pumbleSettings.isPumbleAdmin||i.showPumbleWorkspacesModal?n.close():i.closeModal()})),s.Wb(),s.Wb(),s.Xb(5,"div",6),s.Xb(6,"div",22),s.Xb(7,"div",20),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Xb(10,"ul",20),s.Xb(11,"li"),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xb(14,"li"),s.Zc(15),s.oc(16,"translate"),s.Wb(),s.Wb(),s.Xb(17,"div",23),s.Xb(18,"input",24),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().hasAgreed=t})),s.Wb(),s.Xb(19,"label",25),s.Zc(20),s.oc(21,"translate"),s.Xb(22,"a",26),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Zc(25),s.oc(26,"translate"),s.Xb(27,"a",27),s.Zc(28),s.oc(29,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(30,"div",16),s.Xb(31,"a",17),s.jc("click",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return i.showPumbleWorkspacesModal?n.close():i.closeModal()})),s.Zc(32),s.oc(33,"translate"),s.Wb(),s.Xb(34,"button",28),s.jc("click",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return i.showPumbleWorkspacesModal?n.close():i.closeModal(),i.connectToIntegration()})),s.Zc(35),s.oc(36,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.bd(" ",s.pc(3,12,"WORKSPACE.INTEGRATION.PUMBLE.PERMISSION_HEADER")," "),s.Cb(6),s.bd(" ",s.pc(9,14,"WORKSPACE.INTEGRATION.PUMBLE.PERMISSION_TEXT")," "),s.Cb(4),s.bd(" ",s.pc(13,16,"WORKSPACE.INTEGRATION.PUMBLE.PERMISSION_1")," "),s.Cb(3),s.bd(" ",s.pc(16,18,"WORKSPACE.INTEGRATION.PUMBLE.PERMISSION_2")," "),s.Cb(3),s.wc("ngModel",e.hasAgreed),s.Cb(2),s.bd(" ",s.pc(21,20,"WORKSPACE.INTEGRATION.PUMBLE.AGREE")," "),s.Cb(3),s.bd(" ",s.pc(24,22,"WORKSPACE.SETTINGS.CONSENT_MSG_PART5")," "),s.Cb(2),s.bd(" ",s.pc(26,24,"GLOBAL.AND")," "),s.Cb(3),s.bd(" ",s.pc(29,26,"GLOBAL.TOS")," "),s.Cb(4),s.ad(s.pc(33,28,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",!e.hasAgreed),s.Cb(1),s.bd(" ",s.pc(36,30,"GLOBAL.ALLOW_BTN"),"")}}function qu(e,t){1&e&&(s.Xb(0,"div"),s.Sb(1,"br"),s.Xb(2,"div",35),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Sb(5,"br"),s.Wb()),2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"WORKSPACE.INTEGRATION.PUMBLE.EMAIL.INFO.MSG")," "))}function zu(e,t){if(1&e&&(s.Xb(0,"div",6),s.Xb(1,"img",29),s.jc("click",(function(){return t.$implicit.close()})),s.Wb(),s.Xc(2,qu,6,3,"div",7),s.Xb(3,"div",30),s.Xb(4,"div",31),s.Sb(5,"img",32),s.Xb(6,"div",33),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(11,"div",16),s.Xb(12,"a",17),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Xb(15,"a",34),s.Xb(16,"button",18),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.wc("ngIf",e.showWarningEmailMessage),s.Cb(5),s.bd(" ",s.pc(8,6,"WORKSPACE.INTEGRATION.PUMBLE.SUCCESS_HEADER")," "),s.Cb(2),s.bd(" ",s.pc(10,8,"WORKSPACE.INTEGRATION.PUMBLE.SUCCESS_MSG"),""),s.Cb(4),s.ad(s.pc(14,10,"GLOBAL.CLOSE_BTN")),s.Cb(2),s.xc("href",e.pumbleLink,s.Qc),s.Cb(2),s.bd(" ",s.pc(18,12,"WORKSPACE.INTEGRATION.PUMBLE.OPEN_APP"),"")}}let Qu=(()=>{class e{constructor(e,t,n,i,c,a,o,r,l){this.modalService=e,this.loader=t,this.cd=n,this.authService=i,this.workspaceService=c,this.translateService=a,this.toaster=o,this.analyticsService=r,this.pumbleService=l,this.connected=!1,this.integrationChange=new s.n,this.connectedChange=new s.n,this.hasAgreed=!1,this.useExisting=!1,this.pumbleWorkspaces=[],this.emailVerified=!1,this.isClockifyAdmin=!1,this.hasPumbleAccount=!1,this.showWarningEmailMessage=!1,this.connectClicked=!1,this.close=new s.n}ngOnInit(){this.emailVerified="ACTIVE"==this.authService.getUser().status,this.useExisting=this.pumbleSettings.pumbleWorkspaces.length>0,this.fillPumbleWorkspacesDropdown(),this.isClockifyAdmin=this.authService.isAdminOrOwner(),this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.checkIfShowPumbleWorkspacesModal()}openModal(e){this.modalRef=this.modalService.open(e,{centered:!0})}closeModal(){this.close.emit(!0)}closePermissionModal(){}resendEmail(){this.authService.resendVerifyEmail()}changeUseExisting(e){this.useExisting=e}fillPumbleWorkspacesDropdown(){this.pumbleSettings.pumbleWorkspaces.length>0&&(this.pumbleSettings.pumbleWorkspaces.forEach(e=>{this.pumbleWorkspaces.push(new Un.a(e.id,e.name))}),this.selectedWorkspace=this.pumbleWorkspaces[0].value)}checkIfShowPumbleWorkspacesModal(){this.showPumbleWorkspacesModal=this.pumbleSettings.isPumbleAdmin||!this.pumbleSettings.isPumbleAdmin&&0==this.pumbleSettings.pumbleWorkspaces.length&&this.pumbleSettings.hasPumbleAccount}connectToIntegration(){this.loader.show("GLOBAL.LOADER_LOADING"),this.workspaceService.connectWorkspaceToPumble(this.workspaceId,this.useExisting?{pumbleWorkspaceId:this.selectedWorkspace}:{pumbleWorkspaceId:null}).subscribe(e=>{e.skippedUsers>0&&(this.showWarningEmailMessage=!0),this.loader.hide(),this.modalService.open(this.startChatting,{centered:!0}),this.workspaceService.isPumbleActivated$.next(!0),this.workspaceService.getIntegrationToken(this.workspaceId).subscribe(e=>{this.workspaceService.getExchangeToken(e.integrationToken).subscribe(e=>{this.pumbleLink=bo.a.environment.pumbleAppUrl+"/landing?exchangeToken="+e.exchangeToken,this.cd.detectChanges()}),this.pumbleService.mountPumble(e.integrationToken)}),this.integration&&(this.integration.connectionExist=!0,this.integration.tokenExpired=!1,this.integrationChange.emit(this.integration)),this.workspace.showChatWidget=!0,this.workspaceService.updateWorkspaceSettings(this.workspace),this.addEvent()},e=>{this.loader.hide(),this.toaster.pop("error",this.translateService.instant("WORKSPACE.INTEGRATION.PUMBLE.CONNECTING_FAILED"))})}addEvent(){this.analyticsService.addEvent(new Fi.a({event:"submit",uevent:"submit",value:"Connect Pumble",amount:"",section:"Settings",section2:"Integrations",section3:"Pumble",section4:"Connect to Pumble"}))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q),s.Rb(Hn.a),s.Rb(s.h),s.Rb(re.a),s.Rb(l.a),s.Rb(g.f),s.Rb(r.a),s.Rb(xi.a),s.Rb(Gu.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["pumble-integration-modals"]],viewQuery:function(e,t){var n;1&e&&(s.gd(Fu,!0),s.gd(ju,!0),s.gd(Zu,!0)),2&e&&(s.Kc(n=s.kc())&&(t.startChatting=n.first),s.Kc(n=s.kc())&&(t.connectModal=n.first),s.Kc(n=s.kc())&&(t.permissionModal=n.first))},inputs:{workspaceId:"workspaceId",integration:"integration",connected:"connected",pumbleSettings:"pumbleSettings",connectClicked:"connectClicked"},outputs:{integrationChange:"integrationChange",connectedChange:"connectedChange",close:"close"},decls:5,vars:2,consts:[[4,"ngIf","ngIfElse"],["pumblePermission",""],["startChatting",""],[1,"cl-modal-header"],[1,"cl-modal-title"],["src","assets/ui-icons/close.svg",3,"click"],[1,"cl-modal-body"],[4,"ngIf"],[1,"cl-form-group"],[1,"cl-custom-control","cl-custom-radio","margin",3,"ngClass"],["type","radio","id","existing","name","existing",1,"cl-custom-control-input",3,"value","ngModel","ngModelChange"],["for","existing",1,"cl-custom-control-label"],["class","margin",4,"ngIf"],[1,"cl-custom-control","cl-custom-radio"],["type","radio","id","new","name","new",1,"cl-custom-control-input",3,"value","ngModel","ngModelChange","click"],["for","new",1,"cl-custom-control-label"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-alert","cl-alert-info","cl-fade","cl-show","cl-text-break"],[1,"margin"],[1,"cl-dropdown-full-width",3,"list","value","onChanged"],[1,"cl-text-break","cl-text-color"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline"],["id","hasAgreed","type","checkbox","name","hasAgreed",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","hasAgreed",1,"cl-custom-control-label"],["href","https://pumble.com/privacy","target","_blank"],["href","https://pumble.com/terms","target","_blank"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled","click"],["src","assets/ui-icons/close.svg",1,"cl-text-right","cl-float-right","cl-align-items-right",3,"click"],[1,"cl-text-break","cl-text-color","cl-align-items-center"],[1,"cl-text-break","cl-text-color","cl-text-center","cl-padding"],["src","assets/integrations/start-chatting.svg",1,"margin"],[1,"margin","cl-h1"],["target","_blank",3,"href"],[1,"cl-alert","cl-alert-info","cl-fade","cl-show","cl-text-break","cl-margin-top"]],template:function(e,t){if(1&e&&(s.Xc(0,$u,27,21,"div",0),s.Xc(1,Ku,37,32,"ng-template",null,1,s.Yc),s.Xc(3,zu,19,14,"ng-template",null,2,s.Yc)),2&e){const e=s.Lc(2);s.wc("ngIf",t.showPumbleWorkspacesModal)("ngIfElse",e)}},directives:[i.u,v.I,v.t,v.u,i.r,v.A,v.c,v.s,v.v,ji.a,v.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function Ju(e,t){1&e&&(s.Vb(0),s.Xb(1,"span",17),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Ub()),2&e&&(s.Cb(2),s.ad(s.pc(3,1,"GLOBAL.CONNECTED_BADGE")))}function ep(e,t){1&e&&(s.Vb(0),s.Xb(1,"span",18),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Ub()),2&e&&(s.Cb(2),s.ad(s.pc(3,1,"WORKSPACE.INTEGRATION.EXPIRED")))}function tp(e,t){if(1&e&&s.Sb(0,"p",27),2&e){const e=s.nc(2);s.wc("innerHTML",e.integration.text,s.Pc)}}function np(e,t){if(1&e&&(s.Xb(0,"p",28),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.ad(s.pc(2,1,e.integration.text))}}function ip(e,t){if(1&e&&(s.Xb(0,"li"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.ad(s.pc(2,1,e))}}function sp(e,t){if(1&e&&(s.Xb(0,"ul",29),s.Xc(1,ip,3,3,"li",25),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngForOf",e.integration.bulletsList)}}function cp(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",30),s.Xb(2,"input",31),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc(2).onShowPumbleWidgetChange(t)})),s.Wb(),s.Xb(3,"label",32),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc(2);s.Cb(2),s.wc("ngModel",e.showPumbleWidget),s.Cb(2),s.bd(" ",s.pc(5,2,"WORKSPACE.INTEGRATION.PUMBLE.SHOW_WIDGET")," ")}}function ap(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",38,39),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1),n=s.nc(3);return t.blur(),n.checkSyncData()})),s.Zc(2),s.oc(3,"translate"),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"WORKSPACE.INTEGRATION.QUICKBOOKS.SYNC")," "))}function op(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.oc(3,"translate"),s.Ub()),2&e){const e=s.nc(4);s.Cb(1),s.cd(" ",s.pc(2,2,"WORKSPACE.INTEGRATION.CONNECT_TO")," ",s.pc(3,4,e.integration.name)," ")}}const rp=function(e,t){return{"cl-quickbooks-btn":e,"cl-btn cl-btn-primary":t}};function lp(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",40,41),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1);return s.nc(3).connectToIntegration(),t.blur()})),s.Xc(2,op,4,6,"ng-container",5),s.Wb()}if(2&e){const e=s.nc(3);s.wc("ngClass",s.Cc(2,rp,"WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"===e.integration.name,"WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"!==e.integration.name)),s.Cb(2),s.wc("ngIf","WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"!==e.integration.name)}}function bp(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.INTEGRATION.PUMBLE.ENABLE_CHAT")," "))}function dp(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",42,41),s.jc("click",(function(){return s.Oc(e),s.nc(3).openConnectionModal()})),s.Xc(2,bp,3,3,"ng-container",5),s.Wb()}if(2&e){const e=s.nc(3);s.Cb(2),s.wc("ngIf","WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"!==e.integration.name)}}const up=function(e,t){return{"cl-quickbooks-btn-green":e,"cl-btn-primary":t}};function pp(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",43,44),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1);return s.nc(3).connectToIntegration(),t.blur()})),s.Zc(2),s.oc(3,"translate"),s.Wb()}if(2&e){const e=s.nc(3);s.wc("ngClass",s.Cc(4,up,"WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"===e.integration.name,"WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"==e.integration.name)),s.Cb(2),s.bd(" ",s.pc(3,2,"WORKSPACE.INTEGRATION.RECONNECT")," ")}}function hp(e,t){if(1&e&&(s.Xb(0,"div",33),s.Xc(1,ap,4,3,"button",34),s.Xc(2,lp,3,5,"button",35),s.Xc(3,dp,3,1,"button",36),s.Xc(4,pp,4,7,"button",37),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",e.integration.connectionExist&&!e.integration.tokenExpired&&"WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"!==e.integration.name),s.Cb(1),s.wc("ngIf",!e.integration.connectionExist&&"WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"!==e.integration.name),s.Cb(1),s.wc("ngIf",!e.integration.connectionExist&&"WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"===e.integration.name),s.Cb(1),s.wc("ngIf",e.integration.connectionExist&&e.integration.tokenExpired)}}function mp(e,t){if(1&e&&(s.Xb(0,"div"),s.Xb(1,"a",45),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.wc("href",e.url,s.Qc),s.Cb(1),s.ad(s.pc(3,2,e.label))}}function gp(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",46,47),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1),n=s.nc(2),i=s.Lc(26);return n.openModal(i),t.blur()})),s.Zc(2),s.oc(3,"translate"),s.oc(4,"translate"),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.cd("",s.pc(3,2,"WORKSPACE.INTEGRATION.DISCONNECT.FROM")," ",s.pc(4,4,e.integration.name),"")}}function Ep(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",46,47),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1),n=s.nc(2),i=s.Lc(28);return n.getWorkspaceName(),n.openModal(i),t.blur()})),s.Zc(2),s.oc(3,"translate"),s.oc(4,"translate"),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.cd("",s.pc(3,2,"WORKSPACE.INTEGRATION.DISCONNECT.FROM")," ",s.pc(4,4,e.integration.name),"")}}function fp(e,t){if(1&e&&(s.Xb(0,"div",19),s.Xc(1,tp,1,1,"p",20),s.Xc(2,np,3,3,"ng-template",null,21,s.Yc),s.Xc(4,sp,2,1,"ul",22),s.Xc(5,cp,6,4,"ng-container",5),s.Xc(6,hp,5,4,"div",23),s.Xb(7,"div",24),s.Xb(8,"div"),s.Xc(9,mp,4,4,"div",25),s.Wb(),s.Xc(10,gp,5,6,"button",26),s.Xc(11,Ep,5,6,"button",26),s.Wb(),s.Wb()),2&e){const e=s.Lc(3),t=s.nc();s.Cb(1),s.wc("ngIf","quickbooks"===t.integration.type||"pumble"===t.integration.type)("ngIfElse",e),s.Cb(3),s.wc("ngIf",t.integration.bulletsList),s.Cb(1),s.wc("ngIf","WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"===t.integration.name&&!t.integration.connectionExist&&!t.isAloneOnWs),s.Cb(1),s.wc("ngIf",t.integration.showConnect),s.Cb(3),s.wc("ngForOf",t.integration.links),s.Cb(1),s.wc("ngIf","WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"!==t.integration.name&&t.integration.connectionExist&&!t.integration.tokenExpired&&t.integration.showConnect),s.Cb(1),s.wc("ngIf","WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"===t.integration.name&&t.integration.connectionExist&&!t.integration.tokenExpired)}}function Sp(e,t){1&e&&(s.Xb(0,"verify-email-modal",48),s.jc("close",(function(){return t.$implicit.close()})),s.Wb())}function Cp(e,t){if(1&e&&(s.Xb(0,"pumble-integration-modals",49),s.jc("close",(function(){return t.$implicit.close()})),s.Wb()),2&e){const e=s.nc();s.wc("workspaceId",e.workspaceId)("integration",e.integration)("pumbleSettings",e.pumbleSettings)}}function Ap(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",58),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit,n=s.nc(),i=s.Lc(24);return t.close(),n.openModal(i)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.NEXT_LABEL")," "))}function Op(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",58),s.jc("click",(function(){return s.Oc(e),s.nc().$implicit.close()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.CONFIRM_OK_BTN")))}const vp=function(e){return{value:e}};function Tp(e,t){if(1&e&&(s.Xb(0,"div",50),s.Xb(1,"div",33),s.Sb(2,"img",51),s.Wb(),s.Xb(3,"div",52),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"p",53),s.Zc(7),s.oc(8,"translate"),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Xb(10,"div",54),s.Xb(11,"a",55),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xc(14,Ap,3,3,"button",56),s.Xc(15,Op,3,3,"ng-template",null,57,s.Yc),s.Wb()),2&e){const e=s.Lc(16),t=s.nc();s.Cb(4),s.ad(s.pc(5,5,"GLOBAL.SUCCESS_MSG")),s.Cb(3),s.bd(" ",s.qc(8,7,"WORKSPACE.INTEGRATION.CONNECTED_TO",s.Bc(14,vp,s.pc(9,10,t.integration.name)))," "),s.Cb(5),s.ad(s.pc(13,12,"GLOBAL.CLOSE_BTN")),s.Cb(2),s.wc("ngIf",(null==t.syncData||null==t.syncData.usersToSync?null:t.syncData.usersToSync.length)||(null==t.syncData||null==t.syncData.customersToSync?null:t.syncData.customersToSync.length))("ngIfElse",e)}}function Ip(e,t){1&e&&(s.Xb(0,"div",68),s.Sb(1,"img",69),s.Xb(2,"p",70),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"WORKSPACE.INTEGRATION.SYNC.UP_TO_DATE")," "))}function wp(e,t){if(1&e&&(s.Xb(0,"div"),s.Zc(1),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.cd("",e.name,", ",e.email,"")}}function Lp(e,t){if(1&e&&(s.Xb(0,"div",73),s.Xc(1,wp,2,2,"div",25),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",null==e.syncData?null:e.syncData.usersToSync)}}const Rp=function(e){return{count:e}};function yp(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",28),s.Xb(1,"p",53),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"strong"),s.Zc(5),s.Wb(),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"a",71),s.jc("click",(function(){s.Oc(e);const t=s.nc(2);return t.expandedUsers=!t.expandedUsers})),s.Zc(9),s.oc(10,"translate"),s.oc(11,"translate"),s.Wb(),s.Xc(12,Lp,2,1,"div",72),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.bd(" ",s.pc(3,5,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_ERROR_INFO_3_PART_1"),""),s.Cb(3),s.ad(e.syncData.usersToSync.length),s.Cb(1),s.bd(" ",s.qc(7,7,"WORKSPACE.INTEGRATION.QUICKBOOKS.SYNC_ERROR_INFO_1_PART2",s.Bc(14,Rp,e.syncData.customersToSync.length))," "),s.Cb(3),s.ad(e.expandedUsers?s.pc(10,10,"GLOBAL.HIDE_DETAILS_LABEL"):s.pc(11,12,"GLOBAL.SEE_DETAILS_LABEL")),s.Cb(3),s.wc("ngIf",e.expandedUsers)}}function _p(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.Ub()),2&e){const e=s.nc().$implicit;s.Cb(1),s.bd(" - ",e.parentCustomer.name,"")}}function kp(e,t){if(1&e&&(s.Xb(0,"div"),s.Zc(1),s.Xc(2,_p,2,1,"ng-container",5),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.bd(" ",e.name," "),s.Cb(1),s.wc("ngIf",e.parentCustomer)}}function Wp(e,t){if(1&e&&(s.Xb(0,"div",73),s.Xc(1,kp,3,2,"div",25),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",null==e.syncData?null:e.syncData.customersToSync)}}const Xp=function(e,t){return{count:e,name:t}};function Np(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"p",53),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"strong"),s.Zc(5),s.Wb(),s.Zc(6),s.oc(7,"translate"),s.oc(8,"translate"),s.Wb(),s.Xb(9,"a",71),s.jc("click",(function(){s.Oc(e);const t=s.nc(2);return t.expandedCustomers=!t.expandedCustomers})),s.Zc(10),s.oc(11,"translate"),s.oc(12,"translate"),s.Wb(),s.Xc(13,Wp,2,1,"div",72),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.bd(" ",s.pc(3,5,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_ERROR_INFO_3_PART_1"),""),s.Cb(3),s.ad(e.syncData.customersToSync.length),s.Cb(1),s.bd(" ",s.qc(7,7,"WORKSPACE.INTEGRATION.QUICKBOOKS.SYNC_ERROR_INFO_2_PART2",s.Cc(16,Xp,e.syncData.customersToSync.length,s.pc(8,10,e.integration.name)))," "),s.Cb(4),s.ad(e.expandedCustomers?s.pc(11,12,"GLOBAL.HIDE_DETAILS_LABEL"):s.pc(12,14,"GLOBAL.SEE_DETAILS_LABEL")),s.Cb(3),s.wc("ngIf",e.expandedCustomers)}}function Dp(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",74),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().doSync(t)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc(2);s.wc("disabled",e.syncInProgress||!e.syncData),s.Cb(1),s.bd(" ",s.pc(2,2,"WORKSPACE.INTEGRATION.SYNC.CREATE_MISSING")," ")}}function Pp(e,t){if(1&e&&(s.Xb(0,"div",59),s.Xb(1,"h1",60),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Sb(4,"button",61),s.Xb(5,"button",62),s.jc("click",(function(){return t.$implicit.close()})),s.Xb(6,"span"),s.Sb(7,"img",63),s.Wb(),s.Wb(),s.Wb(),s.Xb(8,"div",64),s.Xc(9,Ip,5,3,"div",65),s.Xc(10,yp,13,16,"div",66),s.Xc(11,Np,14,19,"div",5),s.Wb(),s.Xb(12,"div",54),s.Xb(13,"a",55),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Xc(16,Dp,3,4,"button",67),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,6,"GLOBAL.USERS_CUSTOMERS_SYNC_MSG")),s.Cb(7),s.wc("ngIf",e.syncData&&!(null!=e.syncData&&null!=e.syncData.usersToSync&&e.syncData.usersToSync.length)&&!(null!=e.syncData&&null!=e.syncData.customersToSync&&e.syncData.customersToSync.length)),s.Cb(1),s.wc("ngIf",null==e.syncData||null==e.syncData.usersToSync?null:e.syncData.usersToSync.length),s.Cb(1),s.wc("ngIf",null==e.syncData||null==e.syncData.customersToSync?null:e.syncData.customersToSync.length),s.Cb(3),s.ad(s.pc(15,8,"GLOBAL.CLOSE_BTN")),s.Cb(2),s.wc("ngIf",(null==e.syncData||null==e.syncData.usersToSync?null:e.syncData.usersToSync.length)||(null==e.syncData||null==e.syncData.customersToSync?null:e.syncData.customersToSync.length))}}function Mp(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",75),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().disconnect(),n.close()}))("close",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",76),s.Zc(4),s.oc(5,"translate"),s.oc(6,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,"WORKSPACE.INTEGRATION.DISCONNECT.TITLE"))("btnText",s.pc(2,6,"GLOBAL.DISCONNECT_BTN"))("isDanger",!0),s.Cb(4),s.bd(" ",s.qc(5,8,"WORKSPACE.INTEGRATION.DISCONNECT.CONFIRM_ACTION",s.Bc(13,vp,s.pc(6,11,e.integration.name)))," ")}}function Bp(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",59),s.Xb(1,"h1",60),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"img",77),s.jc("click",(function(){return t.$implicit.close()})),s.Wb(),s.Wb(),s.Xb(5,"div",78),s.Xb(6,"div",79),s.Zc(7),s.oc(8,"translate"),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Xb(10,"div",54),s.Xb(11,"a",55),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xb(14,"button",80),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc().disconnect(),n.close()})),s.Zc(15),s.oc(16,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.bd("",s.pc(3,6,"GLOBAL.DISCONNECT_BTN")," Pumble"),s.Cb(5),s.dd(" ",s.pc(8,8,"WORKSPACE.INTEGRATION.PUMBLE.DISCONNECT_MSG_1")," ",e.pumbleWorkspaceName," ",s.pc(9,10,"WORKSPACE.INTEGRATION.PUMBLE.DISCONNECT_MSG_2")," "),s.Cb(5),s.ad(s.pc(13,12,"GLOBAL.CANCEL_BTN")),s.Cb(3),s.ad(s.pc(16,14,"GLOBAL.DISCONNECT_BTN"))}}let Up=(()=>{class e extends Mu{constructor(e,t,n,i,s,c,a){super(e,t,n),this.modalService=e,this.integrationService=t,this.loader=n,this.cd=i,this.translate=s,this.sanitizer=c,this.analyticsService=a}ngOnInit(){this.integration.text=this.sanitizer.sanitize(s.J.HTML,this.translate.instant(this.integration.text)),super.ngOnInit()}ngOnDestroy(){super.ngOnDestroy()}connectToIntegration(){this.integrationService.getQuickbooksConnectUrl(this.workspaceId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.connectUrl=e,this.openWindow()},()=>{})}connectConfirm(e,t,n){this.integrationService.connectConfirmQuickbooks(e,t,n,this.workspaceId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.integration.connectionExist=!0,this.integration.tokenExpired=!1,this.analyticsService.addEvent(new Fi.a({event:"submit",value:"value",section:"Workspace settings",section2:"Integrations",section3:"Quickbooks",section4:"Connect to quickBooks"})),this.onCheckSyncData$.pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>this.openModal(this.successModal)),this.checkSyncData(!1),this.cd.markForCheck()})}checkSyncData(e=!0){this.syncData=null,this.loader.show("WORKSPACE.INTEGRATION.QUICKBOOKS.LOADER_CHECKING_USERS_MSG"),this.integrationService.checkSyncData(this.workspaceId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.syncData=t,this.loader.hide(),e&&setTimeout(()=>{this.openModal(this.syncModal)},550),this.onCheckSyncData$.next()},()=>{this.loader.hide()})}doSync(e){this.syncInProgress=!0,this.modalService.dismissAll(),this.loader.show("WORKSPACE.INTEGRATION.QUICKBOOKS.LOADER_CREATING_MISSING_USERS_MSG"),this.integrationService.doSync(this.workspaceId,this.syncData).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.syncData={usersToSync:[],customersToSync:[],usersSyncId:"",clientsSyncId:"",projectsSyncId:"",relationsSyncId:"",timeEntriesSent:0},this.syncInProgress=!1,this.loader.hide()},()=>{this.syncInProgress=!1,this.loader.hide()})}disconnect(){this.loader.show(),this.integrationService.disconnectQuickbooks(this.workspaceId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.integration.connectionExist=!1,this.loader.hide(),this.cd.markForCheck()},()=>{this.loader.hide()})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q),s.Rb(ut),s.Rb(Hn.a),s.Rb(s.h),s.Rb(g.f),s.Rb(Bu.b),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["quickbook-integration"]],features:[s.zb],decls:29,vars:14,consts:[[1,"cl-d-flex","cl-mx-n2","cl-mx-lg-n3","cl-p-3",3,"click"],[1,"pointer",3,"src","click"],[1,"cl-w-100","cl-ml-3"],[1,"cl-d-flex","cl-align-items-center","cl-mb-1"],[1,"cl-mb-0","cl-mr-2","pointer",3,"click"],[4,"ngIf"],[1,"cl-text-gray-9"],["class","cl-mt-3",4,"ngIf"],[1,"cl-badge-same-entries-wrapper",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-ml-0"],["src","/assets/images/ui-icons/chevron-down.svg"],["emailNotVerifiedModal",""],["emailVerifiedConnectionModals",""],["successModal",""],["syncModal",""],["deleteConfirm",""],["disconnectPumble",""],[1,"cl-badge","cl-badge-success"],[1,"cl-badge","cl-badge-danger"],[1,"cl-mt-3"],["class","cl-mb-2",3,"innerHTML",4,"ngIf","ngIfElse"],["otherIntegrations",""],["class","cl-pl-3",4,"ngIf"],["class","cl-mb-3",4,"ngIf"],[1,"cl-d-flex","cl-justify-content-between"],[4,"ngFor","ngForOf"],["class","cl-text-danger",3,"click",4,"ngIf"],[1,"cl-mb-2",3,"innerHTML"],[1,"cl-mb-2"],[1,"cl-pl-3"],[1,"cl-custom-control","cl-custom-switch","cl-margin"],["id","showPumbleWidget","type","checkbox",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","showPumbleWidget",1,"cl-custom-control-label"],[1,"cl-mb-3"],["class","cl-btn cl-quickbooks-btn-green",3,"click",4,"ngIf"],["name","connectToQB",3,"ngClass","click",4,"ngIf"],["class","cl-btn cl-btn-success",3,"click",4,"ngIf"],["class","cl-btn",3,"ngClass","click",4,"ngIf"],[1,"cl-btn","cl-quickbooks-btn-green",3,"click"],["syncBtn",""],["name","connectToQB",3,"ngClass","click"],["connectBtn",""],[1,"cl-btn","cl-btn-success",3,"click"],[1,"cl-btn",3,"ngClass","click"],["reconnectBtn",""],["target","_blank",3,"href"],[1,"cl-text-danger",3,"click"],["disconnectBtn",""],[3,"close"],[3,"workspaceId","integration","pumbleSettings","close"],[1,"cl-modal-body","cl-text-center","cl-py-4"],["src","assets/images/illustrations/success.svg",1,"cl-img-fluid"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-mb-0","cl-text-gray-6"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["class","cl-btn cl-btn-primary","ngbAutofocus","",3,"click",4,"ngIf","ngIfElse"],["okBtnTemplate",""],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button","ngbAutofocus",""],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body","cl-py-3"],["class","cl-d-flex cl-align-items-center",4,"ngIf"],["class","cl-mb-2",4,"ngIf"],["class","cl-btn cl-btn-primary",3,"disabled","click",4,"ngIf"],[1,"cl-d-flex","cl-align-items-center"],["src","assets/images/success.svg","ngbAutofocus","",1,"cl-mr-3"],["ngbAutofocus","",1,"cl-mb-0"],[1,"cl-mb-1","cl-d-inline-block",3,"click"],["class","cl-scroll-area cl-ml-2","style","max-height: 100px; overflow-y: auto;",4,"ngIf"],[1,"cl-scroll-area","cl-ml-2",2,"max-height","100px","overflow-y","auto"],[1,"cl-btn","cl-btn-primary",3,"disabled","click"],[3,"title","btnText","isDanger","confirmed","close"],[1,"cl-text-dark","cl-mb-0"],["src","assets/ui-icons/close.svg",3,"click"],[1,"cl-modal-body"],[1,"cl-text-break","cl-text-color"],["type","submit",1,"cl-btn","cl-btn-danger",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.jc("click",(function(){return t.expandEntireComponent()})),s.Xb(1,"div"),s.Xb(2,"img",1),s.jc("click",(function(e){return t.integration.isExpanded=!t.integration.isExpanded,e.stopPropagation()})),s.Wb(),s.Wb(),s.Xb(3,"div",2),s.Xb(4,"div",3),s.Xb(5,"h2",4),s.jc("click",(function(e){return t.integration.isExpanded=!t.integration.isExpanded,e.stopPropagation()})),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xc(8,Ju,4,3,"ng-container",5),s.Xc(9,ep,4,3,"ng-container",5),s.Wb(),s.Xb(10,"div",6),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xc(13,fp,12,8,"div",7),s.Wb(),s.Xb(14,"a",8),s.jc("click",(function(e){return t.integration.isExpanded=!t.integration.isExpanded,e.stopPropagation()})),s.Xb(15,"span",9),s.Sb(16,"img",10),s.Wb(),s.Wb(),s.Wb(),s.Xc(17,Sp,1,0,"ng-template",null,11,s.Yc),s.Xc(19,Cp,1,3,"ng-template",null,12,s.Yc),s.Xc(21,Tp,17,16,"ng-template",null,13,s.Yc),s.Xc(23,Pp,17,10,"ng-template",null,14,s.Yc),s.Xc(25,Mp,7,15,"ng-template",null,15,s.Yc),s.Xc(27,Bp,17,16,"ng-template",null,16,s.Yc)),2&e&&(s.Hb("cl-component-clickable",!t.integration.isExpanded)("cl-border-top",t.integration.isFree),s.Cb(2),s.wc("src",t.integration.logoUrl,s.Qc),s.Cb(4),s.bd(" ",s.pc(7,10,t.integration.name)," "),s.Cb(2),s.wc("ngIf",t.integration.connectionExist&&!t.integration.tokenExpired),s.Cb(1),s.wc("ngIf",t.integration.connectionExist&&t.integration.tokenExpired),s.Cb(2),s.ad(s.pc(12,12,t.integration.title)),s.Cb(2),s.wc("ngIf",t.integration.isExpanded))},directives:[i.u,i.t,v.a,v.s,v.v,i.r,Uu,Qu,Si.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function Gp(e,t){1&e&&(s.Vb(0),s.Xb(1,"span",17),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Ub()),2&e&&(s.Cb(2),s.ad(s.pc(3,1,"GLOBAL.CONNECTED_BADGE")))}function xp(e,t){1&e&&(s.Vb(0),s.Xb(1,"span",18),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Ub()),2&e&&(s.Cb(2),s.ad(s.pc(3,1,"WORKSPACE.INTEGRATION.EXPIRED")))}function Fp(e,t){if(1&e&&s.Sb(0,"p",27),2&e){const e=s.nc(2);s.wc("innerHTML",e.integration.text,s.Pc)}}function jp(e,t){if(1&e&&(s.Xb(0,"p",28),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.ad(s.pc(2,1,e.integration.text))}}function Zp(e,t){if(1&e&&(s.Xb(0,"li"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.ad(s.pc(2,1,e))}}function Vp(e,t){if(1&e&&(s.Xb(0,"ul",29),s.Xc(1,Zp,3,3,"li",25),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngForOf",e.integration.bulletsList)}}function Yp(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",30),s.Xb(2,"input",31),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc(2).onShowPumbleWidgetChange(t)})),s.Wb(),s.Xb(3,"label",32),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc(2);s.Cb(2),s.wc("ngModel",e.showPumbleWidget),s.Cb(2),s.bd(" ",s.pc(5,2,"WORKSPACE.INTEGRATION.PUMBLE.SHOW_WIDGET")," ")}}function Hp(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",38,39),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1),n=s.nc(3);return t.blur(),n.checkSyncData()})),s.Zc(2),s.oc(3,"translate"),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"WORKSPACE.INTEGRATION.QUICKBOOKS.SYNC")," "))}function $p(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.oc(3,"translate"),s.Ub()),2&e){const e=s.nc(4);s.Cb(1),s.cd(" ",s.pc(2,2,"WORKSPACE.INTEGRATION.CONNECT_TO")," ",s.pc(3,4,e.integration.name)," ")}}const Kp=function(e,t){return{"cl-quickbooks-btn":e,"cl-btn cl-btn-primary":t}};function qp(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",40,41),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1);return s.nc(3).connectToIntegration(),t.blur()})),s.Xc(2,$p,4,6,"ng-container",5),s.Wb()}if(2&e){const e=s.nc(3);s.wc("ngClass",s.Cc(2,Kp,"WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"===e.integration.name,"WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"!==e.integration.name)),s.Cb(2),s.wc("ngIf","WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"!==e.integration.name)}}function zp(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.INTEGRATION.PUMBLE.ENABLE_CHAT")," "))}function Qp(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",42,41),s.jc("click",(function(){return s.Oc(e),s.nc(3).openConnectionModal()})),s.Xc(2,zp,3,3,"ng-container",5),s.Wb()}if(2&e){const e=s.nc(3);s.Cb(2),s.wc("ngIf","WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"!==e.integration.name)}}const Jp=function(e,t){return{"cl-quickbooks-btn-green":e,"cl-btn-primary":t}};function eh(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",43,44),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1);return s.nc(3).connectToIntegration(),t.blur()})),s.Zc(2),s.oc(3,"translate"),s.Wb()}if(2&e){const e=s.nc(3);s.wc("ngClass",s.Cc(4,Jp,"WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"===e.integration.name,"WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"==e.integration.name)),s.Cb(2),s.bd(" ",s.pc(3,2,"WORKSPACE.INTEGRATION.RECONNECT")," ")}}function th(e,t){if(1&e&&(s.Xb(0,"div",33),s.Xc(1,Hp,4,3,"button",34),s.Xc(2,qp,3,5,"button",35),s.Xc(3,Qp,3,1,"button",36),s.Xc(4,eh,4,7,"button",37),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",e.integration.connectionExist&&!e.integration.tokenExpired&&"WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"!==e.integration.name),s.Cb(1),s.wc("ngIf",!e.integration.connectionExist&&"WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"!==e.integration.name),s.Cb(1),s.wc("ngIf",!e.integration.connectionExist&&"WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"===e.integration.name),s.Cb(1),s.wc("ngIf",e.integration.connectionExist&&e.integration.tokenExpired)}}function nh(e,t){if(1&e&&(s.Xb(0,"div"),s.Xb(1,"a",45),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.wc("href",e.url,s.Qc),s.Cb(1),s.ad(s.pc(3,2,e.label))}}function ih(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",46,47),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1),n=s.nc(2),i=s.Lc(26);return n.openModal(i),t.blur()})),s.Zc(2),s.oc(3,"translate"),s.oc(4,"translate"),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.cd("",s.pc(3,2,"WORKSPACE.INTEGRATION.DISCONNECT.FROM")," ",s.pc(4,4,e.integration.name),"")}}function sh(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",46,47),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1),n=s.nc(2),i=s.Lc(28);return n.getWorkspaceName(),n.openModal(i),t.blur()})),s.Zc(2),s.oc(3,"translate"),s.oc(4,"translate"),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.cd("",s.pc(3,2,"WORKSPACE.INTEGRATION.DISCONNECT.FROM")," ",s.pc(4,4,e.integration.name),"")}}function ch(e,t){if(1&e&&(s.Xb(0,"div",19),s.Xc(1,Fp,1,1,"p",20),s.Xc(2,jp,3,3,"ng-template",null,21,s.Yc),s.Xc(4,Vp,2,1,"ul",22),s.Xc(5,Yp,6,4,"ng-container",5),s.Xc(6,th,5,4,"div",23),s.Xb(7,"div",24),s.Xb(8,"div"),s.Xc(9,nh,4,4,"div",25),s.Wb(),s.Xc(10,ih,5,6,"button",26),s.Xc(11,sh,5,6,"button",26),s.Wb(),s.Wb()),2&e){const e=s.Lc(3),t=s.nc();s.Cb(1),s.wc("ngIf","quickbooks"===t.integration.type||"pumble"===t.integration.type)("ngIfElse",e),s.Cb(3),s.wc("ngIf",t.integration.bulletsList),s.Cb(1),s.wc("ngIf","WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"===t.integration.name&&!t.integration.connectionExist&&!t.isAloneOnWs),s.Cb(1),s.wc("ngIf",t.integration.showConnect),s.Cb(3),s.wc("ngForOf",t.integration.links),s.Cb(1),s.wc("ngIf","WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"!==t.integration.name&&t.integration.connectionExist&&!t.integration.tokenExpired&&t.integration.showConnect),s.Cb(1),s.wc("ngIf","WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"===t.integration.name&&t.integration.connectionExist&&!t.integration.tokenExpired)}}function ah(e,t){1&e&&(s.Xb(0,"verify-email-modal",48),s.jc("close",(function(){return t.$implicit.close()})),s.Wb())}function oh(e,t){if(1&e&&(s.Xb(0,"pumble-integration-modals",49),s.jc("close",(function(){return t.$implicit.close()})),s.Wb()),2&e){const e=s.nc();s.wc("workspaceId",e.workspaceId)("integration",e.integration)("pumbleSettings",e.pumbleSettings)}}function rh(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",58),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit,n=s.nc(),i=s.Lc(24);return t.close(),n.openModal(i)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.NEXT_LABEL")," "))}function lh(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",58),s.jc("click",(function(){return s.Oc(e),s.nc().$implicit.close()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.CONFIRM_OK_BTN")))}const bh=function(e){return{value:e}};function dh(e,t){if(1&e&&(s.Xb(0,"div",50),s.Xb(1,"div",33),s.Sb(2,"img",51),s.Wb(),s.Xb(3,"div",52),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"p",53),s.Zc(7),s.oc(8,"translate"),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Xb(10,"div",54),s.Xb(11,"a",55),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xc(14,rh,3,3,"button",56),s.Xc(15,lh,3,3,"ng-template",null,57,s.Yc),s.Wb()),2&e){const e=s.Lc(16),t=s.nc();s.Cb(4),s.ad(s.pc(5,5,"GLOBAL.SUCCESS_MSG")),s.Cb(3),s.bd(" ",s.qc(8,7,"WORKSPACE.INTEGRATION.CONNECTED_TO",s.Bc(14,bh,s.pc(9,10,t.integration.name)))," "),s.Cb(5),s.ad(s.pc(13,12,"GLOBAL.CLOSE_BTN")),s.Cb(2),s.wc("ngIf",(null==t.syncData||null==t.syncData.usersToSync?null:t.syncData.usersToSync.length)||(null==t.syncData||null==t.syncData.customersToSync?null:t.syncData.customersToSync.length))("ngIfElse",e)}}function uh(e,t){1&e&&(s.Xb(0,"div",68),s.Sb(1,"img",69),s.Xb(2,"p",70),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"WORKSPACE.INTEGRATION.SYNC.UP_TO_DATE")," "))}function ph(e,t){if(1&e&&(s.Xb(0,"div"),s.Zc(1),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.cd("",e.name,", ",e.email,"")}}function hh(e,t){if(1&e&&(s.Xb(0,"div",73),s.Xc(1,ph,2,2,"div",25),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",null==e.syncData?null:e.syncData.usersToSync)}}const mh=function(e){return{count:e}};function gh(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",28),s.Xb(1,"p",53),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"strong"),s.Zc(5),s.Wb(),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"a",71),s.jc("click",(function(){s.Oc(e);const t=s.nc(2);return t.expandedUsers=!t.expandedUsers})),s.Zc(9),s.oc(10,"translate"),s.oc(11,"translate"),s.Wb(),s.Xc(12,hh,2,1,"div",72),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.bd(" ",s.pc(3,5,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_ERROR_INFO_3_PART_1"),""),s.Cb(3),s.ad(e.syncData.usersToSync.length),s.Cb(1),s.bd(" ",s.qc(7,7,"WORKSPACE.INTEGRATION.QUICKBOOKS.SYNC_ERROR_INFO_1_PART2",s.Bc(14,mh,e.syncData.customersToSync.length))," "),s.Cb(3),s.ad(e.expandedUsers?s.pc(10,10,"GLOBAL.HIDE_DETAILS_LABEL"):s.pc(11,12,"GLOBAL.SEE_DETAILS_LABEL")),s.Cb(3),s.wc("ngIf",e.expandedUsers)}}function Eh(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.Ub()),2&e){const e=s.nc().$implicit;s.Cb(1),s.bd(" - ",e.parentCustomer.name,"")}}function fh(e,t){if(1&e&&(s.Xb(0,"div"),s.Zc(1),s.Xc(2,Eh,2,1,"ng-container",5),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.bd(" ",e.name," "),s.Cb(1),s.wc("ngIf",e.parentCustomer)}}function Sh(e,t){if(1&e&&(s.Xb(0,"div",73),s.Xc(1,fh,3,2,"div",25),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",null==e.syncData?null:e.syncData.customersToSync)}}const Ch=function(e,t){return{count:e,name:t}};function Ah(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"p",53),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"strong"),s.Zc(5),s.Wb(),s.Zc(6),s.oc(7,"translate"),s.oc(8,"translate"),s.Wb(),s.Xb(9,"a",71),s.jc("click",(function(){s.Oc(e);const t=s.nc(2);return t.expandedCustomers=!t.expandedCustomers})),s.Zc(10),s.oc(11,"translate"),s.oc(12,"translate"),s.Wb(),s.Xc(13,Sh,2,1,"div",72),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.bd(" ",s.pc(3,5,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_ERROR_INFO_3_PART_1"),""),s.Cb(3),s.ad(e.syncData.customersToSync.length),s.Cb(1),s.bd(" ",s.qc(7,7,"WORKSPACE.INTEGRATION.QUICKBOOKS.SYNC_ERROR_INFO_2_PART2",s.Cc(16,Ch,e.syncData.customersToSync.length,s.pc(8,10,e.integration.name)))," "),s.Cb(4),s.ad(e.expandedCustomers?s.pc(11,12,"GLOBAL.HIDE_DETAILS_LABEL"):s.pc(12,14,"GLOBAL.SEE_DETAILS_LABEL")),s.Cb(3),s.wc("ngIf",e.expandedCustomers)}}function Oh(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",74),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().doSync(t)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc(2);s.wc("disabled",e.syncInProgress||!e.syncData),s.Cb(1),s.bd(" ",s.pc(2,2,"WORKSPACE.INTEGRATION.SYNC.CREATE_MISSING")," ")}}function vh(e,t){if(1&e&&(s.Xb(0,"div",59),s.Xb(1,"h1",60),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Sb(4,"button",61),s.Xb(5,"button",62),s.jc("click",(function(){return t.$implicit.close()})),s.Xb(6,"span"),s.Sb(7,"img",63),s.Wb(),s.Wb(),s.Wb(),s.Xb(8,"div",64),s.Xc(9,uh,5,3,"div",65),s.Xc(10,gh,13,16,"div",66),s.Xc(11,Ah,14,19,"div",5),s.Wb(),s.Xb(12,"div",54),s.Xb(13,"a",55),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Xc(16,Oh,3,4,"button",67),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,6,"GLOBAL.USERS_CUSTOMERS_SYNC_MSG")),s.Cb(7),s.wc("ngIf",e.syncData&&!(null!=e.syncData&&null!=e.syncData.usersToSync&&e.syncData.usersToSync.length)&&!(null!=e.syncData&&null!=e.syncData.customersToSync&&e.syncData.customersToSync.length)),s.Cb(1),s.wc("ngIf",null==e.syncData||null==e.syncData.usersToSync?null:e.syncData.usersToSync.length),s.Cb(1),s.wc("ngIf",null==e.syncData||null==e.syncData.customersToSync?null:e.syncData.customersToSync.length),s.Cb(3),s.ad(s.pc(15,8,"GLOBAL.CLOSE_BTN")),s.Cb(2),s.wc("ngIf",(null==e.syncData||null==e.syncData.usersToSync?null:e.syncData.usersToSync.length)||(null==e.syncData||null==e.syncData.customersToSync?null:e.syncData.customersToSync.length))}}function Th(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",75),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().disconnect(),n.close()}))("close",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",76),s.Zc(4),s.oc(5,"translate"),s.oc(6,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,"WORKSPACE.INTEGRATION.DISCONNECT.TITLE"))("btnText",s.pc(2,6,"GLOBAL.DISCONNECT_BTN"))("isDanger",!0),s.Cb(4),s.bd(" ",s.qc(5,8,"WORKSPACE.INTEGRATION.DISCONNECT.CONFIRM_ACTION",s.Bc(13,bh,s.pc(6,11,e.integration.name)))," ")}}function Ih(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",59),s.Xb(1,"h1",60),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"img",77),s.jc("click",(function(){return t.$implicit.close()})),s.Wb(),s.Wb(),s.Xb(5,"div",78),s.Xb(6,"div",79),s.Zc(7),s.oc(8,"translate"),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Xb(10,"div",54),s.Xb(11,"a",55),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xb(14,"button",80),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc().disconnect(),n.close()})),s.Zc(15),s.oc(16,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.bd("",s.pc(3,6,"GLOBAL.DISCONNECT_BTN")," Pumble"),s.Cb(5),s.dd(" ",s.pc(8,8,"WORKSPACE.INTEGRATION.PUMBLE.DISCONNECT_MSG_1")," ",e.pumbleWorkspaceName," ",s.pc(9,10,"WORKSPACE.INTEGRATION.PUMBLE.DISCONNECT_MSG_2")," "),s.Cb(5),s.ad(s.pc(13,12,"GLOBAL.CANCEL_BTN")),s.Cb(3),s.ad(s.pc(16,14,"GLOBAL.DISCONNECT_BTN"))}}let wh=(()=>{class e extends Mu{constructor(e,t,n){super(e,t,n),this.modalService=e,this.integrationService=t,this.loader=n}ngOnInit(){super.ngOnInit()}ngOnDestroy(){super.ngOnDestroy()}connectConfirm(e,t,n){}sync(e){}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q),s.Rb(ut),s.Rb(Hn.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["jira-integration"]],features:[s.zb],decls:29,vars:14,consts:[[1,"cl-d-flex","cl-mx-n2","cl-mx-lg-n3","cl-p-3",3,"click"],[1,"pointer",3,"src","click"],[1,"cl-w-100","cl-ml-3"],[1,"cl-d-flex","cl-align-items-center","cl-mb-1"],[1,"cl-mb-0","cl-mr-2","pointer",3,"click"],[4,"ngIf"],[1,"cl-text-gray-9"],["class","cl-mt-3",4,"ngIf"],[1,"cl-badge-same-entries-wrapper",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-ml-0"],["src","/assets/images/ui-icons/chevron-down.svg"],["emailNotVerifiedModal",""],["emailVerifiedConnectionModals",""],["successModal",""],["syncModal",""],["deleteConfirm",""],["disconnectPumble",""],[1,"cl-badge","cl-badge-success"],[1,"cl-badge","cl-badge-danger"],[1,"cl-mt-3"],["class","cl-mb-2",3,"innerHTML",4,"ngIf","ngIfElse"],["otherIntegrations",""],["class","cl-pl-3",4,"ngIf"],["class","cl-mb-3",4,"ngIf"],[1,"cl-d-flex","cl-justify-content-between"],[4,"ngFor","ngForOf"],["class","cl-text-danger",3,"click",4,"ngIf"],[1,"cl-mb-2",3,"innerHTML"],[1,"cl-mb-2"],[1,"cl-pl-3"],[1,"cl-custom-control","cl-custom-switch","cl-margin"],["id","showPumbleWidget","type","checkbox",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","showPumbleWidget",1,"cl-custom-control-label"],[1,"cl-mb-3"],["class","cl-btn cl-quickbooks-btn-green",3,"click",4,"ngIf"],["name","connectToQB",3,"ngClass","click",4,"ngIf"],["class","cl-btn cl-btn-success",3,"click",4,"ngIf"],["class","cl-btn",3,"ngClass","click",4,"ngIf"],[1,"cl-btn","cl-quickbooks-btn-green",3,"click"],["syncBtn",""],["name","connectToQB",3,"ngClass","click"],["connectBtn",""],[1,"cl-btn","cl-btn-success",3,"click"],[1,"cl-btn",3,"ngClass","click"],["reconnectBtn",""],["target","_blank",3,"href"],[1,"cl-text-danger",3,"click"],["disconnectBtn",""],[3,"close"],[3,"workspaceId","integration","pumbleSettings","close"],[1,"cl-modal-body","cl-text-center","cl-py-4"],["src","assets/images/illustrations/success.svg",1,"cl-img-fluid"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-mb-0","cl-text-gray-6"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["class","cl-btn cl-btn-primary","ngbAutofocus","",3,"click",4,"ngIf","ngIfElse"],["okBtnTemplate",""],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button","ngbAutofocus",""],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body","cl-py-3"],["class","cl-d-flex cl-align-items-center",4,"ngIf"],["class","cl-mb-2",4,"ngIf"],["class","cl-btn cl-btn-primary",3,"disabled","click",4,"ngIf"],[1,"cl-d-flex","cl-align-items-center"],["src","assets/images/success.svg","ngbAutofocus","",1,"cl-mr-3"],["ngbAutofocus","",1,"cl-mb-0"],[1,"cl-mb-1","cl-d-inline-block",3,"click"],["class","cl-scroll-area cl-ml-2","style","max-height: 100px; overflow-y: auto;",4,"ngIf"],[1,"cl-scroll-area","cl-ml-2",2,"max-height","100px","overflow-y","auto"],[1,"cl-btn","cl-btn-primary",3,"disabled","click"],[3,"title","btnText","isDanger","confirmed","close"],[1,"cl-text-dark","cl-mb-0"],["src","assets/ui-icons/close.svg",3,"click"],[1,"cl-modal-body"],[1,"cl-text-break","cl-text-color"],["type","submit",1,"cl-btn","cl-btn-danger",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.jc("click",(function(){return t.expandEntireComponent()})),s.Xb(1,"div"),s.Xb(2,"img",1),s.jc("click",(function(e){return t.integration.isExpanded=!t.integration.isExpanded,e.stopPropagation()})),s.Wb(),s.Wb(),s.Xb(3,"div",2),s.Xb(4,"div",3),s.Xb(5,"h2",4),s.jc("click",(function(e){return t.integration.isExpanded=!t.integration.isExpanded,e.stopPropagation()})),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xc(8,Gp,4,3,"ng-container",5),s.Xc(9,xp,4,3,"ng-container",5),s.Wb(),s.Xb(10,"div",6),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xc(13,ch,12,8,"div",7),s.Wb(),s.Xb(14,"a",8),s.jc("click",(function(e){return t.integration.isExpanded=!t.integration.isExpanded,e.stopPropagation()})),s.Xb(15,"span",9),s.Sb(16,"img",10),s.Wb(),s.Wb(),s.Wb(),s.Xc(17,ah,1,0,"ng-template",null,11,s.Yc),s.Xc(19,oh,1,3,"ng-template",null,12,s.Yc),s.Xc(21,dh,17,16,"ng-template",null,13,s.Yc),s.Xc(23,vh,17,10,"ng-template",null,14,s.Yc),s.Xc(25,Th,7,15,"ng-template",null,15,s.Yc),s.Xc(27,Ih,17,16,"ng-template",null,16,s.Yc)),2&e&&(s.Hb("cl-component-clickable",!t.integration.isExpanded)("cl-border-top",t.integration.isFree),s.Cb(2),s.wc("src",t.integration.logoUrl,s.Qc),s.Cb(4),s.bd(" ",s.pc(7,10,t.integration.name)," "),s.Cb(2),s.wc("ngIf",t.integration.connectionExist&&!t.integration.tokenExpired),s.Cb(1),s.wc("ngIf",t.integration.connectionExist&&t.integration.tokenExpired),s.Cb(2),s.ad(s.pc(12,12,t.integration.title)),s.Cb(2),s.wc("ngIf",t.integration.isExpanded))},directives:[i.u,i.t,v.a,v.s,v.v,i.r,Uu,Qu,Si.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var Lh=n("/uUt"),Rh=n("D0XW");const yh=(()=>{function e(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return e.prototype=Object.create(Error.prototype),e})();var _h=n("mlxB"),kh=n("l7GE"),Wh=n("ZUHj");class Xh{constructor(e,t,n,i){this.waitFor=e,this.absoluteTimeout=t,this.withObservable=n,this.scheduler=i}call(e,t){return t.subscribe(new Nh(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))}}class Nh extends kh.a{constructor(e,t,n,i,s){super(e),this.absoluteTimeout=t,this.waitFor=n,this.withObservable=i,this.scheduler=s,this.action=null,this.scheduleTimeout()}static dispatchTimeout(e){const{withObservable:t}=e;e._unsubscribeAndRecycle(),e.add(Object(Wh.a)(e,t))}scheduleTimeout(){const{action:e}=this;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(Nh.dispatchTimeout,this.waitFor,this))}_next(e){this.absoluteTimeout||this.scheduleTimeout(),super._next(e)}_unsubscribe(){this.action=null,this.scheduler=null,this.withObservable=null}}function Dh(e,t=Rh.a){return function(e,t,n=Rh.a){return i=>{let s=Object(_h.a)(e),c=s?+e-n.now():Math.abs(e);return i.lift(new Xh(c,s,t,n))}}(e,Object(cs.a)(new yh),t)}class Ph{constructor(e,t){this._id=e,this._name=t}get id(){return this._id}set id(e){this._id=e}get name(){return this._name}set name(e){this._name=e}}const Mh=["emailVerifiedConnectionModals"],Bh=["emailNotVerifiedModal"];function Uh(e,t){1&e&&(s.Vb(0),s.Xb(1,"span",17),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Ub()),2&e&&(s.Cb(2),s.ad(s.pc(3,1,"GLOBAL.CONNECTED_BADGE")))}function Gh(e,t){1&e&&(s.Vb(0),s.Xb(1,"span",18),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Ub()),2&e&&(s.Cb(2),s.ad(s.pc(3,1,"WORKSPACE.INTEGRATION.EXPIRED")))}function xh(e,t){if(1&e&&s.Sb(0,"p",27),2&e){const e=s.nc(2);s.wc("innerHTML",e.integration.text,s.Pc)}}function Fh(e,t){if(1&e&&(s.Xb(0,"p",28),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.ad(s.pc(2,1,e.integration.text))}}function jh(e,t){if(1&e&&(s.Xb(0,"li"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.ad(s.pc(2,1,e))}}function Zh(e,t){if(1&e&&(s.Xb(0,"ul",29),s.Xc(1,jh,3,3,"li",25),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngForOf",e.integration.bulletsList)}}function Vh(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",30),s.Xb(2,"input",31),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc(2).onShowPumbleWidgetChange(t)})),s.Wb(),s.Xb(3,"label",32),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc(2);s.Cb(2),s.wc("ngModel",e.showPumbleWidget),s.Cb(2),s.bd(" ",s.pc(5,2,"WORKSPACE.INTEGRATION.PUMBLE.SHOW_WIDGET")," ")}}function Yh(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",38,39),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1),n=s.nc(3);return t.blur(),n.checkSyncData()})),s.Zc(2),s.oc(3,"translate"),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"WORKSPACE.INTEGRATION.QUICKBOOKS.SYNC")," "))}function Hh(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.oc(3,"translate"),s.Ub()),2&e){const e=s.nc(4);s.Cb(1),s.cd(" ",s.pc(2,2,"WORKSPACE.INTEGRATION.CONNECT_TO")," ",s.pc(3,4,e.integration.name)," ")}}const $h=function(e,t){return{"cl-quickbooks-btn":e,"cl-btn cl-btn-primary":t}};function Kh(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",40,41),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1);return s.nc(3).connectToIntegration(),t.blur()})),s.Xc(2,Hh,4,6,"ng-container",5),s.Wb()}if(2&e){const e=s.nc(3);s.wc("ngClass",s.Cc(2,$h,"WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"===e.integration.name,"WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"!==e.integration.name)),s.Cb(2),s.wc("ngIf","WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"!==e.integration.name)}}function qh(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.INTEGRATION.PUMBLE.ENABLE_CHAT")," "))}function zh(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",42,41),s.jc("click",(function(){return s.Oc(e),s.nc(3).openConnectionModal()})),s.Xc(2,qh,3,3,"ng-container",5),s.Wb()}if(2&e){const e=s.nc(3);s.Cb(2),s.wc("ngIf","WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"!==e.integration.name)}}const Qh=function(e,t){return{"cl-quickbooks-btn-green":e,"cl-btn-primary":t}};function Jh(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",43,44),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1);return s.nc(3).connectToIntegration(),t.blur()})),s.Zc(2),s.oc(3,"translate"),s.Wb()}if(2&e){const e=s.nc(3);s.wc("ngClass",s.Cc(4,Qh,"WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"===e.integration.name,"WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME"==e.integration.name)),s.Cb(2),s.bd(" ",s.pc(3,2,"WORKSPACE.INTEGRATION.RECONNECT")," ")}}function em(e,t){if(1&e&&(s.Xb(0,"div",33),s.Xc(1,Yh,4,3,"button",34),s.Xc(2,Kh,3,5,"button",35),s.Xc(3,zh,3,1,"button",36),s.Xc(4,Jh,4,7,"button",37),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",e.integration.connectionExist&&!e.integration.tokenExpired&&"WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"!==e.integration.name),s.Cb(1),s.wc("ngIf",!e.integration.connectionExist&&"WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"!==e.integration.name),s.Cb(1),s.wc("ngIf",!e.integration.connectionExist&&"WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"===e.integration.name),s.Cb(1),s.wc("ngIf",e.integration.connectionExist&&e.integration.tokenExpired)}}function tm(e,t){if(1&e&&(s.Xb(0,"div"),s.Xb(1,"a",45),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.wc("href",e.url,s.Qc),s.Cb(1),s.ad(s.pc(3,2,e.label))}}function nm(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",46,47),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1),n=s.nc(2),i=s.Lc(26);return n.openModal(i),t.blur()})),s.Zc(2),s.oc(3,"translate"),s.oc(4,"translate"),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.cd("",s.pc(3,2,"WORKSPACE.INTEGRATION.DISCONNECT.FROM")," ",s.pc(4,4,e.integration.name),"")}}function im(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",46,47),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1),n=s.nc(2),i=s.Lc(28);return n.getWorkspaceName(),n.openModal(i),t.blur()})),s.Zc(2),s.oc(3,"translate"),s.oc(4,"translate"),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.cd("",s.pc(3,2,"WORKSPACE.INTEGRATION.DISCONNECT.FROM")," ",s.pc(4,4,e.integration.name),"")}}function sm(e,t){if(1&e&&(s.Xb(0,"div",19),s.Xc(1,xh,1,1,"p",20),s.Xc(2,Fh,3,3,"ng-template",null,21,s.Yc),s.Xc(4,Zh,2,1,"ul",22),s.Xc(5,Vh,6,4,"ng-container",5),s.Xc(6,em,5,4,"div",23),s.Xb(7,"div",24),s.Xb(8,"div"),s.Xc(9,tm,4,4,"div",25),s.Wb(),s.Xc(10,nm,5,6,"button",26),s.Xc(11,im,5,6,"button",26),s.Wb(),s.Wb()),2&e){const e=s.Lc(3),t=s.nc();s.Cb(1),s.wc("ngIf","quickbooks"===t.integration.type||"pumble"===t.integration.type)("ngIfElse",e),s.Cb(3),s.wc("ngIf",t.integration.bulletsList),s.Cb(1),s.wc("ngIf","WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"===t.integration.name&&!t.integration.connectionExist&&!t.isAloneOnWs),s.Cb(1),s.wc("ngIf",t.integration.showConnect),s.Cb(3),s.wc("ngForOf",t.integration.links),s.Cb(1),s.wc("ngIf","WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"!==t.integration.name&&t.integration.connectionExist&&!t.integration.tokenExpired&&t.integration.showConnect),s.Cb(1),s.wc("ngIf","WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME"===t.integration.name&&t.integration.connectionExist&&!t.integration.tokenExpired)}}function cm(e,t){1&e&&(s.Xb(0,"verify-email-modal",48),s.jc("close",(function(){return t.$implicit.close()})),s.Wb())}function am(e,t){if(1&e&&(s.Xb(0,"pumble-integration-modals",49),s.jc("close",(function(){return t.$implicit.close()})),s.Wb()),2&e){const e=s.nc();s.wc("workspaceId",e.workspaceId)("integration",e.integration)("pumbleSettings",e.pumbleSettings)}}function om(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",58),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit,n=s.nc(),i=s.Lc(24);return t.close(),n.openModal(i)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.NEXT_LABEL")," "))}function rm(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",58),s.jc("click",(function(){return s.Oc(e),s.nc().$implicit.close()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.CONFIRM_OK_BTN")))}const lm=function(e){return{value:e}};function bm(e,t){if(1&e&&(s.Xb(0,"div",50),s.Xb(1,"div",33),s.Sb(2,"img",51),s.Wb(),s.Xb(3,"div",52),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"p",53),s.Zc(7),s.oc(8,"translate"),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Xb(10,"div",54),s.Xb(11,"a",55),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xc(14,om,3,3,"button",56),s.Xc(15,rm,3,3,"ng-template",null,57,s.Yc),s.Wb()),2&e){const e=s.Lc(16),t=s.nc();s.Cb(4),s.ad(s.pc(5,5,"GLOBAL.SUCCESS_MSG")),s.Cb(3),s.bd(" ",s.qc(8,7,"WORKSPACE.INTEGRATION.CONNECTED_TO",s.Bc(14,lm,s.pc(9,10,t.integration.name)))," "),s.Cb(5),s.ad(s.pc(13,12,"GLOBAL.CLOSE_BTN")),s.Cb(2),s.wc("ngIf",(null==t.syncData||null==t.syncData.usersToSync?null:t.syncData.usersToSync.length)||(null==t.syncData||null==t.syncData.customersToSync?null:t.syncData.customersToSync.length))("ngIfElse",e)}}function dm(e,t){1&e&&(s.Xb(0,"div",68),s.Sb(1,"img",69),s.Xb(2,"p",70),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"WORKSPACE.INTEGRATION.SYNC.UP_TO_DATE")," "))}function um(e,t){if(1&e&&(s.Xb(0,"div"),s.Zc(1),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.cd("",e.name,", ",e.email,"")}}function pm(e,t){if(1&e&&(s.Xb(0,"div",73),s.Xc(1,um,2,2,"div",25),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",null==e.syncData?null:e.syncData.usersToSync)}}const hm=function(e){return{count:e}};function mm(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",28),s.Xb(1,"p",53),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"strong"),s.Zc(5),s.Wb(),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"a",71),s.jc("click",(function(){s.Oc(e);const t=s.nc(2);return t.expandedUsers=!t.expandedUsers})),s.Zc(9),s.oc(10,"translate"),s.oc(11,"translate"),s.Wb(),s.Xc(12,pm,2,1,"div",72),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.bd(" ",s.pc(3,5,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_ERROR_INFO_3_PART_1"),""),s.Cb(3),s.ad(e.syncData.usersToSync.length),s.Cb(1),s.bd(" ",s.qc(7,7,"WORKSPACE.INTEGRATION.QUICKBOOKS.SYNC_ERROR_INFO_1_PART2",s.Bc(14,hm,e.syncData.customersToSync.length))," "),s.Cb(3),s.ad(e.expandedUsers?s.pc(10,10,"GLOBAL.HIDE_DETAILS_LABEL"):s.pc(11,12,"GLOBAL.SEE_DETAILS_LABEL")),s.Cb(3),s.wc("ngIf",e.expandedUsers)}}function gm(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.Ub()),2&e){const e=s.nc().$implicit;s.Cb(1),s.bd(" - ",e.parentCustomer.name,"")}}function Em(e,t){if(1&e&&(s.Xb(0,"div"),s.Zc(1),s.Xc(2,gm,2,1,"ng-container",5),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.bd(" ",e.name," "),s.Cb(1),s.wc("ngIf",e.parentCustomer)}}function fm(e,t){if(1&e&&(s.Xb(0,"div",73),s.Xc(1,Em,3,2,"div",25),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",null==e.syncData?null:e.syncData.customersToSync)}}const Sm=function(e,t){return{count:e,name:t}};function Cm(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"p",53),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"strong"),s.Zc(5),s.Wb(),s.Zc(6),s.oc(7,"translate"),s.oc(8,"translate"),s.Wb(),s.Xb(9,"a",71),s.jc("click",(function(){s.Oc(e);const t=s.nc(2);return t.expandedCustomers=!t.expandedCustomers})),s.Zc(10),s.oc(11,"translate"),s.oc(12,"translate"),s.Wb(),s.Xc(13,fm,2,1,"div",72),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.bd(" ",s.pc(3,5,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_ERROR_INFO_3_PART_1"),""),s.Cb(3),s.ad(e.syncData.customersToSync.length),s.Cb(1),s.bd(" ",s.qc(7,7,"WORKSPACE.INTEGRATION.QUICKBOOKS.SYNC_ERROR_INFO_2_PART2",s.Cc(16,Sm,e.syncData.customersToSync.length,s.pc(8,10,e.integration.name)))," "),s.Cb(4),s.ad(e.expandedCustomers?s.pc(11,12,"GLOBAL.HIDE_DETAILS_LABEL"):s.pc(12,14,"GLOBAL.SEE_DETAILS_LABEL")),s.Cb(3),s.wc("ngIf",e.expandedCustomers)}}function Am(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",74),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().doSync(t)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc(2);s.wc("disabled",e.syncInProgress||!e.syncData),s.Cb(1),s.bd(" ",s.pc(2,2,"WORKSPACE.INTEGRATION.SYNC.CREATE_MISSING")," ")}}function Om(e,t){if(1&e&&(s.Xb(0,"div",59),s.Xb(1,"h1",60),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Sb(4,"button",61),s.Xb(5,"button",62),s.jc("click",(function(){return t.$implicit.close()})),s.Xb(6,"span"),s.Sb(7,"img",63),s.Wb(),s.Wb(),s.Wb(),s.Xb(8,"div",64),s.Xc(9,dm,5,3,"div",65),s.Xc(10,mm,13,16,"div",66),s.Xc(11,Cm,14,19,"div",5),s.Wb(),s.Xb(12,"div",54),s.Xb(13,"a",55),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Xc(16,Am,3,4,"button",67),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,6,"GLOBAL.USERS_CUSTOMERS_SYNC_MSG")),s.Cb(7),s.wc("ngIf",e.syncData&&!(null!=e.syncData&&null!=e.syncData.usersToSync&&e.syncData.usersToSync.length)&&!(null!=e.syncData&&null!=e.syncData.customersToSync&&e.syncData.customersToSync.length)),s.Cb(1),s.wc("ngIf",null==e.syncData||null==e.syncData.usersToSync?null:e.syncData.usersToSync.length),s.Cb(1),s.wc("ngIf",null==e.syncData||null==e.syncData.customersToSync?null:e.syncData.customersToSync.length),s.Cb(3),s.ad(s.pc(15,8,"GLOBAL.CLOSE_BTN")),s.Cb(2),s.wc("ngIf",(null==e.syncData||null==e.syncData.usersToSync?null:e.syncData.usersToSync.length)||(null==e.syncData||null==e.syncData.customersToSync?null:e.syncData.customersToSync.length))}}function vm(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",75),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().disconnect(),n.close()}))("close",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",76),s.Zc(4),s.oc(5,"translate"),s.oc(6,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,"WORKSPACE.INTEGRATION.DISCONNECT.TITLE"))("btnText",s.pc(2,6,"GLOBAL.DISCONNECT_BTN"))("isDanger",!0),s.Cb(4),s.bd(" ",s.qc(5,8,"WORKSPACE.INTEGRATION.DISCONNECT.CONFIRM_ACTION",s.Bc(13,lm,s.pc(6,11,e.integration.name)))," ")}}function Tm(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",59),s.Xb(1,"h1",60),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"img",77),s.jc("click",(function(){return t.$implicit.close()})),s.Wb(),s.Wb(),s.Xb(5,"div",78),s.Xb(6,"div",79),s.Zc(7),s.oc(8,"translate"),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Xb(10,"div",54),s.Xb(11,"a",55),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xb(14,"button",80),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc().disconnect(),n.close()})),s.Zc(15),s.oc(16,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.bd("",s.pc(3,6,"GLOBAL.DISCONNECT_BTN")," Pumble"),s.Cb(5),s.dd(" ",s.pc(8,8,"WORKSPACE.INTEGRATION.PUMBLE.DISCONNECT_MSG_1")," ",e.pumbleWorkspaceName," ",s.pc(9,10,"WORKSPACE.INTEGRATION.PUMBLE.DISCONNECT_MSG_2")," "),s.Cb(5),s.ad(s.pc(13,12,"GLOBAL.CANCEL_BTN")),s.Cb(3),s.ad(s.pc(16,14,"GLOBAL.DISCONNECT_BTN"))}}let Im=(()=>{class e extends Mu{constructor(e,t,n,i,s,c,a,o,r,l){super(e,t,n),this.modalService=e,this.integrationService=t,this.loader=n,this.cd=i,this.translate=s,this.sanitizer=c,this.authService=a,this.workspaceService=o,this.pumbleService=r,this.toaster=l,this.showPumbleWidget=!1,this.isEmailVerified=!0,this.showConnectModals=!1,this.isAloneOnWs=!1,this.pumbleSettings=new xu,this.debouncer$=new p.a,this.unsubscribe$=new p.a}ngOnInit(){this.integration.text=this.sanitizer.sanitize(s.J.HTML,this.translate.instant(this.integration.text)),super.ngOnInit(),this.isEmailVerified="ACTIVE"==this.authService.getUser().status,this.checkIfConnected(),this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.checkIfWidgetEnabled(),this.isSelfHosted=null==bo.a?void 0:bo.a.environment.selfHosted,this.subscribeToDebouncer(),this.checkIfUserIsAloneOnWs()}ngOnDestroy(){super.ngOnDestroy()}checkIfConnected(){this.workspaceService.isPumbleActivated$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.integration.connectionExist=e,this.cd.detectChanges()})}disconnect(){this.workspaceService.disconnectWorkspaceFromPumble(this.workspaceId).subscribe(()=>{this.integration.connectionExist=!1,this.workspaceService.isPumbleActivated$.next(!1),this.pumbleService.setOpen(!1),this.pumbleService.unmountPumble(),this.cd.detectChanges()})}checkIfWidgetEnabled(){this.workspaceService.defaultWorkspace$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.showPumbleWidget=null==e?void 0:e.showChatWidget,this.workspace=e})}checkIfUserIsAloneOnWs(){this.workspaceService.getActiveMembersCount().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{e.activeMembersCount<2&&(this.isAloneOnWs=!0)})}getWorkspaceName(){this.workspaceService.getPumbleWorkspaceName(this.workspaceId).subscribe(e=>{this.pumbleWorkspaceName=e.pumbleWorkspaceName})}onShowPumbleWidgetChange(e){this.workspace.showChatWidget=e,this.debouncer$.next(this.workspace)}subscribeToDebouncer(){this.debouncer$.pipe(Object(De.a)(1e3),Object(Lh.a)(),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspaceService.updateWorkspaceSettings(this.workspace),this.cd.detectChanges()})}resendEmail(){this.authService.resendVerifyEmail()}setShowConnectModals(e){this.showConnectModals=e}openConnectionModal(){this.isEmailVerified?this.getPumbleWorkspaces():this.openModal(this.emailNotVerifiedModal)}getPumbleWorkspaces(){this.workspaceService.getIntegrationToken(this.workspaceId).pipe(Dh(1e4)).subscribe(e=>{this.workspaceService.getPumbleWorkspaces(e.integrationToken).pipe(Dh(2e3)).subscribe(e=>{this.pumbleSettings.pumbleWorkspaces=[],e.workspaces&&(this.pumbleSettings.hasPumbleAccount=!0,e.workspaces.length>0&&(this.pumbleSettings.isPumbleAdmin=!0,e.workspaces.forEach(e=>{this.pumbleSettings.pumbleWorkspaces.push(new Ph(e.id,e.name))}))),this.openModal(this.connectionModals),this.cd.detectChanges()},e=>{this.toaster.pop("error",this.translate.instant("WORKSPACE.INTEGRATION.PUMBLE.NETWORK_CONNECTION_ERROR"))})})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q),s.Rb(ut),s.Rb(Hn.a),s.Rb(s.h),s.Rb(g.f),s.Rb(Bu.b),s.Rb(re.a),s.Rb(l.a),s.Rb(Gu.a),s.Rb(a.d))},e.\u0275cmp=s.Lb({type:e,selectors:[["pumble-integration"]],viewQuery:function(e,t){var n;1&e&&(s.gd(Mh,!0),s.gd(Bh,!0)),2&e&&(s.Kc(n=s.kc())&&(t.connectionModals=n.first),s.Kc(n=s.kc())&&(t.emailNotVerifiedModal=n.first))},features:[s.zb],decls:29,vars:14,consts:[[1,"cl-d-flex","cl-mx-n2","cl-mx-lg-n3","cl-p-3",3,"click"],[1,"pointer",3,"src","click"],[1,"cl-w-100","cl-ml-3"],[1,"cl-d-flex","cl-align-items-center","cl-mb-1"],[1,"cl-mb-0","cl-mr-2","pointer",3,"click"],[4,"ngIf"],[1,"cl-text-gray-9"],["class","cl-mt-3",4,"ngIf"],[1,"cl-badge-same-entries-wrapper",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-ml-0"],["src","/assets/images/ui-icons/chevron-down.svg"],["emailNotVerifiedModal",""],["emailVerifiedConnectionModals",""],["successModal",""],["syncModal",""],["deleteConfirm",""],["disconnectPumble",""],[1,"cl-badge","cl-badge-success"],[1,"cl-badge","cl-badge-danger"],[1,"cl-mt-3"],["class","cl-mb-2",3,"innerHTML",4,"ngIf","ngIfElse"],["otherIntegrations",""],["class","cl-pl-3",4,"ngIf"],["class","cl-mb-3",4,"ngIf"],[1,"cl-d-flex","cl-justify-content-between"],[4,"ngFor","ngForOf"],["class","cl-text-danger",3,"click",4,"ngIf"],[1,"cl-mb-2",3,"innerHTML"],[1,"cl-mb-2"],[1,"cl-pl-3"],[1,"cl-custom-control","cl-custom-switch","cl-margin"],["id","showPumbleWidget","type","checkbox",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","showPumbleWidget",1,"cl-custom-control-label"],[1,"cl-mb-3"],["class","cl-btn cl-quickbooks-btn-green",3,"click",4,"ngIf"],["name","connectToQB",3,"ngClass","click",4,"ngIf"],["class","cl-btn cl-btn-success",3,"click",4,"ngIf"],["class","cl-btn",3,"ngClass","click",4,"ngIf"],[1,"cl-btn","cl-quickbooks-btn-green",3,"click"],["syncBtn",""],["name","connectToQB",3,"ngClass","click"],["connectBtn",""],[1,"cl-btn","cl-btn-success",3,"click"],[1,"cl-btn",3,"ngClass","click"],["reconnectBtn",""],["target","_blank",3,"href"],[1,"cl-text-danger",3,"click"],["disconnectBtn",""],[3,"close"],[3,"workspaceId","integration","pumbleSettings","close"],[1,"cl-modal-body","cl-text-center","cl-py-4"],["src","assets/images/illustrations/success.svg",1,"cl-img-fluid"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-mb-0","cl-text-gray-6"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["class","cl-btn cl-btn-primary","ngbAutofocus","",3,"click",4,"ngIf","ngIfElse"],["okBtnTemplate",""],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button","ngbAutofocus",""],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body","cl-py-3"],["class","cl-d-flex cl-align-items-center",4,"ngIf"],["class","cl-mb-2",4,"ngIf"],["class","cl-btn cl-btn-primary",3,"disabled","click",4,"ngIf"],[1,"cl-d-flex","cl-align-items-center"],["src","assets/images/success.svg","ngbAutofocus","",1,"cl-mr-3"],["ngbAutofocus","",1,"cl-mb-0"],[1,"cl-mb-1","cl-d-inline-block",3,"click"],["class","cl-scroll-area cl-ml-2","style","max-height: 100px; overflow-y: auto;",4,"ngIf"],[1,"cl-scroll-area","cl-ml-2",2,"max-height","100px","overflow-y","auto"],[1,"cl-btn","cl-btn-primary",3,"disabled","click"],[3,"title","btnText","isDanger","confirmed","close"],[1,"cl-text-dark","cl-mb-0"],["src","assets/ui-icons/close.svg",3,"click"],[1,"cl-modal-body"],[1,"cl-text-break","cl-text-color"],["type","submit",1,"cl-btn","cl-btn-danger",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.jc("click",(function(){return t.expandEntireComponent()})),s.Xb(1,"div"),s.Xb(2,"img",1),s.jc("click",(function(e){return t.integration.isExpanded=!t.integration.isExpanded,e.stopPropagation()})),s.Wb(),s.Wb(),s.Xb(3,"div",2),s.Xb(4,"div",3),s.Xb(5,"h2",4),s.jc("click",(function(e){return t.integration.isExpanded=!t.integration.isExpanded,e.stopPropagation()})),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xc(8,Uh,4,3,"ng-container",5),s.Xc(9,Gh,4,3,"ng-container",5),s.Wb(),s.Xb(10,"div",6),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xc(13,sm,12,8,"div",7),s.Wb(),s.Xb(14,"a",8),s.jc("click",(function(e){return t.integration.isExpanded=!t.integration.isExpanded,e.stopPropagation()})),s.Xb(15,"span",9),s.Sb(16,"img",10),s.Wb(),s.Wb(),s.Wb(),s.Xc(17,cm,1,0,"ng-template",null,11,s.Yc),s.Xc(19,am,1,3,"ng-template",null,12,s.Yc),s.Xc(21,bm,17,16,"ng-template",null,13,s.Yc),s.Xc(23,Om,17,10,"ng-template",null,14,s.Yc),s.Xc(25,vm,7,15,"ng-template",null,15,s.Yc),s.Xc(27,Tm,17,16,"ng-template",null,16,s.Yc)),2&e&&(s.Hb("cl-component-clickable",!t.integration.isExpanded)("cl-border-top",t.integration.isFree),s.Cb(2),s.wc("src",t.integration.logoUrl,s.Qc),s.Cb(4),s.bd(" ",s.pc(7,10,t.integration.name)," "),s.Cb(2),s.wc("ngIf",t.integration.connectionExist&&!t.integration.tokenExpired),s.Cb(1),s.wc("ngIf",t.integration.connectionExist&&t.integration.tokenExpired),s.Cb(2),s.ad(s.pc(12,12,t.integration.title)),s.Cb(2),s.wc("ngIf",t.integration.isExpanded))},directives:[i.u,i.t,v.a,v.s,v.v,i.r,Uu,Qu,Si.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function wm(e,t){if(1&e&&s.Sb(0,"quickbook-integration",1),2&e){const e=s.nc();s.wc("workspaceId",e.workspaceId)("integration",e.integration)}}function Lm(e,t){if(1&e&&s.Sb(0,"jira-integration",1),2&e){const e=s.nc();s.wc("workspaceId",e.workspaceId)("integration",e.integration)}}function Rm(e,t){if(1&e&&s.Sb(0,"pumble-integration",1),2&e){const e=s.nc();s.wc("workspaceId",e.workspaceId)("integration",e.integration)}}let ym=(()=>{class e{constructor(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["integrations"]],inputs:{integration:"integration",workspaceId:"workspaceId"},decls:3,vars:3,consts:[["class","cl-d-block",3,"workspaceId","integration",4,"ngIf"],[1,"cl-d-block",3,"workspaceId","integration"]],template:function(e,t){1&e&&(s.Xc(0,wm,1,2,"quickbook-integration",0),s.Xc(1,Lm,1,2,"jira-integration",0),s.Xc(2,Rm,1,2,"pumble-integration",0)),2&e&&(s.wc("ngIf","quickbooks"===t.integration.type),s.Cb(1),s.wc("ngIf","jira"===t.integration.type||"others"===t.integration.type),s.Cb(1),s.wc("ngIf","pumble"===t.integration.type))},directives:[i.u,Up,wh,Im],encapsulation:2,changeDetection:0}),e})();function _m(e,t){if(1&e&&s.Sb(0,"integrations",3),2&e){const e=s.nc().$implicit,t=s.nc(2);s.wc("workspaceId",t.workspace.id)("integration",e)}}function km(e,t){if(1&e&&(s.Vb(0),s.Xc(1,_m,1,2,"integrations",2),s.Ub()),2&e){const e=t.$implicit,n=s.nc(2);s.Cb(1),s.wc("ngIf",n.hasQuickbooksIntegrationPermission||e.isFree)}}function Wm(e,t){if(1&e&&s.Sb(0,"integrations",3),2&e){const e=s.nc().$implicit,t=s.nc(3);s.wc("workspaceId",t.workspace.id)("integration",e)}}function Xm(e,t){if(1&e&&(s.Vb(0),s.Xc(1,Wm,1,2,"integrations",2),s.Ub()),2&e){const e=t.$implicit;s.Cb(1),s.wc("ngIf",!e.isFree)}}const Nm=function(e){return{"cl-border-top cl-mx-n2 cl-mx-lg-n3 cl-pt-3 cl-pl-3 cl-pr-3":e}},Dm=function(){return["/upgrade"]},Pm=function(){return{plan:"standard"}};function Mm(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",4),s.Xb(2,"info"),s.Zc(3),s.oc(4,"translate"),s.Xb(5,"a",5),s.jc("click",(function(){return s.Oc(e),s.nc(2).addAnalitycsEvent("Standard")})),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xb(8,"div",6),s.Xc(9,Xm,2,1,"ng-container",1),s.Sb(10,"div",7),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc(2);s.Cb(1),s.wc("ngClass",s.Bc(10,Nm,!e.hasQuickbooksIntegrationPermission)),s.Cb(2),s.bd(" ",s.pc(4,6,"TEAMS.FEATURE.STANDARD")," "),s.Cb(2),s.wc("routerLink",s.Ac(12,Dm))("queryParams",s.Ac(13,Pm)),s.Cb(1),s.ad(s.pc(7,8,"GLOBAL.UPGRADE_BTN")),s.Cb(3),s.wc("ngForOf",e.integrations)}}function Bm(e,t){if(1&e&&(s.Vb(0),s.Xc(1,km,2,1,"ng-container",1),s.Xc(2,Mm,11,14,"ng-container",0),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngForOf",e.integrations),s.Cb(1),s.wc("ngIf",!e.hasQuickbooksIntegrationPermission)}}let Um=(()=>{class e{constructor(e,t,n,i){this.analyticsService=e,this.cd=t,this.integrationService=n,this.translateService=i,this.isQuickBooksExpanded=!1,this.isPumbleExpanded=!1,this.integrations=[],this.unsubscribe$=new p.a}ngOnInit(){this.getQuickbooksIntegration()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initIntegrations(){var e;const t=[new Nu({name:"WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.NAME",type:"quickbooks",title:"WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.TITLE",text:"WORKSPACE.INTAGRATIONS_TAB.QUICK_BOOKS.TEXT",isFree:!1,connectionExist:!1,logoUrl:"assets/integrations/qb-logo.svg",showConnect:!1,links:[{label:this.translateService.instant("GLOBAL.LEARN_MORE_LINK"),url:"https://clockify.me/help/extra-features/quickbooks-integration"}],isExpanded:this.hasQuickbooksIntegrationPermission&&this.isQuickBooksExpanded}),new Nu({name:"WORKSPACE.INTAGRATIONS_TAB.JIRA.NAME",type:"jira",title:"WORKSPACE.INTAGRATIONS_TAB.JIRA.TITLE",text:"WORKSPACE.INTAGRATIONS_TAB.JIRA.TEXT",bulletsList:["WORKSPACE.INTAGRATIONS_TAB.JIRA.LIST_ITEM_1","WORKSPACE.INTAGRATIONS_TAB.JIRA.LIST_ITEM_2"],isFree:!0,isConnected:!1,logoUrl:"assets/integrations/jira-logo.png",links:[{label:"GLOBAL.LEARN_MORE_LINK",url:"https://clockify.me/help/time-tracking/jira-integration"},{label:"WORKSPACE.INTAGRATIONS_TAB.LINK_LABELS.GET_API_KEY",url:"user/settings"},{label:"WORKSPACE.INTAGRATIONS_TAB.LINK_LABELS.INSTALL_JIRA_PLUGIN",url:"https://clockify.me/help/time-tracking/jira-integration#install-the-clockify-jira-app"}]}),new Nu({name:"WORKSPACE.INTAGRATIONS_TAB.OTHER.NAME",type:"others",title:"WORKSPACE.INTAGRATIONS_TAB.OTHER.TITLE",text:"WORKSPACE.INTAGRATIONS_TAB.OTHER.TEXT",isFree:!0,isConnected:!1,logoUrl:"assets/integrations/other_integrations.svg",links:[{label:"WORKSPACE.INTAGRATIONS_TAB.LINK_LABELS.GET_CHROME_EXTENSIOIN",url:"https://chrome.google.com/webstore/detail/clockify-time-tracker/pmjeegjhjdlccodhacdgbgfagbpmccpe"},{label:"WORKSPACE.INTAGRATIONS_TAB.LINK_LABELS.GET_FIREFOX_EXTENSION",url:"https://addons.mozilla.org/en-US/firefox/addon/clockify-time-tracker/"},{label:"WORKSPACE.INTAGRATIONS_TAB.LINK_LABELS.SEE_ALL_INTAGRATIONS",url:"https://clockify.me/integrations"}]})];return(null===(e=null==bo.a?void 0:bo.a.environment)||void 0===e?void 0:e.selfHosted)||t.splice(1,0,new Nu({name:"WORKSPACE.INTAGRATIONS_TAB.PUMBLE.NAME",type:"pumble",title:"WORKSPACE.INTAGRATIONS_TAB.PUMBLE.TITLE",text:"WORKSPACE.INTAGRATIONS_TAB.PUMBLE.TEXT",isFree:!0,connectionExist:!1,logoUrl:"assets/integrations/pumble-icon.svg",showConnect:!0,links:[{label:this.translateService.instant("GLOBAL.LEARN_MORE_LINK"),url:"https://clockify.me/help/users/team-chat"}],isExpanded:this.isPumbleExpanded})),t}getQuickbooksIntegration(){const e=this.initIntegrations();if(!this.workspace.hasFeature(is.a.QUICKBOOKS_INTEGRATION))return this.integrations=[...e],void this.cd.detectChanges();const t=e.findIndex(e=>"quickbooks"===e.type);this.integrationService.isQuickbooksConnected(this.workspace.id).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(n=>{e[t].connectionExist=n.connectionExist,e[t].showConnect=!0,n.connectionExist&&this.integrationService.isTokenValid(this.workspace.id).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(n=>{e[t].tokenExpired=!n.tokenValid},()=>{this.integrations=[...e],this.cd.detectChanges()},()=>{this.integrations=[...e],this.cd.detectChanges()})},()=>{this.integrations=[...e],this.cd.detectChanges()},()=>{e[t].connectionExist||(this.integrations=[...e],this.cd.detectChanges())})}addAnalitycsEvent(e){this.analyticsService.addEvent(new Fi.a({event:"submit",value:e,section:"Workspace settings",section2:"Integrations",section4:"Upgrade"}))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(xi.a),s.Rb(s.h),s.Rb(ut),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["integrations-tab"]],inputs:{workspace:"workspace",hasQuickbooksIntegrationPermission:"hasQuickbooksIntegrationPermission",isQuickBooksExpanded:"isQuickBooksExpanded"},decls:1,vars:1,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"workspaceId","integration",4,"ngIf"],[3,"workspaceId","integration"],[1,"cl-position-relative","cl-mb-1",3,"ngClass"],[1,"cl-btn",3,"routerLink","queryParams","click"],[1,"cl-position-relative"],[1,"cl-blocker",2,"top","1px"]],template:function(e,t){1&e&&s.Xc(0,Bm,3,2,"ng-container",0),2&e&&s.wc("ngIf",!!t.integrations&&!!t.integrations.length)},directives:[i.u,i.t,ym,i.r,To.a,k.g],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var Gm=n("OC8m"),xm=n("24jK");function Fm(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"label",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"input",2,3),s.jc("change",(function(){return s.Oc(e),s.nc().uploadFile()})),s.Wb(),s.Ub()}if(2&e){const e=s.nc();s.Cb(1),s.Hb("cl-disabled",e.disabled),s.xc("for",e.uid),s.wc("ngClass",e.btnClasses),s.Cb(1),s.bd(" ",s.pc(3,9,e.text),"\n"),s.Cb(2),s.xc("id",e.uid),s.xc("name",e.uid),s.wc("disabled",e.importInProgress||e.disabled)("accept",e.accept)}}let jm=(()=>{class e extends fo.a{constructor(e,t,n,i){super(e,t,n,i),this.fileService=e,this.toaster=t,this.cd=n,this.translate=i,this.text="SHARED_MODULES.BTN_UPLOAD_FILE_CONTENT.UPLOAD_FILE_BTN_DEFAULT",this.accept=fo.b.CSV,this.onUploadedCsv=new s.n,this.FileType=fo.b}sendRequest(e,t,n){this.inProgress=!0,this.onUploadStart.emit(),this.fileService.uploadCsvFile(e,this.workspaceId,n).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.onUploadedCsv.emit(e),this.inProgress=!1},this.errorCallback.bind(this))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Et.a),s.Rb(r.a),s.Rb(s.h),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["btn-upload-csv"]],inputs:{workspaceId:"workspaceId",text:"text",accept:"accept"},outputs:{onUploadedCsv:"onUploadedCsv"},features:[s.zb],decls:1,vars:1,consts:[[4,"ngIf"],[1,"cl-btn","pointer","cl-mb-0",3,"ngClass","for"],["type","file","tabindex","0",1,"pointer",2,"width","0","overflow","hidden",3,"id","disabled","name","accept","change"],["fileInput",""]],template:function(e,t){1&e&&s.Xc(0,Fm,6,11,"ng-container",0),2&e&&s.wc("ngIf",t.isVisible)},directives:[i.u,i.r],pipes:[g.e],encapsulation:2}),e})();function Zm(e,t){if(1&e&&(s.Xb(0,"div",1),s.Zc(1),s.oc(2,"translate"),s.Xb(3,"h1"),s.Zc(4),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.pc(2,2,"GLOBAL.PROJECTS_LABEL")," "),s.Cb(3),s.ad(e.uploadedCsv.importedProjects)}}function Vm(e,t){if(1&e&&(s.Xb(0,"div",1),s.Zc(1),s.oc(2,"translate"),s.Xb(3,"h1"),s.Zc(4),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.pc(2,2,"GLOBAL.TASKS_LABEL")," "),s.Cb(3),s.ad(e.uploadedCsv.importedTasks)}}function Ym(e,t){if(1&e&&(s.Xb(0,"div",1),s.Xb(1,"span",2),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"h1"),s.Zc(5),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.bd(" ",e.projectGroupingLabel||s.pc(3,2,"GLOBAL.CLIENTS_LABEL")," "),s.Cb(3),s.ad(e.uploadedCsv.importedClients)}}function Hm(e,t){if(1&e&&(s.Xb(0,"div",1),s.Zc(1),s.oc(2,"translate"),s.Xb(3,"h1"),s.Zc(4),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.pc(2,2,"GLOBAL.TAGS_LABEL")," "),s.Cb(3),s.ad(e.uploadedCsv.importedTags)}}function $m(e,t){if(1&e&&(s.Xb(0,"div",1),s.Zc(1),s.oc(2,"translate"),s.Xb(3,"h1"),s.Zc(4),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.pc(2,2,"WORKSPACE.IMPORT.TIME_ENTRIES")," "),s.Cb(3),s.ad(e.uploadedCsv.importedTimeEntries)}}n("uNKk");let Km=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["csv-table"],["","csv-table",""]],inputs:{uploadedCsv:"uploadedCsv",projectGroupingLabel:"projectGroupingLabel",hasImportFileFeature:"hasImportFileFeature"},decls:5,vars:5,consts:[["class","cl-border cl-p-2 cl-pr-4 cl-d-flex cl-flex-column",4,"ngIf"],[1,"cl-border","cl-p-2","cl-pr-4","cl-d-flex","cl-flex-column"],[1,"cl-text-capitalize"]],template:function(e,t){1&e&&(s.Xc(0,Zm,5,4,"div",0),s.Xc(1,Vm,5,4,"div",0),s.Xc(2,Ym,6,4,"div",0),s.Xc(3,Hm,5,4,"div",0),s.Xc(4,$m,5,4,"div",0)),2&e&&(s.wc("ngIf",t.uploadedCsv.importedProjects||0==t.uploadedCsv.importedProjects),s.Cb(1),s.wc("ngIf",t.uploadedCsv.importedTasks||0==t.uploadedCsv.importedTasks),s.Cb(1),s.wc("ngIf",t.uploadedCsv.importedClients||0==t.uploadedCsv.importedClients),s.Cb(1),s.wc("ngIf",t.uploadedCsv.importedTags||0==t.uploadedCsv.importedTags),s.Cb(1),s.wc("ngIf",t.hasImportFileFeature&&(t.uploadedCsv.importedTimeEntries||0==t.uploadedCsv.importedTimeEntries)))},directives:[i.u],pipes:[g.e],encapsulation:2}),e})();function qm(e,t){if(1&e&&(s.Xb(0,"div"),s.Zc(1),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.ad(e)}}function zm(e,t){if(1&e&&(s.Xb(0,"div",11),s.Xc(1,qm,2,1,"div",12),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngForOf",e.missingUsers)}}const Qm=function(e){return{count:e}};let Jm=(()=>{class e{constructor(e,t,n){this.router=e,this.modalService=t,this.teamsDataService=n,this.close=new s.n,this.confirmed=new s.n}ngOnInit(){}inviteUsers(){this.teamsDataService.missingUsers=this.missingUsers.splice(0),this.modalService.dismissAll(),this.router.navigate(["/teams"])}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.d),s.Rb(w.q),s.Rb(o))},e.\u0275cmp=s.Lb({type:e,selectors:[["missing-users-modal"]],inputs:{missingUsers:"missingUsers"},outputs:{close:"close",confirmed:"confirmed"},decls:33,vars:41,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-text-dark","cl-mb-2"],[3,"click"],[1,"cl-mb-2","cl-d-inline-block",3,"click"],["class","cl-scroll-area cl-ml-2","style","max-height: 100px; overflow-y: auto;",4,"ngIf"],[1,"cl-modal-footer"],["ngbAutofocus","","type","button",1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-scroll-area","cl-ml-2",2,"max-height","100px","overflow-y","auto"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.close.emit()})),s.Xb(5,"span"),s.Sb(6,"img",3),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",4),s.Xb(8,"p",5),s.Zc(9),s.oc(10,"translate"),s.Xb(11,"strong"),s.Zc(12),s.Wb(),s.Zc(13),s.oc(14,"translate"),s.Xb(15,"a",6),s.jc("click",(function(){return t.inviteUsers()})),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Zc(18,", "),s.Xb(19,"span"),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Wb(),s.Xb(22,"a",7),s.jc("click",(function(){return t.expandedMissingUsers=!t.expandedMissingUsers})),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Xc(25,zm,2,1,"div",8),s.Wb(),s.Xb(26,"div",9),s.Xb(27,"a",6),s.jc("click",(function(){return t.close.emit()})),s.Zc(28),s.oc(29,"translate"),s.Wb(),s.Xb(30,"button",10),s.jc("click",(function(){return t.confirmed.emit()})),s.Zc(31),s.oc(32,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.qc(3,10,"WORKSPACE.IMPORT.USER.MISSING.TITLE_PLURAL_HANDLING",s.Bc(31,Qm,t.missingUsers.length))),s.Cb(7),s.bd(" ",s.pc(10,13,"WORKSPACE.IMPORT.USER.MISSING.INFO_MSG_PART1"),""),s.Cb(3),s.ad(t.missingUsers.length),s.Cb(1),s.bd(" ",s.qc(14,15,"WORKSPACE.IMPORT.USER.MISSING.INFO_MSG_PART2",s.Bc(33,Qm,t.missingUsers.length))," "),s.Cb(3),s.ad(s.qc(17,18,"WORKSPACE.IMPORT.USER.MISSING.INVITE_MSG_PART1",s.Bc(35,Qm,t.missingUsers.length))),s.Cb(4),s.ad(s.qc(21,21,"WORKSPACE.IMPORT.USER.MISSING.INVITE_MSG_PART2",s.Bc(37,Qm,t.missingUsers.length))),s.Cb(3),s.bd(" ",s.qc(24,24,t.expandedMissingUsers?"WORKSPACE.IMPORT.USER.MISSING.HIDE_PLURAL_HANDLING":"WORKSPACE.IMPORT.USER.MISSING.SEE_PLURAL_HANDLING",s.Bc(39,Qm,t.missingUsers.length))," "),s.Cb(2),s.wc("ngIf",t.expandedMissingUsers),s.Cb(3),s.ad(s.pc(29,27,"GLOBAL.CANCEL_BTN")),s.Cb(3),s.bd(" ",s.pc(32,29,"WORKSPACE.IMPORT.USER.MISSING.MESSAGE"),""))},directives:[i.u,i.t],pipes:[g.e],encapsulation:2}),e})();const eg=["missingUserModal"];function tg(e,t){1&e&&(s.Xb(0,"div",20),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WORKSPACE.IMPORT.IN_PROGRESS")," "))}function ng(e,t){1&e&&s.Sb(0,"img",21)}function ig(e,t){if(1&e){const e=s.Yb();s.Xb(0,"btn-upload-csv",22),s.jc("onUploadedCsv",(function(t){return s.Oc(e),s.nc().onUploadCsv(t)}))("onUploadStart",(function(){return s.Oc(e),s.nc().onUploadStart()}))("onError",(function(t){return s.Oc(e),s.nc().onUploadError(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("disabled",e.importInProgress||!e.inProgressResponseReceived)("maxMB",e.CsvMaxMbLimit)("workspaceId",e.workspaceId)}}function sg(e,t){if(1&e&&(s.Xb(0,"div",23),s.Xb(1,"span",24),s.Zc(2),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(e.errorMessage)}}function cg(e,t){if(1&e&&(s.Xb(0,"div",23),s.Xb(1,"span",24),s.Zc(2,"Duration format in the file must match duration format in "),s.Xb(3,"a",25),s.Zc(4),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(3),s.yc("href","/workspaces/",e.workspaceId,"/settings#settings",s.Qc),s.Cb(1),s.bd(" Workspace settings ",e.requiredDateFormat,".")}}function ag(e,t){if(1&e&&(s.Xb(0,"div",23),s.Xb(1,"span",24),s.Zc(2,"Date format in the file must match date format in "),s.Xb(3,"a",26),s.Zc(4),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(4),s.bd(" Profile settings (",e.requiredDateFormat,").")}}function og(e,t){if(1&e&&(s.Xb(0,"div",23),s.Xb(1,"span",24),s.Zc(2,"Time format in the file must match time format in "),s.Xb(3,"a",26),s.Zc(4),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(4),s.bd(" Profile settings ",e.requiredDateFormat,".")}}function rg(e,t){if(1&e&&(s.Xb(0,"div",34),s.Zc(1),s.Xb(2,"a",35),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc().$implicit;s.Cb(1),s.bd(" ",e.value," "),s.Cb(2),s.ad(s.pc(4,2,"GLOBAL.LEARN_MORE_LINK"))}}function lg(e,t){if(1&e&&(s.Vb(0),s.Xc(1,rg,5,4,"div",33),s.Ub()),2&e){const e=t.$implicit,n=s.nc(2);s.Cb(1),s.wc("ngIf",!("TIME_ENTRY_MISSING_FIELD"===e.key&&!n.hasImportFileFeature))}}function bg(e,t){1&e&&(s.Xb(0,"div",36),s.Xb(1,"div",37),s.Xb(2,"a",38),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.ad(s.pc(4,2,"WORKSPACE.IMPORT.UPGRADE_PART1")),s.Cb(2),s.bd(" ",s.pc(6,4,"WORKSPACE.IMPORT.UPGRADE_PART2")," "))}function dg(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xc(2,lg,2,1,"ng-container",27),s.oc(3,"keyvalue"),s.Xb(4,"div",28),s.Xb(5,"strong"),s.Zc(6),s.Wb(),s.Wb(),s.Sb(7,"div",29),s.Xc(8,bg,7,6,"div",30),s.Xb(9,"button",31),s.jc("click",(function(){return s.Oc(e),s.nc().validateMissingUsersAndFinishImport()})),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Xb(12,"a",32),s.jc("click",(function(){return s.Oc(e),s.nc().discardCsv()})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.wc("ngForOf",s.pc(3,9,e.uploadedCsv.importWarnings)),s.Cb(4),s.ad(e.uploadedCsv.name),s.Cb(1),s.wc("uploadedCsv",e.uploadedCsv)("projectGroupingLabel",e.projectGroupingLabel)("hasImportFileFeature",e.hasImportFileFeature),s.Cb(1),s.wc("ngIf",!e.hasImportFileFeature),s.Cb(1),s.wc("disabled",e.inProgress||e.inProgressValidation),s.Cb(1),s.bd(" ",s.pc(11,11,"WORKSPACE.IMPORT.START_BTN")," "),s.Cb(3),s.ad(s.pc(14,13,"GLOBAL.CANCEL_BTN"))}}function ug(e,t){if(1&e){const e=s.Yb();s.Xb(0,"missing-users-modal",39),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return n.close(),i.finishImport()}))("close",(function(){return t.$implicit.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("missingUsers",e.missingUsers)}}let pg=(()=>{class e{constructor(e,t,n,i,s,c,a){this.cd=e,this.loader=t,this.modalService=n,this.fileService=i,this.translateService=s,this.notificationService=c,this.analyticsService=a,this.CsvMaxMbLimit=In.a,this.unsubscribe$=new p.a}ngOnInit(){this.fileService.isImportInProgress(this.workspaceId).subscribe(e=>{this.importInProgress=e.inProgress,this.inProgressResponseReceived=!0,this.cd.detectChanges()}),this.notificationService.unreadNotifications$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{e.filter(e=>e.type===xm.a.FILE_IMPORT_COMPLETED).length>0&&(this.importInProgress=!1,this.cd.detectChanges())})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}onUploadStart(){this.loader.show("GLOBAL.UPLOADING_LABEL","GLOBAL.LOADER_WAIT_MOMENT"),this.setSuccessBannerVisibility(!1)}onUploadCsv(e){this.clearErrors(),this.uploadedCsv=e,this.loader.hide(),this.cd.markForCheck()}onUploadError(e){var t,n,i;this.importResponseCode=null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.importResponseCode,400==this.importResponseCode?this.errorMessage="You can import only one file at a time.":this.importResponseCode>=500&&this.importResponseCode<600?this.requiredDateFormat=null===(n=null==e?void 0:e.error)||void 0===n?void 0:n.metaData.requiredDataFormat:this.errorMessage=null===(i=null==e?void 0:e.error)||void 0===i?void 0:i.message,this.loader.hide()}validateMissingUsersAndFinishImport(){this.hasImportFileFeature?(this.loader.show("WORKSPACE.IMPORT_CSV.VALIDATING_DATA_LOADER_MSG"),this.fileService.checkMissingUsers(this.uploadedCsv.id,this.workspaceId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.inProgressValidation=!1,this.loader.hide(),this.missingUsers=e,this.missingUsers.length?this.openModal(this.missingUserModal):this.finishImport()},e=>{this.inProgressValidation=!1,this.loader.hide(),this.cd.markForCheck()})):this.finishImport()}finishImport(){this.loader.show("WORKSPACE.IMPORT_CSV.IMPORTING_DATA_MSG"),this.inProgress=!0,this.fileService.importCsv(this.uploadedCsv.id,this.workspaceId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.analyticsService.addEvent(new Fi.a({event:"submit",value:"uploadCSV",section:"Workspace settings",section2:"Import",section4:"Upload CSV File"})),this.uploadedCsv=null,this.importInProgress=!0,this.clearErrors(),this.inProgress=!1,this.loader.hide(),this.setSuccessBannerVisibility(!0),this.cd.markForCheck()},e=>{this.inProgress=!1,this.loader.hide(),this.cd.markForCheck()})}discardCsv(){this.uploadedCsv=null,this.clearErrors()}clearErrors(){this.importResponseCode=null,this.errorMessage="",this.missingUsers=null}openModal(e){this.modalService.open(e,{centered:!0})}setSuccessBannerVisibility(e){this.isSuccessBannerVisible=e}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.h),s.Rb(Hn.a),s.Rb(w.q),s.Rb(Et.a),s.Rb(g.f),s.Rb(Gm.a),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["import-csv-tab"]],viewQuery:function(e,t){var n;1&e&&s.gd(eg,!0),2&e&&s.Kc(n=s.kc())&&(t.missingUserModal=n.first)},inputs:{workspaceId:"workspaceId",hasImportFileFeature:"hasImportFileFeature",projectGroupingLabel:"projectGroupingLabel"},decls:43,vars:33,consts:[[1,"cl-row"],[1,"cl-col-lg-custom-12"],[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-12","cl-relative"],[1,"cl-h2","cl-mb-0"],[1,"cl-text-gray-9","cl-pr-4","cl-pr-lg-custom-0"],["href","https://clockify.me/help/projects/import-projects","target","_blank"],[1,"cl-mt-0"],["class","cl-col-md-6 cl-alert cl-alert-primary cl-d-block",4,"ngIf"],[1,"cl-col-lg-custom-3"],[1,"cl-nav","cl-nav-tabs","cl-custom-tabs-minimal","cl-mb-3"],[1,"cl-nav-item","cl-flex-grow-1"],[1,"cl-nav-link","cl-pl-0","cl-text-left"],[1,"cl-h5","cl-mb-0"],["src","/assets/images/ui-icons/checkmark-green.svg","class","cl-ml-2",4,"ngIf"],[1,"cl-lowercase"],["class","cl-mr-3",3,"disabled","maxMB","workspaceId","onUploadedCsv","onUploadStart","onError",4,"ngIf"],["class","cl-mt-1",4,"ngIf"],["class","cl-row",4,"ngIf"],["missingUserModal",""],[1,"cl-col-md-6","cl-alert","cl-alert-primary","cl-d-block"],["src","/assets/images/ui-icons/checkmark-green.svg",1,"cl-ml-2"],[1,"cl-mr-3",3,"disabled","maxMB","workspaceId","onUploadedCsv","onUploadStart","onError"],[1,"cl-mt-1"],[1,"cl-invalid-feedback","cl-d-inline-block"],[1,"error-link",3,"href"],["href","/user/settings",1,"error-link"],[4,"ngFor","ngForOf"],[1,"cl-mb-2"],["csv-table","",1,"cl-d-flex","cl-mb-3","cl-borders-table",3,"uploadedCsv","projectGroupingLabel","hasImportFileFeature"],["class","cl-col-lg-custom-12 cl-px-0",4,"ngIf"],["name","uploadCSV",1,"cl-btn","cl-btn-primary","cl-mr-3",3,"disabled","click"],[3,"click"],["class","cl-col-lg-12 cl-alert cl-alert-warning cl-justify-content-between",4,"ngIf"],[1,"cl-col-lg-12","cl-alert","cl-alert-warning","cl-justify-content-between"],["href","https://clockify.me/help/extra-features/import-timesheets","target","_blank",1,"cl-btn","cl-text-nowrap"],[1,"cl-col-lg-custom-12","cl-px-0"],[1,"cl-mb-3","cl-text-gray-9","cl-pr-4","cl-pr-lg-custom-0"],["href","/upgrade"],[3,"missingUsers","confirmed","close"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"div",5),s.Zc(8),s.oc(9,"translate"),s.Xb(10,"a",6),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(13,"hr",7),s.Xc(14,tg,3,3,"div",8),s.Xb(15,"div",0),s.Xb(16,"div",9),s.Xb(17,"ul",10),s.Xb(18,"li",11),s.Xb(19,"span",12),s.Xb(20,"div",13),s.Zc(21),s.oc(22,"translate"),s.Xc(23,ng,1,0,"img",14),s.Wb(),s.Xb(24,"div",15),s.Zc(25),s.oc(26,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(27,"li",11),s.Xb(28,"span",12),s.Xb(29,"div",13),s.Zc(30),s.oc(31,"translate"),s.Wb(),s.Xb(32,"div",15),s.Zc(33),s.oc(34,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(35,ig,1,3,"btn-upload-csv",16),s.Xc(36,sg,3,1,"div",17),s.Xc(37,cg,5,2,"div",17),s.Xc(38,ag,5,1,"div",17),s.Xc(39,og,5,1,"div",17),s.Xc(40,dg,15,15,"div",18),s.Wb(),s.Wb(),s.Xc(41,ug,1,1,"ng-template",null,19,s.Yc)),2&e&&(s.Cb(5),s.ad(s.pc(6,19,"WORKSPACE.IMPORT.TITLE")),s.Cb(3),s.bd(" ",s.pc(9,21,"WORKSPACE.IMPORT.INSTRUCTION_MSG_PART1")," "),s.Cb(3),s.ad(s.pc(12,23,"WORKSPACE.IMPORT.INSTRUCTION_MSG_PART2")),s.Cb(3),s.wc("ngIf",t.importInProgress),s.Cb(5),s.Hb("cl-active",!t.uploadedCsv),s.Cb(2),s.bd("",s.pc(22,25,"GLOBAL.STEP_1_TITLE")," "),s.Cb(2),s.wc("ngIf",t.uploadedCsv),s.Cb(2),s.ad(s.pc(26,27,"WORKSPACE.IMPORT.UPLOAD_FILE")),s.Cb(3),s.Hb("cl-active",t.uploadedCsv),s.Cb(2),s.ad(s.pc(31,29,"GLOBAL.STEP_2_TITLE")),s.Cb(3),s.ad(s.pc(34,31,"WORKSPACE.IMPORT.DO")),s.Cb(2),s.wc("ngIf",!t.uploadedCsv),s.Cb(1),s.wc("ngIf",t.errorMessage),s.Cb(1),s.wc("ngIf",500==t.importResponseCode),s.Cb(1),s.wc("ngIf",510==t.importResponseCode),s.Cb(1),s.wc("ngIf",520==t.importResponseCode),s.Cb(1),s.wc("ngIf",t.uploadedCsv))},directives:[i.u,jm,i.t,Km,Jm],pipes:[g.e,i.m],styles:[".error-link[_ngcontent-%COMP%]{color:#f44336;text-decoration:underline}.error-link[_ngcontent-%COMP%]:hover{text-decoration:none}"],changeDetection:0}),e})();var hg=n("cGux"),mg=n("y+xF");const gg=new mg.a(Eo.e.PROJECTS,[{id:"CREATE_PROJECT",value:"CREATE_PROJECT",label:"Created project",labelTranslationKey:"AUDIT_LOG.FILTERS.PROJECT.CREATE.BY_USER"},{id:"CREATE_PROJECT_IMPORT",value:"CREATE_PROJECT_IMPORT",label:"Created project (import)",labelTranslationKey:"AUDIT_LOG.FILTERS.PROJECT.CREATE.IMPORT"},{id:"CREATE_PROJECT_QUICKBOOKS",value:"CREATE_PROJECT_QUICKBOOKS",label:"Created project (QuickBooks)",labelTranslationKey:"AUDIT_LOG.FILTERS.PROJECT.CREATE.QUICKBOOKS"},{id:"UPDATE_PROJECT",value:"UPDATE_PROJECT",label:"Updated project",labelTranslationKey:"AUDIT_LOG.FILTERS.PROJECT.UPDATE"},{id:"DELETE_PROJECT",value:"DELETE_PROJECT",label:"Deleted project",labelTranslationKey:"AUDIT_LOG.FILTERS.PROJECT.DELETE"}],{label:Eo.f.projects}),Eg=new mg.a(Eo.e.TAG,[{id:"CREATE_TAG",value:"CREATE_TAG",label:"Created tag",labelTranslationKey:"AUDIT_LOG.FILTERS.TAG.CREATE.BY_USER"},{id:"CREATE_TAG_IMPORT",value:"CREATE_TAG_IMPORT",label:"Created tag (import)",labelTranslationKey:"AUDIT_LOG.FILTERS.TAG.CREATE.IMPORT"},{id:"UPDATE_TAG",value:"UPDATE_TAG",label:"Updated tag",labelTranslationKey:"AUDIT_LOG.FILTERS.TAG.UPDATE"},{id:"DELETE_TAG",value:"DELETE_TAG",label:"Deleted tag",labelTranslationKey:"AUDIT_LOG.FILTERS.TAG.DELETE"}],{label:Eo.f.tag}),fg=new mg.a(Eo.e.TASK,[{id:"CREATE_TASK",value:"CREATE_TASK",label:"Created task",labelTranslationKey:"AUDIT_LOG.FILTERS.TASK.CREATE.BY_USER"},{id:"CREATE_TASK_IMPORT",value:"CREATE_TASK_IMPORT",label:"Created task (import)",labelTranslationKey:"AUDIT_LOG.FILTERS.TASK.CREATE.IMPORT"},{id:"UPDATE_TASK",value:"UPDATE_TASK",label:"Updated task",labelTranslationKey:"AUDIT_LOG.FILTERS.TASK.UPDATE"},{id:"DELETE_TASK",value:"DELETE_TASK",label:"Deleted task",labelTranslationKey:"AUDIT_LOG.FILTERS.TASK.DELETE"}],{label:Eo.f.task}),Sg=new mg.a(Eo.e.TIME_ENTRY,[{id:"CREATE_TIME_PERSONAL_TIMER",value:"CREATE_TIME_PERSONAL_TIMER",label:"Created time (personal, timer)",labelTranslationKey:"AUDIT_LOG.FILTERS.TIME_ENTRY.CREATE.PERSONAL_TIMER"},{id:"CREATE_TIME_PERSONAL_MANUAL",value:"CREATE_TIME_PERSONAL_MANUAL",label:"Created time (personal, manual)",labelTranslationKey:"AUDIT_LOG.FILTERS.TIME_ENTRY.CREATE.PERSONAL_MANUAL"},{id:"CREATE_TIME_IMPORT",value:"CREATE_TIME_IMPORT",label:"Created time (import)",labelTranslationKey:"AUDIT_LOG.FILTERS.TIME_ENTRY.CREATE.IMPORT"},{id:"CREATE_TIME_FOR_OTHER",value:"CREATE_TIME_FOR_OTHER",label:"Created time (for other)",labelTranslationKey:"AUDIT_LOG.FILTERS.TIME_ENTRY.CREATE.FOR_OTHER"},{id:"UPDATE_TIME_PERSONAL",value:"UPDATE_TIME_PERSONAL",label:"Updated time (personal)",labelTranslationKey:"AUDIT_LOG.FILTERS.TIME_ENTRY.UPDATE.PERSONAL"},{id:"UPDATE_TIME_FOR_OTHER",value:"UPDATE_TIME_FOR_OTHER",label:"Updated time (for other)",labelTranslationKey:"AUDIT_LOG.FILTERS.TIME_ENTRY.UPDATE.FOR_OTHER"},{id:"DELETE_TIME_PERSONAL",value:"DELETE_TIME_PERSONAL",label:"Deleted time (personal)",labelTranslationKey:"AUDIT_LOG.FILTERS.TIME_ENTRY.DELETE.PERSONAL"},{id:"DELETE_TIME_FOR_OTHER",value:"DELETE_TIME_FOR_OTHER",label:"Deleted time (for other)",labelTranslationKey:"AUDIT_LOG.FILTERS.TIME_ENTRY.DELETE.FOR_OTHER"}],{label:Eo.f.timeEntry});var Cg=n("D0uv");function Ag(e,t){if(1&e&&(s.Xb(0,"span",17),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",e.numberOfSelected[e.AuditLogFilter.USERS]," ")}}function Og(e,t){if(1&e){const e=s.Yb();s.Xb(0,"dropdown-checkbox",18),s.jc("loadMore",(function(){return s.Oc(e),s.nc().loadMoreUsers()}))("onSelectAllWithTextInput",(function(t){return s.Oc(e),s.nc().selectAllUserIds(t)}))("onSearchChange",(function(t){s.Oc(e);const n=s.nc();return n.onFilterSearchChange(n.AuditLogFilter.USERS,t)}))("onFilterOptionChange",(function(t){s.Oc(e);const n=s.nc();return n.onFilterOptionChange(n.AuditLogFilter.USERS,t)}))("onCloseFilter",(function(t){s.Oc(e);const n=s.nc();return n.onFilterClosed(n.AuditLogFilter.USERS,t)}))("onChange",(function(t){s.Oc(e);const n=s.nc();return n.onFilterChange(n.AuditLogFilter.USERS,t)})),s.oc(1,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("placeholder",s.pc(1,10,"SHARED_MODULES.DROPDOWN_CHECKBOX_WRAPPER.FIND_USER_PLACEHOLDER"))("isResizeable",!1)("preventOfflineFiltering",!0)("showSelectAll",!0)("checkboxValues",e.userFilterValues[e.AuditLogFilter.USERS])("selectableMaps",e.userFilterMaps[e.AuditLogFilter.USERS])("searchValue",e.usersQuery[e.AuditLogFilter.USERS].name)("countMap",e.userCount)("inProgressSelectAll",e.inProgressSelectAllUsers[e.AuditLogFilter.USERS])("inProgressLoading",e.inProgressLoadingUsers[e.AuditLogFilter.USERS])}}function vg(e,t){if(1&e&&(s.Xb(0,"span",17),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",e.numberOfSelected[e.AuditLogFilter.ACTIONS]," ")}}function Tg(e,t){if(1&e){const e=s.Yb();s.Xb(0,"dropdown-checkbox",19),s.jc("onFilterOptionChange",(function(t){s.Oc(e);const n=s.nc();return n.onFilterOptionChange(n.AuditLogFilter.ACTIONS,t)}))("onCloseFilter",(function(t){s.Oc(e);const n=s.nc();return n.onFilterClosed(n.AuditLogFilter.ACTIONS,t)}))("onChange",(function(t){s.Oc(e);const n=s.nc();return n.onFilterChange(n.AuditLogFilter.ACTIONS,t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("showSearch",!1)("isResizeable",!1)("alreadySorted",!0)("preventOfflineFiltering",!0)("showSelectAll",!0)("checkboxValues",e.actionFilterValues)("selectableMaps",e.actionFilterMaps)("countMap",e.actionCount)("enableSelectingGroups",!0)}}let Ig=(()=>{class e{constructor(e,t,n,i,c,a,o,r){this.cd=e,this.workspaceService=t,this.userService=n,this.auditLogService=i,this.translateService=c,this.authService=a,this.toaster=o,this.analyticsService=r,this.filtersUpdated=new s.n,this.isOpenedMap={users:!1,actions:!1},this.numberOfSelected={users:null,actions:null},this.usersQuery={},this.userFilterValues={[Eo.e.USERS]:new wn.a},this.userFilterMaps={[Eo.e.USERS]:null},this.reachedUserLimit={},this.userCount=new hg.a({users:null}),this.inProgressLoadingUsers={},this.inProgressSelectAllUsers={},this.actionsQuery=[],this.actionFilterValues=new wn.a({options:{status:"ALL"}}),this.reachedActionLimit={},this.actionCount=new hg.a({[Eo.n]:null,[Eo.j]:null,[Eo.m]:null,[Eo.g]:null,[Eo.l]:null}),this.AuditLogFilter=Eo.e,this.dateLimit={min:ke().subtract(1,"year"),max:ke()},this.applyButtonDisabled=!0,this._ngUnsubscribe$=new p.a}ngOnInit(){this.activeUser=this.authService.getUser(),this.workspace=new ss.a(JSON.parse(localStorage.getItem("defaultWorkspace"))),this.projectGroupingLabel=this.workspace.projectGroupingLabel,this.auditLogService.auditLogSettings.pipe(Object(Pe.a)(this._ngUnsubscribe$)).subscribe(e=>{if(e){if(this.userFilterMaps[Eo.e.USERS]=new Tn.a([new mg.a(Eo.o)]),this.actionFilterMaps=new Tn.a([]),e.timeEntryAuditing&&(this.translateFilterItems(Sg),this.actionFilterMaps.pushMap(Sg)),e.projectAuditing&&(this.translateFilterItems(gg),this.actionFilterMaps.pushMap(gg),this.translateFilterItems(fg),this.actionFilterMaps.pushMap(fg)),e.clientAuditing){const e=this.auditLogService.setProjectGroupingLabelTranslations(this.projectGroupingLabel),t=new mg.a(Eo.e.CLIENT,[{id:"CREATE_CLIENT",value:"CREATE_CLIENT",label:e.get("CREATE_CLIENT"),labelTranslationKey:"AUDIT_LOG.FILTERS.CLIENT.CREATE.BY_USER"},{id:"CREATE_CLIENT_IMPORT",value:"CREATE_CLIENT_IMPORT",label:e.get("CREATE_CLIENT_IMPORT"),labelTranslationKey:"AUDIT_LOG.FILTERS.CLIENT.CREATE.IMPORT"},{id:"CREATE_CLIENT_QUICKBOOKS",value:"CREATE_CLIENT_QUICKBOOKS",label:e.get("CREATE_CLIENT_QUICKBOOKS"),labelTranslationKey:"AUDIT_LOG.FILTERS.CLIENT.CREATE.QUICKBOOKS"},{id:"UPDATE_CLIENT",value:"UPDATE_CLIENT",label:e.get("UPDATE_CLIENT"),labelTranslationKey:"AUDIT_LOG.FILTERS.CLIENT.UPDATE"},{id:"DELETE_CLIENT",value:"DELETE_CLIENT",label:e.get("DELETE_CLIENT"),labelTranslationKey:"AUDIT_LOG.FILTERS.CLIENT.DELETE"}],{label:this.setProjectGroupingLabelTranslation(this.projectGroupingLabel)});this.actionFilterMaps.pushMap(t)}e.tagAuditing&&(this.translateFilterItems(Eg),this.actionFilterMaps.pushMap(Eg)),this.resetQuery();const t=this.auditLogService.getFilterSettings();t?(this.initializeFilterSettings(e,t),this.applyButtonDisabled=!1,this.filtersUpdated.emit(this.formatFilters())):this.initDateRange(),this.cd.detectChanges()}})}initializeFilterSettings(e,t){this.userFilterValues[Eo.e.USERS]=new wn.a({exclude:t.usersFilter.exclude,map:t.usersFilter.map}),this.usersQuery[Eo.e.USERS].statuses=[Xc.a.ACTIVE,Xc.a.INACTIVE],this.usersQuery[Eo.e.USERS].email="",this.workspaceService.getReportsFilterTeamMembers(this.usersQuery[Eo.e.USERS]).pipe(Object(Pe.a)(this._ngUnsubscribe$)).subscribe(({count:e})=>{var n;const i=null===(n=t.usersFilter.map.users)||void 0===n?void 0:n.length;t.usersFilter.exclude?this.numberOfSelected[Eo.e.USERS]=i?e-i:e:t.usersFilter.exclude||(this.numberOfSelected[Eo.e.USERS]=i||e),this.cd.detectChanges()}),new Map([[Eo.n,e.timeEntryAuditing],[Eo.j,e.projectAuditing],[Eo.m,e.projectAuditing],[Eo.g,e.clientAuditing],[Eo.l,e.tagAuditing]]).forEach((e,n)=>{e||delete t.actionsFilter.map[n]}),this.actionFilterValues=new wn.a({exclude:t.actionsFilter.exclude,map:Object.assign({},t.actionsFilter.map)}),this.actionFilterMaps.maps.forEach(e=>{const n=t.actionsFilter.map[e.key],i=e.value.map(e=>e.entity.id);if(t.actionsFilter.exclude){const s=t.actionsFilter.map[e.key];s&&0!==s.length?e.setSelected(i.filter(e=>!n.includes(e)),"id"):e.setSelectedAll(!0)}else n&&n.length>0&&e.setSelected(i.filter(e=>n.includes(e)),"id")}),this.numberOfSelected[Eo.a]=this.actionFilterMaps.getSelectedData().selected,this.cd.detectChanges(),this.dateRange={start:ke(t.dateRange.start),end:ke(t.dateRange.end)}}dropdownOpened(e){this.isOpenedMap[e]=!0,e===Eo.o&&(this.usersQuery[e].page=Eo.i,this.getUsers())}dropdownClosed(e){this.isOpenedMap[e]=!1}loadMoreUsers(){this.usersQuery[Eo.e.USERS].page++,this.getUsers()}getUsers(e=this.usersQuery[Eo.e.USERS]){e.statuses=[Xc.a.ACTIVE,Xc.a.INACTIVE],e.email=e.name,this.setInProgressLoading(Eo.e.USERS,!0),this.workspaceService.getReportsFilterTeamMembers(e).pipe(Object(Pe.a)(this._ngUnsubscribe$)).subscribe(({count:t,users:n})=>{!!e.name||this.userCount.set(Eo.o,t),1===e.page&&this.userFilterMaps[Eo.e.USERS].resetMap(Eo.o),this.userFilterMaps[Eo.e.USERS].pushToMap(Eo.o,n);const i=this.userFilterMaps[Eo.e.USERS].countSelectablesOf(Eo.o);this.reachedUserLimit[Eo.o]=i>=t||n.length<e.limit,this.setInProgressLoading(Eo.o,!1)},()=>{this.setInProgressLoading(Eo.o,!1)})}onFilterClosed(e,t){this.setIndicatorOf(e,t)}onFilterChange(e,t){e===Eo.e.USERS&&(this.userFilterMaps[Eo.e.USERS]=t.selectableMaps,this.userFilterValues[Eo.e.USERS]=t.checkboxValues),e===Eo.e.ACTIONS&&(this.actionFilterMaps=t.selectableMaps,this.actionFilterValues=t.checkboxValues),this.setIndicatorOf(e,t)}onFilterSearchChange(e,t){this.clearFilters(e,{searchTerm:t},!1),e===Eo.o&&this.getUsers()}onFilterOptionChange(e,t){this.clearFilters(e,t),e===Eo.o&&this.getUsers()}selectAllUserIds(e){const t={status:this.userFilterMaps[Eo.e.USERS].options.status,name:e.searchTerm};this.setInProgressLoading(Eo.e.USERS,!0),this.userService.getUserIds(t).pipe(Object(Pe.a)(this._ngUnsubscribe$)).subscribe(t=>{let n=e.isSelected;this.userFilterMaps[Eo.o].exclude&&(n=!n),this.userFilterMaps[Eo.e.USERS].toggleMultipleIds(Eo.e.USERS,t,n),this.isOpenedMap[Eo.o]||this.generateIndicatorOf(Eo.e.USERS),this.setInProgressSelectAll(Eo.e.USERS)})}resetQuery(){this.usersQuery[Eo.e.USERS]={page:Eo.i,limit:In.f,name:""},this.reachedUserLimit={}}applyFilter(){this.saveFilters();const e=this.formatFilters();this.filtersUpdated.emit(e)}saveFilters(){const e={usersFilter:{exclude:this.userFilterValues.users.exclude,map:Object.assign({},this.userFilterValues.users.map)},actionsFilter:{exclude:this.actionFilterValues.exclude,map:Object.assign({},this.actionFilterValues.map)},dateRange:{start:this.dateRange.start.toISOString(),end:this.dateRange.end.toISOString(),label:this.dateRange.label}};this.auditLogService.saveFilterSettings(e)}formatFilters(){const e={users:{exclude:null,userIds:null},actions:null,to:null,from:null};e.users={exclude:this.userFilterValues.users.exclude,userIds:Object.keys(this.userFilterValues.users.map).length>0?[...this.userFilterValues.users.map.users]:[]},e.actions=this.actionFilterMaps.getAllSelectedEntities().map(e=>e.id);const t=ke(this.dateRange.start).tz(this.activeUser.settings.timeZone).utcOffset(),n=ke(this.dateRange.end).tz(this.activeUser.settings.timeZone).utcOffset();return e.from=this.dateRange.start.clone().subtract(t,"minutes").toISOString(),e.to=this.dateRange.end.clone().subtract(n,"minutes").toISOString(),Object.assign({},e)}clearFilters(e,t,n=!0){e===Eo.o&&(this.usersQuery[e].page=1,this.usersQuery[e].name=t.searchTerm,this.reachedUserLimit[e]=!1,n&&(this.userCount[e]=!1)),e===Eo.a&&(this.actionsQuery=[])}setInProgressSelectAll(e,t=!1){e===Eo.o&&(this.inProgressSelectAllUsers[e]=t),this.cd.markForCheck()}setInProgressLoading(e,t){e===Eo.o&&(this.inProgressLoadingUsers[e]=t),this.cd.markForCheck()}generateIndicatorOf(e){if(e===Eo.o){if(!this.userFilterValues[e])return;const t=this.userFilterValues[Eo.o].getSelectedData(this.userFilterMaps[e]);this.numberOfSelected[e]=t.numberOfSelected>=0?t.numberOfSelected:t.numberOfSelectedApproximately}if(e===Eo.a){if(0===Object.keys(this.actionFilterValues.map).length&&!this.actionFilterValues.exclude)return;const t=this.actionFilterValues.getSelectedData(this.actionFilterMaps);this.numberOfSelected[e]=t.numberOfSelected>=0?t.numberOfSelected:t.numberOfSelectedApproximately}this.cd.markForCheck()}setIndicatorOf(e,{numberOfSelected:t,numberOfSelectedApproximately:n}){e===Eo.o?this.numberOfSelected[Eo.o]=t||n:this.numberOfSelected[Eo.a]=this.actionFilterMaps.getSelectedData().selected,this.checkApplyButton(),this.cd.markForCheck()}checkApplyButton(){const e=this.isUsersFilterValid(),t=this.isActionsFilterValid();this.applyButtonDisabled=!(e&&t)}isUsersFilterValid(){const e=this.userFilterValues.users.hasSelected();return!(!this.userFilterValues.users.exclude&&!e)}isActionsFilterValid(){const e=this.actionFilterValues.hasSelected();return!(!this.actionFilterValues.exclude&&!e)}dateRangeChanged(e){const t=e.dateRange.start.clone();let n=e.dateRange.end.clone();n.diff(t,"days")>30&&(n=e.dateRange.start.add(30,"days")),this.dateRange={start:t,end:n};const i=this.isUsersFilterValid(),s=this.isActionsFilterValid();i&&s&&this.applyButtonDisabled&&(this.applyButtonDisabled=!1,this.cd.detectChanges()),this.analyticsService.addEvent(new Fi.a({event:"change",uevent:"change",value:this.dateRange.start.format("MMMM DD, YYYY")+" - "+this.dateRange.end.format("MMMM DD, YYYY"),amount:"",section:"Workspace settings",section2:"Audit Log",section3:"",section4:"Run Report"}))}initDateRange(){this.dateRange={start:ke().utc().startOf("day"),end:ke().utc().endOf("day")}}translateFilterItems(e){const t=e.value.map(e=>e.entity.labelTranslationKey),n=this.translateService.instant(t);t.forEach((t,i)=>{e.value[i].entity.label=n[t]})}setProjectGroupingLabelTranslation(e){let t;return t=e===go.a.client?this.translateService.instant("GLOBAL.CLIENT_LABEL"):e===go.a.department?this.translateService.instant("GLOBAL.DEPARTMENT_LABEL"):e===go.a.category?this.translateService.instant("GLOBAL.CATEGORY_LABEL"):e,t}ngOnDestroy(){this._ngUnsubscribe$.next(),this._ngUnsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.h),s.Rb(l.a),s.Rb(Lc.a),s.Rb(kt.a),s.Rb(g.f),s.Rb(re.a),s.Rb(a.d),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["audit-log-filter"]],outputs:{filtersUpdated:"filtersUpdated"},decls:26,vars:21,consts:[[1,"cl-card","cl-border-bottom","cl-mb-0"],[1,"cl-component-row","cl-p-0"],[1,"cl-report-entry-actions","cl-border-0","cl-d-flex","cl-flex-wrap","cl-w-100"],[1,"cl-ml-2","cl-d-report-filter-item"],[3,"disableDatepicker","removeArrows","disableOpenPicker","onlyLastDays","minDate","maxDate","timeEntriesDateRange","enableMonthlyRangesOnly","forceDefaultLabel","dateRangeOut"],[1,"cl-d-report-filter-item",2,"width","123px"],["dropdownKey","",1,"cl-dropdown","cl-dropdown-large","cl-d-flex",3,"onOpen","onClose"],["dropdownKeyButton","","tabindex","0","data-cy","audit-log-user",1,"pointer","cl-component-divided-left","cl-dropdown-toggle"],["class","cl-badge cl-badge-filter",4,"ngIf"],["filterName","selectUsers",3,"placeholder","isResizeable","preventOfflineFiltering","showSelectAll","checkboxValues","selectableMaps","searchValue","countMap","inProgressSelectAll","inProgressLoading","loadMore","onSelectAllWithTextInput","onSearchChange","onFilterOptionChange","onCloseFilter","onChange",4,"dropdownKeyContent"],[1,"cl-d-report-filter-item"],["dropdownKeyButton","","tabindex","0","data-cy","audit-log-action",1,"pointer","cl-component-divided-left","cl-dropdown-toggle"],["filterName","actions","labelProp","label",3,"showSearch","isResizeable","alreadySorted","preventOfflineFiltering","showSelectAll","checkboxValues","selectableMaps","countMap","enableSelectingGroups","onFilterOptionChange","onCloseFilter","onChange",4,"dropdownKeyContent"],[1,"cl-component-divided-left"],[1,"cl-ml-auto"],[1,"cl-mx-2"],["tabindex","0",1,"cl-btn","cl-btn-primary","cl-ml-auto","cl-d-lg-custom-block",3,"disabled","keyup.enter","click"],[1,"cl-badge","cl-badge-filter"],["filterName","selectUsers",3,"placeholder","isResizeable","preventOfflineFiltering","showSelectAll","checkboxValues","selectableMaps","searchValue","countMap","inProgressSelectAll","inProgressLoading","loadMore","onSelectAllWithTextInput","onSearchChange","onFilterOptionChange","onCloseFilter","onChange"],["filterName","actions","labelProp","label",3,"showSearch","isResizeable","alreadySorted","preventOfflineFiltering","showSelectAll","checkboxValues","selectableMaps","countMap","enableSelectingGroups","onFilterOptionChange","onCloseFilter","onChange"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"datepicker-range",4),s.jc("dateRangeOut",(function(e){return t.dateRangeChanged(e)})),s.Wb(),s.Wb(),s.Xb(5,"div",5),s.Xb(6,"div",6),s.jc("onOpen",(function(){return t.dropdownOpened(t.AuditLogFilter.USERS)}))("onClose",(function(){return t.dropdownClosed(t.AuditLogFilter.USERS)})),s.Xb(7,"div",7),s.Zc(8),s.oc(9,"translate"),s.Xc(10,Ag,2,1,"span",8),s.Wb(),s.Xc(11,Og,2,12,"dropdown-checkbox",9),s.Wb(),s.Wb(),s.Xb(12,"div",10),s.Xb(13,"div",6),s.jc("onOpen",(function(){return t.dropdownOpened(t.AuditLogFilter.ACTIONS)}))("onClose",(function(){return t.dropdownClosed(t.AuditLogFilter.ACTIONS)})),s.Xb(14,"div",11),s.Zc(15),s.oc(16,"translate"),s.Xc(17,vg,2,1,"span",8),s.Wb(),s.Xc(18,Tg,1,9,"dropdown-checkbox",12),s.Wb(),s.Wb(),s.Xb(19,"div",10),s.Sb(20,"div",13),s.Wb(),s.Xb(21,"div",14),s.Xb(22,"div",15),s.Xb(23,"button",16),s.jc("keyup.enter",(function(){return t.applyFilter()}))("click",(function(){return t.applyFilter()})),s.Zc(24),s.oc(25,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(4),s.wc("disableDatepicker",!1)("removeArrows",!0)("disableOpenPicker",!1)("onlyLastDays",!0)("minDate",t.dateLimit.min)("maxDate",t.dateLimit.max)("timeEntriesDateRange",t.dateRange)("enableMonthlyRangesOnly",!0)("forceDefaultLabel",!0),s.Cb(4),s.bd(" ",s.pc(9,15,t.numberOfSelected[t.AuditLogFilter.USERS]?"GLOBAL.USERS_LABEL":"TEAMS.USERS.SELECT")," "),s.Cb(2),s.wc("ngIf",t.numberOfSelected[t.AuditLogFilter.USERS]),s.Cb(5),s.bd(" ",s.pc(16,17,t.numberOfSelected[t.AuditLogFilter.ACTIONS]?"INVOICES.DETAILS.ACTIONS":"GLOBAL.SELECT_ACTION_LABEL")," "),s.Cb(2),s.wc("ngIf",t.numberOfSelected[t.AuditLogFilter.ACTIONS]),s.Cb(6),s.wc("disabled",t.applyButtonDisabled),s.Cb(1),s.bd(" ",s.pc(25,19,"AUDIT_LOG.APPLY_FILTER_BTN")," "))},directives:[ws.a,ni.a,ii.a,i.u,si.a,Cg.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})(),wg=(()=>{class e{constructor(e,t){this.cd=e,this.auditLogTableService=t}ngOnInit(){}expandAll(){this.isExpandAll=!this.isExpandAll,this.auditLogTableService.setExpandAllRows(this.isExpandAll)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.h),s.Rb(_t))},e.\u0275cmp=s.Lb({type:e,selectors:[["audit-log-table-header"],["","audit-log-table-header",""]],decls:18,vars:10,consts:[[1,"cl-text-gray-6","cl-text-break"],[1,"cl-d-flex","cl-justify-content-start","cl-align-items-center","cl-pl-2"],[1,"cl-mx-0",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"],[1,"cl-ml-lg-custom-n2"]],template:function(e,t){1&e&&(s.Xb(0,"th",0),s.Xb(1,"div",1),s.Xb(2,"a",2),s.jc("click",(function(){return t.expandAll()})),s.Xb(3,"span",3),s.Sb(4,"img",4),s.Wb(),s.Wb(),s.Xb(5,"div"),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(8,"th",0),s.Xb(9,"div",5),s.Xb(10,"div"),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(13,"th",0),s.Xb(14,"div",5),s.Xb(15,"div"),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(4),s.wc("src",t.isExpandAll?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",s.Qc),s.Cb(2),s.ad(s.pc(7,4,"GLOBAL.TIMESTAMP_LABEL")),s.Cb(5),s.ad(s.pc(12,6,"GLOBAL.USER_LABEL")),s.Cb(5),s.ad(s.pc(17,8,"GLOBAL.ACTION_LABEL")))},pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var Lg=n("B4wx");let Rg=(()=>{class e{constructor(e,t,n){this.cd=e,this.auditLogTableService=t,this.authService=n,this.expand=!1,this.Actions=Eo.d}set expandAll(e){this.expand=e}ngOnInit(){this.user=this.authService.getUser(),this.timeFormat=this.user.settings.timeFormat===Lg.a.HOUR24?"HH:mm":"hh:mmA"}ngAfterViewinit(){this.cd.detectChanges()}onExpandRow(){this.expand=!this.expand,this.auditLogTableService.setExpandRow(this.rowIndex,this.expand)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.h),s.Rb(_t),s.Rb(re.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["audit-log-table-row"],["","audit-log-table-row",""]],inputs:{logEntry:"logEntry",expandAll:"expandAll",rowIndex:"rowIndex",availableActions:"availableActions"},decls:16,vars:13,consts:[[1,"cl-pl-lg-3","cl-py-2","cl-pr-0","cl-cut-text-wrapper-td"],[1,"cl-w-100","cl-text-decoration-none","cl-d-flex","cl-align-items-center"],[1,"cl-mx-0",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"],[1,"cl-p-0","cl-cut-text-wrapper-td"],[1,"cl-component-divided-left","cl-w-100","cl-text-decoration-none","cl-d-flex","cl-align-items-center","cl-cut-text-wrapper",3,"title"],[1,"cl-cut-text"],[1,"cl-component-divided-left","cl-w-100","cl-text-decoration-none","cl-d-flex","cl-align-items-center"]],template:function(e,t){1&e&&(s.Xb(0,"td",0),s.Xb(1,"div",1),s.Xb(2,"a",2),s.jc("click",(function(){return t.onExpandRow()})),s.Xb(3,"span",3),s.Sb(4,"img",4),s.Wb(),s.Wb(),s.Xb(5,"div"),s.Zc(6),s.oc(7,"momentFormat"),s.oc(8,"momentFormat"),s.Wb(),s.Wb(),s.Wb(),s.Xb(9,"td",5),s.Xb(10,"div",6),s.Xb(11,"div",7),s.Zc(12),s.Wb(),s.Wb(),s.Wb(),s.Xb(13,"td",5),s.Xb(14,"div",8),s.Zc(15),s.Wb(),s.Wb()),2&e&&(s.Cb(4),s.wc("src",t.expand?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",s.Qc),s.Cb(2),s.bd(" ",s.qc(7,7,t.logEntry.timestamp,t.user.settings.dateFormat)+" "+s.qc(8,10,t.logEntry.timestamp,t.timeFormat)," "),s.Cb(4),s.zc("title","",t.logEntry.userName," (",t.logEntry.userEmail,")"),s.Cb(2),s.cd(" ",t.logEntry.userName," (",t.logEntry.userEmail,") "),s.Cb(3),s.bd(" ",t.availableActions.get(t.logEntry.action)," "))},pipes:[Ro.a],encapsulation:2,changeDetection:0}),e})();const yg=new mg.a(Eo.e.CLIENT,[{id:"CREATE_CLIENT",value:"CREATE_CLIENT",label:"Created client",labelTranslationKey:"AUDIT_LOG.FILTERS.CLIENT.CREATE.BY_USER"},{id:"CREATE_CLIENT_IMPORT",value:"CREATE_CLIENT_IMPORT",label:"Created client (import)",labelTranslationKey:"AUDIT_LOG.FILTERS.CLIENT.CREATE.IMPORT"},{id:"CREATE_CLIENT_QUICKBOOKS",value:"CREATE_CLIENT_QUICKBOOKS",label:"Created client (QuickBooks)",labelTranslationKey:"AUDIT_LOG.FILTERS.CLIENT.CREATE.QUICKBOOKS"},{id:"UPDATE_CLIENT",value:"UPDATE_CLIENT",label:"Updated client",labelTranslationKey:"AUDIT_LOG.FILTERS.CLIENT.UPDATE"},{id:"DELETE_CLIENT",value:"DELETE_CLIENT",label:"Deleted client",labelTranslationKey:"AUDIT_LOG.FILTERS.CLIENT.DELETE"}],{label:Eo.f.client});n("RiPy");const _g=["audit-log-time-entry-details",""];function kg(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null==e._log.previousContent?null:e._log.previousContent.user," ")}}function Wg(e,t){1&e&&(s.Xb(0,"span",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function Xg(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"lowercase"),s.oc(3,"translate"),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.description?null==e._log.previousContent?null:e._log.previousContent.description:"("+s.pc(2,1,s.pc(3,3,"APPROVAL.ENTRY_NO_DESCRIPTION"))+")"," ")}}function Ng(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,Xg,4,5,"ng-container",1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function Dg(e,t){1&e&&(s.Xb(0,"span",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function Pg(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"lowercase"),s.oc(3,"translate"),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.projectTaskClient?null==e._log.previousContent?null:e._log.previousContent.projectTaskClient:"("+s.pc(2,1,s.pc(3,3,"GLOBAL.NO_PROJECT_LABEL"))+")"," ")}}function Mg(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,Pg,4,5,"ng-container",1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function Bg(e,t){1&e&&(s.Xb(0,"span",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function Ug(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",e.prevTagsLabel," ")}}function Gg(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,Ug,2,1,"ng-container",1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function xg(e,t){1&e&&(s.Xb(0,"span",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function Fg(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null==e._log.previousContent?null:e._log.previousContent.startDate," ")}}function jg(e,t){1&e&&(s.Xb(0,"span",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function Zg(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null==e._log.previousContent?null:e._log.previousContent.startTime," ")}}function Vg(e,t){1&e&&(s.Xb(0,"span",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function Yg(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null==e._log.previousContent?null:e._log.previousContent.endDate," ")}}function Hg(e,t){1&e&&(s.Xb(0,"span",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function $g(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null==e._log.previousContent?null:e._log.previousContent.endTime," ")}}function Kg(e,t){1&e&&(s.Xb(0,"span",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function qg(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null==e._log.previousContent?null:e._log.previousContent.duration," ")}}function zg(e,t){1&e&&(s.Xb(0,"span",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function Qg(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ","-"!==(null==e._log.previousContent?null:e._log.previousContent.billable)?s.pc(2,1,null!=e._log.previousContent&&e._log.previousContent.billable?"GLOBAL.TRUE_LABEL":"GLOBAL.FALSE_LABEL"):null==e._log.previousContent?null:e._log.previousContent.billable," ")}}function Jg(e,t){1&e&&(s.Xb(0,"span",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function eE(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"lowercase"),s.oc(3,"translate"),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.bd(" ",null!==(null==e._log.previousContent?null:e._log.previousContent.billableRate)?null==e._log.previousContent?null:e._log.previousContent.billableRate:"("+s.pc(2,1,s.pc(3,3,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_BILLABLE_RATE_LABEL"))+")"," ")}}function tE(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,eE,4,5,"ng-container",1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function nE(e,t){1&e&&(s.Xb(0,"span",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")))}function iE(e,t){1&e&&(s.Zc(0),s.oc(1,"translate")),2&e&&s.bd(" (",s.pc(1,1,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_BILLABLE_RATE_LABEL"),") ")}function sE(e,t){if(1&e&&(s.Xb(0,"tr"),s.Xb(1,"td",0),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,tE,2,1,"td",1),s.Xb(5,"td",0),s.Xc(6,nE,3,3,"span",2),s.Zc(7),s.oc(8,"lowercase"),s.oc(9,"translate"),s.Wb(),s.Xc(10,iE,2,3,"ng-template",null,4,s.Yc),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,4,"AUDIT_LOG.TABLE_COLUMNS.SHARED.BILLABLE_RATE")),s.Cb(2),s.wc("ngIf",e.action===e.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!e.oldEntryUpdated&&e.action===e.AuditLogAction.UPDATE&&"-"!==(null==e._log.content?null:e._log.content.billableRate)),s.Cb(1),s.bd(" ",null!=e._log.content&&e._log.content.billableRate?null==e._log.content?null:e._log.content.billableRate:"("+s.pc(8,6,s.pc(9,8,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_BILLABLE_RATE_LABEL"))+")"," ")}}function cE(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"lowercase"),s.oc(3,"translate"),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.costRate?null==e._log.previousContent?null:e._log.previousContent.costRate:"("+s.pc(2,1,s.pc(3,3,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_COST_RATE_LABEL"))+")"," ")}}function aE(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,cE,4,5,"ng-container",1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function oE(e,t){1&e&&(s.Xb(0,"span",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function rE(e,t){if(1&e&&(s.Xb(0,"tr"),s.Xb(1,"td",0),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,aE,2,1,"td",1),s.Xb(5,"td",0),s.Xc(6,oE,3,3,"span",2),s.Zc(7),s.oc(8,"lowercase"),s.oc(9,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,4,"AUDIT_LOG.TABLE_COLUMNS.SHARED.COST_RATE")),s.Cb(2),s.wc("ngIf",e.action===e.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!e.oldEntryUpdated&&e.action===e.AuditLogAction.UPDATE&&"-"!==(null==e._log.content?null:e._log.content.costRate)),s.Cb(1),s.bd(" ",null!=e._log.content&&e._log.content.costRate?null==e._log.content?null:e._log.content.costRate:"("+s.pc(8,6,s.pc(9,8,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_COST_RATE_LABEL"))+")"," ")}}function lE(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.bd(" ",!(null==e._log.previousContent||!e._log.previousContent.approved)," ")}}function bE(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,lE,2,1,"ng-container",1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function dE(e,t){1&e&&(s.Xb(0,"span",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function uE(e,t){if(1&e&&(s.Xb(0,"tr"),s.Xb(1,"td",0),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,bE,2,1,"td",1),s.Xb(5,"td",0),s.Xc(6,dE,3,3,"span",2),s.Zc(7),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,4,"AUDIT_LOG.TABLE_COLUMNS.TIME_ENTRY.APPROVED")),s.Cb(2),s.wc("ngIf",e.action===e.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!e.oldEntryUpdated&&e.action===e.AuditLogAction.UPDATE&&"-"!==(null==e._log.content?null:e._log.content.approved)),s.Cb(1),s.bd(" ",null==e._log.content?null:e._log.content.approved," ")}}function pE(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"lowercase"),s.oc(3,"translate"),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.bd(" ",null!==(null==e._log.previousContent?null:e._log.previousContent.invoiced)?null==e._log.previousContent?null:e._log.previousContent.invoiced:"("+s.pc(2,1,s.pc(3,3,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_INVOICED_STATUS_LABEL"))+")"," ")}}function hE(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,pE,4,5,"ng-container",1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function mE(e,t){1&e&&(s.Xb(0,"span",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function gE(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",null==e._log.content?null:e._log.content.invoiced," ")}}function EE(e,t){1&e&&(s.Zc(0),s.oc(1,"lowercase"),s.oc(2,"translate")),2&e&&s.bd(" (",s.pc(1,1,s.pc(2,3,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_INVOICED_STATUS_LABEL")),") ")}function fE(e,t){if(1&e&&(s.Xb(0,"tr"),s.Xb(1,"td",0),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,hE,2,1,"td",1),s.Xb(5,"td",0),s.Xc(6,mE,3,3,"span",2),s.Xc(7,gE,2,1,"ng-container",5),s.Wb(),s.Xc(8,EE,3,5,"ng-template",null,6,s.Yc),s.Wb()),2&e){const e=s.Lc(9),t=s.nc();s.Cb(2),s.ad(s.pc(3,5,"AUDIT_LOG.TABLE_COLUMNS.TIME_ENTRY.INVOICED")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.invoiced)),s.Cb(1),s.wc("ngIf",null!==(null==t._log.content?null:t._log.content.invoiced))("ngIfElse",e)}}function SE(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"lowercase"),s.oc(3,"translate"),s.Ub()),2&e){const e=s.nc(2).$implicit;s.Cb(1),s.bd(" ",null!==e.value.prev?e.value.prev:"("+s.pc(2,1,s.pc(3,3,"GLOBAL.NO_LABEL"))+" "+e.key+")"," ")}}function CE(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,SE,4,5,"ng-container",1),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function AE(e,t){1&e&&(s.Xb(0,"span",3),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")))}function OE(e,t){if(1&e&&(s.Xb(0,"tr"),s.Xb(1,"td"),s.Zc(2),s.Wb(),s.Xc(3,CE,2,1,"td",1),s.Xb(4,"td"),s.Xc(5,AE,3,3,"span",2),s.Zc(6),s.oc(7,"lowercase"),s.oc(8,"translate"),s.Wb(),s.Wb()),2&e){const e=t.$implicit,n=s.nc(2);s.Cb(2),s.ad(e.key),s.Cb(1),s.wc("ngIf",n.action===n.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!n.oldEntryUpdated&&n.action===n.AuditLogAction.UPDATE&&"-"!==e.value.current&&e.value.current!==e.value.prev),s.Cb(1),s.bd(" ",null!==e.value.current?e.value.current:"("+s.pc(7,4,s.pc(8,6,"GLOBAL.NO_LABEL"))+" "+e.key+")"," ")}}function vE(e,t){if(1&e&&(s.Vb(0),s.Xc(1,OE,9,8,"tr",7),s.oc(2,"keyvalue"),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngForOf",s.pc(2,1,e.customFieldsData))}}const TE=function(e){return{groupingLabelName:e}};let IE=(()=>{class e{constructor(e,t,n){this.auditLogService=e,this.authService=t,this.translateService=n,this.AuditLogAction=Eo.d,this.projectGroupingLabels=new Map([[go.a.client,"GLOBAL.CLINENT_LABEL"],[go.a.department,"GLOBAL.DEPARTMENT_LABEL"],[go.a.category,"GLOBAL.CATEGORY_LABEL"]])}set log(e){e&&(this.action=this.auditLogService.setActionFlag(e.action),this._log=this.auditLogService.prepareLogData(e,this.action))}ngOnInit(){this.noTagsLabel=this.translateService.instant("AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_TAGS_LABEL"),this.oldEntryUpdated=this.action===Eo.d.UPDATE&&null===this._log.previousContent,this.setInvoicedRowVisibility(),this.setApprovedRowVisibility(),this.groupingLabelTranslation=this.projectGroupingLabel===go.a.client||this.projectGroupingLabel===go.a.department||this.projectGroupingLabel===go.a.category?this.translateService.instant(this.projectGroupingLabels.get(this.projectGroupingLabel)):this.projectGroupingLabel,this.setProjectTaskClient("content"),this.setProjectTaskClient("previousContent"),this.setTags(),this.setRateLabel("content",Eo.k.BILLABLE_RATE),this.setRateLabel("previousContent",Eo.k.BILLABLE_RATE),this.setCostRateRowVisibility(),this.setRateLabel("content",Eo.k.COST_RATE),this.setRateLabel("previousContent",Eo.k.COST_RATE);const e=this.authService.getUser();this.dateFormat=e.settings.dateFormat,this.timeFormat=e.settings.timeFormat===Lg.a.HOUR24?"HH:mm":"hh:mmA",this.setDuration("content",this.durationFormat),this.setDuration("previousContent",this.durationFormat),this.setDateAndTime("content","start"),this.setDateAndTime("content","end"),this.setDateAndTime("previousContent","start"),this.setDateAndTime("previousContent","end"),this._log.previousContent&&(this._log.previousContent.approved=!!this._log.previousContent.approved),this.prepareCustomFields(this.action,this.oldEntryUpdated),this.prepareBillableRateRowData(this.action),this._log.previousContent&&Object.keys(this._log.previousContent).forEach(e=>{"customFields"!==e&&this._log.content[e]===this._log.previousContent[e]&&(this._log.content[e]="-")})}setProjectTaskClient(e){if(this._log[e]){let t="";this._log[e].project&&(t+=this._log[e].project),this._log[e].task&&(t+=":"+this._log[e].task),this._log[e].client&&(t+=" - "+this._log[e].client),this._log[e].projectTaskClient=t}}setCostRateRowVisibility(){this._log.content&&null===this._log.previousContent?this.showCostRateRow=null!==this._log.content.costRate:this._log.content&&this._log.previousContent&&(this.showCostRateRow=null!==this._log.content.costRate||null!==this._log.previousContent.costRate)}setRateLabel(e,t){this._log[e]&&this._log[e][t]&&(this._log[e][t]=this._log[e][t]/100+" "+this._log[e].currency)}setDuration(e,t){let n;if(this._log[e]){if("h.hh"===t)n=Object(ke.duration)(this._log[e].duration,"seconds").asHours().toFixed(2);else if("h:mm"===t){const i=Object(ke.duration)(this._log[e].duration,"seconds").seconds();i>0?(n=Object(ke.duration)(this._log[e].duration,"seconds"),n=n.subtract(Object(ke.duration)(i,"seconds")),n=n.add(Object(ke.duration)(1,"minute"))):n=Object(ke.duration)(this._log[e].duration,"seconds"),n=Object(ke.duration)(n,"seconds").format(t,{trim:!1})}else n=Object(ke.duration)(this._log[e].duration,"seconds").format(t,{trim:!1});this._log[e].duration=n.toString()}}setDateAndTime(e,t){if(this._log[e]){const n=ke(this._log[e][t]),i=n.format(this.dateFormat).toString(),s=n.format(this.timeFormat).toString();"start"===t&&(this._log[e].startTime=s,this._log[e].startDate=i),"end"===t&&(this._log[e].endTime=s,this._log[e].endDate=i)}}prepareCustomFields(e,t){var n,i;const s=new Map;let c=[];this._log.previousContent&&(c=Object.keys(this._log.previousContent.customFields));let a=[];if(this._log.content&&(a=Object.keys(this._log.content.customFields)),this.customFieldsPresent=0!==c.length||0!==a.length,this.customFieldsPresent){if((null===(n=this._log.content)||void 0===n?void 0:n.project)!==(null===(i=this._log.previousContent)||void 0===i?void 0:i.project))a.forEach(e=>{var t,n;const i=null===(t=this._log.previousContent)||void 0===t?void 0:t.customFields[e],c=null===(n=this._log.content)||void 0===n?void 0:n.customFields[e];s.set(e,{prev:i||"-",current:c!==i?c:"-"})});else{c.length>=a.length?c.forEach(e=>{var t;s.set(e,{prev:this._log.previousContent.customFields[e],current:(null===(t=this._log.content)||void 0===t?void 0:t.customFields[e])||null})}):a.forEach(e=>{var t,n;s.set(e,{prev:(null===(t=this._log.previousContent)||void 0===t?void 0:t.customFields[e])||null,current:null===(n=this._log.content)||void 0===n?void 0:n.customFields[e]})});for(const[n,i]of s)i.prev=i.prev?i.prev:null,i.current=i.current?i.current:null,e===Eo.d.UPDATE&&(t?i.current=i.current?i.current:null:i.prev===i.current&&(i.current="-"))}this.customFieldsData=new Map([...s])}}setSharedCustomFieldPreviousValue(e,t,n,i){}setTags(){this._log.previousContent&&(this.prevTagsLabel=this.setTagsLabel("previousContent")),this._log.content&&(this.tagsLabel=this.setTagsLabel("content")),this._log.content&&this._log.previousContent&&(this.tagsUpdated=this.tagsLabel!==this.prevTagsLabel,this.tagsUpdated||(this.tagsLabel="-"))}setTagsLabel(e){let t="";if(this._log[e].tags.length>0){const n=this._log[e].tags.length;this._log[e].tags.forEach((e,i)=>{t+=e+(i!==n-1?", ":"")})}else t="("+this.noTagsLabel+")";return t}setInvoicedRowVisibility(){var e;this._log.content&&null===this._log.previousContent?this.showInvoicedRow=null!==(null===(e=this._log.content)||void 0===e?void 0:e.invoiced):this._log.content&&this._log.previousContent&&(this.showInvoicedRow=null!==this._log.content.invoiced||null!==this._log.previousContent.invoiced)}setApprovedRowVisibility(){var e;this._log.content&&null===this._log.previousContent?this.showApprovedRow=null!==(null===(e=this._log.content)||void 0===e?void 0:e.approved):this._log.content&&this._log.previousContent&&(this.showApprovedRow=null!==this._log.content.approved||null!==this._log.previousContent.approved)}prepareBillableRateRowData(e){e===Eo.d.UPDATE?this.oldEntryUpdated?this._log.content.billable&&(this.showBillableRateRow=!0):this._log.previousContent.billable&&!this._log.content.billable?(this._log.content.billableRate=null,this.showBillableRateRow=!0):!this._log.previousContent.billable&&this._log.content.billable?(this._log.previousContent.billableRate=null,this.showBillableRateRow=!0):this.showBillableRateRow=!(!this._log.previousContent.billable&&!this._log.content.billable):this._log.content.billable&&(this.showBillableRateRow=!0)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(kt.a),s.Rb(re.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["","audit-log-time-entry-details",""]],inputs:{log:"log",durationFormat:"durationFormat",projectGroupingLabel:"projectGroupingLabel",workspace:"workspace"},attrs:_g,decls:90,vars:78,consts:[[1,"cl-pl-3"],[4,"ngIf"],["class","cl-badge-approve cl-badge-success no-wrap cl-text-white cl-mr-1",4,"ngIf"],[1,"cl-badge-approve","cl-badge-success","no-wrap","cl-text-white","cl-mr-1"],["noBillableRateData",""],[4,"ngIf","ngIfElse"],["noInvoicedStatusData",""],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(s.Xb(0,"tr"),s.Xb(1,"td",0),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,kg,2,1,"td",1),s.Xb(5,"td",0),s.Xc(6,Wg,3,3,"span",2),s.Zc(7),s.Wb(),s.Wb(),s.Xb(8,"tr"),s.Xb(9,"td",0),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Xc(12,Ng,2,1,"td",1),s.Xb(13,"td",0),s.Xc(14,Dg,3,3,"span",2),s.Zc(15),s.oc(16,"lowercase"),s.oc(17,"translate"),s.Wb(),s.Wb(),s.Xb(18,"tr"),s.Xb(19,"td",0),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Xc(22,Mg,2,1,"td",1),s.Xb(23,"td",0),s.Xc(24,Bg,3,3,"span",2),s.Zc(25),s.oc(26,"lowercase"),s.oc(27,"translate"),s.Wb(),s.Wb(),s.Xb(28,"tr"),s.Xb(29,"td",0),s.Zc(30),s.oc(31,"translate"),s.Wb(),s.Xc(32,Gg,2,1,"td",1),s.Xb(33,"td",0),s.Xc(34,xg,3,3,"span",2),s.Zc(35),s.Wb(),s.Wb(),s.Xb(36,"tr"),s.Xb(37,"td",0),s.Zc(38),s.oc(39,"translate"),s.Wb(),s.Xc(40,Fg,2,1,"td",1),s.Xb(41,"td",0),s.Xc(42,jg,3,3,"span",2),s.Zc(43),s.Wb(),s.Wb(),s.Xb(44,"tr"),s.Xb(45,"td",0),s.Zc(46),s.oc(47,"translate"),s.Wb(),s.Xc(48,Zg,2,1,"td",1),s.Xb(49,"td",0),s.Xc(50,Vg,3,3,"span",2),s.Zc(51),s.Wb(),s.Wb(),s.Xb(52,"tr"),s.Xb(53,"td",0),s.Zc(54),s.oc(55,"translate"),s.Wb(),s.Xc(56,Yg,2,1,"td",1),s.Xb(57,"td",0),s.Xc(58,Hg,3,3,"span",2),s.Zc(59),s.Wb(),s.Wb(),s.Xb(60,"tr"),s.Xb(61,"td",0),s.Zc(62),s.oc(63,"translate"),s.Wb(),s.Xc(64,$g,2,1,"td",1),s.Xb(65,"td",0),s.Xc(66,Kg,3,3,"span",2),s.Zc(67),s.Wb(),s.Wb(),s.Xb(68,"tr"),s.Xb(69,"td",0),s.Zc(70),s.oc(71,"translate"),s.Wb(),s.Xc(72,qg,2,1,"td",1),s.Xb(73,"td",0),s.Xc(74,zg,3,3,"span",2),s.Zc(75),s.Wb(),s.Wb(),s.Xb(76,"tr"),s.Xb(77,"td",0),s.Zc(78),s.oc(79,"translate"),s.Wb(),s.Xc(80,Qg,3,3,"td",1),s.Xb(81,"td",0),s.Xc(82,Jg,3,3,"span",2),s.Zc(83),s.oc(84,"translate"),s.Wb(),s.Wb(),s.Xc(85,sE,12,10,"tr",1),s.Xc(86,rE,10,10,"tr",1),s.Xc(87,uE,8,6,"tr",1),s.Xc(88,fE,10,7,"tr",1),s.Xc(89,vE,3,3,"ng-container",1)),2&e&&(s.Cb(2),s.ad(s.pc(3,45,"AUDIT_LOG.TABLE_COLUMNS.TIME_ENTRY.USER")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.user)),s.Cb(1),s.bd(" ",null==t._log.content?null:t._log.content.user," "),s.Cb(3),s.ad(s.pc(11,47,"AUDIT_LOG.TABLE_COLUMNS.TIME_ENTRY.DESCRIPTION")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.description)),s.Cb(1),s.bd(" ",null!=t._log.content&&t._log.content.description?null==t._log.content?null:t._log.content.description:"("+s.pc(16,49,s.pc(17,51,"APPROVAL.ENTRY_NO_DESCRIPTION"))+")"," "),s.Cb(5),s.ad(s.qc(21,53,"AUDIT_LOG.TABLE_COLUMNS.TIME_ENTRY.PROJECT",s.Bc(76,TE,t.groupingLabelTranslation))),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.projectTaskClient)),s.Cb(1),s.bd(" ",null!=t._log.content&&t._log.content.projectTaskClient?null==t._log.content?null:t._log.content.projectTaskClient:"("+s.pc(26,56,s.pc(27,58,"GLOBAL.NO_PROJECT_LABEL"))+")"," "),s.Cb(5),s.ad(s.pc(31,60,"AUDIT_LOG.TABLE_COLUMNS.TIME_ENTRY.TAGS")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&t.tagsUpdated),s.Cb(1),s.bd(" ",t.tagsLabel," "),s.Cb(3),s.ad(s.pc(39,62,"AUDIT_LOG.TABLE_COLUMNS.TIME_ENTRY.START_DATE")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.startDate)),s.Cb(1),s.bd(" ",null==t._log.content?null:t._log.content.startDate," "),s.Cb(3),s.ad(s.pc(47,64,"AUDIT_LOG.TABLE_COLUMNS.TIME_ENTRY.START_TIME")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==t._log.content.startTime),s.Cb(1),s.bd(" ",null==t._log.content?null:t._log.content.startTime," "),s.Cb(3),s.ad(s.pc(55,66,"AUDIT_LOG.TABLE_COLUMNS.TIME_ENTRY.END_DATE")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==t._log.content.endDate),s.Cb(1),s.bd(" ",null==t._log.content?null:t._log.content.endDate," "),s.Cb(3),s.ad(s.pc(63,68,"AUDIT_LOG.TABLE_COLUMNS.TIME_ENTRY.END_TIME")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.endTime)),s.Cb(1),s.bd(" ",null==t._log.content?null:t._log.content.endTime," "),s.Cb(3),s.ad(s.pc(71,70,"AUDIT_LOG.TABLE_COLUMNS.TIME_ENTRY.DURATION")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.duration)),s.Cb(1),s.bd(" ",null==t._log.content?null:t._log.content.duration," "),s.Cb(3),s.ad(s.pc(79,72,"AUDIT_LOG.TABLE_COLUMNS.SHARED.BILLABLE")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.billable)),s.Cb(1),s.bd(" ","-"!==(null==t._log.content?null:t._log.content.billable)?s.pc(84,74,null!=t._log.content&&t._log.content.billable?"GLOBAL.TRUE_LABEL":"GLOBAL.FALSE_LABEL"):null==t._log.content?null:t._log.content.billable," "),s.Cb(2),s.wc("ngIf",t.showBillableRateRow),s.Cb(1),s.wc("ngIf",t.showCostRateRow),s.Cb(1),s.wc("ngIf",t.showApprovedRow),s.Cb(1),s.wc("ngIf",t.showInvoicedRow),s.Cb(1),s.wc("ngIf",t.customFieldsPresent))},directives:[i.u,i.t],pipes:[g.e,i.q,i.m],encapsulation:2}),e})();const wE=["audit-log-project-details",""];function LE(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null==e._log.previousContent?null:e._log.previousContent.projectName," ")}}function RE(e,t){1&e&&(s.Xb(0,"span",5),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function yE(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"lowercase"),s.oc(3,"translate"),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.client?null==e._log.previousContent?null:e._log.previousContent.client:"("+s.pc(2,1,s.pc(3,3,"GLOBAL.NO_CLIENT_LABEL"))+")"," ")}}function _E(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,yE,4,5,"ng-container",1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function kE(e,t){1&e&&(s.Xb(0,"span",5),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function WE(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.archived?s.pc(2,1,null==e._log.previousContent?null:e._log.previousContent.archived):""," ")}}function XE(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,WE,3,3,"ng-container",1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function NE(e,t){1&e&&(s.Xb(0,"span",5),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function DE(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.pc(2,1,null==e._log.previousContent?null:e._log.previousContent.visibility)," ")}}function PE(e,t){1&e&&(s.Xb(0,"span",5),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function ME(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.Ub()),2&e){const e=t.$implicit,n=t.last;s.Cb(1),s.cd(" ",e," ",n?"":", "," ")}}function BE(e,t){if(1&e&&(s.Vb(0),s.Xc(1,ME,2,2,"ng-container",6),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngForOf",e._log.previousContent.members)}}function UE(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,BE,2,1,"ng-container",1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e._log.previousContent)}}function GE(e,t){1&e&&(s.Xb(0,"span",5),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function xE(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.Ub()),2&e){const e=t.$implicit,n=t.last;s.Cb(1),s.cd(" ",e," ",n?"":", "," ")}}function FE(e,t){if(1&e&&(s.Vb(0),s.Xc(1,xE,2,2,"ng-container",6),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngForOf",e._log.content.members)}}function jE(e,t){1&e&&s.Zc(0," - ")}function ZE(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.note?null==e._log.previousContent?null:e._log.previousContent.note:"("+s.pc(2,1,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_NOTE_LABEL")+")"," ")}}function VE(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,ZE,3,3,"ng-container",1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function YE(e,t){1&e&&(s.Xb(0,"span",5),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function HE(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ","-"!==(null==e._log.previousContent?null:e._log.previousContent.billableByDefault)?s.pc(2,1,null!=e._log.previousContent&&e._log.previousContent.billableByDefault?"GLOBAL.TRUE_LABEL":"GLOBAL.FALSE_LABEL"):null==e._log.previousContent?null:e._log.previousContent.billableByDefault," ")}}function $E(e,t){1&e&&(s.Xb(0,"span",5),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function KE(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.billableRate?null==e._log.previousContent?null:e._log.previousContent.billableRate:"("+s.pc(2,1,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_BILLABLE_RATE_LABEL")+")"," ")}}function qE(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,KE,3,3,"ng-container",1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function zE(e,t){1&e&&(s.Xb(0,"span",5),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function QE(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.costRate?null==e._log.previousContent?null:e._log.previousContent.costRate:"("+s.pc(2,1,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_COST_RATE_LABEL")+")"," ")}}function JE(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,QE,3,3,"ng-container",1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function ef(e,t){1&e&&(s.Xb(0,"span",5),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function tf(e,t){if(1&e&&(s.Xb(0,"tr"),s.Xb(1,"td",0),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,JE,2,1,"td",1),s.Xb(5,"td",0),s.Xc(6,ef,3,3,"span",2),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,4,"AUDIT_LOG.TABLE_COLUMNS.SHARED.COST_RATE")),s.Cb(2),s.wc("ngIf",e.action===e.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!e.oldEntryUpdated&&e.action===e.AuditLogAction.UPDATE&&"-"!==(null==e._log.content?null:e._log.content.costRate)),s.Cb(1),s.bd(" ",null!=e._log.content&&e._log.content.costRate?null==e._log.content?null:e._log.content.costRate:"("+s.pc(8,6,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_COST_RATE_LABEL")+")"," ")}}function nf(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null==e._log.previousContent?null:e._log.previousContent.estimateTypeLabel," ")}}function sf(e,t){1&e&&(s.Xb(0,"span",5),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function cf(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"lowercase"),s.oc(3,"translate"),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.estimate?null==e._log.previousContent?null:e._log.previousContent.estimate:"("+s.pc(2,1,s.pc(3,3,"PROJECTS.DROPDOWN.NO_ESTIMATE"))+")"," ")}}function af(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,cf,4,5,"ng-container",1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function of(e,t){1&e&&(s.Xb(0,"span",5),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function rf(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ","-"!==(null==e._log.previousContent?null:e._log.previousContent.recurringEstimate)?s.pc(2,1,null!=e._log.previousContent&&e._log.previousContent.recurringEstimate?"GLOBAL.TRUE_LABEL":"GLOBAL.FALSE_LABEL"):null==e._log.previousContent?null:e._log.previousContent.recurringEstimate," ")}}function lf(e,t){1&e&&(s.Xb(0,"span",5),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}let bf=(()=>{class e{constructor(e,t){this.auditLogService=e,this.translate=t,this.AuditLogAction=Eo.d,this.membersUpdated=!1}set log(e){this.action=this.auditLogService.setActionFlag(e.action),this._log=this.auditLogService.prepareLogData(e,this.action)}ngOnInit(){if(this.oldEntryUpdated=this.action===Eo.d.UPDATE&&null===this._log.previousContent,this.showCostRateRow=this.workspace.isCostRateActive,this.setRate("previousContent","billableRate"),this.setRate("content","billableRate"),this.setRate("previousContent","costRate"),this.setRate("content","costRate"),this.setEstimate("content"),this.setEstimate("previousContent"),this.setEstimateType("content"),this.setEstimateType("previousContent"),this.setArchived("content"),this.setArchived("previousContent"),this.setVisibility("content"),this.setVisibility("previousContent"),this._log.previousContent&&Object.keys(this._log.previousContent).forEach(e=>{this._log.content[e]===this._log.previousContent[e]&&(this._log.content[e]="-")}),this.action===Eo.d.UPDATE){const e=this._log.content.members.toString(),t=this._log.previousContent?this._log.previousContent.members.toString():null;this.membersUpdated=e!==t}}convertMembersArrToString(e){if(null===e)return null;const t=e.length;let n;return e.forEach((e,i)=>{n+=e,i<t-1&&(n+=", ")}),n}setRate(e,t){this._log[e]&&this._log[e][t]&&(this._log[e][t]=this._log[e][t]/100+" "+this._log[e].currency)}setArchived(e){this._log[e]&&(this._log[e].archived=this._log[e].archived?"GLOBAL.ARCHIVED_LABEL":"GLOBAL.ACTIVE_LABEL")}setVisibility(e){this._log[e]&&(this._log[e].visibility=this._log[e].visibility?"GLOBAL.PUBLIC_LABEL":"GLOBAL.PRIVATE_LABEL")}setEstimate(e){const t=this.translate.instant("PROJECTS.SHARED.PER_MONTH_LABEL");if(this._log[e]){let n,i;this._log[e].activeEstimate===Eo.b.TIME?(n=ke.duration(this._log[e].estimate).asHours().toString(),this._log[e].estimate=n+"h",this._log[e].recurringEstimate&&(this._log[e].estimate+=" "+t)):this._log[e].activeEstimate===Eo.b.BUDGET?(i=this._log[e].estimate/100,this._log[e].estimate=i.toString()+" "+this._log[e].currency,this._log[e].recurringEstimate&&(this._log[e].estimate+=" "+t)):this._log[e].estimate=null}}setEstimateType(e){if(this._log[e])if(this._log[e].activeEstimate===Eo.b.NONE){const t=this.translate.instant(Eo.h.NONE);this._log[e].estimateTypeLabel="("+t.toLowerCase()+")"}else{const t=this.translate.instant(Eo.h[this._log[e].activeEstimate]),n=this.translate.instant(Eo.h[this._log[e].estimateType]);this._log[e].estimateTypeLabel=`${t} - ${n}`}}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(kt.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["","audit-log-project-details",""]],inputs:{log:"log",workspace:"workspace"},attrs:wE,decls:101,vars:88,consts:[[1,"cl-pl-3"],[4,"ngIf"],["class","cl-badge-approve cl-badge-success no-wrap cl-text-white cl-mr-1",4,"ngIf"],[4,"ngIf","ngIfElse"],["membersUntouched",""],[1,"cl-badge-approve","cl-badge-success","no-wrap","cl-text-white","cl-mr-1"],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(s.Xb(0,"tr"),s.Xb(1,"td",0),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,LE,2,1,"td",1),s.Xb(5,"td",0),s.Xc(6,RE,3,3,"span",2),s.Zc(7),s.Wb(),s.Wb(),s.Xb(8,"tr"),s.Xb(9,"td",0),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Xc(12,_E,2,1,"td",1),s.Xb(13,"td",0),s.Xc(14,kE,3,3,"span",2),s.Zc(15),s.oc(16,"lowercase"),s.oc(17,"translate"),s.Wb(),s.Wb(),s.Xb(18,"tr"),s.Xb(19,"td",0),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Xc(22,XE,2,1,"td",1),s.Xb(23,"td",0),s.Xc(24,NE,3,3,"span",2),s.Zc(25),s.oc(26,"translate"),s.Wb(),s.Wb(),s.Xb(27,"tr"),s.Xb(28,"td",0),s.Zc(29),s.oc(30,"translate"),s.Wb(),s.Xc(31,DE,3,3,"td",1),s.Xb(32,"td",0),s.Xc(33,PE,3,3,"span",2),s.Zc(34),s.oc(35,"translate"),s.Wb(),s.Wb(),s.Xb(36,"tr"),s.Xb(37,"td",0),s.Zc(38),s.oc(39,"translate"),s.Wb(),s.Xc(40,UE,2,1,"td",1),s.Xb(41,"td",0),s.Xc(42,GE,3,3,"span",2),s.Xc(43,FE,2,1,"ng-container",3),s.Xc(44,jE,1,0,"ng-template",null,4,s.Yc),s.Wb(),s.Wb(),s.Xb(46,"tr"),s.Xb(47,"td",0),s.Zc(48),s.oc(49,"translate"),s.Wb(),s.Xc(50,VE,2,1,"td",1),s.Xb(51,"td",0),s.Xc(52,YE,3,3,"span",2),s.Zc(53),s.oc(54,"translate"),s.Wb(),s.Wb(),s.Xb(55,"tr"),s.Xb(56,"td",0),s.Zc(57),s.oc(58,"translate"),s.Wb(),s.Xc(59,HE,3,3,"td",1),s.Xb(60,"td",0),s.Xc(61,$E,3,3,"span",2),s.Zc(62),s.oc(63,"translate"),s.Wb(),s.Wb(),s.Xb(64,"tr"),s.Xb(65,"td",0),s.Zc(66),s.oc(67,"translate"),s.Wb(),s.Xc(68,qE,2,1,"td",1),s.Xb(69,"td",0),s.Xc(70,zE,3,3,"span",2),s.Zc(71),s.oc(72,"translate"),s.Wb(),s.Wb(),s.Xc(73,tf,9,8,"tr",1),s.Xb(74,"tr"),s.Xb(75,"td",0),s.Zc(76),s.oc(77,"translate"),s.Wb(),s.Xc(78,nf,2,1,"td",1),s.Xb(79,"td",0),s.Xc(80,sf,3,3,"span",2),s.Zc(81),s.Wb(),s.Wb(),s.Xb(82,"tr"),s.Xb(83,"td",0),s.Zc(84),s.oc(85,"translate"),s.Wb(),s.Xc(86,af,2,1,"td",1),s.Xb(87,"td",0),s.Xc(88,of,3,3,"span",2),s.Zc(89),s.oc(90,"lowercase"),s.oc(91,"translate"),s.Wb(),s.Wb(),s.Xb(92,"tr"),s.Xb(93,"td",0),s.Zc(94),s.oc(95,"translate"),s.Wb(),s.Xc(96,rf,3,3,"td",1),s.Xb(97,"td",0),s.Xc(98,lf,3,3,"span",2),s.Zc(99),s.oc(100,"translate"),s.Wb(),s.Wb()),2&e){const e=s.Lc(45);s.Cb(2),s.ad(s.pc(3,46,"AUDIT_LOG.TABLE_COLUMNS.PROJECT.NAME")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.projectName)),s.Cb(1),s.bd(" ",null==t._log.content?null:t._log.content.projectName," "),s.Cb(3),s.ad(s.pc(11,48,"AUDIT_LOG.TABLE_COLUMNS.PROJECT.CLIENT")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.client)),s.Cb(1),s.bd(" ",null!=t._log.content&&t._log.content.client?null==t._log.content?null:t._log.content.client:"("+s.pc(16,50,s.pc(17,52,"GLOBAL.NO_CLIENT_LABEL"))+")"," "),s.Cb(5),s.ad(s.pc(21,54,"AUDIT_LOG.TABLE_COLUMNS.SHARED.STATUS")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.archived)),s.Cb(1),s.bd(" ","-"!==(null==t._log.content?null:t._log.content.archived)?s.pc(26,56,null==t._log.content?null:t._log.content.archived):null==t._log.content?null:t._log.content.archived," "),s.Cb(4),s.ad(s.pc(30,58,"AUDIT_LOG.TABLE_COLUMNS.PROJECT.VISIBILITY")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.visibility)),s.Cb(1),s.bd(" ",s.pc(35,60,null==t._log.content?null:t._log.content.visibility)," "),s.Cb(4),s.bd("",s.pc(39,62,"AUDIT_LOG.TABLE_COLUMNS.PROJECT.MEMBERS")," "),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&t.membersUpdated),s.Cb(1),s.wc("ngIf",t.action!==t.AuditLogAction.UPDATE||t.membersUpdated)("ngIfElse",e),s.Cb(5),s.bd("",s.pc(49,64,"AUDIT_LOG.TABLE_COLUMNS.PROJECT.NOTE")," "),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.note)),s.Cb(1),s.bd(" ",null!=t._log.content&&t._log.content.note?null==t._log.content?null:t._log.content.note:"("+s.pc(54,66,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_NOTE_LABEL")+")"," "),s.Cb(4),s.ad(s.pc(58,68,"AUDIT_LOG.TABLE_COLUMNS.PROJECT.BILLABLE_BY_DEFAULT")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.billableByDefault)),s.Cb(1),s.bd(" ","-"!==(null==t._log.content?null:t._log.content.billableByDefault)?s.pc(63,70,null!=t._log.content&&t._log.content.billableByDefault?"GLOBAL.TRUE_LABEL":"GLOBAL.FALSE_LABEL"):null==t._log.content?null:t._log.content.billableByDefault," "),s.Cb(4),s.ad(s.pc(67,72,"AUDIT_LOG.TABLE_COLUMNS.SHARED.BILLABLE_RATE")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.billableRate)),s.Cb(1),s.bd(" ",null!=t._log.content&&t._log.content.billableRate?null==t._log.content?null:t._log.content.billableRate:"("+s.pc(72,74,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_BILLABLE_RATE_LABEL")+")"," "),s.Cb(2),s.wc("ngIf",t.showCostRateRow),s.Cb(3),s.ad(s.pc(77,76,"AUDIT_LOG.TABLE_COLUMNS.PROJECT.ESTIMATE_TYPE")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.estimateType)),s.Cb(1),s.bd(" ",null==t._log.content?null:t._log.content.estimateTypeLabel," "),s.Cb(3),s.ad(s.pc(85,78,"AUDIT_LOG.TABLE_COLUMNS.SHARED.ESTIMATE")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.estimate)),s.Cb(1),s.bd(" ",null!=t._log.content&&t._log.content.estimate?null==t._log.content?null:t._log.content.estimate:"("+s.pc(90,80,s.pc(91,82,"PROJECTS.DROPDOWN.NO_ESTIMATE"))+")"," "),s.Cb(5),s.ad(s.pc(95,84,"AUDIT_LOG.TABLE_COLUMNS.PROJECT.RECURRING_ESTIMATE")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&(null==t._log.content?null:t._log.content.recurringEstimate)&&"-"!==(null==t._log.content?null:t._log.content.recurringEstimate)),s.Cb(1),s.bd(" ","-"!==(null==t._log.content?null:t._log.content.recurringEstimate)?s.pc(100,86,null!=t._log.content&&t._log.content.recurringEstimate?"GLOBAL.TRUE_LABEL":"GLOBAL.FALSE_LABEL"):null==t._log.content?null:t._log.content.recurringEstimate," ")}},directives:[i.u,i.t],pipes:[g.e,i.q],encapsulation:2}),e})();const df=["audit-log-task-details",""];function uf(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null==e._log.previousContent?null:e._log.previousContent.projectClientLabel," ")}}function pf(e,t){1&e&&(s.Xb(0,"span",2),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function hf(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null==e._log.previousContent?null:e._log.previousContent.taskName," ")}}function mf(e,t){1&e&&(s.Xb(0,"span",2),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function gf(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"lowercase"),s.oc(3,"translate"),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.estimate&&"0h"!==(null==e._log.previousContent?null:e._log.previousContent.estimate)?null==e._log.previousContent?null:e._log.previousContent.estimate:"("+s.pc(2,1,s.pc(3,3,"PROJECTS.DROPDOWN.NO_ESTIMATE"))+")"," ")}}function Ef(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,gf,4,5,"ng-container",0),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function ff(e,t){1&e&&(s.Xb(0,"span",2),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function Sf(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",e.prevAssigneesLabel," ")}}function Cf(e,t){1&e&&(s.Zc(0),s.oc(1,"translate")),2&e&&s.bd(" ",s.pc(1,1,"PROJECTS.PROJECTS_TABLE.ANYONE_LABEL")," ")}function Af(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,Sf,2,1,"ng-container",3),s.Xc(2,Cf,2,3,"ng-template",null,4,s.Yc),s.Wb()),2&e){const e=s.Lc(3),t=s.nc();s.Cb(1),s.wc("ngIf",t.prevAssigneesLabel)("ngIfElse",e)}}function Of(e,t){1&e&&(s.Xb(0,"span",2),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")))}function vf(e,t){1&e&&(s.Vb(0),s.Zc(1," - "),s.Ub())}function Tf(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",e.assigneesLabel," ")}}function If(e,t){1&e&&(s.Zc(0),s.oc(1,"translate")),2&e&&s.bd(" ",s.pc(1,1,"PROJECTS.PROJECTS_TABLE.ANYONE_LABEL")," ")}function wf(e,t){if(1&e&&(s.Vb(0),s.Xc(1,Tf,2,1,"ng-container",3),s.Xc(2,If,2,3,"ng-template",null,5,s.Yc),s.Ub()),2&e){const e=s.Lc(3),t=s.nc();s.Cb(1),s.wc("ngIf",t.assigneesLabel)("ngIfElse",e)}}function Lf(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.status?s.pc(2,1,null==e._log.previousContent?null:e._log.previousContent.status):null==e._log.previousContent?null:e._log.previousContent.status," ")}}function Rf(e,t){1&e&&(s.Xb(0,"span",2),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")))}function yf(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ","-"!==(null==e._log.previousContent?null:e._log.previousContent.billable)?s.pc(2,1,null!=e._log.previousContent&&e._log.previousContent.billable?"GLOBAL.TRUE_LABEL":"GLOBAL.FALSE_LABEL"):null==e._log.previousContent?null:e._log.previousContent.billable," ")}}function _f(e,t){1&e&&(s.Xb(0,"span",2),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")))}function kf(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.billableRate?null==e._log.previousContent?null:e._log.previousContent.billableRate:"("+s.pc(2,1,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_BILLABLE_RATE_LABEL")+")"," ")}}function Wf(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,kf,3,3,"ng-container",0),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function Xf(e,t){1&e&&(s.Xb(0,"span",2),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")))}function Nf(e,t){if(1&e&&(s.Xb(0,"tr"),s.Xb(1,"td"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,Wf,2,1,"td",0),s.Xb(5,"td"),s.Xc(6,Xf,3,3,"span",1),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,4,"AUDIT_LOG.TABLE_COLUMNS.SHARED.BILLABLE_RATE")),s.Cb(2),s.wc("ngIf",e.action===e.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!e.oldEntryUpdated&&e.action===e.AuditLogAction.UPDATE&&"-"!==(null==e._log.content?null:e._log.content.billableRate)),s.Cb(1),s.bd(" ",null!=e._log.content&&e._log.content.billableRate?null==e._log.content?null:e._log.content.billableRate:"("+s.pc(8,6,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_BILLABLE_RATE_LABEL")+")"," ")}}function Df(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.costRate?null==e._log.previousContent?null:e._log.previousContent.costRate:"("+s.pc(2,1,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_COST_RATE_LABEL")+")"," ")}}function Pf(e,t){if(1&e&&(s.Xb(0,"td"),s.Xc(1,Df,3,3,"ng-container",0),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",!e.oldEntryUpdated)}}function Mf(e,t){1&e&&(s.Xb(0,"span",2),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")))}function Bf(e,t){if(1&e&&(s.Xb(0,"tr"),s.Xb(1,"td"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,Pf,2,1,"td",0),s.Xb(5,"td"),s.Xc(6,Mf,3,3,"span",1),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,4,"AUDIT_LOG.TABLE_COLUMNS.SHARED.COST_RATE")),s.Cb(2),s.wc("ngIf",e.action===e.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!e.oldEntryUpdated&&e.action===e.AuditLogAction.UPDATE&&"-"!==(null==e._log.content?null:e._log.content.costRate)),s.Cb(1),s.bd(" ",null!=e._log.content&&e._log.content.costRate?null==e._log.content?null:e._log.content.costRate:"("+s.pc(8,6,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_COST_RATE_LABEL")+")"," ")}}const Uf=function(e){return{groupingLabelName:e}};var Gf=function(e){return e.ACTIVE="ACTIVE",e.DONE="DONE",e}({});let xf=(()=>{class e{constructor(e,t){this.auditLogService=e,this.translateService=t,this.AuditLogAction=Eo.d,this.assigneesUpdated=!1,this.projectGroupingLabels=new Map([[go.a.client,"GLOBAL.CLINENT_LABEL"],[go.a.department,"GLOBAL.DEPARTMENT_LABEL"],[go.a.category,"GLOBAL.CATEGORY_LABEL"]])}set log(e){this.action=this.auditLogService.setActionFlag(e.action),this._log=this.auditLogService.prepareLogData(e,this.action)}ngOnInit(){this.oldEntryUpdated=this.action===Eo.d.UPDATE&&null===this._log.previousContent,this.groupingLabelTranslation=this.projectGroupingLabel===go.a.client||this.projectGroupingLabel===go.a.department||this.projectGroupingLabel===go.a.category?this.translateService.instant(this.projectGroupingLabels.get(this.projectGroupingLabel)):this.projectGroupingLabel,this.setEstimate("content"),this.setEstimate("previousContent"),this.setRateRowVisibility(Eo.k.BILLABLE_RATE),this.setRate("content","billableRate"),this.setRate("previousContent","billableRate"),this.setRateRowVisibility(Eo.k.COST_RATE),this.setRate("content","costRate"),this.setRate("previousContent","costRate"),this.setStatus("content"),this.setStatus("previousContent"),this.setProjectClientLabel("content"),this.setProjectClientLabel("previousContent"),this.setAssignees(),this._log.previousContent&&Object.keys(this._log.previousContent).forEach(e=>{this._log.content[e]===this._log.previousContent[e]&&(this._log.content[e]="-")})}setRateRowVisibility(e){this._log.content&&null===this._log.previousContent?e===Eo.k.BILLABLE_RATE?this.showBillableRateRow=null!==this._log.content.billableRate:e===Eo.k.COST_RATE&&(this.showCostRateRow=null!==this._log.content.costRate):this._log.content&&this._log.previousContent&&(e===Eo.k.BILLABLE_RATE?this.showBillableRateRow=null!==this._log.content.billableRate||null!==this._log.previousContent.billableRate:e===Eo.k.COST_RATE&&(this.showCostRateRow=null!==this._log.content.costRate||null!==this._log.previousContent.costRate))}setRate(e,t){this._log[e]&&this._log[e][t]&&(this._log[e][t]=this._log[e][t]/100+" "+this._log[e].currency)}setStatus(e){this._log[e]&&(this._log[e].status=this._log[e].status===Gf.ACTIVE?"GLOBAL.ACTIVE_LABEL":"GLOBAL.DONE_LABEL")}setProjectClientLabel(e){let t=null,n=null;this._log[e]&&(t=this._log[e].projectName,n=this._log[e].clientName,this._log[e].projectClientLabel=(t||"")+(n&&t?"-":"")+(n||""))}setAssignees(){this._log.content&&(this.assigneesLabel=this.setAssigneesLabel("content")),this._log.previousContent&&(this.prevAssigneesLabel=this.setAssigneesLabel("previousContent")),this.assigneesUpdated=!(!this._log.content||!this._log.previousContent)&&this.assigneesLabel!==this.prevAssigneesLabel}setAssigneesLabel(e){let t="";if(this._log[e].assignees.length>0){const n=this._log[e].assignees.length;this._log[e].assignees.forEach((e,i)=>{t+=e+(i!==n-1?", ":"")})}else t=null;return t}setEstimate(e){if(this.translateService.instant("PROJECTS.SHARED.PER_MONTH_LABEL"),this._log[e]){let t,n;this._log[e].activeEstimate===Eo.b.TIME?(t=ke.duration(this._log[e].estimate).asHours().toString(),this._log[e].estimate=t,this._log[e].estimate+="h"):this._log[e].activeEstimate===Eo.b.BUDGET?(n=this._log[e].estimate/100,this._log[e].estimate=n.toString()+" "+this._log[e].currency):this._log[e].estimate=null}}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(kt.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["","audit-log-task-details",""]],inputs:{log:"log",projectGroupingLabel:"projectGroupingLabel"},attrs:df,decls:55,vars:50,consts:[[4,"ngIf"],["class","cl-badge-approve cl-badge-success no-wrap cl-text-white cl-mr-1",4,"ngIf"],[1,"cl-badge-approve","cl-badge-success","no-wrap","cl-text-white","cl-mr-1"],[4,"ngIf","ngIfElse"],["noPrevAssignees",""],["noAssignees",""]],template:function(e,t){1&e&&(s.Xb(0,"tr"),s.Xb(1,"td"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,uf,2,1,"td",0),s.Xb(5,"td"),s.Xc(6,pf,3,3,"span",1),s.Zc(7),s.Wb(),s.Wb(),s.Xb(8,"tr"),s.Xb(9,"td"),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Xc(12,hf,2,1,"td",0),s.Xb(13,"td"),s.Xc(14,mf,3,3,"span",1),s.Zc(15),s.Wb(),s.Wb(),s.Xb(16,"tr"),s.Xb(17,"td"),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Xc(20,Ef,2,1,"td",0),s.Xb(21,"td"),s.Xc(22,ff,3,3,"span",1),s.Zc(23),s.oc(24,"lowercase"),s.oc(25,"translate"),s.Wb(),s.Wb(),s.Xb(26,"tr"),s.Xb(27,"td"),s.Zc(28),s.oc(29,"translate"),s.Wb(),s.Xc(30,Af,4,2,"td",0),s.Xb(31,"td"),s.Xc(32,Of,3,3,"span",1),s.Xc(33,vf,2,0,"ng-container",0),s.Xc(34,wf,4,2,"ng-container",0),s.Wb(),s.Wb(),s.Xb(35,"tr"),s.Xb(36,"td"),s.Zc(37),s.oc(38,"translate"),s.Wb(),s.Xc(39,Lf,3,3,"td",0),s.Xb(40,"td"),s.Xc(41,Rf,3,3,"span",1),s.Zc(42),s.oc(43,"translate"),s.Wb(),s.Wb(),s.Xb(44,"tr"),s.Xb(45,"td"),s.Zc(46),s.oc(47,"translate"),s.Wb(),s.Xc(48,yf,3,3,"td",0),s.Xb(49,"td"),s.Xc(50,_f,3,3,"span",1),s.Zc(51),s.oc(52,"translate"),s.Wb(),s.Wb(),s.Xc(53,Nf,9,8,"tr",0),s.Xc(54,Bf,9,8,"tr",0)),2&e&&(s.Cb(2),s.ad(s.qc(3,27,"AUDIT_LOG.TABLE_COLUMNS.TASK.PROJECT",s.Bc(48,Uf,t.groupingLabelTranslation))),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.projectClientLabel)),s.Cb(1),s.bd(" ",null==t._log.content?null:t._log.content.projectClientLabel," "),s.Cb(3),s.ad(s.pc(11,30,"AUDIT_LOG.TABLE_COLUMNS.TASK.NAME")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.taskName)),s.Cb(1),s.bd(" ",null==t._log.content?null:t._log.content.taskName," "),s.Cb(3),s.ad(s.pc(19,32,"AUDIT_LOG.TABLE_COLUMNS.SHARED.ESTIMATE")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.estimate)),s.Cb(1),s.bd(" ",null!=t._log.content&&t._log.content.estimate&&"0h"!==t._log.content.estimate?null==t._log.content?null:t._log.content.estimate:"("+s.pc(24,34,s.pc(25,36,"PROJECTS.DROPDOWN.NO_ESTIMATE"))+")"," "),s.Cb(5),s.ad(s.pc(29,38,"AUDIT_LOG.TABLE_COLUMNS.TASK.ASSIGNEE")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&t.assigneesUpdated),s.Cb(1),s.wc("ngIf",t.assigneesLabel===t.prevAssigneesLabel),s.Cb(1),s.wc("ngIf",t.assigneesLabel!==t.prevAssigneesLabel),s.Cb(3),s.ad(s.pc(38,40,"AUDIT_LOG.TABLE_COLUMNS.SHARED.STATUS")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.status)),s.Cb(1),s.bd(" ","-"!==(null==t._log.content?null:t._log.content.status)?s.pc(43,42,null==t._log.content?null:t._log.content.status):null==t._log.content?null:t._log.content.status," "),s.Cb(4),s.ad(s.pc(47,44,"AUDIT_LOG.TABLE_COLUMNS.SHARED.BILLABLE")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.billable)),s.Cb(1),s.bd(" ","-"!==(null==t._log.content?null:t._log.content.billable)?s.pc(52,46,null!=t._log.content&&t._log.content.billable?"GLOBAL.TRUE_LABEL":"GLOBAL.FALSE_LABEL"):null==t._log.content?null:t._log.content.billable," "),s.Cb(2),s.wc("ngIf",t.showBillableRateRow),s.Cb(1),s.wc("ngIf",t.showCostRateRow))},directives:[i.u],pipes:[g.e,i.q],encapsulation:2}),e})();const Ff=["audit-log-client-details",""];function jf(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.pc(2,1,e.projectGroupingLabels.get(e.projectGroupingLabel))," ")}}function Zf(e,t){if(1&e&&s.Zc(0),2&e){const e=s.nc();s.bd(" ",e.projectGroupingLabel," ")}}function Vf(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null==e._log.previousContent?null:e._log.previousContent.clientName," ")}}function Yf(e,t){1&e&&(s.Xb(0,"span",5),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")))}function Hf(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.address?null==e._log.previousContent?null:e._log.previousContent.address:"("+s.pc(2,1,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_ADDRESS_LABEL")+")"," ")}}function $f(e,t){1&e&&(s.Xb(0,"span",5),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")))}function Kf(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.archived?s.pc(2,1,null==e._log.previousContent?null:e._log.previousContent.archived):"","")}}function qf(e,t){1&e&&(s.Xb(0,"span",5),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")))}let zf=(()=>{class e{constructor(e){this.auditLogService=e,this.AuditLogAction=Eo.d,this.projectGroupingLabels=new Map([[go.a.client,"AUDIT_LOG.TABLE_COLUMNS.CLIENT.NAME"],[go.a.department,"AUDIT_LOG.TABLE_COLUMNS.CLIENT.DEPARTMENT"],[go.a.category,"AUDIT_LOG.TABLE_COLUMNS.CLIENT.CATEGORY"]])}set log(e){this.action=this.auditLogService.setActionFlag(e.action),this._log=this.auditLogService.prepareLogData(e,this.action)}ngOnInit(){var e,t,n,i;this.oldEntryUpdated=this.action===Eo.d.UPDATE&&null===this._log.previousContent,this.setArchived("content"),this.setArchived("previousContent"),this._log.content&&(this._log.content.address=(null===(e=this._log.content)||void 0===e?void 0:e.address)?null===(t=this._log.content)||void 0===t?void 0:t.address:null),this._log.previousContent&&(this._log.previousContent.address=(null===(n=this._log.previousContent)||void 0===n?void 0:n.address)?null===(i=this._log.previousContent)||void 0===i?void 0:i.address:null,Object.keys(this._log.previousContent).forEach(e=>{this._log.content[e]===this._log.previousContent[e]&&(this._log.content[e]="-")}))}setArchived(e){this._log[e]&&(this._log[e].archived=this._log[e].archived?"GLOBAL.ARCHIVED_LABEL":"GLOBAL.ACTIVE_LABEL")}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(kt.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["","audit-log-client-details",""]],inputs:{log:"log",projectGroupingLabel:"projectGroupingLabel"},attrs:Ff,decls:27,vars:21,consts:[[1,"cl-pl-3"],[4,"ngIf","ngIfElse"],["customProjectLabel",""],[4,"ngIf"],["class","cl-badge-approve cl-badge-success nowrap cl-text-white cl-mr-1",4,"ngIf"],[1,"cl-badge-approve","cl-badge-success","nowrap","cl-text-white","cl-mr-1"]],template:function(e,t){if(1&e&&(s.Xb(0,"tr"),s.Xb(1,"td",0),s.Xc(2,jf,3,3,"ng-container",1),s.Xc(3,Zf,1,1,"ng-template",null,2,s.Yc),s.Wb(),s.Xc(5,Vf,2,1,"td",3),s.Xb(6,"td",0),s.Xc(7,Yf,3,3,"span",4),s.Zc(8),s.Wb(),s.Wb(),s.Xb(9,"tr"),s.Xb(10,"td",0),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xc(13,Hf,3,3,"td",3),s.Xb(14,"td",0),s.Xc(15,$f,3,3,"span",4),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Wb(),s.Xb(18,"tr"),s.Xb(19,"td",0),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Xc(22,Kf,3,3,"td",3),s.Xb(23,"td",0),s.Xc(24,qf,3,3,"span",4),s.Zc(25),s.oc(26,"translate"),s.Wb(),s.Wb()),2&e){const e=s.Lc(4);s.Cb(2),s.wc("ngIf","client"===t.projectGroupingLabel||"department"===t.projectGroupingLabel||"category"===t.projectGroupingLabel)("ngIfElse",e),s.Cb(3),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.clientName)),s.Cb(1),s.bd(" ",null==t._log.content?null:t._log.content.clientName," "),s.Cb(3),s.ad(s.pc(12,13,"AUDIT_LOG.TABLE_COLUMNS.CLIENT.ADDRESS")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.address)),s.Cb(1),s.bd(" ",null!=t._log.content&&t._log.content.address?null==t._log.content?null:t._log.content.address:"("+s.pc(17,15,"AUDIT_LOG.TABLE_COLUMNS.SHARED.NO_ADDRESS_LABEL")+")"," "),s.Cb(4),s.ad(s.pc(21,17,"AUDIT_LOG.TABLE_COLUMNS.SHARED.STATUS")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.archived)),s.Cb(1),s.bd(" ","-"!==(null==t._log.content?null:t._log.content.archived)?s.pc(26,19,null==t._log.content?null:t._log.content.archived):null==t._log.content?null:t._log.content.archived,"")}},directives:[i.u],pipes:[g.e],encapsulation:2}),e})();const Qf=["audit-log-tag-details",""];function Jf(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null==e._log.previousContent?null:e._log.previousContent.tagName," ")}}function eS(e,t){1&e&&(s.Xb(0,"span",2),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}function tS(e,t){if(1&e&&(s.Xb(0,"td"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null!=e._log.previousContent&&e._log.previousContent.archived?s.pc(2,1,null==e._log.previousContent?null:e._log.previousContent.archived):null==e._log.previousContent?null:e._log.previousContent.archived," ")}}function nS(e,t){1&e&&(s.Xb(0,"span",2),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"AUDIT_LOG.OPERATIONS.UPDATE_LABEL")," "))}let iS=(()=>{class e{constructor(e){this.auditLogService=e,this.AuditLogAction=Eo.d}set log(e){e&&(this.action=this.auditLogService.setActionFlag(e.action),this._log=this.auditLogService.prepareLogData(e,this.action),this.oldEntryUpdated=this.action===Eo.d.UPDATE&&null===this._log.previousContent)}ngOnInit(){this.setArchived("content"),this.setArchived("previousContent"),this._log.previousContent&&Object.keys(this._log.previousContent).forEach(e=>{this._log.content[e]===this._log.previousContent[e]&&(this._log.content[e]="-")})}setArchived(e){this._log[e]&&(this._log[e].archived=this._log[e].archived?"GLOBAL.ARCHIVED_LABEL":"GLOBAL.ACTIVE_LABEL")}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(kt.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["","audit-log-tag-details",""]],inputs:{log:"log"},attrs:Qf,decls:17,vars:14,consts:[[4,"ngIf"],["class","cl-badge-approve cl-badge-success no-wrap cl-text-white cl-mr-1",4,"ngIf"],[1,"cl-badge-approve","cl-badge-success","no-wrap","cl-text-white","cl-mr-1"]],template:function(e,t){1&e&&(s.Xb(0,"tr"),s.Xb(1,"td"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,Jf,2,1,"td",0),s.Xb(5,"td"),s.Xc(6,eS,3,3,"span",1),s.Zc(7),s.Wb(),s.Wb(),s.Xb(8,"tr"),s.Xb(9,"td"),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Xc(12,tS,3,3,"td",0),s.Xb(13,"td"),s.Xc(14,nS,3,3,"span",1),s.Zc(15),s.oc(16,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,8,"AUDIT_LOG.TABLE_COLUMNS.TAG.NAME")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&t.action===t.AuditLogAction.UPDATE&&"-"!==(null==t._log.content?null:t._log.content.tagName)),s.Cb(1),s.bd(" ",null==t._log.content?null:t._log.content.tagName," "),s.Cb(3),s.ad(s.pc(11,10,"AUDIT_LOG.TABLE_COLUMNS.SHARED.STATUS")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(2),s.wc("ngIf",!t.oldEntryUpdated&&"-"!==t._log.content.archived&&t.action===t.AuditLogAction.UPDATE),s.Cb(1),s.bd(" ","-"!==t._log.content.archived?s.pc(16,12,t._log.content.archived):t._log.content.archived," "))},directives:[i.u],pipes:[g.e],encapsulation:2}),e})();const sS=["audit-log-table-details-row",""];function cS(e,t){1&e&&(s.Xb(0,"span",11),s.Zc(1),s.oc(2,"translate"),s.Xb(3,"a",12),s.Sb(4,"img",13),s.Wb(),s.Wb()),2&e&&(s.Cb(1),s.bd(" (",s.pc(2,1,"GLOBAL.NO_PRIOR_HISTORY_LABEL"),") "))}function aS(e,t){if(1&e&&(s.Xb(0,"th"),s.Xb(1,"div",3),s.Zc(2),s.oc(3,"translate"),s.Xc(4,cS,5,3,"span",10),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.bd(" ",s.pc(3,2,"GLOBAL.PREVIOUS_VALUE_LABEL")," "),s.Cb(2),s.wc("ngIf",e.oldEntryUpdated)}}function oS(e,t){if(1&e&&s.Sb(0,"tbody",14),2&e){const e=s.nc();s.wc("log",e.logEntry)("durationFormat",e.timeFormat)("projectGroupingLabel",e.workspace.projectGroupingLabel)("workspace",e.workspace)}}function rS(e,t){if(1&e&&s.Sb(0,"tbody",15),2&e){const e=s.nc();s.wc("log",e.logEntry)("workspace",e.workspace)}}function lS(e,t){if(1&e&&s.Sb(0,"tbody",16),2&e){const e=s.nc();s.wc("projectGroupingLabel",e.workspace.projectGroupingLabel)("log",e.logEntry)}}function bS(e,t){if(1&e&&s.Sb(0,"tbody",17),2&e){const e=s.nc();s.wc("projectGroupingLabel",e.workspace.projectGroupingLabel)("log",e.logEntry)}}function dS(e,t){if(1&e&&s.Sb(0,"tbody",18),2&e){const e=s.nc();s.wc("log",e.logEntry)}}let uS=(()=>{class e{constructor(e,t){this.auditLogTableService=e,this.auditLogService=t,this.expand=!1,this.AuditLogAction=Eo.d,this._ngUnsubscribe$=new p.a}get isExpanded(){return!this.expand}set logEntry(e){this._logEntry=e,this.action=this.auditLogService.setActionFlag(this._logEntry.action),this.oldEntryUpdated=this.action===Eo.d.UPDATE&&!this._logEntry.previousContent}get logEntry(){return this._logEntry}set expandAll(e){this.expand=e}ngOnInit(){this.auditLogTableService.expandRow.pipe(Object(Pe.a)(this._ngUnsubscribe$)).subscribe(e=>{e.id===this.rowIndex&&(this.expand=e.expand)}),this.timeFormat=this.workspace.getTimeFormat()}isTimeEntry(e){return Sg.value.map(e=>e.entity.id).indexOf(e)>=0}isProject(e){return gg.value.map(e=>e.entity.id).indexOf(e)>=0}isTask(e){return fg.value.map(e=>e.entity.id).indexOf(e)>=0}isClient(e){return yg.value.map(e=>e.entity.id).indexOf(e)>=0}isTag(e){return Eg.value.map(e=>e.entity.id).indexOf(e)>=0}ngOnDestroy(){this._ngUnsubscribe$.next(),this._ngUnsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(_t),s.Rb(kt.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["","audit-log-table-details-row",""]],hostVars:2,hostBindings:function(e,t){2&e&&s.Hb("cl-d-none",t.isExpanded)},inputs:{logEntry:"logEntry",expandAll:"expandAll",rowIndex:"rowIndex",workspace:"workspace"},attrs:sS,decls:18,vars:12,consts:[["colspan","3",1,"cl-w-100","cl-border-top-0","cl-p-0"],[1,"cl-w-100","cl-bg-light-grey","log-details-table"],[1,"calendar-header-background-color"],[1,"cl-h5","cl-text-font-weight-500","cl-text-gray-6","cl-mb-0","cl-ml-2","cl-transform-none"],[4,"ngIf"],["audit-log-time-entry-details","",3,"log","durationFormat","projectGroupingLabel","workspace",4,"ngIf"],["audit-log-project-details","",3,"log","workspace",4,"ngIf"],["audit-log-task-details","",3,"projectGroupingLabel","log",4,"ngIf"],["audit-log-client-details","",3,"projectGroupingLabel","log",4,"ngIf"],["audit-log-tag-details","",3,"log",4,"ngIf"],["class","cl-d-inline-flex cl-flex-row cl-align-center cl-text-gray-9 cl-font-weight-normal",4,"ngIf"],[1,"cl-d-inline-flex","cl-flex-row","cl-align-center","cl-text-gray-9","cl-font-weight-normal"],["href","https://clockify.me/help/extra-features/audit-log","target","_blank",1,"cl-d-inline-flex","cl-flex-row","cl-align-center","cl-ml-1"],["src","assets/images/ui-icons/info-9.svg"],["audit-log-time-entry-details","",3,"log","durationFormat","projectGroupingLabel","workspace"],["audit-log-project-details","",3,"log","workspace"],["audit-log-task-details","",3,"projectGroupingLabel","log"],["audit-log-client-details","",3,"projectGroupingLabel","log"],["audit-log-tag-details","",3,"log"]],template:function(e,t){1&e&&(s.Xb(0,"td",0),s.Xb(1,"table",1),s.Xb(2,"thead",2),s.Xb(3,"tr"),s.Xb(4,"th"),s.Xb(5,"div",3),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xc(8,aS,5,4,"th",4),s.Xb(9,"th"),s.Xb(10,"div",3),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(13,oS,1,4,"tbody",5),s.Xc(14,rS,1,2,"tbody",6),s.Xc(15,lS,1,2,"tbody",7),s.Xc(16,bS,1,2,"tbody",8),s.Xc(17,dS,1,1,"tbody",9),s.Wb(),s.Wb()),2&e&&(s.Cb(6),s.ad(s.pc(7,8,"GLOBAL.PROPERTY_LABEL")),s.Cb(2),s.wc("ngIf",t.action===t.AuditLogAction.UPDATE),s.Cb(3),s.bd(" ",s.pc(12,10,t.action===t.AuditLogAction.UPDATE?"GLOBAL.NEW_VALUE_LABEL":"SHARED_MODULES.CUSTOM_FIELD.VALUE_LABEL"),""),s.Cb(2),s.wc("ngIf",t.isTimeEntry(t.logEntry.action)),s.Cb(1),s.wc("ngIf",t.isProject(t.logEntry.action)),s.Cb(1),s.wc("ngIf",t.isTask(t.logEntry.action)),s.Cb(1),s.wc("ngIf",t.isClient(t.logEntry.action)),s.Cb(1),s.wc("ngIf",t.isTag(t.logEntry.action)))},directives:[i.u,IE,bf,xf,zf,iS],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function pS(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"div",4),s.Sb(2,"tr",5),s.Wb(),s.Sb(3,"tr",6),s.Ub()),2&e){const e=t.$implicit,n=t.index,i=s.nc();s.Cb(2),s.wc("availableActions",i.AVAILABLE_ACTIONS)("logEntry",e)("expandAll",i.isExpandAll)("rowIndex",n),s.Cb(1),s.wc("workspace",i.workspace)("logEntry",e)("expandAll",i.isExpandAll)("rowIndex",n)}}function hS(e,t){if(1&e){const e=s.Yb();s.Xb(0,"pager",7),s.jc("pageChanged",(function(t){return s.Oc(e),s.nc().onPageChanged(t)}))("limitChanged",(function(t){return s.Oc(e),s.nc().onLimitChanged(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("page",e.pagination.page)("limit",e.pagination.limit)("total",e.pagination.total)("pageSizes",e.pageSizes)}}let mS=(()=>{class e{constructor(e,t,n,i,c){this.cd=e,this.auditLogTableService=t,this.auditLogService=n,this.translate=i,this.workspaceService=c,this.paginationUpdated=new s.n,this.showPagination=!0,this.AuditLogAction=Eo.d,this.pageSizes=[10,20,50],this._ngUnsubscribe$=new p.a}set paginationData(e){e&&(this.pagination=Object.assign({},e))}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace();const e=new Map(Sg.value.map(e=>[e.entity.id,this.translate.instant(e.entity.labelTranslationKey)])),t=new Map(gg.value.map(e=>[e.entity.id,this.translate.instant(e.entity.labelTranslationKey)])),n=new Map(fg.value.map(e=>[e.entity.id,this.translate.instant(e.entity.labelTranslationKey)])),i=this.auditLogService.setProjectGroupingLabelTranslations(this.workspace.projectGroupingLabel),s=new Map(Eg.value.map(e=>[e.entity.id,this.translate.instant(e.entity.labelTranslationKey)]));this.AVAILABLE_ACTIONS=new Map([...e,...t,...n,...i,...s]),this.auditLogTableService.expandAllRows.pipe(Object(Pe.a)(this._ngUnsubscribe$)).subscribe(e=>{this.isExpandAll=e,this.cd.detectChanges()})}onPageChanged(e){this.pagination.page=e.page||this.pagination.page,this.pagination.limit=e.limit||this.pagination.limit,this.paginationUpdated.emit(this.pagination)}onLimitChanged(e){this.pagination.page=1,this.pagination.limit=e.limit||this.pagination.limit,this.paginationUpdated.emit(this.pagination)}ngOnDestroy(){this._ngUnsubscribe$.next(),this._ngUnsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.h),s.Rb(_t),s.Rb(kt.a),s.Rb(g.f),s.Rb(l.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["audit-log-table"]],inputs:{logs:"logs",paginationData:"paginationData"},outputs:{paginationUpdated:"paginationUpdated"},decls:6,vars:2,consts:[[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6","cl-mb-3","cl-audit-log-table"],["audit-log-table-header",""],[4,"ngFor","ngForOf"],[3,"page","limit","total","pageSizes","pageChanged","limitChanged",4,"ngIf"],[1,"cl-row-hover-shadow"],["audit-log-table-row","",3,"availableActions","logEntry","expandAll","rowIndex"],["audit-log-table-details-row","",3,"workspace","logEntry","expandAll","rowIndex"],[3,"page","limit","total","pageSizes","pageChanged","limitChanged"]],template:function(e,t){1&e&&(s.Xb(0,"table",0),s.Xb(1,"thead"),s.Sb(2,"tr",1),s.Wb(),s.Xb(3,"tbody"),s.Xc(4,pS,4,8,"ng-container",2),s.Wb(),s.Wb(),s.Xc(5,hS,1,4,"pager",3)),2&e&&(s.Cb(4),s.wc("ngForOf",t.logs),s.Cb(1),s.wc("ngIf",(null==t.pagination?null:t.pagination.page)&&(null==t.pagination?null:t.pagination.limit)&&(null==t.pagination?null:t.pagination.total)))},directives:[wg,i.t,i.u,Rg,uS,Pi.a],encapsulation:2,changeDetection:0}),e})(),gS=(()=>{class e{constructor(){this.startExport=new s.n,this.close=new s.n}ngOnInit(){}confirmExport(){this.startExport.emit()}closeModal(){this.close.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["audit-log-export-prompt"]],outputs:{startExport:"startExport",close:"close"},decls:18,vars:12,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["ngbAutofocus","","type","button",1,"cl-close","cl-no-outline",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-text-color"],[1,"cl-modal-footer"],[3,"click"],[1,"cl-btn","cl-btn-primary",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.closeModal()})),s.Xb(5,"span",3),s.Sb(6,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",5),s.Xb(8,"div",6),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Xb(11,"div",7),s.Xb(12,"a",8),s.jc("click",(function(){return t.closeModal()})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Xb(15,"button",9),s.jc("click",(function(){return t.confirmExport()})),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,4,"AUDIT_LOG.EXPORT_PROMPT.TITLE")),s.Cb(7),s.bd(" ",s.pc(10,6,"AUDIT_LOG.EXPORT_PROMPT.NOTIFICATION")," "),s.Cb(4),s.ad(s.pc(14,8,"GLOBAL.CANCEL_BTN")),s.Cb(3),s.ad(s.pc(17,10,"AUDIT_LOG.EXPORT_PROMPT.START_EXPORT_BTN")))},pipes:[g.e],encapsulation:2}),e})();function ES(e,t){if(1&e){const e=s.Yb();s.Xb(0,"delete-confirm-modal",11),s.jc("onClose",(function(){return t.$implicit.close()}))("onDelete",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return n.close(),i.discardExport()})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",12),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb()}2&e&&(s.wc("title",s.pc(1,4,"GLOBAL.DISCARD_BTN"))("btnText",s.pc(2,6,"GLOBAL.CONFIRM_LABEL"))("showConfirmation",!1),s.Cb(4),s.bd(" ",s.pc(5,8,"AUDIT_LOG.DISCARD.WARNING")," "))}const fS=function(e,t){return{rows:e,count:t}},SS=function(e){return{value:e}};let CS=(()=>{class e{constructor(e,t,n){this.authService=e,this.auditLogService=t,this.modalService=n,this.sendToEmail=new s.n,this.exportComplete=new s.n,this.close=new s.n}set query(e){e&&(this._query={actions:e.actions,from:e.from,to:e.to,exclude:e.users.exclude,userIds:e.users.userIds})}ngOnInit(){this.activeUser=this.authService.getUser(),this.auditLogService.startExport(this._query).subscribe(e=>{this.numberOfExportedRows=e.numOfExportedRows,this.exportTaskId=e.exportTaskId,this.auditLogService.configurePolling(e.exportTaskId),this.startPolling()})}startPolling(){this.auditLogService.pollingTimer.subscribe(e=>{(null==e?void 0:e.csvFileId)&&(this.auditLogService.stopPolling(),this.downloadFile(e.csvFileId),this.exportComplete.emit({fileId:e.csvFileId}))})}downloadFile(e){this.auditLogService.downloadExportedFile(e).subscribe(e=>{const t=new Blob([e.body],{type:"application/csv"}),n=e.headers.get("content-disposition").split(";")[1].split("filename")[1].split("=")[1].trim().replace(/^"|"$/g,"");Object($n.b)(t,n)})}openConfirmDiscardModal(e){this.deleteModalRef=this.modalService.open(e,{centered:!0,backdrop:!1})}openDownloadCompleteModal(){this.exportComplete.next()}discardExport(){this.auditLogService.stopPolling(),this.auditLogService.cancelExport(this.exportTaskId).subscribe(()=>{this.close.emit()})}sendToMail(){this.sendToEmail.emit(this.exportTaskId)}ngOnDestroy(){this.deleteModalRef&&this.deleteModalRef.close(),this.auditLogService.stopPolling()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(re.a),s.Rb(kt.a),s.Rb(w.q))},e.\u0275cmp=s.Lb({type:e,selectors:[["audit-log-export"]],inputs:{query:"query"},outputs:{sendToEmail:"sendToEmail",exportComplete:"exportComplete",close:"close"},decls:20,vars:19,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["ngbAutofocus","","type","button",1,"cl-close","cl-no-outline",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-text-color"],[1,"cl-modal-footer"],[3,"click"],[1,"cl-btn","cl-btn-primary",3,"click"],["discardModal",""],[3,"title","btnText","showConfirmation","onClose","onDelete"],[1,"cl-text-muted","cl-mb-0"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){s.Oc(e);const n=s.Lc(19);return t.openConfirmDiscardModal(n)})),s.Xb(5,"span",3),s.Sb(6,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",5),s.Xb(8,"div",6),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Xb(11,"div",7),s.Xb(12,"a",8),s.jc("click",(function(){s.Oc(e);const n=s.Lc(19);return t.openConfirmDiscardModal(n)})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Xb(15,"button",9),s.jc("click",(function(){return t.sendToMail()})),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Wb(),s.Xc(18,ES,6,10,"ng-template",null,10,s.Yc)}2&e&&(s.Cb(2),s.ad(s.pc(3,4,"AUDIT_LOG.EXPORT.TITLE")),s.Cb(7),s.ad(s.qc(10,6,"AUDIT_LOG.EXPORT.NOTIFICATION",s.Cc(14,fS,t.numberOfExportedRows,t.numberOfExportedRows))),s.Cb(4),s.ad(s.pc(14,9,"GLOBAL.DISCARD_BTN")),s.Cb(3),s.ad(s.qc(17,11,"GLOBAL.SEND_TO_PARAM",s.Bc(17,SS,t.activeUser.email))))},directives:[Xd.a],pipes:[g.e],encapsulation:2}),e})();function AS(e,t){if(1&e){const e=s.Yb();s.Xb(0,"delete-confirm-modal",11),s.jc("onClose",(function(){return t.$implicit.close()}))("onDelete",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return n.close(),i.discardExport()})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",12),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb()}2&e&&(s.wc("title",s.pc(1,4,"GLOBAL.DISCARD_BTN"))("btnText",s.pc(2,6,"GLOBAL.CONFIRM_LABEL"))("showConfirmation",!1),s.Cb(4),s.bd(" ",s.pc(5,8,"AUDIT_LOG.DISCARD.WARNING")," "))}const OS=function(e){return{email:e}},vS=function(e){return{value:e}};let TS=(()=>{class e{constructor(e,t,n){this.auditLogService=e,this.authService=t,this.modalService=n,this.close=new s.n,this.exportComplete=new s.n}ngOnInit(){this.activeUser=this.authService.getUser(),this.auditLogService.sendExportToEmail(this.exportTaskId).subscribe(()=>{this.startPolling()})}startPolling(){this.auditLogService.pollingTimer.subscribe(e=>{(null==e?void 0:e.csvFileId)&&(this.auditLogService.stopPolling(),this.downloadFile(e.csvFileId),this.exportComplete.emit())})}downloadFile(e){this.auditLogService.downloadExportedFile(e).subscribe(e=>{const t=new Blob([e.body],{type:"application/csv"}),n=e.headers.get("content-disposition").split(";")[1].split("filename")[1].split("=")[1].trim().replace(/^"|"$/g,"");Object($n.b)(t,n)})}openConfirmDiscardModal(e){this.deleteModalRef=this.modalService.open(e,{centered:!0,backdrop:!1})}discardExport(){this.auditLogService.stopPolling(),this.auditLogService.cancelExport(this.exportTaskId).subscribe(()=>{this.close.emit()})}closeModal(){this.close.emit()}ngOnDestroy(){this.deleteModalRef&&this.deleteModalRef.close(),this.auditLogService.stopPolling()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(kt.a),s.Rb(re.a),s.Rb(w.q))},e.\u0275cmp=s.Lb({type:e,selectors:[["audit-log-send-to-email"]],inputs:{query:"query",exportTaskId:"exportTaskId"},outputs:{close:"close",exportComplete:"exportComplete"},decls:20,vars:18,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["ngbAutofocus","","type","button",1,"cl-close","cl-no-outline",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-text-color"],[1,"cl-modal-footer"],[3,"click"],[1,"cl-btn","cl-btn-primary",3,"click"],["discardModal",""],[3,"title","btnText","showConfirmation","onClose","onDelete"],[1,"cl-text-muted","cl-mb-0"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){s.Oc(e);const n=s.Lc(19);return t.openConfirmDiscardModal(n)})),s.Xb(5,"span",3),s.Sb(6,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",5),s.Xb(8,"div",6),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Xb(11,"div",7),s.Xb(12,"a",8),s.jc("click",(function(){s.Oc(e);const n=s.Lc(19);return t.openConfirmDiscardModal(n)})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Xb(15,"button",9),s.jc("click",(function(){return t.closeModal()})),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Wb(),s.Xc(18,AS,6,10,"ng-template",null,10,s.Yc)}2&e&&(s.Cb(2),s.ad(s.pc(3,4,"AUDIT_LOG.EXPORT.TITLE")),s.Cb(7),s.ad(s.qc(10,6,"AUDIT_LOG.EXPORT.EXPORT_TO_EMAIL_NOTIFICATION",s.Bc(14,OS,t.activeUser.email))),s.Cb(4),s.ad(s.pc(14,9,"GLOBAL.DISCARD_BTN")),s.Cb(3),s.ad(s.qc(17,11,"GLOBAL.CLOSE_BTN",s.Bc(16,vS,t.activeUser.email))))},directives:[Xd.a],pipes:[g.e],encapsulation:2}),e})(),IS=(()=>{class e{constructor(e){this.auditLogService=e,this.close=new s.n}ngOnInit(){}downloadAgain(){this.downloadFile(this.fileId)}downloadFile(e){this.auditLogService.downloadExportedFile(e).subscribe(e=>{const t=new Blob([e.body],{type:"application/csv"}),n=e.headers.get("content-disposition").split(";")[1].split("filename")[1].split("=")[1].trim().replace(/^"|"$/g,"");Object($n.b)(t,n)})}closeModal(){this.close.emit()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(kt.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["audit-log-export-complete"]],inputs:{fileId:"fileId"},outputs:{close:"close"},decls:18,vars:12,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["ngbAutofocus","","type","button",1,"cl-close","cl-no-outline",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-text-color"],[3,"click"],[1,"cl-modal-footer"],[1,"cl-btn","cl-btn-primary",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.closeModal()})),s.Xb(5,"span",3),s.Sb(6,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",5),s.Xb(8,"div",6),s.Zc(9),s.oc(10,"translate"),s.Xb(11,"a",7),s.jc("click",(function(){return t.downloadAgain()})),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(14,"div",8),s.Xb(15,"button",9),s.jc("click",(function(){return t.closeModal()})),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,4,"AUDIT_LOG.EXPORT_COMPLETE.TITLE")),s.Cb(7),s.bd("",s.pc(10,6,"AUDIT_LOG.EXPORT_COMPLETE.NOTIFICATION_PART1")," "),s.Cb(3),s.ad(s.pc(13,8,"AUDIT_LOG.EXPORT_COMPLETE.NOTIFICATION_PART2")),s.Cb(4),s.bd(" ",s.pc(17,10,"GLOBAL.CLOSE_BTN")," "))},pipes:[g.e],encapsulation:2}),e})();function wS(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",8),s.Xb(1,"div",9),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",10),s.jc("click",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(5);return t.showModal(n)})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,2,"AUDIT_LOG.AUDIT_LOG_LABEL")," "),s.Cb(3),s.bd(" ",s.pc(6,4,"AUDIT_LOG.EXPORT_BTN")," "))}function LS(e,t){if(1&e){const e=s.Yb();s.Xb(0,"audit-log-table",11),s.jc("paginationUpdated",(function(t){return s.Oc(e),s.nc().onPaginationUpdated(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("logs",e.logs)("paginationData",e.paginationData)}}function RS(e,t){if(1&e&&(s.Sb(0,"message-entries",12),s.oc(1,"translate"),s.oc(2,"translate")),2&e){const e=s.nc();s.wc("title",s.pc(1,3,e.notificationTitle))("subtitle",s.pc(2,5,e.notificationSubtitle))("imagePath","assets/images/no_audit_logs_illustration.svg")}}function yS(e,t){if(1&e){const e=s.Yb();s.Xb(0,"audit-log-export-prompt",13),s.jc("startExport",(function(){s.Oc(e);const n=t.$implicit,i=s.nc(),c=s.Lc(7);return i.showModal(c),n.close()}))("close",(function(){return t.$implicit.close()})),s.Wb()}}function _S(e,t){if(1&e){const e=s.Yb();s.Xb(0,"audit-log-export",14),s.jc("sendToEmail",(function(n){s.Oc(e);const i=t.$implicit,c=s.nc(),a=s.Lc(9);return c.showSendToEmailModal(a,n),i.close()}))("exportComplete",(function(n){s.Oc(e);const i=t.$implicit,c=s.nc(),a=s.Lc(11);return c.setFileId(n),c.showModal(a),i.close()}))("close",(function(){return t.$implicit.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("query",e.query)}}function kS(e,t){if(1&e){const e=s.Yb();s.Xb(0,"audit-log-send-to-email",15),s.jc("discardExport",(function(){return t.$implicit.close()}))("close",(function(){return t.$implicit.close()}))("exportComplete",(function(){s.Oc(e);const n=t.$implicit,i=s.nc(),c=s.Lc(11);return i.showModal(c),n.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("query",e.query)("exportTaskId",e.exportTaskId)}}function WS(e,t){if(1&e){const e=s.Yb();s.Xb(0,"audit-log-export-complete",16),s.jc("retryExport",(function(){s.Oc(e);const n=t.$implicit,i=s.nc(),c=s.Lc(5);return i.showModal(c),n.close()}))("close",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return n.close(),i.resetFileId()})),s.Wb()}if(2&e){const e=s.nc();s.wc("fileId",e.fileId)}}let XS=(()=>{class e{constructor(e,t,n,i,s){this.workspaceService=e,this.auditLogService=t,this.cd=n,this.loader=i,this.modalService=s,this.logs=[],this.noFilterSettings=!0,this._ngUnsubscribe$=new p.a}ngOnInit(){this.workspaceService.getWorkspaceById(this.workspaceId).subscribe(e=>{this.auditLogService.auditLogSettings.next(e.auditLogSettings);const t=this.auditLogService.getFilterSettings();this.noFilterSettings=null===t,this.noFilterSettings&&(this.notificationTitle="AUDIT_LOG.NOTIFICATION_MESSAGE.TITLE.DEFAULT",this.notificationSubtitle="AUDIT_LOG.NOTIFICATION_MESSAGE.SUBTITLE.DEFAULT")})}onFiltersUpdated(e){this.loader.show(),this.query=Object.assign(Object.assign({},e),{pageNumber:1,pageSize:20}),this.auditLogService.getLogs(this.query).subscribe(e=>{this.logs=[...e.result],this.paginationData={page:e.pageNumber+1,limit:e.pageSize,total:e.totalResults},0===this.logs.length&&(this.notificationTitle="AUDIT_LOG.NOTIFICATION_MESSAGE.TITLE.NO_LOGS_FOUND",this.notificationSubtitle="AUDIT_LOG.NOTIFICATION_MESSAGE.SUBTITLE.NO_LOGS_FOUND"),this.cd.detectChanges(),this.loader.hide()})}onPaginationUpdated(e){this.query.pageNumber=e.page,this.query.pageSize=e.limit,this.auditLogService.getLogs(this.query).subscribe(e=>{this.logs=[...e.result],this.cd.detectChanges(),this.loader.hide()})}showModal(e){this.modalService.open(e,{centered:!0})}showSendToEmailModal(e,t){this.exportTaskId=t,this.modalService.open(e,{centered:!0})}setFileId(e){this.fileId=e.fileId}resetFileid(){this.fileId=null}ngOnDestroy(){this._ngUnsubscribe$.next(),this._ngUnsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(kt.a),s.Rb(s.h),s.Rb(Hn.a),s.Rb(w.q))},e.\u0275cmp=s.Lb({type:e,selectors:[["audit-log"]],inputs:{workspaceId:"workspaceId"},decls:12,vars:5,consts:[[1,"cl-d-block",3,"filtersUpdated"],["class","cl-bg-light cl-text-gray-9 cl-border-top cl-border-right cl-border-left",4,"ngIf"],[3,"logs","paginationData","paginationUpdated",4,"ngIf"],["class","cl-d-block cl-mt-4",3,"title","subtitle","imagePath",4,"ngIf"],["exportPrompt",""],["exportModal",""],["sendToEmailModal",""],["exportComplete",""],[1,"cl-bg-light","cl-text-gray-9","cl-border-top","cl-border-right","cl-border-left"],[1,"cl-mw-100","cl-d-flex","cl-flex-row","cl-align-items-center","cl-justify-content-between","cl-h6","cl-mb-0","cl-pl-lg-3","cl-p-1"],[1,"cl-btn-sm","cl-btn-outline-primary","cl-border","cl-border-primary","cl-text-uppercase","cl-text-decoration-none","cl-px-2","cl-py-1",3,"click"],[3,"logs","paginationData","paginationUpdated"],[1,"cl-d-block","cl-mt-4",3,"title","subtitle","imagePath"],[3,"startExport","close"],[3,"query","sendToEmail","exportComplete","close"],[3,"query","exportTaskId","discardExport","close","exportComplete"],[3,"fileId","retryExport","close"]],template:function(e,t){1&e&&(s.Xb(0,"audit-log-filter",0),s.jc("filtersUpdated",(function(e){return t.onFiltersUpdated(e)})),s.Wb(),s.Xc(1,wS,7,6,"div",1),s.Xc(2,LS,1,2,"audit-log-table",2),s.Xc(3,RS,3,7,"message-entries",3),s.Xc(4,yS,1,0,"ng-template",null,4,s.Yc),s.Xc(6,_S,1,1,"ng-template",null,5,s.Yc),s.Xc(8,kS,1,2,"ng-template",null,6,s.Yc),s.Xc(10,WS,1,1,"ng-template",null,7,s.Yc)),2&e&&(s.Hb("cl-mb-4",t.logs.length>0),s.Cb(1),s.wc("ngIf",t.logs.length>0),s.Cb(1),s.wc("ngIf",t.logs.length>0),s.Cb(1),s.wc("ngIf",0===t.logs.length))},directives:[Ig,i.u,mS,li.a,gS,CS,TS,IS],pipes:[g.e],encapsulation:2}),e})();const NS=["tabs"];function DS(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"li",8),s.Xb(2,"a",9),s.jc("click",(function(){return s.Oc(e),s.nc(2).activatePill("ACCOUNTS")})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Xb(5,"li",8),s.Xb(6,"a",9),s.jc("click",(function(){return s.Oc(e),s.nc(2).activatePill("AUTH")})),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc(2);s.Cb(2),s.Hb("cl-active",e.pills.ACCOUNTS),s.Cb(1),s.bd(" ",s.pc(4,6,"GLOBAL.ACCOUNTS_TITLE")," "),s.Cb(3),s.Hb("cl-active",e.pills.AUTH),s.Cb(1),s.bd(" ",s.pc(8,8,"WORKSPACE.SHARED.AUTH_LABEL")," ")}}function PS(e,t){if(1&e){const e=s.Yb();s.Xb(0,"li",8),s.Xb(1,"a",9),s.jc("click",(function(){return s.Oc(e),s.nc(2).activatePill("AUDIT_LOG")})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(1),s.Hb("cl-active",e.pills.AUDIT_LOG),s.Cb(1),s.bd(" ",s.pc(3,3,"AUDIT_LOG.AUDIT_LOG_LABEL")," ")}}function MS(e,t){if(1&e&&s.Sb(0,"settings-tab",22),2&e){const e=s.nc(2);s.wc("hasHistoricRateFeature",e.hasHistoricRateFeature)("workspace",e.workspace)}}function BS(e,t){if(1&e&&s.Sb(0,"permissions-tab",23),2&e){const e=s.nc(2);s.wc("workspace",e.workspace)("user",e.user)}}function US(e,t){if(1&e&&s.Sb(0,"alerts",24),2&e){const e=s.nc(2);s.wc("hasAlertsFeature",e.hasAlertsFeature)("workspaceId",e.workspaceId)}}function GS(e,t){if(1&e&&s.Sb(0,"accounts-tab",27),2&e){const e=s.nc(3);s.wc("hasControlAccountFeature",e.hasControlAccountFeature)("isOwner",e.isOwner)}}function xS(e,t){if(1&e&&s.Sb(0,"auth-tab",28),2&e){const e=s.nc(3);s.wc("hasCustomSubdomainFeature",e.hasCustomSubdomainFeature)("isOwner",e.isOwner)}}function FS(e,t){if(1&e&&(s.Vb(0),s.Xc(1,GS,1,2,"accounts-tab",25),s.Xc(2,xS,1,2,"auth-tab",26),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",e.pills.ACCOUNTS),s.Cb(1),s.wc("ngIf",e.pills.AUTH)}}function jS(e,t){if(1&e&&s.Sb(0,"custom-field-card",29),2&e){const e=s.nc(2);s.wc("hasCustomFieldsFeature",e.hasCustomFieldsFeature)}}function ZS(e,t){if(1&e&&s.Sb(0,"integrations-tab",30),2&e){const e=s.nc(2);s.wc("workspace",e.workspace)("hasQuickbooksIntegrationPermission",e.hasQuickbooksIntegrationPermission)}}function VS(e,t){if(1&e&&s.Sb(0,"import-csv-tab",31),2&e){const e=s.nc(2);s.wc("projectGroupingLabel",e.projectGroupingLabel)("workspaceId",e.workspaceId)("hasImportFileFeature",e.hasImportFileFeature)}}function YS(e,t){if(1&e&&s.Sb(0,"audit-log",32),2&e){const e=s.nc(2);s.Hb("cl-mb-0",!0),s.wc("workspaceId",e.workspaceId)}}function HS(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",5),s.Xb(2,"ul",6,7),s.Xb(4,"li",8),s.Xb(5,"a",9),s.jc("click",(function(){return s.Oc(e),s.nc().activatePill("SETTINGS")})),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xb(8,"li",8),s.Xb(9,"a",9),s.jc("click",(function(){return s.Oc(e),s.nc().activatePill("PERMISSIONS")})),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Wb(),s.Xb(12,"li",8),s.Xb(13,"a",9),s.jc("click",(function(){return s.Oc(e),s.nc().activatePill("ALERTS")})),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Wb(),s.Xc(16,DS,9,10,"ng-container",4),s.Xb(17,"li",8),s.Xb(18,"a",9),s.jc("click",(function(){return s.Oc(e),s.nc().activatePill("CUSTOM_FIELDS")})),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Wb(),s.Xb(21,"li",8),s.Xb(22,"a",9),s.jc("click",(function(){return s.Oc(e),s.nc().activatePill("INTEGRATIONS")})),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Wb(),s.Xb(25,"li",8),s.Xb(26,"a",9),s.jc("click",(function(){return s.Oc(e),s.nc().activatePill("IMPORT")})),s.Zc(27),s.oc(28,"translate"),s.Wb(),s.Wb(),s.Xc(29,PS,4,5,"li",10),s.Wb(),s.Wb(),s.Xb(30,"div",11),s.Xb(31,"div",12),s.Xb(32,"div",13),s.Xb(33,"div",14),s.Xc(34,MS,1,2,"settings-tab",15),s.Xc(35,BS,1,2,"permissions-tab",16),s.Xc(36,US,1,2,"alerts",17),s.Xc(37,FS,3,2,"ng-container",4),s.Xc(38,jS,1,1,"custom-field-card",18),s.Xc(39,ZS,1,2,"integrations-tab",19),s.Xc(40,VS,1,3,"import-csv-tab",20),s.Xc(41,YS,1,3,"audit-log",21),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc();s.Cb(5),s.Hb("cl-active",e.pills.SETTINGS),s.Cb(1),s.bd(" ",s.pc(7,28,"WORKSPACE.SETTINGS.TABS.GENERAL_TITLE")," "),s.Cb(3),s.Hb("cl-active",e.pills.PERMISSIONS),s.Cb(1),s.bd(" ",s.pc(11,30,"WORKSPACE.SETTINGS.TABS.PERMISSIONS_TITLE")," "),s.Cb(3),s.Hb("cl-active",e.pills.ALERTS),s.Cb(1),s.bd(" ",s.pc(15,32,"GLOBAL.ALERTS_TITLE")," "),s.Cb(2),s.wc("ngIf",!e.isSelfHosted),s.Cb(2),s.Hb("cl-active",e.pills.CUSTOM_FIELDS),s.Cb(1),s.bd(" ",s.pc(20,34,"GLOBAL.CUSTOM_FIELDS_LABEL")," "),s.Cb(3),s.Hb("cl-active",e.pills.INTEGRATIONS),s.Cb(1),s.bd(" ",s.pc(24,36,"WORKSPACE.SETTINGS.TABS.INTEGRATIONS_TITLE")," "),s.Cb(3),s.Hb("cl-active",e.pills.IMPORT),s.Cb(1),s.bd(" ",s.pc(28,38,"GLOBAL.IMPORT_TITLE")," "),s.Cb(2),s.wc("ngIf",e.workspace.hasFeature(e.Features.AUDIT_LOG)&&e.auditLogActive),s.Cb(5),s.wc("ngIf",e.pills.SETTINGS),s.Cb(1),s.wc("ngIf",e.pills.PERMISSIONS),s.Cb(1),s.wc("ngIf",e.pills.ALERTS),s.Cb(1),s.wc("ngIf",!e.isSelfHosted),s.Cb(1),s.wc("ngIf",e.pills.CUSTOM_FIELDS),s.Cb(1),s.wc("ngIf",e.pills.INTEGRATIONS),s.Cb(1),s.wc("ngIf",e.pills.IMPORT),s.Cb(1),s.wc("ngIf",e.pills.AUDIT_LOG)}}let $S=(()=>{class e{constructor(e,t,n,i,s,c,a){this.workspaceService=e,this.userService=t,this.activatedRoute=n,this.router=i,this.authService=s,this.auditLogService=c,this.http=a,this.projectGroupingLabel="",this.isSelfHosted=bo.a.environment.selfHosted,this.Features=is.a,this.unsubscribe$=new Fn.a}ngOnInit(){this.user=this.authService.getUser(),this.authService.permissionData$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(({isOwner:e})=>this.isOwner=e),this.activatedRoute.params.pipe(Object(d.a)(e=>e.workspaceId)).subscribe(e=>{this.workspaceId=e,this.workspaceService.getDefaultWorkspaceId()===e?this.subscribeToDefaultWorkspace():this.getWorkspaceById(e)}),this.activatedRoute.fragment.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{const t=uo[(e||"").toUpperCase()];this.pills={[t||uo.SETTINGS]:!0},t||this.router.navigate([])})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}activatePill(e){this.pills={[e]:!0},e===uo.SETTINGS?this.router.navigate([]):this.router.navigate([],{fragment:e.toString().toLowerCase()})}getWorkspaceById(e){this.workspaceService.getWorkspaceById(e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.setWorkspace(e)})}subscribeToDefaultWorkspace(){this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.setWorkspace(e)})}setWorkspace(e){this.workspace=e,this.auditLogActive=!!this.workspace.auditLogSettings&&this.workspace.auditLogSettings.auditEnabled,this.projectGroupingLabel=this.workspaceService.generateClientsLabel(e.projectGroupingLabel),this.hasImportFileFeature=e.hasFeature(is.a.FILE_IMPORT),this.hasHistoricRateFeature=e.hasFeature(is.a.HISTORIC_RATES),this.hasAlertsFeature=e.hasFeature(is.a.ALERTS),this.hasControlAccountFeature=e.hasFeature(is.a.ADMIN_PANEL),this.hasCustomSubdomainFeature=e.hasFeature(is.a.CUSTOM_SUBDOMAIN),this.hasCustomFieldsFeature=e.hasFeature(is.a.CUSTOM_FIELDS),this.hasQuickbooksIntegrationPermission=e.hasFeature(is.a.QUICKBOOKS_INTEGRATION)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(Lc.a),s.Rb(k.a),s.Rb(k.d),s.Rb(re.a),s.Rb(kt.a),s.Rb(m.c))},e.\u0275cmp=s.Lb({type:e,selectors:[["workspace-settings"]],viewQuery:function(e,t){var n;1&e&&s.gd(NS,!0),2&e&&s.Kc(n=s.kc())&&(t.tabs=n.first)},decls:7,vars:4,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-h1"],[4,"ngIf"],[1,"cl-scroll-tabs-wrapper"],["tabs","",1,"cl-nav","cl-nav-tabs","cl-m-0","cl-scroll-tabs"],["tabs","tabs"],[1,"cl-nav-item"],[1,"cl-nav-link",3,"click"],["class","cl-nav-item",4,"ngIf"],[1,"cl-card"],[1,"cl-card-body"],[1,"cl-tab-content"],[1,"cl-tab-pane","cl-fade","cl-active","cl-show"],[3,"hasHistoricRateFeature","workspace",4,"ngIf"],[3,"workspace","user",4,"ngIf"],[3,"hasAlertsFeature","workspaceId",4,"ngIf"],[3,"hasCustomFieldsFeature",4,"ngIf"],[3,"workspace","hasQuickbooksIntegrationPermission",4,"ngIf"],[3,"projectGroupingLabel","workspaceId","hasImportFileFeature",4,"ngIf"],[3,"cl-mb-0","workspaceId",4,"ngIf"],[3,"hasHistoricRateFeature","workspace"],[3,"workspace","user"],[3,"hasAlertsFeature","workspaceId"],[3,"hasControlAccountFeature","isOwner",4,"ngIf"],[3,"hasCustomSubdomainFeature","isOwner",4,"ngIf"],[3,"hasControlAccountFeature","isOwner"],[3,"hasCustomSubdomainFeature","isOwner"],[3,"hasCustomFieldsFeature"],[3,"workspace","hasQuickbooksIntegrationPermission"],[3,"projectGroupingLabel","workspaceId","hasImportFileFeature"],[3,"workspaceId"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"h1",3),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Xc(6,HS,42,40,"ng-container",4),s.Wb(),s.Wb()),2&e&&(s.Cb(4),s.ad(s.pc(5,2,"WORKSPACE.SETTINGS.TITLE")),s.Cb(2),s.wc("ngIf",t.workspace))},directives:[i.u,lo.a,Dr,Ll,Fl,fb,Wu,Xu.a,Um,pg,XS],pipes:[g.e],encapsulation:2}),e})();var KS=n("B0km");let qS=(()=>{class e{constructor(e,t,n,i){this.authService=e,this.router=t,this.adminGuard=n,this.workspaceService=i}canActivate(e){const t=this.workspaceService.getDefaultWorkspaceId()||this.authService.getUserDefaultWorkspaceId(),n=e.url[1].path;return t!==n?this.authService.isUserAdminOnWorkspace(n).pipe(Object(d.a)(e=>{const t=null==e?void 0:e.isAdminOrOwner;return t||this.router.navigate(["/tracker"]),t}),Object(Vt.a)(()=>(this.router.navigate(["/tracker"]),Object(Yt.a)(!1)))):this.adminGuard.checkIsAdmin()}}return e.\u0275fac=function(t){return new(t||e)(s.fc(re.a),s.fc(k.d),s.fc(KS.a),s.fc(l.a))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var zS=n("bM1u");function QS(e,t){if(1&e&&(s.Xb(0,"button",15),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.ad(s.pc(2,1,e.reason))}}function JS(e,t){1&e&&(s.Xb(0,"button",15),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd("",s.pc(2,1,"DELETE_ACCOUNT.FORM.DELETE_REASON_BTN")," "))}function eC(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",19),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc(2).selectReason(n)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=t.$implicit;s.Cb(1),s.ad(s.pc(2,1,e.name))}}function tC(e,t){if(1&e&&(s.Xb(0,"div",16),s.Xb(1,"div",17),s.Xc(2,eC,3,3,"a",18),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.wc("ngForOf",e.deleteReasons)}}function nC(e,t){if(1&e&&(s.Xb(0,"div",6),s.Xb(1,"div",20),s.Xb(2,"textarea",21),s.oc(3,"translate"),s.Zc(4,"        "),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.Hb("cl-is-invalid",e.isValid("reasonDescription")),s.xc("placeholder",s.pc(3,3,e.placeholder))}}let iC=(()=>{class e{constructor(e,t,n,i,c){this.router=e,this.userService=t,this.authService=n,this.formBuilder=i,this.translate=c,this.deleteReasons=[{name:"DELETE_ACCOUNT.DELETE_REASONS.REASON_1",placeholder:"DELETE_ACCOUNT.DELETE_REASONS.REASON_1_PLACEHOLDER"},{name:"DELETE_ACCOUNT.DELETE_REASONS.REASON_2",placeholder:"DELETE_ACCOUNT.DELETE_REASONS.REASON_2_PLACEHOLDER"},{name:"DELETE_ACCOUNT.DELETE_REASONS.REASON_3",placeholder:"DELETE_ACCOUNT.DELETE_REASONS.REASON_3_PLACEHOLDER"},{name:"DELETE_ACCOUNT.DELETE_REASONS.REASON_4",placeholder:"DELETE_ACCOUNT.DELETE_REASONS.REASON_4_PLACEHOLDER"},{name:"GLOBAL.REASON_NAME_TITLE",placeholder:"DELETE_ACCOUNT.DELETE_REASONS.REASON_5_PLACEHOLDER"}],this.unsubscribe$=new Fn.a,this.onSuccess=new s.n}ngOnInit(){this.message="",this.profile=this.authService.getUser(),this.form=this.formBuilder.group({reasonDescription:["",[v.G.required,v.G.minLength(2)]]})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}selectReason(e){this.reason=e.name,this.placeholder=e.placeholder}get reasonDescription(){return this.form.get("reasonDescription")}deleteAccount(){this.message=this.translate.instant(this.reason)+" , "+this.reasonDescription.value,this.inProgress=!0,this.userService.deleteUser(this.profile.id,this.message,this.authentication).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.onSuccess.emit(!0),this.close()},()=>{this.inProgress=!1})}isValid(e){const t=this.form.get(e);return!!t&&t.dirty&&t.touched&&!!t.errors}close(){this.onSuccess.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.d),s.Rb(Lc.a),s.Rb(re.a),s.Rb(v.f),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["delete-form"]],inputs:{authentication:"authentication"},outputs:{onSuccess:"onSuccess"},decls:24,vars:14,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[3,"formGroup","ngSubmit"],[1,"cl-modal-body"],[1,"cl-form-row"],[1,"cl-form-group","cl-col-lg-custom-12"],[1,"cl-text-gray-6"],["dropdownKey","",1,"cl-dropdown"],["class","cl-btn cl-w-100 cl-text-left cl-btn-outline-light cl-dropdown-toggle","dropdownKeyButton","","type","button",4,"ngIf"],["class","cl-dropdown-menu",4,"dropdownKeyContent"],["class","cl-form-row",4,"ngIf"],[1,"cl-modal-footer"],["type","submit",1,"cl-btn","cl-btn-danger",3,"disabled"],["dropdownKeyButton","","type","button",1,"cl-btn","cl-w-100","cl-text-left","cl-btn-outline-light","cl-dropdown-toggle"],[1,"cl-dropdown-menu"],[1,"cl-scroll-area"],["clickCloseDropdown","","class","cl-dropdown-item",3,"click",4,"ngFor","ngForOf"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"click"],[1,"cl-form-group","cl-mb-0","cl-col-lg-custom-12"],["rows","4","name","reason","formControlName","reasonDescription",1,"cl-form-control",3,"placeholder"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.close()})),s.Xb(5,"span"),s.Sb(6,"img",3),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"form",4),s.jc("ngSubmit",(function(){return t.deleteAccount()})),s.Xb(8,"div",5),s.Xb(9,"div"),s.Xb(10,"div",6),s.Xb(11,"div",7),s.Xb(12,"label",8),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Xb(15,"div",9),s.Xc(16,QS,3,3,"button",10),s.Xc(17,JS,3,3,"button",10),s.Xc(18,tC,3,1,"div",11),s.Wb(),s.Wb(),s.Wb(),s.Xc(19,nC,5,5,"div",12),s.Wb(),s.Wb(),s.Xb(20,"div",13),s.Xb(21,"button",14),s.Zc(22),s.oc(23,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,8,"DELETE_ACCOUNT.DELETE_HEADER")),s.Cb(5),s.wc("formGroup",t.form),s.Cb(6),s.bd("",s.pc(14,10,"DELETE_ACCOUNT.FORM.DELETE_REASON_LABEL"),":"),s.Cb(3),s.wc("ngIf",t.reason),s.Cb(1),s.wc("ngIf",!t.reason),s.Cb(2),s.wc("ngIf",t.reason),s.Cb(2),s.wc("disabled",t.form.invalid||t.inProgress),s.Cb(1),s.ad(s.pc(23,12,"DELETE_ACCOUNT.DELETE_ACC_BTN")))},directives:[v.I,v.t,v.k,ni.a,i.u,si.a,ii.a,i.t,v.c,v.s,v.i],pipes:[g.e],encapsulation:2}),e})();function sC(e,t){1&e&&(s.Xb(0,"div",15),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"a",16),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"span"),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Xb(10,"a",17),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,4,"GLOBAL.NEED_HELP")),s.Cb(3),s.bd(" ",s.pc(6,6,"GLOBAL.CALL_SUPPORT_LABEL"),""),s.Cb(3),s.bd(" ",s.pc(9,8,"DELETE_ACCOUNT.FORBID_SUPPORT_PART_1")," "),s.Cb(3),s.bd(" ",s.pc(12,10,"DELETE_ACCOUNT.FORBID_SUPPORT_PART_2")," "))}function cC(e,t){if(1&e&&(s.Xb(0,"div",18),s.Xb(1,"div",19),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"span",20),s.Zc(5),s.Wb(),s.Zc(6,"."),s.Wb(),s.Xb(7,"div",21),s.Xb(8,"div",22),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Xb(11,"ul",23),s.Xb(12,"li",24),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Xb(15,"li",24),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Wb(),s.Sb(18,"hr",18),s.Xb(19,"div",25),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.bd("",s.pc(3,6,"DELETE_ACCOUNT.WORKSPACE_NOT_EMPTY_WARNING"),": "),s.Cb(3),s.ad(e.workspaces),s.Cb(4),s.bd("",s.pc(10,8,"DELETE_ACCOUNT.WORKSPACE_NOT_EMPTY_STEP_INFO"),":"),s.Cb(4),s.ad(s.pc(14,10,"DELETE_ACCOUNT.WORKSPACE_NOT_EMPTY_STEP_1")),s.Cb(3),s.ad(s.pc(17,12,"DELETE_ACCOUNT.WORKSPACE_NOT_EMPTY_STEP_2")),s.Cb(4),s.bd("",s.pc(21,14,"DELETE_ACCOUNT.WORKSPACE_NOT_EMPTY_STEP_FINAL"),".")}}function aC(e,t){if(1&e&&(s.Xb(0,"li"),s.Zc(1),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.bd(" ",e," ")}}function oC(e,t){if(1&e&&(s.Xb(0,"div",26),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"ul",27),s.Xc(5,aC,2,1,"li",28),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.bd("",s.pc(3,2,"DELETE_ACCOUNT.DELETE_FROM_ALL_INFO"),": "),s.Cb(3),s.wc("ngForOf",e.allWorkspaces)}}function rC(e,t){if(1&e){const e=s.Yb();s.Xb(0,"delete-confirm",29),s.jc("onSuccess",(function(){return t.$implicit.close()}))("onUserConfirmed",(function(t){s.Oc(e);const n=s.nc(),i=s.Lc(22);return n.openSecondModal(t,i)})),s.Wb()}}function lC(e,t){if(1&e&&(s.Xb(0,"delete-form",30),s.jc("onSuccess",(function(){return t.$implicit.close()})),s.Wb()),2&e){const e=s.nc();s.wc("authentication",e.authentication)}}let bC=(()=>{class e{constructor(e,t,n,i,s){this.workspaceService=e,this.router=t,this.userService=n,this.authService=i,this.modalService=s,this.workspaces=[],this.allWorkspaces=[],this.workspaceIdsWhereOwner=[],this.unsubscribe$=new Fn.a}ngOnInit(){this.isForbiddenZone=In.g.includes(ke.tz.guess()),this.subscribeToWorkspaces(),this.workspaceService.getAllWorkspaces()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}isOnlyOneMemberIn(e){return 1==e.memberships.filter(e=>"ACTIVE"===e.membershipStatus).length}modalOne(e){this.modalService.open(e,{centered:!0})}openSecondModal(e,t){e.shouldOpen&&(this.authentication=e.authentication,this.modalOne(t))}subscribeToWorkspaces(){this.workspaceService.workspaces$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspaceService.getPermissionsForUserOnWorkspaces(e.map(e=>e.id)),this.workspaceService.workspacesPermissionsForUser.pipe(Object(ln.a)(1)).subscribe(t=>{this.workspaceIdsWhereOwner=t.filter(e=>e.name===h.a.OWNER).map(e=>e.objectId),this.allWorkspaces=e.map(e=>e.name),this.workspaces=e.filter(e=>!this.isOnlyOneMemberIn(e)&&this.workspaceIdsWhereOwner.indexOf(e.id)>-1).map(e=>e.name)})})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(k.d),s.Rb(Lc.a),s.Rb(re.a),s.Rb(w.q))},e.\u0275cmp=s.Lb({type:e,selectors:[["delete-account"]],decls:23,vars:13,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-h1"],[1,"cl-card"],[1,"cl-card-body","cl-m-2"],[1,"cl-row","cl-align-items-center"],[1,"cl-col-lg-custom-6"],[1,"cl-display-1","cl-mb-3"],["class","cl-d-block cl-alert cl-alert-primary cl-fade cl-show cl-mb-3 cl-text-left",4,"ngIf"],["class","cl-mb-3",4,"ngIf"],["class","cl-alert cl-d-block cl-alert-danger cl-rounded-0 cl-mb-3","role","alert",4,"ngIf"],[1,"cl-btn","cl-btn-danger","cl-mr-3",3,"disabled","click"],["confirmModal",""],["formModal",""],[1,"cl-d-block","cl-alert","cl-alert-primary","cl-fade","cl-show","cl-mb-3","cl-text-left"],["href","https://calendly.com/clockify-support/call","target","_blank",1,"cl-font-weight-bold"],["href","https://clockify.me/help/contact/sales\\","target","_blank",1,"cl-font-weight-bold"],[1,"cl-mb-3"],[1,"cl-alert","cl-d-block","cl-alert-danger","cl-rounded-0","cl-mb-0"],[1,"cl-add-comma"],[1,"cl-border","cl-border-top-0","cl-p-3"],[1,"cl-h2"],[1,"cl-d-inline-block"],[1,"cl-delete-account-list-elements"],[1,"cl-small"],["role","alert",1,"cl-alert","cl-d-block","cl-alert-danger","cl-rounded-0","cl-mb-3"],[1,"cl-ml-3"],[4,"ngFor","ngForOf"],[3,"onSuccess","onUserConfirmed"],[3,"authentication","onSuccess"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"h1",3),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Xb(6,"div",4),s.Xb(7,"div",5),s.Xb(8,"div",6),s.Xb(9,"div",7),s.Xb(10,"div",8),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xc(13,sC,13,12,"div",9),s.Xc(14,cC,22,16,"div",10),s.Xc(15,oC,6,4,"div",11),s.Xb(16,"button",12),s.jc("click",(function(){s.Oc(e);const n=s.Lc(20);return t.modalOne(n)})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(19,rC,1,0,"ng-template",null,13,s.Yc),s.Xc(21,lC,1,1,"ng-template",null,14,s.Yc)}2&e&&(s.Cb(4),s.ad(s.pc(5,7,"DELETE_ACCOUNT.DELETE_HEADER")),s.Cb(7),s.ad(s.pc(12,9,"DELETE_ACCOUNT.SORRY_TO_LEAVE_TEXT")),s.Cb(2),s.wc("ngIf",!t.isForbiddenZone),s.Cb(1),s.wc("ngIf",t.workspaces.length>0),s.Cb(1),s.wc("ngIf",t.allWorkspaces.length>0),s.Cb(1),s.wc("disabled",t.workspaces.length>0),s.Cb(1),s.ad(s.pc(18,11,"DELETE_ACCOUNT.DELETE_ACC_BTN")))},directives:[i.u,i.t,zS.a,iC],pipes:[g.e],encapsulation:2}),e})();var dC=n("s5zK"),uC=n("itXk");const pC={type:"user-seats",title:"GLOBAL.USER_SEATS_TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.USER_SEATS.DESCRIPTION",img:"/assets/images/features-info/user_seats.svg",link:"https://clockify.me/help/extra-features/subscription#user-seats-enterprise"},hC=[{type:is.a.ADD_TIME_FOR_OTHERS,title:"GLOBAL.ADD_TIME_FOR_OTHERS",text:"SHARED_MODULES.FEATURES_INFO_TYPES.ADD_TIME_FOR_OTHERS.DESCRIPTION",img:"/assets/images/features-info/add_time_for_others.svg",link:"https://clockify.me/help/extra-features/add-time-for-others"},{type:"hide-and-time-and-page",title:"SHARED_MODULES.FEATURES_INFO_TYPES.HIDE_TIME_AND_PAGES.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.HIDE_TIME_AND_PAGES.DESCRIPTION",img:"/assets/images/features-info/hide_pages.svg",link:"https://clockify.me/help/extra-features/hide-time"},{type:is.a.AUTOMATIC_LOCK,title:"SHARED_MODULES.FEATURES_INFO_TYPES.AUTOMATIC_LOCK.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.AUTOMATIC_LOCK.DESCRIPTION",img:"/assets/images/features-info/automatic_lock.svg",link:"https://clockify.me/help/extra-features/automatic-lock"},{type:is.a.WORKSPACE_TIME_AUDIT,title:"GLOBAL.TIME_AUDIT_TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.TIME_AUDIT.DESCRIPTION",img:"/assets/images/features-info/time_audit.svg",link:"https://clockify.me/help/extra-features/time-audit"},{type:is.a.REQUIRED_FIELDS,title:"SHARED_MODULES.FEATURES_INFO_TYPES.REQUIRED_FIELDS.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.REQUIRED_FIELDS.DESCRIPTION",img:"/assets/images/features-info/required_fields.svg",link:"https://clockify.me/help/extra-features/required-fields"},{type:is.a.PROJECT_TEMPLATES,title:"SHARED_MODULES.FEATURES_INFO_TYPES.PROJECT_TEMPLATES.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.PROJECT_TEMPLATES.DESCRIPTION",img:"/assets/images/features-info/project_template.svg",link:"https://clockify.me/help/extra-features/project-templates"},{type:is.a.BULK_EDIT,title:"GLOBAL.BULK_EDIT_LABEL",text:"SHARED_MODULES.FEATURES_INFO_TYPES.BULK_EDIT.DESCRIPTION",img:"/assets/images/features-info/bulk_edit.svg",link:"https://clockify.me/help/extra-features/bulk-edit"},{type:is.a.CUSTOM_REPORTING,title:"SHARED_MODULES.FEATURES_INFO_TYPES.CUSTOMIZE_EXPORTS.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.CUSTOMIZE_EXPORTS.DESCRIPTION",img:"/assets/images/features-info/custom-exports.svg",link:"https://clockify.me/help/extra-features/customize-exports"},{type:is.a.HIDE_PAGES,title:"SHARED_MODULES.FEATURES_INFO_TYPES.HIDE_PAGES.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.HIDE_PAGES.DESCRIPTION",img:"/assets/images/features-info/hide_pages.svg",link:"https://clockify.me/help/extra-features/hide-time"},{type:is.a.HISTORIC_RATES,title:"SHARED_MODULES.FEATURES_INFO_TYPES.HISTORIC_RATES.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.HISTORIC_RATES.DESCRIPTION",img:"/assets/images/features-info/historic_rates.svg",link:"https://clockify.me/help/reports/hourly-rates#historic-rates"},{type:is.a.WORKSPACE_LOCK_TIMEENTRIES,title:"GLOBAL.LOCK_TIME_TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.LOCK_TIME.DESCRIPTION",img:"/assets/images/features-info/lock_entries.svg",link:"https://clockify.me/help/extra-features/lock-timesheets"},{type:"automatic-and-manual-lock",title:"GLOBAL.LOCK_TIME_TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.AUTO_LOCK_TIME.DESCRIPTION",img:"/assets/images/features-info/automatic-and-manual-lock.svg",link:"https://clockify.me/help/extra-features/lock-timesheets"},{type:is.a.APPROVAL,title:"GLOBAL.TIME_APPROVAL_TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.TIME_APPROVAL.DESCRIPTION",img:"/assets/images/features-info/time-approval-info.svg",link:"https://clockify.me/help/extra-features/time-approval"},{type:is.a.MANAGER_ROLE,title:"SHARED_MODULES.FEATURES_INFO_TYPES.MANAGER_ROLE.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.MANAGER_ROLE.DESCRIPTION",img:"/assets/images/features-info/manager-role-info.svg",link:"https://clockify.me/help/extra-features/manager-role"},{type:is.a.TARGETS_AND_REMINDERS,title:"SHARED_MODULES.FEATURES_INFO_TYPES.TIMESHEET_REMINDERS.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.TIMESHEET_REMINDERS.DESCRIPTION",img:"/assets/images/features-info/reminders.svg",link:"https://clockify.me/help/extra-features/targets-reminders"},{type:is.a.FILE_IMPORT,title:"SHARED_MODULES.FEATURES_INFO_TYPES.IMPORT_TIMESHEETS.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.IMPORT_TIMESHEETS.DESCRIPTION",img:"/assets/images/features-info/import_csv.png",link:"https://clockify.me/help/extra-features/import-timesheets"},{type:is.a.WORKSPACE_TIME_ROUNDING,title:"GLOBAL.TIME_ROUNDING_TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.TIME_ROUNDING.DESCRIPTION",img:"/assets/images/features-info/time_rounding.svg",link:"https://clockify.me/help/extra-features/time-rounding"},{type:is.a.TASK_RATES,title:"GLOBAL.TASK_RATES_TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.TASK_RATES.DESCRIPTION",img:"/assets/images/features-info/task-rates.svg",link:"https://clockify.me/help/extra-features/task-rates"},{type:is.a.INVOICING,title:"GLOBAL.INVOICING_TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.INVOICING.DESCRIPTION",img:"/assets/images/features-info/invoicing.svg",link:"https://clockify.me/help/extra-features/invoicing"},{type:is.a.QUICKBOOKS_INTEGRATION,title:"SHARED_MODULES.FEATURES_INFO_TYPES.QUICKBOOKS_INTEGRATIONS.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.QUICKBOOKS_INTEGRATIONS.DESCRIPTION",img:"/assets/images/features-info/qb_integration.svg",link:"https://clockify.me/help/extra-features/quickbooks-integration"},{type:is.a.LABOR_COST,title:"SHARED_MODULES.FEATURES_INFO_TYPES.LABOR_COST_AND_PROFIT.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.LABOR_COST_AND_PROFIT.DESCRIPTION",img:"/assets/images/features-info/labor_cost_upgrade.svg",link:"https://clockify.me/help/extra-features/labor-cost"},{type:is.a.SCHEDULED_REPORTS,title:"SHARED_MODULES.FEATURES_INFO_TYPES.SCHEDULED_REPORTS.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.SCHEDULED_REPORTS.DESCRIPTION",img:"/assets/images/features-info/scheduled-info.png",link:"https://clockify.me/help/extra-features/scheduled-reports"},{type:is.a.PROJECT_BUDGET,title:"SHARED_MODULES.FEATURES_INFO_TYPES.BUDGET_AND_ESTIMATES.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.BUDGET_AND_ESTIMATES.DESCRIPTION_NEW",img:"/assets/images/features-info/project-budget.svg",link:"https://clockify.me/help/extra-features/project-budget"},{type:is.a.ALERTS,title:"GLOBAL.ALERTS_TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.ALERTS.DESCRIPTION",img:"/assets/images/features-info/alerts.svg",link:"https://clockify.me/help/extra-features/alerts"},{type:is.a.DISABLE_MANUAL_MODE,title:"GLOBAL.FORCE_TIMER_TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.FORCE_TIMER.DESCRIPTION",img:"/assets/images/features-info/force-timer-info.svg",link:"https://clockify.me/help/extra-features/force-timer"},{type:is.a.LOCATIONS,title:"GLOBAL.GPS_TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.GPS_TRACKING.DESCRIPTION",img:"/assets/images/features-info/locations-feature.svg",link:"https://clockify.me/help/extra-features/gps-tracking"},{type:is.a.SCREENSHOTS,title:"GLOBAL.SCREENSHOT_TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.SCREENSHOTS.DESCRIPTION",img:"/assets/images/features-info/screenshots.svg",link:"https://clockify.me/help/extra-features/screenshots"},{type:is.a.CUSTOM_FIELDS,title:"GLOBAL.CUSTOM_FIELDS_LABEL",text:"SHARED_MODULES.FEATURES_INFO_TYPES.CUSTOM_FIELDS.DESCRIPTION",img:"/assets/images/features-info/custom_fields_upgrade.svg",link:"https://clockify.me/help/extra-features/custom-fields"},{type:is.a.WHO_CAN_SEE_ALL_TIME_ENTRIES,title:"SHARED_MODULES.FEATURES_INFO_TYPES.HIDE_TIME_FROM_USERS.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.HIDE_TIME_FROM_USERS.DESCRIPTION",img:"/assets/images/features-info/private_entries.svg",link:"https://clockify.me/help/extra-features/private-time-entries"},{type:is.a.BRANDED_REPORTS,title:"SHARED_MODULES.FEATURES_INFO_TYPES.BRANDED_REPORTS.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.BRANDED_REPORTS.DESCRIPTION",img:"/assets/images/features-info/branded_reports.svg",link:"https://clockify.me/help/extra-features/branded-reports"},{type:is.a.SSO,title:"SHARED_MODULES.FEATURES_INFO_TYPES.SSO.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.SSO.DESCRIPTION",img:"/assets/images/features-info/sso-info.svg",link:"https://clockify.me/help/extra-features/single-sign-on"},{type:is.a.CUSTOM_SUBDOMAIN,title:"SHARED_MODULES.FEATURES_INFO_TYPES.CUSTOM_SUBDOMAIN.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.CUSTOM_SUBDOMAIN.DESCRIPTION",img:"/assets/images/features-info/subdomain-info.svg",link:""},{type:is.a.ADMIN_PANEL,title:"SHARED_MODULES.FEATURES_INFO_TYPES.CONTROL_ACCOUNTS.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.CONTROL_ACCOUNTS.DESCRIPTION",img:"/assets/images/features-info/accounts-info.svg",link:"https://clockify.me/help/extra-features/manage-accounts"},{type:is.a.DECIMAL_FORMAT,title:"SHARED_MODULES.FEATURES_INFO_TYPES.DECIMAL_FORMAT.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.DECIMAL_FORMAT.DESCRIPTION",img:"/assets/images/features-info/decimal.svg",link:"https://clockify.me/help/extra-features/decimal-format"},{type:is.a.TIME_OFF,title:"Time off",text:"Define time off policies and holidays, submit and approve leave requests, see who's away and when, and track accruals and remaining balances.",img:"/assets/images/features-info/pto.svg",link:"https://clockify.me/help/extra-features/time-off"},{type:is.a.EXPENSES,title:"EXPENSES.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.EXPENSES.DESCRIPTION",img:"/assets/images/features-info/expenses.svg",link:"https://clockify.me/help/extra-features/expenses"},{type:is.a.SCHEDULING,title:"SCHEDULING.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.SCHEDULING.DESCRIPTION",img:"/assets/images/features-info/scheduling.png",link:"https://clockify.me/help/extra-features/scheduling"},{type:is.a.AUDIT_LOG,title:"AUDIT_LOG.AUDIT_LOG_LABEL",text:"SHARED_MODULES.FEATURES_INFO_TYPES.AUDIT_LOG.DESCRIPTION",img:"/assets/images/features-info/audit_log_illustration.svg",link:"https://clockify.me/help/extra-features/audit-log"},{type:is.a.EDIT_MEMBER_PROFILE,title:"SHARED_MODULES.FEATURES_INFO_TYPES.EDIT_MEMBER_PROFILE.TITLE",text:"SHARED_MODULES.FEATURES_INFO_TYPES.EDIT_MEMBER_PROFILE.DESCRIPTION",img:"/assets/images/features-info/edit_user_profile.svg",link:"https://clockify.me/help/extra-features/edit-profiles"}],mC=[is.a.ADD_TIME_FOR_OTHERS,"hide-and-time-and-page",is.a.WORKSPACE_TIME_AUDIT,is.a.REQUIRED_FIELDS,is.a.PROJECT_TEMPLATES,is.a.BULK_EDIT,is.a.HISTORIC_RATES,is.a.WHO_CAN_SEE_PROJECT_STATUS,is.a.CUSTOM_REPORTING,is.a.DECIMAL_FORMAT,is.a.FILE_IMPORT,is.a.EDIT_MEMBER_PROFILE],gC=hC.filter(e=>mC.includes(e.type)),EC=["automatic-and-manual-lock",is.a.APPROVAL,is.a.MANAGER_ROLE,is.a.TARGETS_AND_REMINDERS,is.a.WORKSPACE_TIME_ROUNDING,is.a.TASK_RATES,is.a.INVOICING,is.a.QUICKBOOKS_INTEGRATION,is.a.TIME_OFF],fC=hC.filter(e=>EC.includes(e.type)),SC=[is.a.LABOR_COST,is.a.SCHEDULED_REPORTS,is.a.PROJECT_BUDGET,is.a.ALERTS,is.a.DISABLE_MANUAL_MODE,is.a.LOCATIONS,is.a.SCREENSHOTS,is.a.CUSTOM_FIELDS,is.a.SUMMARY_ESTIMATE,is.a.EXPENSES,is.a.SCHEDULING],CC=hC.filter(e=>SC.includes(e.type)),AC=[is.a.SSO,is.a.CUSTOM_SUBDOMAIN,is.a.ADMIN_PANEL,is.a.AUDIT_LOG],OC=hC.filter(e=>AC.includes(e.type)),vC=[is.a.WHO_CAN_SEE_ALL_TIME_ENTRIES,is.a.WORKSPACE_LOCK_TIMEENTRIES,is.a.REQUIRED_FIELDS,is.a.WORKSPACE_TIME_ROUNDING,is.a.WORKSPACE_TIME_AUDIT,is.a.BRANDED_REPORTS,is.a.TARGETS_AND_REMINDERS,is.a.WHO_CAN_SEE_PROJECT_STATUS,is.a.DECIMAL_FORMAT],TC=hC.filter(e=>vC.includes(e.type)),IC=[is.a.ADD_TIME_FOR_OTHERS,is.a.PROJECT_TEMPLATES,is.a.ALERTS,is.a.BULK_EDIT,is.a.HIDE_PAGES,is.a.AUTOMATIC_LOCK,is.a.CUSTOM_REPORTING],wC=hC.filter(e=>IC.includes(e.type)),LC=[is.a.SSO,is.a.ADMIN_PANEL,is.a.CUSTOM_SUBDOMAIN,is.a.CUSTOM_FIELDS,is.a.LABOR_COST,is.a.APPROVAL,is.a.MANAGER_ROLE,is.a.SCHEDULED_REPORTS,is.a.FILE_IMPORT,is.a.DISABLE_MANUAL_MODE,is.a.PROJECT_BUDGET,is.a.TASK_RATES,is.a.HISTORIC_RATES,is.a.INVOICING,is.a.SCREENSHOTS,is.a.LOCATIONS,is.a.QUICKBOOKS_INTEGRATION,is.a.SUMMARY_ESTIMATE],RC=hC.filter(e=>LC.includes(e.type));let yC=(()=>{class e{constructor(){this.close=new s.n}closeDialog(){this.close.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["subscription-incomplete-modal"]],outputs:{close:"close"},decls:11,vars:9,consts:[[1,"cl-modal-header"],[1,"cl-modal-body","cl-py-4"],[1,"cl-modal-footer"],["data-dismiss","modal",1,"cl-color-blue",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Zc(1),s.oc(2,"translate"),s.Wb(),s.Xb(3,"div",1),s.Xb(4,"p"),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Xb(7,"div",2),s.Xb(8,"a",3),s.jc("click",(function(){return t.closeDialog()})),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,3,"SHARED_MODULES.SUBSCRIPTION_INCOMPLETE_MODAL.TITLE"),"\n"),s.Cb(4),s.ad(s.pc(6,5,"SHARED_MODULES.SUBSCRIPTION_INCOMPLETE_MODAL.EXPLANATION")),s.Cb(4),s.ad(s.pc(10,7,"GLOBAL.CONFIRM_OK_BTN")))},pipes:[g.e],encapsulation:2}),e})();function _C(e,t){1&e&&(s.Xb(0,"div",12),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,1,"SHARED_FOLDER.LEGACY_WARNING")))}function kC(e,t){1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"SHARED_FOLDER.NO_REFUNDS")))}n("nslC");const WC=function(){return{standalone:!0}};function XC(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",13),s.Xb(1,"div",14),s.Xb(2,"input",15),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().agreement=t})),s.Wb(),s.Xb(3,"label",16),s.Xb(4,"span",17),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"span",18),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.wc("ngModel",e.agreement)("ngModelOptions",s.Ac(8,WC)),s.Cb(3),s.ad(s.pc(6,4,"GLOBAL.TOS_READ")),s.Cb(3),s.ad(s.pc(9,6,"GLOBAL.REFUNDS_EXPLANATION"))}}const NC=function(e){return{title:e}};let DC=(()=>{class e{constructor(e){this.translate=e,this.closeModal=new s.n,this.pay=new s.n,this.isEnterprise=mo.e,this.isMonthly=mo.h,this.expandForSeats=!1,this.agreement=!1}ngOnInit(){const e=this.translate.instant("SHARED_MODULES.SWITCHING_PLAN_MODAL.DOWNGRADE_BONUS");this.type.quantity=0,this.currentType=mo.a[this.workspace.featureSubscriptionType.replace("SPECIAL","PLUS")],this.type.title!==this.currentType.title||this.currentType.legacy?this.currentType.weight<this.type.weight?(this.buttonText="GLOBAL.UPGRADE_BTN",this.text=this.translate.instant("SHARED_MODULES.SWITCHING_PLAN_MODAL.UPGRADE_EXPLANATION",{price:this.price,feature:this.type.title.toUpperCase()})):(this.buttonText="GLOBAL.DOWNGRADE_BTN",this.text=this.translate.instant("SHARED_MODULES.SWITCHING_PLAN_MODAL.DOWNGRADE_EXPLANATION")+(Object(mo.h)(this.currentType.value)&&!Object(mo.h)(this.type.value)?" "+e:"")):(this.buttonText=this.type.weight<this.currentType.weight?"SHARED_MODULES.SWITCHING_PLAN_MODAL.PAYMENT_INTERVAL_MONTHLY":"SHARED_MODULES.SWITCHING_PLAN_MODAL.PAYMENT_INTERVAL_ANNUALLY",this.text=this.type.weight<this.currentType.weight?this.translate.instant("SHARED_MODULES.SWITCHING_PLAN_MODAL.MONTHLY_BILLING_EXPLANATION"):this.translate.instant("SHARED_MODULES.SWITCHING_PLAN_MODAL.BILLING_PRICE",{price:this.price})+(this.type.weight<this.currentType.weight?" ":this.translate.instant("SHARED_MODULES.SWITCHING_PLAN_MODAL.BILLING_SAVINGS",{savings:"20%"}))),this.type===this.currentType&&(this.buttonText="GLOBAL.REACTIVATE_BUTTON",this.text="SHARED_MODULES.SWITCHING_PLAN_MODAL.REACTIVATE_SUBSCRIPTION")}close(){this.closeModal.emit(!0)}continue(){this.pay.emit(this.type)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["switching-plan"]],inputs:{type:"type",workspace:"workspace",disableButton:"disableButton",price:"price"},outputs:{closeModal:"closeModal",pay:"pay"},decls:25,vars:22,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],[1,"cl-text-gray-9"],["type","button",1,"cl-close",3,"click"],["src","assets/ui-icons/close.svg"],[1,"cl-modal-body"],["class","cl-alert cl-alert-warning cl-alert-reset-main cl-alert-dismissible cl-fade cl-show cl-my-3 cl-p-2 cl-mx-0",4,"ngIf"],[4,"ngIf"],["class","cl-mt-3",4,"ngIf"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[1,"cl-alert","cl-alert-warning","cl-alert-reset-main","cl-alert-dismissible","cl-fade","cl-show","cl-my-3","cl-p-2","cl-mx-0"],[1,"cl-mt-3"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline"],["type","checkbox","id","agreementCheckbox",1,"cl-custom-control-input",3,"ngModel","ngModelOptions","ngModelChange"],["for","agreementCheckbox",1,"cl-custom-control-label"],[1,"cl-font-weight-bold"],[1,"cl-color-grey","cl-d-block"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"span",2),s.Zc(5),s.oc(6,"lowercase"),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xb(8,"button",3),s.jc("click",(function(){return t.close()})),s.Xb(9,"span"),s.Sb(10,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(11,"div",5),s.Xc(12,_C,4,3,"div",6),s.Xb(13,"div"),s.Xb(14,"p"),s.Zc(15),s.Xc(16,kC,3,3,"span",7),s.Wb(),s.Wb(),s.Xc(17,XC,10,9,"div",8),s.Wb(),s.Xb(18,"div",9),s.Xb(19,"a",10),s.jc("click",(function(){return t.close()})),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Xb(22,"button",11),s.jc("click",(function(){return t.continue()})),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd("",s.qc(3,9,"SHARED_MODULES.SWITCHING_PLAN_MODAL.TITLE",s.Bc(20,NC,t.type.title))," "),s.Cb(3),s.bd(" (",s.pc(6,12,s.pc(7,14,t.type.label.includes("YEAR")?"GLOBAL.PAY_YEARLY_LABEL":"GLOBAL.MONTHLY_LABEL")),") "),s.Cb(7),s.wc("ngIf",t.currentType&&t.currentType.legacy),s.Cb(3),s.bd("",t.text,". "),s.Cb(1),s.wc("ngIf",t.type.weight<t.currentType.weight),s.Cb(1),s.wc("ngIf",t.type.weight>=t.currentType.weight),s.Cb(3),s.ad(s.pc(21,16,"GLOBAL.NEVERMIND_CANCEL_BTN")),s.Cb(2),s.wc("disabled",t.disableButton||!t.agreement&&t.type.weight>=t.currentType.weight),s.Cb(1),s.bd("",s.pc(24,18,t.buttonText)," "))},directives:[i.u,v.a,v.s,v.v],pipes:[g.e,i.q],encapsulation:2}),e})();function PC(e,t){if(1&e&&(s.Xb(0,"div",10),s.Sb(1,"img",11),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.xc("src",e.typeObject.img,s.Qc)}}function MC(e,t){if(1&e&&(s.Xb(0,"a",12),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.xc("href",e.typeObject.link,s.Qc),s.Cb(1),s.bd(" ",s.pc(2,2,"GLOBAL.LEARN_MORE_LINK"),"")}}let BC=(()=>{class e{constructor(){this.close=new s.n}closeDialog(){this.close.emit(!0)}ngOnInit(){const e=hC.find(e=>e.type===this.type)||[pC].find(e=>e.type===this.type);e?this.typeObject=e:this.closeDialog()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["features-info"]],inputs:{type:"type"},outputs:{close:"close"},decls:15,vars:11,consts:[[1,"cl-modal-body","cl-py-4"],[1,"cl-row","cl-align-items-center","cl-justify-content-between"],[1,"cl-col","cl-mb-3","cl-mb-lg-0"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-text-gray-3","cl-mb-0",3,"innerHTML"],[1,"cl-col-lg-4"],["class","cl-rounded-circle cl-p-2 cl-border",4,"ngIf"],[1,"cl-modal-footer"],["data-dismiss","modal",1,"cl-color-blue",3,"click"],["class","cl-btn cl-btn-primary","ngbAutofocus","","target","_blank",3,"href",4,"ngIf"],[1,"cl-rounded-circle","cl-p-2","cl-border"],[1,"cl-w-100","cl-rounded-circle",3,"src"],["ngbAutofocus","","target","_blank",1,"cl-btn","cl-btn-primary",3,"href"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Sb(6,"p",4),s.oc(7,"translate"),s.Wb(),s.Xb(8,"div",5),s.Xc(9,PC,2,1,"div",6),s.Wb(),s.Wb(),s.Wb(),s.Xb(10,"div",7),s.Xb(11,"a",8),s.jc("click",(function(){return t.closeDialog()})),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xc(14,MC,3,4,"a",9),s.Wb()),2&e&&(s.Cb(4),s.ad(s.pc(5,5,t.typeObject.title)),s.Cb(2),s.xc("innerHTML",s.pc(7,7,t.typeObject.text),s.Pc),s.Cb(3),s.wc("ngIf",t.typeObject.img),s.Cb(3),s.ad(s.pc(13,9,"GLOBAL.CLOSE_BTN")),s.Cb(2),s.wc("ngIf",t.typeObject.link))},directives:[i.u],pipes:[g.e],encapsulation:2}),e})();const UC=["featuresInfoModal"],GC=["upgradeModal"],xC=["confirmUpgradeModal"],FC=["subscriptionFailedModal"];function jC(e,t){1&e&&(s.Xb(0,"div"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"SHARED_MODULES.UPGRADE_PLANS.CHOOSE_YEARLY_PLAN_INFO")," "))}function ZC(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Xb(3,"span",44),s.Zc(4),s.Wb(),s.Zc(5),s.oc(6,"translate"),s.Xc(7,jC,3,3,"div",45),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.pc(2,5,"SHARED_MODULES.UPGRADE_PLANS.ALREADY_USING_PLAN.PART_1")," "),s.Cb(2),s.wc("ngClass",e.currentPaymentType.colorText),s.Cb(1),s.ad(e.currentPaymentType.title),s.Cb(1),s.bd("",s.pc(6,7,"SHARED_MODULES.UPGRADE_PLANS.ALREADY_USING_PLAN.PART_2")," "),s.Cb(2),s.wc("ngIf","ENTERPRISE"!==e.currentPaymentType.value)}}const VC=function(e){return{name:e}};function YC(e,t){if(1&e&&(s.Zc(0),s.oc(1,"translate")),2&e){const e=s.nc();s.bd(" ",s.qc(1,1,"SHARED_MODULES.UPGRADE_PLANS.UPGRADE_WORKSPACE_WITH_PARAM_INFO",s.Bc(4,VC,e.workspace.name))," ")}}function HC(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",46),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.goToPayment(t.isMonthly?t.paymentType.BASIC_2021.label:t.paymentType.BASIC_YEAR_2021.label)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.pc(2,1,e.isMonthly?e.paymentType.BASIC_2021.button:e.paymentType.BASIC_YEAR_2021.button)," ")}}function $C(e,t){1&e&&(s.Xb(0,"span",47),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"SHARED_MODULES.UPGRADE_PLANS.SUBSCRIBED_LABEL"),""))}function KC(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",49),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().openFeaturesInfo(t.type)})),s.Sb(1,"img",38),s.Wb()}}function qC(e,t){if(1&e&&(s.Xb(0,"li"),s.Xb(1,"span",30),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,KC,2,0,"a",48),s.Wb()),2&e){const e=t.$implicit;s.Cb(2),s.ad(s.pc(3,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function zC(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",46),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.goToPayment(t.isMonthly?t.paymentType.STANDARD_2021.label:t.paymentType.STANDARD_YEAR_2021.label)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.pc(2,1,e.isMonthly?e.paymentType.STANDARD_2021.button:e.paymentType.STANDARD_YEAR_2021.button)," ")}}function QC(e,t){1&e&&(s.Xb(0,"span",47),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"SHARED_MODULES.UPGRADE_PLANS.SUBSCRIBED_LABEL"),""))}function JC(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",49),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().openFeaturesInfo(t.type)})),s.Sb(1,"img",38),s.Wb()}}function eA(e,t){if(1&e&&(s.Xb(0,"li"),s.Xb(1,"span",30),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,JC,2,0,"a",48),s.Wb()),2&e){const e=t.$implicit;s.Cb(2),s.ad(s.pc(3,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function tA(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",46),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.goToPayment(t.isMonthly?t.paymentType.PRO_2021.label:t.paymentType.PRO_YEAR_2021.label)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.pc(2,1,e.isMonthly?e.paymentType.PRO_2021.button:e.paymentType.PRO_YEAR_2021.button)," ")}}function nA(e,t){1&e&&(s.Xb(0,"span",47),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"SHARED_MODULES.UPGRADE_PLANS.SUBSCRIBED_LABEL"),""))}function iA(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",49),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().openFeaturesInfo(t.type)})),s.Sb(1,"img",38),s.Wb()}}function sA(e,t){if(1&e&&(s.Xb(0,"li"),s.Xb(1,"span",30),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,iA,2,0,"a",48),s.Wb()),2&e){const e=t.$implicit;s.Cb(2),s.ad(s.pc(3,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function cA(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",46),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.goToPayment(t.isMonthly?t.paymentType.ENTERPRISE_2021.label:t.paymentType.ENTERPRISE_YEAR_2021.label)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.pc(2,1,e.isMonthly?e.paymentType.ENTERPRISE_2021.button:e.paymentType.ENTERPRISE_YEAR_2021.button)," ")}}function aA(e,t){1&e&&(s.Xb(0,"span",47),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"SHARED_MODULES.UPGRADE_PLANS.SUBSCRIBED_LABEL"),""))}function oA(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",49),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().openFeaturesInfo(t.type)})),s.Sb(1,"img",38),s.Wb()}}function rA(e,t){if(1&e&&(s.Xb(0,"li"),s.Xb(1,"span",30),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,oA,2,0,"a",48),s.Wb()),2&e){const e=t.$implicit;s.Cb(2),s.ad(s.pc(3,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function lA(e,t){if(1&e&&(s.Xb(0,"simple-modal",50),s.jc("confirmed",(function(){return t.$implicit.close(!0)}))("close",(function(){return t.$implicit.close(!1)})),s.oc(1,"translate"),s.oc(2,"translate"),s.oc(3,"translate"),s.Xb(4,"p",51),s.Zc(5),s.oc(6,"translate"),s.Xb(7,"strong"),s.Zc(8),s.Wb(),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.wc("title",s.pc(1,6,"GLOBAL.UPGRADE_BTN"))("btnText",s.pc(2,8,"GLOBAL.UPGRADE_BTN"))("btnCancel",s.pc(3,10,"GLOBAL.NEVERMIND_CANCEL_BTN")),s.Cb(5),s.bd(" ",s.pc(6,12,"SHARED_MODULES.UPGRADE_PLANS.UPGRADE_PART_1"),""),s.Cb(3),s.ad(e.workspace.name),s.Cb(1),s.bd("",s.pc(10,14,"SHARED_MODULES.UPGRADE_PLANS.UPGRADE_PART_2")," ")}}function bA(e,t){1&e&&(s.Xb(0,"subscription-incomplete-modal",52),s.jc("close",(function(){return t.$implicit.close()})),s.Wb())}function dA(e,t){if(1&e){const e=s.Yb();s.Xb(0,"switching-plan",53),s.jc("pay",(function(t){return s.Oc(e),s.nc().pay(t)}))("closeModal",(function(){return t.$implicit.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("disableButton",e.upgradeInProgress)("workspace",e.workspace)("type",e.plan)("price",e.price)}}function uA(e,t){if(1&e&&(s.Xb(0,"features-info",54),s.jc("close",(function(){return t.$implicit.close()})),s.Wb()),2&e){const e=s.nc();s.wc("type",e.featuresInfoType)}}let pA=(()=>{class e{constructor(e,t,n,i,c,a,o,r,l){this.workspaceService=e,this.paymentService=t,this.toaster=n,this.loader=i,this.router=c,this.modalService=a,this.translateService=o,this.activeRoute=r,this.analyticsService=l,this.onDestroy=new s.n,this.unsubscribe$=new Fn.a,this.BASIC_2021_FEATURE_TYPES=gC,this.STANDARD_2021_FEATURE_TYPES=fC,this.PRO_2021_FEATURE_TYPES=CC,this.ENTERPRISE_2021_FEATURE_TYPES=OC,this.paymentType=mo.a,this.hasPaymentInfo$=new Ge.a(null)}ngOnInit(){this.scaledPlan="standard",this.getBasicFromButton(),"Basic"===this.isBasic&&(this.scaledPlan="basic"),this.subscribeToAllWorkspaces(),this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e,Object(mo.m)(this.workspace.featureSubscriptionType),this.isMonthly=Object(mo.h)(this.workspace.featureSubscriptionType),this.currentPaymentType=Object(mo.c)(this.workspace.featureSubscriptionType),"Basic"!==this.isBasic&&(null===this.workspace.featureSubscriptionType||"TRIAL"===this.workspace.featureSubscriptionType||"BASIC_2021"===this.workspace.featureSubscriptionType?this.scaledPlan="standard":"STANDARD_2021"===this.workspace.featureSubscriptionType?this.scaledPlan="pro":"PRO_2021"===this.workspace.featureSubscriptionType&&(this.scaledPlan="enterprise"));const t=this.activeRoute.snapshot.queryParamMap.get("plan");null!==t&&(this.scaledPlan=t)}),this.paymentService.everHadSubscription.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{e?this.getPaymentInformation():this.hasPaymentInfo$.next(!0)}),this.paymentService.everHadPaidSubscription.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>this.everHadPaidSubscription=e),this.paymentService.getEverHadSubscription()}getBasicFromButton(){this.workspaceService.sharedgetBasicPlanUpgrade().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isBasic=e})}ngOnDestroy(){this.loader.hideBar(),this.onDestroy.emit(),this.unsubscribe$.next(!0),this.unsubscribe$.complete()}getPaymentInformation(){this.paymentService.getPaymentInformation(this.workspace.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.paymentInformation=e,this.hasPaymentInfo$.next(!0)},()=>this.loader.hideBar())}openFeaturesInfo(e){this.featuresInfoType=e,this.modalService.open(this.featuresInfoModal,{size:"lg",centered:!0})}goToPayment(e){this.paymentInformation||this.loader.showBar();const t=new p.a;Object(uC.a)(t,this.hasPaymentInfo$.pipe(Object(Zt.a)(e=>e))).pipe(Object(ln.a)(1),Object(d.a)(e=>e[0]),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.loader.hideBar(),this.handleUpgradePlan(e)}),t.next(e)}handleUpgradePlan(e){var t,n,i;if(this.workspace.featureSubscriptionType&&this.workspace.featureSubscriptionType!==mo.b.TRIAL&&this.paymentInformation.cardHolder)this.plan=this.paymentType[e],this.loader.show(),this.paymentService.previewPrice(this.plan.value,this.workspace.memberships.filter(e=>e.isActiveOrPending).length).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{var t,n,i,s,c;this.price=e.price,this.loader.hide();const a=new Fi.a({event:"begin_checkout",uevent:"begin_checkout",value:"begin_checkout",ecommerce:{transaction_id:null===(t=this.plan)||void 0===t?void 0:t.value,action:(null===(n=this.plan)||void 0===n?void 0:n.button.includes("DOWNGRADE"))?"downgrade":"upgrade",value:e.price,currency:"USD",items:[{index:null===(i=this.plan)||void 0===i?void 0:i.index,item_name:null===(s=this.plan)||void 0===s?void 0:s.value,price:null===(c=this.plan)||void 0===c?void 0:c.fullPrice,quantity:this.workspace.getWorkspaceSeats()}]}});this.analyticsService.addEvent(a),this.modalService.open(this.upgradeModal,{centered:!0})});else{if(!(this.numberOfWorkspaces>1)||this.everHadPaidSubscription)return void this.navigateToUpgrade(e);this.analyticsService.addEvent(new Fi.a({event:"select_item",ecommerce:{items:[{index:null===(t=this.paymentType[e])||void 0===t?void 0:t.index,item_name:null===(n=this.paymentType[e])||void 0===n?void 0:n.value,price:null===(i=this.paymentType[e])||void 0===i?void 0:i.fullPrice,quantity:this.workspace.getWorkspaceSeats()}]}})),this.modalService.open(this.confirmUpgradeModal,{centered:!0}).result.then(t=>{t&&this.navigateToUpgrade(e)}).catch(e=>{})}}navigateToUpgrade(e){this.router.navigate(["upgrade",this.workspace.id],{queryParams:{plan:e}})}changeToMonthly(e){this.isMonthly=e}pay(e){if(this.upgradeInProgress)return;this.upgradeInProgress=!0,this.loader.show("GLOBAL.PROCESSING_PAYMENT_MESSAGE_TITLE");const t=e.quantity+this.workspace.memberships.filter(e=>e.isActiveOrPending).length;this.paymentService.chargeCard(this.paymentInformation,t,e.value).subscribe(()=>{var n,i,s;this.loader.hide(),this.upgradeInProgress=!1,(null==e?void 0:e.button.includes("DOWNGRADE"))?this.analyticsService.addEvent(new Fi.a({event:"refund",value:"refund",uevent:"refund",ecommerce:{transaction_id:null===(n=this.plan)||void 0===n?void 0:n.value,action:"downgrade",value:((null==e?void 0:e.fullPrice)-(null===(i=mo.a[this.workspace.featureSubscriptionType])||void 0===i?void 0:i.fullPrice))*t,currency:"USD",items:[{index:null==e?void 0:e.index,item_name:null==e?void 0:e.value,price:null==e?void 0:e.fullPrice,quantity:t}]}})):this.analyticsService.addEvent(new Fi.a({event:"purchase",value:"purchase",uevent:"purchase",ecommerce:{transaction_id:null===(s=this.plan)||void 0===s?void 0:s.value,action:"upgrade",value:((null==e?void 0:e.fullPrice)-mo.a[this.workspace.featureSubscriptionType].fullPrice)*t,currency:"USD",items:[{index:null==e?void 0:e.index,item_name:null==e?void 0:e.value,price:null==e?void 0:e.fullPrice,quantity:t}]}})),this.modalService.dismissAll(),this.toaster.pop("success",this.translateService.instant("SHARED_MODULES.UPGRADE_PLANS.UPGRADE_SUCCESSFUL_MSG",{planName:e.title})),this.onPaymentSuccess()},e=>{e.error&&e.error.message&&e.error.message.includes("incomplete")?this.modalService.open(this.subscriptionFailedModal):this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("GLOBAL.PROCESSING_FAILED_ERROR_MESSAGE")),this.loader.hide(),this.upgradeInProgress=!1})}onPaymentSuccess(){this.loader.showBar();const e=this.workspaceService.getPaymentDate(),t=this.workspaceService.getDefaultWorkspace();Object(Sb.a)(e,t).pipe(Object(ln.a)(1)).subscribe(()=>{this.loader.hideBar(),this.router.navigate(["subscription"],{fragment:"payment"})},()=>this.loader.hideBar())}subscribeToAllWorkspaces(){this.workspaceService.workspaces$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>this.numberOfWorkspaces=e.length)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(dC.a),s.Rb(r.a),s.Rb(Hn.a),s.Rb(k.d),s.Rb(w.q),s.Rb(g.f),s.Rb(k.a),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["upgrade-plans"]],viewQuery:function(e,t){var n;1&e&&(s.gd(UC,!0),s.gd(GC,!0),s.gd(xC,!0),s.gd(FC,!0)),2&e&&(s.Kc(n=s.kc())&&(t.featuresInfoModal=n.first),s.Kc(n=s.kc())&&(t.upgradeModal=n.first),s.Kc(n=s.kc())&&(t.confirmUpgradeModal=n.first),s.Kc(n=s.kc())&&(t.subscriptionFailedModal=n.first))},outputs:{onDestroy:"onDestroy"},decls:170,vars:93,consts:[[1,"cl-text-center","cl-mt-4"],[1,"cl-display-1"],[1,"cl-lead","cl-text-gray-6","cl-w-75","cl-mx-auto"],[4,"ngIf","ngIfElse"],["noPlanHeaderTemplate",""],[1,"cl-my-5"],[1,"cl-btn-group","cl-btn-group-toggle","cl-upgrade-switchers"],[1,"cl-btn","cl-btn-outline-light","cl-hover-pointer",3,"click"],["type","radio"],[1,"cl-badge","cl-badge-success","cl-ml-2"],[1,"cl-row","cl-row-cards","cl-justify-content-center"],[1,"cl-col-lg-6","cl-col-lg-custom-3","cl-p-0","cl-parent-grey",3,"ngClass"],[1,"cl-card","cl-border-top","cl-w-100","cl-border-bottom-grey"],[1,"cl-border-0","cl-bg-transparent","cl-pt-3","cl-text-center"],[1,"cl-h1","cl-font-weight-bold","cl-mb-0","cl-text-color"],[1,"cl-h3","cl-mb-0","cl-text-color"],[1,"cl-card-body","cl-px-3","cl-pt-0"],[1,"cl-d-flex","cl-text-center","cl-justify-content-center","cl-my-3"],[1,"cl-d-flex","cl-text-center","cl-mr-2","cl-text-color"],[1,"cl-mr-1","cl-text-color"],[1,"cl-display-1","cl-lh-1","cl-mb-0","cl-text-gray-3","cl-text-color"],[1,"cl-d-flex","cl-justify-content-center","cl-text-color"],[1,"cl-h3","cl-text-color"],["data-cy","basic-plan",1,"cl-px-2","cl-py-3","cl-bg-transparent"],["class","cl-btn cl-btn cl-btn-block cl-btn-color",3,"click",4,"ngIf"],["class","cl-btn cl-btn-block cl-text-uppercase cl-text-color",4,"ngIf"],[1,"cl-list-unstyled","cl-add-lh","cl-padding"],[4,"ngFor","ngForOf"],[1,"cl-col-lg-6","cl-col-lg-custom-3","cl-p-0","cl-parent-blue",3,"ngClass"],["data-cy","standard-plan",1,"cl-px-2","cl-py-3","cl-bg-transparent"],[1,"cl-color-grey"],[1,"cl-col-lg-6","cl-col-lg-custom-3","cl-p-0","cl-parent-red",3,"ngClass"],["data-cy","pro-plan",1,"cl-px-2","cl-py-3","cl-bg-transparent"],[1,"cl-col-lg-6","cl-col-lg-custom-3","cl-p-0","cl-parent-purple",3,"ngClass"],[1,"cl-card-body","cl-px-3","cl-pt-0","cl-position-relative"],["data-cy","enterprise-plan",1,"cl-px-2","cl-py-3","cl-bg-transparent"],[1,"cl-text-center","cl-card-last"],["href","https://clockify.me/self-hosted-time-tracking-software","target","_blank",1,"cl-ml-1","cl-d-inline-flex"],["src","assets/images/ui-icons/info-9.svg"],["href","https://clockify.me/help/contact/sales","target","_blank",1,"cl-text-color"],["confirmUpgradeModal",""],["subscriptionFailedModal",""],["upgradeModal",""],["featuresInfoModal",""],[3,"ngClass"],[4,"ngIf"],[1,"cl-btn","cl-btn","cl-btn-block","cl-btn-color",3,"click"],[1,"cl-btn","cl-btn-block","cl-text-uppercase","cl-text-color"],["class","cl-ml-1 cl-d-inline-flex",3,"click",4,"ngIf"],[1,"cl-ml-1","cl-d-inline-flex",3,"click"],[3,"title","btnText","btnCancel","confirmed","close"],[1,"cl-text-dark","cl-mb-0"],[3,"close"],[3,"disableButton","workspace","type","price","pay","closeModal"],[3,"type","close"]],template:function(e,t){if(1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"p",2),s.Xc(5,ZC,8,9,"ng-container",3),s.Xc(6,YC,2,6,"ng-template",null,4,s.Yc),s.Wb(),s.Xb(8,"div",5),s.Xb(9,"div",6),s.Xb(10,"label",7),s.jc("click",(function(){return t.changeToMonthly(!0)})),s.Sb(11,"input",8),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xb(14,"label",7),s.jc("click",(function(){return t.changeToMonthly(!1)})),s.Sb(15,"input",8),s.Zc(16),s.oc(17,"translate"),s.Xb(18,"span",9),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(21,"div",10),s.Xb(22,"div",11),s.Xb(23,"div",12),s.Xb(24,"div",13),s.Xb(25,"span",14),s.Zc(26),s.oc(27,"translate"),s.Wb(),s.Wb(),s.Xb(28,"div",13),s.Xb(29,"span",15),s.Zc(30),s.oc(31,"translate"),s.Wb(),s.Wb(),s.Xb(32,"div",16),s.Xb(33,"div",17),s.Xb(34,"div",18),s.Xb(35,"span",19),s.Zc(36,"$"),s.Wb(),s.Xb(37,"span",20),s.Zc(38),s.Wb(),s.Xb(39,"span"),s.Zc(40),s.Wb(),s.Wb(),s.Wb(),s.Xb(41,"div",21),s.Xb(42,"div"),s.Xb(43,"div",22),s.Zc(44),s.oc(45,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(46,"div",23),s.Xc(47,HC,3,3,"a",24),s.Xc(48,$C,3,3,"span",25),s.Wb(),s.Xb(49,"ul",26),s.Xc(50,qC,5,4,"li",27),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(51,"div",28),s.Xb(52,"div",12),s.Xb(53,"div",13),s.Xb(54,"span",14),s.Zc(55),s.oc(56,"translate"),s.Wb(),s.Wb(),s.Xb(57,"div",13),s.Xb(58,"span",15),s.Zc(59),s.oc(60,"translate"),s.Wb(),s.Wb(),s.Xb(61,"div",16),s.Xb(62,"div",17),s.Xb(63,"div",18),s.Xb(64,"span",19),s.Zc(65,"$"),s.Wb(),s.Xb(66,"span",20),s.Zc(67),s.Wb(),s.Xb(68,"span"),s.Zc(69),s.Wb(),s.Wb(),s.Wb(),s.Xb(70,"div",21),s.Xb(71,"div"),s.Xb(72,"div",22),s.Zc(73),s.oc(74,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(75,"div",29),s.Xc(76,zC,3,3,"a",24),s.Xc(77,QC,3,3,"span",25),s.Wb(),s.Xb(78,"ul",26),s.Xb(79,"li"),s.Xb(80,"span",30),s.Zc(81),s.oc(82,"translate"),s.Wb(),s.Wb(),s.Xc(83,eA,5,4,"li",27),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(84,"div",31),s.Xb(85,"div",12),s.Xb(86,"div",13),s.Xb(87,"span",14),s.Zc(88),s.oc(89,"translate"),s.Wb(),s.Wb(),s.Xb(90,"div",13),s.Xb(91,"span",15),s.Zc(92),s.oc(93,"translate"),s.Wb(),s.Wb(),s.Xb(94,"div",16),s.Xb(95,"div",17),s.Xb(96,"div",18),s.Xb(97,"span",19),s.Zc(98,"$"),s.Wb(),s.Xb(99,"span",20),s.Zc(100),s.Wb(),s.Xb(101,"span"),s.Zc(102),s.Wb(),s.Wb(),s.Wb(),s.Xb(103,"div",21),s.Xb(104,"div"),s.Xb(105,"div",22),s.Zc(106),s.oc(107,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(108,"div",32),s.Xc(109,tA,3,3,"a",24),s.Xc(110,nA,3,3,"span",25),s.Wb(),s.Xb(111,"ul",26),s.Xb(112,"li"),s.Xb(113,"span",30),s.Zc(114),s.oc(115,"translate"),s.Wb(),s.Wb(),s.Xc(116,sA,5,4,"li",27),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(117,"div",33),s.Xb(118,"div",12),s.Xb(119,"div",13),s.Xb(120,"span",14),s.Zc(121),s.oc(122,"translate"),s.Wb(),s.Wb(),s.Xb(123,"div",13),s.Xb(124,"span",15),s.Zc(125),s.oc(126,"translate"),s.Wb(),s.Wb(),s.Xb(127,"div",34),s.Xb(128,"div",17),s.Xb(129,"div",18),s.Xb(130,"span",19),s.Zc(131,"$"),s.Wb(),s.Xb(132,"span",20),s.Zc(133),s.Wb(),s.Xb(134,"span"),s.Zc(135),s.Wb(),s.Wb(),s.Wb(),s.Xb(136,"div",21),s.Xb(137,"div"),s.Xb(138,"div",22),s.Zc(139),s.oc(140,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(141,"div",35),s.Xc(142,cA,3,3,"a",24),s.Xc(143,aA,3,3,"span",25),s.Wb(),s.Xb(144,"ul",26),s.Xb(145,"li"),s.Xb(146,"span",30),s.Zc(147),s.oc(148,"translate"),s.Wb(),s.Wb(),s.Xc(149,rA,5,4,"li",27),s.Wb(),s.Xb(150,"div",36),s.Sb(151,"hr"),s.Xb(152,"div"),s.Xb(153,"span"),s.Zc(154),s.oc(155,"translate"),s.Wb(),s.Xb(156,"a",37),s.Sb(157,"img",38),s.Wb(),s.Wb(),s.Xb(158,"div"),s.Xb(159,"a",39),s.Zc(160),s.oc(161,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(162,lA,11,16,"ng-template",null,40,s.Yc),s.Xc(164,bA,1,0,"ng-template",null,41,s.Yc),s.Xc(166,dA,1,4,"ng-template",null,42,s.Yc),s.Xc(168,uA,1,1,"ng-template",null,43,s.Yc)),2&e){const e=s.Lc(7);s.Cb(2),s.ad(s.pc(3,51,"SHARED_MODULES.UPGRADE_PLANS.GET_MORE_PROMO")),s.Cb(3),s.wc("ngIf","FREE"!==t.currentPaymentType.value&&"TRIAL"!==t.currentPaymentType.value)("ngIfElse",e),s.Cb(5),s.Hb("cl-active",t.isMonthly),s.Cb(2),s.bd("",s.pc(13,53,"GLOBAL.MONTHLY_BILLING_LABEL")," "),s.Cb(2),s.Hb("cl-active",!t.isMonthly),s.Cb(2),s.bd("",s.pc(17,55,"GLOBAL.ANNUAL_BILLING_LABEL")," "),s.Cb(3),s.ad(s.pc(20,57,"GLOBAL.BILLING_SAVE")),s.Cb(3),s.wc("ngClass","basic"===t.scaledPlan?"cl-scale":""),s.Cb(4),s.ad(s.pc(27,59,"SHARED_MODULES.UPGRADE_PLANS.BASIC_LABEL")),s.Cb(4),s.ad(s.pc(31,61,"SHARED_MODULES.UPGRADE_PLANS.ADMIN_LABEL")),s.Cb(8),s.bd(" ",t.isMonthly?t.paymentType.BASIC_2021.price:t.paymentType.BASIC_YEAR_2021.price," "),s.Cb(2),s.ad(t.isMonthly?t.paymentType.BASIC_2021.fullPrice.toString().split(".")[1]:t.paymentType.BASIC_YEAR_2021.fullPrice.toString().split(".")[1]),s.Cb(4),s.bd(" ",s.pc(45,63,"SHARED_MODULES.UPGRADE_PLANS.PER_SEAT_MONTH_LABEL"),""),s.Cb(3),s.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.BASIC_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.BASIC_YEAR_2021.value),s.Cb(1),s.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.BASIC_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.BASIC_YEAR_2021.value),s.Cb(2),s.wc("ngForOf",t.BASIC_2021_FEATURE_TYPES),s.Cb(1),s.wc("ngClass","standard"===t.scaledPlan?"cl-scale":""),s.Cb(4),s.ad(s.pc(56,65,"SHARED_MODULES.UPGRADE_PLANS.STANDARD_LABEL")),s.Cb(4),s.ad(s.pc(60,67,"SHARED_MODULES.UPGRADE_PLANS.TIMESHEETING_BILLING_INFO")),s.Cb(8),s.bd(" ",t.isMonthly?t.paymentType.STANDARD_2021.price:t.paymentType.STANDARD_YEAR_2021.price," "),s.Cb(2),s.ad(t.isMonthly?t.paymentType.STANDARD_2021.fullPrice.toString().split(".")[1]:t.paymentType.STANDARD_YEAR_2021.fullPrice.toString().split(".")[1]),s.Cb(4),s.bd(" ",s.pc(74,69,"SHARED_MODULES.UPGRADE_PLANS.PER_SEAT_MONTH_LABEL"),""),s.Cb(3),s.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.STANDARD_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.STANDARD_YEAR_2021.value),s.Cb(1),s.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.STANDARD_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.STANDARD_YEAR_2021.value),s.Cb(4),s.ad(s.pc(82,71,"SHARED_MODULES.UPGRADE_PLANS.BASIC_FEATURES_TITLE")),s.Cb(2),s.wc("ngForOf",t.STANDARD_2021_FEATURE_TYPES),s.Cb(1),s.wc("ngClass","pro"===t.scaledPlan?"cl-scale":""),s.Cb(4),s.ad(s.pc(89,73,"SHARED_MODULES.UPGRADE_PLANS.PRO_LABEL")),s.Cb(4),s.ad(s.pc(93,75,"SHARED_MODULES.UPGRADE_PLANS.PROFIT_PRODUCTIVITY_INFO")),s.Cb(8),s.bd(" ",t.isMonthly?t.paymentType.PRO_2021.price:t.paymentType.PRO_YEAR_2021.price," "),s.Cb(2),s.ad(t.isMonthly?t.paymentType.PRO_2021.fullPrice.toString().split(".")[1]:t.paymentType.PRO_YEAR_2021.fullPrice.toString().split(".")[1]),s.Cb(4),s.bd(" ",s.pc(107,77,"SHARED_MODULES.UPGRADE_PLANS.PER_SEAT_MONTH_LABEL"),""),s.Cb(3),s.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.PRO_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.PRO_YEAR_2021.value),s.Cb(1),s.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.PRO_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.PRO_YEAR_2021.value),s.Cb(4),s.ad(s.pc(115,79,"SHARED_MODULES.UPGRADE_PLANS.STANDARD_FEATURE_TITLE")),s.Cb(2),s.wc("ngForOf",t.PRO_2021_FEATURE_TYPES),s.Cb(1),s.wc("ngClass","enterprise"===t.scaledPlan?"cl-scale":""),s.Cb(4),s.ad(s.pc(122,81,"GLOBAL.ENTERPRISE_LABEL_PART")),s.Cb(4),s.ad(s.pc(126,83,"SHARED_MODULES.UPGRADE_PLANS.CONTROL_SECURITY_LABEL")),s.Cb(8),s.bd(" ",t.isMonthly?t.paymentType.ENTERPRISE_2021.price:t.paymentType.ENTERPRISE_YEAR_2021.price," "),s.Cb(2),s.ad(t.isMonthly?t.paymentType.ENTERPRISE_2021.fullPrice.toString().split(".")[1]:t.paymentType.ENTERPRISE_YEAR_2021.fullPrice.toString().split(".")[1]),s.Cb(4),s.bd(" ",s.pc(140,85,"SHARED_MODULES.UPGRADE_PLANS.PER_SEAT_MONTH_LABEL"),""),s.Cb(3),s.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.ENTERPRISE_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType!==t.paymentType.ENTERPRISE_YEAR_2021.value),s.Cb(1),s.wc("ngIf",t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.ENTERPRISE_2021.value||!t.isMonthly&&t.workspace.featureSubscriptionType===t.paymentType.ENTERPRISE_YEAR_2021.value),s.Cb(4),s.ad(s.pc(148,87,"SHARED_MODULES.UPGRADE_PLANS.PRO_FEATURE_TITLE")),s.Cb(2),s.wc("ngForOf",t.ENTERPRISE_2021_FEATURE_TYPES),s.Cb(5),s.ad(s.pc(155,89,"SHARED_MODULES.UPGRADE_PLANS.PRIVATE_SERVER_PROMO_INFO")),s.Cb(6),s.ad(s.pc(161,91,"SHARED_MODULES.UPGRADE_PLANS.CONTACT_SALES_LABEL"))}},directives:[i.u,i.r,i.t,Si.a,yC,DC,BC],pipes:[g.e],encapsulation:2}),e})();const hA=["successModal"],mA=["freeTrialModal"],gA=["trialExpiredModal"];function EA(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",37),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"a",38),s.jc("click",(function(){return s.Oc(e),s.nc().closeAlarm()})),s.Xb(5,"span"),s.Zc(6,"\xd7"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"PAGES.FEATURES.PLAN.FREE.INFO_MESSAGE")," "))}function fA(e,t){1&e&&(s.Xb(0,"div",39),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,1,"PAGES.FEATURES.PLAN.LEGACY.INFO_MESSAGE")))}function SA(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",40,41),s.jc("click",(function(){return s.Oc(e),s.Lc(1).blur()})),s.Zc(2),s.oc(3,"translate"),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"PAGES.FEATURES.DEMO")," "))}function CA(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",42,43),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1);return s.nc().blurElementAndSendEvent(t,"contact for demo")})),s.Zc(2),s.oc(3,"translate"),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"PAGES.FEATURES.DEMO")," "))}function AA(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",44),s.jc("click",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(92);return t.openFreeTrialDialog(n)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"PAGES.FEATURES.TRIAL.ACTIVATE")," "))}function OA(e,t){if(1&e){const e=s.Yb();s.Xb(0,"p"),s.Zc(1),s.oc(2,"translate"),s.Xb(3,"a",45),s.jc("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(92);return t.openFreeTrialDialog(n)})),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Zc(6,"."),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,2,"PAGES.FEATURES.QUESTIONS.TRY_FIRST.A")," "),s.Cb(3),s.bd(" ",s.pc(5,4,"PAGES.FEATURES.TRIAL.ACTIVATE"),""))}function vA(e,t){1&e&&(s.Xb(0,"p"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"PAGES.FEATURES.TRIAL.HAD_ALREADY")," "))}function TA(e,t){if(1&e&&(s.Xb(0,"div",28),s.Xb(1,"div",29),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,OA,7,6,"p",31),s.Xc(5,vA,3,3,"p",31),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,3,"PAGES.FEATURES.QUESTIONS.TRY_FIRST.Q")),s.Cb(2),s.wc("ngIf",!e.everHadSubscription),s.Cb(1),s.wc("ngIf",e.everHadSubscription)}}function IA(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",46),s.jc("click",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(92);return t.openFreeTrialDialog(n)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"PAGES.FEATURES.QUESTIONS.REFUND.A_FREE_TRIAL")," "))}function wA(e,t){1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"PAGES.FEATURES.QUESTIONS.REFUND.A_FREE_TRIAL")," "))}function LA(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",47),s.Xb(1,"div",48),s.Sb(2,"img",49),s.Wb(),s.Xb(3,"div",50),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"p",51),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Xb(9,"div",52),s.Xb(10,"a",46),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xb(13,"button",53),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc().startFreeTrial(n)})),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(4),s.ad(s.pc(5,5,"PAGES.FEATURES.TRIAL.TITLE")),s.Cb(3),s.bd(" ",s.pc(8,7,"PAGES.FEATURES.TRIAL.INFO_MESSAGE")," "),s.Cb(4),s.ad(s.pc(12,9,"GLOBAL.NEVERMIND_CANCEL_BTN")),s.Cb(2),s.wc("disabled",e.inProgress),s.Cb(1),s.bd(" ",s.pc(15,11,"PAGES.FEATURES.TRIAL.TITLE")," ")}}function RA(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",54),s.Xb(1,"div",48),s.Sb(2,"img",55),s.Wb(),s.Xb(3,"div",50),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"p",51),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Xb(9,"div",52),s.Xb(10,"a",56),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xb(13,"a",57),s.jc("click",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return n.close(),i.goToSettings()})),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Wb()}2&e&&(s.Cb(4),s.ad(s.pc(5,4,"GLOBAL.SUCCESS_MSG")),s.Cb(3),s.ad(s.pc(8,6,"PAGES.FEATURES.TRIAL.SUCCESS.INFO_MESSAGE")),s.Cb(4),s.ad(s.pc(12,8,"GLOBAL.CLOSE_BTN")),s.Cb(3),s.bd(" ",s.pc(15,10,"PAGES.FEATURES.TRIAL.SUCCESS.SEE_SETTINGS")," "))}function yA(e,t){1&e&&(s.Xb(0,"div",47),s.Xb(1,"div",48),s.Sb(2,"img",49),s.Wb(),s.Xb(3,"div",50),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"p",51),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Xb(9,"div",52),s.Xb(10,"a",46),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(4),s.bd(" ",s.pc(5,3,"PAGES.FEATURES.TRIAL.EXPIRED")," "),s.Cb(3),s.bd(" ",s.pc(8,5,"PAGES.FEATURES.TRIAL.MORE_TIME")," "),s.Cb(4),s.bd(" ",s.pc(12,7,"GLOBAL.CLOSE_BTN")," "))}let _A=(()=>{class e{constructor(e,t,n,i,s,c,a){this.workspaceService=e,this.paymentService=t,this.activatedRoute=n,this.router=i,this.cd=s,this.modalService=c,this.analyticsService=a,this.everHadSubscription=!1,this.unsubscribe$=new Fn.a}ngOnInit(){this.isForbiddenZone=In.g.includes(ke.tz.guess()),this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e,this.isAlarmOpen=!this.workspace.featureSubscriptionType||this.workspace.featureSubscriptionType===mo.b.TRIAL,this.currentPlan=this.workspace.featureSubscriptionType&&mo.a[this.workspace.featureSubscriptionType.replace("SPECIAL","PLUS")],this.isAlarmOpen=!this.workspace.featureSubscriptionType,this.analyticsService.addEvent(new Fi.a({event:"view_item_list",uevent:"view_item_list",ecommerce:{items:[{index:"1",item_name:"Basic2021",price:"4.99",quantity:this.workspace.getWorkspaceSeats()},{index:"2",item_name:"Standard2021",price:"6.99",quantity:this.workspace.getWorkspaceSeats()},{index:"3",item_name:"Pro2021",price:"9.99",quantity:this.workspace.getWorkspaceSeats()},{index:"4",item_name:"Enterprise2021",price:"14.99",quantity:this.workspace.getWorkspaceSeats()}]}}))}),this.paymentService.everHadSubscription.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.everHadSubscription=e,this.hasSubscriptionResponse=!0,this.cd.markForCheck()}),this.paymentService.everHadSubscription.pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>this.checkTrialModal(e))}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}blurElementAndSendEvent(e,t){e.blur(),this.analyticsService.addEvent(new Fi.a({event:"submit",value:t,section:"Upgrade"}))}openFreeTrialDialog(e){this.modalService.open(e,{centered:!0})}startFreeTrial(e){this.inProgress||(this.inProgress=!0,this.paymentService.startFreeTrial().subscribe(()=>{this.workspaceService.getDefaultWorkspace(),this.inProgress=!1,e.close();const t=new Fi.a({event:"submit",uevent:"submit",value:"activate free trial",section:"Upgrade"});this.analyticsService.addEvent(t),this.modalService.open(this.successModal,{centered:!0})},e=>{this.inProgress=!1}))}closeAlarm(){this.isAlarmOpen=!1}goToSettings(){this.router.navigate(["workspaces",this.workspace.id,"settings"])}checkTrialModal(e){if(this.workspace.featureSubscriptionType===mo.b.TRIAL)return;const t=this.activatedRoute.snapshot.queryParams.freeTrial;t&&"true"===t&&this.openFreeTrialDialog(e?this.trialExpiredModal:this.freeTrialModal)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(dC.a),s.Rb(k.a),s.Rb(k.d),s.Rb(s.h),s.Rb(w.q),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["upgrade"]],viewQuery:function(e,t){var n;1&e&&(s.gd(hA,!0),s.gd(mA,!0),s.gd(gA,!0)),2&e&&(s.Kc(n=s.kc())&&(t.successModal=n.first),s.Kc(n=s.kc())&&(t.freeTrialModal=n.first),s.Kc(n=s.kc())&&(t.trialExpiredModal=n.first))},decls:97,vars:59,consts:[[1,"cl-page-wrapper"],["class","cl-mb-3 cl-alert cl-alert-info cl-alert-reset-main cl-alert-dismissible cl-fade cl-show",4,"ngIf"],["class","cl-alert cl-alert-warning cl-alert-reset-main cl-alert-dismissible cl-fade cl-show cl-mb-2",4,"ngIf"],[1,"cl-container-fluid","cl-d-print-none"],[1,"cl-row","cl-align-items-center"],[1,"cl-col"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end"],["href","https://clockify.me/help/getting-started/demo#paid-features-tour","target","_blank","class","cl-mr-3 cl-btn cl-btn-outline-primary",3,"click",4,"ngIf"],["href","https://clockify.me/help/contact/sales","target","_blank","class","cl-mr-3 cl-btn cl-btn-outline-primary",3,"click",4,"ngIf"],["class","cl-btn cl-btn-primary",3,"click",4,"ngIf"],[1,"cl-container","cl-w-max-1200"],[1,"cl-upgrade-companies"],[1,"cl-h4","cl-mb-4"],[1,"cl-d-flex","cl-justify-content-center"],[1,"cl-clients-logos-container"],["src","assets/clients-logos/Group1.svg"],["src","assets/clients-logos/Group2.svg"],["src","assets/clients-logos/Group3.svg"],["src","assets/clients-logos/Group5.svg"],["src","assets/clients-logos/Group6.svg"],["src","assets/clients-logos/Group7.svg"],["src","assets/clients-logos/Group8.svg"],["src","assets/clients-logos/Group10.svg"],[1,"cl-row","cl-mt-4"],[1,"cl-col-12"],[1,"cl-h1","cl-text-center","cl-mb-4"],[1,"cl-col-lg-6"],["class","cl-mb-4",4,"ngIf"],[1,"cl-mb-4"],[1,"cl-h2"],["class","cl-color-blue",3,"click",4,"ngIf"],[4,"ngIf"],["href","https://clockify.me/extra-features",1,"cl-color-blue"],["href","https://clockify.me/self-hosted-time-tracking-software",1,"cl-color-blue"],["freeTrialModal",""],["successModal",""],["trialExpiredModal",""],[1,"cl-mb-3","cl-alert","cl-alert-info","cl-alert-reset-main","cl-alert-dismissible","cl-fade","cl-show"],[1,"cl-close",3,"click"],[1,"cl-alert","cl-alert-warning","cl-alert-reset-main","cl-alert-dismissible","cl-fade","cl-show","cl-mb-2"],["href","https://clockify.me/help/getting-started/demo#paid-features-tour","target","_blank",1,"cl-mr-3","cl-btn","cl-btn-outline-primary",3,"click"],["demo",""],["href","https://clockify.me/help/contact/sales","target","_blank",1,"cl-mr-3","cl-btn","cl-btn-outline-primary",3,"click"],["contactLink",""],[1,"cl-btn","cl-btn-primary",3,"click"],["data-toggle","modal","data-target","#modal-free-trial",1,"cl-color-blue",3,"click"],[1,"cl-color-blue",3,"click"],[1,"cl-modal-body","cl-text-center","cl-py-4"],[1,"cl-mb-3"],["src","assets/images/illustrations/start-free-trial.svg",1,"cl-img-fluid"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-mb-0","cl-text-gray-6"],[1,"cl-modal-footer"],[1,"cl-btn","cl-btn-primary",3,"disabled","click"],["data-cy","success-modal",1,"cl-modal-body","cl-text-center","cl-py-4"],["src","assets/images/illustrations/success.svg",1,"cl-img-fluid"],["data-cy","close-success-modal",1,"cl-color-blue",3,"click"],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xc(1,EA,7,3,"div",1),s.Xc(2,fA,4,3,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"div",5),s.Xb(6,"div",6),s.Xc(7,SA,4,3,"a",7),s.Xc(8,CA,4,3,"a",8),s.Xc(9,AA,3,3,"a",9),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(10,"div",10),s.Sb(11,"upgrade-plans"),s.Xb(12,"div",11),s.Xb(13,"div",12),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Xb(16,"div",13),s.Xb(17,"div",14),s.Sb(18,"img",15),s.Wb(),s.Xb(19,"div",14),s.Sb(20,"img",16),s.Wb(),s.Xb(21,"div",14),s.Sb(22,"img",17),s.Wb(),s.Xb(23,"div",14),s.Sb(24,"img",18),s.Wb(),s.Xb(25,"div",14),s.Sb(26,"img",19),s.Wb(),s.Xb(27,"div",14),s.Sb(28,"img",20),s.Wb(),s.Xb(29,"div",14),s.Sb(30,"img",21),s.Wb(),s.Xb(31,"div",14),s.Sb(32,"img",22),s.Wb(),s.Wb(),s.Wb(),s.Sb(33,"hr"),s.Xb(34,"div",23),s.Xb(35,"div",24),s.Xb(36,"div",25),s.Zc(37),s.oc(38,"translate"),s.Wb(),s.Wb(),s.Xb(39,"div",26),s.Xc(40,TA,6,5,"div",27),s.Xb(41,"div",28),s.Xb(42,"div",29),s.Zc(43),s.oc(44,"translate"),s.Wb(),s.Xb(45,"p"),s.Zc(46),s.oc(47,"translate"),s.Wb(),s.Wb(),s.Xb(48,"div",28),s.Xb(49,"div",29),s.Zc(50),s.oc(51,"translate"),s.Wb(),s.Xb(52,"p"),s.Zc(53),s.oc(54,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(55,"div",26),s.Xb(56,"div",28),s.Xb(57,"div",29),s.Zc(58),s.oc(59,"translate"),s.Wb(),s.Xb(60,"p"),s.Zc(61),s.oc(62,"translate"),s.Xc(63,IA,3,3,"a",30),s.Xc(64,wA,3,3,"span",31),s.Zc(65),s.oc(66,"translate"),s.Wb(),s.Wb(),s.Xb(67,"div",28),s.Xb(68,"div",29),s.Zc(69),s.oc(70,"translate"),s.Wb(),s.Xb(71,"p"),s.Zc(72),s.oc(73,"translate"),s.Xb(74,"a",32),s.Zc(75),s.oc(76,"translate"),s.Wb(),s.Zc(77),s.oc(78,"translate"),s.Xb(79,"a",33),s.Zc(80),s.oc(81,"translate"),s.Wb(),s.Zc(82),s.oc(83,"translate"),s.Wb(),s.Wb(),s.Xb(84,"div",28),s.Xb(85,"div",29),s.Zc(86),s.oc(87,"translate"),s.Wb(),s.Xb(88,"p"),s.Zc(89),s.oc(90,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(91,LA,16,13,"ng-template",null,34,s.Yc),s.Xc(93,RA,16,12,"ng-template",null,35,s.Yc),s.Xc(95,yA,13,9,"ng-template",null,36,s.Yc)),2&e&&(s.Cb(1),s.wc("ngIf",t.isAlarmOpen&&!t.workspace.featureSubscriptionType),s.Cb(1),s.wc("ngIf",t.currentPlan&&t.currentPlan.legacy),s.Cb(5),s.wc("ngIf",t.isForbiddenZone),s.Cb(1),s.wc("ngIf",!t.isForbiddenZone),s.Cb(1),s.wc("ngIf",t.hasSubscriptionResponse&&!t.everHadSubscription),s.Cb(5),s.ad(s.pc(15,25,"PAGES.FEATURES.COMPANIES.INFO_MESSAGE")),s.Cb(23),s.ad(s.pc(38,27,"PAGES.FEATURES.QUESTIONS.TITLE")),s.Cb(3),s.wc("ngIf",t.hasSubscriptionResponse),s.Cb(3),s.ad(s.pc(44,29,"PAGES.FEATURES.QUESTIONS.SEAT.Q")),s.Cb(3),s.bd("",s.pc(47,31,"PAGES.FEATURES.QUESTIONS.SEAT.A")," "),s.Cb(4),s.ad(s.pc(51,33,"PAGES.FEATURES.QUESTIONS.SWITCH.Q")),s.Cb(3),s.ad(s.pc(54,35,"PAGES.FEATURES.QUESTIONS.SWITCH.A")),s.Cb(5),s.ad(s.pc(59,37,"PAGES.FEATURES.QUESTIONS.REFUND.Q")),s.Cb(3),s.bd("",s.pc(62,39,"PAGES.FEATURES.QUESTIONS.REFUND.A_ACTIVATE_FREE_FIRST")," "),s.Cb(2),s.wc("ngIf",!t.everHadSubscription),s.Cb(1),s.wc("ngIf",t.everHadSubscription),s.Cb(1),s.bd(" ",s.pc(66,41,"PAGES.FEATURES.QUESTIONS.REFUND.A_THEN_PAYMENT")," "),s.Cb(4),s.ad(s.pc(70,43,"PAGES.FEATURES.QUESTIONS.PAYMENT_TYPES.Q")),s.Cb(3),s.bd("",s.pc(73,45,"PAGES.FEATURES.QUESTIONS.PAYMENT_TYPES.A_FIRST_PART")," "),s.Cb(3),s.bd(" ",s.pc(76,47,"GLOBAL.ENTERPRISE_LABEL_PART")," "),s.Cb(2),s.bd(" ",s.pc(78,49,"PAGES.FEATURES.QUESTIONS.PAYMENT_TYPES.A_THIRD_PART")," "),s.Cb(3),s.bd(" ",s.pc(81,51,"PAGES.FEATURES.QUESTIONS.PAYMENT_TYPES.A_FORTH_PART")," "),s.Cb(2),s.bd(" ",s.pc(83,53,"PAGES.FEATURES.QUESTIONS.PAYMENT_TYPES.A_FIFTH_PART")," "),s.Cb(4),s.ad(s.pc(87,55,"PAGES.FEATURES.QUESTIONS.TAXES.Q")),s.Cb(3),s.ad(s.pc(90,57,"PAGES.FEATURES.QUESTIONS.TAXES.A")))},directives:[i.u,pA],pipes:[g.e],encapsulation:2}),e})(),kA=(()=>{class e{constructor(e,t,n){this.workspaceService=e,this.router=t,this.authService=n}canActivate(e){const t=this.workspaceService.getLocalDefaultWorkspace();let n,i;n=t?Object(Yt.a)(t):this.workspaceService.getDefaultWorkspace();const s=this.authService.permissionData$.pipe(Object(Zt.a)(e=>null!==e),Object(ln.a)(1));let c;return s.subscribe(()=>i=!0),c=i?s:this.authService.getPermissionsForUser(),Object(Sb.a)(n,c).pipe(Object(ln.a)(1),Object(d.a)(t=>this.allowVisitPage(t[0],t[1],e)))}allowVisitPage(e,t,n){return e&&t?!(-1!==e.adminOnlyPages.indexOf(n.data.page)&&("TEAM"!==n.data.page||!this.authService.isAdminOrOwner())&&("PROJECT"!==n.data.page||!this.authService.isAdminOrOwner()&&!t.isProjectManager)&&("REPORTS"!==n.data.page||!(this.authService.isAdminOrOwner()||t.isProjectManager||t.isTeamManager))&&(this.router.navigate(["/tracker"]),1)):(this.router.navigate(["/tracker"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(s.fc(l.a),s.fc(k.d),s.fc(re.a))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var WA=n("avDW"),XA=n("UnIm"),NA=n("9a6x"),DA=n("Hf8F"),PA=n("zDGq"),MA=n("Ypq1"),BA=n("iO9P"),UA=n("lp//"),GA=function(e){return e.TOP="TOP",e.BOTTOM="BOTTOM",e.ABSOLUTE="ABSOLUTE",e}({});let xA=(()=>{class e{constructor(e){this.browserService=e,this.scrollStatus=GA.TOP,this.unsubscribe$=new p.a,this.onScroll=()=>{const e=window.scrollY;if(this.isDesktop)try{this.asideElement||(this.asideElement=document.getElementById("sidebar-menu"));const t=window.innerHeight,n=this.asideElement.getBoundingClientRect(),i=n.height,s=n.top,c=e<this.lastScrollPosition||0;if(this.lastScrollPosition=e,0===e||t>=i)return void this.setSidebarToTop();if(c&&this.scrollStatus===GA.TOP)return;if(!c&&this.scrollStatus===GA.BOTTOM)return;if(s>=0){if(this.scrollStatus!==GA.TOP)return void this.setSidebarToTop()}else if(t-s>=i&&this.scrollStatus!==GA.BOTTOM)return this.asideElement.style.position="fixed",this.asideElement.style.bottom="0",this.asideElement.style.top="auto",void(this.scrollStatus=GA.BOTTOM);if(this.scrollStatus!==GA.ABSOLUTE)return this.asideElement.style.top=e+s+"px",this.asideElement.style.bottom="auto",this.asideElement.style.position="absolute",void(this.scrollStatus=GA.ABSOLUTE)}catch(t){}},this.browserService.onHeightResize$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop&&this.onScroll()}),this.isDesktop=window.innerHeight>=In.h,this.browserService.isBreakpointLg$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>this.isDesktop=e)}ngOnDestroy(){this.removeScrollListener(),this.unsubscribe$.next(!0),this.unsubscribe$.complete()}addScrollListener(){this.isListening||(this.isListening=!0,this.asideElement=document.getElementById("sidebar-menu"),window.addEventListener("scroll",this.onScroll),this.onScroll())}removeScrollListener(){this.isListening=!1,window.removeEventListener("scroll",this.onScroll),this.onScroll()}setSidebarToTop(){this.asideElement.style.position="fixed",this.asideElement.style.bottom="auto",this.asideElement.style.top="0",this.scrollStatus=GA.TOP}disableBodyScroll(){try{const e=document.body;e&&e.classList.add("cl-scroll-0")}catch(e){}}enableBodyScroll(){try{const e=document.body;e&&e.classList.remove("cl-scroll-0")}catch(e){}}}return e.\u0275fac=function(t){return new(t||e)(s.fc(Gn.a))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var FA=n("GK8k"),jA=n("4olG"),ZA=n("yK97"),VA=n("tzGe");let YA=(()=>{class e{transform(e){return Object(wc.b)(e/10)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=s.Qb({name:"stopwatchTime",type:e,pure:!0}),e})(),HA=(()=>{class e{constructor(e,t){this.stopWatchService=e,this.cd=t,this.offset=0,this.unsubscribe$=new p.a}ngOnInit(){this.subscribeToUpdateTime()}subscribeToUpdateTime(){this.time=this.stopWatchService.time(),this.stopWatchService.time$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.time=e+this.offset,this.cd.detectChanges()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(VA.a),s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["stopwatch-seconds"],["","stopwatch-seconds",""]],inputs:{offset:"offset"},decls:2,vars:3,template:function(e,t){1&e&&(s.Zc(0),s.oc(1,"stopwatchTime")),2&e&&s.ad(s.pc(1,1,t.time))},pipes:[YA],encapsulation:2,changeDetection:0}),e})();var $A=n("enr5"),KA=n("3eYs"),qA=n("RZdV");const zA=["tooltipStopwatch"];function QA(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",13),s.Xb(1,"div",14),s.Xb(2,"div",15),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"div",16),s.Xb(6,"input-time-ampm",17),s.jc("timeChanged",(function(t){return s.Oc(e),s.nc(3).startTimeChanged(t)})),s.Wb(),s.Wb(),s.Xb(7,"div",18),s.Zc(8),s.oc(9,"formatDateToday"),s.oc(10,"formatDate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc(3);s.Cb(3),s.ad(s.pc(4,4,"GLOBAL.FORM_LABEL_START_TIME")),s.Cb(3),s.wc("focusOnInput",!0)("dateTime",null==e.timeEntry||null==e.timeEntry.timeInterval?null:e.timeEntry.timeInterval.start),s.Cb(2),s.bd(" ",s.qc(9,6,s.pc(10,9,null==e.timeEntry||null==e.timeEntry.timeInterval?null:e.timeEntry.timeInterval.start),!1)," ")}}function JA(e,t){1&e&&(s.Vb(0),s.Xc(1,QA,11,11,"div",12),s.Ub())}function eO(e,t){if(1&e&&(s.Xb(0,"div",9),s.Sb(1,"span",10),s.oc(2,"translate"),s.oc(3,"translate"),s.Xc(4,JA,2,0,"ng-container",11),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.Wc("cursor",e.disableManualMode?s.pc(2,3,"TRACKER.DEFAULT"):s.pc(3,5,"TRACKER.CURSOR.POINTER")),s.Cb(3),s.wc("ngIf",!e.disableManualMode)}}function tO(e,t){1&e&&(s.Xb(0,"span",19),s.Zc(1,"00:00:00"),s.Wb())}function nO(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"button",20),s.oc(2,"translate"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"button",21),s.oc(6,"translate"),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.yc("title","",s.pc(2,6,"TRACKER.STOP")," (s)"),s.wc("disabled",e.isDisabled||!e.isEntryInitialized),s.Cb(2),s.ad(s.pc(4,8,"TRACKER.STOP")),s.Cb(2),s.yc("title","",s.pc(6,10,"TRACKER.STOP")," (s)"),s.wc("disabled",e.isDisabled||!e.isEntryInitialized),s.Cb(2),s.ad(s.pc(8,12,"TRACKER.STOP"))}}function iO(e,t){if(1&e&&(s.Xb(0,"button",22),s.Zc(1),s.oc(2,"translate"),s.Wb(),s.Xb(3,"button",23),s.Zc(4),s.oc(5,"translate"),s.Wb()),2&e){const e=s.nc();s.wc("disabled",e.isDisabled||!e.isEntryInitialized),s.Cb(1),s.ad(s.pc(2,4,"TRACKER.START")),s.Cb(2),s.wc("disabled",e.isDisabled||!e.isEntryInitialized),s.Cb(1),s.ad(s.pc(5,6,"TRACKER.START"))}}function sO(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",31),s.Xb(1,"div",32),s.Xb(2,"div",33),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"button",34),s.jc("keyup.space",(function(){return s.Oc(e),s.nc(2).cancelConfirmed()}))("keyup.enter",(function(){return s.Oc(e),s.nc(2).cancelConfirmed()}))("click",(function(){return s.Oc(e),s.nc(2).cancelConfirmed()})),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Sb(8,"span",35),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(3),s.ad(s.pc(4,3,"TRACKER.CONFIRM_ACTION")),s.Cb(2),s.wc("disabled",e.isDisabled||!(null!=e.timeEntry&&e.timeEntry.id)),s.Cb(1),s.ad(s.pc(7,5,"GLOBAL.DISCARD_BTN"))}}function cO(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",24),s.Xb(1,"div",25),s.Xb(2,"div",26),s.jc("click",(function(){return s.Oc(e),s.nc().onDropdownOpen()})),s.Xb(3,"a",27),s.Sb(4,"img",28),s.Wb(),s.Wb(),s.Xb(5,"div",29),s.jc("click",(function(){return s.Oc(e),s.nc().onDropdownOpen()})),s.Xb(6,"a",27),s.Sb(7,"img",28),s.Wb(),s.Wb(),s.Xc(8,sO,9,7,"div",30),s.Wb(),s.Wb()}}let aO=(()=>{class e{constructor(e,t,n,i,c,a,o,r,l){this.stopwatchService=e,this.entryHelper=t,this.cd=n,this.toaster=i,this.keyboardService=c,this.debouncerService=a,this.entryGroupService=o,this.trackerService=r,this.translate=l,this.setEntry=new s.n,this.stopped=new s.n,this.canceled=new s.n,this.canceledFailed=new s.n,this.setInProgress=new s.n,this.unsubscribe$=new p.a}ngOnInit(){this.translations=this.translate.instant(["TRACKER.MESSAGES.STOP_FAIL","TRACKER.MESSAGES.CANCEL_SUCCESS","TRACKER.MESSAGES.CANCEL_FAIL"]),this.stopwatchService.stateChanged.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{e==VA.b.STARTED?(this.inProgress=!0,this.cd.detectChanges()):e==VA.b.STOPPED&&(this.inProgress=!1,this.cd.detectChanges())}),this.subscribeToKeyboard()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}startTimeChanged(e){const t=ke().utc(),n=ke.utc(e);for(ke.duration(t.diff(n)).asMilliseconds()>864e4&&(e=n.add(1,"days").toISOString());ke(e).isAfter(ke(t));)e=n.subtract(1,"days").toISOString();const i=this.timeEntry.timeInterval.start;this.timeEntry.timeInterval.start=e,this.setStart(e),this.debouncerService.debouncer$.pipe(Object(ln.a)(1),Object(Zt.a)(e=>e),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.trackerService.editStartTime(this.timeEntry.id,e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{},e=>{this.timeEntry.timeInterval.start=i,this.setStart(i)})}),this.debouncerService.next(!0)}start(e){this.inProgress||this.isDisabled||setTimeout(()=>{this.stopwatchService.start(),this.timeEntry.timeInterval=new ZA.a({start:ke().toISOString()}),this.isDisabled=!0,this.cd.detectChanges(),this.trackerService.addStartedTimeEntry(e||this.timeEntry).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isDisabled=!1,this.cd.detectChanges(),this.setEntry.emit(e)},e=>{this.isDisabled=!1,this.cd.detectChanges(),this.stopwatchService.stop()})},2)}onDropdownOpen(){this.debouncerService.reset()}stop(e,t=!1){this.isDisabled||setTimeout(()=>{this.entryHelper.isValid(this.timeEntry)&&(this.debouncerService.next(!1),this.stopwatchService.stop(),this.isDisabled=!0,this.cd.detectChanges(),this.trackerService.stopwatchStopped(this.timeEntry).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(n=>{if(this.isDisabled=!1,this.cd.detectChanges(),!n.timeInterval.end)return this.setStart(this.timeEntry.timeInterval.start),void this.toaster.pop("error",this.translations["TRACKER.MESSAGES.STOP_FAIL"]);e?this.start(e):t?this.start():this.stopped.emit({billable:this.timeEntry.billable}),this.entryGroupService.setNewEntryCreated(n)},e=>{this.isDisabled=!1,this.cd.detectChanges(),this.setStart(this.timeEntry.timeInterval.start)}))},2)}toggleStartStop(){this.isDisabled||(this.inProgress?this.stop():this.start())}cancelConfirmed(){this.stopwatchService.stop();const e=en.a.clone(this.timeEntry);this.canceled.emit();const t={success:this.translations["TRACKER.MESSAGES.CANCEL_SUCCESS"],error:this.translations["TRACKER.MESSAGES.CANCEL_FAIL"]};this.isDisabled=!0,this.cd.detectChanges(),this.trackerService.deleteTimeEntry(e,t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.isDisabled=!1,this.cd.detectChanges()},t=>{this.isDisabled=!1,this.cd.detectChanges(),this.canceledFailed.emit(e),this.setStart(e.timeInterval.start)})}setStart(e){const t=new Date(e).getTime()/100;this.stopwatchService.setStart(t)}subscribeToKeyboard(){this.keyboardService.keyboardRecorder$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{e===_b.g&&this.inProgress&&this.stop()})}showTooltip(){this.tooltipStopwatch&&this.tooltipStopwatch.open()}closeTooltip(){this.tooltipStopwatch&&this.tooltipStopwatch.close()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(VA.a),s.Rb(NA.a),s.Rb(s.h),s.Rb(r.a),s.Rb(PA.a),s.Rb(Me),s.Rb(XA.a),s.Rb(WA.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["stopwatch"],["","stopwatch",""]],viewQuery:function(e,t){var n;1&e&&s.gd(zA,!0),2&e&&s.Kc(n=s.kc())&&(t.tooltipStopwatch=n.first)},inputs:{isEntryInitialized:"isEntryInitialized",timeEntryDate:"timeEntryDate",disableManualMode:"disableManualMode",timeEntry:"timeEntry"},outputs:{setEntry:"setEntry",stopped:"stopped",canceled:"canceled",canceledFailed:"canceledFailed",setInProgress:"setInProgress"},decls:12,vars:9,consts:[[1,"cl-component-divided-left","cl-d-md-inline-flex","cl-cursor-default"],["dropdown","","class","cl-relative",4,"ngIf","ngIfElse"],["stopwatchTime",""],[1,"cl-d-flex","cl-align-items-center","cl-relative"],["triggers","manual","placement","bottom","tabindex","0",3,"autoClose","ngbTooltip","keyup.space","keyup.enter","click"],["tooltipStopwatch","ngbTooltip"],[4,"ngIf","ngIfElse"],["start",""],["class","cl-stopwatch-discard-wrapper",4,"ngIf"],["dropdown","",1,"cl-relative"],["stopwatch-seconds","",1,"cl-form-control","cl-input-time-picker-sum"],[4,"ngIf"],["class","cl-dropdown-menu cl-dropdown-menu-right cl-py-3 cl-px-2",4,"dropdownContent"],[1,"cl-dropdown-menu","cl-dropdown-menu-right","cl-py-3","cl-px-2"],[1,"cl-d-flex","cl-align-items-center","cl-stopwatch-dropdown-wrapper"],[1,"cl-h5","cl-mb-0","cl-stopwatch-dropdown-label"],[1,"cl-mx-2","cl-stopwatch-dropdown-input"],[3,"focusOnInput","dateTime","timeChanged"],[1,"cl-stopwatch-dropdown-day","cl-cursor-default"],[1,"cl-form-control","cl-input-time-picker-sum"],["tabIndex","-1","data-cy","tracker-stop",1,"cl-btn","cl-btn-danger","cl-d-none","cl-d-lg-custom-block",3,"disabled","title"],["tabIndex","-1",1,"cl-btn","cl-btn-danger","cl-btn-sm","cl-d-block","cl-d-lg-custom-none",3,"disabled","title"],["tabIndex","-1",1,"cl-btn","cl-btn-primary","cl-d-none","cl-d-lg-custom-block",3,"disabled"],["tabIndex","-1",1,"cl-btn","cl-btn-primary","cl-btn-sm","cl-d-block","cl-d-lg-custom-none",3,"disabled"],[1,"cl-stopwatch-discard-wrapper"],["dropdownKey","",1,"cl-stopwatch-discard","cl-d-flex","cl-align-items-center"],["dropdownKeyButton","","tabindex","0",1,"cl-d-block","cl-d-lg-custom-none",3,"click"],[1,"cl-timetracker-switch"],["src","assets/images/ui-icons/close.svg"],["dropdownKeyButton","","tabindex","0",1,"cl-d-none","cl-d-lg-custom-flex","cl-align-items-center","cl-h-100",3,"click"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-d-flex","cl-align-items-center","cl-px-3","cl-py-2"],[1,"cl-cut-text","cl-mr-3"],["tabindex","0",1,"cl-btn","cl-btn-primary",3,"disabled","keyup.space","keyup.enter","click"],["dropdownClose","","tabindex","0"]],template:function(e,t){if(1&e&&(s.Xb(0,"div",0),s.Xc(1,eO,5,7,"div",1),s.Xc(2,tO,2,0,"ng-template",null,2,s.Yc),s.Wb(),s.Xb(4,"div",3),s.Xb(5,"div",4,5),s.jc("keyup.space",(function(){return t.toggleStartStop()}))("keyup.enter",(function(){return t.toggleStartStop()}))("click",(function(){return t.toggleStartStop()})),s.oc(7,"translate"),s.Xc(8,nO,9,14,"ng-container",6),s.Xc(9,iO,6,8,"ng-template",null,7,s.Yc),s.Wb(),s.Wb(),s.Xc(11,cO,9,0,"div",8)),2&e){const e=s.Lc(3),n=s.Lc(10);s.Cb(1),s.wc("ngIf",t.inProgress)("ngIfElse",e),s.Cb(4),s.wc("autoClose","inside")("ngbTooltip",s.pc(7,7,"TRACKER.TIME_TRACKER.START_TIMER_TOOLTIP")),s.Cb(3),s.wc("ngIf",t.inProgress)("ngIfElse",n),s.Cb(3),s.wc("ngIf",t.inProgress)}},directives:[i.u,w.bb,Nc.a,HA,Dc.a,$A.a,ni.a,ii.a,si.a],pipes:[g.e,KA.a,qA.a],styles:["[_nghost-%COMP%]     input-time-ampm{display:block}[_nghost-%COMP%]     input-time-ampm input{width:100%;text-align:center!important}"],changeDetection:0}),e})();var oO=n("VYrk"),rO=n("PqYM");class lO{constructor(e){this.durationSelector=e}call(e,t){return t.subscribe(new bO(e,this.durationSelector))}}class bO extends kh.a{constructor(e,t){super(e),this.durationSelector=t,this.hasValue=!1,this.durationSubscription=null}_next(e){try{const t=this.durationSelector.call(this,e);t&&this._tryNext(e,t)}catch(t){this.destination.error(t)}}_complete(){this.emitValue(),this.destination.complete()}_tryNext(e,t){let n=this.durationSubscription;this.value=e,this.hasValue=!0,n&&(n.unsubscribe(),this.remove(n)),n=Object(Wh.a)(this,t),n&&!n.closed&&this.add(this.durationSubscription=n)}notifyNext(e,t,n,i,s){this.emitValue()}notifyComplete(){this.emitValue()}emitValue(){if(this.hasValue){const e=this.value,t=this.durationSubscription;t&&(this.durationSubscription=null,t.unsubscribe(),this.remove(t)),this.value=null,this.hasValue=!1,super._next(e)}}}var dO=n("GidR"),uO=n("V3bs"),pO=n("Nu56");const hO=["autocompleteInput"],mO=["dropdownKeyRef"];function gO(e,t){if(1&e&&(s.Xb(0,"div",16),s.Zc(1),s.Wb()),2&e){const e=s.nc().$implicit;s.Cb(1),s.bd(" ",e.description," ")}}function EO(e,t){1&e&&s.Sb(0,"span",21)}function fO(e,t){if(1&e&&(s.Xb(0,"div",17),s.Xb(1,"span"),s.Sb(2,"i",18),s.Xb(3,"span"),s.Zc(4),s.Wb(),s.Wb(),s.Xc(5,EO,1,0,"span",19),s.Xb(6,"span",20),s.Zc(7),s.Wb(),s.Wb()),2&e){const e=s.nc().$implicit;s.Cb(1),s.Wc("color",e.project.color),s.Cb(1),s.Wc("background-color",e.project.color),s.Cb(2),s.cd("",e.project.name,"",e.task?": "+e.task.name:"",""),s.Cb(1),s.wc("ngIf",e.project.clientName),s.Cb(2),s.ad(e.project.clientName)}}function SO(e,t){if(1&e&&s.Sb(0,"tag-names-text-only",22),2&e){const e=s.nc().$implicit;s.wc("tags",e.tags)("hideAddingTags",!0)}}function CO(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",11),s.jc("keyup.enter",(function(){s.Oc(e);const n=t.$implicit;return s.nc(3).selectEntry(n)}))("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc(3).selectEntry(n)})),s.Xb(1,"div",12),s.Xc(2,gO,2,1,"div",13),s.Xc(3,fO,8,8,"div",14),s.Xc(4,SO,1,2,"tag-names-text-only",15),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit;s.Hb("angular-autocomplete-last",t.last),s.Cb(2),s.wc("ngIf",e.description),s.Cb(1),s.wc("ngIf",e.project),s.Cb(1),s.wc("ngIf",e.tags)}}function AO(e,t){if(1&e&&(s.Xb(0,"div",6),s.Xb(1,"div",7),s.Xb(2,"div",8),s.Xc(3,CO,5,5,"div",9),s.oc(4,"slice"),s.Sb(5,"span",10),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(3),s.wc("ngForOf",s.rc(4,1,e.timeEntries,0,8))}}function OO(e,t){1&e&&(s.Vb(0),s.Xc(1,AO,6,5,"div",5),s.Ub())}let vO=(()=>{class e{constructor(e,t){this.trackerService=e,this.cd=t,this.description="",this.descriptionBackup="",this.placeholder="",this.clearCacheOnEntryChange=!0,this.onFocus=new s.n,this.onEnter=new s.n,this.onChange=new s.n,this.onSelect=new s.n,this.descriptionDebouncer$=new p.a,this.unsubscribe$=new p.a,this.ignoreKeys=[_b.a,_b.b,_b.d,_b.i],this.latestSearch={},this.isCacheClear=!1,this.hasNoResults=[]}set descriptionSetter(e){this.description=e||"",this.descriptionBackup=e||""}ngOnInit(){this.trackerService.clearLastesEntriesCache(),this.subscribeToDebouncer(),this.subscribeToEntryChange(),this.autofocus&&this.focusToInput()}ngOnDestroy(){this.unsubscribeSub(),this.unsubscribe$.next(!0),this.unsubscribe$.complete()}keydown(e){this.ignoreKeys.includes(e.keyCode||e.which)||this.isInputElementInFocus()||this.focusToInput()}unsubscribeSub(){this.descriptionSub&&this.descriptionSub.unsubscribe()}subscribeToEntryChange(){this.clearCacheOnEntryChange&&this.trackerService.clearAutocompleteCache$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.isCacheClear=!0,this.trackerService.clearLastesEntriesCache(),this.hasNoResults=[]})}onDropdownClose(){this.isAutocompleteSelected?this.isAutocompleteSelected=!1:setTimeout(()=>{this.isInputElementInFocus()||this.emit()})}blur(){setTimeout(()=>{this.isDropdownInFocus()||this.emit()})}emit(){const e=this.description.trim();e!==this.descriptionBackup&&this.onChange.emit(e)}focusToInput(){this.autocompleteInput.nativeElement.focus()}onModelChange(){this.descriptionDebouncer$.next({description:this.description,event:"onModelChange"})}subscribeToDebouncer(){var e;this.descriptionSub=this.descriptionDebouncer$.pipe((e=e=>Object(rO.a)("onModelChange"===e.event?400:0),t=>t.lift(new lO(e))),Object(Lh.a)((e,t)=>e.description===t.description&&!this.isCacheClear&&"onModelChange"===t.event),Object(yb.a)(({description:e,event:t})=>(this.latestSearch={description:e,event:t},this.isCacheClear=!1,1===e.length?(this.skipRequest=!0,Object(Yt.a)([])):(this.skipRequest=this.hasNoResults.some(t=>e.startsWith(t)),this.skipRequest?Object(Yt.a)([]):e?this.trackerService.getAutocomplete(e):this.trackerService.getLatestEntries(!0)))),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.timeEntries=e.filter(e=>e.id!==this.id);const t=!this.timeEntries.length;t&&!this.skipRequest&&1!==this.latestSearch.description.length&&(this.hasNoResults=this.hasNoResults.slice(0,100),this.hasNoResults.push(this.latestSearch.description)),t?this.dropdownKeyRef.closeDropdown():(this.showDropdown(),this.cd.detectChanges())},()=>{this.unsubscribeSub(),this.subscribeToDebouncer()})}shouldHideDropdown(e,t){return"onModelChange"===e&&!t}showDropdown(){var e;this.isComponentInFocus()&&(null===(e=this.timeEntries)||void 0===e?void 0:e.length)&&(this.dropdownKeyRef.showDropdown(),this.cd.detectChanges())}isInputElementInFocus(){return document.activeElement===this.autocompleteInput.nativeElement}isDropdownInFocus(){return document.activeElement.hasAttribute("autocompleteSuggestionElement")}isComponentInFocus(){return this.dropdownKeyRef.isElementInside(document.activeElement)}selectEntry(e){this.isAutocompleteSelected=!0;const t=dO.a.clone(e);this.onSelect.emit(t),this.dropdownKeyRef.closeDropdown()}focus(){this.onFocus.emit()}click(){this.checkAutocompleteDropdown("focus")}enter(){this.onEnter.emit(this.description.trim())}checkAutocompleteDropdown(e){setTimeout(()=>{this.latestSearch.description!==this.description||this.isCacheClear?this.descriptionDebouncer$.next({description:this.description,event:e}):this.showDropdown()})}onArrowUp(){try{document.getElementsByClassName("angular-autocomplete-last")[0].focus()}catch(e){}}onArrowDown(){this.checkAutocompleteDropdown("arrowDown")}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(WA.a),s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["autocomplete-input"]],viewQuery:function(e,t){var n;1&e&&(s.Uc(hO,!0),s.gd(mO,!0)),2&e&&(s.Kc(n=s.kc())&&(t.autocompleteInput=n.first),s.Kc(n=s.kc())&&(t.dropdownKeyRef=n.first))},hostBindings:function(e,t){1&e&&s.jc("keydown",(function(e){return t.keydown(e)}))},inputs:{id:"id",descriptionSetter:["description","descriptionSetter"],placeholder:"placeholder",autofocus:"autofocus",clearCacheOnEntryChange:"clearCacheOnEntryChange"},outputs:{onFocus:"onFocus",onEnter:"onEnter",onChange:"onChange",onSelect:"onSelect"},decls:5,vars:4,consts:[["tabCell","","dropdownKey","",1,"cl-position-relative",3,"onClose"],["dropdownKeyRef","dropdownKey"],["type","text","tabindex","0","name","autocomplete-input","spellcheck","true","autocomplete","off",1,"cl-form-control","cl-input-timetracker-main","cl-cut-text",3,"ngModel","placeholder","ngModelChange","click","focus","blur","keyup.enter","keyup.arrowup","keyup.arrowdown"],["autocompleteInput",""],[4,"ngIf"],["arrowNavigation","","class","cl-dropdown cl-dropdown-large",4,"dropdownKeyContent"],["arrowNavigation","",1,"cl-dropdown","cl-dropdown-large"],[1,"cl-dropdown-menu","cl-w-100","cl-overflow-hidden","cl-autocomplete-dropdown"],["tabindex","0","autocompleteSuggestionElement","",1,"cl-no-focus-tabindex"],["class","cl-dropdown-item pointer cl-no-focus-tabindex","tabindex","-1","autocompleteSuggestionElement","",3,"angular-autocomplete-last","keyup.enter","click",4,"ngFor","ngForOf"],["dropdownClose","","tabindex","0"],["tabindex","-1","autocompleteSuggestionElement","",1,"cl-dropdown-item","pointer","cl-no-focus-tabindex",3,"keyup.enter","click"],[1,"cl-d-flex"],["class","cl-mr-2 cl-cut-text",4,"ngIf"],["class","cl-project-name cl-project-name-colored cl-mr-2 cl-cut-text",4,"ngIf"],["class","cl-d-flex","style","height: 21px;",3,"tags","hideAddingTags",4,"ngIf"],[1,"cl-mr-2","cl-cut-text"],[1,"cl-project-name","cl-project-name-colored","cl-mr-2","cl-cut-text"],[1,"cl-entry__project__dot"],["class","cl-h-line-divider",4,"ngIf"],[1,"cl-listing-client"],[1,"cl-h-line-divider"],[1,"cl-d-flex",2,"height","21px",3,"tags","hideAddingTags"]],template:function(e,t){1&e&&(s.Xb(0,"div",0,1),s.jc("onClose",(function(){return t.onDropdownClose()})),s.Xb(2,"input",2,3),s.jc("ngModelChange",(function(e){return t.description=e}))("click",(function(){return t.click()}))("focus",(function(){return t.focus()}))("blur",(function(){return t.blur()}))("ngModelChange",(function(){return t.onModelChange()}))("keyup.enter",(function(){return t.enter()}))("keyup.arrowup",(function(){return t.onArrowUp()}))("keyup.arrowdown",(function(){return t.onArrowDown()})),s.Wb(),s.Xc(4,OO,2,0,"ng-container",4),s.Wb()),2&e&&(s.Cb(2),s.wc("ngModel",t.description)("placeholder",t.placeholder),s.Db("title",t.description),s.Cb(2),s.wc("ngIf",null==t.timeEntries?null:t.timeEntries.length))},directives:[ni.a,v.c,v.s,v.v,i.u,si.a,uO.a,i.t,pO.a],pipes:[i.F],encapsulation:2,changeDetection:0}),e})();var TO=n("nss9"),IO=n("pCWH"),wO=n("+/oa"),LO=n("okBH");function RO(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.Wb()),2&e){const e=t.$implicit,n=t.last;s.Cb(1),s.cd(" ",e.name,"",n?"":", "," ")}}function yO(e,t){if(1&e&&(s.Xb(0,"div",5),s.Xb(1,"span",6),s.Xc(2,RO,2,2,"span",7),s.oc(3,"sortBy"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.Db("title",e.attributeTitle),s.Cb(1),s.wc("ngForOf",s.qc(3,3,e.tags,e.sortByNameMapper))("ngForTrackBy",e.trackByFn)}}function _O(e,t){1&e&&(s.Xb(0,"div",8),s.Sb(1,"img",9),s.Xb(2,"div",10),s.Xb(3,"a",11),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(4),s.ad(s.pc(5,1,"GLOBAL.ADD_TAGS_LABEL")))}function kO(e,t){1&e&&s.Sb(0,"img",12)}function WO(e,t){1&e&&s.Sb(0,"img",13)}let XO=(()=>{class e{constructor(){this.sortByNameMapper=e=>e.name}set tags(e){this._tags=e,this.attributeTitle="",e&&(this.attributeTitle=Object(wO.a)(e))}get tags(){return this._tags}ngOnInit(){}trackByFn(e,t){return t.id}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["tag-names"]],inputs:{tags:"tags"},decls:7,vars:4,consts:[["class","cl-component-divided-left cl-dropdown-toggle cl-no-arrow cl-w-100\n            cl-no-divider-border cl-cut-text-wrapper cl-d-none cl-d-lg-custom-flex tt-entry-show-mob",4,"ngIf","ngIfElse"],["tagIcon",""],[1,"cl-component-divided-left","cl-dropdown-toggle","cl-no-arrow","cl-remove-divider-mob","cl-d-flex","cl-d-lg-custom-none","tt-entry-hide-mob"],["src","assets/images/ui-icons/tag-blue.svg",4,"ngIf","ngIfElse"],["tagIconMobile",""],[1,"cl-component-divided-left","cl-dropdown-toggle","cl-no-arrow","cl-w-100","cl-no-divider-border","cl-cut-text-wrapper","cl-d-none","cl-d-lg-custom-flex","tt-entry-show-mob"],[1,"cl-badge","cl-badge-tag","cl-badge-tag-timetracker-entry"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"cl-component-divided-left","cl-dropdown-toggle","cl-no-arrow","cl-d-none","cl-d-lg-custom-flex","tt-entry-show-mob"],["src","assets/images/ui-icons/tag-gray.svg",1,"tag-icon"],[1,"tag-text"],[1,"cl-btn","cl-btn-sm","cl-btn-outline-light"],["src","assets/images/ui-icons/tag-blue.svg"],["src","assets/images/ui-icons/tag-gray.svg"]],template:function(e,t){if(1&e&&(s.Xc(0,yO,4,6,"div",0),s.Xc(1,_O,6,3,"ng-template",null,1,s.Yc),s.Xb(3,"div",2),s.Xc(4,kO,1,0,"img",3),s.Xc(5,WO,1,0,"ng-template",null,4,s.Yc),s.Wb()),2&e){const e=s.Lc(2),n=s.Lc(6);s.wc("ngIf",(null==t.tags?null:t.tags.length)>0)("ngIfElse",e),s.Cb(4),s.wc("ngIf",(null==t.tags?null:t.tags.length)>0)("ngIfElse",n)}},directives:[i.u,i.t],pipes:[LO.a,g.e],styles:[""],changeDetection:0}),e})();var NO=n("GAki"),DO=n("1YN2"),PO=n("MPSC"),MO=n("FfKB"),BO=n("4Seb");function UO(e,t){if(1&e&&(s.Xb(0,"a",18),s.oc(1,"translate"),s.Sb(2,"img",19),s.Zc(3),s.oc(4,"translate"),s.Wb()),2&e){const e=s.nc(3);s.Hb("cl-active",e.isManual),s.wc("ngbTooltip",s.pc(1,4,"CALENDAR.INTEGRATIONS.DISABLED_MANUAL_MODE_TOOLTIP")),s.Cb(3),s.bd(" ",s.pc(4,6,"GLOBAL.MANUAL_LABEL")," ")}}function GO(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",16),s.jc("click",(function(){return s.Oc(e),s.nc(3).setManualState(!0)}))("keyup.enter",(function(){return s.Oc(e),s.nc(3).setManualState(!0)}))("keyup.space",(function(){return s.Oc(e),s.nc(3).setManualState(!0)})),s.oc(1,"translate"),s.Sb(2,"img",17),s.Zc(3),s.oc(4,"translate"),s.Wb()}if(2&e){const e=s.nc(3);s.Hb("cl-active",e.isManual),s.xc("title",s.pc(1,5,"TRACKER.TIME_TRACKER.ENTRY.TRACK.MANUAL_M")),s.Cb(2),s.wc("src",e.isManual?"assets/images/ui-icons/list-blue.svg":"assets/images/ui-icons/list-gray.svg",s.Qc),s.Cb(1),s.bd(" ",s.pc(4,7,"GLOBAL.MANUAL_LABEL")," ")}}function xO(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",13),s.Xb(1,"list-items"),s.Xc(2,UO,5,8,"a",14),s.Xc(3,GO,5,9,"a",15),s.Xb(4,"a",16),s.jc("click",(function(){return s.Oc(e),s.nc(2).setManualState(!1)}))("keyup.enter",(function(){return s.Oc(e),s.nc(2).setManualState(!1)}))("keyup.space",(function(){return s.Oc(e),s.nc(2).setManualState(!1)})),s.oc(5,"translate"),s.Sb(6,"img",17),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.wc("ngIf",e.disableManualMode),s.Cb(1),s.wc("ngIf",!e.disableManualMode),s.Cb(1),s.Hb("cl-active",!e.isManual),s.xc("title",s.pc(5,7,"TRACKER.TIME_TRACKER.ENTRY.TRACK.TIMER_N")),s.Cb(2),s.wc("src",e.isManual?"assets/images/ui-icons/clock-gray.svg":"assets/images/ui-icons/clock-blue.svg",s.Qc),s.Cb(1),s.bd(" ",s.pc(8,9,"TRACKER.TIME_TRACKER.ENTRY.TRACK.TIMER")," ")}}function FO(e,t){1&e&&(s.Xb(0,"div",7),s.Xb(1,"div",8),s.Xb(2,"a",9),s.Sb(3,"img",10),s.Wb(),s.Xc(4,xO,9,11,"div",11),s.Sb(5,"span",12),s.Wb(),s.Wb())}function jO(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",20),s.jc("click",(function(){return s.Oc(e),s.nc().setIsManual.emit(!0)}))("keyup.enter",(function(){return s.Oc(e),s.nc().setIsManual.emit(!0)}))("keyup.space",(function(){return s.Oc(e),s.nc().setIsManual.emit(!0)})),s.oc(1,"translate"),s.Sb(2,"img",21),s.Wb()}if(2&e){const e=s.nc();s.Hb("grayscale",!e.isManual),s.xc("title",s.pc(1,3,"TRACKER.TIME_TRACKER.ENTRY.TRACK.MANUAL_M"))}}function ZO(e,t){1&e&&(s.Xb(0,"a",22),s.oc(1,"translate"),s.Sb(2,"img",21),s.Wb()),2&e&&s.wc("ngbTooltip",s.pc(1,1,"CALENDAR.INTEGRATIONS.DISABLED_MANUAL_MODE_TOOLTIP"))}let VO=(()=>{class e{constructor(e){this.analyticsService=e,this.setIsManual=new s.n}ngOnInit(){}setManualState(e){this.analyticsService.addEvent(new Fi.a(e?{event:"Submit",value:"Manual mode",section:"Time Tracker"}:{event:"Submit",value:"Timer mode",section:"Time Tracker"})),e&&this.disableManualMode||this.setIsManual.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["modes-btns"]],inputs:{isManual:"isManual",disableManualMode:"disableManualMode"},outputs:{setIsManual:"setIsManual"},decls:8,vars:10,consts:[[1,"cl-px-lg-custom-2"],["class","cl-d-block cl-d-lg-custom-none","dropdownKey","","tabCell","",4,"ngIf"],[1,"cl-d-none","cl-d-lg-custom-block"],["tabindex","0","data-cy","timer-mode",1,"cl-timetracker-switch",3,"title","click","keyup.enter","keyup.space"],["src","assets/images/ui-icons/clock-blue.svg"],["tabindex","0","class","cl-timetracker-switch","data-cy","manual-mode",3,"grayscale","title","click","keyup.enter","keyup.space",4,"ngIf"],["class","cl-timetracker-switch cl-cursor-default grayscale",3,"ngbTooltip",4,"ngIf"],["dropdownKey","","tabCell","",1,"cl-d-block","cl-d-lg-custom-none"],[1,"cl-dropdown","cl-px-0"],["dropdownKeyButton","","tabindex","0",1,"cl-d-flex","cl-px-3","cl-dropdown-toggle","cl-no-arrow"],["src","assets/images/ui-icons/menu-dots-vertical.svg"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["tabFocus","","tabindex","0"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],["class","cl-dropdown-item cl-d-flex cl-align-items-center cl-cursor-default",3,"cl-active","ngbTooltip",4,"ngIf"],["class","cl-dropdown-item cl-d-flex cl-align-items-center","tabindex","-1","clickCloseDropdown","",3,"cl-active","title","click","keyup.enter","keyup.space",4,"ngIf"],["tabindex","-1","clickCloseDropdown","",1,"cl-dropdown-item","cl-d-flex","cl-align-items-center",3,"title","click","keyup.enter","keyup.space"],["clickCloseDropdown","",1,"cl-mr-2",3,"src"],[1,"cl-dropdown-item","cl-d-flex","cl-align-items-center","cl-cursor-default",3,"ngbTooltip"],["src","assets/images/ui-icons/list-gray.svg",1,"cl-mr-2"],["tabindex","0","data-cy","manual-mode",1,"cl-timetracker-switch",3,"title","click","keyup.enter","keyup.space"],["src","assets/images/ui-icons/list-blue.svg"],[1,"cl-timetracker-switch","cl-cursor-default","grayscale",3,"ngbTooltip"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xc(1,FO,6,0,"div",1),s.Xb(2,"div",2),s.Xb(3,"a",3),s.jc("click",(function(){return t.setManualState(!1)}))("keyup.enter",(function(){return t.setManualState(!1)}))("keyup.space",(function(){return t.setManualState(!1)})),s.oc(4,"translate"),s.Sb(5,"img",4),s.Wb(),s.Xc(6,jO,3,5,"a",5),s.Xc(7,ZO,3,3,"a",6),s.Wb(),s.Wb()),2&e&&(s.Hb("cl-mr-1",t.disableManualMode&&!t.isManual),s.Cb(1),s.wc("ngIf",!t.disableManualMode||t.isManual),s.Cb(2),s.Hb("grayscale",t.isManual),s.xc("title",s.pc(4,8,"TRACKER.TIME_TRACKER.ENTRY.TRACK.TIMER_N")),s.Cb(3),s.wc("ngIf",!t.disableManualMode),s.Cb(1),s.wc("ngIf",t.disableManualMode))},directives:[i.u,ni.a,ii.a,si.a,fi.a,w.bb],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var YO=n("pOhx");const HO=["stopwatch"],$O=["tooltipDescription"],KO=["tooltipProject"],qO=["tooltipManual"];function zO(e,t){if(1&e){const e=s.Yb();s.Xb(0,"project-picker",27,28),s.jc("selectedProjectAndTask",(function(t){s.Oc(e);const n=s.nc(),i=s.Lc(20);return n.selectProjectAndTask(t,i)}))("onResize",(function(t){return s.Oc(e),s.Lc(1).onResizeChange(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("resizeableName","projectPicker")("selectedProject",e.timeEntry.project)("selectedTask",e.timeEntry.task)("hideWorkspaces",!0)}}const QO=function(e){return{"cl-entry-tag-dropdown":e}};function JO(e,t){if(1&e){const e=s.Yb();s.Xb(0,"tag-dropdown",29),s.jc("close",(function(t){return s.Oc(e),s.nc().selectTags(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("ngClass",s.Bc(4,QO,!e.isManual))("resizeableName","tagPicker")("resizeToLeft",!e.isManual)("entryTags",e.timeEntry.tags)}}function ev(e,t){if(1&e){const e=s.Yb();s.Xb(0,"billable-icon",30),s.jc("changed",(function(t){return s.Oc(e),s.nc().changeBillable(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("billable",e.timeEntry.billable)}}function tv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"stopwatch",31,32),s.jc("setEntry",(function(t){return s.Oc(e),s.nc().setEntry(t)}))("stopped",(function(t){return s.Oc(e),s.nc().onStopped(t)}))("canceled",(function(){return s.Oc(e),s.nc().onCancel()}))("canceledFailed",(function(t){return s.Oc(e),s.nc().onCancelFailed(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("timeEntry",e.timeEntry)("disableManualMode",e.disableManualMode)("isEntryInitialized",e.isEntryInitialized)}}function nv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"single-date-picker2",39),s.jc("pickedDate",(function(t){return s.Oc(e),s.nc(2).dateTimeManualChanged(t)})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("textualDate",!0)("focusOnInput",!0)("debounce",!1)("dateTime",e.timeEntry.timeInterval)("canTriggerNextDay",!0)}}const iv=function(e){return{"cl-disabled":e}};function sv(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xc(1,nv,1,5,"single-date-picker2",33),s.Xb(2,"div",34),s.Xb(3,"input-duration",35),s.jc("onFocus",(function(){return s.Oc(e),s.nc().closeDatepicker()}))("timeChanged",(function(t){return s.Oc(e),s.nc().dateTimeManualChanged(t)})),s.Wb(),s.Wb(),s.Xb(4,"div",36),s.jc("click",(function(){return s.Oc(e),s.nc().createTimeEntryManually()}))("keyup.space",(function(){return s.Oc(e),s.nc().createTimeEntryManually()}))("keyup.enter",(function(){return s.Oc(e),s.nc().createTimeEntryManually()})),s.Xb(5,"a",37),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"a",38),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.timeEntry.timeInterval),s.Cb(2),s.wc("format",e.format)("focusOnInput",!0)("timeInterval",e.timeEntry.timeInterval),s.Cb(1),s.wc("ngClass",s.Bc(11,iv,e.disableAddButton)),s.Cb(2),s.ad(s.pc(7,7,"GLOBAL.ADD_LABEL")),s.Cb(3),s.ad(s.pc(10,9,"GLOBAL.ADD_LABEL"))}}function cv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"modes-btns",40,41),s.jc("setIsManual",(function(t){return s.Oc(e),s.nc().setIsManual(t)})),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("autoClose","inside")("ngbTooltip",s.pc(2,4,"TRACKER.TIME_TRACKER.RECORDER.ADD_TIME_MANUALLY_TOOLTIP"))("disableManualMode",e.disableManualMode)("isManual",e.isManual)}}function av(e,t){if(1&e){const e=s.Yb();s.Xb(0,"custom-fields-values",42),s.jc("entryChanged",(function(t){return s.Oc(e),s.nc().customFieldValueChanged(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("timeEntryId",e.timeEntry.id)("projectId",null==e.timeEntry.project?null:e.timeEntry.project.id)("customFields",e.customFields)("customFieldValues",e.timeEntry.id?e.timeEntry.customFieldValues:e.defaultForProjectValues)}}var ov=function(e){return e.MANUAL="tooltipManual",e.PROJECT="tooltipProject",e.DESCRIPTION="tooltipDescription",e}({});let rv=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r,l,b,d,u,h,m,g){this.entryHelper=e,this.entryGroupService=t,this.activatedRoute=n,this.authService=i,this.userService=s,this.stopwatchService=c,this.debouncerService=a,this.trackerService=o,this.tagService=r,this.modalService=l,this.toaster=b,this.keyboardService=d,this.browserService=u,this.workspaceService=h,this.translate=m,this.cd=g,this.inProgress=!1,this.billableBackup=!1,this.unsubscribe$=new p.a,this.sortByTagNameMapper=e=>e.name}set setCustomFields(e){e&&(this.customFields=e)}set entryInProgress(e){if(e){if(e.id){this.setIsManual(!1);const t=new Date(e.timeInterval.start).getTime()/100;this.stopwatchService.setStart(t),this.timeEntry=e,this.projectAttributeTitle=Object(sn.o)(e,this.translate.instant("GLOBAL.PROJECT_LABEL"),this.translate.instant("GLOBAL.TASK_LABEL"))}else this.stopwatchService.stop();this.isEntryInitialized=!0,this.cd.detectChanges()}}set disableManualMode(e){this._disableManualMode=e,e&&this.isManual&&this.setIsManual(!1)}get disableManualMode(){return this._disableManualMode}ngOnInit(){this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.isDesktop=window.innerWidth>=In.h,this.isNew="true"===localStorage.getItem("isNew"),this.profile=this.authService.getUser(),this.isManual=this.profile.settings.timeTrackingManual&&!this.disableManualMode,this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.resetTimeEntry(),this.subscribeToPlay(),this.subscribeToKeyboard(),this.stopwatchService.stateChanged.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{e==VA.b.STARTED?(this.inProgress=!0,this.isNew&&(this.openTooltip(ov.PROJECT),this.stopwatch&&this.stopwatch.closeTooltip()),this.cd.detectChanges()):e==VA.b.STOPPED&&(this.inProgress=!1,this.cd.detectChanges())}),this.stopwatchService.timeEntryStoppedSocket$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.resetTimeEntry()}),this.authService.user.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.profile=e,this.inProgress||this.setIsManual(this.profile.settings.timeTrackingManual,!1),this.cd.detectChanges()}),this.activatedRoute.queryParams.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{const t=e&&"manual"===e.mode;t&&(this.setIsManual(t,!1),this.cd.detectChanges())})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}ngAfterViewInit(){this.isNew&&(this.openTooltip(ov.DESCRIPTION),this.stopwatch&&this.stopwatch.showTooltip())}autocompleteSelect(e){this.timeEntry.description=e.description,this.timeEntry.billable=e.project?e.project.billable:this.timeEntry.billable,this.timeEntry.project=e.project,this.timeEntry.task=e.task,this.timeEntry.tags=e.tags,this.isManual?this.datePicker.setFocusToStartTime():this.inProgress?this.trackerService.updateEntryWithBulk(this.timeEntry,[TO.a.DESCRIPTION,TO.a.BILLABLE,TO.a.PROJECT,TO.a.TASK,TO.a.TAG]).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.timeEntry.customFieldValues=e.customFieldValues,this.timeEntry.billable=e.billable,this.setFocusToDescription(),this.cd.detectChanges()}):(this.stopwatch.start(),this.setFocusToDescription())}subscribeToPlay(){this.entryGroupService.entryToPlay$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.setIsManual(!1),this.projectAttributeTitle=Object(sn.o)(e,this.translate.instant("GLOBAL.PROJECT_LABEL"),this.translate.instant("GLOBAL.TASK_LABEL")),this.inProgress?this.stopwatch.stop(e):this.stopwatch.start(e),this.browserService.scrollToTop()})}setIsManual(e,t=!0){e!=this.isManual&&(this.disableManualMode?this.isManual=!1:(this.isManual=e,t&&this.userService.updateTimeTrackingSettings(this.profile,this.isManual),this.isManual?(this.closeTooltip(ov.MANUAL),this.manualAlreadyVisited=!0):(this.cd.detectChanges(),this.isNew&&this.stopwatch&&this.stopwatch.showTooltip())))}setEntry(e){this.timeEntry=e,this.timeEntry.description=Object(sn.G)(this.timeEntry.description,this.toaster,this.translate),this.cd.detectChanges()}onStopped(e){this.setNotNew(),this.billableBackup=e.billable,this.setFocusToDescription(),this.resetTimeEntry()}onCancel(){this.resetTimeEntry()}onCancelFailed(e){this.timeEntry=e,this.cd.detectChanges()}setNotNew(){this.isNew?(this.closeTooltip(ov.PROJECT),this.isNew=!1,this.closeTooltip(ov.DESCRIPTION),localStorage.setItem("isNew","false"),this.isManual||this.manualAlreadyVisited||this.disableManualMode||this.openTooltip(ov.MANUAL)):this.isManual&&this.closeTooltip(ov.MANUAL)}resetTimeEntry(e=null){const t=this.setInterval(e);this.timeEntry=new en.a({billable:this.billableBackup,timeInterval:t}),this.setDefaultCustomField(),this.cd.detectChanges()}setDefaultCustomField(e){const t=[];this.customFields.forEach(n=>{const i=new oO.a({customFieldId:n.id,customField:n,value:e&&n.getProjectValue(e.project.id)?n.getProjectValue(e.project.id).value:n.workspaceDefaultValue});t.push(i)}),this.defaultForProjectValues=t}setInterval(e=null){let t;if(e){const n=ke(e.start),i=ke(e.end),s=ke.duration(i.diff(n)),c=ke(i).clone().add(s,"s");t=new ZA.a({start:i.toISOString(),end:c.toISOString(),duration:s})}else{const e=ke().set({second:0,millisecond:0}),n=ke.duration(e.diff(e)).toISOString();t=new ZA.a({start:e.toISOString(),end:e.toISOString(),duration:n})}return t}dateTimeManualChanged(e){if(this.timeEntry.timeInterval=new ZA.a(e),!this.timeEntry.id)return;const t=new ZA.a(this.timeEntry.timeInterval);this.trackerService.editTimeInterval(this.timeEntry.id,this.timeEntry.timeInterval).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{},e=>{this.timeEntry.timeInterval=t,this.cd.detectChanges()})}changeBillable(e){if(!this.timeEntry.id)return void(this.timeEntry.billable=e);const t=this.timeEntry.billable;t!==e&&(this.timeEntry.billable=e,this.trackerService.updateBillable(this.timeEntry.id,e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.billableBackup=e,this.timeEntry.billable=t.billable,this.cd.detectChanges()},()=>{this.timeEntry.billable=t,this.cd.detectChanges()}))}saveCurrentEntry(e){if(this.isManual)return this.timeEntry.description=e,void this.createTimeEntryManually();this.stopwatch||this.cd.detectChanges(),this.inProgress?e!==this.timeEntry.description&&(this.timeEntry.description=e,this.updateDescription()):(this.timeEntry.description=e,this.stopwatch.start())}createTimeEntryManually(){this.disableAddButton=!0,setTimeout(()=>{if(this.setNotNew(),!this.entryHelper.isValid(this.timeEntry))return this.disableAddButton=!1,void this.cd.detectChanges();this.timeEntry.description=Object(sn.G)(this.timeEntry.description,this.toaster,this.translate),this.billableBackup=this.timeEntry.billable;const e=new ZA.a(this.timeEntry.timeInterval);this.trackerService.createTimeEntry(this.timeEntry).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.entryGroupService.setNewEntryCreated(t),this.setFocusToDescription(),this.resetTimeEntry(e),this.disableAddButton=!1,this.cd.detectChanges()},e=>{this.disableAddButton=!1,this.cd.detectChanges()})},2)}updateDescription(){this.closeTooltip(ov.DESCRIPTION),this.timeEntry.description=Object(sn.G)(this.timeEntry.description,this.toaster,this.translate),this.timeEntry.id&&(this.entryHelper.validateDescription(this.timeEntry.description)?(this.debouncerService.debouncer$.pipe(Object(ln.a)(1),Object(Zt.a)(e=>e),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.trackerService.updateDescription(this.timeEntry.id,this.timeEntry.description).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{})}),this.debouncerService.next(!0)):this.timeEntry.description=this.backupDescription)}selectTags(e){if(!e)return;if(!this.timeEntry.id){const t=this.tagService.sortTags(e);return this.timeEntry.tags=t,void this.cd.markForCheck()}const t=this.tagService.sortTags(e);if(this.timeEntry.tags=t,!this.entryHelper.validateTag(e))return;const n=Object(sn.f)(this.timeEntry.tags);this.timeEntry.tags=e,this.cd.markForCheck(),this.debouncerService.debouncer$.pipe(Object(ln.a)(1),Object(Zt.a)(e=>e),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.trackerService.updateTags(this.timeEntry.id,e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{},e=>{this.timeEntry.tags=n,this.cd.detectChanges()})}),this.debouncerService.next(!0)}selectProjectAndTask(e,t){if(t&&t.focus(),!this.timeEntry.id)return this.setProjectAndTask(e),void(e&&e.project&&(this.timeEntry.billable=this.workspace.taskBillableEnabled&&e.task?e.task.billable:e.project.billable));if(!this.entryHelper.validateProjectAndTask(e))return;const n=Object(sn.f)(this.timeEntry.project),i=Object(sn.f)(this.timeEntry.task);this.setProjectAndTask(e),this.debouncerService.debouncer$.pipe(Object(ln.a)(1),Object(Zt.a)(e=>e),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.trackerService.updateProjectAndTask(this.timeEntry).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.timeEntry.billable!=e.billable&&(this.timeEntry.billable=e.billable,this.cd.detectChanges()),this.timeEntry.customFieldValues=e.customFieldValues,this.cd.detectChanges()},e=>{this.setProjectAndTask({project:n,task:i})})}),this.debouncerService.next(!0)}setProjectAndTask(e){this.timeEntry.project=e.project,this.timeEntry.project&&(this.timeEntry.project.clientName=this.timeEntry.project&&this.timeEntry.project.client&&this.timeEntry.project.client.name||this.timeEntry.project.clientName),this.timeEntry.task=e.task,this.projectAttributeTitle=Object(sn.o)(e,this.translate.instant("GLOBAL.PROJECT_LABEL"),this.translate.instant("GLOBAL.TASK_LABEL")),this.timeEntry=en.a.clone(this.timeEntry),this.setDefaultCustomField(e),this.cd.detectChanges()}setFocusToDescription(){this.autocompleteComponent&&window.innerWidth>=In.h&&this.autocompleteComponent.focusToInput()}closeDatepicker(){this.datePicker&&this.datePicker.closeDatepicker(!0)}closeTooltip(e){this[e]&&this[e].close()}openTooltip(e){this[e]&&this[e].open()}subscribeToKeyboard(){this.keyboardService.keyboardRecorder$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{if(!this.modalService.hasOpenModals()){if(e===_b.e){if(this.inProgress||this.disableManualMode)return;return this.setIsManual(!0),this.setFocusToDescription(),void this.cd.detectChanges()}if(e===_b.f&&(this.setIsManual(!1),this.setFocusToDescription(),this.inProgress?this.stopwatch.stop(null,!0):this.stopwatch.start()),e===_b.c){let e;this.setIsManual(!1),this.setFocusToDescription(),this.entryGroups[0]&&this.entryGroups[0].timeEntries[0]&&(e=en.a.clone(this.entryGroups[0].timeEntries[0])),this.inProgress?this.stopwatch.stop(e):(this.browserService.scrollToTop(),this.stopwatch.start(e))}}})}customFieldValueChanged(e){this.timeEntry.customFieldValues=e}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(NA.a),s.Rb(XA.a),s.Rb(k.a),s.Rb(re.a),s.Rb(Lc.a),s.Rb(VA.a),s.Rb(Me),s.Rb(WA.a),s.Rb(vn.a),s.Rb(w.q),s.Rb(r.a),s.Rb(PA.a),s.Rb(Gn.a),s.Rb(l.a),s.Rb(g.f),s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["time-tracker-recorder"]],viewQuery:function(e,t){var n;1&e&&(s.gd(HO,!0),s.gd(vO,!0),s.gd(zr.a,!0),s.gd($O,!0),s.gd(KO,!0),s.gd(qO,!0)),2&e&&(s.Kc(n=s.kc())&&(t.stopwatch=n.first),s.Kc(n=s.kc())&&(t.autocompleteComponent=n.first),s.Kc(n=s.kc())&&(t.datePicker=n.first),s.Kc(n=s.kc())&&(t.tooltipDescription=n.first),s.Kc(n=s.kc())&&(t.tooltipProject=n.first),s.Kc(n=s.kc())&&(t.tooltipManual=n.first))},inputs:{entryGroups:"entryGroups",format:"format",setCustomFields:"setCustomFields",entryInProgress:"entryInProgress",projectData:"projectData",disableManualMode:"disableManualMode"},decls:31,vars:28,consts:[["tabRow","",1,"cl-card","cl-border-bottom","cl-mb-0"],[1,"cl-component-row","cl-p-0","cl-border-0"],[1,"cl-row","cl-no-gutters","cl-w-100","cl-d-flex","cl-align-items-center"],[1,"cl-col"],[1,"cl-row","cl-align-items-center","cl-pl-lg-2","cl-py-2","cl-py-lg-custom-0","cl-w-100"],[1,"cl-col","cl-ml-2","cl-ml-lg-0"],["triggers","manual","placement","bottom",3,"autoClose","ngbTooltip","id","autofocus","placeholder","description","onEnter","onChange","onSelect","onFocus"],["tooltipDescription","ngbTooltip"],[1,"cl-col-auto","cl-pl-0","cl-pr-3"],[1,"recorder-project-wrapper"],["dropdownKey","","tabCell","",1,"cl-dropdown","cl-dropdown-large","cl-d-flex",3,"click"],["triggers","manual","placement","bottom",1,"cl-cut-text","cl-w-100-hidden",3,"autoClose","ngbTooltip"],["tooltipProject","ngbTooltip"],[3,"isDisabled","project","projectData","task"],["class","cl-dropdown-menu recorder-project-picker","resizeable","",3,"resizeableName","selectedProject","selectedTask","hideWorkspaces","selectedProjectAndTask","onResize",4,"dropdownKeyContent"],["tabFocus","","tabindex","0"],["projectTabFocus",""],[1,"cl-col-lg-custom-auto"],[1,"cl-timetracker-entry-actions","cl-d-flex","cl-justify-content-between","cl-justify-content-lg-custom-end","cl-py-2",2,"position","relative"],["dropdownKey","","tabCell","",1,"cl-dropdown"],["dropdownKeyButton","","tabindex","0",1,"pointer",3,"tags"],["class","cl-dropdown-menu","resizeable","",3,"ngClass","resizeableName","resizeToLeft","entryTags","close",4,"dropdownKeyContent"],["class","cl-component-divided-left",3,"billable","changed",4,"ngIf"],["style","display: flex;",3,"timeEntry","disableManualMode","isEntryInitialized","setEntry","stopped","canceled","canceledFailed",4,"ngIf"],[4,"ngIf"],["style","position: relative;","triggers","manual","placement","left",3,"autoClose","ngbTooltip","disableManualMode","isManual","setIsManual",4,"ngIf"],[3,"timeEntryId","projectId","customFields","customFieldValues","entryChanged",4,"ngIf"],["resizeable","",1,"cl-dropdown-menu","recorder-project-picker",3,"resizeableName","selectedProject","selectedTask","hideWorkspaces","selectedProjectAndTask","onResize"],["projectPickerEl",""],["resizeable","",1,"cl-dropdown-menu",3,"ngClass","resizeableName","resizeToLeft","entryTags","close"],[1,"cl-component-divided-left",3,"billable","changed"],[2,"display","flex",3,"timeEntry","disableManualMode","isEntryInitialized","setEntry","stopped","canceled","canceledFailed"],["stopwatch",""],["class","cl-d-flex cl-w-100 cl-mobile-hide-input-date-picker",3,"textualDate","focusOnInput","debounce","dateTime","canTriggerNextDay","pickedDate",4,"ngIf"],[1,"cl-component-divided-left","cl-d-sm-inline-flex","cl-input-time-wrapper","cl-d-none"],[3,"format","focusOnInput","timeInterval","onFocus","timeChanged"],["tabindex","0","data-cy","add-btn",3,"ngClass","click","keyup.space","keyup.enter"],[1,"cl-btn","cl-btn-primary","cl-d-none","cl-d-lg-custom-block"],[1,"cl-btn","cl-btn-primary","cl-btn-sm","cl-d-block","cl-d-lg-custom-none"],[1,"cl-d-flex","cl-w-100","cl-mobile-hide-input-date-picker",3,"textualDate","focusOnInput","debounce","dateTime","canTriggerNextDay","pickedDate"],["triggers","manual","placement","left",2,"position","relative",3,"autoClose","ngbTooltip","disableManualMode","isManual","setIsManual"],["tooltipManual","ngbTooltip"],[3,"timeEntryId","projectId","customFields","customFieldValues","entryChanged"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"form",5),s.Xb(6,"autocomplete-input",6,7),s.jc("onEnter",(function(e){return t.saveCurrentEntry(e)}))("onChange",(function(e){return t.timeEntry.description=e,t.updateDescription()}))("onSelect",(function(e){return t.autocompleteSelect(e)}))("onFocus",(function(){return t.backupDescription=t.timeEntry.description})),s.oc(8,"translate"),s.oc(9,"translate"),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Xb(11,"div",8),s.Xb(12,"div",9),s.Xb(13,"div",10),s.jc("click",(function(){s.Oc(e);const t=s.Lc(15);return t&&t.close()})),s.Xb(14,"div",11,12),s.oc(16,"translate"),s.Sb(17,"project-picker-label",13),s.Wb(),s.Xc(18,zO,2,4,"project-picker",14),s.Sb(19,"span",15,16),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(21,"div",17),s.Xb(22,"div",18),s.Xb(23,"div",19),s.Sb(24,"tag-names",20),s.Xc(25,JO,1,6,"tag-dropdown",21),s.Wb(),s.Xc(26,ev,1,1,"billable-icon",22),s.Xc(27,tv,2,3,"stopwatch",23),s.Xc(28,sv,11,13,"ng-container",24),s.Xc(29,cv,3,6,"modes-btns",25),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(30,av,1,4,"custom-fields-values",26),s.Wb()}2&e&&(s.Cb(6),s.wc("autoClose","inside")("ngbTooltip",s.pc(8,20,"TRACKER.TIME_TRACKER.DESCRIPTION_TOOLTIP"))("id",t.timeEntry.id)("autofocus",t.isDesktop)("placeholder",t.isManual?s.pc(9,22,"GLOBAL.FORM_LABEL_DESCRIPTION_PLACEHOLDER"):s.pc(10,24,"TRACKER.TIME_TRACKER.ENTRY.TRACK.PLACEHOLDER.TIMER"))("description",t.timeEntry.description),s.Cb(6),s.Hb("cl-recorder-has-tags",t.timeEntry.tags&&t.timeEntry.tags.length>0),s.Cb(2),s.xc("ngbTooltip",s.pc(16,26,"TRACKER.TIME_TRACKER.CATEGORIZE_TOOLTIP_MSG")),s.wc("autoClose","inside"),s.Cb(3),s.wc("isDisabled",!1)("project",t.timeEntry.project)("projectData",t.projectData)("task",t.timeEntry.task),s.Cb(7),s.wc("tags",t.timeEntry.tags),s.Cb(2),s.wc("ngIf",t.workspace.activeBillableHours&&(!t.workspace.onlyAdminsCanChangeBillableStatus||t.isAdminOrOwner)),s.Cb(1),s.wc("ngIf",!t.isManual),s.Cb(1),s.wc("ngIf",t.isManual),s.Cb(1),s.wc("ngIf",!t.inProgress),s.Cb(1),s.wc("ngIf",(null==t.customFields?null:t.customFields.length)>0))},directives:[v.I,v.t,v.u,vO,w.bb,ni.a,IO.a,si.a,XO,ii.a,i.u,NO.a,DO.a,PO.a,i.r,MO.a,aO,BO.a,zr.a,VO,YO.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var lv=n("1k8b"),bv=n("eBys"),dv=n("znhS");function uv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",8),s.Xb(1,"input",9),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().toggleSelectAll(t)})),s.Wb(),s.Sb(2,"label",10),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.xc("id",e.date),s.wc("indeterminate",e.numberOfSelected>0&&e.numberOfSelected<e.numberOfEntries)("ngModel",e.numberOfSelected===e.numberOfEntries&&e.numberOfSelected>0),s.Cb(1),s.xc("for",e.date)}}function pv(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"span",11),s.jc("click",(function(){return s.Oc(e),s.nc().bulkEdit.emit()})),s.Xb(2,"a",12),s.Xb(3,"span",13),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"span",14),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(9,"span",11),s.jc("click",(function(){return s.Oc(e),s.nc().bulkDelete.emit()})),s.Xb(10,"a",15),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb(),s.Ub()}2&e&&(s.Cb(4),s.ad(s.pc(5,3,"GLOBAL.BULK_EDIT_LABEL")),s.Cb(3),s.ad(s.pc(8,5,"GLOBAL.EDIT_LABEL")),s.Cb(4),s.ad(s.pc(12,7,"GLOBAL.DELETE_BTN")))}function hv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",16,17),s.jc("keyup.enter",(function(){return s.Oc(e),s.nc().toggleEditMode()}))("keyup.space",(function(){return s.Oc(e),s.nc().toggleEditMode()}))("click",(function(){s.Oc(e);const t=s.Lc(1);return s.nc().toggleEditMode(),t.blur()})),s.oc(2,"translate"),s.Sb(3,"img",18),s.Wb()}2&e&&s.xc("title",s.pc(2,1,"GLOBAL.BULK_EDIT_LABEL"))}let mv=(()=>{class e{constructor(e,t,n){this.entryBulk=e,this.cd=t,this.changedDayService=n,this.setSelectAll=new s.n,this.bulkEdit=new s.n,this.bulkDelete=new s.n,this.changeEditMode=new s.n,this.unsubscribe$=new p.a,this.triggerPipe=!1}toggleEditMode(){this.changeEditMode.emit(!this.editMode),this.editMode=!this.editMode}toggleSelectAll(e){this.entryBulk.setSelectAll(e)}ngOnInit(){this.entryBulk.numberOfEntries$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.numberOfEntries=e,this.cd.detectChanges()}),this.entryBulk.numberOfSelected$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.numberOfSelected=e,this.cd.detectChanges()}),this.changedDayService.changeDayTrigger$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{const e=ke().startOf("day").diff(ke(this.date),"days");e<3&&e>=0&&(this.triggerPipe=!this.triggerPipe,this.cd.detectChanges())})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(xe),s.Rb(s.h),s.Rb(lv.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["entry-group-header"]],inputs:{date:"date",time:"time",format:"format",disableEdit:"disableEdit",editMode:"editMode"},outputs:{setSelectAll:"setSelectAll",bulkEdit:"bulkEdit",bulkDelete:"bulkDelete",changeEditMode:"changeEditMode"},decls:15,vars:15,consts:[[1,"cl-card-header","cl-px-2","cl-px-lg-3"],[1,"cl-h6","cl-mb-0","cl-pl-2","cl-pl-lg-0","cl-d-flex","cl-align-items-center"],["class","cl-custom-control cl-custom-checkbox",4,"ngIf"],[4,"ngIf"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-h6","cl-lh-1","cl-align-self-end","cl-entry-total-label"],[1,"cl-h2","cl-mb-0","cl-ml-2","cl-lh-1"],["tabindex","0","class","cl-ml-2 cl-mr-1 cl-mr-lg-n1 cl-align-self-center cl-non-selectable",3,"title","keyup.enter","keyup.space","click",4,"ngIf"],[1,"cl-custom-control","cl-custom-checkbox"],["type","checkbox",1,"cl-custom-control-input",3,"id","indeterminate","ngModel","ngModelChange"],[1,"cl-custom-control-label",3,"for"],[1,"cl-bulk-edit-link",3,"click"],[1,"cl-color-blue"],[1,"remove-320-minus","cl-text-capitalize"],[1,"remove-321-plus","cl-text-capitalize"],[1,"cl-color-blue","cl-text-capitalize"],["tabindex","0",1,"cl-ml-2","cl-mr-1","cl-mr-lg-n1","cl-align-self-center","cl-non-selectable",3,"title","keyup.enter","keyup.space","click"],["bulkEdit",""],["src","assets/images/ui-icons/bulk-edit.svg"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xc(2,uv,3,4,"div",2),s.Xb(3,"span"),s.Zc(4),s.oc(5,"dateFormat"),s.Wb(),s.Xc(6,pv,13,9,"ng-container",3),s.Wb(),s.Xb(7,"div",4),s.Xb(8,"div",5),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Xb(11,"div",6),s.Zc(12),s.oc(13,"timeFormat"),s.Wb(),s.Xc(14,hv,4,3,"a",7),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.wc("ngIf",t.editMode),s.Cb(2),s.ad(s.rc(5,6,t.date,null,t.triggerPipe)),s.Cb(2),s.wc("ngIf",t.editMode&&t.numberOfSelected>0),s.Cb(3),s.ad(s.pc(10,10,"GLOBAL.TOTAL_TIME")),s.Cb(3),s.ad(s.qc(13,12,t.time,t.format)),s.Cb(2),s.wc("ngIf",!t.disableEdit&&t.numberOfEntries))},directives:[i.u,v.a,v.s,v.v],pipes:[bv.a,g.e,dv.a],encapsulation:2,changeDetection:0}),e})();var gv=n("9Eqt");function Ev(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.ad(e.weekLabel)}}function fv(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"momentUtcFormat"),s.Wb(),s.Xb(3,"span",10),s.Zc(4,"-"),s.Wb(),s.Xb(5,"span"),s.Zc(6),s.oc(7,"momentUtcFormat"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.ad(s.qc(2,2,e.weekStatus.dateRange.start,"MMM D")),s.Cb(5),s.ad(s.qc(7,5,e.weekStatus.dateRange.end,"MMM D"))}}function Sv(e,t){1&e&&(s.Vb(0),s.Xb(1,"span",12),s.oc(2,"translate"),s.Sb(3,"img",13),s.Wb(),s.Ub()),2&e&&(s.Cb(1),s.wc("ngbTooltip",s.pc(2,1,"TRACKER.APPROVALS.ZONE.MISMATCH")))}function Cv(e,t){1&e&&(s.Xb(0,"span",16),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.APPROVED_LABEL")," "))}function Av(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",18),s.Xb(2,"span",19),s.oc(3,"translate"),s.Zc(4),s.oc(5,"translate"),s.Xb(6,"span",20),s.jc("click",(function(){s.Oc(e);const t=s.nc(4),n=s.Lc(16);return t.openModal(n)})),s.oc(7,"translate"),s.Zc(8," \u2715 "),s.Wb(),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc(4);s.Cb(2),s.wc("title",s.pc(3,3,"APPROVAL.DETAILS.SUBMITTED_BY")+": "+(e.weekStatus.submitterName||e.approvalRequestCreator)),s.Cb(2),s.bd(" ",s.pc(5,5,"GLOBAL.PENDING_APPROVAL")," "),s.Cb(2),s.xc("title",s.pc(7,7,"GLOBAL.WITHDRAW_HEADER_APPROVAL"))}}function Ov(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",21),s.jc("click",(function(){s.Oc(e);const t=s.nc(4),n=s.Lc(14);return t.openModal(n)})),s.oc(1,"translate"),s.Zc(2),s.oc(3,"translate"),s.Wb()}2&e&&(s.xc("title",s.pc(1,2,"TRACKER.APPROVALS.SUBMIT_TIME.TITLE")),s.Cb(2),s.ad(s.pc(3,4,"GLOBAL.SUBMIT")))}function vv(e,t){if(1&e&&(s.Xc(0,Av,9,9,"ng-container",4),s.Xc(1,Ov,4,6,"a",17)),2&e){const e=s.nc(3);s.wc("ngIf",e.weekStatus.id),s.Cb(1),s.wc("ngIf",!e.weekStatus.id)}}function Tv(e,t){if(1&e&&(s.Xc(0,Cv,3,3,"span",14),s.Xc(1,vv,2,2,"ng-template",null,15,s.Yc)),2&e){const e=s.Lc(2),t=s.nc(2);s.wc("ngIf",t.weekStatus.isApprovedAllOnCurrentPage&&t.weekStatus.isApprovedAllOnOtherPages)("ngIfElse",e)}}function Iv(e,t){if(1&e&&(s.Vb(0),s.Xc(1,Sv,4,3,"ng-container",2),s.Xc(2,Tv,3,2,"ng-template",null,11,s.Yc),s.Ub()),2&e){const e=s.Lc(3),t=s.nc();s.Cb(1),s.wc("ngIf",t.timeZoneMissmatch)("ngIfElse",e)}}const wv=function(e,t){return{startDate:e,endDate:t}};function Lv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",22),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().submit(n)}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",23),s.Zc(4),s.oc(5,"translate"),s.oc(6,"momentUtcFormat"),s.oc(7,"momentUtcFormat"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,"GLOBAL.TIME_ENTRY_APPROVE_SUBMIT"))("btnText",s.pc(2,6,"GLOBAL.SUBMIT"))("inProgress",e.inProgress),s.Cb(4),s.bd(" ",s.qc(5,8,"TRACKER.APPROVALS.SUBMIT_APPROVAL_MSG",s.Cc(17,wv,s.qc(6,11,e.weekStatus.dateRange.start,"MMM D"),s.qc(7,14,e.weekStatus.dateRange.end,"MMM D")))," ")}}function Rv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",22),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().withdrawSubmission(n)}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",23),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,"GLOBAL.WITHDRAW_LABEL"))("btnText",s.pc(2,6,"TIMESHEET2.WITHDRAW"))("inProgress",e.inProgress),s.Cb(4),s.bd(" ",s.pc(5,8,"GLOBAL.WITHDRAW_MESSAGE")," ")}}let yv=(()=>{class e{constructor(e,t,n,i,c,a){this.modalService=e,this.approvalService=t,this.notificationService=n,this.cd=i,this.translate=c,this.analyticsService=a,this.onWithdraw=new s.n,this.onSubmit=new s.n,this.ApprovalStatus=Ht,this.unsubscribe$=new p.a}set weekStatus(e){this._weekStatus=e;const t=Object(_e.h)(ke(),this.startOfWeek);this.weekLabel=t.format("YYYY-MM-DD")===e.startDayOfWeek?this.translate.instant("TRACKER.APPROVAL.THIS_WEEK"):t.subtract(7,"days").format("YYYY-MM-DD")===e.startDayOfWeek?this.translate.instant("TRACKER.APPROVAL.LAST_WEEK"):""}get weekStatus(){return this._weekStatus}ngOnInit(){this.notificationService.timeZoneMissmatch$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.timeZoneMissmatch=e,this.cd.markForCheck()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}openModal(e){this.modalService.open(e,{centered:!0})}submit(e){this.inProgress=!0,this.approvalService.createSubmitRequest(this.weekStatus.startDayOfWeek).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.approvalRequestCreator=t.creator.userName,this.onSubmit.emit({id:t.id,startDayOfWeek:this.weekStatus.startDayOfWeek}),this.inProgress=!1,e.close(),this.cd.detectChanges(),this.analyticsService.addEvent(new Fi.a({event:"Submit",value:"Submit for approval",section:"Time Tracker",section2:"Submit week for approval"}))},()=>{this.inProgress=!1})}withdrawSubmission(e){this.inProgress=!0,this.approvalService.withdrawSubmission(this.weekStatus.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.onWithdraw.emit({startDayOfWeek:this.weekStatus.startDayOfWeek}),this.inProgress=!1,e.close(),this.cd.detectChanges()},()=>{this.inProgress=!1})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q),s.Rb(rn),s.Rb(Gm.a),s.Rb(s.h),s.Rb(g.f),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["approval-header"]],inputs:{startOfWeek:"startOfWeek",weekStatus:"weekStatus",format:"format",timeApprovalEnabled:"timeApprovalEnabled"},outputs:{onWithdraw:"onWithdraw",onSubmit:"onSubmit"},decls:17,vars:10,consts:[[1,"cl-d-flex","cl-align-items-center","cl-position-relative"],[1,"cl-d-flex","cl-flex-column","cl-flex-sm-row","cl-mr-3"],[4,"ngIf","ngIfElse"],["fromToDateTemplate",""],[4,"ngIf"],[1,"cl-d-flex","cl-align-items-end","cl-mt-2","cl-mt-lg-0"],[1,"cl-h6","cl-mb-0","cl-lh-1"],[1,"cl-h2","cl-mb-0","cl-ml-2","cl-lh-1"],["submitApprovalModal",""],["witdhDrawApprovalModal",""],[1,"cl-d-none","cl-d-sm-inline-flex","cl-mx-1"],["approvalFeatureTemplate",""],["placement","right",3,"ngbTooltip"],["src","assets/images/ui-icons/icon-warning.svg"],["class","cl-badge-approve cl-approve-status-approved",4,"ngIf","ngIfElse"],["submitAndPendingTemplate",""],[1,"cl-badge-approve","cl-approve-status-approved"],["class","cl-small",3,"title","click",4,"ngIf"],[1,"cl-mr-3"],[1,"cl-badge-approve","cl-approve-status-pending",3,"title"],[1,"pointer","cl-ml-1",3,"title","click"],[1,"cl-small",3,"title","click"],[3,"title","btnText","inProgress","confirmed","close"],[1,"cl-text-dark","cl-mb-0"]],template:function(e,t){if(1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xc(2,Ev,2,1,"span",2),s.Xc(3,fv,8,8,"ng-template",null,3,s.Yc),s.Wb(),s.Xc(5,Iv,4,2,"ng-container",4),s.Wb(),s.Xb(6,"div",5),s.Xb(7,"div",6),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Xb(10,"div",7),s.Zc(11),s.oc(12,"timeFormat"),s.Wb(),s.Wb(),s.Xc(13,Lv,8,20,"ng-template",null,8,s.Yc),s.Xc(15,Rv,6,10,"ng-template",null,9,s.Yc)),2&e){const e=s.Lc(4);s.Cb(2),s.wc("ngIf",t.weekLabel)("ngIfElse",e),s.Cb(3),s.wc("ngIf",t.timeApprovalEnabled),s.Cb(3),s.ad(s.pc(9,5,"TRACKER.TIME_TRACKER.WEEK_TOTAL")),s.Cb(3),s.bd(" ",s.qc(12,7,t.weekStatus.total,t.format)," ")}},directives:[i.u,w.bb,Si.a],pipes:[g.e,dv.a,gv.a],encapsulation:2,changeDetection:0}),e})();const _v=["tabFocusDuplicate"];let kv=(()=>{class e{constructor(e,t,n,i,c,a,o,r,l,b){this.trackerService=e,this.entryHelper=t,this.entryGroupService=n,this.toaster=i,this.keyboardService=c,this.modalService=a,this.entryBulk=o,this.workspaceService=r,this.translate=l,this.cd=b,this.entryIsDeleted=new s.n,this.unsubscribe$=new p.a}set isAdminOrOwner(e){void 0!==e&&(this._isAdminOrOwner=e,this.checkIsEnableToEdit())}get isAdminOrOwner(){return this._isAdminOrOwner}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.subscribeToBulkChange(),this.projectAttributeTitle=Object(sn.o)(this.timeEntry,this.translate.instant("GLOBAL.PROJECT_LABEL"),this.translate.instant("GLOBAL.TASK_LABEL"))}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}checkIsEnableToEdit(){this.disableEdit=this.timeEntry.isLocked&&!this.isAdminOrOwner||!!this.timeEntry.approvalRequestId}duplicateEntry(){this.disableManualModeEdit||(this.trackerService.duplicateTimeEntry(this.timeEntry.children?this.timeEntry.children[0]:this.timeEntry).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.entryGroupService.setNewEntryCreated(e)}),this.focusToRowEnd())}setEntryToPlay(){this.entryGroupService.setEntryToPlay(this.timeEntry.children?this.timeEntry.children[0]:this.timeEntry)}deleteTimeEntryConfirmed(){}dateTimeChanged(e){}setProjectToEntry(e,t){var n;t.project=e.project,t.project&&(t.project.clientName=(null===(n=t.project.client)||void 0===n?void 0:n.name)||t.project.clientName),t.task=e.task,this.projectAttributeTitle=Object(sn.o)(e,this.translate.instant("GLOBAL.PROJECT_LABEL"),this.translate.instant("GLOBAL.TASK_LABEL"))}openDeleteModal(e){this.entriesToModify=this.timeEntry.children&&this.timeEntry.children.length||null,this.keyboardService.removeListener(),this.modalService.open(e,{centered:!0}).result.then(e=>{e&&this.deleteTimeEntryConfirmed(),this.focusToRowEnd(),this.keyboardService.addListener()},e=>{this.focusToRowEnd(),this.keyboardService.addListener()})}toggleCollapseSameEntries(e){this.timeEntry.children&&(this.timeEntry.expanded=!this.timeEntry.expanded,e&&e.stopPropagation())}focusToRowEnd(){this.tabFocusDuplicate&&this.tabFocusDuplicate.nativeElement.focus()}subscribeToBulkChange(){this.entryBulk.selectAllChanged$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{if(this.timeEntry.children)this.timeEntry.children.forEach(t=>{this.disableEdit||(t.bulkEdit=e)});else{if(this.disableEdit)return;this.timeEntry.bulkEdit=e}this.cd.detectChanges()})}closeDatepicker(){this.datepicker&&this.datepicker.closeDatepicker(!0)}selectProjectAndTask(e,t){t&&t.focus();const n={project:Object(sn.f)(this.timeEntry.project),task:Object(sn.f)(this.timeEntry.task),workspaceId:this.timeEntry.workspaceId};if(this.setProjectToEntry(e,this.timeEntry),!this.entryHelper.validateProjectAndTask(e))return;const i=e&&e.workspace&&e.workspace.id,s=this.timeEntry.workspaceId;this.timeEntry.workspaceId=i,this.saveProjectAndTask(n,s,i,e)}saveProjectAndTask(e,t,n,i){}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(WA.a),s.Rb(NA.a),s.Rb(XA.a),s.Rb(r.a),s.Rb(PA.a),s.Rb(w.q),s.Rb(xe),s.Rb(l.a),s.Rb(g.f),s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["time-entry-base"]],viewQuery:function(e,t){var n;1&e&&(s.gd(zr.a,!0),s.gd(MO.a,!0),s.gd(_v,!0)),2&e&&(s.Kc(n=s.kc())&&(t.datepicker=n.first),s.Kc(n=s.kc())&&(t.billableComponent=n.first),s.Kc(n=s.kc())&&(t.tabFocusDuplicate=n.first))},inputs:{format:"format",timeEntry:"timeEntry",editMode:"editMode",hideWorkspacesInPicker:"hideWorkspacesInPicker",customFields:"customFields",isAdminOrOwner:"isAdminOrOwner",disableManualModeEdit:"disableManualModeEdit",projectData:"projectData"},outputs:{entryIsDeleted:"entryIsDeleted"},decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0}),e})();function Wv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"input",38),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc(2).timeEntry.bulkEdit=t}))("change",(function(){s.Oc(e);const t=s.nc(2);return t.signleBulkChange(t.timeEntry.bulkEdit)}))("keyup.enter",(function(){s.Oc(e);const t=s.nc(2);return t.timeEntry.bulkEdit=!t.timeEntry.bulkEdit,t.signleBulkChange(t.timeEntry.bulkEdit)})),s.Wb()}if(2&e){const e=s.nc(2);s.yc("id","edit_",e.timeEntry.id,""),s.wc("ngModel",e.timeEntry.bulkEdit)}}function Xv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"input",39),s.jc("change",(function(){return s.Oc(e),s.nc(2).groupBulkChange()}))("keyup.enter",(function(){return s.Oc(e),s.nc(2).groupBulkChange()})),s.Wb()}if(2&e){const e=s.nc(2);s.yc("id","edit_",e.timeEntry.id,""),s.wc("ngModel",e.bulkSelected===e.allChilds)("indeterminate",e.bulkSelected>0&&e.bulkSelected<e.allChilds)}}function Nv(e,t){if(1&e&&(s.Xb(0,"div",34),s.Xc(1,Wv,1,2,"input",35),s.Xc(2,Xv,1,3,"input",36),s.Sb(3,"label",37),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",!(null!=e.timeEntry&&null!=e.timeEntry.children&&e.timeEntry.children.length)),s.Cb(1),s.wc("ngIf",null==e.timeEntry||null==e.timeEntry.children?null:e.timeEntry.children.length),s.Cb(1),s.yc("for","edit_",e.timeEntry.id,"")}}const Dv=function(e){return{count:e}};function Pv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",40),s.jc("keyup.space",(function(){return s.Oc(e),s.nc().toggleCollapseSameEntries()}))("keyup.enter",(function(){return s.Oc(e),s.nc().toggleCollapseSameEntries()}))("click",(function(){return s.Oc(e),s.nc().toggleCollapseSameEntries()})),s.oc(1,"translate"),s.Xb(2,"span",41),s.Zc(3),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.qc(1,2,"TRACKER.TIME_TRACKER.ENTRY.GROUPS_TOOLTIP",s.Bc(5,Dv,e.childrenLength))),s.Cb(3),s.ad(e.childrenLength)}}function Mv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"project-picker",42,43),s.jc("selectedProjectAndTask",(function(t){s.Oc(e);const n=s.nc(),i=s.Lc(17);return n.selectProjectAndTask(t,i)}))("onResize",(function(t){return s.Oc(e),s.Lc(1).onResizeChange(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("selectedProject",e.timeEntry.project)("selectedTask",e.timeEntry.task)("hideWorkspaces",e.hideWorkspacesInPicker)("resizeableName","projectPicker")}}function Bv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"tag-dropdown",44),s.jc("close",(function(t){return s.Oc(e),s.nc().selectTags(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("entryTags",e.timeEntry.tags)("resizeableName","tagPicker")("resizeToLeft",!0)}}function Uv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"billable-icon",45),s.jc("changed",(function(t){return s.Oc(e),s.nc().changeBillable(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("disableEdit",e.disableEdit)("billable",e.timeEntry.billable)}}function Gv(e,t){if(1&e&&(s.Xb(0,"div"),s.Sb(1,"input",46),s.oc(2,"timeFormat"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngModel",s.qc(2,1,e.timeEntry.timeInterval.duration,e.format))}}function xv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"input-duration",47),s.jc("onFocus",(function(){return s.Oc(e),s.nc().closeDatepicker()}))("timeChanged",(function(t){return s.Oc(e),s.nc().dateTimeChanged(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("format",e.format)("timeInterval",e.timeEntry.timeInterval)("disable",e.disableEdit||(null==e.timeEntry.children?null:e.timeEntry.children.length))}}function Fv(e,t){1&e&&(s.Sb(0,"img",52),s.oc(1,"translate")),2&e&&s.xc("title",s.pc(1,1,"GLOBAL.APPROVED_ERROR_MESSAGE"))}function jv(e,t){1&e&&(s.Sb(0,"img",53),s.oc(1,"translate")),2&e&&s.xc("title",s.pc(1,1,"GLOBAL.ENTRIES_LOCKED_ERROR_MESSAGE"))}function Zv(e,t){if(1&e&&(s.Xb(0,"div",48),s.Xb(1,"div",49),s.Xc(2,Fv,2,3,"img",50),s.Xc(3,jv,2,3,"ng-template",null,51,s.Yc),s.Wb(),s.Wb()),2&e){const e=s.Lc(4),t=s.nc();s.Cb(2),s.wc("ngIf",t.timeEntry.approvalRequestId)("ngIfElse",e)}}function Vv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",63),s.jc("keyup.enter",(function(){return s.Oc(e),s.nc(4).duplicateEntry()}))("keyup.space",(function(){return s.Oc(e),s.nc(4).duplicateEntry()}))("click",(function(){return s.Oc(e),s.nc(4).duplicateEntry()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.DUPLICATE_BTN")," "))}function Yv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",60),s.Xb(1,"list-items"),s.Xc(2,Vv,3,3,"a",61),s.Xb(3,"a",62),s.jc("keyup.enter",(function(){s.Oc(e);const t=s.nc(3),n=s.Lc(39);return t.openDeleteModal(n)}))("keyup.space",(function(){s.Oc(e);const t=s.nc(3),n=s.Lc(39);return t.openDeleteModal(n)}))("click",(function(){s.Oc(e);const t=s.nc(3),n=s.Lc(39);return t.openDeleteModal(n)})),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc(3);s.Cb(2),s.wc("ngIf",!e.disableManualModeEdit),s.Cb(2),s.bd(" ",s.pc(5,2,"GLOBAL.DELETE_BTN")," ")}}function Hv(e,t){1&e&&(s.Xb(0,"div",55),s.Xb(1,"div",56),s.Sb(2,"img",57),s.Wb(),s.Xc(3,Yv,6,4,"div",58),s.Sb(4,"span",14,59),s.Wb())}function $v(e,t){if(1&e&&s.Xc(0,Hv,6,0,"div",54),2&e){const e=s.nc();s.wc("ngIf",!e.disableEdit)}}function Kv(e,t){if(1&e){const e=s.Yb();s.Xb(0,"custom-fields-values",64),s.jc("entryChanged",(function(t){return s.Oc(e),s.nc().entryChanged(t)}))("manyChanged",(function(t){return s.Oc(e),s.nc().entryChanged(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("timeEntryId",e.timeEntry.id)("projectId",null==e.timeEntry.project?null:e.timeEntry.project.id)("customFields",e.customFields)("isLocked",e.timeEntry.isLocked)("disableEdit",e.timeEntry.approvalRequestId)("customFieldValues",e.timeEntry.customFieldValues)}}const qv=function(e){return{entries:e}};function zv(e,t){if(1&e&&(s.Xb(0,"div",65),s.Xb(1,"h1",66),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",67),s.jc("click",(function(){return t.$implicit.dismiss()})),s.Xb(5,"span",68),s.Sb(6,"img",69),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",70),s.Xb(8,"p",71),s.Zc(9),s.oc(10,"translate"),s.oc(11,"translate"),s.Wb(),s.Wb(),s.Xb(12,"div",72),s.Xb(13,"a",73),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Xb(16,"button",74),s.jc("click",(function(){return t.$implicit.close(!0)})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,4,"GLOBAL.DELETE_BTN")),s.Cb(7),s.ad(e.entriesToModify?s.qc(10,6,"TRACKER.TIME_TRACKER.ENTRY.DELETE_ENTRIES_MODAL_BODY",s.Bc(15,qv,e.entriesToModify)):s.pc(11,9,"REPORTS.DETAILED_REPORT.DELETE_MODAL_BODY")),s.Cb(5),s.ad(s.pc(15,11,"GLOBAL.CANCEL_BTN")),s.Cb(3),s.ad(s.pc(18,13,"GLOBAL.DELETE_BTN"))}}const Qv=function(e){return{"cl-locked":e}};let Jv=(()=>{class e extends kv{constructor(e,t,n,i,c,a,o,r,l,b){super(e,t,n,i,c,a,o,r,l,b),this.trackerService=e,this.entryHelper=t,this.entryGroupService=n,this.toaster=i,this.keyboardService=c,this.modalService=a,this.entryBulk=o,this.workspaceService=r,this.translate=l,this.cd=b,this.refreshView=new s.n,this.onBulkEditChange=new s.n}updateDescription(){this.timeEntry.description=Object(sn.G)(this.timeEntry.description,this.toaster,this.translate),this.entryHelper.validateDescription(this.timeEntry.description)?(this.timeEntry.children.forEach(e=>e.description=this.timeEntry.description),this.trackerService.updateGroup(this.timeEntry.children.map(e=>e.id),[TO.a.DESCRIPTION],this.timeEntry).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.refreshView.emit(this.timeEntry.expanded)},e=>{this.timeEntry.description=this.backupDescription,this.timeEntry.children.forEach(e=>e.description=this.backupDescription),this.cd.detectChanges()})):this.timeEntry.description=this.backupDescription}changeBillable(e){const t=this.timeEntry.billable;t!==e&&(this.timeEntry.billable=e,this.timeEntry.children.forEach(e=>e.billable=this.timeEntry.billable),this.trackerService.updateGroup(this.timeEntry.children.map(e=>e.id),[TO.a.BILLABLE],this.timeEntry).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.refreshView.emit(this.timeEntry.expanded)},e=>{this.timeEntry.billable=t,this.timeEntry.children.forEach(e=>e.billable=t),this.cd.detectChanges()}))}groupBulkChange(){const e=!(this.bulkSelected===this.allChilds);this.timeEntry.children.forEach(t=>{t.isLocked&&!this.isAdminOrOwner||(t.bulkEdit=e)}),this.onBulkEditChange.emit(),this.entryBulk.recalculateBulkCheckboxes()}selectTags(e){if(!e)return;if(!this.entryHelper.validateTag(e))return;const t=Object(sn.f)(this.timeEntry.tags);this.timeEntry.tags=e,this.timeEntry.children.forEach(e=>e.tags=Object(sn.f)(this.timeEntry.tags)),this.trackerService.updateGroup(this.timeEntry.children.map(e=>e.id),[TO.a.TAG],this.timeEntry).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.refreshView.emit(this.timeEntry.expanded)},e=>{this.timeEntry.tags=t,this.timeEntry.children.forEach(e=>e.tags=Object(sn.f)(t)),this.cd.detectChanges()})}deleteTimeEntryConfirmed(){this.trackerService.deleteMany(this.getChildrenIds(),this.userId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.entryIsDeleted.emit(this.timeEntry)})}getChildrenIds(){return this.timeEntry.children?this.timeEntry.children.map(e=>e.id):null}notifyParentSingleEntryChanged(){this.cd.detectChanges()}saveProjectAndTask(e,t,n,i){const s=this.timeEntry.billable;i&&i.project&&(this.timeEntry.billable=i.project.billable),this.workspace.taskBillableEnabled&&i&&i.task&&(this.timeEntry.billable=i.task.billable),this.timeEntry.children.forEach(e=>{e.billable=this.timeEntry.billable,this.setProjectToEntry(en.a.clone(this.timeEntry),e),e.workspaceId=n});const c=[TO.a.PROJECT,TO.a.BILLABLE];this.timeEntry.task&&c.push(TO.a.TASK),this.trackerService.updateGroup(this.timeEntry.children.map(e=>e.id),c,this.timeEntry).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{t===e[0].workspaceId?(this.timeEntry.customFieldValues=e[0].customFieldValues,this.timeEntry.children.forEach(e=>{e.customFieldValues=this.timeEntry.customFieldValues}),this.refreshView.emit(this.timeEntry.expanded)):this.entryIsDeleted.emit(this.timeEntry)},t=>{this.timeEntry.billable=s,this.setProjectToEntry(e,this.timeEntry),this.timeEntry.workspaceId=e.workspaceId,this.timeEntry.children.forEach(t=>{t.billable=s,this.setProjectToEntry(Object(sn.f)(e),t),t.workspaceId=e.workspaceId}),this.cd.detectChanges()})}get allChilds(){return this.timeEntry.children?this.timeEntry.children.length:0}get bulkSelected(){return this.timeEntry.children&&this.timeEntry.children.filter(e=>e.bulkEdit).length||0}entryChanged(e){this.trackerService.updateGroup(this.timeEntry.children.map(e=>e.id),[TO.a.CUSTOM_FIELDS],this.timeEntry,[new oO.a({customFieldId:e.customFieldId,value:e.value})]).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.timeEntry.customFieldValues=e[0].customFieldValues,this.timeEntry.children.forEach(e=>e.customFieldValues=this.timeEntry.customFieldValues),this.refreshView.emit(this.timeEntry.expanded)})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(WA.a),s.Rb(NA.a),s.Rb(XA.a),s.Rb(r.a),s.Rb(PA.a),s.Rb(w.q),s.Rb(xe),s.Rb(l.a),s.Rb(g.f),s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["parent-tracker-entry"]],inputs:{childrenLength:"childrenLength",userId:"userId"},outputs:{refreshView:"refreshView",onBulkEditChange:"onBulkEditChange"},features:[s.zb],decls:40,vars:33,consts:[["tabRow","",1,"cl-flex-container","cl-tracker-entry",3,"ngClass"],[1,"cl-col-responsive","cl-description-col","cl-flex-grow-0"],[1,"cl-d-flex","cl-align-items-center","cl-mr-2"],["class","cl-custom-control cl-custom-checkbox cl-ml-2",4,"ngIf"],["class","cl-badge-same-entries-wrapper cl-non-selectable",3,"title","keyup.space","keyup.enter","click",4,"ngIf"],[1,"cl-fake-input-wrapper","cl-cut-text","cl-w-100"],["type","text","tabindex","0","autocomplete","off","spellcheck","true",1,"cl-form-control","cl-input-description",3,"placeholder","disabled","ngModel","ngModelChange","change","focus","keyup.enter"],["description",""],[1,"cl-form-control","cl-fake-input"],[1,"cl-col-responsive","cl-project-col"],["tabCell","",1,"cl-dropdown","cl-dropdown-large","cl-d-flex","cl-w-100",3,"dropdownKey"],[1,"cl-cut-text","cl-w-100-hidden"],[3,"project","projectData","workspace","task"],["openUpAtBottom","","class","cl-dropdown-menu","resizeable","",3,"selectedProject","selectedTask","hideWorkspaces","resizeableName","selectedProjectAndTask","onResize",4,"dropdownKeyContent"],["tabFocus","","tabindex","0"],["projectTabFocus",""],[1,"cl-col-responsive","cl-tag-col"],["tabCell","",1,"cl-dropdown","cl-d-flex","cl-w-100","cl-cut-text-wrapper","cl-justify-content-end",3,"dropdownKey"],["dropdownKeyButton","","tabindex","0",1,"cl-cut-text","pointer",3,"tags"],["openUpAtBottom","","class","cl-dropdown-menu cl-entry-tag-dropdown","resizeable","",3,"entryTags","resizeableName","resizeToLeft","close",4,"dropdownKeyContent"],[1,"cl-col-fixed"],[1,"cl-timetracker-list-actions","cl-d-flex","cl-justify-content-between","cl-w-100"],["class","cl-component-divided-left cl-remove-divider-mob",3,"disableEdit","billable","changed",4,"ngIf"],[1,"cl-d-flex","cl-w-100",3,"focusOnInput","disableEdit","dateTime","click","pickedDate"],[1,"cl-component-divided-left","cl-d-md-inline-flex","cl-input-time-wrapper","cl-entry-duration","cl-m-abs","cl-remove-divider-mob",3,"click"],[4,"ngIf","ngIfElse"],["inputComponent",""],["tabindex","0",1,"cl-component-divided-left","cl-icon-play","pointer","cl-non-selectable","cl-px-1",3,"title","keyup.space","keyup.enter","click"],["play",""],["src","assets/images/ui-icons/play.svg",1,"cl-px-1","cl-pr-lg-2"],["class","cl-dropdown cl-tree-dots cl-d-flex",4,"ngIf","ngIfElse"],["optionsTemplate",""],[3,"timeEntryId","projectId","customFields","isLocked","disableEdit","customFieldValues","entryChanged","manyChanged",4,"ngIf"],["content",""],[1,"cl-custom-control","cl-custom-checkbox","cl-ml-2"],["class","cl-custom-control-input","type","checkbox",3,"ngModel","id","ngModelChange","change","keyup.enter",4,"ngIf"],["class","cl-custom-control-input","type","checkbox",3,"ngModel","indeterminate","id","change","keyup.enter",4,"ngIf"],[1,"cl-custom-control-label",3,"for"],["type","checkbox",1,"cl-custom-control-input",3,"ngModel","id","ngModelChange","change","keyup.enter"],["type","checkbox",1,"cl-custom-control-input",3,"ngModel","indeterminate","id","change","keyup.enter"],[1,"cl-badge-same-entries-wrapper","cl-non-selectable",3,"title","keyup.space","keyup.enter","click"],[1,"cl-badge","cl-badge-same-entries"],["openUpAtBottom","","resizeable","",1,"cl-dropdown-menu",3,"selectedProject","selectedTask","hideWorkspaces","resizeableName","selectedProjectAndTask","onResize"],["projectPicker",""],["openUpAtBottom","","resizeable","",1,"cl-dropdown-menu","cl-entry-tag-dropdown",3,"entryTags","resizeableName","resizeToLeft","close"],[1,"cl-component-divided-left","cl-remove-divider-mob",3,"disableEdit","billable","changed"],["type","text","disabled","",1,"cl-form-control","cl-input-time-picker-sum",3,"ngModel"],[3,"format","timeInterval","disable","onFocus","timeChanged"],[1,"cl-dropdown","cl-tree-dots","cl-d-flex"],[1,"cl-non-selectable","cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow","approval-icon-align"],["src","assets/ui-icons/checkmark-green-circle.svg",3,"title",4,"ngIf","ngIfElse"],["lockIconTemplate",""],["src","assets/ui-icons/checkmark-green-circle.svg",3,"title"],["src","assets/images/ui-icons/locked.svg",3,"title"],["class","cl-dropdown cl-tree-dots cl-d-flex","dropdownKey","","tabCell","",4,"ngIf"],["dropdownKey","","tabCell","",1,"cl-dropdown","cl-tree-dots","cl-d-flex"],["dropdownKeyButton","","tabindex","0",1,"pointer","cl-non-selectable","cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow"],["src","assets/images/ui-icons/menu-dots-vertical.svg",1,"cl-px-2"],["openUpAtBottom","","class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["tabFocusDuplicate",""],["openUpAtBottom","",1,"cl-dropdown-menu","cl-dropdown-menu-right"],["class","cl-dropdown-item","clickCloseDropdown","","tabindex","-1","data-cy","duplicate-button",3,"keyup.enter","keyup.space","click",4,"ngIf"],["tabindex","-1","clickCloseDropdown","","data-cy","delete-button",1,"cl-dropdown-item",3,"keyup.enter","keyup.space","click"],["clickCloseDropdown","","tabindex","-1","data-cy","duplicate-button",1,"cl-dropdown-item",3,"keyup.enter","keyup.space","click"],[3,"timeEntryId","projectId","customFields","isLocked","disableEdit","customFieldValues","entryChanged","manyChanged"],[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-mb-0"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"click"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-danger",3,"click"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"span",2),s.Xc(3,Nv,4,3,"div",3),s.Xc(4,Pv,4,7,"a",4),s.Xb(5,"div",5),s.Xb(6,"input",6,7),s.jc("ngModelChange",(function(e){return t.timeEntry.description=e}))("change",(function(){return t.updateDescription()}))("focus",(function(){return t.backupDescription=t.timeEntry.description}))("keyup.enter",(function(){return s.Oc(e),s.Lc(7).blur()})),s.oc(8,"translate"),s.Wb(),s.Xb(9,"div",8),s.Zc(10),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(11,"div",9),s.Xb(12,"div",10),s.Xb(13,"div",11),s.Sb(14,"project-picker-label",12),s.Wb(),s.Xc(15,Mv,2,4,"project-picker",13),s.Sb(16,"span",14,15),s.Wb(),s.Wb(),s.Xb(18,"div",16),s.Xb(19,"div",17),s.Sb(20,"tag-names",18),s.Xc(21,Bv,1,3,"tag-dropdown",19),s.Wb(),s.Wb(),s.Xb(22,"div",20),s.Xb(23,"div",21),s.Xc(24,Uv,1,2,"billable-icon",22),s.Xb(25,"single-date-picker2",23),s.jc("click",(function(e){return t.toggleCollapseSameEntries(e)}))("pickedDate",(function(e){return t.dateTimeChanged(e)})),s.Wb(),s.Xb(26,"div",24),s.jc("click",(function(e){return t.toggleCollapseSameEntries(e)})),s.Xc(27,Gv,3,4,"div",25),s.Xc(28,xv,1,3,"ng-template",null,26,s.Yc),s.Wb(),s.Xb(30,"div",27,28),s.jc("keyup.space",(function(){return t.setEntryToPlay()}))("keyup.enter",(function(){return t.setEntryToPlay()}))("click",(function(){s.Oc(e);const n=s.Lc(31);return t.setEntryToPlay(),n.blur()})),s.oc(32,"translate"),s.Sb(33,"img",29),s.Wb(),s.Xc(34,Zv,5,2,"div",30),s.Xc(35,$v,1,1,"ng-template",null,31,s.Yc),s.Wb(),s.Wb(),s.Wb(),s.Xc(37,Kv,1,6,"custom-fields-values",32),s.Xc(38,zv,19,17,"ng-template",null,33,s.Yc)}if(2&e){const e=s.Lc(29),n=s.Lc(36);s.wc("ngClass",s.Bc(31,Qv,t.disableEdit)),s.Cb(3),s.wc("ngIf",t.editMode&&!t.disableEdit),s.Cb(1),s.wc("ngIf",null==t.timeEntry||null==t.timeEntry.children?null:t.timeEntry.children.length),s.Cb(2),s.xc("placeholder",s.pc(8,27,"TRACKER.TIME_TRACKER.ENTRY.DESCRIPTION")),s.wc("disabled",t.disableEdit)("ngModel",t.timeEntry.description),s.Db("title",t.timeEntry.description),s.Cb(4),s.bd(" ",t.timeEntry.description," "),s.Cb(2),s.wc("dropdownKey",t.disableEdit),s.Cb(2),s.wc("project",t.timeEntry.project)("projectData",t.projectData)("workspace",t.workspace)("task",t.timeEntry.task),s.Cb(4),s.Hb("cl-has-tags",t.timeEntry.tags&&t.timeEntry.tags.length>0),s.Cb(1),s.wc("dropdownKey",t.disableEdit),s.Cb(1),s.wc("tags",t.timeEntry.tags),s.Cb(4),s.wc("ngIf",t.workspace.activeBillableHours&&(!t.workspace.onlyAdminsCanChangeBillableStatus||t.isAdminOrOwner)),s.Cb(1),s.wc("focusOnInput",!0)("disableEdit",t.disableManualModeEdit||t.disableEdit||(null==t.timeEntry.children?null:t.timeEntry.children.length))("dateTime",t.timeEntry.timeInterval),s.Cb(2),s.wc("ngIf",t.disableManualModeEdit||(null==t.timeEntry.children?null:t.timeEntry.children.length))("ngIfElse",e),s.Cb(3),s.xc("title",s.pc(32,29,"TRACKER.TIME_TRACKER.ENTRY.CONTINUE")),s.Cb(4),s.wc("ngIf",t.disableEdit)("ngIfElse",n),s.Cb(3),s.wc("ngIf",(null==t.customFields?null:t.customFields.length)>0)}},directives:[i.r,i.u,v.c,v.s,v.v,ni.a,IO.a,si.a,XO,ii.a,zr.a,v.a,NO.a,DO.a,PO.a,MO.a,BO.a,fi.a,YO.a],pipes:[g.e,dv.a],encapsulation:2,changeDetection:0}),e})();function eT(e,t){if(1&e){const e=s.Yb();s.Xb(0,"input",38),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc(2).timeEntry.bulkEdit=t}))("change",(function(){s.Oc(e);const t=s.nc(2);return t.signleBulkChange(t.timeEntry.bulkEdit)}))("keyup.enter",(function(){s.Oc(e);const t=s.nc(2);return t.timeEntry.bulkEdit=!t.timeEntry.bulkEdit,t.signleBulkChange(t.timeEntry.bulkEdit)})),s.Wb()}if(2&e){const e=s.nc(2);s.yc("id","edit_",e.timeEntry.id,""),s.wc("ngModel",e.timeEntry.bulkEdit)}}function tT(e,t){if(1&e){const e=s.Yb();s.Xb(0,"input",39),s.jc("change",(function(){return s.Oc(e),s.nc(2).groupBulkChange()}))("keyup.enter",(function(){return s.Oc(e),s.nc(2).groupBulkChange()})),s.Wb()}if(2&e){const e=s.nc(2);s.yc("id","edit_",e.timeEntry.id,""),s.wc("ngModel",e.bulkSelected===e.allChilds)("indeterminate",e.bulkSelected>0&&e.bulkSelected<e.allChilds)}}function nT(e,t){if(1&e&&(s.Xb(0,"div",34),s.Xc(1,eT,1,2,"input",35),s.Xc(2,tT,1,3,"input",36),s.Sb(3,"label",37),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",!(null!=e.timeEntry&&null!=e.timeEntry.children&&e.timeEntry.children.length)),s.Cb(1),s.wc("ngIf",null==e.timeEntry||null==e.timeEntry.children?null:e.timeEntry.children.length),s.Cb(1),s.yc("for","edit_",e.timeEntry.id,"")}}const iT=function(e){return{count:e}};function sT(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",40),s.jc("keyup.space",(function(){return s.Oc(e),s.nc().toggleCollapseSameEntries()}))("keyup.enter",(function(){return s.Oc(e),s.nc().toggleCollapseSameEntries()}))("click",(function(){return s.Oc(e),s.nc().toggleCollapseSameEntries()})),s.oc(1,"translate"),s.Xb(2,"span",41),s.Zc(3),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.qc(1,2,"TRACKER.TIME_TRACKER.ENTRY.GROUPS_TOOLTIP",s.Bc(5,iT,e.childrenLength))),s.Cb(3),s.ad(e.childrenLength)}}function cT(e,t){if(1&e){const e=s.Yb();s.Xb(0,"project-picker",42,43),s.jc("selectedProjectAndTask",(function(t){s.Oc(e);const n=s.nc(),i=s.Lc(17);return n.selectProjectAndTask(t,i)}))("onResize",(function(t){return s.Oc(e),s.Lc(1).onResizeChange(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("selectedProject",e.timeEntry.project)("selectedTask",e.timeEntry.task)("hideWorkspaces",e.hideWorkspacesInPicker)("resizeableName","projectPicker")}}function aT(e,t){if(1&e){const e=s.Yb();s.Xb(0,"tag-dropdown",44),s.jc("close",(function(t){return s.Oc(e),s.nc().selectTags(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("entryTags",e.timeEntry.tags)("resizeableName","tagPicker")("resizeToLeft",!0)}}function oT(e,t){if(1&e){const e=s.Yb();s.Xb(0,"billable-icon",45),s.jc("changed",(function(t){return s.Oc(e),s.nc().changeBillable(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("disableEdit",e.disableEdit)("billable",e.timeEntry.billable)}}function rT(e,t){if(1&e&&(s.Xb(0,"div"),s.Sb(1,"input",46),s.oc(2,"timeFormat"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngModel",s.qc(2,1,e.timeEntry.timeInterval.duration,e.format))}}function lT(e,t){if(1&e){const e=s.Yb();s.Xb(0,"input-duration",47),s.jc("onFocus",(function(){return s.Oc(e),s.nc().closeDatepicker()}))("timeChanged",(function(t){return s.Oc(e),s.nc().dateTimeChanged(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("format",e.format)("timeInterval",e.timeEntry.timeInterval)("disable",e.disableEdit||(null==e.timeEntry.children?null:e.timeEntry.children.length))}}function bT(e,t){1&e&&(s.Sb(0,"img",52),s.oc(1,"translate")),2&e&&s.xc("title",s.pc(1,1,"GLOBAL.APPROVED_ERROR_MESSAGE"))}function dT(e,t){1&e&&(s.Sb(0,"img",53),s.oc(1,"translate")),2&e&&s.xc("title",s.pc(1,1,"GLOBAL.ENTRIES_LOCKED_ERROR_MESSAGE"))}function uT(e,t){if(1&e&&(s.Xb(0,"div",48),s.Xb(1,"div",49),s.Xc(2,bT,2,3,"img",50),s.Xc(3,dT,2,3,"ng-template",null,51,s.Yc),s.Wb(),s.Wb()),2&e){const e=s.Lc(4),t=s.nc();s.Cb(2),s.wc("ngIf",t.timeEntry.approvalRequestId)("ngIfElse",e)}}function pT(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",63),s.jc("keyup.enter",(function(){return s.Oc(e),s.nc(4).duplicateEntry()}))("keyup.space",(function(){return s.Oc(e),s.nc(4).duplicateEntry()}))("click",(function(){return s.Oc(e),s.nc(4).duplicateEntry()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.DUPLICATE_BTN")," "))}function hT(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",60),s.Xb(1,"list-items"),s.Xc(2,pT,3,3,"a",61),s.Xb(3,"a",62),s.jc("keyup.enter",(function(){s.Oc(e);const t=s.nc(3),n=s.Lc(39);return t.openDeleteModal(n)}))("keyup.space",(function(){s.Oc(e);const t=s.nc(3),n=s.Lc(39);return t.openDeleteModal(n)}))("click",(function(){s.Oc(e);const t=s.nc(3),n=s.Lc(39);return t.openDeleteModal(n)})),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc(3);s.Cb(2),s.wc("ngIf",!e.disableManualModeEdit),s.Cb(2),s.bd(" ",s.pc(5,2,"GLOBAL.DELETE_BTN")," ")}}function mT(e,t){1&e&&(s.Xb(0,"div",55),s.Xb(1,"div",56),s.Sb(2,"img",57),s.Wb(),s.Xc(3,hT,6,4,"div",58),s.Sb(4,"span",14,59),s.Wb())}function gT(e,t){if(1&e&&s.Xc(0,mT,6,0,"div",54),2&e){const e=s.nc();s.wc("ngIf",!e.disableEdit)}}function ET(e,t){if(1&e){const e=s.Yb();s.Xb(0,"custom-fields-values",64),s.jc("entryChanged",(function(t){return s.Oc(e),s.nc().entryChanged(t)}))("manyChanged",(function(t){return s.Oc(e),s.nc().entryChanged(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("timeEntryId",e.timeEntry.id)("projectId",null==e.timeEntry.project?null:e.timeEntry.project.id)("customFields",e.customFields)("isLocked",e.timeEntry.isLocked)("disableEdit",e.timeEntry.approvalRequestId)("customFieldValues",e.timeEntry.customFieldValues)}}const fT=function(e){return{entries:e}};function ST(e,t){if(1&e&&(s.Xb(0,"div",65),s.Xb(1,"h1",66),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",67),s.jc("click",(function(){return t.$implicit.dismiss()})),s.Xb(5,"span",68),s.Sb(6,"img",69),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",70),s.Xb(8,"p",71),s.Zc(9),s.oc(10,"translate"),s.oc(11,"translate"),s.Wb(),s.Wb(),s.Xb(12,"div",72),s.Xb(13,"a",73),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Xb(16,"button",74),s.jc("click",(function(){return t.$implicit.close(!0)})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,4,"GLOBAL.DELETE_BTN")),s.Cb(7),s.ad(e.entriesToModify?s.qc(10,6,"TRACKER.TIME_TRACKER.ENTRY.DELETE_ENTRIES_MODAL_BODY",s.Bc(15,fT,e.entriesToModify)):s.pc(11,9,"REPORTS.DETAILED_REPORT.DELETE_MODAL_BODY")),s.Cb(5),s.ad(s.pc(15,11,"GLOBAL.CANCEL_BTN")),s.Cb(3),s.ad(s.pc(18,13,"GLOBAL.DELETE_BTN"))}}const CT=function(e){return{"cl-locked":e}};let AT=(()=>{class e extends kv{constructor(e,t,n,i,c,a,o,r,l,b){super(e,t,n,i,c,a,o,r,l,b),this.trackerService=e,this.entryHelper=t,this.entryGroupService=n,this.toaster=i,this.keyboardService=c,this.modalService=a,this.entryBulk=o,this.workspaceService=r,this.translate=l,this.cd=b,this.singleEntryChanged=new s.n,this.onSignleBulkChange=new s.n,this.entryDurationChanged=new s.n}getId(){return this.timeEntry.id}triggerDetection(){this.timeEntry.customFieldValues&&(this.timeEntry.customFieldValues=this.timeEntry.customFieldValues.map(e=>oO.a.clone(e))),this.cd.detectChanges()}updateDescription(){this.timeEntry.description=Object(sn.G)(this.timeEntry.description,this.toaster,this.translate),this.entryHelper.validateDescription(this.timeEntry.description)?this.trackerService.updateDescription(this.timeEntry.id,this.timeEntry.description).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.singleEntryChanged.emit(this.timeEntry)},()=>{this.timeEntry.description=this.backupDescription,this.cd.markForCheck()}):this.timeEntry.description=this.backupDescription}changeBillable(e){const t=this.timeEntry.billable;t!==e&&(this.timeEntry.billable=e,this.trackerService.updateBillable(this.timeEntry.id,e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.timeEntry.billable=e.billable,this.singleEntryChanged.emit(this.timeEntry)},()=>{this.timeEntry.billable=t,this.cd.detectChanges()}))}dateTimeChanged(e){const t=new ZA.a(this.timeEntry.timeInterval);this.timeEntry.timeInterval=new ZA.a(e),this.trackerService.editTimeInterval(this.timeEntry.id,e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{if(this.timeEntry.timeInterval=e.timeInterval,tn(e.timeInterval.start).isSame(t.start,"day"))this.entryDurationChanged.emit({newInterval:e.timeInterval,oldInterval:t});else{const e=en.a.clone(this.timeEntry);this.entryIsDeleted.emit(this.timeEntry),this.entryGroupService.setNewEntryCreated(e)}},e=>{this.timeEntry.timeInterval=t,this.cd.detectChanges()})}selectTags(e){if(!e)return;if(!this.entryHelper.validateTag(e))return;const t=Object(sn.f)(this.timeEntry.tags);this.timeEntry.tags=e,this.cd.markForCheck(),this.trackerService.updateTags(this.timeEntry.id,e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.singleEntryChanged.emit(this.timeEntry)},()=>{this.timeEntry.tags=t,this.cd.detectChanges()})}deleteTimeEntryConfirmed(){this.trackerService.deleteTimeEntry(this.timeEntry).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.entryIsDeleted.emit(this.timeEntry)})}signleBulkChange(e){this.onSignleBulkChange.next(e),this.entryBulk.recalculateBulkCheckboxes()}saveProjectAndTask(e,t,n,i){this.trackerService.updateProjectAndTask(this.timeEntry,n).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{t===e.workspaceId?(this.projectAttributeTitle=Object(sn.o)(this.timeEntry,this.translate.instant("GLOBAL.PROJECT_LABEL"),this.translate.instant("GLOBAL.TASK_LABEL")),this.timeEntry.billable!=e.billable&&(this.timeEntry.billable=e.billable),this.timeEntry.customFieldValues=e.customFieldValues,this.singleEntryChanged.emit(this.timeEntry)):this.entryIsDeleted.emit(this.timeEntry)},t=>{this.setProjectToEntry(e,this.timeEntry),this.timeEntry.workspaceId=e.workspaceId,this.cd.detectChanges()})}entryChanged(e){this.timeEntry.customFieldValues=e,this.singleEntryChanged.emit(this.timeEntry)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(WA.a),s.Rb(NA.a),s.Rb(XA.a),s.Rb(r.a),s.Rb(PA.a),s.Rb(w.q),s.Rb(xe),s.Rb(l.a),s.Rb(g.f),s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["time-tracker-entry"]],outputs:{singleEntryChanged:"singleEntryChanged",onSignleBulkChange:"onSignleBulkChange",entryDurationChanged:"entryDurationChanged"},features:[s.zb],decls:40,vars:33,consts:[["tabRow","",1,"cl-flex-container","cl-tracker-entry",3,"ngClass"],[1,"cl-col-responsive","cl-description-col","cl-flex-grow-0"],[1,"cl-d-flex","cl-align-items-center","cl-mr-2"],["class","cl-custom-control cl-custom-checkbox cl-ml-2",4,"ngIf"],["class","cl-badge-same-entries-wrapper cl-non-selectable",3,"title","keyup.space","keyup.enter","click",4,"ngIf"],[1,"cl-fake-input-wrapper","cl-cut-text","cl-w-100"],["type","text","tabindex","0","autocomplete","off","spellcheck","true",1,"cl-form-control","cl-input-description",3,"placeholder","disabled","ngModel","ngModelChange","change","focus","keyup.enter"],["description",""],[1,"cl-form-control","cl-fake-input"],[1,"cl-col-responsive","cl-project-col"],["tabCell","",1,"cl-dropdown","cl-dropdown-large","cl-d-flex","cl-w-100",3,"dropdownKey"],[1,"cl-cut-text","cl-w-100-hidden"],[3,"project","projectData","workspace","task"],["openUpAtBottom","","class","cl-dropdown-menu","resizeable","",3,"selectedProject","selectedTask","hideWorkspaces","resizeableName","selectedProjectAndTask","onResize",4,"dropdownKeyContent"],["tabFocus","","tabindex","0"],["projectTabFocus",""],[1,"cl-col-responsive","cl-tag-col"],["tabCell","",1,"cl-dropdown","cl-d-flex","cl-w-100","cl-cut-text-wrapper","cl-justify-content-end",3,"dropdownKey"],["dropdownKeyButton","","tabindex","0",1,"cl-cut-text","pointer",3,"tags"],["openUpAtBottom","","class","cl-dropdown-menu cl-entry-tag-dropdown","resizeable","",3,"entryTags","resizeableName","resizeToLeft","close",4,"dropdownKeyContent"],[1,"cl-col-fixed"],[1,"cl-timetracker-list-actions","cl-d-flex","cl-justify-content-between","cl-w-100"],["class","cl-component-divided-left cl-remove-divider-mob",3,"disableEdit","billable","changed",4,"ngIf"],[1,"cl-d-flex","cl-w-100",3,"focusOnInput","disableEdit","dateTime","click","pickedDate"],[1,"cl-component-divided-left","cl-d-md-inline-flex","cl-input-time-wrapper","cl-entry-duration","cl-m-abs","cl-remove-divider-mob",3,"click"],[4,"ngIf","ngIfElse"],["inputComponent",""],["tabindex","0",1,"cl-component-divided-left","cl-icon-play","pointer","cl-non-selectable","cl-px-1",3,"title","keyup.space","keyup.enter","click"],["play",""],["src","assets/images/ui-icons/play.svg",1,"cl-px-1","cl-pr-lg-2"],["class","cl-dropdown cl-tree-dots cl-d-flex",4,"ngIf","ngIfElse"],["optionsTemplate",""],[3,"timeEntryId","projectId","customFields","isLocked","disableEdit","customFieldValues","entryChanged","manyChanged",4,"ngIf"],["content",""],[1,"cl-custom-control","cl-custom-checkbox","cl-ml-2"],["class","cl-custom-control-input","type","checkbox",3,"ngModel","id","ngModelChange","change","keyup.enter",4,"ngIf"],["class","cl-custom-control-input","type","checkbox",3,"ngModel","indeterminate","id","change","keyup.enter",4,"ngIf"],[1,"cl-custom-control-label",3,"for"],["type","checkbox",1,"cl-custom-control-input",3,"ngModel","id","ngModelChange","change","keyup.enter"],["type","checkbox",1,"cl-custom-control-input",3,"ngModel","indeterminate","id","change","keyup.enter"],[1,"cl-badge-same-entries-wrapper","cl-non-selectable",3,"title","keyup.space","keyup.enter","click"],[1,"cl-badge","cl-badge-same-entries"],["openUpAtBottom","","resizeable","",1,"cl-dropdown-menu",3,"selectedProject","selectedTask","hideWorkspaces","resizeableName","selectedProjectAndTask","onResize"],["projectPicker",""],["openUpAtBottom","","resizeable","",1,"cl-dropdown-menu","cl-entry-tag-dropdown",3,"entryTags","resizeableName","resizeToLeft","close"],[1,"cl-component-divided-left","cl-remove-divider-mob",3,"disableEdit","billable","changed"],["type","text","disabled","",1,"cl-form-control","cl-input-time-picker-sum",3,"ngModel"],[3,"format","timeInterval","disable","onFocus","timeChanged"],[1,"cl-dropdown","cl-tree-dots","cl-d-flex"],[1,"cl-non-selectable","cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow","approval-icon-align"],["src","assets/ui-icons/checkmark-green-circle.svg",3,"title",4,"ngIf","ngIfElse"],["lockIconTemplate",""],["src","assets/ui-icons/checkmark-green-circle.svg",3,"title"],["src","assets/images/ui-icons/locked.svg",3,"title"],["class","cl-dropdown cl-tree-dots cl-d-flex","dropdownKey","","tabCell","",4,"ngIf"],["dropdownKey","","tabCell","",1,"cl-dropdown","cl-tree-dots","cl-d-flex"],["dropdownKeyButton","","tabindex","0",1,"pointer","cl-non-selectable","cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow"],["src","assets/images/ui-icons/menu-dots-vertical.svg",1,"cl-px-2"],["openUpAtBottom","","class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["tabFocusDuplicate",""],["openUpAtBottom","",1,"cl-dropdown-menu","cl-dropdown-menu-right"],["class","cl-dropdown-item","clickCloseDropdown","","tabindex","-1","data-cy","duplicate-button",3,"keyup.enter","keyup.space","click",4,"ngIf"],["tabindex","-1","clickCloseDropdown","","data-cy","delete-button",1,"cl-dropdown-item",3,"keyup.enter","keyup.space","click"],["clickCloseDropdown","","tabindex","-1","data-cy","duplicate-button",1,"cl-dropdown-item",3,"keyup.enter","keyup.space","click"],[3,"timeEntryId","projectId","customFields","isLocked","disableEdit","customFieldValues","entryChanged","manyChanged"],[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-mb-0"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"click"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-danger",3,"click"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"span",2),s.Xc(3,nT,4,3,"div",3),s.Xc(4,sT,4,7,"a",4),s.Xb(5,"div",5),s.Xb(6,"input",6,7),s.jc("ngModelChange",(function(e){return t.timeEntry.description=e}))("change",(function(){return t.updateDescription()}))("focus",(function(){return t.backupDescription=t.timeEntry.description}))("keyup.enter",(function(){return s.Oc(e),s.Lc(7).blur()})),s.oc(8,"translate"),s.Wb(),s.Xb(9,"div",8),s.Zc(10),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(11,"div",9),s.Xb(12,"div",10),s.Xb(13,"div",11),s.Sb(14,"project-picker-label",12),s.Wb(),s.Xc(15,cT,2,4,"project-picker",13),s.Sb(16,"span",14,15),s.Wb(),s.Wb(),s.Xb(18,"div",16),s.Xb(19,"div",17),s.Sb(20,"tag-names",18),s.Xc(21,aT,1,3,"tag-dropdown",19),s.Wb(),s.Wb(),s.Xb(22,"div",20),s.Xb(23,"div",21),s.Xc(24,oT,1,2,"billable-icon",22),s.Xb(25,"single-date-picker2",23),s.jc("click",(function(e){return t.toggleCollapseSameEntries(e)}))("pickedDate",(function(e){return t.dateTimeChanged(e)})),s.Wb(),s.Xb(26,"div",24),s.jc("click",(function(e){return t.toggleCollapseSameEntries(e)})),s.Xc(27,rT,3,4,"div",25),s.Xc(28,lT,1,3,"ng-template",null,26,s.Yc),s.Wb(),s.Xb(30,"div",27,28),s.jc("keyup.space",(function(){return t.setEntryToPlay()}))("keyup.enter",(function(){return t.setEntryToPlay()}))("click",(function(){s.Oc(e);const n=s.Lc(31);return t.setEntryToPlay(),n.blur()})),s.oc(32,"translate"),s.Sb(33,"img",29),s.Wb(),s.Xc(34,uT,5,2,"div",30),s.Xc(35,gT,1,1,"ng-template",null,31,s.Yc),s.Wb(),s.Wb(),s.Wb(),s.Xc(37,ET,1,6,"custom-fields-values",32),s.Xc(38,ST,19,17,"ng-template",null,33,s.Yc)}if(2&e){const e=s.Lc(29),n=s.Lc(36);s.wc("ngClass",s.Bc(31,CT,t.disableEdit)),s.Cb(3),s.wc("ngIf",t.editMode&&!t.disableEdit),s.Cb(1),s.wc("ngIf",null==t.timeEntry||null==t.timeEntry.children?null:t.timeEntry.children.length),s.Cb(2),s.xc("placeholder",s.pc(8,27,"TRACKER.TIME_TRACKER.ENTRY.DESCRIPTION")),s.wc("disabled",t.disableEdit)("ngModel",t.timeEntry.description),s.Db("title",t.timeEntry.description),s.Cb(4),s.bd(" ",t.timeEntry.description," "),s.Cb(2),s.wc("dropdownKey",t.disableEdit),s.Cb(2),s.wc("project",t.timeEntry.project)("projectData",t.projectData)("workspace",t.workspace)("task",t.timeEntry.task),s.Cb(4),s.Hb("cl-has-tags",t.timeEntry.tags&&t.timeEntry.tags.length>0),s.Cb(1),s.wc("dropdownKey",t.disableEdit),s.Cb(1),s.wc("tags",t.timeEntry.tags),s.Cb(4),s.wc("ngIf",t.workspace.activeBillableHours&&(!t.workspace.onlyAdminsCanChangeBillableStatus||t.isAdminOrOwner)),s.Cb(1),s.wc("focusOnInput",!0)("disableEdit",t.disableManualModeEdit||t.disableEdit||(null==t.timeEntry.children?null:t.timeEntry.children.length))("dateTime",t.timeEntry.timeInterval),s.Cb(2),s.wc("ngIf",t.disableManualModeEdit||(null==t.timeEntry.children?null:t.timeEntry.children.length))("ngIfElse",e),s.Cb(3),s.xc("title",s.pc(32,29,"TRACKER.TIME_TRACKER.ENTRY.CONTINUE")),s.Cb(4),s.wc("ngIf",t.disableEdit)("ngIfElse",n),s.Cb(3),s.wc("ngIf",(null==t.customFields?null:t.customFields.length)>0)}},directives:[i.r,i.u,v.c,v.s,v.v,ni.a,IO.a,si.a,XO,ii.a,zr.a,v.a,NO.a,DO.a,PO.a,MO.a,BO.a,fi.a,YO.a],pipes:[g.e,dv.a],encapsulation:2,changeDetection:0}),e})();var OT=n("JO38");const vT=["dropdown"];function TT(e,t){1&e&&s.Sb(0,"div",44)}function IT(e,t){1&e&&s.Sb(0,"div",44)}function wT(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Sb(1,"hr",14),s.Xb(2,"div",5),s.Xb(3,"div",6),s.Xb(4,"div",7),s.Xb(5,"input",45),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().user=t})),s.Wb(),s.Xb(6,"label",46),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(9,"div",10),s.Xc(10,IT,1,0,"div",11),s.Xb(11,"dropdown-items",47,48),s.jc("click",(function(){s.Oc(e);const t=s.Lc(12),n=s.nc();return!n.hasChangeUserPermission&&n.showPopup(t)}))("onFilterOptionChange",(function(t){return s.Oc(e),s.nc().onFilterChange(t)}))("onChangedDropdown",(function(t){s.Oc(e);const n=s.nc();return n.timeEntry.user.id=t.value,n.timeEntry.user.name=t.label}))("loadMore",(function(){return s.Oc(e),s.nc().loadMoreUsers()}))("onOpen",(function(){return s.Oc(e),s.nc().getUsers()})),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc(),t=s.Lc(82);s.Cb(5),s.wc("ngModel",e.user),s.Cb(2),s.ad(s.pc(8,14,"GLOBAL.USER_LABEL")),s.Cb(3),s.wc("ngIf",!e.user),s.Cb(1),s.wc("ngbPopover",t)("enableSearch",!0)("filterQuery",e.usersQuery)("list",e.users)("placeholder",s.pc(14,16,"GLOBAL.SEARCH_USERS_LABEL"))("initLabel",e.timeEntry.user.name||e.timeEntry.user.email||"Select user")("itemLabel",e.timeEntry.user.name||e.timeEntry.user.email||"Select user")("value",e.timeEntry.user.id)("isDisabled",!e.hasChangeUserPermission)("offlineSearch",!1)("filterOptions",e.userFilterOptions)}}function LT(e,t){1&e&&s.Sb(0,"div",44)}function RT(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",e.timeEntry.project.name+(e.timeEntry.task?": "+e.timeEntry.task.name:"")," ")}}function yT(e,t){1&e&&(s.Zc(0),s.oc(1,"translate")),2&e&&s.bd(" ",s.pc(1,1,"GLOBAL.ADD_PROJECT_LABEL")," ")}function _T(e,t){if(1&e){const e=s.Yb();s.Xb(0,"project-picker",49),s.jc("selectedProjectAndTask",(function(t){return s.Oc(e),s.nc().selectProjectAndTask(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("selectedProject",e.timeEntry.project)("selectedTask",e.timeEntry.task)("selectedUserId",1==e.entriesOwners.length?e.entriesOwners[0]:e.loggedInUser.id)("hideWorkspaces",e.hideWorkspacesInPicker)}}function kT(e,t){1&e&&s.Sb(0,"div",44)}function WT(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.Wb()),2&e){const e=t.$implicit,n=t.last;s.Cb(1),s.cd(" ",e.name,"",n?"":", "," ")}}function XT(e,t){if(1&e&&(s.Vb(0),s.Xc(1,WT,2,2,"span",50),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngForOf",e.timeEntry.tags)}}function NT(e,t){1&e&&(s.Zc(0),s.oc(1,"translate")),2&e&&s.bd(" ",s.pc(1,1,"TIMESHEET2.TIME_ENTRY.TAGS.SELECT")," ")}function DT(e,t){if(1&e){const e=s.Yb();s.Xb(0,"tag-dropdown",51),s.jc("close",(function(t){return s.Oc(e),s.nc().closeTagDropdown(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("resizeableName","tagPicker")("entryTags",e.timeEntry.tags)}}function PT(e,t){1&e&&s.Sb(0,"div",44)}function MT(e,t){1&e&&s.Sb(0,"hr",14)}function BT(e,t){1&e&&s.Sb(0,"div",44)}function UT(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",52),s.Xb(1,"div",6),s.Xb(2,"div",7),s.Xb(3,"input",53),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().billable=t})),s.Wb(),s.Xb(4,"label",54),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",10),s.Xc(8,BT,1,0,"div",11),s.Xb(9,"div",55),s.Xb(10,"input",56),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().timeEntry.billable=t})),s.Wb(),s.Xb(11,"label",57),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.wc("ngModel",e.billable),s.Cb(2),s.ad(s.pc(6,5,"GLOBAL.BILLABLE_LABEL")),s.Cb(3),s.wc("ngIf",!e.billable),s.Cb(2),s.wc("ngModel",e.timeEntry.billable),s.Cb(2),s.ad(s.pc(13,7,"GLOBAL.CONFIRM_LABEL"))}}function GT(e,t){1&e&&s.Sb(0,"div",44)}function xT(e,t){1&e&&s.Sb(0,"div",44)}function FT(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Sb(1,"hr",14),s.Xb(2,"div",15),s.oc(3,"translate"),s.Xb(4,"div",6),s.Xb(5,"div",7),s.Xb(6,"input",58),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().time=t})),s.Wb(),s.Xb(7,"label",59),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(10,"div",10),s.Xc(11,GT,1,0,"div",11),s.Xb(12,"div",60),s.Xb(13,"single-date-picker2",61),s.jc("pickedDate",(function(t){return s.Oc(e),s.nc().pickedDateAndTime(t)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(14,"hr",14),s.Xb(15,"div",15),s.oc(16,"translate"),s.Xb(17,"div",6),s.Xb(18,"div",7),s.Xb(19,"input",62),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().date=t})),s.Wb(),s.Xb(20,"label",63),s.Zc(21),s.oc(22,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(23,"div",10),s.Xc(24,xT,1,0,"div",11),s.Xb(25,"div",64),s.Xb(26,"single-date-picker2",65),s.jc("pickedDate",(function(t){return s.Oc(e),s.nc().pickedDateAndTime(t)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc();s.Cb(2),s.wc("ngbTooltip",e.isRounding?s.pc(3,18,"REPORTS.SHARED.EDIT_TIME_WARNING_TOOLTIP"):""),s.Cb(4),s.wc("disabled",e.isRounding)("ngModel",e.time),s.Cb(2),s.ad(s.pc(9,20,"GLOBAL.TIME_LABEL")),s.Cb(3),s.wc("ngIf",!e.time),s.Cb(2),s.wc("debounce",!1)("dateTime",e.timeEntry.timeInterval)("mode","time_only"),s.Cb(2),s.wc("ngbTooltip",e.isRounding?s.pc(16,22,"SHARED_MODULES.TIME_ENTRY_BULK_EDIT.EDIT_WHEN_ROUNDING_WARNING"):""),s.Cb(4),s.wc("disabled",e.isRounding)("ngModel",e.date),s.Cb(2),s.ad(s.pc(22,24,"GLOBAL.DATE_LABEL")),s.Cb(3),s.wc("ngIf",!e.date),s.Cb(2),s.wc("debounce",!1)("dateTime",e.timeEntry.timeInterval)("textualDate",!0)("openUp",!0)("mode","date_only")}}function jT(e,t){1&e&&s.Sb(0,"div",44)}function ZT(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",67),s.Xb(1,"div",68),s.Xb(2,"div",7),s.Xb(3,"input",69),s.jc("ngModelChange",(function(n){return s.Oc(e),t.$implicit.isSameForAll=n})),s.Wb(),s.Xb(4,"label",70),s.Zc(5),s.Wb(),s.Wb(),s.Wb(),s.Xb(6,"div",71),s.Xc(7,jT,1,0,"div",11),s.Xb(8,"div",72),s.Sb(9,"custom-field-value",73),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit;s.Cb(3),s.wc("id",e.customField.id)("name",e.customField.name)("ngModel",e.isSameForAll),s.Cb(1),s.wc("for",e.customField.id),s.Cb(1),s.ad(e.customField.name),s.Cb(2),s.wc("ngIf",!e.isSameForAll),s.Cb(2),s.wc("customField",e)}}function VT(e,t){if(1&e&&(s.Vb(0),s.Sb(1,"hr",14),s.Xc(2,ZT,10,7,"div",66),s.Ub()),2&e){const e=s.nc();s.Cb(2),s.wc("ngForOf",e.customFieldValues)}}function YT(e,t){if(1&e){const e=s.Yb();s.Zc(0),s.oc(1,"translate"),s.Xb(2,"a",74),s.jc("click",(function(){return s.Oc(e),s.nc().navigateToUpgrade()})),s.Zc(3),s.oc(4,"translate"),s.Wb()}2&e&&(s.bd(" ",s.pc(1,2,"SHARED_MODULES.TIME_ENTRY_BULK_EDIT.UPGRADE_MSG")," "),s.Cb(3),s.ad(s.pc(4,4,"GLOBAL.UPGRADE_BTN")))}const HT=function(e){return{count:e}};let $T=(()=>{class e{constructor(e,t,n,i,c){this.authService=e,this.trackerService=t,this.cd=n,this.workspaceService=i,this.translateService=c,this.entriesOwners=[],this.autofillWithSameData=!0,this.preventSendRequest=!1,this.isRounding=!1,this.hideDates=!1,this._customFields=[],this.close=new s.n,this.emitEntries=new s.n,this.onEdit=new s.n,this.onUpdate=new s.n,this.description=!1,this.projects=!1,this.customField=!1,this.tag=!1,this.billable=!1,this.time=!1,this.date=!1,this.unsubscribe$=new p.a,this.overwriteTags=!1,this.sameProject=!0,this.user=!1,this.users=[],this.usersQuery={},this.userFilterOptions=on.v}set customFields(e){this._customFields=e||[]}get customFields(){return this._customFields}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.hasChangeUserPermission=this.workspace.hasFeature(is.a.ADD_TIME_FOR_OTHERS),this.entriesOfMultipleUsersSelected=this.entriesOwners.length>1,this.loggedInUser=this.authService.getUser(),this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.createTimeEntry(this.workspace.id,this.loggedInUser.id),this.customFieldValues=this.createCustomFieldList(),this.resetQuery(),this.cd.detectChanges()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}createTaskHash(e){return e&&e.id||null}createProjectHash(e){let t="";return e.project&&(t+=e.project.id,e.project.clientId?t+=e.project.clientId:e.project.client&&e.project.client.id&&(t+=e.project.client.id)),t+=e.task&&e.task.id||null,t}createTagHash(e){const t=e?e.map(e=>e.id):[];return JSON.stringify(t)}createTimeEntry(e,t){if(!this.autofillWithSameData){const t=new Ca.a;return void(this.timeEntry=new en.a({user:t,workspaceId:e}))}const n=en.a.clone(this.timeEntries[0]);n.workspaceId=e,n.userId=t;const i=this.timeEntries.length;for(let s=1;s<i;s++)n.description!==this.timeEntries[s].description&&(n.description=""),this.enableEditUser&&n.user&&n.user.id!==this.timeEntries[s].user.id&&(n.user=new Ca.a),n.billable!==this.timeEntries[s].billable&&(n.billable=!1),this.createTagHash(n.tags)!==this.createTagHash(this.timeEntries[s].tags)&&(n.tags=null),this.createProjectHash(n)!==this.createProjectHash(this.timeEntries[s])&&(n.project=null,this.sameProject=!1),this.createTaskHash(n.task)!==this.createTaskHash(this.timeEntries[s].task)&&(n.task=null),n.timeInterval.start!==this.timeEntries[s].timeInterval.start&&(n.timeInterval.start=ke().toISOString()),n.timeInterval.end!==this.timeEntries[s].timeInterval.end&&(n.timeInterval.end=ke().toISOString());this.enableEditUser&&!n.user&&(n.user=new Ca.a),this.timeEntry=n}closeBulk(e=!1){this.close.emit(e)}selectProjectAndTask(e){this.timeEntry.project=e.project,this.timeEntry.billable=this.workspace.taskBillableEnabled&&e.task?e.task.billable:e.project?e.project.billable:this.timeEntry.billable,this.timeEntry.project&&(this.timeEntry.project.clientName=this.timeEntry.project&&this.timeEntry.project.client&&this.timeEntry.project.client.name),this.timeEntry.task=e.task,this.timeEntry.workspaceId=e.workspace?e.workspace.id:this.timeEntry.workspaceId,this.sameProject=!0,this.customFieldValues=this.createCustomFieldList(),this.cd.detectChanges()}closeTagDropdown(e){e&&(this.timeEntry.tags=e)}pickedDateAndTime(e){(this.time||this.date)&&(this.timeEntry.timeInterval=e,this.cd.detectChanges())}editEntries(){this.inProgress||(this.inProgress=!0,setTimeout(()=>{const e=this.generateChangeFields(),t=[];this.timeEntries.forEach(e=>t.push(e.id)),this.preventSendRequest?this.onEdit.emit({ids:t,changeFields:e,timeEntry:this.timeEntry,customFieldValues:this.customFieldValues.filter(e=>e.isSameForAll)}):this.trackerService.updateGroup(t,e,this.timeEntry,this.customFieldValues.filter(e=>e.isSameForAll)).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.inProgress=!1,this.onEdit.emit(),this.closeBulk(!0)},()=>{this.inProgress=!1,this.cd.detectChanges()})}))}generateChangeFields(){const e=[];return this.description&&e.push(TO.a.DESCRIPTION),this.projects?(e.push(TO.a.PROJECT),e.push(TO.a.TASK),this.customFields.length&&e.push(TO.a.CUSTOM_FIELDS),this.timeEntry.project&&e.push(TO.a.BILLABLE)):this.customFieldValues.some(e=>e.isSameForAll)&&e.push(TO.a.CUSTOM_FIELDS),this.tag&&this.overwriteTags&&e.push(TO.a.TAG),this.tag&&!this.overwriteTags&&e.push(TO.a.TAG_ADD),this.billable&&e.push(TO.a.BILLABLE),this.time&&!this.isRounding&&e.push(TO.a.TIME),this.date&&!this.isRounding&&e.push(TO.a.DATE),this.enableEditUser&&this.hasChangeUserPermission&&this.user&&this.timeEntry.user.id&&e.push(TO.a.USER),e}showPopup(e){this.hasChangeUserPermission||(e.isOpen()?e.close():e.open())}navigateToUpgrade(){this.onUpdate.emit()}resetQuery(){this.usersQuery={page:1,limit:In.f,name:"",sortColumn:"name",statuses:on.l.ACTIVE,status:on.l.ACTIVE},this.allUsersReceived=!1}getUsers(e=this.usersQuery){this.allUsersReceived||this.workspaceService.getUsers(e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(({count:t,users:n})=>{1===e.page&&(this.users=[]);const i=n.map(e=>{const t=this.translateService.instant("SHARED_MODULES.TIME_ENTRY_BULK_EDIT.USER_PENDING_MSG",{userEmail:e.email});return new Un.a(e.id,e.name||t)});if(this.users.push.apply(this.users,i),this.allUsersReceived=this.users.length>=t||n.length<e.limit,!this.timeEntry.user.name&&this.timeEntry.user.id){const e=n.filter(e=>e.id===this.timeEntry.user.id);this.timeEntry.user.name=e&&e[0]&&e[0].name}this.cd.markForCheck(),this.dropdownItems&&this.dropdownItems.triggerDetection()})}onFilterChange(e){this.resetQuery(),this.usersQuery.email=e.searchTerm,this.usersQuery.statuses=e.status,this.usersQuery.status=e.status,this.allUsersReceived=!1,this.getUsers(this.usersQuery)}loadMoreUsers(){this.usersQuery.page++,this.getUsers(this.usersQuery)}createCustomFieldList(){if(!this.sameProject)return this.customFields.filter(e=>e.status===jA.a.VISIBLE).map(e=>{const t=this.isSameValue(e);return new oO.a({customFieldId:e.id,customField:e,value:t?this.getValue(e):e.workspaceDefaultValue,isSameForAll:!1})});const e=this.timeEntry.project?this.customFields.filter(e=>e.status!==jA.a.VISIBLE&&e.projectDefaultValues.filter(e=>e.projectId===(this.timeEntry.project&&this.timeEntry.project.id)&&e.status===jA.a.VISIBLE).length>0):[];return[...this.customFields.filter(e=>e.status===jA.a.VISIBLE&&0===e.projectDefaultValues.filter(e=>e.projectId===(this.timeEntry.project&&this.timeEntry.project.id)&&e.status===jA.a.INVISIBLE).length),...e].map(e=>{const t=this.isSameValue(e);return new oO.a({customFieldId:e.id,customField:e,value:t?this.getValue(e):this.getDefault(e),isSameForAll:!1})})}getValue(e){if(this.timeEntry){const t=this.timeEntry.customFieldValues.filter(t=>t.customFieldId===e.id)[0];return t?t.value:""}}isSameValue(e){if(this.timeEntry&&this.timeEntry.customFieldValues){const t=this.timeEntry.customFieldValues.filter(t=>t.customFieldId===e.id)[0];return this.timeEntries.every(n=>{const i=n.customFieldValues.filter(t=>t.customFieldId===e.id)[0];return i&&t&&i.value===t.value})}return!1}getDefault(e){const t=e.projectDefaultValues.filter(e=>this.timeEntry.project&&e.projectId===this.timeEntry.project.id)[0];return t&&t.value?t.value:e.workspaceDefaultValue}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(re.a),s.Rb(WA.a),s.Rb(s.h),s.Rb(l.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["time-entry-bulk-edit"]],viewQuery:function(e,t){var n;1&e&&s.gd(vT,!0),2&e&&s.Kc(n=s.kc())&&(t.dropdownItems=n.first)},inputs:{timeEntries:"timeEntries",enableEditUser:"enableEditUser",entriesOwners:"entriesOwners",overrideEntiesLength:"overrideEntiesLength",autofillWithSameData:"autofillWithSameData",preventSendRequest:"preventSendRequest",inProgress:"inProgress",isTimesheet:"isTimesheet",isRounding:"isRounding",hideWorkspacesInPicker:"hideWorkspacesInPicker",hideDates:"hideDates",customFields:"customFields"},outputs:{close:"close",emitEntries:"emitEntries",onEdit:"onEdit",onUpdate:"onUpdate"},decls:83,vars:58,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group","cl-row"],[1,"cl-col-sm-3","cl-col-form-label"],[1,"cl-custom-control","cl-custom-control-inline","cl-custom-checkbox"],["type","checkbox","id","desc-1","name","description","autocomplete","off",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","desc-1",1,"cl-custom-control-label"],[1,"cl-col-sm-9","cl-position-relative"],["class","cl-blocker",4,"ngIf"],["type","text","name","descriptionName","autocomplete","off",1,"cl-form-control",3,"ngModel","placeholder","ngModelChange"],[4,"ngIf"],[1,"cl-mt-0"],[1,"cl-form-group","cl-row",3,"ngbTooltip"],["type","checkbox","id","proj-1","name","project",1,"cl-custom-control-input",3,"disabled","ngModel","ngModelChange"],["for","proj-1",1,"cl-custom-control-label"],[1,"cl-dropdown","cl-dropdown-large",3,"dropdownKey"],["dropdownKeyButton","","type","button","data-cy","project-dropdown",1,"cl-btn","cl-btn-outline-light","cl-w-100","cl-cut-text","cl-text-left","cl-dropdown-toggle"],[4,"ngIf","ngIfElse"],["noProjectTemplate",""],["class","cl-dropdown-menu",3,"selectedProject","selectedTask","selectedUserId","hideWorkspaces","selectedProjectAndTask",4,"dropdownKeyContent"],["type","checkbox","id","tags-1","name","tags",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","tags-1",1,"cl-custom-control-label"],[1,"cl-dropdown",3,"dropdownKey"],["type","button","dropdownKeyButton","","data-cy","tags-dropdown",1,"cl-btn","cl-btn-outline-light","cl-w-100","cl-cut-text","cl-text-left","cl-dropdown-toggle"],["noTagsTemplate",""],[1,"cl-cut-text-wrapper"],[1,"cl-dropdown"],["class","cl-dropdown-menu","resizeable","",3,"resizeableName","entryTags","close",4,"dropdownKeyContent"],[1,"cl-form-group","cl-row","cl-position-relative"],[1,"cl-col-sm-9"],[1,"cl-custom-control","cl-custom-radio","cl-custom-control-inline"],["type","radio","id","nonBillable","name","defaultBillableProjects",1,"cl-custom-control-input",3,"value","ngModel","ngModelChange"],["for","nonBillable",1,"cl-custom-control-label"],["type","radio","id","billable","name","defaultBillableProjects",1,"cl-custom-control-input",3,"value","ngModel","ngModelChange"],["for","billable",1,"cl-custom-control-label"],["class","cl-mt-0",4,"ngIf"],["class","cl-form-group cl-row cl-align-items-center",4,"ngIf"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","submit","ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"disabled","click"],["popContent",""],[1,"cl-blocker"],["type","checkbox","id","user-1","name","user",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","user-1",1,"cl-custom-control-label"],["triggers","manual","placement","left","container","body",3,"ngbPopover","enableSearch","filterQuery","list","placeholder","initLabel","itemLabel","value","isDisabled","offlineSearch","filterOptions","click","onFilterOptionChange","onChangedDropdown","loadMore","onOpen"],["featurePopover","ngbPopover","dropdown",""],[1,"cl-dropdown-menu",3,"selectedProject","selectedTask","selectedUserId","hideWorkspaces","selectedProjectAndTask"],[4,"ngFor","ngForOf"],["resizeable","",1,"cl-dropdown-menu",3,"resizeableName","entryTags","close"],[1,"cl-form-group","cl-row","cl-align-items-center"],["type","checkbox","name","billable","id","bill-1",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","bill-1",1,"cl-custom-control-label"],[1,"cl-custom-control","cl-custom-switch"],["type","checkbox","id","bill-2","name","billableValue",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","bill-2",1,"cl-custom-control-label"],["type","checkbox","id","time-1","name","time",1,"cl-custom-control-input",3,"disabled","ngModel","ngModelChange"],["for","time-1",1,"cl-custom-control-label"],[1,"cl-row","cl-align-items-center","detailed-report-bulk-edit"],[1,"cl-date-picker-white",3,"debounce","dateTime","mode","pickedDate"],["type","checkbox","id","date-1","name","date",1,"cl-custom-control-input",3,"disabled","ngModel","ngModelChange"],["for","date-1",1,"cl-custom-control-label"],[1,"cl-d-flex","cl-align-items-center","detailed-report-bulk-edit"],[3,"debounce","dateTime","textualDate","openUp","mode","pickedDate"],["class","cl-row cl-mb-n2",4,"ngFor","ngForOf"],[1,"cl-row","cl-mb-n2"],[1,"cl-col-sm-12","cl-col-form-label"],["type","checkbox",1,"cl-custom-control-input",3,"id","name","ngModel","ngModelChange"],[1,"cl-custom-control-label",3,"for"],[1,"cl-col-sm-12","cl-position-relative"],[1,"cl-mb-3"],[3,"customField"],[3,"click"]],template:function(e,t){if(1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.closeBulk()})),s.Xb(5,"span"),s.Sb(6,"img",3),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",4),s.Xb(8,"form"),s.Xb(9,"div",5),s.Xb(10,"div",6),s.Xb(11,"div",7),s.Xb(12,"input",8),s.jc("ngModelChange",(function(e){return t.description=e})),s.Wb(),s.Xb(13,"label",9),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(16,"div",10),s.Xc(17,TT,1,0,"div",11),s.Xb(18,"input",12),s.jc("ngModelChange",(function(e){return t.timeEntry.description=e})),s.oc(19,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xc(20,wT,15,18,"ng-container",13),s.Sb(21,"hr",14),s.Xb(22,"div",15),s.oc(23,"translate"),s.Xb(24,"div",6),s.Xb(25,"div",7),s.Xb(26,"input",16),s.jc("ngModelChange",(function(e){return t.projects=e})),s.Wb(),s.Xb(27,"label",17),s.Zc(28),s.oc(29,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(30,"div",10),s.Xc(31,LT,1,0,"div",11),s.Xb(32,"div",18),s.Xb(33,"button",19),s.Xc(34,RT,2,1,"ng-container",20),s.Xc(35,yT,2,3,"ng-template",null,21,s.Yc),s.Wb(),s.Xc(37,_T,1,4,"project-picker",22),s.Wb(),s.Wb(),s.Wb(),s.Sb(38,"hr",14),s.Xb(39,"div",5),s.Xb(40,"div",6),s.Xb(41,"div",7),s.Xb(42,"input",23),s.jc("ngModelChange",(function(e){return t.tag=e})),s.Wb(),s.Xb(43,"label",24),s.Zc(44),s.oc(45,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(46,"div",10),s.Xc(47,kT,1,0,"div",11),s.Xb(48,"div",25),s.Xb(49,"button",26),s.Xc(50,XT,2,1,"ng-container",20),s.Xc(51,NT,2,3,"ng-template",null,27,s.Yc),s.Wb(),s.Xb(53,"div",28),s.Xb(54,"div",29),s.Xc(55,DT,1,2,"tag-dropdown",30),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(56,"div",31),s.Xc(57,PT,1,0,"div",11),s.Sb(58,"div",6),s.Xb(59,"div",32),s.Xb(60,"div",33),s.Xb(61,"input",34),s.jc("ngModelChange",(function(e){return t.overwriteTags=e})),s.Wb(),s.Xb(62,"label",35),s.Zc(63),s.oc(64,"translate"),s.Wb(),s.Wb(),s.Xb(65,"div",33),s.Xb(66,"input",36),s.jc("ngModelChange",(function(e){return t.overwriteTags=e})),s.Wb(),s.Xb(67,"label",37),s.Zc(68),s.oc(69,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(70,MT,1,0,"hr",38),s.Xc(71,UT,14,9,"div",39),s.Xc(72,FT,27,26,"ng-container",13),s.Xc(73,VT,3,1,"ng-container",13),s.Wb(),s.Wb(),s.Xb(74,"div",40),s.Xb(75,"a",41),s.jc("click",(function(){return t.closeBulk()})),s.Zc(76),s.oc(77,"translate"),s.Wb(),s.Xb(78,"button",42),s.jc("click",(function(){return t.editEntries()})),s.Zc(79),s.oc(80,"translate"),s.Wb(),s.Wb(),s.Xc(81,YT,5,6,"ng-template",null,43,s.Yc)),2&e){const e=s.Lc(36),n=s.Lc(52);s.Cb(2),s.ad(s.qc(3,35,"SHARED_MODULES.TIME_ENTRY_BULK_EDIT.TITLE_PARAMS",s.Bc(56,HT,t.overrideEntiesLength||t.timeEntries.length))),s.Cb(10),s.wc("ngModel",t.description),s.Cb(2),s.ad(s.pc(15,38,"GLOBAL.DESCRIPTION_LABEL")),s.Cb(3),s.wc("ngIf",!t.description),s.Cb(1),s.wc("ngModel",t.timeEntry.description)("placeholder",s.pc(19,40,"TRACKER.TIME_TRACKER.ENTRY.DESCRIPTION")+"..."),s.Cb(2),s.wc("ngIf",t.enableEditUser),s.Cb(2),s.wc("ngbTooltip",!t.isAdminOrOwner&&t.entriesOfMultipleUsersSelected?s.pc(23,42,"PROJECTS.PROJECT_BULK_EDIT.UPDATE_NO_PERMISSIONS_WARNING"):""),s.Cb(4),s.wc("disabled",!t.isAdminOrOwner&&t.entriesOfMultipleUsersSelected)("ngModel",t.projects),s.Cb(2),s.ad(s.pc(29,44,"GLOBAL.PROJECT_LABEL")),s.Cb(3),s.wc("ngIf",!t.projects),s.Cb(1),s.wc("dropdownKey",!t.projects),s.Cb(2),s.wc("ngIf",t.timeEntry.project)("ngIfElse",e),s.Cb(8),s.wc("ngModel",t.tag),s.Cb(2),s.ad(s.pc(45,46,"GLOBAL.TAGS_LABEL")),s.Cb(3),s.wc("ngIf",!t.tag),s.Cb(1),s.wc("dropdownKey",!t.tag),s.Cb(2),s.wc("ngIf",null==t.timeEntry.tags?null:t.timeEntry.tags.length)("ngIfElse",n),s.Cb(7),s.wc("ngIf",!t.tag),s.Cb(4),s.wc("value",!1)("ngModel",t.overwriteTags),s.Cb(2),s.ad(s.pc(64,48,"PROJECTS.PROJECT_BULK_EDIT.ADD_TO_EXISTING_LABEL")),s.Cb(3),s.wc("value",!0)("ngModel",t.overwriteTags),s.Cb(2),s.ad(s.pc(69,50,"PROJECTS.PROJECT_BULK_EDIT.OVERWRITE_EXISTING_LABEL")),s.Cb(2),s.wc("ngIf",t.workspace.activeBillableHours&&(!t.workspace.onlyAdminsCanChangeBillableStatus||t.isAdminOrOwner)),s.Cb(1),s.wc("ngIf",t.workspace.activeBillableHours&&(!t.workspace.onlyAdminsCanChangeBillableStatus||t.isAdminOrOwner)),s.Cb(1),s.wc("ngIf",!t.hideDates),s.Cb(1),s.wc("ngIf",null==t.customFields?null:t.customFields.length),s.Cb(3),s.ad(s.pc(77,52,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",t.inProgress),s.Cb(1),s.ad(s.pc(80,54,"GLOBAL.SAVE_LABEL"))}},directives:[v.I,v.t,v.u,v.a,v.s,v.v,i.u,v.c,w.bb,ni.a,ii.a,si.a,v.A,ji.a,w.M,NO.a,i.t,PO.a,DO.a,zr.a,OT.a],pipes:[g.e],styles:[".cl-bulk-edit h4{margin:20px}"],changeDetection:0}),e})();const KT=["childrenEntries"];function qT(e,t){if(1&e){const e=s.Yb();s.Xb(0,"approval-header",6),s.jc("onSubmit",(function(t){return s.Oc(e),s.nc().onApprovalSubmit.emit(t)}))("onWithdraw",(function(t){return s.Oc(e),s.nc().onApprovalWithdraw.emit(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("startOfWeek",e.startOfWeek)("weekStatus",e.weekStatus)("timeApprovalEnabled",e.timeApprovalEnabled)("format",e.format)}}function zT(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"time-tracker-entry",11,12),s.jc("singleEntryChanged",(function(n){s.Oc(e);const i=t.index,c=s.nc(3).index;return s.nc().singleEntryChanged(n,c,i)}))("onSignleBulkChange",(function(){return s.Oc(e),s.nc(2),s.Lc(2).notifyParentSingleEntryChanged()}))("entryIsDeleted",(function(n){s.Oc(e);const i=t.index,c=s.nc(3).index;return s.nc().entryIsDeleted(n,c,i)}))("entryDurationChanged",(function(t){s.Oc(e),s.nc(2);const n=s.Lc(2),i=s.nc().index;return s.nc().entryDurationChanged(t,i),null==n?null:n.notifyParentSingleEntryChanged()})),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc(4);s.Cb(1),s.wc("timeEntry",e)("disableManualModeEdit",n.disableManualMode)("isAdminOrOwner",n.isAdminOrOwner)("format",n.format)("projectData",n.projectData)("editMode",n.entryGroup.editMode)("customFields",n.customFields)("hideWorkspacesInPicker",n.hideWorkspacesInPicker)}}function QT(e,t){if(1&e&&(s.Vb(0),s.Xc(1,zT,3,8,"div",3),s.Ub()),2&e){const e=s.nc(2).$implicit,t=s.nc();s.Cb(1),s.wc("ngForOf",e.children)("ngForTrackBy",t.trackByFn)}}function JT(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"parent-tracker-entry",9,10),s.jc("entryIsDeleted",(function(t){s.Oc(e);const n=s.nc().index;return s.nc().similarEntriesDeleted(t,n)}))("refreshView",(function(t){s.Oc(e);const n=s.nc().index;return s.nc().refreshGroupView(n,t)}))("onBulkEditChange",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().childTriggerDetection(t.children)})),s.Wb(),s.Xc(3,QT,2,2,"ng-container",7),s.Ub()}if(2&e){const e=s.nc().$implicit,t=s.nc();s.Cb(1),s.Hb("cl-time-tracker-entry",t.customFields.length>0),s.wc("childrenLength",e.children.length)("timeEntry",e)("disableManualModeEdit",t.disableManualMode)("isAdminOrOwner",t.isAdminOrOwner)("format",t.format)("projectData",t.projectData)("editMode",t.entryGroup.editMode)("userId",t.userId)("customFields",t.customFields)("hideWorkspacesInPicker",t.hideWorkspacesInPicker),s.Cb(2),s.wc("ngIf",e.expanded)}}function eI(e,t){if(1&e){const e=s.Yb();s.Xb(0,"time-tracker-entry",13),s.jc("singleEntryChanged",(function(t){s.Oc(e);const n=s.nc().index;return s.nc().singleEntryChanged(t,n)}))("entryIsDeleted",(function(t){s.Oc(e);const n=s.nc().index;return s.nc().entryIsDeleted(t,n)}))("entryDurationChanged",(function(t){return s.Oc(e),s.nc(2).entryDurationChanged(t)})),s.Wb()}if(2&e){const e=s.nc().$implicit,t=s.nc();s.wc("timeEntry",e)("disableManualModeEdit",t.disableManualMode)("isAdminOrOwner",t.isAdminOrOwner)("format",t.format)("projectData",t.projectData)("editMode",t.entryGroup.editMode)("customFields",t.customFields)("hideWorkspacesInPicker",t.hideWorkspacesInPicker)}}function tI(e,t){if(1&e&&(s.Vb(0),s.Xc(1,JT,4,13,"ng-container",7),s.Xc(2,eI,1,8,"time-tracker-entry",8),s.Ub()),2&e){const e=t.$implicit;s.Cb(1),s.wc("ngIf",e.children),s.Cb(1),s.wc("ngIf",!e.children)}}function nI(e,t){if(1&e){const e=s.Yb();s.Xb(0,"time-entry-bulk-edit",14),s.jc("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.Wb()}if(2&e){const e=s.nc();s.wc("hideDates",e.disableManualMode)("hideWorkspacesInPicker",e.hideWorkspacesInPicker)("timeEntries",e.timeEntriesSelected)("entriesOwners",e.selectedEntriesOwners)("customFields",e.customFields)}}const iI=function(e){return{value:e}};function sI(e,t){if(1&e&&(s.Xb(0,"delete-confirm-modal",15),s.jc("onDelete",(function(){return t.$implicit.close(!0)}))("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.oc(2,"uppercase"),s.oc(3,"translate"),s.Xb(4,"p",16),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.wc("title",s.pc(1,3,"GLOBAL.DELETE_BTN"))("btnText",s.pc(2,5,s.pc(3,7,"GLOBAL.DELETE_BTN"))),s.Cb(5),s.bd(" ",s.qc(6,9,"TRACKER.TIME_TRACKER.ENTRY.DELETE.CONFIRM",s.Bc(12,iI,e.timeEntriesSelected.length))," ")}}let cI=(()=>{class e{constructor(e,t,n,i,c,a,o){this.keyboardService=e,this.trackerService=t,this.authService=n,this.entryBulk=i,this.cd=c,this.entryGroupService=a,this.modalService=o,this.deleteEntryGroup=new s.n,this.subtractWeekDuration=new s.n,this.addWeekDuration=new s.n,this.loaded=new s.n,this.onApprovalSubmit=new s.n,this.onApprovalWithdraw=new s.n,this.unsubscribe$=new p.a;const r=this.authService.getUser();r&&(this.userId=r.id,this.GROUPING_IS_DISABLED=r.settings.groupSimilarEntriesDisabled,this.entryGroupService.setIsGroupDisabled(this.GROUPING_IS_DISABLED))}set isAdminOrOwner(e){this._isAdminOrOwner=e,this.isEditingAvailable()}get isAdminOrOwner(){return this._isAdminOrOwner}set entryGroup(e){e&&(e.time||(e.time=this.entryGroupService.calculateTotalDuration(e.timeEntries)),this._entryGroup=this.entryGroupService.transformEntryGroup(e),this.entryBulk.recalculateBulkCheckboxes(this.entryGroup.timeEntries),this.isEditingAvailable())}get entryGroup(){return this._entryGroup}set customFields(e){this._customFields=e,e.length&&(this.hideWorkspacesInPicker=!0)}get customFields(){return this._customFields}shouldBeChild(e){if(this.GROUPING_IS_DISABLED)return!1;const t=this.entryGroup.timeEntries,n=t.length;for(let i=0;i<n;i++){const n=t[i];if(e.id!=n.id&&e.sameGroupWith(n))return!0}return!1}ngAfterViewInit(){this.loaded.emit()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}isEditingAvailable(){this.entryGroup&&this.entryGroup.timeEntries&&this.entryGroup.timeEntries[0]&&(this.disableEdit=this.entryGroup.timeEntries[0].isLocked&&!this.isAdminOrOwner)}getSelected(){let e=[];return this.entryGroup.timeEntries.forEach(t=>{t.children?e=e.concat(t.children):e.push(t)}),e.filter(e=>e.bulkEdit)}openDeleteModal(e){this.isModalOpen||(this.isModalOpen=!0,this.timeEntriesSelected=this.getSelected(),this.keyboardService.removeListener(),this.modalService.open(e,{centered:!0}).result.then(e=>{e&&this.deleteManyConfirmed(),this.isModalOpen=!1,this.keyboardService.addListener()},e=>{this.isModalOpen=!1,this.keyboardService.addListener()}))}deleteManyConfirmed(){this.trackerService.deleteMany(this.timeEntriesSelected.map(e=>e.id),this.userId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.entryGroup.editMode=!1,this.entryBulk.setSelectAll(!1),this.trackerService.getAllTimeEntries()})}openBulkEdit(e){this.isModalOpen||(this.isModalOpen=!0,this.keyboardService.removeListener(),this.modalService.open(e,{centered:!0}).result.then(e=>{e&&(this.entryGroup.editMode=!1,this.entryBulk.setSelectAll(!1),this.trackerService.getAllTimeEntries()),this.isModalOpen=!1,this.keyboardService.addListener()},e=>{this.isModalOpen=!1,this.keyboardService.addListener()}),this.timeEntriesSelected=this.getSelected())}get selectedEntriesOwners(){return[...new Set(this.timeEntriesSelected.map(e=>e.userId))]}trackByFn(e,t){return t.id}childTriggerDetection(e){if(!this.childrenEntriesRef||!e)return;const t=e.map(e=>e.id);this.childrenEntriesRef.forEach(e=>{t.indexOf(e.getId())>-1&&e.triggerDetection()})}removeParentIfNoMoreChildren(e,t){if(e.children.length<2){const n=e.children[0];this.entryGroup.timeEntries.splice(t,1),n&&(e.children.splice(0,1),this.entryGroupService.addElementToEntryGroup(n,this.entryGroup.timeEntries,this.entryGroup.date))}}refreshGroupView(e,t){if(t){const t=this.entryGroup.timeEntries[e];t&&t.children&&this.childTriggerDetection(t.children)}this.entryGroupService.refreshGroupView(this.entryGroup)}singleEntryChanged(e,t,n){if(e.isChild&&!this.GROUPING_IS_DISABLED){const i=this.entryGroup.timeEntries[t];if(!e.sameGroupWith(i)){i.children.splice(n,1);const s=this.entryGroupService.addElementToEntryGroup(e,this.entryGroup.timeEntries,this.entryGroup.date);i&&this.entryGroupService.setDateAndDurationForSameEntries(i),this.removeParentIfNoMoreChildren(i,t),s>-1&&this.entryGroupService.setDateAndDurationForSameEntries(this.entryGroup.timeEntries[s])}}else if(this.shouldBeChild(e)){this.entryGroup.timeEntries.splice(t,1);const n=this.entryGroupService.addElementToEntryGroup(e,this.entryGroup.timeEntries,this.entryGroup.date);n>-1&&(Object(sn.F)(this.entryGroup.timeEntries[n].children),this.entryGroupService.setDateAndDurationForSameEntries(this.entryGroup.timeEntries[n]))}Object(sn.F)(this.entryGroup.timeEntries),this.cd.detectChanges()}entryIsDeleted(e,t,n){const i=new DA.a(this.entryGroup.time),s=(new DA.a).intervalToDuration(e.timeInterval),c=new DA.a(s).asString();i.subtract(s),this.entryGroup.time=i.asString(),e.isChild?(this.entryGroup.timeEntries[t].children.splice(n,1),this.removeParentIfNoMoreChildren(this.entryGroup.timeEntries[t],t),this.entryGroup.timeEntries[t]&&this.entryGroupService.setDateAndDurationForSameEntries(this.entryGroup.timeEntries[t])):this.entryGroup.timeEntries.splice(t,1),0===this.entryGroup.timeEntries.length?this.deleteEntryGroup.emit(c):this.subtractWeekDuration.emit(c),this.entryBulk.recalculateBulkCheckboxes(),this.entryGroupService.numberOfEntriesChanged()}similarEntriesDeleted(e,t){const n=new DA.a(this.entryGroup.time),i=e.timeInterval.duration;n.subtract(i),this.entryGroup.time=n.asString(),this.entryGroup.timeEntries.splice(t,1),0===this.entryGroup.timeEntries.length?this.deleteEntryGroup.emit(i):this.subtractWeekDuration.emit(i),this.entryGroupService.numberOfEntriesChanged()}entryDurationChanged({newInterval:e,oldInterval:t},n){const i=new DA.a,s=i.intervalToDuration(e),c=i.intervalToDuration(t),a=new DA.a(this.entryGroup.time),o=s-c;this.entryGroup.time=a.add(o).asString(),(n||0===n)&&this.entryGroup.timeEntries[n].children&&(Object(sn.F)(this.entryGroup.timeEntries[n].children),this.entryGroupService.setDateAndDurationForSameEntries(this.entryGroup.timeEntries[n])),Object(sn.F)(this.entryGroup.timeEntries),this.entryBulk.recalculateBulkCheckboxes(this.entryGroup.timeEntries);const r=new DA.a(Math.abs(o)).asString();o<0?this.subtractWeekDuration.emit(r):this.addWeekDuration.emit(r)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(PA.a),s.Rb(WA.a),s.Rb(re.a),s.Rb(xe),s.Rb(s.h),s.Rb(XA.a),s.Rb(w.q))},e.\u0275cmp=s.Lb({type:e,selectors:[["entry-group"]],viewQuery:function(e,t){var n;1&e&&s.gd(KT,!0),2&e&&s.Kc(n=s.kc())&&(t.childrenEntriesRef=n)},inputs:{isAdminOrOwner:"isAdminOrOwner",entryGroup:"entryGroup",format:"format",projectData:"projectData",timeApprovalEnabled:"timeApprovalEnabled",startOfWeek:"startOfWeek",disableManualMode:"disableManualMode",customFields:"customFields",weekStatus:"weekStatus"},outputs:{deleteEntryGroup:"deleteEntryGroup",subtractWeekDuration:"subtractWeekDuration",addWeekDuration:"addWeekDuration",loaded:"loaded",onApprovalSubmit:"onApprovalSubmit",onApprovalWithdraw:"onApprovalWithdraw"},features:[s.Bb([xe])],decls:8,vars:8,consts:[["class","cl-d-flex cl-justify-content-between cl-flex-column cl-flex-lg-row cl-px-2 cl-px-lg-0 cl-mb-3",3,"startOfWeek","weekStatus","timeApprovalEnabled","format","onSubmit","onWithdraw",4,"ngIf"],[1,"cl-card"],[3,"date","format","disableEdit","editMode","time","changeEditMode","bulkEdit","bulkDelete"],[4,"ngFor","ngForOf","ngForTrackBy"],["edit",""],["delete",""],[1,"cl-d-flex","cl-justify-content-between","cl-flex-column","cl-flex-lg-row","cl-px-2","cl-px-lg-0","cl-mb-3",3,"startOfWeek","weekStatus","timeApprovalEnabled","format","onSubmit","onWithdraw"],[4,"ngIf"],["class","cl-hover-shadow",3,"timeEntry","disableManualModeEdit","isAdminOrOwner","format","projectData","editMode","customFields","hideWorkspacesInPicker","singleEntryChanged","entryIsDeleted","entryDurationChanged",4,"ngIf"],[1,"cl-parent-collapse","cl-hover-shadow",3,"childrenLength","timeEntry","disableManualModeEdit","isAdminOrOwner","format","projectData","editMode","userId","customFields","hideWorkspacesInPicker","entryIsDeleted","refreshView","onBulkEditChange"],["parent",""],[1,"cl-collapse",3,"timeEntry","disableManualModeEdit","isAdminOrOwner","format","projectData","editMode","customFields","hideWorkspacesInPicker","singleEntryChanged","onSignleBulkChange","entryIsDeleted","entryDurationChanged"],["childrenEntries",""],[1,"cl-hover-shadow",3,"timeEntry","disableManualModeEdit","isAdminOrOwner","format","projectData","editMode","customFields","hideWorkspacesInPicker","singleEntryChanged","entryIsDeleted","entryDurationChanged"],[3,"hideDates","hideWorkspacesInPicker","timeEntries","entriesOwners","customFields","close"],[3,"title","btnText","onDelete","onClose"],[1,"cl-h2","cl-cut-text-wrap"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xc(0,qT,1,4,"approval-header",0),s.Xb(1,"div",1),s.Xb(2,"entry-group-header",2),s.jc("changeEditMode",(function(e){return t.entryGroup.editMode=e}))("bulkEdit",(function(){s.Oc(e);const n=s.Lc(5);return t.openBulkEdit(n)}))("bulkDelete",(function(){s.Oc(e);const n=s.Lc(7);return t.openDeleteModal(n)})),s.Wb(),s.Xc(3,tI,3,2,"ng-container",3),s.Wb(),s.Xc(4,nI,1,5,"ng-template",null,4,s.Yc),s.Xc(6,sI,7,14,"ng-template",null,5,s.Yc)}2&e&&(s.wc("ngIf",t.weekStatus),s.Cb(2),s.wc("date",t.entryGroup.date)("format",t.format)("disableEdit",t.disableEdit)("editMode",t.entryGroup.editMode)("time",t.entryGroup.time),s.Cb(1),s.wc("ngForOf",t.entryGroup.timeEntries)("ngForTrackBy",t.trackByFn))},directives:[i.u,mv,i.t,yv,Jv,AT,$T,Xd.a],pipes:[g.e,i.I],styles:[".cl-collapse{background:#f2f6f8}"],changeDetection:0}),e})();function aI(e,t){if(1&e){const e=s.Yb();s.Xb(0,"entry-group",12),s.jc("loaded",(function(){s.Oc(e);const n=t.index,i=t.last;return s.nc(3).lazyLoading(n+1,i)}))("deleteEntryGroup",(function(n){s.Oc(e);const i=t.index,c=t.$implicit;return s.nc(3).deleteEntryGroup(i,c,n)}))("subtractWeekDuration",(function(n){s.Oc(e);const i=t.$implicit;return s.nc(3).changeWeekDuration(i.date,n,"subtract")}))("addWeekDuration",(function(n){s.Oc(e);const i=t.$implicit;return s.nc(3).changeWeekDuration(i.date,n,"add")}))("onApprovalSubmit",(function(t){return s.Oc(e),s.nc(3).onWeekSubmitStatusChange(t)}))("onApprovalWithdraw",(function(t){return s.Oc(e),s.nc(3).onWeekSubmitStatusChange(t)})),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc(3);s.wc("format",n.format)("startOfWeek",n.startOfWeek)("isAdminOrOwner",n.isAdminOrOwner)("projectData",n.projectData)("weekStatus",e.weekStatus)("customFields",n.customFields)("timeApprovalEnabled",n.workspace.timeApprovalEnabled)("disableManualMode",n.disableManualMode)("entryGroup",e)}}function oI(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",8),s.Xc(1,aI,1,9,"entry-group",9),s.Xb(2,"pager",10,11),s.jc("pageChanged",(function(t){return s.Oc(e),s.nc(2).setPaginationUrl(t)}))("limitChanged",(function(t){return s.Oc(e),s.nc(2).setPaginationUrl(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Hb("cl-entries-w-cf",e.hasActiveCustomFields),s.Cb(1),s.wc("ngForOf",e.entryGroupsLazy)("ngForTrackBy",e.trackByFn),s.Cb(1),s.wc("visible",e.isMultiplePages)("page",e.page)("limit",e.limit)("total",e.total)}}function rI(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",34),s.jc("click",(function(){return s.Oc(e),s.nc(3).emptyStateEnableTimesheet()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.ad(s.pc(2,1,"ENABLE_TIMESHEET_MODE")))}function lI(e,t){if(1&e&&(s.Xb(0,"div",13),s.Xb(1,"message-entries",14),s.Xb(2,"div",15),s.Xb(3,"div",16),s.Sb(4,"img",17),s.Wb(),s.Xb(5,"span",18),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"p",19),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Xb(11,"div",20),s.Xb(12,"a",21),s.mc(),s.Xb(13,"svg",22),s.Xb(14,"g",23),s.Sb(15,"path",24),s.Wb(),s.Xb(16,"defs"),s.Xb(17,"clipPath",25),s.Sb(18,"rect",26),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.lc(),s.Xb(19,"a",21),s.mc(),s.Xb(20,"svg",27),s.Sb(21,"path",28),s.Sb(22,"path",29),s.Wb(),s.Wb(),s.lc(),s.Xb(23,"a",21),s.mc(),s.Xb(24,"svg",22),s.Sb(25,"path",30),s.Wb(),s.Wb(),s.lc(),s.Xb(26,"a",21),s.mc(),s.Xb(27,"svg",22),s.Sb(28,"path",31),s.Wb(),s.Wb(),s.Wb(),s.lc(),s.Xb(29,"a",32),s.Zc(30),s.oc(31,"translate"),s.Wb(),s.Xc(32,rI,3,3,"a",33),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("isError",e.isError)("loadInProgress",e.loadInProgress)("isTracker",!0),s.Cb(5),s.ad(s.pc(7,7,"LETS_START_TRACKING")),s.Cb(3),s.ad(s.pc(10,9,"INSTAL_AND_TRACK_ANYWHERE")),s.Cb(21),s.ad(s.pc(31,11,"FIFTY_PLUS_INTEGRATIONS")),s.Cb(2),s.wc("ngIf",e.isAdminOrOwner&&!e.enabledTimesheet)}}function bI(e,t){if(1&e&&(s.Xb(0,"div",3),s.Xb(1,"div",4),s.Sb(2,"time-tracker-recorder",5),s.Xc(3,oI,4,8,"div",6),s.Xc(4,lI,33,13,"ng-template",null,7,s.Yc),s.Wb(),s.Wb()),2&e){const e=s.Lc(5),t=s.nc();s.Cb(2),s.Hb("cl-recorder-get-out",!t.isSidebarOpen),s.wc("entryInProgress",t.entryInProgress)("entryGroups",t.entryGroupsLazy)("projectData",t.projectData)("format",t.format)("disableManualMode",t.disableManualMode)("setCustomFields",t.customFields),s.Cb(1),s.wc("ngIf",(null==t.entryGroupsLazy?null:t.entryGroupsLazy.length)>0)("ngIfElse",e)}}function dI(e,t){1&e&&(s.Xb(0,"div",40),s.Sb(1,"img",41),s.Xb(2,"div"),s.Xb(3,"div",42),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"div",43),s.Xb(7,"a",44),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(4),s.ad(s.pc(5,2,"TRACKER.TIME_TRACKER.TIMESHEET.ENABLED")),s.Cb(4),s.bd(" ",s.pc(9,4,"TRACKER.TIME_TRACKER.TIMESHEET.GO_TO")," "))}function uI(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",40),s.Sb(1,"img",45),s.Xb(2,"div"),s.Xb(3,"div",42),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"a",46),s.jc("click",(function(){return s.Oc(e),s.nc(2).enableTimeSheet()})),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(4),s.ad(s.pc(5,2,"TRACKER.TIME_TRACKER.TIMESHEET.PREFER")),s.Cb(3),s.ad(s.pc(8,4,"TRACKER.TIME_TRACKER.TIMESHEET.ENABLE")))}function pI(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",35),s.Xb(1,"div",36),s.Xb(2,"div",37),s.Xb(3,"button",38),s.jc("click",(function(){return s.Oc(e),s.nc().closeOnboardingTimesheet()})),s.Xb(4,"span"),s.Zc(5,"\xd7"),s.Wb(),s.Wb(),s.Xc(6,dI,10,6,"div",39),s.Xc(7,uI,9,6,"div",39),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(6),s.wc("ngIf",e.enabledTimesheet),s.Cb(1),s.wc("ngIf",!e.enabledTimesheet)}}let hI=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r,l,b,d,u,h,m,g,E,f,S,C){this.authService=e,this.cd=t,this.uiSettingsService=n,this.approvalService=i,this.userService=s,this.tagService=c,this.entryHelper=a,this.workspaceService=o,this.entryGroupService=r,this.activatedRoute=l,this.router=b,this.approvalHelperService=d,this.browserService=u,this.synchronizationService=h,this.keyboardService=m,this.trackerService=g,this.customFieldService=E,this.sidebarStateService=f,this.sidebarScrollService=S,this.systemSettingsService=C,this.entryGroupsTemp=[],this.entryGroupsLazy=[],this.unsubscribe$=new p.a,this.stompDebouncer$=new p.a,this.customFields=[],this.weekStatusMap={}}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}ngOnInit(){this.isNew="true"===localStorage.getItem("isNew"),this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.authService.permissionData$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(({isAdminOrOwner:e})=>{this.isAdminOrOwner=e,this.setOnboardingTimesheet(),this.cd.detectChanges()}),this.startOfWeek=this.authService.getUser().settings.weekStart,this.activatedRoute.queryParams.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{if(this.page=Object(sn.u)(e.page)&&e.page>0?Number(e.page||1):1,Object(sn.u)(e.limit)&&e.limit>0&&e.limit<=500)this.limit=Number(e.limit||In.j);else{const e=this.uiSettingsService.getSettings(xn.b.TRACKER_PAGINATION)||{};this.limit=e.limit||In.j}this.getAllTimeEntries()}),this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.setWorkspaceSettings(e),e.hasFeature(is.a.CUSTOM_FIELDS)&&this.getCustomFields(),this.enabledTimesheet=!!this.workspace.canSeeTimeSheet}),this.subscribeToAllTimeEntries(),this.tagService.clearTagsSubject(),this.tagService.getAllTags(Rn.a.ACTIVE),this.subscribeToNewEntry(),this.subscribeEntryChanged(),this.synchronizationService.onStompEntryChange$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.stompDebouncer$.next(e)}),this.stompDebouncer$.pipe(Object(De.a)(600),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>this.trackerService.getAllTimeEntries()),this.userService.onTimeZoneChange$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>this.getAllTimeEntries()),this.subscribeToSidebarState()}subscribeToSidebarState(){this.sidebarStateService.sidebarState$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isSidebarOpen=e,this.cd.markForCheck()})}getAllTimeEntries(){this.isError=!1,this.loadInProgress=!0,this.trackerService.getAllTimeEntries(this.page,this.limit,!0)}setWorkspaceSettings(e){this.workspace=e,this.disableManualMode=e.disableManualMode;const t=this.authService.getUser();this.projectData=new BA.a(e,t),this.format=e.getTimeFormat(),this.entryHelper.projectGroupingLabel=e.projectGroupingLabel,this.cd.detectChanges()}setOnboardingTimesheet(){this.workspace&&(this.onboardingTimesheet=!this.workspace.canSeeTimeSheet&&this.isAdminOrOwner&&this.isNew)}lazyLoading(e,t){if(!this.lazyLoadingInProgress)return;const n=this.entryGroupsTemp.length;e<n?setTimeout(()=>{if(t&&!this.cd.destroyed){let t=e+this.lazyStep;t=t>n?n:t;for(let n=e;n<t;n++)this.entryGroupsLazy.push(this.entryGroupsTemp[n]);this.cd.detectChanges()}}):(this.keyboardService.addListener(),this.lazyLoadingInProgress=!1,this.lazyLoading$.next(),this.lazyLoading$.complete())}onWeekSubmitStatusChange({id:e,startDayOfWeek:t}){this.weekStatusMap[t].id=e||null,this.refreshSingleWeekHeader(t)}refreshSingleWeekHeader(e){this.entryGroupsLazy.find(t=>{var n;return(null===(n=t.weekStatus)||void 0===n?void 0:n.startDayOfWeek)===e}).weekStatus=new We.a(this.weekStatusMap[e])}subscribeToAllTimeEntries(){this.trackerService.timeEntries$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{if(!e)return this.isError=!0,this.loadInProgress=!1,void this.cd.detectChanges();if(this.weekStatusMap=e.weekStatusMap||{},this.approvalHelperService.updateWeekStatusToGroups(e.entryGroups,this.weekStatusMap,!0),this.total=e.total,this.isMultiplePages=this.total>In.j||this.total>this.limit,this.numberOfEntries=e.received,0===e.entryGroups.length&&1!=this.page&&(this.page=1,this.setPaginationUrl({page:this.page}),this.pager)&&this.pager.setPaginationManually({page:this.page,limit:this.limit,total:this.total}),this.isError=!1,this.loadInProgress=!1,e.entryInProgress&&(this.entryInProgress=e.entryInProgress),e.preventScroll||this.browserService.scrollToTop(),e.lazyLoading){this.entryGroupsTemp=e.entryGroups,this.lazyStep=this.setLazyStep(this.entryGroupsTemp)||2;const t=this.lazyStep>e.entryGroups.length?e.entryGroups.length:this.lazyStep;this.entryGroupsLazy=this.entryGroupsTemp.slice(0,t),this.cd.detectChanges(),t<e.entryGroups.length&&(this.keyboardService.removeListener(),this.lazyLoadingInProgress=!0,this.lazyLoading$=new p.a,this.lazyLoading(t,!0))}else this.entryGroupsLazy=e.entryGroups,this.cd.detectChanges()})}setLazyStep(e){let t=0;for(let n=0;n<e.length;n++)if(t+=e[n].timeEntries.length,t>10)return(0===n?1:n)+1;return e.length}setPaginationUrl(e){this.uiSettingsService.setSettings(xn.b.TRACKER_PAGINATION,e),this.router.navigate(["/"+In.o],{queryParams:{page:e.page||this.page,limit:e.limit||this.limit}})}trackByFn(e,t){return t.id}subscribeEntryChanged(){this.entryGroupService.numberOfEntriesChanged$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.checkPaginationSize()})}checkPaginationSize(){let e=0;this.entryGroupsLazy.forEach(t=>{t.timeEntries.forEach(t=>{t.children?e+=t.children.length:e++})}),this.numberOfEntries=e,this.pager&&this.pager.setNumberOfEntriesOnPage(e),0===e&&this.getAllTimeEntries()}deleteEntryGroup(e,t,n){this.lazyLoadingInProgress?this.lazyLoading$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>this.removeEntryGroup(e,t,n)):this.removeEntryGroup(e,t,n)}removeEntryGroup(e,t,n){this.entryGroupsLazy.splice(e,1),this.changeWeekDuration(t.date,n,"subtract")}changeWeekDuration(e,t,n){const i=Object(_e.h)(tn(e),this.startOfWeek).format("YYYY-MM-DD");this.weekStatusMap[i]&&("add"===n?this.weekStatusMap[i].addTotalDuration(t):this.weekStatusMap[i].subtractTotalDuration(t),this.approvalHelperService.updateWeekStatusToGroups(this.entryGroupsLazy,this.weekStatusMap))}getSingleWeekStatus(e){if(!this.workspace.timeApprovalEnabled)return;const t=tn.utc(e).toISOString();this.approvalService.getWeekStatus(t,e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{const{entriesCount:n,approvedCount:i}=this.approvalHelperService.getTotalsOfWeek(this.entryGroupsLazy,t.startDayOfWeek);t.initIsApprovedOnOtherPages(n,i),this.weekStatusMap[e]=t,this.approvalHelperService.updateWeekStatusToGroups(this.entryGroupsLazy,this.weekStatusMap),this.cd.detectChanges()})}subscribeToNewEntry(){this.entryGroupService.newEntryCreated$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.lazyLoadingInProgress?this.lazyLoading$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.addEntryGroup(e)}):this.addEntryGroup(e)})}addEntryGroup(e){const t=this.userService.getTimeZone(),n=tn.tz(e.timeInterval.start,t).format("YYYY-MM-DD"),i=this.entryGroupsLazy.findIndex(e=>e.date===n);if(i>=0&&this.entryGroupsLazy[i]){const t=new DA.a(this.entryGroupsLazy[i].time);t.add(e.timeInterval.duration),this.entryGroupsLazy[i].time=t.asString(),this.entryGroupsLazy[i].timeEntries.push(e);const n=this.entryGroupsLazy[i];this.entryGroupsLazy[i]=new nn.a(n.date,n.time,n.timeEntries,n.editMode,n.weekStatus),this.changeWeekDuration(n.date,e.timeInterval.duration,"add")}else{const t=this.entryGroupsLazy.length?this.entryGroupsLazy[this.entryGroupsLazy.length-1].date:0,i=this.entryGroupsLazy.length?this.entryGroupsLazy[0].date:0;if(this.numberOfEntries<this.limit)this.createNewEntryGroup(e,n);else if(1===this.page&&tn(n).isAfter(tn(i)))this.createNewEntryGroup(e,n);else if(tn(n).isAfter(tn(t))&&tn(n).isBefore(tn(i)))this.createNewEntryGroup(e,n);else if(tn(n).isBefore(tn(t))){this.isMultiplePages=!0,this.pager&&this.pager.allowNextPage();const t=Object(_e.h)(tn(n),this.startOfWeek).format("YYYY-MM-DD");this.weekStatusMap[t]&&(this.weekStatusMap[t].isApprovedAllOnOtherPages=!1),this.changeWeekDuration(n,e.timeInterval.duration,"add")}}this.checkPaginationSize(),this.cd.detectChanges()}createNewEntryGroup(e,t){const n=new nn.a(t,e.timeInterval.duration,[e]),i=this.entryGroupsLazy.length;let s=0;for(let a=0;a<i;a++)tn(t).isBefore(tn(this.entryGroupsLazy[a].date))&&(s=a+1);s>=i?this.entryGroupsLazy.push(n):this.entryGroupsLazy.splice(s,0,n);const c=Object(_e.h)(tn(t),this.startOfWeek).format("YYYY-MM-DD");if(this.weekStatusMap[c])this.changeWeekDuration(t,n.time,"add");else{const e={startDayOfWeek:c,total:n.time,isApprovedAllOnOtherPages:!0,dateRange:{start:tn(c).startOf("day").toISOString(),end:tn(c).add(6,"day").endOf("day").toISOString()}};this.weekStatusMap[c]=new We.a(e),this.approvalHelperService.updateWeekStatusToGroups(this.entryGroupsLazy,this.weekStatusMap),this.getSingleWeekStatus(c)}this.cd.detectChanges()}enableTimeSheet(){this.workspace.canSeeTimeSheet=!0;const e={preventToast:!0,onSuccess:this.enableTimeSheetOnSuccess.bind(this)};this.workspaceService.updateWorkspaceSettings(this.workspace,e)}enableTimeSheetOnSuccess(){this.enabledTimesheet=!0}closeOnboardingTimesheet(){this.onboardingTimesheet=!1}getCustomFields(){this.customFieldService.get().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.customFields=e,this.hasActiveCustomFields=e.some(e=>e.status===jA.a.VISIBLE),this.cd.detectChanges()})}emptyStateEnableTimesheet(){this.enableTimeSheet(),location.reload()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(re.a),s.Rb(s.h),s.Rb(xn.a),s.Rb(rn),s.Rb(Lc.a),s.Rb(vn.a),s.Rb(NA.a),s.Rb(l.a),s.Rb(XA.a),s.Rb(k.a),s.Rb(k.d),s.Rb(Xe),s.Rb(Gn.a),s.Rb(MA.a),s.Rb(PA.a),s.Rb(WA.a),s.Rb(UA.a),s.Rb(FA.a),s.Rb(xA),s.Rb(bn.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["tracker2"]],viewQuery:function(e,t){var n;1&e&&s.gd(Pi.a,!0),2&e&&s.Kc(n=s.kc())&&(t.pager=n.first)},decls:3,vars:2,consts:[[1,"cl-page-wrapper","cl-px-0","cl-px-lg-2","cl-pt-0"],["class","cl-tracker-wrapper",4,"ngIf"],["class","cl-toast-wrapper",4,"ngIf"],[1,"cl-tracker-wrapper"],[1,"cl-container-fluid","cl-px-0","cl-px-lg-2"],[1,"cl-time-tracker-recorder","cl-new-layer",3,"entryInProgress","entryGroups","projectData","format","disableManualMode","setCustomFields"],["class","cl-tracker-entries-wrapper",3,"cl-entries-w-cf",4,"ngIf","ngIfElse"],["messageEntries",""],[1,"cl-tracker-entries-wrapper"],[3,"format","startOfWeek","isAdminOrOwner","projectData","weekStatus","customFields","timeApprovalEnabled","disableManualMode","entryGroup","loaded","deleteEntryGroup","subtractWeekDuration","addWeekDuration","onApprovalSubmit","onApprovalWithdraw",4,"ngFor","ngForOf","ngForTrackBy"],[3,"visible","page","limit","total","pageChanged","limitChanged"],["pager",""],[3,"format","startOfWeek","isAdminOrOwner","projectData","weekStatus","customFields","timeApprovalEnabled","disableManualMode","entryGroup","loaded","deleteEntryGroup","subtractWeekDuration","addWeekDuration","onApprovalSubmit","onApprovalWithdraw"],[1,"cl-no-entries-wrapper"],[3,"isError","loadInProgress","isTracker"],["trackerPageContent","",1,"cl-tracker-no-entries","cl-bg-white","cl-shadow"],[1,"cl-no-entries-image-wrapper","cl-mt-auto","cl-mb-0"],["src","/assets/images/empty-tracker-icon.svg",1,"no__entries--image"],[1,"cl-h1","cl-text-gray-3"],[1,"cl-mb-0","cl-text-gray-9","cl-py-2"],[1,"cl-w-100","cl-d-flex","cl-justify-content-center","cl-align-items-center","cl-mt-0"],["href","https://clockify.me/apps","target","_blank",1,"cl-px-2","cl-tracker-icon"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["clip-path","url(#clip0)"],["fill-rule","evenodd","clip-rule","evenodd","d","M21.069 7.5874C20.2774 7.5874 19.6365 8.21102 19.6365 8.98015V14.9421C19.6365 15.7112 20.2774 16.3348 21.069 16.3348C21.8591 16.3348 22.5 15.7112 22.5 14.9421V8.98015C22.5 8.21121 21.8591 7.5874 21.069 7.5874ZM2.9325 7.5874C2.14088 7.5874 1.5 8.21102 1.5 8.98015V14.9421C1.5 15.7112 2.14088 16.3348 2.9325 16.3348C3.72263 16.3348 4.3635 15.7112 4.3635 14.9421V8.98015C4.3635 8.21121 3.72263 7.5874 2.9325 7.5874ZM5.42194 7.5874H5.319V17.8067C5.319 18.618 5.99606 19.2786 6.83119 19.2786H7.9215C7.88381 19.4014 7.86356 19.5298 7.86356 19.6652V22.6075C7.86356 23.3766 8.50594 24.0002 9.29606 24.0002C10.0862 24.0002 10.7286 23.3766 10.7286 22.6075V19.665C10.7286 19.5296 10.7068 19.4012 10.6706 19.2784H13.3298C13.2936 19.4012 13.2731 19.5296 13.2731 19.665V22.6073C13.2731 23.3764 13.914 24 14.7041 24C15.4957 24 16.1381 23.3764 16.1381 22.6073V19.665C16.1381 19.5296 16.1164 19.4012 16.0787 19.2784H17.1705C18.0056 19.2784 18.6812 18.618 18.6812 17.8065V7.5874H5.42194ZM15.2869 2.00927L15.5537 1.61702L15.8205 1.2304L16.4149 0.361148C16.4887 0.253898 16.4584 0.109898 16.3481 0.0393983C16.2394 -0.0326017 16.0901 -0.00297666 16.0191 0.104273L15.1114 1.42652L14.8389 1.8244C13.9762 1.49852 13.0149 1.31646 12 1.31646C10.9866 1.31646 10.0238 1.49852 9.16106 1.8244L8.88994 1.42652L8.62162 1.03559L7.98375 0.104273C7.90988 -0.00297666 7.76194 -0.0311017 7.65169 0.0393983C7.54294 0.109898 7.51256 0.253898 7.58494 0.361148L8.17931 1.2304L8.44613 1.61702L8.71444 2.00927C6.68888 2.92784 5.31881 4.66784 5.31881 6.6589H18.6808C18.681 4.66784 17.3109 2.92802 15.2869 2.00927ZM9.1365 4.8004C8.74069 4.8004 8.42025 4.48859 8.42025 4.10327C8.42025 3.71796 8.74069 3.40765 9.1365 3.40765C9.53231 3.40765 9.85275 3.71815 9.85275 4.10327C9.85275 4.48859 9.53231 4.8004 9.1365 4.8004ZM14.8635 4.8004C14.4677 4.8004 14.1473 4.48859 14.1473 4.10327C14.1473 3.71796 14.4677 3.40765 14.8635 3.40765C15.2593 3.40765 15.5798 3.71815 15.5798 4.10327C15.5798 4.48859 15.2593 4.8004 14.8635 4.8004Z","fill","#999999"],["id","clip0"],["width","24","height","24","fill","white"],["width","19","height","24","viewBox","0 0 19 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M11.0348 3.55717C11.7932 2.60636 12.312 1.31273 12.168 0C11.0703 0.0487131 9.69766 0.761198 8.90721 1.69116C8.20783 2.51065 7.58303 3.8538 7.74443 5.11694C8.97748 5.20921 10.2435 4.49321 11.0348 3.55717Z","fill","#999999"],["d","M15.0426 13.6091C15.0175 10.8053 17.3325 9.44118 17.4383 9.37769C16.1272 7.46121 14.0951 7.19938 13.3809 7.17851C11.6742 6.99845 10.0186 8.20242 9.14912 8.20242C8.26238 8.20242 6.92348 7.19587 5.48047 7.22549C3.6236 7.25419 1.88648 8.33201 0.933733 10.0058C-1.03247 13.4186 0.433911 18.4338 2.31771 21.1923C3.26006 22.5433 4.36116 24.0518 5.80243 23.9987C7.21243 23.9405 7.73911 23.0975 9.44072 23.0975C11.1266 23.0975 11.6212 23.9987 13.0911 23.9648C14.6044 23.9405 15.5571 22.6077 16.4665 21.2445C17.5555 19.696 17.9928 18.171 18.0102 18.0928C17.9746 18.0806 15.0713 16.9696 15.0426 13.6091Z","fill","#999999"],["fill-rule","evenodd","clip-rule","evenodd","d","M12 24C18.6274 24 24 18.6274 24 12C24 10.6473 23.7762 9.34679 23.3635 8.13362C23.2519 8.17662 23.1307 8.2002 23.004 8.2002H16.3821C17.2655 9.21801 17.8002 10.5467 17.8002 12.0002C17.8002 13.143 17.4697 14.2087 16.899 15.1067L11.7703 23.9978C11.8467 23.9993 11.9233 24 12 24ZM15.335 13.8235C15.3177 13.8481 15.3013 13.8737 15.286 13.9002L15.1925 14.0624C14.5155 15.1082 13.3387 15.8002 12.0002 15.8002C10.625 15.8002 9.42039 15.0697 8.75331 13.9755C8.74126 13.9499 8.72803 13.9246 8.71359 13.8996L8.61805 13.7343C8.35094 13.2144 8.2002 12.6249 8.2002 12.0002C8.2002 9.90151 9.90151 8.2002 12.0002 8.2002C14.0989 8.2002 15.8002 9.90151 15.8002 12.0002C15.8002 12.6609 15.6316 13.2822 15.335 13.8235ZM11.9968 6.2002C9.45992 6.20167 7.30401 7.83181 6.51806 10.1016L3.20559 4.37159C3.14278 4.26294 3.06265 4.17053 2.97071 4.09583C5.17021 1.58528 8.39998 0 12 0C16.5238 0 20.463 2.50327 22.5079 6.2002H12.0002H12C11.9989 6.2002 11.9978 6.2002 11.9968 6.2002ZM6.85937 14.6883L1.72241 5.8021C0.62914 7.61112 0 9.73209 0 12C0 17.8295 4.15676 22.6881 9.66796 23.7735C9.68642 23.6552 9.7266 23.5382 9.79003 23.4282L13.0961 17.6968C12.7412 17.7647 12.3748 17.8002 12.0002 17.8002C9.76701 17.8002 7.82861 16.5381 6.85937 14.6883Z","fill","#999999"],["d","M0 3.38236L9.73282 2.05685L9.73707 11.4449L0.00889091 11.5003L0 3.38236ZM9.72818 12.5266L9.73574 21.9229L0.00755455 20.5854L0.00700909 12.4636L9.72818 12.5266ZM10.908 1.88345L23.8129 0V11.3255L10.908 11.428V1.88345ZM23.8159 12.615L23.8129 23.8895L10.908 22.0682L10.8899 12.5939L23.8159 12.615Z","fill","#999999"],["href","http://clockify.me/integrations","target","_blank",1,"cl-text-blue-gray-5","cl-py-2","cl-mb-auto"],["class","cl-py-2 cl-border-top cl-w-100 cl-text-blue",3,"click",4,"ngIf"],[1,"cl-py-2","cl-border-top","cl-w-100","cl-text-blue",3,"click"],[1,"cl-toast-wrapper"],[1,"cl-toast"],[1,"cl-toast-body"],["type","button",1,"cl-ml-3","cl-close",3,"click"],["class","cl-d-flex cl-align-items-start",4,"ngIf"],[1,"cl-d-flex","cl-align-items-start"],["src","assets/images/ui-icons/checkmark-green-circle.svg",1,"cl-mr-2"],[1,"cl-h3","cl-mb-0"],[1,"cl-text-gray-9","cl-small"],["routerLink","/timesheet",1,"cl-color-blue"],["src","assets/images/nav-icons/timesheet.svg",1,"cl-mr-2"],[1,"cl-small","cl-color-blue",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xc(1,bI,6,10,"div",1),s.Wb(),s.Xc(2,pI,8,2,"div",2)),2&e&&(s.Cb(1),s.wc("ngIf",t.workspace),s.Cb(1),s.wc("ngIf",t.onboardingTimesheet))},directives:[i.u,rv,i.t,Pi.a,cI,li.a,k.g],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var mI=function(e){return e.USERS="USERS",e.MANAGERS="MANAGERS",e.ADMINS="ADMINS",e}({});class gI{constructor(e){this._id=e&&e.id||null,this._workspaceId=e&&e.workspaceId||null,this._users=e&&e.users||[],this._less=e&&e.less,this._hours=e&&e.hours||8,this._dateRange=e&&e.dateRange||"week",this._days=e&&e.days||[],this._receivers=e&&e.receivers||[mI.USERS],this._userAndGroupNames=e&&e.userAndGroupNames}get id(){return this._id}set id(e){this._id=e}get workspaceId(){return this._workspaceId}set workspaceId(e){this._workspaceId=e}get users(){return this._users}set users(e){this._users=e}get less(){return this._less}set less(e){this._less=e}get hours(){return this._hours}set hours(e){this._hours=e}get dateRange(){return this._dateRange}set dateRange(e){this._dateRange=e}get days(){return this._days}set days(e){this._days=e}get receivers(){return this._receivers}set receivers(e){this._receivers=e}get userAndGroupNames(){return this._userAndGroupNames}set userAndGroupNames(e){this._userAndGroupNames=e}get containsFilter(){return this._containsFilter}set containsFilter(e){this._containsFilter=e}}var EI=n("83av"),fI=n("9WzS");let SI=(()=>{class e{constructor(e,t,n,i){this.http=e,this.workspaceService=t,this.toaster=n,this.translateService=i,this.error=new p.a,this.reminders=new p.a,this.reminderUpdated=new p.a}createReminder(e,t,n){const i={users:{ids:n.ids,contains:n.contains,status:n.status},less:e.less,hours:Number(e.hours),dateRange:e.dateRange,days:e.days,receivers:e.receivers};return this.http.post(`/workspaces/${t}/reminders/`,i).pipe(Object(d.a)(e=>new gI(e)),Object(u.a)(()=>{this.toaster.pop("success",this.translateService.instant("SERVICES.REMINDER.CREATE.SUCCESS_MESSAGE"))},e=>{this.error.next(e),this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("SERVICES.REMINDER.CREATE.ERROR_MESSAGE"))}))}getReminders(e){return this.http.get(`/workspaces/${e}/reminders/`).pipe(Object(d.a)(e=>e.map(e=>new gI(e))),Object(u.a)(e=>{this.reminders.next(e)},e=>{this.error.next(e),this.toaster.pop("error",e.error&&e.error.message||this.translateService.instant("SERVICES.REMINDER.GET.ERROR_MESSAGE"))}))}getTargets(){const e=this.workspaceService.getDefaultWorkspaceId(),t=(new m.h).append("hydrated","true");return this.http.get(`/workspaces/${e}/reminders/targets`,{params:t}).pipe(Object(d.a)(e=>e.map(e=>new gI(e))))}updateReminder(e,t){var n,i,s;const c={id:e.id,users:{ids:(null===(n=e.containsFilter)||void 0===n?void 0:n.ids)||e.users,contains:(null===(i=e.containsFilter)||void 0===i?void 0:i.contains)||EI.a.CONTAINS,status:(null===(s=e.containsFilter)||void 0===s?void 0:s.status)||fI.a.ALL},less:e.less,hours:e.hours,dateRange:e.dateRange,days:e.days,receivers:e.receivers};this.http.put(`/workspaces/${t}/reminders/${e.id}`,c).subscribe(e=>{this.reminderUpdated.next(new gI(e)),this.toaster.pop("success",this.translateService.instant("SERVICES.REMINDER.UPDATE.SUCCESS_MESSAGE"))},e=>{var t;this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translateService.instant("SERVICES.REMINDER.UPDATE.ERROR_MESSAGE")),this.error.next(e)})}deleteReminder(e,t){return this.http.delete(`/workspaces/${t}/reminders/${e}`).pipe(Object(u.a)(()=>{this.toaster.pop("success",this.translateService.instant("SERVICES.REMINDER.DELETE.SUCCESS_MESSAGE"))},e=>{this.error.next(e),this.toaster.pop("error",this.translateService.instant("SERVICES.REMINDER.DELETE.ERROR_MESSAGE"))}))}toastForEmptyTeam(e){this.toaster.pop("error",this.translateService.instant(e?"SERVICES.REMINDER.CREATE.ERROR_MESSAGE":"SERVICES.REMINDER.UPDATE.ERROR_MESSAGE"),this.translateService.instant(e?"SERVICES.REMINDER.CREATE.NO_TEAM_MEMBERS_ERROR_MESSAGE":"SERVICES.REMINDER.UPDATE.NO_TEAM_MEMBERS_ERROR_MESSAGE"))}toastForEmptyHours(e){this.toaster.pop("error",this.translateService.instant(e?"SERVICES.REMINDER.CREATE.ERROR_MESSAGE":"SERVICES.REMINDER.UPDATE.ERROR_MESSAGE"),this.translateService.instant(e?"SERVICES.REMINDER.CREATE.NO_HOURS_ERROR_MESSAGE":"SERVICES.REMINDER.UPDATE.NO_HOURS_ERROR_MESSAGE"))}toastForEmptyDays(e){this.toaster.pop("error",this.translateService.instant(e?"SERVICES.REMINDER.CREATE.ERROR_MESSAGE":"SERVICES.REMINDER.UPDATE.ERROR_MESSAGE"),this.translateService.instant(e?"SERVICES.REMINDER.CREATE.NO_DAYS_ERROR_MESSAGE":"SERVICES.REMINDER.UPDATE.NO_DAYS_ERROR_MESSAGE"))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(m.c),s.fc(l.a),s.fc(r.a),s.fc(g.f))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})(),CI=(()=>{class e{constructor(e){this._sendNewsletter=e&&e.sendNewsletter,this._weeklyUpdates=e&&e.weeklyUpdates,this._status=e&&e.status,this._longRunning=e&&e.longRunning,this._timeZone=e&&e.timeZone,this._dateFormat=e&&e.dateFormat,this._timeFormat=e&&e.timeFormat,this._weekStart=e&&e.weekStart,this._timeTrackingManual=e&&e.timeTrackingManual,this._summaryReportSettings=e&&e.summaryReportSettings,this._isCompactViewOn=e&&e.isCompactViewOn,this._dashboardSelection=e&&e.dashboardSelection,this._dashboardDateRange=e&&e.dashboardDateRange,this._dashboardViewType=e&&e.dashboardViewType?e.dashboardViewType:yc.a.BILLABILITY,this._dashboardPinToTop=e&&e.dashboardPinToTop,this._projectListCollapse=e&&e.projectListCollapse,this._collapseAllProjectLists=e&&e.collapseAllProjectLists,this._groupSimilarEntriesDisabled=e&&e.groupSimilarEntriesDisabled,this._myStartOfDay=e&&e.myStartOfDay,this._darkTheme=e&&e.darkTheme,this._projectPickerSpecialFilter=e&&e.projectPickerSpecialFilter,this._lang=e&&e.lang,this._alerts=e&&e.alerts,this._approval=e&&e.approval,this._scheduledReports=e&&e.scheduledReports,this._pto=e&&e.pto,this._reminders=e&&e.reminders}get sendNewsletter(){return this._sendNewsletter}get status(){return this._status}get weeklyUpdates(){return this._weeklyUpdates}get longRunning(){return this._longRunning}get alerts(){return this._alerts}get approval(){return this._approval}get scheduledReports(){return this._scheduledReports}get pto(){return this._pto}get reminders(){return this._reminders}get timeZone(){return this._timeZone}get dateFormat(){return this._dateFormat}get timeFormat(){return this._timeFormat}get weekStart(){return this._weekStart}get timeTrackingManual(){return this._timeTrackingManual}get summaryReportSettings(){return this._summaryReportSettings}set sendNewsletter(e){this._sendNewsletter=e}set weeklyUpdates(e){this._weeklyUpdates=e}set pto(e){this._pto=e}set reminders(e){this._reminders=e}set status(e){this._status=e}set longRunning(e){this._longRunning=e}set timeZone(e){this._timeZone=e}set alerts(e){this._alerts=e}set approval(e){this._approval=e}set scheduledReports(e){this._scheduledReports=e}set dateFormat(e){this._dateFormat=e}set timeFormat(e){this._timeFormat=e}set weekStart(e){this._weekStart=e}set timeTrackingManual(e){this._timeTrackingManual=e}set summaryReportSettings(e){this._summaryReportSettings=e}get isCompactViewOn(){return this._isCompactViewOn}set isCompactViewOn(e){this._isCompactViewOn=e}get dashboardSelection(){return this._dashboardSelection}set dashboardSelection(e){this._dashboardSelection=e}get dashboardDateRange(){return this._dashboardDateRange}set dashboardDateRange(e){this._dashboardDateRange=e}get dashboardViewType(){return this._dashboardViewType}set dashboardViewType(e){this._dashboardViewType=e}get dashboardPinToTop(){return this._dashboardPinToTop}set dashboardPinToTop(e){this._dashboardPinToTop=e}get projectListCollapse(){return this._projectListCollapse}get collapseAllProjectLists(){return this._collapseAllProjectLists}set collapseAllProjectLists(e){this._collapseAllProjectLists=e}set projectListCollapse(e){this._projectListCollapse=e}get groupSimilarEntriesDisabled(){return this._groupSimilarEntriesDisabled}set groupSimilarEntriesDisabled(e){this._groupSimilarEntriesDisabled=e}get myStartOfDay(){return this._myStartOfDay}set myStartOfDay(e){this._myStartOfDay=e}get darkTheme(){return this._darkTheme}set darkTheme(e){this._darkTheme=e}get projectPickerSpecialFilter(){return this._projectPickerSpecialFilter}set projectPickerSpecialFilter(e){this._projectPickerSpecialFilter=e}get lang(){return this._lang}set lang(e){this._lang=e}}return e.defaultMyStartOfDay="09:00",e})();function AI(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",10),s.jc("keyup.enter",(function(){s.Oc(e);const n=t.$implicit;return s.nc(2).valueChange(n)}))("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc(2).valueChange(n)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc(2);s.Hb("cl-active",n.selected===e),s.Cb(1),s.bd(" ",s.pc(2,3,n.options[e])," ")}}function OI(e,t){if(1&e&&(s.Xb(0,"div",6),s.Xb(1,"div",7),s.Xc(2,AI,3,5,"a",8),s.Sb(3,"span",9),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.wc("ngForOf",e.objectKeys(e.options))}}const vI=function(e){return{limit:e}};function TI(e,t){if(1&e&&(s.Xb(0,"div"),s.Xb(1,"small",17),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.bd(" ",s.qc(3,1,"USER_PROFILE.COMPACT_PROJECT.COLLAPSED_PROJECT_MSG",s.Bc(4,vI,e.limit))," ")}}function II(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",11),s.Xb(1,"div",12),s.Xb(2,"div",13),s.Xb(3,"input",14,15),s.jc("change",(function(){return s.Oc(e),s.nc().numberChanged()}))("keyup.enter",(function(){return s.Oc(e),s.Lc(4).blur()}))("ngModelChange",(function(t){return s.Oc(e),s.nc().settings.projectListCollapse=t})),s.Wb(),s.Wb(),s.Xc(5,TI,4,6,"div",16),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.wc("ngModel",e.settings.projectListCollapse),s.Cb(2),s.wc("ngIf",e.showWarning&&e.settings.projectListCollapse>=50)}}var wI=function(e){return e.ALL="ALL",e.DONT="DONT",e.NUMBER="NUMBER",e}({});let LI=(()=>{class e{constructor(){this.limit=50,this.defaultValue=40,this.objectKeys=Object.keys,this.options={ALL:"USER_PROFILE.COMPACT_PROJECT.OPTIONS.COLLAPSE_ALL_LABEL",DONT:"USER_PROFILE.COMPACT_PROJECT.OPTIONS.DONT_COLLAPSE_LABEL",NUMBER:"USER_PROFILE.COMPACT_PROJECT.OPTIONS.COLLAPSE_IF_TOO_MANY_LABEL"},this.onChange=new s.n,this.unsubscribe$=new p.a}ngOnInit(){this.fromSettingsToDropdownValues()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}fromSettingsToDropdownValues(){this.numberOfProjectsBackup=this.settings.projectListCollapse||this.defaultValue,this.selected=this.settings.projectListCollapse&&this.settings.collapseAllProjectLists?wI.ALL:null!==this.settings.projectListCollapse?wI.NUMBER:wI.DONT}valueChange(e){if(e!==this.selected)return this.selected=e,e===wI.DONT?(this.settings.collapseAllProjectLists=!1,this.numberOfProjectsBackup=this.settings.projectListCollapse||this.numberOfProjectsBackup,this.settings.projectListCollapse=null,void this.emitChanges()):e===wI.ALL?(this.settings.collapseAllProjectLists=!0,this.settings.projectListCollapse=this.numberOfProjectsBackup,void this.emitChanges()):e===wI.NUMBER?(this.showWarning=!1,this.settings.collapseAllProjectLists=!1,this.numberOfProjectsBackup>this.limit&&(this.numberOfProjectsBackup=this.defaultValue),this.settings.projectListCollapse=this.numberOfProjectsBackup,void this.emitChanges()):void 0}numberChanged(){this.settings.projectListCollapse>this.limit&&(this.settings.projectListCollapse=this.limit,this.showWarning=!0),this.settings.projectListCollapse<1&&(this.settings.projectListCollapse=1),this.emitChanges()}emitChanges(){this.onChange.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["compact-project"]],inputs:{settings:"settings"},outputs:{onChange:"onChange"},decls:8,vars:4,consts:[[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-6"],["dropdownKey","",1,"cl-dropdown"],["tabindex","0","dropdownKeyButton","",1,"cl-btn","cl-btn-outline-light","cl-w-100","cl-text-left","cl-dropdown-toggle","cl-cut-text","cl-pr-3"],["class","cl-dropdown-menu","openUpAtBottom","",4,"dropdownKeyContent"],["class","cl-col-md-6",4,"ngIf"],["openUpAtBottom","",1,"cl-dropdown-menu"],[1,"cl-scroll-area"],["clickCloseDropdown","","tabindex","0","class","cl-dropdown-item",3,"cl-active","keyup.enter","click",4,"ngFor","ngForOf"],["dropdownClose","","tabindex","0"],["clickCloseDropdown","","tabindex","0",1,"cl-dropdown-item",3,"keyup.enter","click"],[1,"cl-col-md-6"],[1,"cl-form-group"],[1,"cl-input-group"],["type","number","name","projectListCollapse2","tabindex","0",1,"cl-form-control",3,"ngModel","change","keyup.enter","ngModelChange"],["compactProjectInput",""],[4,"ngIf"],[1,"cl-form-text","cl-text-gray-9"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"a",3),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,OI,4,1,"div",4),s.Wb(),s.Wb(),s.Xc(7,II,6,2,"div",5),s.Wb()),2&e&&(s.Cb(4),s.bd(" ",s.pc(5,2,t.options[t.selected])," "),s.Cb(3),s.wc("ngIf","NUMBER"===t.selected))},directives:[ni.a,ii.a,si.a,i.u,i.t,v.y,v.c,v.s,v.v],pipes:[g.e],encapsulation:2}),e})(),RI=(()=>{class e{constructor(e,t,n){this.timeInputConverterService=e,this.timeZoneConverterService=t,this.userService=n,this._hours=CI.defaultMyStartOfDay,this.onTimeChanged=new s.n,this.format="HH:mm"}set hours(e){e&&(this._hours=e,this.backup=e,this.isInitialized&&this.initDate())}get hours(){return this._hours}set timeFormat(e){e&&(this.format=e===Lg.a.HOUR12?"hh:mmA":"HH:mm",this.isInitialized&&this.initDate())}ngOnInit(){this.initDate(),this.isInitialized=!0}timeChanged(){let e=this.hoursModel.trim();if(!e)return void(this.hours=this.backup);if(e=this.timeInputConverterService.parseInput(e.replace(/ /g,"")),!e)return void(this.hours=this.backup);e.indexOf(":")<0&&(e=e.substring(0,2).concat(":").concat(e.substring(2,4)));const t=ke(),n=Number(e.split(":")[0]),i=Number(e.split(":")[1]);t.hours(n),t.minutes(i);const s=this.emitFormat||this.format,c=ke(t).format(s).toString();c!==this.backup?this.emit(c):this.hours=this.backup}initDate(){this.hoursModel=Object(ke.utc)(this.hours,"HH:mm").format(this.format)}emit(e){this.hours=e,this.onTimeChanged.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(pe.a),s.Rb(Ic.a),s.Rb(Lc.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["input-hours"]],inputs:{hours:"hours",timeFormat:"timeFormat",emitFormat:"emitFormat"},outputs:{onTimeChanged:"onTimeChanged"},decls:2,vars:1,consts:[["spellcheck","false","autocomplete","off","type","text","tabindex","0",1,"cl-form-control","cl-input-time-picker",3,"ngModel","ngModelChange","blur","keyup.enter"],["inputField",""]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"input",0,1),s.jc("ngModelChange",(function(e){return t.hoursModel=e}))("blur",(function(){return t.timeChanged()}))("keyup.enter",(function(){return s.Oc(e),s.Lc(1).blur()})),s.Wb()}2&e&&s.wc("ngModel",t.hoursModel)},directives:[v.c,v.s,v.v],encapsulation:2,changeDetection:0}),e})();const yI=function(e){return{value:e}};function _I(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.qc(2,1,"USER_PROFILE.SETTINGS.PASSWORD.CHANGE.ERROR_MESSAGE.MIN",s.Bc(4,yI,e.minLength))," ")}}function kI(e,t){if(1&e&&(s.Xb(0,"div",10),s.Xc(1,_I,3,6,"span",11),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.oldPassword.errors.required||e.oldPassword.errors.minlength)}}function WI(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.qc(2,1,"USER_PROFILE.SETTINGS.PASSWORD.CHANGE.ERROR_MESSAGE.MIN",s.Bc(4,yI,e.minLength))," ")}}function XI(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.qc(2,1,"USER_PROFILE.SETTINGS.PASSWORD.CHANGE.ERROR_MESSAGE.MAX",s.Bc(4,yI,e.maxLength))," ")}}function NI(e,t){if(1&e&&(s.Xb(0,"div",10),s.Xc(1,WI,3,6,"span",11),s.Xc(2,XI,3,6,"span",11),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.newPassword.errors.required||e.newPassword.errors.minlength),s.Cb(1),s.wc("ngIf",e.newPassword.errors.maxlength)}}function DI(e,t){1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.PASSWORD_MATCH_ERROR_MSG")," "))}function PI(e,t){if(1&e&&(s.Xb(0,"div",10),s.Xc(1,DI,3,3,"span",11),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.newPasswordRepeated.errors.matchInputs)}}let MI=(()=>{class e{constructor(e,t,n){this.formBuilder=e,this.authService=t,this.analyticsService=n,this.unsubscribe$=new p.a,this.onClose=new s.n}ngOnInit(){this.minLength=In.s,this.maxLength=In.r,this.changePasswordForm=this.formBuilder.group({oldPassword:["",[v.G.required,v.G.minLength(this.minLength)]],newPassword:["",[v.G.required,v.G.minLength(this.minLength),v.G.maxLength(this.maxLength)]],newPasswordRepeated:["",[]]},{validator:Object(sn.B)("newPassword","newPasswordRepeated")})}get oldPassword(){return this.changePasswordForm.get("oldPassword")}get newPassword(){return this.changePasswordForm.get("newPassword")}get newPasswordRepeated(){return this.changePasswordForm.get("newPasswordRepeated")}get isOldPasswordInvalid(){return this.oldPassword.dirty&&this.oldPassword.touched&&!!this.oldPassword.errors}get isNewPasswordInvalid(){return this.newPassword.dirty&&this.newPassword.touched&&!!this.newPassword.errors}get isNewPasswordRepeatedInvalid(){return this.newPasswordRepeated.dirty&&this.newPasswordRepeated.touched&&!!this.newPasswordRepeated.errors}onSubmit(){this.changePasswordForm.invalid||(this.inProgress=!0,this.authService.changePassword(this.oldPassword.value,this.newPassword.value,this.newPasswordRepeated.value).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.analyticsService.addEvent(new Fi.a({event:"change",section:"Profile settings",section2:"Personal info",section3:"Change password"})),this.closeModal()},()=>this.inProgress=!1))}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}closeModal(){this.onClose.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(v.f),s.Rb(re.a),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["change-password"]],outputs:{onClose:"onClose"},decls:27,vars:26,consts:[["novalidate","",3,"formGroup","ngSubmit"],[1,"cl-modal-body"],[1,"cl-form-group"],["formControlName","oldPassword","type","password","ngbAutofocus","","autofill","off","autocomplete","current-password",1,"cl-form-control"],["class","cl-invalid-feedback",4,"ngIf"],["type","password","autocomplete","current-password","autofill","off","formControlName","newPassword","autocomplete","new-password",1,"cl-form-control"],["type","password","autocomplete","new-password","autofill","off","formControlName","newPasswordRepeated",1,"cl-form-control"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"click","keyup.enter"],["type","submit","tabindex","0",1,"cl-btn","cl-btn-primary",3,"disabled"],[1,"cl-invalid-feedback"],[4,"ngIf"]],template:function(e,t){1&e&&(s.Xb(0,"form",0),s.jc("ngSubmit",(function(){return t.onSubmit()})),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"label"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Sb(6,"input",3),s.Xc(7,kI,2,1,"div",4),s.Wb(),s.Xb(8,"div",2),s.Xb(9,"label"),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Sb(12,"input",5),s.Xc(13,NI,3,2,"div",4),s.Wb(),s.Xb(14,"div",2),s.Xb(15,"label"),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Sb(18,"input",6),s.Xc(19,PI,2,1,"div",4),s.Wb(),s.Wb(),s.Xb(20,"div",7),s.Xb(21,"a",8),s.jc("click",(function(){return t.closeModal()}))("keyup.enter",(function(){return t.closeModal()})),s.Zc(22),s.oc(23,"translate"),s.Wb(),s.Xb(24,"button",9),s.Zc(25),s.oc(26,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.wc("formGroup",t.changePasswordForm),s.Cb(4),s.ad(s.pc(5,16,"USER_PROFILE.SETTINGS.PASSWORD.CHANGE.OLD")),s.Cb(2),s.Hb("cl-is-invalid",t.isOldPasswordInvalid),s.Cb(1),s.wc("ngIf",t.isOldPasswordInvalid),s.Cb(3),s.ad(s.pc(11,18,"USER_PROFILE.SETTINGS.PASSWORD.CHANGE.NEW")),s.Cb(2),s.Hb("cl-is-invalid",t.isNewPasswordInvalid),s.Cb(1),s.wc("ngIf",t.isNewPasswordInvalid),s.Cb(3),s.ad(s.pc(17,20,"GLOBAL.RETYPE_PASSWORD_PLACEHOLDER")),s.Cb(2),s.Hb("cl-is-invalid",t.isNewPasswordRepeatedInvalid),s.Cb(1),s.wc("ngIf",t.isNewPasswordRepeatedInvalid),s.Cb(3),s.ad(s.pc(23,22,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",t.inProgress||t.changePasswordForm.invalid),s.Cb(1),s.ad(s.pc(26,24,"GLOBAL.SAVE_LABEL")))},directives:[v.I,v.t,v.k,v.c,v.s,v.i,i.u],pipes:[g.e],encapsulation:2}),e})();function BI(e,t){1&e&&(s.Xb(0,"div",9),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"USER_PROFILE.SETTINGS.EMAIL.CHANGE.ERROR_MESSAGE.VALID")," "))}function UI(e,t){1&e&&(s.Xb(0,"div",9),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"USER_PROFILE.SETTINGS.EMAIL.CHANGE.ERROR_MESSAGE.MATCH")," "))}let GI=(()=>{class e{constructor(e,t,n,i,c){this.formBuilder=e,this.authService=t,this.toaster=n,this.translateService=i,this.analyticsService=c,this.unsubscribe$=new p.a,this.onClose=new s.n,this.onEmailSet=new s.n}ngOnInit(){this.oldEmail=this.authService.getUser().email,this.changePasswordForm=this.formBuilder.group({newEmail:["",[v.G.required,v.G.email]],retypedNewEmail:["",[]]},{validator:Object(sn.B)("newEmail","retypedNewEmail")})}get newEmail(){return this.changePasswordForm.get("newEmail")}get retypedNewEmail(){return this.changePasswordForm.get("retypedNewEmail")}get isNewEmailInvalid(){return this.newEmail.dirty&&this.newEmail.touched&&!!this.newEmail.errors}get isRetypedNewEmailInvalid(){return this.retypedNewEmail.dirty&&this.retypedNewEmail.touched&&!!this.retypedNewEmail.errors}onSubmit(){if(!this.changePasswordForm.invalid){if(this.doNotSubmit)return this.onEmailSet.emit(this.newEmail.value.toLowerCase()),void this.closeModal();if(this.oldEmail.toLowerCase()===this.newEmail.value.toLowerCase())return this.toaster.pop("success",this.translateService.instant("USER_PROFILE.CHANGE_EMAIL.EMAIL_SAVED")),void this.closeModal();this.inProgress=!0,this.authService.changeEmail(this.newEmail.value.toLowerCase(),this.userId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.analyticsService.addEvent(new Fi.a({event:"change",section:"Profile settings",section2:"Personal info",section3:"Change email"})),this.closeModal()},e=>this.inProgress=!1)}}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}closeModal(){this.onClose.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(v.f),s.Rb(re.a),s.Rb(a.d),s.Rb(g.f),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["change-email"]],inputs:{userId:"userId",doNotSubmit:"doNotSubmit"},outputs:{onClose:"onClose",onEmailSet:"onEmailSet"},decls:21,vars:20,consts:[["novalidate","",3,"formGroup","ngSubmit"],[1,"cl-modal-body"],[1,"cl-form-group"],["formControlName","newEmail","type","email","ngbAutofocus","","autocomplete","off",1,"cl-form-control"],["class","cl-invalid-feedback",4,"ngIf"],["type","email","autocomplete","off","formControlName","retypedNewEmail",1,"cl-form-control"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"keyup.enter","click"],["type","submit","tabindex","0",1,"cl-btn","cl-btn-primary",3,"disabled"],[1,"cl-invalid-feedback"]],template:function(e,t){1&e&&(s.Xb(0,"form",0),s.jc("ngSubmit",(function(){return t.onSubmit()})),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"label"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Sb(6,"input",3),s.Xc(7,BI,3,3,"div",4),s.Wb(),s.Xb(8,"div",2),s.Xb(9,"label"),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Sb(12,"input",5),s.Xc(13,UI,3,3,"div",4),s.Wb(),s.Wb(),s.Xb(14,"div",6),s.Xb(15,"a",7),s.jc("keyup.enter",(function(){return t.closeModal()}))("click",(function(){return t.closeModal()})),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Xb(18,"button",8),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.wc("formGroup",t.changePasswordForm),s.Cb(4),s.ad(s.pc(5,12,"USER_PROFILE.SETTINGS.EMAIL.CHANGE.ENTER_NEW")),s.Cb(2),s.Hb("cl-is-invalid",t.isNewEmailInvalid),s.Cb(1),s.wc("ngIf",t.isNewEmailInvalid),s.Cb(3),s.ad(s.pc(11,14,"USER_PROFILE.SETTINGS.EMAIL.CHANGE.RETYPE")),s.Cb(2),s.Hb("cl-is-invalid",t.isRetypedNewEmailInvalid),s.Cb(1),s.wc("ngIf",t.isRetypedNewEmailInvalid),s.Cb(3),s.ad(s.pc(17,16,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",t.inProgress||t.changePasswordForm.invalid),s.Cb(1),s.ad(s.pc(20,18,"GLOBAL.SAVE_LABEL")))},directives:[v.I,v.t,v.k,v.c,v.s,v.i,i.u],pipes:[g.e],encapsulation:2}),e})(),xI=(()=>{class e{constructor(e){this.apiKeyService=e,this.unsubscribe$=new p.a,this.onClose=new s.n}ngOnInit(){}confirmGenerateApiKey(){this.apiKeyService.generateApiKey(),this.closeModal()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}closeModal(){this.onClose.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(le))},e.\u0275cmp=s.Lb({type:e,selectors:[["generate-api"]],outputs:{onClose:"onClose"},decls:18,vars:13,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-mb-0"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"disabled","keyup.enter","click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.closeModal()})),s.Xb(5,"span",3),s.Sb(6,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",5),s.Xb(8,"p",6),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Xb(11,"div",7),s.Xb(12,"a",8),s.jc("click",(function(){return t.closeModal()})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Xb(15,"button",9),s.jc("keyup.enter",(function(){return t.confirmGenerateApiKey()}))("click",(function(){return t.confirmGenerateApiKey()})),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,5,"USER_PROFILE.SETTINGS.GENERATE_API.TITLE")),s.Cb(7),s.bd(" ",s.pc(10,7,"USER_PROFILE.SETTINGS.GENERATE_API.INFO_MESSAGE")," "),s.Cb(4),s.ad(s.pc(14,9,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",t.inProgress),s.Cb(1),s.ad(s.pc(17,11,"USER_PROFILE.SETTINGS.GENERATE_API.BUTTON")))},pipes:[g.e],encapsulation:2}),e})();const FI=["fileInput"],jI=["dropdownItems"],ZI=["dropdownTimeZone"];function VI(e,t){1&e&&(s.Xb(0,"modal-header",67),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"change-password",68),s.jc("onClose",(function(){return t.$implicit.close()})),s.Wb()),2&e&&s.wc("title",s.pc(1,1,"USER_PROFILE.SETTINGS.PASSWORD.CHANGE.TITLE"))}function YI(e,t){if(1&e){const e=s.Yb();s.Xb(0,"modal-header",67),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"set-password",69),s.jc("onClose",(function(){return t.$implicit.close()}))("onSetPassword",(function(){s.Oc(e);const n=t.$implicit;return s.nc().onSetPassword(),n.close()})),s.Wb()}2&e&&s.wc("title",s.pc(1,1,"GLOBAL.SET_TITLE"))}function HI(e,t){if(1&e&&(s.Xb(0,"modal-header",67),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"change-email",70),s.jc("onClose",(function(){return t.$implicit.close()})),s.Wb()),2&e){const e=s.nc();s.wc("title",s.pc(1,2,"USER_PROFILE.SETTINGS.EMAIL.CHANGE.TITLE")),s.Cb(2),s.wc("userId",null==e.user?null:e.user.id)}}function $I(e,t){1&e&&(s.Xb(0,"generate-api",68),s.jc("onClose",(function(){return t.$implicit.close()})),s.Wb())}function KI(e,t){if(1&e&&(s.Xb(0,"li"),s.Zc(1),s.oc(2,"momentFormat"),s.oc(3,"momentFormat"),s.Wb()),2&e){const e=t.$implicit,n=s.nc(3);s.Cb(1),s.cd(" ",s.qc(2,2,e.start,n.user.settings.dateFormat)," - ",s.qc(3,5,e.end,n.user.settings.dateFormat)," ")}}function qI(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"div",74),s.Zc(2),s.Wb(),s.Xb(3,"ul",75),s.Xc(4,KI,4,8,"li",73),s.Wb(),s.Ub()),2&e){const e=t.$implicit;s.Cb(2),s.ad(e.name),s.Cb(2),s.wc("ngForOf",e.ranges)}}function zI(e,t){if(1&e){const e=s.Yb();s.Xb(0,"delete-confirm-modal",71),s.jc("onDelete",(function(){s.Oc(e);const n=t.$implicit;return s.nc().confirmWithdrawnAll(n)}))("onClose",(function(){s.Oc(e);const n=t.$implicit;return s.nc().cancelWithdrawnAllApprovals(),n.close(!1)})),s.oc(1,"translate"),s.oc(2,"translate"),s.oc(3,"translate"),s.Xb(4,"p",72),s.Zc(5),s.oc(6,"translate"),s.oc(7,"translate"),s.Wb(),s.Xc(8,qI,5,2,"ng-container",73),s.Wb()}if(2&e){const e=s.nc();s.wc("title","timeZone"===e.approvalInProgressProp?s.pc(1,7,"USER_PROFILE.SETTINGS.TIME_SETTINGS.CHANGE.ZONE"):s.pc(2,9,"USER_PROFILE.SETTINGS.TIME_SETTINGS.CHANGE.WEEK"))("btnText",s.pc(3,11,"USER_PROFILE.UNSUBMIT"))("showConfirmation",!0)("confirmationText","unsubmit")("inProgress",e.inProgress),s.Cb(5),s.bd(" ","timeZone"===e.approvalInProgressProp?s.pc(6,13,"USER_PROFILE.SETTINGS.TIME_SETTINGS.ZONE.INFO_MESSAGE"):s.pc(7,15,"USER_PROFILE.SETTINGS.TIME_SETTINGS.WEEK.INFO_MESSAGE")," "),s.Cb(3),s.wc("ngForOf",e.pendingApprovals)}}function QI(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",76),s.jc("keyup.enter",(function(){return s.Oc(e),s.nc().removeImage()}))("click",(function(){return s.Oc(e),s.nc().removeImage()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.REMOVE_IMAGE_LABEL")))}function JI(e,t){1&e&&(s.Xb(0,"span",79),s.Xb(1,"a",80),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,1,"GLOBAL.CHANGE_LABEL")))}function ew(e,t){if(1&e){const e=s.Yb();s.Xb(0,"span",64),s.Xb(1,"a",81,82),s.jc("click",(function(){s.Oc(e);const t=s.Lc(2),n=s.nc(2),i=s.Lc(5);return t.blur(),n.openModal(i)}))("keyup.enter",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(5);return t.openModal(n)})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()}2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"GLOBAL.CHANGE_LABEL")," "))}function tw(e,t){if(1&e&&(s.Xb(0,"div",63),s.Xc(1,JI,4,3,"span",77),s.Xc(2,ew,5,3,"span",78),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",!e.canChangePassword),s.Cb(1),s.wc("ngIf",e.canChangePassword)}}function nw(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",87),s.jc("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(1);return t.canChangeReceived&&t.openModal(n)}))("keyup.enter",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(1);return t.openModal(n)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"USER_PROFILE.SETTINGS.PASSWORD.CHANGE.TITLE")," "))}function iw(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",88),s.jc("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(3);return t.canChangeReceived&&t.openModal(n)}))("keyup.enter",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(3);return t.openModal(n)})),s.Zc(1),s.oc(2,"translate"),s.Wb(),s.Xb(3,"small",89),s.Zc(4),s.oc(5,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,2,"GLOBAL.SET_TITLE"),""),s.Cb(3),s.bd(" ",s.pc(5,4,"USER_PROFILE.SETTINGS.PASSWORD.INFO_MESSAGE")," "))}function sw(e,t){if(1&e&&(s.Xb(0,"div",13),s.Xb(1,"div",83),s.Xb(2,"label"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"div",13),s.Xb(6,"div",84),s.Xc(7,nw,3,3,"a",85),s.Xc(8,iw,6,6,"ng-template",null,86,s.Yc),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.Lc(9),t=s.nc();s.Cb(3),s.ad(s.pc(4,3,"GLOBAL.PASSWORD_LABEL")),s.Cb(4),s.wc("ngIf",t.canChangePassword)("ngIfElse",e)}}function cw(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",null==e.activeLanguage?null:e.activeLanguage.label," ")}}function aw(e,t){1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"USER_PROFILE.SETTINGS.LANGUAGE.LANGUAGE_PICKER_PLACEHOLDER")))}function ow(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",94),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc(2).onLanguageChange(n.code)})),s.Zc(1),s.Wb()}if(2&e){const e=t.$implicit;s.Cb(1),s.bd(" ",e.label," ")}}function rw(e,t){if(1&e&&(s.Xb(0,"div"),s.Xb(1,"div",90),s.Xc(2,ow,2,1,"div",91),s.Xb(3,"div",92),s.Xb(4,"a",93),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.wc("ngForOf",e.languages),s.Cb(3),s.bd(" ",s.pc(6,2,"USER_PROFILE.SETTINGS.LANGUAGE.ADD_LANGUAGE_LABEL")," ")}}function lw(e,t){if(1&e&&(s.Xb(0,"div"),s.Sb(1,"img",96),s.Xb(2,"span"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"span"),s.Zc(6),s.oc(7,"translate"),s.oc(8,"uppercase"),s.oc(9,"translate"),s.Wb(),s.Wb()),2&e){const e=t.$implicit,n=s.nc(2);s.Cb(3),s.bd("",s.pc(4,4,n.getLabel(e)),":"),s.Cb(3),s.dd(" ",e.hours," ",s.pc(7,6,"TEAMS.REMINDERS.CREATE.SENTENCE.SIXTH_PART")," ",s.pc(8,8,s.pc(9,10,n.translatedDateRangeEnum[e.dateRange])),"")}}function bw(e,t){if(1&e&&(s.Vb(0),s.Sb(1,"hr",24),s.Xb(2,"div",13),s.Xb(3,"div",14),s.Xb(4,"div",16),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Xb(7,"div",95),s.Xc(8,lw,10,12,"div",73),s.Wb(),s.Wb(),s.Ub()),2&e){const e=s.nc();s.Cb(5),s.ad(s.pc(6,2,"USER_PROFILE.SETTINGS.TIME_SETTINGS.TARGET")),s.Cb(3),s.wc("ngForOf",e.targets)}}const dw=function(){return["/email-preferences"]},uw=function(){return["/webhooks"]};var pw=function(e){return e.DAY="TEAMS.REMINDERS.DATE_RANGE.DAY_LABEL",e.WEEK="TEAMS.REMINDERS.DATE_RANGE.WEEK_LABEL",e.MONTH="GLOBAL.MONTH_LABEL",e}({});let hw=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r,l,b,d,u,h){this.userService=e,this.authService=t,this.notificationService=n,this.apiKeyService=i,this.reminderService=s,this.workspaceService=c,this.approvalService=a,this.loader=o,this.modalService=r,this.cd=l,this.translationStoreService=b,this.translateService=d,this.toaster=u,this.analyticsService=h,this.apiKeyDisplayValue=null,this.updateSettingsDebouncer$=new p.a,this.translatedDateRangeEnum=pw,this.hasNativeLogin=!0,this.languages=[{label:"English",code:"en"},{label:"Fran\xe7ais",code:"fr"},{label:"Espa\xf1ol",code:"es"},{label:"Portugu\xe9s",code:"pt"},{label:"Deutsch",code:"de"},{label:"\u0420\u0443\u0441\u0441\u043a\u0438\u0439",code:"ru"}],this.unsubscribe$=new Fn.a}ngOnInit(){var e;this.initTimeZones(),this.initDropDowns();const t=localStorage.getItem("systemSettings");if(t){const n=JSON.parse(t);this.hasNativeLogin=(null===(e=null==n?void 0:n.loginPreference)||void 0===e?void 0:e.indexOf(Cb.NATIVE_LOGIN))>-1}this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e}),this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.authService.permissionData$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(({isAdminOrOwner:e})=>{this.isAdminOrOwner=e,this.cd.markForCheck()}),this.authService.user.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.setUser(e)});const n=this.authService.getUser();this.setUser(n),this.apiKeyService.apiKey$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{e.apiKey&&(this.apiKey=e,this.apiKeyDisplayValue=this.createApiKeyDisplayValue(this.apiKey),this.cd.detectChanges())}),this.apiKeyService.getApiKeyForUser(),this.languages=this.languages.sort((e,t)=>e.label<t.label?-1:e.label>t.label?1:0),this.authService.canChangePassword.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.canChangeReceived=!0,this.canChangePassword=e,this.cd.detectChanges()}),this.getTargets(),this.authService.canChange(),this.subscribeToSaveSettings(),this.translateService.onLangChange.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{})}ngAfterViewInit(){this.inputEl&&this.inputEl.nativeElement.focus()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initTimeZones(){let e=ke.tz.names();e=e.map(e=>({timeZone:e,offset:ke.tz(e).format("Z")})).filter(e=>In.w.indexOf(e.timeZone)<0),e.sort((e,t)=>{const n=t.offset;return parseInt(e.offset.replace(":",""),10)-parseInt(n.replace(":",""),10)}),this.timezones=e.map(({timeZone:e,offset:t})=>{let n=`(UTC ${t}) `+e;return n=n.replace(/_/g," "),new Un.a(e,n)})}initDropDowns(){this.dateFormat=[new Un.a("MM/DD/YYYY"),new Un.a("MM-DD-YYYY"),new Un.a("MM DD YYYY"),new Un.a("MM.DD.YYYY"),new Un.a("DD/MM/YYYY"),new Un.a("DD-MM-YYYY"),new Un.a("DD MM YYYY"),new Un.a("DD.MM.YYYY"),new Un.a("YYYY-MM-DD"),new Un.a("YYYY/MM/DD"),new Un.a("YYYY MM DD"),new Un.a("YYYY.MM.DD"),new Un.a("YYYY-DD-MM"),new Un.a("YYYY/DD/MM"),new Un.a("YYYY DD MM"),new Un.a("YYYY.DD.MM")],this.timeFormat=[new Un.a(Lg.a.HOUR12,"12-"+this.translateService.instant("REPORTS.TABLE_INFO.HOUR_LABEL")),new Un.a(Lg.a.HOUR24,"24-"+this.translateService.instant("REPORTS.TABLE_INFO.HOUR_LABEL"))],this.dayOfWeek=[new Un.a("MONDAY","TEAMS.REMINDERS.WEEKDAYS.MONDAY"),new Un.a("TUESDAY","TEAMS.REMINDERS.WEEKDAYS.TUESDAY"),new Un.a("WEDNESDAY","TEAMS.REMINDERS.WEEKDAYS.WEDNESDAY"),new Un.a("THURSDAY","TEAMS.REMINDERS.WEEKDAYS.THURSDAY"),new Un.a("FRIDAY","TEAMS.REMINDERS.WEEKDAYS.FRIDAY"),new Un.a("SATURDAY","TEAMS.REMINDERS.WEEKDAYS.SATURDAY"),new Un.a("SUNDAY","TEAMS.REMINDERS.WEEKDAYS.SUNDAY")]}updateSettingsDebounce(e,t){var n;void 0===t&&(t=null===(n=this.user)||void 0===n?void 0:n.settings[e]),this.updateSettingsDebouncer$.next({value:t,prop:e})}nameChanged(){this.user.name=this.user.name.trim(),this.user.name?this.updateSettingsDebounce():this.user.name=this.usernameBackup}setUser(e){this.user=e,this.usernameBackup=this.user.name,this.userTimeFormat=this.user.settings.timeFormat,this.groupSimilarEntries=!this.user.settings.groupSimilarEntriesDisabled,this.activeLanguage=this.user.settings.lang?this.languages.find(e=>e.code===this.user.settings.lang.toLowerCase()):null,this.cd.detectChanges()}setSettingsProperty(e,t){this.user.settings[t]!==e&&(this.user.settings[t]=e,this.updateSettingsDebounce(t,e))}toggleProperty(e){this.user.settings[e]=!this.user.settings[e],this.updateSettingsDebounce(e,this.user.settings[e])}addEventOnSettingsChanged(e,t){const n=new Fi.a({section:"Profile settings",value:e});"groupSimilarEntriesDisabled"==t&&(n.event="switch",n.value=e?"OFF":"ON",n.section2="Group time entries",n.section3="Group similar time entries",n.section4="Group similar time entries"),"timeZone"==t&&(n.event="select",n.section2="Time settings",n.section3="Time zone"),"dateFormat"==t&&(n.event="select",n.section2="Time settings",n.section3="Date format"),"timeFormat"==t&&(n.event="select",n.section2="Time settings",n.section3="Time format"),"weekStart"==t&&(n.event="select",n.section2="Time settings",n.section3="Week start"),"dayStart"==t&&(n.event="select",n.section2="Time settings",n.section3="Day start"),"sendNewsletter"==t&&(n.event="select",n.section2="Email notifications",n.section3="Newsletter"),"weeklyUpdates"==t&&(n.event="select",n.section2="Email notifications",n.section3="Weekly updates"),"longRunning"==t&&(n.event="select",n.section2="Email notifications",n.section3="Long Running timers"),"projectPickerSpecialFilter"==t&&(n.event="switch",n.section2="Task filter",n.section3="Activate task filter"),"generateApiKey"==t&&(n.event="submit",n.section2="API",n.section3="Generate API Key",n.section4="API"),this.analyticsService.addEvent(n)}subscribeToSaveSettings(){this.updateSettingsDebouncer$.pipe(Object(De.a)(600),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{e&&this.addEventOnSettingsChanged(null==e?void 0:e.value,null==e?void 0:e.prop),this.updateSettings()})}updateSettings(){this.user.name||(this.user.name=this.usernameBackup,this.cd.detectChanges()),this.userService.updateSettings(this.user).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.notificationService.userSettingChanged(this.user.settings.timeZone),this.loader.hide()},()=>this.loader.hide())}removeImage(){this.user.profilePicture="",this.updateSettings()}get hasCustomProfileImage(){return!this.user.profilePicture.endsWith(In.t)}setImage(e){this.user.profilePicture=e,this.updateSettings()}openModal(e){this.isModalOpen||(this.isModalOpen=!0,this.modalService.open(e,{centered:!0}).result.then(()=>setTimeout(()=>this.isModalOpen=!1,100),()=>setTimeout(()=>this.isModalOpen=!1,100)))}onTimeZoneChange(e,t){ke.tz(this.user.settings.timeZone).format("Z")!==ke.tz(t).format("Z")?this.checkApprovalSubmittedStatus(e,t,"timeZone"):this.setSettingsProperty(t,"timeZone")}checkApprovalSubmittedStatus(e,t,n){t!==this.user.settings[n]&&(this.approvalInProgressBackupValue=t,this.approvalInProgressProp=n,this.loader.showBar(),this.approvalService.getAllPendingRequestsForAllWorkspaces().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(i=>{i.length?(this.pendingApprovals=i,this.modalService.open(e,{centered:!0}).result.then(null,()=>{this.cancelWithdrawnAllApprovals()}),this.loader.hide()):(this.user.settings[n]=t,this.addEventOnSettingsChanged(t,n),this.updateSettings())},e=>{this.cancelWithdrawnAllApprovals()}))}confirmWithdrawnAll(e){this.loader.showBar(!0,!0),this.inProgress=!0,this.approvalService.withdrawAllRequestsForAllWorkspaces().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.user.settings[this.approvalInProgressProp]=this.approvalInProgressBackupValue,this.updateSettings(),this.inProgress=!1,this.addEventOnSettingsChanged(this.approvalInProgressBackupValue,this.approvalInProgressProp),e.close()},e=>{this.inProgress=!1,this.loader.hide()})}cancelWithdrawnAllApprovals(){this.dropdownItems.setValue(this.user.settings.weekStart,null,!1),this.dropdownTimeZone.setValue(this.user.settings.timeZone,null,!1),this.loader.hide()}onSetPassword(){this.canChangePassword=!0}generateApiKey(e){this.apiKey?this.openModal(e):(this.addEventOnSettingsChanged("generateApiKey","generateApiKey"),this.apiKeyService.generateApiKey())}timeChanged(e){this.user.settings.myStartOfDay=e,this.updateSettingsDebounce("dayStart",e)}getTargets(){this.workspace.hasFeature(is.a.TARGETS_AND_REMINDERS)&&this.reminderService.getTargets().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.targets=e,this.cd.detectChanges()})}getLabel(e){var t;const n=e.users.length;return 1===n?"everyone"===e.users[0]?"GLOBAL.EVERYONE_LABEL":null===(t=e.userAndGroupNames[0])||void 0===t?void 0:t.name:n>1?`Team (${n})`:"USER_PROFILE.SETTINGS.TARGET.NO_TARGET"}onLanguageChange(e){this.activeLanguage=this.languages.find(t=>t.code===e),this.loader.show(),this.userService.setLanguage(e.toUpperCase()).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.analyticsService.addEvent(new Fi.a({event:"select",value:this.activeLanguage.label,section:"Profile settings",section2:"Language",section3:"Select language",section4:"Select language"})),this.translationStoreService.changeActiveLanguage(e),this.translateService.onLangChange.pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.toaster.pop("success",this.translateService.instant("SERVICES.USER.SETTINGS.SAVE.SUCCESS_MESSAGE")),this.apiKey&&(this.apiKeyDisplayValue=this.createApiKeyDisplayValue(this.apiKey)),this.notificationService.getNotification()}),this.loader.hide()})}createApiKeyDisplayValue(e){return this.apiKeyDisplayValue=this.apiKey.apiKey+(this.apiKey.active?"":" ("+this.translateService.instant("WORKSPACE.ACCOUNT.USER.API_KEY.DEACTIVATED")+")")}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Lc.a),s.Rb(re.a),s.Rb(Gm.a),s.Rb(le),s.Rb(SI),s.Rb(l.a),s.Rb(rn),s.Rb(Hn.a),s.Rb(w.q),s.Rb(s.h),s.Rb(Ra.a),s.Rb(g.f),s.Rb(a.d),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["userProfile"]],viewQuery:function(e,t){var n;1&e&&(s.gd(FI,!0),s.gd(jI,!0),s.gd(ZI,!0)),2&e&&(s.Kc(n=s.kc())&&(t.inputEl=n.first),s.Kc(n=s.kc())&&(t.dropdownItems=n.first),s.Kc(n=s.kc())&&(t.dropdownTimeZone=n.first))},decls:210,vars:133,consts:[["changePasswordModal",""],["setPasswordModal",""],["changeEmailModal",""],["generateApiModal",""],["approvalListModal",""],[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-h1"],[1,"cl-card"],[1,"cl-card-body"],[1,"cl-row"],[1,"cl-col-12"],[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-12"],[1,"cl-mb-3"],[1,"cl-h2","cl-mb-0"],[1,"cl-text-gray-9","cl-w-lg-75"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-upload-img",3,"classSize","src","name"],[1,"cl-upload-file-wrapper"],[1,"cl-upload-btn-wrapper","cl-mr-3"],[3,"text","onUploaded"],["class","cl-color-blue","tabindex","0",3,"keyup.enter","click",4,"ngIf"],[1,"cl-mt-0"],[1,"cl-form-group","cl-mb-0","cl-col-md-12","cl-col-lg-8","cl-col-lg-custom-5"],[1,"cl-form-group","cl-col-md-6"],["type","text","data-cy","profile-name","tabindex","0",1,"cl-form-control",3,"ngModel","change","keyup.enter","ngModelChange"],["userNameInput",""],[1,"cl-input-group"],["type","email","autocomplete","off","readonly","",1,"cl-form-control","cl-cut-text",3,"ngModel"],["class","cl-input-group-append",4,"ngIf"],["class","cl-form-row",4,"ngIf"],[1,"cl-form-group","cl-col-md-3"],["dropdownKey","",1,"cl-dropdown","cl-dropdown-large","cl-d-flex"],["dropdownKeyButton","","tabindex","0","placement","bottom","data-cy","language-dropdown",1,"cl-dropdown-item-label","cl-btn","cl-btn-outline-light","cl-w-100","cl-text-left","cl-dropdown-toggle","cl-cut-text","pointer"],[1,"cl-d-flex","cl-flex-row","cl-align-center","cl-justify-content-start"],["src","assets/images/ui-icons/translate.svg",1,"cl-mr-2"],[4,"ngIf"],["languagePlaceholder",""],[4,"dropdownKeyContent"],[1,"cl-custom-control","cl-custom-switch"],["type","checkbox","id","similarGroup","tabindex","0",1,"cl-custom-control-input",3,"ngModel","ngModelChange","keyup.enter"],["for","similarGroup",1,"cl-custom-control-label"],[3,"settings","onChange"],[1,"cl-form-group","cl-col-md-12","cl-col-lg-5"],["type","checkbox","id","searchByTask",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","searchByTask",1,"cl-custom-control-label"],["data-cy","time-zone",1,"cl-form-group","cl-col-md-6"],[3,"enableSearch","list","placeholder","value","title","onChanged"],["dropdownTimeZone",""],["data-cy","date-format",1,"cl-form-group","cl-col-md-6"],[3,"list","value","title","onChanged"],["data-cy","time-format",1,"cl-form-group","cl-col-md-6"],["data-cy","week-start",1,"cl-form-group","cl-col-md-6"],["dropdownItems",""],[1,"reset-cl-form-control"],[3,"emitFormat","timeFormat","hours","onTimeChanged"],[1,"cl-form-group","cl-mb-0","cl-col-md-6","cl-col-lg-8","cl-col-lg-custom-5"],[3,"routerLink"],["data-cy","api-key",1,"cl-input-group"],["type","text","readonly","",1,"cl-form-control",2,"cursor","text",3,"ngModel","click"],["apiKeyInput",""],[1,"cl-input-group-append"],[1,"cl-input-group-text","cl-bg-white"],["name","generateApiKey","tabindex","0",1,"cl-color-blue",3,"click","keyup.enter"],["generateLink",""],[3,"title","onClose"],[3,"onClose"],[3,"onClose","onSetPassword"],[3,"userId","onClose"],[3,"title","btnText","showConfirmation","confirmationText","inProgress","onDelete","onClose"],[1,"cl-text-dark"],[4,"ngFor","ngForOf"],[1,"cl-h2"],[1,"cl-list-unstyled","cl-ml-0"],["tabindex","0",1,"cl-color-blue",3,"keyup.enter","click"],["class","cl-input-group-text",4,"ngIf"],["class","cl-input-group-text cl-bg-white",4,"ngIf"],[1,"cl-input-group-text"],["ngbTooltip","Email can't be changed until you set a password","placement","bottom",1,"cl-color-blue","cl-disabled-not-allowed"],["tabindex","0",1,"cl-color-blue",3,"click","keyup.enter"],["emailBtn",""],[1,"cl-form-group","cl-col-md-12","cl-col-lg-8","cl-col-lg-custom-5"],[1,"cl-form-group","cl-mb-0","cl-col-md-6"],["tabindex","0","class","cl-btn cl-btn-block cl-btn-outline-light","data-cy","change-password",3,"click","keyup.enter",4,"ngIf","ngIfElse"],["setPasswordTemplate",""],["tabindex","0","data-cy","change-password",1,"cl-btn","cl-btn-block","cl-btn-outline-light",3,"click","keyup.enter"],["tabindex","0",1,"cl-btn","cl-btn-block","cl-btn-outline-light",3,"click","keyup.enter"],[1,"cl-form-text","cl-text-gray-9"],[1,"cl-dropdown-menu","cl-pb-0","cl-w-250"],["clickCloseDropdown","","class","cl-dropdown-item pointer",3,"click",4,"ngFor","ngForOf"],[1,"cl-dropdown-item","cl-border-light"],["href"," https://clockify.me/help/translation","target","_blank"],["clickCloseDropdown","",1,"cl-dropdown-item","pointer",3,"click"],[1,"cl-col-md-12","cl-mb-2"],["src","../assets/checked.png",1,"cl-mr-2"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xc(0,VI,3,3,"ng-template",null,0,s.Yc),s.Xc(2,YI,3,3,"ng-template",null,1,s.Yc),s.Xc(4,HI,3,4,"ng-template",null,2,s.Yc),s.Xc(6,$I,1,0,"ng-template",null,3,s.Yc),s.Xc(8,zI,9,17,"ng-template",null,4,s.Yc),s.Xb(10,"div",5),s.Xb(11,"div",6),s.Xb(12,"div",7),s.Xb(13,"h1",8),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Wb(),s.Xb(16,"div",9),s.Xb(17,"div",10),s.Xb(18,"div",11),s.Xb(19,"div",12),s.Xb(20,"div"),s.Xb(21,"div",13),s.Xb(22,"div",14),s.Xb(23,"div",15),s.Xb(24,"div",16),s.Zc(25),s.oc(26,"translate"),s.Wb(),s.Xb(27,"div",17),s.Zc(28),s.oc(29,"translate"),s.Wb(),s.Wb(),s.Xb(30,"div",18),s.Sb(31,"avatar",19),s.Xb(32,"div",20),s.Xb(33,"div",21),s.Xb(34,"btn-upload-file",22),s.jc("onUploaded",(function(e){return t.setImage(e)})),s.Wb(),s.Wb(),s.Xc(35,QI,3,3,"a",23),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(36,"hr",24),s.Xb(37,"div",13),s.Xb(38,"div",14),s.Xb(39,"div",16),s.Zc(40),s.oc(41,"translate"),s.Wb(),s.Xb(42,"div",17),s.Zc(43),s.oc(44,"translate"),s.Wb(),s.Wb(),s.Xb(45,"div",25),s.Xb(46,"div",13),s.Xb(47,"div",26),s.Xb(48,"label"),s.Zc(49),s.oc(50,"translate"),s.Wb(),s.Xb(51,"input",27,28),s.jc("change",(function(){return t.nameChanged()}))("keyup.enter",(function(){return s.Oc(e),s.Lc(52).blur()}))("ngModelChange",(function(e){return t.user.name=e})),s.Wb(),s.Wb(),s.Xb(53,"div",26),s.Xb(54,"label"),s.Zc(55),s.oc(56,"translate"),s.Wb(),s.Xb(57,"div",29),s.Sb(58,"input",30),s.Xc(59,tw,3,2,"div",31),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(60,sw,10,5,"div",32),s.Sb(61,"hr",24),s.Xb(62,"div",13),s.Xb(63,"div",14),s.Xb(64,"div",16),s.Zc(65),s.oc(66,"translate"),s.Wb(),s.Xb(67,"div",17),s.Zc(68),s.oc(69,"translate"),s.Wb(),s.Wb(),s.Xb(70,"div",14),s.Xb(71,"div",13),s.Xb(72,"div",33),s.Xb(73,"div",34),s.Xb(74,"a",35),s.Xb(75,"div",36),s.Sb(76,"img",37),s.Xc(77,cw,2,1,"span",38),s.Wb(),s.Xc(78,aw,3,3,"ng-template",null,39,s.Yc),s.Wb(),s.Xc(80,rw,7,4,"div",40),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(81,"hr",24),s.Xb(82,"div",13),s.Xb(83,"div",14),s.Xb(84,"div",16),s.Zc(85),s.oc(86,"translate"),s.Wb(),s.Xb(87,"div",17),s.Zc(88),s.oc(89,"translate"),s.Wb(),s.Wb(),s.Xb(90,"div",14),s.Xb(91,"div",41),s.Xb(92,"input",42),s.jc("ngModelChange",(function(e){return t.groupSimilarEntries=e}))("ngModelChange",(function(){return t.setSettingsProperty(!t.groupSimilarEntries,"groupSimilarEntriesDisabled")}))("keyup.enter",(function(){return t.groupSimilarEntries=!t.groupSimilarEntries,t.setSettingsProperty(!t.groupSimilarEntries,"groupSimilarEntriesDisabled")})),s.Wb(),s.Xb(93,"label",43),s.Zc(94),s.oc(95,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(96,"hr",24),s.Xb(97,"div",13),s.Xb(98,"div",14),s.Xb(99,"div",16),s.Zc(100),s.oc(101,"translate"),s.Wb(),s.Xb(102,"div",17),s.Zc(103),s.oc(104,"translate"),s.Wb(),s.Wb(),s.Xb(105,"div",25),s.Xb(106,"compact-project",44),s.jc("onChange",(function(){return t.updateSettingsDebounce()})),s.Wb(),s.Wb(),s.Wb(),s.Sb(107,"hr",24),s.Xb(108,"div",13),s.Xb(109,"div",14),s.Xb(110,"div",16),s.Zc(111),s.oc(112,"translate"),s.Wb(),s.Xb(113,"div",17),s.Zc(114),s.oc(115,"translate"),s.Wb(),s.Wb(),s.Xb(116,"div",45),s.Xb(117,"div",41),s.Xb(118,"input",46),s.jc("change",(function(){return t.updateSettingsDebounce("projectPickerSpecialFilter")}))("ngModelChange",(function(e){return t.user.settings.projectPickerSpecialFilter=e})),s.Wb(),s.Xb(119,"label",47),s.Zc(120),s.oc(121,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(122,bw,9,4,"ng-container",38),s.Sb(123,"hr",24),s.Xb(124,"div",13),s.Xb(125,"div",14),s.Xb(126,"div",16),s.Zc(127),s.oc(128,"translate"),s.Wb(),s.Xb(129,"div",17),s.Zc(130),s.oc(131,"translate"),s.Wb(),s.Wb(),s.Xb(132,"div",25),s.Xb(133,"div",13),s.Xb(134,"div",48),s.Xb(135,"dropdown-items",49,50),s.jc("onChanged",(function(n){s.Oc(e);const i=s.Lc(9);return t.onTimeZoneChange(i,n)})),s.oc(137,"translate"),s.oc(138,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(139,"div",13),s.Xb(140,"div",51),s.Xb(141,"dropdown-items",52),s.jc("onChanged",(function(e){return t.setSettingsProperty(e,"dateFormat")})),s.oc(142,"translate"),s.Wb(),s.Wb(),s.Xb(143,"div",53),s.Xb(144,"dropdown-items",52),s.jc("onChanged",(function(e){return t.setSettingsProperty(e,"timeFormat")})),s.oc(145,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(146,"div",13),s.Xb(147,"div",54),s.Xb(148,"dropdown-items",52,55),s.jc("onChanged",(function(n){s.Oc(e);const i=s.Lc(9);return t.checkApprovalSubmittedStatus(i,n,"weekStart")})),s.oc(150,"translate"),s.Wb(),s.Wb(),s.Xb(151,"div",26),s.Xb(152,"label"),s.Zc(153),s.oc(154,"translate"),s.Wb(),s.Xb(155,"div",56),s.Xb(156,"input-hours",57),s.jc("onTimeChanged",(function(e){return t.timeChanged(e)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(157,"hr",24),s.Xb(158,"div",13),s.Xb(159,"div",14),s.Xb(160,"div",16),s.Zc(161),s.oc(162,"translate"),s.Wb(),s.Xb(163,"div",17),s.Zc(164),s.oc(165,"translate"),s.Wb(),s.Wb(),s.Xb(166,"div",58),s.Xb(167,"div",13),s.Xb(168,"div",14),s.Xb(169,"a",59),s.Zc(170),s.oc(171,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(172,"hr",24),s.Xb(173,"div",13),s.Xb(174,"div",14),s.Xb(175,"div",16),s.Zc(176,"API"),s.Wb(),s.Xb(177,"div",17),s.Zc(178),s.oc(179,"translate"),s.Wb(),s.Wb(),s.Xb(180,"div",58),s.Xb(181,"div",13),s.Xb(182,"div",14),s.Xb(183,"label"),s.Zc(184),s.oc(185,"translate"),s.Wb(),s.Xb(186,"div",60),s.Xb(187,"input",61,62),s.jc("click",(function(){return s.Oc(e),s.Lc(188).select()})),s.Wb(),s.Xb(189,"div",63),s.Xb(190,"span",64),s.Xb(191,"a",65,66),s.jc("click",(function(){s.Oc(e);const n=s.Lc(192),i=s.Lc(7);return n.blur(),t.generateApiKey(i)}))("keyup.enter",(function(){s.Oc(e);const n=s.Lc(192),i=s.Lc(7);return n.blur(),t.generateApiKey(i)})),s.Zc(193),s.oc(194,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(195,"hr",24),s.Xb(196,"div",13),s.Xb(197,"div",14),s.Xb(198,"div",16),s.Zc(199),s.oc(200,"translate"),s.Wb(),s.Xb(201,"div",17),s.Zc(202),s.oc(203,"translate"),s.Wb(),s.Wb(),s.Xb(204,"div",58),s.Xb(205,"div",13),s.Xb(206,"div",14),s.Xb(207,"a",59),s.Zc(208),s.oc(209,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(14),s.ad(s.pc(15,63,"GLOBAL.PROFILE_SETTINGS_LABEL")),s.Cb(11),s.ad(s.pc(26,65,"USER_PROFILE.SETTINGS.PHOTO.TITLE")),s.Cb(3),s.bd(" ",s.pc(29,67,"USER_PROFILE.SETTINGS.PHOTO.INFO_MESSAGE")," "),s.Cb(3),s.wc("classSize","cl-no-image-wrapper-lg")("src",t.user.profilePicture)("name",t.usernameBackup),s.Cb(3),s.wc("text","SHARED_MODULES.BTN_UPLOAD_FILE_CONTENT.UPLOAD_IMG_BTN_DEFAULT"),s.Cb(1),s.wc("ngIf",t.hasCustomProfileImage),s.Cb(5),s.ad(s.pc(41,69,"USER_PROFILE.SETTINGS.PERSONAL.TITLE")),s.Cb(3),s.bd(" ",s.pc(44,71,"USER_PROFILE.SETTINGS.PERSONAL.INFO_MESSAGE")," "),s.Cb(6),s.ad(s.pc(50,73,"GLOBAL.NAME_LABEL")),s.Cb(2),s.wc("ngModel",t.user.name),s.Cb(4),s.ad(s.pc(56,75,"GLOBAL.EMAIL_LABEL")),s.Cb(3),s.wc("ngModel",null==t.user?null:t.user.email),s.Cb(1),s.wc("ngIf",t.hasNativeLogin),s.Cb(1),s.wc("ngIf",t.hasNativeLogin),s.Cb(5),s.bd(" ",s.pc(66,77,"USER_PROFILE.SETTINGS.LANGUAGE.TITLE")," "),s.Cb(3),s.bd(" ",s.pc(69,79,"USER_PROFILE.SETTINGS.LANGUAGE.INFO_MESSAGE")," "),s.Cb(9),s.wc("ngIf",t.activeLanguage),s.Cb(8),s.ad(s.pc(86,81,"USER_PROFILE.SETTINGS.GROUP_ENTRIES.TITLE")),s.Cb(3),s.ad(s.pc(89,83,"USER_PROFILE.SETTINGS.GROUP_ENTRIES.INFO_MESSAGE")),s.Cb(4),s.wc("ngModel",t.groupSimilarEntries),s.Cb(2),s.bd(" ",s.pc(95,85,"USER_PROFILE.SETTINGS.GROUP_ENTRIES.TOGGLE")," "),s.Cb(6),s.ad(s.pc(101,87,"USER_PROFILE.SETTINGS.COMPACT_PROJECT_LIST.TITLE")),s.Cb(3),s.bd(" ",s.pc(104,89,"USER_PROFILE.SETTINGS.COMPACT_PROJECT_LIST.INFO_MESSAGE"),""),s.Cb(3),s.wc("settings",t.user.settings),s.Cb(5),s.ad(s.pc(112,91,"USER_PROFILE.SETTINGS.TASK_FILTER.TITLE")),s.Cb(3),s.bd(" ",s.pc(115,93,"USER_PROFILE.SETTINGS.TASK_FILTER.INFO_MESSAGE")," "),s.Cb(4),s.wc("ngModel",t.user.settings.projectPickerSpecialFilter),s.Cb(2),s.bd(" ",s.pc(121,95,"USER_PROFILE.SETTINGS.TASK_FILTER.TOGGLE")," "),s.Cb(2),s.wc("ngIf",null==t.targets?null:t.targets.length),s.Cb(5),s.ad(s.pc(128,97,"USER_PROFILE.SETTINGS.TIME_SETTINGS.TITLE")),s.Cb(3),s.bd(" ",s.pc(131,99,"USER_PROFILE.SETTINGS.TIME_SETTINGS.INFO_MESSAGE")," "),s.Cb(5),s.wc("enableSearch",!0)("list",t.timezones)("placeholder",s.pc(137,101,"USER_PROFILE.SETTINGS.TIME_SETTINGS.ZONE.PLACEHOLDER"))("value",t.user.settings.timeZone)("title",s.pc(138,103,"USER_PROFILE.SETTINGS.TIME_SETTINGS.ZONE.TITLE")),s.Cb(6),s.wc("list",t.dateFormat)("value",t.user.settings.dateFormat)("title",s.pc(142,105,"USER_PROFILE.SETTINGS.TIME_SETTINGS.DATE.TITLE")),s.Cb(3),s.wc("list",t.timeFormat)("value",t.user.settings.timeFormat)("title",s.pc(145,107,"USER_PROFILE.SETTINGS.TIME_SETTINGS.TIME.TITLE")),s.Cb(4),s.wc("list",t.dayOfWeek)("value",t.user.settings.weekStart)("title",s.pc(150,109,"USER_PROFILE.SETTINGS.TIME_SETTINGS.WEEK.START")),s.Cb(5),s.ad(s.pc(154,111,"USER_PROFILE.SETTINGS.TIME_SETTINGS.DAY.START")),s.Cb(3),s.wc("emitFormat","HH:mm")("timeFormat",null==t.user||null==t.user.settings?null:t.user.settings.timeFormat)("hours",null==t.user||null==t.user.settings?null:t.user.settings.myStartOfDay),s.Cb(5),s.ad(s.pc(162,113,"GLOBAL.EMAIL_PREFERENCES_LABEL")),s.Cb(3),s.bd(" ",s.pc(165,115,"USER_PROFILE.SETTINGS.EMAIL_PREFERENCES.INFO_MESSAGE")," "),s.Cb(5),s.wc("routerLink",s.Ac(131,dw)),s.Cb(1),s.ad(s.pc(171,117,"USER_PROFILE.SETTINGS.EMAIL_PREFERENCES.MANAGE")),s.Cb(8),s.ad(s.pc(179,119,"USER_PROFILE.SETTINGS.API.INFO_MESSAGE")),s.Cb(6),s.ad(s.pc(185,121,"GLOBAL.API_KEY_TITLE")),s.Cb(3),s.wc("ngModel",t.apiKeyDisplayValue),s.Cb(6),s.ad(s.pc(194,123,"USER_PROFILE.SETTINGS.API.GENERATE_ACTION")),s.Cb(6),s.ad(s.pc(200,125,"GLOBAL.WEBHOOKS_TITLE")),s.Cb(3),s.bd(" ",s.pc(203,127,"USER_PROFILE.SETTINGS.WEBHOOKS.INFO_MESSAGE")," "),s.Cb(5),s.wc("routerLink",s.Ac(132,uw)),s.Cb(1),s.ad(s.pc(209,129,"USER_PROFILE.SETTINGS.WEBHOOKS.MANAGE")))},directives:[Pc.a,fo.a,i.u,v.c,v.s,v.v,ni.a,ii.a,si.a,v.a,LI,ji.a,RI,k.g,Wd.a,MI,bu,GI,xI,Xd.a,i.t,w.bb],pipes:[g.e,Ro.a,i.I],encapsulation:2,changeDetection:0}),e})();var mw=n("q92s");let gw=(()=>{class e{constructor(e){this.workspaceService=e}canActivate(){if(this.workspaceService.getLocalDefaultWorkspace())return!0;const e=this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>null!==e)),t=this.workspaceService.defaultWorkspaceError;return this.workspaceService.getDefaultWorkspace(),e.pipe(Object(mw.a)(t),Object(Zt.a)(e=>null!==e),Object(ln.a)(1),Object(d.a)(e=>!!e))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(l.a))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Ew=(()=>{class e{constructor(e){this.authService=e}resolve(){let e;const t=this.authService.permissionData$.pipe(Object(Zt.a)(e=>null!==e),Object(ln.a)(1));let n;return t.subscribe(()=>e=!0),n=e?t:this.authService.getPermissionsForUser(),n.pipe(Object(ln.a)(1),Object(d.a)(e=>!!e))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(re.a))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),fw=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(){if(this.workspaceService.getLocalDefaultWorkspace().canSeeTimeSheet)return!0;this.router.navigate(["tracker"])}}return e.\u0275fac=function(t){return new(t||e)(s.fc(l.a),s.fc(k.d))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})(),Sw=(()=>{class e{constructor(e,t){this.authService=e,this.router=t}canActivate(e,t){const{id:n,token:i,refreshToken:s,workspaceId:c}=e.queryParams;return!(n&&i&&s)||(this.authService.saveTokenToLocalStorage(i,s),this.authService.getUserById(n).pipe(Object(d.a)(n=>{let i;if(n.defaultWorkspaceId===c){const n=e.fragment;i={url:(t.url||"").split("?")[0],fragment:n}}return this.authService.redirectAfterLogin(i),!0},()=>!0)))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(re.a),s.fc(k.d))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Cw=n("dU7q"),Aw=n("IlrW");function Ow(e,t){1&e&&(s.Xb(0,"div",18),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.INVOICE_EXPLANATION")))}function vw(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",13),s.Xb(1,"input",19),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().editInvoiceInformation.vatNumber=t})),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.wc("placeholder",null!=e.tax?e.tax.placeholder:"")("ngModel",e.editInvoiceInformation.vatNumber)}}function Tw(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",4),s.Xb(1,"div",5),s.Xb(2,"a",20),s.jc("click",(function(){return s.Oc(e),s.nc().addAddress()})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"label"),s.Xb(6,"span",7),s.Zc(7),s.oc(8,"lowercase"),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(3),s.bd("",s.pc(4,2,"INVOICES.DETAILS.ADD_ADRESS")," "),s.Cb(4),s.bd(" (",s.pc(8,4,s.pc(9,6,"INVOICES.SHARED.OPTIONAL")),")"))}function Iw(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"div",4),s.Xb(2,"div",5),s.Xb(3,"label"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(6,"div",4),s.Xb(7,"div",5),s.Xb(8,"label"),s.Zc(9),s.oc(10,"translate"),s.Xb(11,"span",7),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Xb(14,"input",21),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().editInvoiceInformation.country=t})),s.Wb(),s.Wb(),s.Wb(),s.Xb(15,"div",4),s.Xb(16,"div",5),s.Xb(17,"label"),s.Zc(18),s.oc(19,"translate"),s.Xb(20,"span",7),s.Zc(21),s.oc(22,"translate"),s.Wb(),s.Wb(),s.Xb(23,"input",22),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().editInvoiceInformation.address1=t})),s.Wb(),s.Wb(),s.Wb(),s.Xb(24,"div",4),s.Xb(25,"div",5),s.Xb(26,"label"),s.Zc(27),s.oc(28,"translate"),s.Xb(29,"span",7),s.Zc(30),s.oc(31,"lowercase"),s.oc(32,"translate"),s.Wb(),s.Wb(),s.Xb(33,"input",23),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().editInvoiceInformation.address2=t})),s.Wb(),s.Wb(),s.Wb(),s.Xb(34,"div",4),s.Xb(35,"div",5),s.Xb(36,"label"),s.Zc(37),s.oc(38,"translate"),s.Xb(39,"span",7),s.Zc(40),s.oc(41,"translate"),s.Wb(),s.Wb(),s.Xb(42,"input",24),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().editInvoiceInformation.city=t})),s.Wb(),s.Wb(),s.Wb(),s.Xb(43,"div",4),s.Xb(44,"div",5),s.Xb(45,"label"),s.Zc(46),s.oc(47,"translate"),s.Xb(48,"span",7),s.Zc(49),s.oc(50,"translate"),s.Wb(),s.Wb(),s.Xb(51,"input",25),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().editInvoiceInformation.state=t})),s.Wb(),s.Wb(),s.Wb(),s.Xb(52,"div",4),s.Xb(53,"div",5),s.Xb(54,"label"),s.Zc(55),s.oc(56,"translate"),s.Xb(57,"span",7),s.Zc(58),s.oc(59,"translate"),s.Wb(),s.Wb(),s.Xb(60,"input",26),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().editInvoiceInformation.zip=t})),s.Wb(),s.Wb(),s.Wb(),s.Xb(61,"div",4),s.Xb(62,"div",5),s.Xb(63,"a",20),s.jc("click",(function(){return s.Oc(e),s.nc().removeAddress()})),s.Zc(64),s.oc(65,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(4),s.ad(s.pc(5,20,"GLOBAL.ADDRESS_LABEL")),s.Cb(5),s.bd("",s.pc(10,22,"GLOBAL.LABEL_COUNTRY")," "),s.Cb(3),s.ad(s.pc(13,24,"SHARED_MODULES.STRIPE.REQUIRED_LABEL")),s.Cb(2),s.wc("ngModel",e.editInvoiceInformation.country),s.Cb(4),s.bd("",s.pc(19,26,"GLOBAL.ADDRESS_LABEL")," 1 "),s.Cb(3),s.ad(s.pc(22,28,"SHARED_MODULES.STRIPE.REQUIRED_LABEL")),s.Cb(2),s.wc("ngModel",e.editInvoiceInformation.address1),s.Cb(4),s.bd("",s.pc(28,30,"GLOBAL.ADDRESS_LABEL")," 2 "),s.Cb(3),s.bd("(",s.pc(31,32,s.pc(32,34,"INVOICES.SHARED.OPTIONAL")),")"),s.Cb(3),s.wc("ngModel",e.editInvoiceInformation.address2),s.Cb(4),s.bd("",s.pc(38,36,"GLOBAL.LABEL_CITY")," "),s.Cb(3),s.ad(s.pc(41,38,"SHARED_MODULES.STRIPE.REQUIRED_LABEL")),s.Cb(2),s.wc("ngModel",e.editInvoiceInformation.city),s.Cb(4),s.bd("",s.pc(47,40,"GLOBAL.LABEL_STATE")," "),s.Cb(3),s.ad(s.pc(50,42,"SHARED_MODULES.STRIPE.REQUIRED_LABEL")),s.Cb(2),s.wc("ngModel",e.editInvoiceInformation.state),s.Cb(4),s.bd("",s.pc(56,44,"GLOBAL.LABEL_ZIP")," "),s.Cb(3),s.ad(s.pc(59,46,"SHARED_MODULES.STRIPE.REQUIRED_LABEL")),s.Cb(2),s.wc("ngModel",e.editInvoiceInformation.zip),s.Cb(4),s.ad(s.pc(65,48,"SHARED_MODULES.STRIPE.REMOVE_ADDRESS_BTN"))}}function ww(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",4),s.Xb(1,"div",27),s.Xb(2,"button",28),s.jc("click",(function(){return s.Oc(e),s.nc().next()})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"GLOBAL.NEXT_STEP_BTN")," "))}let Lw=(()=>{class e{constructor(e,t,n,i){this.formBuilder=e,this.toaster=t,this.translateService=n,this.analyticsService=i,this.saveInfo=new s.n,this.closeModal=new s.n,this.nextStep=new s.n,this.turnAddress=new s.n,this.mode="create",this.taxes=[new Ea.a(null,this.translateService.instant("SHARED_MODULES.STRIPE_INVOICE.TAX_ID_PLACEHOLDER"),""),new Ea.a("ae_trn","AE TRN United Arab Emirates","123456789012345"),new Ea.a("eu_vat at","AT VAT Austria","ATU12345678"),new Ea.a("au_abn","AU ABN Australia","12345678912"),new Ea.a("eu_vat be","BE VAT Belgium","BE0123456789"),new Ea.a("eu_vat bg","BG VAT Bulgaria","BG0123456789"),new Ea.a("br_cnpj","BR CNPJ Brazil","01.234.456/5432-10"),new Ea.a("br_cpf","BR CPF Brazil","123.456.789-87"),new Ea.a("ca_bn","CA BN Canada","123456789"),new Ea.a("ca_qst","CA QST Canada","1234567890TQ1234"),new Ea.a("ch_vat","CH VAT Switzerland","CHE-123.456.789 MWST"),new Ea.a("cl_tin","CL TIN Chile","12.345.678-K"),new Ea.a("eu_vat cy","CY VAT Cyprus","CY12345678Z"),new Ea.a("eu_vat cz","CZ VAT Czech Republic","CZ1234567890"),new Ea.a("eu_vat de","DE VAT Germany","DE123456789"),new Ea.a("eu_vat dk","DK VAT Denmark","DK12345678"),new Ea.a("eu_vat ee","EE VAT Estonia","EE123456789"),new Ea.a("es_cif","ES CIF Spain","A12345678"),new Ea.a("eu_vat es","ES VAT Spain","ESA1234567Z"),new Ea.a("eu_vat fi","FI VAT Finland","FI12345678"),new Ea.a("eu_vat fr","FR VAT France","FRAB123456789"),new Ea.a("eu_vat gb","GB VAT United Kingdom","GB123456789"),new Ea.a("eu_vat el","GR VAT Greece","EL123456789"),new Ea.a("hk_br","HK BR Hong Kong","12345678"),new Ea.a("eu_vat hr","HR VAT Croatia","HR12345678912"),new Ea.a("eu_vat hu","HU VAT Hungary","HU12345678"),new Ea.a("id_npwp","ID NPWP Indonesia","12.345.678.9-012.345"),new Ea.a("eu_vat ie","IE VAT Ireland","IE1234567AB"),new Ea.a("in_gst","IN GST India","12ABCDE3456FGZH"),new Ea.a("eu_vat it","IT VAT Italy","IT12345678912"),new Ea.a("jp_cn","JP CN Japan","1234567891234"),new Ea.a("kr_brn","KR BRN South Korea","123-45-67890"),new Ea.a("li_uid","LI UID Liechtenstein","CHE123456789"),new Ea.a("eu_vat lt","LT VAT Lithuania","LT123456789123"),new Ea.a("eu_vat lu","LU VAT Luxembourg","LU12345678"),new Ea.a("eu_vat lv","LV VAT Latvia","LV12345678912"),new Ea.a("eu_vat mt","MT VAT Malta","MT12345678"),new Ea.a("mx_rfc","MX RFC Mexico","ABC010203AB9"),new Ea.a("my_frp","MY FRP Malaysia","12345678"),new Ea.a("my_itn","MY ITN Malaysia","C 1234567890"),new Ea.a("my_sst","MY SST Malaysia","A12-3456-78912345"),new Ea.a("eu_vat nl","NL VAT Netherlands","NL123456789B12"),new Ea.a("no_vat","NO VAT Norway","123456789MVA"),new Ea.a("nz_gst","NZ GST New Zealand","123456789"),new Ea.a("eu_vat pl","PL VAT Poland","PL1234567890"),new Ea.a("eu_vat pt","PT VAT Portugal","PT123456789"),new Ea.a("eu_vat ro","RO VAT Romania","RO1234567891"),new Ea.a("ru_inn","RU INN Russia","1234567891"),new Ea.a("sa_vat","SA VAT Saudi Arabia","123456789012345"),new Ea.a("eu_vat se","SE VAT Sweden","SE123456789123"),new Ea.a("sg_gst","SG GST Singapore","M12345678X"),new Ea.a("sg_uen","SG UEN Singapore","123456789F"),new Ea.a("eu_vat si","SI VAT Slovenia","SI12345678"),new Ea.a("eu_vat sk","SK VAT Slovakia","SK1234567891"),new Ea.a("th_vat","TH VAT Thailand","1234567891234"),new Ea.a("tw_vat","TW VAT Taiwan","12345678"),new Ea.a("us_ein","US EIN United States","12-3456789"),new Ea.a("za_vat","ZA VAT South Africa","4123456789")]}ngOnInit(){this.editInvoiceInformation.vatType||(this.editInvoiceInformation.vatType=null),this.editInvoiceInformation.vatType&&"eu_vat"===this.editInvoiceInformation.vatType&&(this.editInvoiceInformation.vatType=this.editInvoiceInformation.vatType+" "+this.editInvoiceInformation.vatNumber.substring(0,2).toLowerCase()),this.tax=this.editInvoiceInformation.vatType?this.taxes.filter(e=>e.value===this.editInvoiceInformation.vatType)[0]:null,this.informationGroup=this.formBuilder.group({email:["",[v.G.required,v.G.email]]}),this.editInvoiceInformation||(this.editInvoiceInformation=new Cw.a),this.editInvoiceInformation.companyName=this.editInvoiceInformation.companyName||this.workspaceName,this.editInvoiceInformation.address1&&(this.address=!0,this.turnAddress.emit(this.address))}get email(){return this.informationGroup.get("email")}save(){this.saveInfo.emit(!0)}close(){this.closeModal.emit()}next(){this.editInvoiceInformation.isCompanyNameEmpty()?this.toaster.pop("error",this.translateService.instant("GLOBAL.COMPANY_NAME_ERROR_MESSAGE")):this.editInvoiceInformation.isAddressEmpty(this.address)?this.toaster.pop("error",this.translateService.instant("GLOBAL.ADDRESS_FIELDS_ERROR_MESSAGE")):this.editInvoiceInformation.isVatEmpty()?this.toaster.pop("error",this.translateService.instant("SHARED_MODULES.STRIPE_INVOICE.MISSING_TAX_ID_ERROR_MESSAGE")):this.nextStep.emit(!0)}checkEmail(){this.mailBad=!Object(sn.A)(this.editInvoiceInformation.email)}removeAddress(){this.address=!1,this.editInvoiceInformation.address1=null,this.editInvoiceInformation.address2=null,this.editInvoiceInformation.city=null,this.editInvoiceInformation.country=null,this.editInvoiceInformation.state=null,this.editInvoiceInformation.zip=null,this.turnAddress.emit(this.address)}addAddress(){this.address=!0,this.turnAddress.emit(this.address)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(v.f),s.Rb(r.a),s.Rb(g.f),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["stripe-invoice"]],inputs:{mode:"mode",workspaceName:"workspaceName",editInvoiceInformation:"editInvoiceInformation"},outputs:{saveInfo:"saveInfo",closeModal:"closeModal",nextStep:"nextStep",turnAddress:"turnAddress"},decls:41,vars:34,consts:[[1,"cl-tab-pane","cl-active"],[1,"cl-py-2"],["class","cl-h1 cl-mb-3",4,"ngIf"],["autocomplete","off"],[1,"cl-form-row"],[1,"cl-form-group","cl-col-lg-custom-12"],[1,"cl-mb-1"],[1,"cl-text-gray-9"],["type","text","placeholder","","name","si_companyName","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","name","si_email","autocomplete","off",1,"cl-form-control",3,"placeholder","ngModel","blur","ngModelChange"],[1,"cl-form-group","cl-mb-0","cl-col-md-12"],[1,"cl-m-0","cl-mb-1"],[1,"cl-form-row","cl-align-items-center"],[1,"cl-form-group","cl-col-md-6"],[3,"list","value","onChangedDropdown","onChanged"],["class","cl-form-group cl-col-md-6",4,"ngIf"],["class","cl-form-row",4,"ngIf"],[4,"ngIf"],[1,"cl-h1","cl-mb-3"],["type","text","placeholder","","name","si_vat","autocomplete","off",1,"cl-form-control",3,"placeholder","ngModel","ngModelChange"],[3,"click"],["type","text","placeholder","","name","si_country","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","si_address1","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","si_address2","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","si_city","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","si_state","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","si_zip","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],[1,"cl-form-group","cl-mb-0","cl-col-lg-custom-12"],["type","submit",1,"cl-btn","cl-btn-block","cl-btn-primary",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xc(2,Ow,3,3,"div",2),s.Xb(3,"form",3),s.Xb(4,"div",4),s.Xb(5,"div",5),s.Xb(6,"label",6),s.Zc(7),s.oc(8,"translate"),s.Xb(9,"span",7),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Wb(),s.Xb(12,"input",8),s.jc("ngModelChange",(function(e){return t.editInvoiceInformation.companyName=e})),s.Wb(),s.Wb(),s.Wb(),s.Xb(13,"div",4),s.Xb(14,"div",5),s.Xb(15,"label",6),s.Zc(16),s.oc(17,"translate"),s.Xb(18,"span",7),s.Zc(19),s.oc(20,"lowercase"),s.oc(21,"translate"),s.Wb(),s.Wb(),s.Xb(22,"input",9),s.jc("blur",(function(){return t.checkEmail()}))("ngModelChange",(function(e){return t.editInvoiceInformation.email=e})),s.oc(23,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(24,"div",4),s.Xb(25,"div",10),s.Xb(26,"label",11),s.Zc(27),s.oc(28,"translate"),s.Xb(29,"span",7),s.Zc(30),s.oc(31,"lowercase"),s.oc(32,"translate"),s.Wb(),s.Wb(),s.Xb(33,"div",12),s.Xb(34,"div",13),s.Xb(35,"dropdown-items",14),s.jc("onChangedDropdown",(function(e){return t.tax=e}))("onChanged",(function(e){return t.editInvoiceInformation.vatType=e,t.editInvoiceInformation.vatNumber=null})),s.Wb(),s.Wb(),s.Xc(36,vw,2,2,"div",15),s.Wb(),s.Wb(),s.Wb(),s.Sb(37,"hr"),s.Xc(38,Tw,10,8,"div",16),s.Xc(39,Iw,66,50,"div",17),s.Xc(40,ww,5,3,"div",16),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.wc("ngIf","create"===t.mode),s.Cb(5),s.bd("",s.pc(8,16,"GLOBAL.COMPANY_NAME_LABEL")," "),s.Cb(3),s.ad(s.pc(11,18,"SHARED_MODULES.STRIPE.REQUIRED_LABEL")),s.Cb(2),s.wc("ngModel",t.editInvoiceInformation.companyName),s.Cb(4),s.bd("",s.pc(17,20,"GLOBAL.SEND_EMAIL_TO_LABEL")," "),s.Cb(3),s.bd("(",s.pc(20,22,s.pc(21,24,"INVOICES.SHARED.OPTIONAL")),")"),s.Cb(3),s.xc("placeholder",s.pc(23,26,"SHARED_MODULES.STRIPE.VALID_EMAIL_WARNING_PLACEHOLDER")),s.wc("ngModel",t.editInvoiceInformation.email),s.Cb(5),s.bd("",s.pc(28,28,"GLOBAL.TAX_ID_LABEL")," "),s.Cb(3),s.bd("(",s.pc(31,30,s.pc(32,32,"INVOICES.SHARED.OPTIONAL")),")"),s.Cb(5),s.wc("list",t.taxes)("value",t.editInvoiceInformation.vatType),s.Cb(1),s.wc("ngIf",null==t.tax?null:t.tax.value),s.Cb(2),s.wc("ngIf",!t.address),s.Cb(1),s.wc("ngIf",t.address),s.Cb(1),s.wc("ngIf","create"===t.mode))},directives:[i.u,v.I,v.t,v.u,v.c,v.s,v.v,ji.a],pipes:[g.e,i.q],encapsulation:2}),e})();var Rw=n("F2Zd");const yw=["authentication_required","approve_with_id","call_issuer","card_not_supported","card_velocity_exceeded","currency_not_supported","do_not_honor","do_not_try_again","duplicate_transaction","expired_card","fraudulent","generic_decline","incorrect_number","incorrect_cvc","incorrect_zip","insufficient_funds","invalid_account","invalid_amount","invalid_cvc","invalid_expiry_month","invalid_expiry_year","invalid_number","issuer_not_available","lost_card","merchant_blacklist","new_account_information_available","no_action_taken","not_permitted","pickup_card","processing_error","reenter_transaction","restricted_card","revocation_of_all_authorizations","revocation_of_authorization","security_violation","service_not_allowed","stolen_card","stop_payment_order","transaction_not_allowed","try_again_later","withdrawal_count_limit_exceeded","incomplete_number","incomplete_expiry","incomplete_cvc"];function _w(e,t){1&e&&(s.Xb(0,"div",29),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.PAYMENT_INFORMATION_TITLE")))}function kw(e,t){if(1&e&&(s.Xb(0,"div",30),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.ad(e.failMessage)}}function Ww(e,t){1&e&&(s.Xb(0,"div",32),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"SHARED_MODULES.STRIPE.CHARGING_EXPLANATION")," "))}function Xw(e,t){if(1&e&&(s.Xb(0,"div"),s.Xc(1,Ww,3,3,"div",31),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf","edit"===e.mode)}}function Nw(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",4),s.Xb(1,"div",5),s.Xb(2,"button",33),s.jc("click",(function(){return s.Oc(e),s.nc().createToken()})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.wc("disabled",e.disableButton||!e.agreement),s.Cb(1),s.bd(" ",s.pc(4,2,e.isPaymentInfo?"GLOBAL.SAVE_INFO_TITLE":"SHARED_MODULES.STRIPE.BTN_FINISH_PAYMENT")," ")}}function Dw(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",4),s.Xb(1,"div",34),s.Xb(2,"a",35),s.jc("click",(function(){return s.Oc(e),s.nc().close()})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(3),s.ad(s.pc(4,1,"GLOBAL.CANCEL_BTN")))}function Pw(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",36),s.Xb(1,"a",35),s.jc("click",(function(){return s.Oc(e),s.nc().close()})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",37),s.jc("click",(function(){return s.Oc(e),s.nc().createToken()})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,3,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",e.disableButton||!e.agreement),s.Cb(1),s.bd("",s.pc(6,5,"GLOBAL.SAVE_LABEL")," ")}}const Mw=function(){return{standalone:!0}};let Bw=(()=>{class e{constructor(e,t,n,i,c,a,o){this.fb=e,this.stripeService=t,this.paymentService=n,this.loader=i,this.renderer=c,this.toaster=a,this.translate=o,this.agreement=!1,this.mode="create",this.style={base:{iconColor:"#666EE8",color:Rw.h[Object(Rw.b)()].stripeTextColor,lineHeight:"40px",fontWeight:"300",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSize:"16px","::placeholder":{color:Rw.h[Object(Rw.b)()].placeholderInput}}},this.cardOptions={style:this.style},this.elementsOptions={locale:"auto"},this.closeDialog=new s.n,this.showSuccessDialog=new s.n,this.paid=new s.n,this.paymentInformation=new s.n,this.unsubscribe$=new Fn.a,bo.a.environment.stripePublicKey&&""!==bo.a.environment.stripePublicKey&&this.stripeService.changeKey(bo.a.environment.stripePublicKey)}ngOnInit(){this.editPaymentInformation?(this.editPaymentInformation.cardHolder=this.editPaymentInformation.cardHolder||this.invoiceInformation&&this.invoiceInformation.companyName,this.editPaymentInformation.street=this.editPaymentInformation.street||this.invoiceInformation&&this.invoiceInformation.address1,this.editPaymentInformation.zip=this.editPaymentInformation.zip||this.invoiceInformation&&this.invoiceInformation.zip,this.editPaymentInformation.state=this.editPaymentInformation.state||this.invoiceInformation&&this.invoiceInformation.state,this.editPaymentInformation.country=this.editPaymentInformation.country||this.invoiceInformation&&this.invoiceInformation.country,this.editPaymentInformation.city=this.editPaymentInformation.city||this.invoiceInformation&&this.invoiceInformation.city):this.editPaymentInformation=new Aw.a,this.stripeService.elements(this.elementsOptions).subscribe(e=>{this.elements=e,this.cardNumber||(this.cardNumber=this.elements.create("cardNumber",{showIcon:!0,style:this.style}),this.cardNumber.mount("#card-number")),this.cardExpiry||(this.cardExpiry=this.elements.create("cardExpiry",this.cardOptions),this.cardExpiry.mount("#card-expiry")),this.cardCvc||(this.cardCvc=this.elements.create("cardCvc",this.cardOptions),this.cardCvc.mount("#card-cvc"))})}set paymentFailedMessage(e){this.failMessage=e,this.failMessage&&(this.disableButton=!1)}createToken(){if(this.isSomeEmpty())this.disableButton=!1,this.toaster.pop("error",this.translate.instant("SHARED_MODULES.STRIPE.CREATE_TOKEN.ERROR_MSG"));else{this.loader.show(),this.renderer.addClass(document.getElementsByTagName("body")[0],"cl-loader-overlay"),this.disableButton=!0;const e=this.paymentService.createClientSecretOfSetupIntent(this.invoiceInformation);bo.a.environment.stripePublicKey&&""!=bo.a.environment.stripePublicKey?this.contactStripeAndConfirmCardSetup(e):this.emitPaymentTestInfo(e)}}contactStripeAndConfirmCardSetup(e){e.subscribe(e=>{this.createStripeToken().subscribe(t=>{t.error?(this.disableButton=!1,this.handleError(t)):this.confirmCardSetup(e,t).subscribe(e=>{e.error?this.handleError(e):(this.loader.hide(),this.paymentInformation.emit({id:t.token.id,cardExpMonth:t.token.card.exp_month,cardExpYear:t.token.card.exp_year,last4:t.token.card.last4,cardHolder:this.editPaymentInformation.cardHolder,street:this.editPaymentInformation.street,zip:this.editPaymentInformation.zip,country:this.editPaymentInformation.country,state:this.editPaymentInformation.state,city:this.editPaymentInformation.city}))})})},e=>this.handleError(e))}createStripeToken(){return this.stripeService.createToken(this.cardNumber,{name:this.editPaymentInformation.cardHolder,address_line1:this.editPaymentInformation.street,address_city:this.editPaymentInformation.city,address_state:this.editPaymentInformation.state,address_zip:this.editPaymentInformation.zip,address_country:this.editPaymentInformation.country})}confirmCardSetup(e,t){return this.stripeService.confirmCardSetup(e.clientSecret,{payment_method:{card:{token:t.token.id},billing_details:{name:this.editPaymentInformation.cardHolder}}})}emitPaymentTestInfo(e){e.subscribe(e=>{e.error?this.handleError(e):(this.loader.hide(),this.paymentInformation.emit({id:"id-1234",cardExpMonth:"12",cardExpYear:"2030",last4:"1111",cardHolder:this.editPaymentInformation.cardHolder,street:this.editPaymentInformation.street,zip:this.editPaymentInformation.zip,country:this.editPaymentInformation.country,state:this.editPaymentInformation.state,city:this.editPaymentInformation.city}))})}handleError(e){this.loader.hide(),this.renderer.removeClass(document.getElementsByTagName("body")[0],"cl-loader-overlay"),this.toaster.pop("error",this.getToastMessage(e.error))}getToastMessage(e){const t=e.code;return yw.includes(t)?this.translate.instant("SHARED_MODULES.STRIPE.ERROR."+t.toUpperCase()):e.message}isSomeEmpty(){return null==this.editPaymentInformation.cardHolder||null==this.editPaymentInformation.street||null==this.editPaymentInformation.zip||null==this.editPaymentInformation.country||null==this.editPaymentInformation.state||null==this.editPaymentInformation.city||""==this.editPaymentInformation.cardHolder.trim()||""==this.editPaymentInformation.street.trim()||""==this.editPaymentInformation.zip.trim()||""==this.editPaymentInformation.country.trim()||""==this.editPaymentInformation.state.trim()||""==this.editPaymentInformation.city.trim()}close(){this.closeDialog.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(v.f),s.Rb(ze.c),s.Rb(dC.a),s.Rb(Hn.a),s.Rb(s.F),s.Rb(r.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["stripe"]],viewQuery:function(e,t){var n;1&e&&s.gd(ze.b,!0),2&e&&s.Kc(n=s.kc())&&(t.card=n.first)},inputs:{editPaymentInformation:"editPaymentInformation",isMonthly:"isMonthly",invoiceInformation:"invoiceInformation",mode:"mode",isPaymentInfo:"isPaymentInfo",disableButton:"disableButton",paymentFailedMessage:"paymentFailedMessage"},outputs:{closeDialog:"closeDialog",showSuccessDialog:"showSuccessDialog",paid:"paid",paymentInformation:"paymentInformation"},decls:105,vars:83,consts:[[1,"cl-tab-pane","cl-active"],[1,"cl-py-2"],["class","cl-h1 cl-mb-3",4,"ngIf"],["autocomplete","off"],[1,"cl-form-row"],[1,"cl-form-group","cl-col-lg-custom-12"],["for","card-number"],[1,"cl-text-gray-9"],["id","card-number",1,"field"],["stripeCard",""],["class","cl-invalid-feedback cl-block",4,"ngIf"],[1,"cl-form-group","cl-col-lg-custom-6"],["id","card-expiry",1,"stripe__expiration","field"],["id","card-cvc",1,"stripe__cvc","field"],["type","text","placeholder","","name","s_cardHolder","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","s_street","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","s_city","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","s_zip","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","s_state","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","","name","s_country","autocomplete","off",1,"cl-form-control",3,"ngModel","ngModelChange"],[4,"ngIf"],[1,"cl-form-group","cl-col-lg-custom-12","cl-mt-1","cl-mb-3"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline"],["type","checkbox","id","agreementCheckbox",1,"cl-custom-control-input",3,"ngModel","ngModelOptions","ngModelChange"],["for","agreementCheckbox",1,"cl-custom-control-label"],[1,"cl-font-weight-bold"],[1,"cl-color-grey","cl-d-block"],["class","cl-form-row",4,"ngIf"],["class","cl-modal-footer",4,"ngIf"],[1,"cl-h1","cl-mb-3"],[1,"cl-invalid-feedback","cl-block"],["class","cl-alert cl-alert-primary cl-d-block",4,"ngIf"],[1,"cl-alert","cl-alert-primary","cl-d-block"],["type","submit",1,"cl-btn","cl-btn-block","cl-btn-primary",3,"disabled","click"],[1,"cl-form-group","cl-mb-0","cl-col-lg-custom-12","cl-text-center"],[1,"cl-color-blue",3,"click"],[1,"cl-modal-footer"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xc(2,_w,3,3,"div",2),s.Xb(3,"form",3),s.Xb(4,"div",4),s.Xb(5,"div",5),s.Xb(6,"label",6),s.Zc(7),s.oc(8,"translate"),s.Xb(9,"span",7),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Wb(),s.Sb(12,"div",8,9),s.Xc(14,kw,2,1,"div",10),s.Wb(),s.Wb(),s.Xb(15,"div",4),s.Xb(16,"div",11),s.Xb(17,"label"),s.Zc(18),s.oc(19,"translate"),s.Xb(20,"span",7),s.Zc(21),s.oc(22,"translate"),s.Wb(),s.Wb(),s.Sb(23,"div",12,9),s.Wb(),s.Xb(25,"div",11),s.Xb(26,"label"),s.Zc(27),s.oc(28,"translate"),s.Xb(29,"span",7),s.Zc(30),s.oc(31,"translate"),s.Wb(),s.Wb(),s.Sb(32,"div",13,9),s.Wb(),s.Wb(),s.Xb(34,"div",4),s.Xb(35,"div",5),s.Xb(36,"label"),s.Zc(37),s.oc(38,"translate"),s.Xb(39,"span",7),s.Zc(40),s.oc(41,"translate"),s.Wb(),s.Wb(),s.Xb(42,"input",14),s.jc("ngModelChange",(function(e){return t.editPaymentInformation.cardHolder=e})),s.Wb(),s.Wb(),s.Wb(),s.Xb(43,"div",4),s.Xb(44,"div",5),s.Xb(45,"label"),s.Zc(46),s.oc(47,"translate"),s.Xb(48,"span",7),s.Zc(49),s.oc(50,"translate"),s.Wb(),s.Wb(),s.Xb(51,"input",15),s.jc("ngModelChange",(function(e){return t.editPaymentInformation.street=e})),s.Wb(),s.Wb(),s.Wb(),s.Xb(52,"div",4),s.Xb(53,"div",5),s.Xb(54,"label"),s.Zc(55),s.oc(56,"translate"),s.Xb(57,"span",7),s.Zc(58),s.oc(59,"translate"),s.Wb(),s.Wb(),s.Xb(60,"input",16),s.jc("ngModelChange",(function(e){return t.editPaymentInformation.city=e})),s.Wb(),s.Wb(),s.Wb(),s.Xb(61,"div",4),s.Xb(62,"div",5),s.Xb(63,"label"),s.Zc(64),s.oc(65,"translate"),s.oc(66,"translate"),s.Xb(67,"span",7),s.Zc(68),s.oc(69,"translate"),s.Wb(),s.Wb(),s.Xb(70,"input",17),s.jc("ngModelChange",(function(e){return t.editPaymentInformation.zip=e})),s.Wb(),s.Wb(),s.Wb(),s.Xb(71,"div",4),s.Xb(72,"div",5),s.Xb(73,"label"),s.Zc(74),s.oc(75,"translate"),s.oc(76,"translate"),s.Xb(77,"span",7),s.Zc(78),s.oc(79,"translate"),s.Wb(),s.Wb(),s.Xb(80,"input",18),s.jc("ngModelChange",(function(e){return t.editPaymentInformation.state=e})),s.Wb(),s.Wb(),s.Wb(),s.Xb(81,"div",4),s.Xb(82,"div",5),s.Xb(83,"label"),s.Zc(84),s.oc(85,"translate"),s.Xb(86,"span",7),s.Zc(87),s.oc(88,"translate"),s.Wb(),s.Wb(),s.Xb(89,"input",19),s.jc("ngModelChange",(function(e){return t.editPaymentInformation.country=e})),s.Wb(),s.Wb(),s.Wb(),s.Xc(90,Xw,2,1,"div",20),s.Xb(91,"div",4),s.Xb(92,"div",21),s.Xb(93,"div",22),s.Xb(94,"input",23),s.jc("ngModelChange",(function(e){return t.agreement=e})),s.Wb(),s.Xb(95,"label",24),s.Xb(96,"span",25),s.Zc(97),s.oc(98,"translate"),s.Wb(),s.Xb(99,"span",26),s.Zc(100),s.oc(101,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(102,Nw,5,4,"div",27),s.Xc(103,Dw,5,3,"div",27),s.Wb(),s.Wb(),s.Wb(),s.Xc(104,Pw,7,7,"div",28)),2&e&&(s.Cb(2),s.wc("ngIf","create"===t.mode),s.Cb(5),s.bd("",s.pc(8,38,"SHARED_MODULES.STRIPE.LABEL_CARD_NUMBER")," "),s.Cb(3),s.bd("(",s.pc(11,40,"SHARED_MODULES.STRIPE.REQUIRED"),")"),s.Cb(2),s.Hb("cl-is-invalid",t.failMessage),s.Cb(2),s.wc("ngIf",t.failMessage),s.Cb(4),s.bd("",s.pc(19,42,"GLOBAL.LABEL_EXPIRATION_DATE")," "),s.Cb(3),s.bd("(",s.pc(22,44,"SHARED_MODULES.STRIPE.REQUIRED"),")"),s.Cb(6),s.bd("",s.pc(28,46,"SHARED_MODULES.STRIPE.LABEL_CVC")," "),s.Cb(3),s.bd("(",s.pc(31,48,"SHARED_MODULES.STRIPE.REQUIRED"),")"),s.Cb(7),s.bd("",s.pc(38,50,"SHARED_MODULES.STRIPE.LABEL_CARDHOLDER")," "),s.Cb(3),s.bd("(",s.pc(41,52,"SHARED_MODULES.STRIPE.REQUIRED"),")"),s.Cb(2),s.wc("ngModel",t.editPaymentInformation.cardHolder),s.Cb(4),s.bd("",s.pc(47,54,"GLOBAL.LABEL_STREET")," "),s.Cb(3),s.bd("(",s.pc(50,56,"SHARED_MODULES.STRIPE.REQUIRED"),")"),s.Cb(2),s.wc("ngModel",t.editPaymentInformation.street),s.Cb(4),s.bd("",s.pc(56,58,"GLOBAL.LABEL_CITY")," "),s.Cb(3),s.bd("(",s.pc(59,60,"SHARED_MODULES.STRIPE.REQUIRED"),")"),s.Cb(2),s.wc("ngModel",t.editPaymentInformation.city),s.Cb(4),s.cd("",s.pc(65,62,"GLOBAL.LABEL_ZIP")," / ",s.pc(66,64,"GLOBAL.LABEL_POSTAL")," "),s.Cb(4),s.bd("(",s.pc(69,66,"SHARED_MODULES.STRIPE.REQUIRED"),")"),s.Cb(2),s.wc("ngModel",t.editPaymentInformation.zip),s.Cb(4),s.cd("",s.pc(75,68,"GLOBAL.LABEL_STATE")," / ",s.pc(76,70,"GLOBAL.LABEL_PROVINCE")," "),s.Cb(4),s.bd("(",s.pc(79,72,"SHARED_MODULES.STRIPE.REQUIRED"),")"),s.Cb(2),s.wc("ngModel",t.editPaymentInformation.state),s.Cb(4),s.bd("",s.pc(85,74,"GLOBAL.LABEL_COUNTRY")," "),s.Cb(3),s.bd("(",s.pc(88,76,"SHARED_MODULES.STRIPE.REQUIRED"),")"),s.Cb(2),s.wc("ngModel",t.editPaymentInformation.country),s.Cb(1),s.wc("ngIf",!t.isPaymentInfo),s.Cb(4),s.wc("ngModel",t.agreement)("ngModelOptions",s.Ac(82,Mw)),s.Cb(3),s.ad(s.pc(98,78,"GLOBAL.TOS_READ")),s.Cb(3),s.ad(s.pc(101,80,"GLOBAL.REFUNDS_EXPLANATION")),s.Cb(2),s.wc("ngIf","create"===t.mode),s.Cb(1),s.wc("ngIf","create"===t.mode),s.Cb(1),s.wc("ngIf","edit"===t.mode))},directives:[i.u,v.I,v.t,v.u,v.c,v.s,v.v,v.a],pipes:[g.e],encapsulation:2}),e})();const Uw=["featuresInfoModal"],Gw=["successModal"];function xw(e,t){1&e&&(s.Zc(0),s.oc(1,"translate")),2&e&&s.bd(" ",s.pc(1,1,"PAGES.PAYMENT.PRICE.SEATS.MIN_MESSAGE")," ")}function Fw(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",46),s.Xb(1,"div",47),s.Xb(2,"span"),s.Zc(3),s.Wb(),s.Zc(4,"-"),s.Xb(5,"span"),s.Zc(6),s.Wb(),s.Wb(),s.Xb(7,"div",48),s.Xb(8,"span"),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Xb(11,"a",49),s.jc("click",(function(){return s.Oc(e),s.nc(2).openFeaturesInfo("user-seats")})),s.Sb(12,"img",50),s.Wb(),s.Xb(13,"div",51),s.Xb(14,"input",52),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc(2).numberOfSeats=t}))("ngModelChange",(function(t){return s.Oc(e),s.nc(2).seatsUpdated(t)}))("blur",(function(){return s.Oc(e),s.nc(2).onNumberOfSeatsBlur()})),s.Wb(),s.Xb(15,"div",53),s.Xc(16,xw,2,3,"ng-template",null,54,s.Yc),s.Xb(18,"span",55),s.jc("click",(function(){return s.Oc(e),s.nc(2).addSeat()})),s.Wb(),s.Xb(19,"span",56,57),s.jc("click",(function(){s.Oc(e);const t=s.Lc(20);return s.nc(2).removeSeat(t)})),s.Wb(),s.Wb(),s.Wb(),s.Xb(21,"span",58),s.Zc(22),s.Wb(),s.Xb(23,"div",59),s.Zc(24),s.oc(25,"number"),s.Wb(),s.Wb(),s.Sb(26,"hr"),s.Xb(27,"div",60),s.Xb(28,"span",61),s.Zc(29),s.oc(30,"translate"),s.Wb(),s.Xb(31,"div",61),s.Xb(32,"span"),s.Zc(33,"$"),s.Wb(),s.Zc(34),s.oc(35,"number"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.Lc(17),t=s.nc(2);s.Cb(3),s.ad(t.moment2().format("MMM DD").toUpperCase()),s.Cb(3),s.bd(" ",t.isMonthly?t.moment2().add(1,"months").format("MMM DD, YYYY").toUpperCase():t.moment2().add(1,"year").format("MMM DD, YYYY").toUpperCase()," "),s.Cb(3),s.ad(s.pc(10,12,"GLOBAL.USER_SEATS_TITLE")),s.Cb(5),s.xc("min",t.activeMembers),s.wc("ngModel",t.numberOfSeats),s.Cb(5),s.Hb("cl-arrow-disabled",t.numberOfSeats===t.activeMembers),s.wc("ngbPopover",e),s.Cb(3),s.bd("x $",t.isMonthly?t.paymentPlan.fullPrice:12*t.paymentPlan.fullPrice,""),s.Cb(2),s.bd(" $",s.qc(25,14,t.seatsPrice,"1.2-2")," "),s.Cb(5),s.ad(s.pc(30,17,"PAGES.PAYMENT.PRICE.TOTAL")),s.Cb(5),s.bd("",s.qc(35,19,t.seatsPrice,"1.2-2")," ")}}function jw(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",49),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(2).openFeaturesInfo(t.type)})),s.Sb(1,"img",50),s.Wb()}}function Zw(e,t){if(1&e&&(s.Xb(0,"li"),s.mc(),s.Xb(1,"svg",62),s.Sb(2,"path",63),s.Wb(),s.lc(),s.Xb(3,"span"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,jw,2,0,"a",64),s.Wb()),2&e){const e=t.$implicit;s.Cb(4),s.ad(s.pc(5,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function Vw(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",66),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(3).openFeaturesInfo(t.type)})),s.Sb(1,"img",67),s.Wb()}}function Yw(e,t){if(1&e&&(s.Xb(0,"li"),s.mc(),s.Xb(1,"svg",62),s.Sb(2,"path",63),s.Wb(),s.lc(),s.Xb(3,"span"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,Vw,2,0,"a",65),s.Wb()),2&e){const e=t.$implicit;s.Cb(4),s.ad(s.pc(5,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function Hw(e,t){if(1&e&&(s.Vb(0),s.Xc(1,Yw,7,4,"li",28),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngForOf",e.STANDARD_2021_FEATURE_TYPES)}}function $w(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",66),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(3).openFeaturesInfo(t.type)})),s.Sb(1,"img",67),s.Wb()}}function Kw(e,t){if(1&e&&(s.Xb(0,"li"),s.mc(),s.Xb(1,"svg",62),s.Sb(2,"path",63),s.Wb(),s.lc(),s.Xb(3,"span"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,$w,2,0,"a",65),s.Wb()),2&e){const e=t.$implicit;s.Cb(4),s.ad(s.pc(5,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function qw(e,t){if(1&e&&(s.Vb(0),s.Xc(1,Kw,7,4,"li",28),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngForOf",e.PRO_2021_FEATURE_TYPES)}}function zw(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",66),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(3).openFeaturesInfo(t.type)})),s.Sb(1,"img",67),s.Wb()}}function Qw(e,t){if(1&e&&(s.Xb(0,"li"),s.mc(),s.Xb(1,"svg",62),s.Sb(2,"path",63),s.Wb(),s.lc(),s.Xb(3,"span"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,zw,2,0,"a",65),s.Wb()),2&e){const e=t.$implicit;s.Cb(4),s.ad(s.pc(5,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function Jw(e,t){if(1&e&&(s.Vb(0),s.Xc(1,Qw,7,4,"li",28),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}function eL(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",66),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(3).openFeaturesInfo(t.type)})),s.Sb(1,"img",67),s.Wb()}}function tL(e,t){if(1&e&&(s.Xb(0,"li"),s.Sb(1,"img",69),s.Xb(2,"span"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xc(5,eL,2,0,"a",65),s.Wb()),2&e){const e=t.$implicit;s.Cb(3),s.ad(s.pc(4,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function nL(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",66),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(3).openFeaturesInfo(t.type)})),s.Sb(1,"img",67),s.Wb()}}function iL(e,t){if(1&e&&(s.Xb(0,"li"),s.Sb(1,"img",69),s.Xb(2,"span"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xc(5,nL,2,0,"a",65),s.Wb()),2&e){const e=t.$implicit;s.Cb(3),s.ad(s.pc(4,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function sL(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",66),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(3).openFeaturesInfo(t.type)})),s.Sb(1,"img",67),s.Wb()}}function cL(e,t){if(1&e&&(s.Xb(0,"li"),s.Sb(1,"img",69),s.Xb(2,"span"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xc(5,sL,2,0,"a",65),s.Wb()),2&e){const e=t.$implicit;s.Cb(3),s.ad(s.pc(4,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function aL(e,t){if(1&e&&(s.Xb(0,"ul",27),s.Xc(1,tL,6,4,"li",28),s.Xb(2,"div",68),s.Xc(3,iL,6,4,"li",28),s.Wb(),s.Xb(4,"div",68),s.Xc(5,cL,6,4,"li",28),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngForOf",e.STANDARD_2021_FEATURE_TYPES),s.Cb(2),s.wc("ngForOf",e.PRO_2021_FEATURE_TYPES),s.Cb(2),s.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}function oL(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",66),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(3).openFeaturesInfo(t.type)})),s.Sb(1,"img",67),s.Wb()}}function rL(e,t){if(1&e&&(s.Xb(0,"li"),s.Sb(1,"img",69),s.Xb(2,"span"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xc(5,oL,2,0,"a",65),s.Wb()),2&e){const e=t.$implicit;s.Cb(3),s.ad(s.pc(4,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function lL(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",66),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(3).openFeaturesInfo(t.type)})),s.Sb(1,"img",67),s.Wb()}}function bL(e,t){if(1&e&&(s.Xb(0,"li"),s.Sb(1,"img",69),s.Xb(2,"span"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xc(5,lL,2,0,"a",65),s.Wb()),2&e){const e=t.$implicit;s.Cb(3),s.ad(s.pc(4,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function dL(e,t){if(1&e&&(s.Xb(0,"ul",70),s.Xc(1,rL,6,4,"li",28),s.Xb(2,"div",68),s.Xc(3,bL,6,4,"li",28),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngForOf",e.PRO_2021_FEATURE_TYPES),s.Cb(2),s.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}function uL(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",66),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(3).openFeaturesInfo(t.type)})),s.Sb(1,"img",67),s.Wb()}}function pL(e,t){if(1&e&&(s.Xb(0,"li"),s.Sb(1,"img",69),s.Xb(2,"span"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xc(5,uL,2,0,"a",65),s.Wb()),2&e){const e=t.$implicit;s.Cb(3),s.ad(s.pc(4,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function hL(e,t){if(1&e&&(s.Xb(0,"ul",70),s.Xc(1,pL,6,4,"li",28),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}function mL(e,t){1&e&&s.Sb(0,"img",71)}function gL(e,t){if(1&e){const e=s.Yb();s.Xb(0,"stripe-invoice",72),s.jc("turnAddress",(function(t){return s.Oc(e),s.nc(2).addressOn=t}))("nextStep",(function(){return s.Oc(e),s.nc(2).toggleInformation(!0)})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("editInvoiceInformation",e.invoiceInformation)("workspaceName",e.workspace.name)}}function EL(e,t){if(1&e){const e=s.Yb();s.Xb(0,"stripe",73),s.jc("paymentInformation",(function(t){return s.Oc(e),s.nc(2).getPaymentInformation(t)}))("closeDialog",(function(){return s.Oc(e),s.nc(2).toggleInformation(!1)})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("disableButton",e.disableButton)("invoiceInformation",e.invoiceInformation)("paymentFailedMessage",e.paymentFailedMessage)("isMonthly",e.isMonthly)}}const fL=function(e){return{value:e}};function SL(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",3),s.Xb(1,"div",4),s.Xb(2,"div",5),s.Xb(3,"div",6),s.Xb(4,"div",7),s.Xb(5,"div",8),s.Xb(6,"div",9),s.Xb(7,"div",10),s.Xb(8,"label",11),s.jc("click",(function(){return s.Oc(e),s.nc().changeToMonthly(!0)})),s.Sb(9,"input",12),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Xb(12,"label",13),s.jc("click",(function(){return s.Oc(e),s.nc().changeToMonthly(!1)})),s.Sb(13,"input",12),s.Zc(14),s.oc(15,"translate"),s.Xb(16,"span",14),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(19,"div",15),s.Xb(20,"span",16),s.Zc(21),s.oc(22,"translate"),s.Xb(23,"span",17),s.Zc(24),s.oc(25,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(26,"div",18),s.Xb(27,"div",19),s.Xb(28,"div",20),s.Xb(29,"span",21),s.Zc(30,"$"),s.Wb(),s.Xb(31,"span",22),s.Zc(32),s.Wb(),s.Xb(33,"span",23),s.Zc(34),s.Wb(),s.Wb(),s.Xb(35,"div"),s.Xb(36,"div",24),s.Zc(37),s.oc(38,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xc(39,Fw,36,22,"div",25),s.Xb(40,"div",26),s.Xb(41,"ul",27),s.Xc(42,Zw,7,4,"li",28),s.Xc(43,Hw,2,1,"ng-container",29),s.Xc(44,qw,2,1,"ng-container",29),s.Xc(45,Jw,2,1,"ng-container",29),s.Wb(),s.Sb(46,"hr"),s.Xc(47,aL,6,3,"ul",30),s.Xc(48,dL,4,2,"ul",31),s.Xc(49,hL,2,1,"ul",31),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(50,"div",32),s.Xb(51,"div",33),s.Xb(52,"div",34),s.Xb(53,"div",35),s.Xb(54,"div",34),s.Xb(55,"div",36),s.Xb(56,"ul",37),s.Xb(57,"li",38),s.Xb(58,"a",39),s.jc("click",(function(){return s.Oc(e),s.nc().toggleInformation(!1)})),s.Xb(59,"div",40),s.Zc(60),s.oc(61,"translate"),s.Xc(62,mL,1,0,"img",41),s.Wb(),s.Xb(63,"div",42),s.Zc(64),s.oc(65,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(66,"li",38),s.Xb(67,"a",39),s.jc("click",(function(){return s.Oc(e),s.nc().toggleInformation(!0)})),s.Xb(68,"div",40),s.Zc(69),s.oc(70,"translate"),s.Wb(),s.Xb(71,"div",42),s.Zc(72),s.oc(73,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(74,"div",43),s.Xc(75,gL,1,2,"stripe-invoice",44),s.Xc(76,EL,1,4,"stripe",45),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(4),s.wc("ngClass","cl-parent-"+e.paymentPlan.color),s.Cb(4),s.Hb("cl-active",e.isMonthly),s.Cb(2),s.bd("",s.pc(11,33,"GLOBAL.MONTHLY_BILLING_LABEL")," "),s.Cb(2),s.Hb("cl-active",!e.isMonthly),s.Cb(2),s.ad(s.pc(15,35,"GLOBAL.ANNUAL_BILLING_LABEL")),s.Cb(3),s.ad(s.pc(18,37,"GLOBAL.BILLING_SAVE")),s.Cb(4),s.cd("",e.paymentPlan.title," ",s.pc(22,39,"GLOBAL.UPGRADE_BTN")," "),s.Cb(3),s.bd(" ",s.qc(25,41,"PAGES.FEATURES.FOR_WORKSPACE",s.Bc(54,fL,e.workspace.name)),""),s.Cb(8),s.ad(e.paymentPlan.price),s.Cb(2),s.ad("."+e.paymentPlan.fullPrice.toString().split(".")[1]),s.Cb(3),s.ad(s.pc(38,44,"PAGES.PAYMENT.PRICE.PER")),s.Cb(2),s.wc("ngIf",null==e.paymentPlan?null:e.paymentPlan.bySeat),s.Cb(3),s.wc("ngForOf",e.BASIC_2021_FEATURE_TYPES),s.Cb(1),s.wc("ngIf",e.isStandard(e.paymentPlan.value)||e.isPro(e.paymentPlan.value)||e.isEnterprise(e.paymentPlan.value)),s.Cb(1),s.wc("ngIf",e.isPro(e.paymentPlan.value)||e.isEnterprise(e.paymentPlan.value)),s.Cb(1),s.wc("ngIf",e.isEnterprise(e.paymentPlan.value)),s.Cb(2),s.wc("ngIf",e.isBasic(e.paymentPlan.value)),s.Cb(1),s.wc("ngIf",e.isStandard(e.paymentPlan.value)),s.Cb(1),s.wc("ngIf",e.isPro(e.paymentPlan.value)),s.Cb(9),s.Hb("cl-active",!e.isPayment),s.Cb(2),s.bd(" ",s.pc(61,46,"GLOBAL.STEP_1_TITLE")," "),s.Cb(2),s.wc("ngIf",e.isPayment),s.Cb(2),s.ad(s.pc(65,48,"GLOBAL.INVOICE_EXPLANATION")),s.Cb(3),s.Hb("cl-active",e.isPayment),s.Cb(2),s.ad(s.pc(70,50,"GLOBAL.STEP_2_TITLE")),s.Cb(3),s.ad(s.pc(73,52,"GLOBAL.PAYMENT_INFORMATION_TITLE")),s.Cb(3),s.wc("ngIf",!e.isPayment),s.Cb(1),s.wc("ngIf",e.isPayment)}}function CL(e,t){if(1&e&&(s.Xb(0,"features-info",74),s.jc("close",(function(){return t.$implicit.close()})),s.Wb()),2&e){const e=s.nc();s.wc("type",e.featuresInfoType)}}function AL(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",83),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit,n=s.nc();return t.close(),n.goToSubscription()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.GO_TO_SUBSCRIPTION_LABEL")," "))}function OL(e,t){if(1&e&&(s.Xb(0,"div",75),s.Xb(1,"div",76),s.Sb(2,"img",77),s.Wb(),s.Xb(3,"div",78),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"p",79),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Xb(9,"div",80),s.Xb(10,"a",81),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xc(13,AL,3,3,"a",82),s.Wb()),2&e){const e=s.nc();s.Cb(4),s.ad(s.pc(5,4,"GLOBAL.SUCCESS_MSG")),s.Cb(3),s.bd(" ",s.qc(8,6,"PAGES.FEATURES.SUBSCRIPTION.ACTIVE",s.Bc(11,fL,e.workspace.name))," "),s.Cb(4),s.ad(s.pc(12,9,"GLOBAL.CLOSE_BTN")),s.Cb(2),s.wc("ngIf",e.workspaceIsRefreshed)}}let vL=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r){this.activatedRoute=e,this.router=t,this.loader=n,this.workspaceService=i,this.modalService=s,this.paymentService=c,this.toaster=a,this.translateService=o,this.analyticsService=r,this.unsubscribe$=new p.a,this.invoiceInformation=new Cw.a,this.paymentInformation=new Aw.a,this.isBasic=mo.d,this.isStandard=mo.l,this.isPro=mo.k,this.isEnterprise=mo.f,this.numberOfSeats=0,this.moment2=ke,this.BASIC_2021_FEATURE_TYPES=gC,this.STANDARD_2021_FEATURE_TYPES=fC,this.PRO_2021_FEATURE_TYPES=CC,this.ENTERPRISE_2021_FEATURE_TYPES=OC}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.activatedRoute.queryParams.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{e&&Object(mo.c)(e.plan)&&Object(mo.c)(e.plan)!=mo.a.FREE?(this.paymentPlan=Object(mo.c)(e.plan),this.isMonthly=Object(mo.h)(this.paymentPlan.value),this.getActiveMembersCount()):this.router.navigate(["/upgrade"])})}toggleInformation(e){var t,n,i,s,c;this.invoiceInformation.isCompanyNameEmpty()?this.toaster.pop("error",this.translateService.instant("GLOBAL.COMPANY_NAME_ERROR_MESSAGE")):this.invoiceInformation.isAddressEmpty(this.addressOn)?this.toaster.pop("error",this.translateService.instant("GLOBAL.ADDRESS_FIELDS_ERROR_MESSAGE")):this.invoiceInformation.isVatEmpty()?this.toaster.pop("error",this.translateService.instant("GLOBAL.VAT_ERROR_MESSAGE")):(window.scrollTo(0,0),e&&(this.analyticsService.addEvent(new Fi.a({event:"submit",value:mo.h?"Monthly":"Anual",amount:this.numberOfSeats,section:"Subscription",section2:"New Subscription",section3:"Step 1"})),this.analyticsService.addEvent(new Fi.a({event:"add_shipping_info",ecommerce:{transaction_id:null===(t=this.paymentPlan)||void 0===t?void 0:t.value,action:(null===(n=this.paymentPlan)||void 0===n?void 0:n.button.includes("DOWNGRADE"))?"downgrade":"upgrade",value:this.seatsPrice,currency:"USD",items:[{index:null===(i=this.paymentPlan)||void 0===i?void 0:i.index,item_name:null===(s=this.paymentPlan)||void 0===s?void 0:s.value,price:null===(c=this.paymentPlan)||void 0===c?void 0:c.fullPrice,quantity:this.numberOfSeats}]}}))),this.isPayment=e)}openFeaturesInfo(e){this.modalService.open(this.featuresInfoModal,{size:"lg",centered:!0}),this.featuresInfoType=e}goToUpgrade(){this.router.navigate(["/upgrade"])}changeToMonthly(e){let t=this.paymentPlan.label.split("_2021")[0];t=e?t.split("_YEAR")[0]:t.includes("_YEAR")?t:t.concat("_YEAR"),t=t.concat("_2021"),this.router.navigate(["upgrade",this.workspace.id],{queryParams:{plan:t}})}getPaymentInformation(e){this.paymentInformation=e,this.pay()}pay(){var e,t,n,i,s;this.analyticsService.addEvent(new Fi.a({event:"add_payment_info",ecommerce:{transaction_id:null===(e=this.paymentPlan)||void 0===e?void 0:e.value,action:(null===(t=this.paymentPlan)||void 0===t?void 0:t.button.includes("DOWNGRADE"))?"downgrade":"upgrade",value:this.seatsPrice,currency:"USD",items:[{index:null===(n=this.paymentPlan)||void 0===n?void 0:n.index,item_name:null===(i=this.paymentPlan)||void 0===i?void 0:i.value,price:null===(s=this.paymentPlan)||void 0===s?void 0:s.fullPrice,quantity:this.numberOfSeats}]}})),this.disableButton=!0,this.loader.show("GLOBAL.PROCESSING_PAYMENT_MESSAGE_TITLE"),this.paymentFailedMessage=void 0,this.paymentService.chargeCard(this.paymentInformation,this.numberOfSeats,this.paymentPlan.value).subscribe(()=>{var e,t,n,i,s,c,a,o;this.disableButton=!1,this.loader.hide(),this.modalService.open(this.successModal,{centered:!0});const r=mo.a[this.workspace.featureSubscriptionType];(null==r?void 0:r.title)!==this.paymentPlan.title&&this.analyticsService.addEvent(new Fi.a(!r||(null==r?void 0:r.weight)<this.paymentPlan.weight?{event:"purchase",value:"purchase",uevent:"purchase",ecommerce:{transaction_id:null===(e=this.paymentPlan)||void 0===e?void 0:e.value,action:"upgrade",value:this.seatsPrice,currency:"USD",items:[{index:null===(t=this.paymentPlan)||void 0===t?void 0:t.index,item_name:null===(n=this.paymentPlan)||void 0===n?void 0:n.value,price:null===(i=this.paymentPlan)||void 0===i?void 0:i.fullPrice,quantity:this.numberOfSeats}]}}:{event:"refund",value:"refund",uevent:"refund",ecommerce:{transaction_id:null===(s=this.paymentPlan)||void 0===s?void 0:s.value,action:"downgrade",value:(null==r?void 0:r.fullPrice)-this.seatsPrice,currency:"USD",items:[{index:null===(c=this.paymentPlan)||void 0===c?void 0:c.index,item_name:null===(a=this.paymentPlan)||void 0===a?void 0:a.value,price:null===(o=this.paymentPlan)||void 0===o?void 0:o.fullPrice,quantity:this.numberOfSeats}]}})),this.onPaymentSuccess()},e=>{this.disableButton=!1,this.loader.hide(),this.paymentFailedMessage=e.error.message})}onPaymentSuccess(){this.loader.showBar();const e=this.workspaceService.getPaymentDate(),t=this.workspaceService.getDefaultWorkspace();Object(Sb.a)(e,t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.workspaceIsRefreshed=!0,this.loader.hideBar()},()=>this.loader.hideBar())}goToSubscription(){this.router.navigate(["subscription"],{fragment:"payment"})}closeSuccess(){this.router.navigate(["workspaces",this.workspace.id,"settings"],{fragment:"subscription"})}setTotalPrice(){this.numberOfSeats<-1&&(this.numberOfSeats=0),this.seatsPrice=this.numberOfSeats*this.paymentPlan.fullPrice,this.isMonthly||(this.seatsPrice=12*this.seatsPrice)}addSeat(){this.numberOfSeats++,this.setTotalPrice()}removeSeat(e){this.numberOfSeats<=this.activeMembers?e.isOpen()?e.close():e.open():(this.numberOfSeats--,this.setTotalPrice())}seatsUpdated(e){this.numberOfSeats=e,this.setTotalPrice()}onNumberOfSeatsBlur(){this.numberOfSeats<this.activeMembers&&(this.numberOfSeats=this.activeMembers,this.setTotalPrice())}getActiveMembersCount(){this.workspaceService.getActiveMembersCount().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{var t,n,i,s;this.activeMembers=e.activeMembersCount,this.numberOfSeats=this.activeMembers,this.setTotalPrice();const c=new Fi.a({event:"begin_checkout",uevent:"begin_checkout",value:"begin_checkout",ecommerce:{transaction_id:null===(t=this.paymentPlan)||void 0===t?void 0:t.value,action:"upgrade",value:this.seatsPrice,currency:"USD",items:[{index:null===(n=this.paymentPlan)||void 0===n?void 0:n.index,item_name:null===(i=this.paymentPlan)||void 0===i?void 0:i.value,price:null===(s=this.paymentPlan)||void 0===s?void 0:s.fullPrice,quantity:this.activeMembers}]}});this.analyticsService.addEvent(c)})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.a),s.Rb(k.d),s.Rb(Hn.a),s.Rb(l.a),s.Rb(w.q),s.Rb(dC.a),s.Rb(r.a),s.Rb(g.f),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["payment"]],viewQuery:function(e,t){var n;1&e&&(s.gd(Uw,!0),s.gd(Gw,!0)),2&e&&(s.Kc(n=s.kc())&&(t.featuresInfoModal=n.first),s.Kc(n=s.kc())&&(t.successModal=n.first))},decls:5,vars:1,consts:[["class","cl-page-wrapper",4,"ngIf"],["featuresInfoModal",""],["successModal",""],[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-upgrade-wrapper"],[1,"cl-row","upgrade-row"],[1,"cl-col-lg-custom-4","cl-upgrade-col","cl-mb-2","cl-mb-lg-custom-0",3,"ngClass"],[1,"cl-card","cl-h-100","cl-border-bottom"],[1,"cl-p-3","cl-pb-0"],["data-toggle","buttons",1,"cl-btn-group","cl-btn-group-toggle","cl-w-100"],[1,"cl-btn","cl-btn-outline-light","cl-d-flex","cl-align-items-center","cl-justify-content-center","cl-hover-pointer",3,"click"],["type","radio"],[1,"cl-btn","cl-btn-outline-light","cl-d-flex","cl-align-items-center","cl-justify-content-center","cl-hover-pointer","cl-active",3,"click"],[1,"cl-badge","cl-badge-success","cl-ml-2"],[1,"cl-card-header","cl-border-0","cl-bg-transparent","cl-pt-2"],[1,"cl-font-weight-normal","cl-h2","cl-mb-0","cl-text-color"],[1,"cl-text-gray-6","cl-text-break"],[1,"cl-card-body","cl-pb-0","cl-px-3"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-d-flex","cl-align-items-start","cl-mr-2"],[1,"cl-mr-1"],[1,"cl-display-1","cl-lh-1","cl-mb-0","cl-text-gray-3"],[1,"cl-align-self-end"],[1,"cl-text-gray-6","cl-small","cl-lh-1"],["class","cl-border cl-rounded cl-p-3 cl-mt-3",4,"ngIf"],[1,"cl-d-none","cl-d-lg-custom-block","cl-mt-3"],[1,"cl-list-unstyled","cl-add-lh"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","cl-list-unstyled cl-add-lh",4,"ngIf"],["class","cl-list-unstyled cl-add-lh cl-ml-0",4,"ngIf"],[1,"cl-col-lg-custom-8","cl-upgrade-col"],[1,"cl-h-100","cl-pt-2","cl-px-3","cl-pb-3","cl-bg-white","cl-border","cl-rounded"],[1,"cl-row"],[1,"cl-col-lg-custom-8","cl-col-xl-custom-6"],[1,"cl-col-lg-custom-12"],["id","myTab","role","tablist",1,"cl-nav","cl-nav-tabs","cl-custom-tabs-minimal","cl-mb-2"],[1,"cl-nav-item","cl-flex-grow-1"],[1,"cl-nav-link","cl-pl-0","cl-text-left",3,"click"],[1,"cl-h5","cl-mb-0"],["src","/assets/images/ui-icons/checkmark-green.svg","class","cl-ml-2",4,"ngIf"],[1,"cl-lowercase"],[1,"cl-tab-content"],[3,"editInvoiceInformation","workspaceName","turnAddress","nextStep",4,"ngIf"],[3,"disableButton","invoiceInformation","paymentFailedMessage","isMonthly","paymentInformation","closeDialog",4,"ngIf"],[1,"cl-border","cl-rounded","cl-p-3","cl-mt-3"],[1,"cl-h5"],[1,"cl-d-flex","cl-align-items-center","cl-input-no-arrow"],["data-toggle","modal","data-target","#modal-template-info",1,"cl-ml-1","cl-d-inline-flex",3,"click"],["src","/assets/images/ui-icons/info-9.svg"],[1,"cl-ml-3","cl-d-flex","cl-mr-2","cl-border"],["type","number",1,"cl-input-5-digits","cl-form-control","cl-border-0",3,"min","ngModel","ngModelChange","blur"],[1,"cl-d-flex","cl-flex-column","cl-pr-2"],["popContent",""],[1,"cl-arrow-up","cl-hover-pointer",3,"click"],["triggers","manual","placement","right","container","body",1,"cl-arrow-down","cl-hover-pointer",3,"ngbPopover","click"],["featurePopover","ngbPopover"],[1,"cl-mr-2"],[1,"cl-ml-auto"],[1,"cl-d-flex","cl-justify-content-between"],[1,"cl-h2","cl-mb-0"],["viewBox","0 0 15 13","fill","none",1,"cl-checkmark-svg","cl-mr-1","cl-dynamic-color"],["d","M13 2L5.47368 10L2 6.30769"],["class","cl-ml-1 cl-d-inline-flex","data-toggle","modal","data-target","#modal-template-info",3,"click",4,"ngIf"],["class","cl-ml-1 cl-d-inline-flex",3,"click",4,"ngIf"],[1,"cl-ml-1","cl-d-inline-flex",3,"click"],["src","assets/ui-icons/info-9.svg"],[1,"cl-mt-3"],["src","assets/ui-icons/cross.svg",1,"cl-mr-1"],[1,"cl-list-unstyled","cl-add-lh","cl-ml-0"],["src","/assets/images/ui-icons/checkmark-green.svg",1,"cl-ml-2"],[3,"editInvoiceInformation","workspaceName","turnAddress","nextStep"],[3,"disableButton","invoiceInformation","paymentFailedMessage","isMonthly","paymentInformation","closeDialog"],[3,"type","close"],[1,"cl-modal-body","cl-text-center","cl-py-4"],[1,"cl-mb-3"],["src","assets/images/illustrations/success.svg",1,"cl-img-fluid"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-mb-0","cl-text-gray-6","cl-text-break"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["class","cl-btn cl-btn-primary","ngbAutofocus","",3,"click",4,"ngIf"],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"]],template:function(e,t){1&e&&(s.Xc(0,SL,77,56,"div",0),s.Xc(1,CL,1,1,"ng-template",null,1,s.Yc),s.Xc(3,OL,14,13,"ng-template",null,2,s.Yc)),2&e&&s.wc("ngIf",t.paymentPlan)},directives:[i.u,i.r,i.t,v.y,v.c,v.s,v.v,w.M,Lw,Bw,BC],pipes:[g.e,i.g],encapsulation:2}),e})();var TL=n("awBr"),IL=n("z1wq");class wL{constructor(e){this.projectId=e&&e.project,this.taskId=e&&e.task}}var LL=n("npmQ"),RL=n("O3o7"),yL=n("tnjF");class _L{constructor(e,t,n){this.date=e,this.project=t,this.task=n}toJson(){var e,t;return{date:this.date,project:{id:this.project.id,name:this.project.name,billable:this.project.billable,color:this.project.color,clientId:this.project.clientId||(null===(e=this.project.client)||void 0===e?void 0:e.id),clientName:this.project.clientName||(null===(t=this.project.client)||void 0===t?void 0:t.name),favorite:this.project.favorite,archived:this.project.archived},task:this.task?this.task.toJson():null}}}var kL=n("6qRu"),WL=n("ePBx"),XL=n("wkZx"),NL=n("+yX9"),DL=n("MjqS"),PL=n("oTlO"),ML=n("btz8"),BL=n("3QTq");const UL=["timeDurationInput"];function GL(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",3),s.jc("click",(function(){return s.Oc(e),s.nc().openEditModal()})),s.Sb(1,"img",4),s.Wb()}if(2&e){const e=s.nc();s.Wc("cursor",e.disabled?"not-allowed":"pointer")}}let xL=(()=>{class e{constructor(){this.durationChanged=new s.n,this.onFocus=new s.n,this.openModalEmitter=new s.n}set initialValue(e){this._initialValue=e,this.format&&this.initData()}get initialValue(){return this._initialValue}ngOnInit(){this.initData()}initData(){this.timeEntryDurationInput=this.initialValue,this.timeEntryDurationBackup=this.timeEntryDurationInput||""}addFromTimeDurationInput(){this.timeEntryDurationInput=this.timeEntryDurationInput.trim();const e=Object(BL.c)(this.timeEntryDurationInput,this.format),t=Object(BL.a)(this.timeEntryDurationInput,this.format);e||!this.timeEntryDurationInput?(this.timeEntryDurationInput="00:00:00"!==e&&"00:00"!==e&&e?e:"",this.timeEntryDurationInput!==this.timeEntryDurationBackup&&this.durationChanged.emit(t.toString()),this.timeEntryDurationBackup=this.timeEntryDurationInput):this.timeEntryDurationInput=this.timeEntryDurationBackup}focusInput(){this.timeDurationInput.nativeElement.focus()}openEditModal(){this.disabled||(this.timeDurationInput.nativeElement.blur(),this.openModalEmitter.emit(!0))}inputFocused(){this.disabled?this.timeDurationInput.nativeElement.blur():this.onFocus.emit(this.timeDurationInput)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["time-duration"]],viewQuery:function(e,t){var n;1&e&&s.gd(UL,!0),2&e&&s.Kc(n=s.kc())&&(t.timeDurationInput=n.first)},inputs:{initialValue:["duration","initialValue"],disabled:"disabled",disabledText:"disabledText",showOptions:"showOptions",hasEntries:"hasEntries",format:"format",isDesktop:"isDesktop"},outputs:{durationChanged:"durationChanged",onFocus:"onFocus",openModalEmitter:"openModalEmitter"},decls:3,vars:7,consts:[["type","text","autocomplete","off","placement","left",1,"cl-form-control","cl-form-control-sm","cl-timesheet-input",3,"ngModel","ngbTooltip","ngModelChange","change","focus","keyup.enter"],["timeDurationInput",""],["class","cl-input-dots",3,"cursor","click",4,"ngIf"],[1,"cl-input-dots",3,"click"],["src","assets/images/ui-icons/input-dots-menu.svg"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"input",0,1),s.jc("ngModelChange",(function(e){return t.timeEntryDurationInput=e}))("change",(function(){return t.addFromTimeDurationInput()}))("focus",(function(){return t.inputFocused()}))("keyup.enter",(function(){return s.Oc(e),s.Lc(1).blur()})),s.Wb(),s.Xc(2,GL,2,2,"a",2)}2&e&&(s.Hb("cl-timesheet-show-dots",t.hasEntries||!t.isDesktop)("cl-disabled-not-allowed",t.disabled),s.wc("ngModel",t.timeEntryDurationInput)("ngbTooltip",t.disabled?t.disabledText:""),s.Cb(2),s.wc("ngIf",t.hasEntries||!t.isDesktop))},directives:[v.c,v.s,v.v,w.bb,i.u],encapsulation:2,changeDetection:0}),e})();var FL=n("soCN"),jL=n("Kdc/"),ZL=n("MXpx");const VL=["pickerDropdown"],YL=["timeDuration"];function HL(e,t){1&e&&(s.Xb(0,"span"),s.Zc(1,": "),s.Wb())}function $L(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.ad(e.timesheetRow.task.name)}}function KL(e,t){if(1&e&&(s.Vb(0),s.Sb(1,"span",12),s.Xb(2,"span",13),s.Zc(3),s.Wb(),s.Ub()),2&e){const e=s.nc(2);s.Cb(3),s.bd(" ",e.timesheetRow.project.clientName||e.timesheetRow.project.client.name," ")}}function qL(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"span"),s.Sb(2,"i",11),s.Zc(3),s.Wb(),s.Xc(4,HL,2,0,"span",8),s.Xc(5,$L,2,1,"span",8),s.Xc(6,KL,4,1,"ng-container",8),s.Ub()),2&e){const e=s.nc();s.Cb(2),s.Wc("background",e.timesheetRow.project.color,s.Kb),s.Cb(1),s.ad(e.timesheetRow.project.name),s.Cb(1),s.wc("ngIf",null==e.timesheetRow.task?null:e.timesheetRow.task.id),s.Cb(1),s.wc("ngIf",e.timesheetRow.task),s.Cb(1),s.wc("ngIf",e.timesheetRow.project.clientName||(null==e.timesheetRow.project.client?null:e.timesheetRow.project.client.name))}}function zL(e,t){if(1&e&&(s.Sb(0,"img",14),s.Xb(1,"span",15),s.Zc(2),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(e.projectPickerTrigger)}}function QL(e,t){if(1&e){const e=s.Yb();s.Xb(0,"project-picker",16,17),s.jc("selectedProjectAndTask",(function(t){return s.Oc(e),s.nc().selectProjectAndTask(t)}))("dropdownClosed",(function(){return s.Oc(e),s.nc().focusFirstInput()}))("onResize",(function(t){return s.Oc(e),s.Lc(1).onResizeChange(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("timesheetRows",e.timesheetRows)("hideWorkspaces",!0)("selectedUserId",null==e.selectedUser?null:e.selectedUser.id)}}function JL(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"span",18),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.isExpanded=!t.isExpanded})),s.Zc(2),s.oc(3,"sumDurations"),s.Wb(),s.Xb(4,"a",19),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.isExpanded=!t.isExpanded})),s.Xb(5,"span",20),s.Sb(6,"img",21),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.qc(3,2,e.timesheetRow.durationsByDay,e.format)),s.Cb(4),s.wc("src",e.isExpanded?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",s.Qc)}}function eR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",22),s.jc("click",(function(){return s.Oc(e),s.nc().delete.emit(!0)})),s.Sb(1,"img",23),s.Wb()}}function tR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"tr"),s.Xb(1,"th",26),s.Xb(2,"span",31),s.Zc(3),s.oc(4,"momentToLocaleDateString"),s.Wb(),s.Wb(),s.Xb(5,"td",32),s.Xb(6,"time-duration",33,34),s.jc("onFocus",(function(n){s.Oc(e);const i=t.index,c=s.nc(2);return c.focusRow(),c.clickInput(i,n)}))("durationChanged",(function(n){s.Oc(e);const i=t.index;return s.nc(2).durationChanged(n,i)}))("openModalEmitter",(function(){s.Oc(e);const n=t.index;return s.nc(2).bulkEditEntries(n)})),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit,n=t.index,i=s.nc(2);s.Cb(3),s.ad(s.qc(4,15,e,i.currentLanguage)),s.Cb(2),s.Hb("cl-request-calendar",!i.isHolidayAndRequest(i.dailyTimeOffs[n])&&(null==i.dailyTimeOffs[n]?null:i.dailyTimeOffs[n].length)&&"REQUEST"===i.dailyTimeOffs[n][0].type)("cl-holiday-calendar",!i.isHolidayAndRequest(i.dailyTimeOffs[n])&&(null==i.dailyTimeOffs[n]?null:i.dailyTimeOffs[n].length)&&"HOLIDAY"===i.dailyTimeOffs[n][0].type)("cl-holiday-and-request",i.isHolidayAndRequest(i.dailyTimeOffs[n]))("cl-bg-lighter",!i.isWorkDay(i.momentWeek[n])),s.Cb(1),s.wc("disabled",i.isInputDisabled(n))("format",i.format)("duration",i.durations[n])("disabledText",i.getDisabledText(n))("showOptions",!i.workspace.canSeeTracker)("isDesktop",i.isDesktop)}}function nR(e,t){1&e&&(s.Xb(0,"span",35),s.Sb(1,"img",36),s.Wb())}function iR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",37),s.jc("click",(function(){return s.Oc(e),s.nc(2).deleteRow()})),s.Sb(1,"img",23),s.Wb()}if(2&e){const e=s.nc(2);s.wc("disabled",e.forbidManagerEdit||e.timesheetRow.disabled||e.allEntriesLocked)}}function sR(e,t){if(1&e&&(s.Xb(0,"table",24),s.Xb(1,"tbody"),s.Xc(2,tR,8,18,"tr",25),s.Xb(3,"tr"),s.Xb(4,"th",26),s.Xb(5,"span",27),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xb(8,"td",28),s.Xb(9,"span"),s.Zc(10),s.oc(11,"sumDurations"),s.Wb(),s.Xc(12,nR,2,0,"span",29),s.Xc(13,iR,2,1,"ng-template",null,30,s.Yc),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.Lc(14),t=s.nc();s.Cb(2),s.wc("ngForOf",t.momentWeek),s.Cb(4),s.ad(s.pc(7,6,"GLOBAL.TOTAL_TIME")),s.Cb(2),s.wc("ngClass",0===t.timesheetRow.durationsByDay.length?"cl-text-gray-9":"cl-text-dark"),s.Cb(2),s.ad(s.qc(11,8,t.timesheetRow.durationsByDay,t.format)),s.Cb(2),s.wc("ngIf",t.timesheetRow.isApproved)("ngIfElse",e)}}function cR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"td",44),s.oc(1,"checkIfEditedEntries"),s.Xb(2,"time-duration",45,34),s.jc("onFocus",(function(n){s.Oc(e);const i=t.index,c=s.nc(2);return c.focusRow(),c.clickInput(i,n)}))("durationChanged",(function(n){s.Oc(e);const i=t.index;return s.nc(2).durationChanged(n,i)}))("openModalEmitter",(function(){s.Oc(e);const n=t.index;return s.nc(2).bulkEditEntries(n)})),s.Wb(),s.Wb()}if(2&e){const e=t.index,n=s.nc(2);s.Hb("cl-edited",s.pc(1,18,n.timesheetRow.entries[e]))("cl-hide-dots",n.shouldHideDots(e))("cl-bg-lighter",!n.isWorkDay(n.momentWeek[e]))("cl-request-calendar",!n.isHolidayAndRequest(n.dailyTimeOffs[e])&&(null==n.dailyTimeOffs[e]?null:n.dailyTimeOffs[e].length)&&"REQUEST"===n.dailyTimeOffs[e][0].type)("cl-holiday-calendar",!n.isHolidayAndRequest(n.dailyTimeOffs[e])&&(null==n.dailyTimeOffs[e]?null:n.dailyTimeOffs[e].length)&&"HOLIDAY"===n.dailyTimeOffs[e][0].type)("cl-holiday-and-request",n.isHolidayAndRequest(n.dailyTimeOffs[e])),s.Cb(2),s.wc("disabled",n.isInputDisabled(e))("format",n.format)("duration",n.durations[e])("disabledText",n.getDisabledText(e))("showOptions",!n.workspace.canSeeTracker)("hasEntries",!!n.timesheetRow.entries[e])}}function aR(e,t){1&e&&(s.Xb(0,"a",46),s.oc(1,"translate"),s.Sb(2,"img",36),s.Wb()),2&e&&s.xc("title",s.pc(1,1,"GLOBAL.APPROVED_LABEL"))}function oR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",47),s.jc("click",(function(){return s.Oc(e),s.nc(2).deleteRow()})),s.Sb(1,"img",23),s.Wb()}if(2&e){const e=s.nc(2);s.wc("disabled",e.forbidManagerEdit||e.timesheetRow.disabled||e.allEntriesLocked)}}function rR(e,t){if(1&e&&(s.Vb(0),s.Xc(1,cR,4,20,"td",38),s.Xb(2,"td",39),s.Xb(3,"div",40),s.Xb(4,"span",41),s.Zc(5),s.oc(6,"sumDurations"),s.Wb(),s.Xc(7,aR,3,3,"a",42),s.Xc(8,oR,2,1,"ng-template",null,43,s.Yc),s.Wb(),s.Wb(),s.Ub()),2&e){const e=s.Lc(9),t=s.nc();s.Cb(1),s.wc("ngForOf",t.week),s.Cb(3),s.wc("ngClass",0===t.timesheetRow.durationsByDay.length?"cl-text-gray-9":"cl-text-dark"),s.Cb(1),s.bd(" ",s.qc(6,5,t.timesheetRow.durationsByDay,t.format)," "),s.Cb(2),s.wc("ngIf",t.timesheetRow.isApproved)("ngIfElse",e)}}const lR=function(e){return{"cl-project-name cl-project-name-colored cl-dropdown-toggle cl-no-arrow cl-listing-project-client cl-text-dark":e}};let bR=(()=>{class e{constructor(e,t,n,i,c){this.timezoneConverter=e,this.authService=t,this.cd=n,this.translate=i,this.translationStore=c,this.delete=new s.n,this.changeDuration=new s.n,this.selectedProjectAndTask=new s.n,this.openNextPicker=new s.n,this.preventOpenPickerOnTab=new s.n,this.focusedRow=new s.n,this.openModalEmitter=new s.n,this.lockedWeek=new s.n,this.durations=[],this.lockedEntries=[],this.hasLockedEntries=!1,this.allEntriesLocked=!1,this.projectPickerTrigger="",this.unsubscribe$=new p.a}set expandAll(e){this.timesheetRow&&this.timesheetRow.project&&(this.isExpanded=e)}get expandAll(){return this._expandAll}set userGroups(e){this._userGroups=e,this.isLoaded&&(this.disableRowWithoutPermission(),this.cd.detectChanges())}get userGroups(){return this._userGroups}set selectedUser(e){this._selectedUser=e,this.isLoaded&&(this.disableRowWithoutPermission(),this.cd.detectChanges())}get selectedUser(){return this._selectedUser}ngOnInit(){this.currentLanguage=this.translationStore.getCurrentLang(),this.errorMessages=this.translate.instant(["TIMESHEET2.MESSAGES.MANUAL_MODE_DISABLED","GLOBAL.APPROVED_ERROR_MESSAGE","GLOBAL.ENTRIES_LOCKED_ERROR_MESSAGE","TIMESHEET2.MESSAGES.DONT_HAVE_PERMISSION","TIMESHEET2.MESSAGES.SELECT_PROJECT_TASK_ERROR","TIMESHEET2.MESSAGES.ENTRIES_TAG_ARCHIVED"]),this.title=Object(sn.o)(this.timesheetRow,this.translate.instant("GLOBAL.PROJECT_LABEL"),this.translate.instant("GLOBAL.TASK_LABEL"),this.workspace.projectGroupingLabel),this.projectPickerTrigger=this.translate.instant(this.projectPickerSpecialFilter?"TIMESHEET2.SHARED.TASK_PROJECT_PLACEHOLDER":this.workspace.forceTasks?"TIMESHEET2.SHARED.TASK_PLACEHOLDER":"GLOBAL.ADD_PROJECT_LABEL"),this.getFormattedDurations(),this.workspace.lockTimeEntries&&!this.isAdminOrOwner&&this.checkLockedEntries(),this.lockedWeek.emit(this.allEntriesLocked)}ngAfterViewInit(){this.disableRowWithoutPermission(),this.isLoaded=!0,this.cd.detectChanges()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}getFormattedDurations(){this.durations=this.timesheetRow.durationsByDay.map(e=>e&&Object(La.a)(e,this.format)||""),this.timesheetRow.durationsByDay=[...this.timesheetRow.durationsByDay],this.cd.detectChanges()}checkLockedEntries(){const e=this.authService.getUser().settings.timeZone,t=this.timezoneConverter.addOffsetToUTCTime(tn.tz(this.workspace.lockTimeEntries,e).clone()),n=this.dateRange.start.clone();this.lockedEntries=this.week.map((e,i)=>Object(ke.utc)(n).startOf("day").add(i,"days").isBefore(tn(t))),this.hasLockedEntries=this.lockedEntries.some(e=>e),this.allEntriesLocked=this.lockedEntries.every(e=>e)}selectProjectAndTask(e){this.selectedProjectAndTask.emit({task:e.task,project:e.project,workspace:e.workspace}),this.isDesktop||!this.timesheetRow.project||this.timesheetRow.entries.length||(this.isExpanded=!0),(this.isDesktop||this.isExpanded)&&this.focusFirstInput()}durationChanged(e,t){this.changeDuration.emit({duration:e,index:t}),0===Object(ke.duration)(e).asSeconds()&&(this.timesheetRow.durationsByDay[t]=null,this.timesheetRow.entries[t]=[])}getDisabledText(e){return this.forbidManagerEdit?"":this.disableManualMode?this.errorMessages["TIMESHEET2.MESSAGES.MANUAL_MODE_DISABLED"]:this.timesheetRow.isApproved?this.errorMessages["GLOBAL.APPROVED_ERROR_MESSAGE"]:this.lockedEntries[e]?this.errorMessages["GLOBAL.ENTRIES_LOCKED_ERROR_MESSAGE"]:this.timesheetRow.disabled?this.errorMessages["TIMESHEET2.MESSAGES.DONT_HAVE_PERMISSION"]:this.timesheetRow.project?this.timesheetRow.entries[e]&&this.timesheetRow.entries[e].some(e=>e.tags&&e.tags.some(e=>e.archived))?this.errorMessages["TIMESHEET2.MESSAGES.ENTRIES_TAG_ARCHIVED"]:"":this.errorMessages["TIMESHEET2.MESSAGES.SELECT_PROJECT_TASK_ERROR"]}disableRowWithoutPermission(){if(this.selectedUser&&this.userGroups&&this.timesheetRow){const e=this.userGroups.filter(e=>e.userIds.indexOf(this.selectedUser.id)>-1).map(e=>e.id);if(!this.isAdminOrOwner&&this.timesheetRow.project&&this.timesheetRow.project.archived)return void(this.timesheetRow.disabled=!0);if(!this.isAdminOrOwner&&this.timesheetRow.task&&"DONE"===this.timesheetRow.task.status)return void(this.timesheetRow.disabled=!0);if(!this.isAdminOrOwner&&this.timesheetRow.task&&this.timesheetRow.task.assigneeIds&&this.timesheetRow.task.userGroupIds&&!this.isNoOneAssigned()&&-1===this.timesheetRow.task.assigneeIds.indexOf(this.selectedUser.id)&&!this.isUserIdInAssignedGroups(this.timesheetRow.task.userGroupIds))return void(this.timesheetRow.disabled=!0);if(this.timesheetRow.project&&new RL.a(this.timesheetRow.project).public)return void(this.timesheetRow.disabled=!1);if(!this.isAdminOrOwner&&this.timesheetRow.project&&this.timesheetRow.project.memberships&&!this.timesheetRow.project.memberships.some(t=>t.userId===this.selectedUser.id||e.indexOf(t.userId)>-1))return void(this.timesheetRow.disabled=!0)}}isUserIdInAssignedGroups(e){const t=this.userGroups.filter(t=>e.indexOf(t.id)>-1);let n=!1;return t.forEach(e=>{e.userIds.indexOf(this.selectedUser.id)>-1&&(n=!0)}),n}isNoOneAssigned(){return 0===this.timesheetRow.task.assigneeIds.length&&0===this.timesheetRow.task.userGroupIds.length}deleteRow(){this.timesheetRow.disabled||this.allEntriesLocked||this.timesheetRow.isApproved||this.delete.emit()}focusFirstInput(){this.workspace.forceDescription||this.workspace.forceTags||(setTimeout(()=>{this.inputs&&this.inputs.first&&this.inputs.first.focusInput()},200),this.preventOpenPickerOnTab.emit(!0))}openProjectPicker(){this.pickerDropdown.nativeElement.focus()}pickerOpened(){this.preventOpenPickerOnTab.emit(!0)}focusRow(){this.focusedRow.emit(this.index)}clickInput(e,t){const n=this.timesheetRow.entries[e];(this.workspace.forceDescription||this.workspace.forceTags||n&&n.length&&1!==n.length)&&((!this.workspace.forceDescription&&!this.workspace.forceTags||n&&n.length)&&this.areDescriptionsSame(n)&&this.areTagsSame(n)&&this.isBillabilitySame(n)&&this.areCustomFieldsSame(n)&&(!this.workspace.forceDescription||this.workspace.forceDescription&&n[0].description)&&(!this.workspace.forceTags||this.workspace.forceTags&&n[0].tags&&n[0].tags.length)||this.openEditModal(e,t))}areDescriptionsSame(e){return!e||e.every(t=>t.description===e[0].description)}areTagsSame(e){return!e||e.every(t=>Object(sn.c)(t.tags.map(e=>e.id),e[0].tags.map(e=>e.id)))}isBillabilitySame(e){return!e||e.every(t=>t.billable===e[0].billable)}areCustomFieldsSame(e){let t=[],n=[];return e&&e[0]&&e[0].customFieldValues&&e[0].customFieldValues.length&&(t=e[0].customFieldValues.map(e=>e.customFieldId),n=e[0].customFieldValues.map(e=>e.value)),!e||e.every(i=>{if(!(e[0].customFieldValues&&e[0].customFieldValues.length||i.customFieldValues&&i.customFieldValues.length))return!0;const s=Object(sn.c)(i.customFieldValues.map(e=>e.customFieldId),t),c=Object(sn.c)(i.customFieldValues.map(e=>e.value),n);return s&&c})}openEditModal(e,t){t.nativeElement.blur(),this.bulkEditEntries(e)}bulkEditEntries(e){this.timesheetRow.disabled||this.lockedEntries[e]||!this.timesheetRow.project||(this.openModalEmitter.emit({timesheetRow:this.timesheetRow,index:e}),this.preventOpenPickerOnTab.emit(!0))}isInputDisabled(e){return this.forbidManagerEdit||this.timesheetRow.isApproved||this.timesheetRow.disabled||this.lockedEntries[e]||this.disableManualMode||!this.timesheetRow.project||this.timesheetRow.entries[e]&&this.timesheetRow.entries[e].some(e=>e.tags&&e.tags.some(e=>e.archived))}shouldHideDots(e){return!(this.workspace.forceDescription||this.workspace.forceTags||this.timesheetRow.entries[e]&&this.timesheetRow.entries[e].length)}isWorkDay(e){return this.workspace.workingDays.includes(ho.b[tn(e).clone().locale("en").format("dddd").toUpperCase()])}isHolidayAndRequest(e){if(null==e||null==e)return!1;let t=!1,n=!1;return e.forEach(e=>{"HOLIDAY"==e.type&&(t=!0),"REQUEST"==e.type&&(n=!0)}),!(!t||!n)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Ic.a),s.Rb(re.a),s.Rb(s.h),s.Rb(g.f),s.Rb(Ra.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["timesheet-row"],["","timesheet-row",""]],viewQuery:function(e,t){var n;1&e&&(s.gd(VL,!0),s.gd(YL,!0)),2&e&&(s.Kc(n=s.kc())&&(t.pickerDropdown=n.first),s.Kc(n=s.kc())&&(t.inputs=n))},inputs:{expandAll:"expandAll",userGroups:"userGroups",selectedUser:"selectedUser",timesheetRows:"timesheetRows",timesheetRow:"timesheetRow",week:"week",momentWeek:"momentWeek",dailyTimeOffs:"dailyTimeOffs",isDesktop:"isDesktop",format:"format",isAdminOrOwner:"isAdminOrOwner",dateRange:"dateRange",workspace:"workspace",projectPickerSpecialFilter:"projectPickerSpecialFilter",index:"index",disableManualMode:"disableManualMode",forbidManagerEdit:"forbidManagerEdit"},outputs:{delete:"delete",changeDuration:"changeDuration",selectedProjectAndTask:"selectedProjectAndTask",openNextPicker:"openNextPicker",preventOpenPickerOnTab:"preventOpenPickerOnTab",focusedRow:"focusedRow",openModalEmitter:"openModalEmitter",lockedWeek:"lockedWeek"},decls:13,vars:13,consts:[[1,"cl-px-lg-3","cl-cut-text-wrapper-td"],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-center"],[1,"cl-dropdown","cl-dropdown-large","cl-d-inline-flex","cl-cut-text-wrapper","cl-w-100",3,"dropdownKey"],["dropdownKeyButton","","tabindex","0",1,"cl-cut-text",3,"ngClass","click"],["pickerDropdown",""],[4,"ngIf","ngIfElse"],["noSelectedTemplate",""],["openUpAtBottom","","class","cl-dropdown-menu","resizeable","",3,"timesheetRows","hideWorkspaces","selectedUserId","selectedProjectAndTask","dropdownClosed","onResize",4,"dropdownKeyContent"],[4,"ngIf"],["class","cl-ml-2 cl-mr-1 cl-lh-0",3,"click",4,"ngIf"],["class","cl-table cl-table-bordered cl-remove-cell-borders cl-mt-2 cl-mt-lg-3",4,"ngIf"],[1,"cl-entry__project__dot"],[1,"cl-h-line-divider"],[1,"cl-listing-client"],["src","assets/images/ui-icons/plus-blue-req.svg"],[1,"cl-ml-2","cl-color-blue"],["openUpAtBottom","","resizeable","",1,"cl-dropdown-menu",3,"timesheetRows","hideWorkspaces","selectedUserId","selectedProjectAndTask","dropdownClosed","onResize"],["projectPicker",""],[1,"cl-text-dark",3,"click"],[1,"cl-ml-3",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"],[1,"cl-ml-2","cl-mr-1","cl-lh-0",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-mt-2","cl-mt-lg-3"],[4,"ngFor","ngForOf"],[1,"cl-bg-light"],[1,"cl-h6","cl-mb-0"],[1,"cl-bg-light","cl-text-right",3,"ngClass"],["class","cl-ml-2 cl-mr-1 cl-lh-0",4,"ngIf","ngIfElse"],["deleteTemplateMobile",""],[1,"cl-h6"],[1,"cl-timesheet-input-td","cl-edited"],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-center",3,"disabled","format","duration","disabledText","showOptions","isDesktop","onFocus","durationChanged","openModalEmitter"],["timeDuration",""],[1,"cl-ml-2","cl-mr-1","cl-lh-0"],["src","assets/ui-icons/checkmark-green-circle.svg"],[1,"cl-ml-2","cl-mr-1","cl-lh-0",3,"disabled","click"],["class","cl-timesheet-input-td",3,"cl-edited","cl-hide-dots","cl-bg-lighter","cl-request-calendar","cl-holiday-calendar","cl-holiday-and-request",4,"ngFor","ngForOf"],[1,"cl-timesheet-total-td","cl-pr-lg-2"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-between"],[3,"ngClass"],["class","cl-ml-2 cl-lh-0 cl-d-print-none cl-disabled-light",3,"title",4,"ngIf","ngIfElse"],["deleteTemplate",""],[1,"cl-timesheet-input-td"],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-center","cl-position-relative",3,"disabled","format","duration","disabledText","showOptions","hasEntries","onFocus","durationChanged","openModalEmitter"],[1,"cl-ml-2","cl-lh-0","cl-d-print-none","cl-disabled-light",3,"title"],[1,"cl-ml-2","cl-lh-0","cl-d-print-none",3,"disabled","click"]],template:function(e,t){if(1&e&&(s.Xb(0,"td",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"a",3,4),s.jc("click",(function(){return t.pickerOpened()})),s.Xc(5,qL,7,6,"ng-container",5),s.Xc(6,zL,3,1,"ng-template",null,6,s.Yc),s.Wb(),s.Xc(8,QL,2,3,"project-picker",7),s.Wb(),s.Xc(9,JL,7,5,"ng-container",8),s.Xc(10,eR,2,0,"a",9),s.Wb(),s.Xc(11,sR,15,11,"table",10),s.Wb(),s.Xc(12,rR,10,8,"ng-container",8)),2&e){const e=s.Lc(7);s.Cb(2),s.wc("dropdownKey",t.forbidManagerEdit||t.timesheetRow.isApproved||t.disableManualMode||t.timesheetRow.project&&t.hasLockedEntries&&!t.isAdminOrOwner),s.Cb(1),s.Hb("cl-disabled",t.forbidManagerEdit||t.timesheetRow.isApproved||t.disableManualMode||t.timesheetRow.project&&t.hasLockedEntries&&!t.isAdminOrOwner),s.wc("ngClass",s.Bc(11,lR,t.timesheetRow.project&&t.timesheetRow.project.name)),s.Db("title",t.timesheetRow.project?t.title:""),s.Cb(2),s.wc("ngIf",t.timesheetRow.project)("ngIfElse",e),s.Cb(4),s.wc("ngIf",!t.isDesktop&&t.timesheetRow.project),s.Cb(1),s.wc("ngIf",!t.isDesktop&&!t.timesheetRow.project),s.Cb(1),s.wc("ngIf",!t.isDesktop&&t.isExpanded),s.Cb(1),s.wc("ngIf",t.isDesktop)}},directives:[ni.a,ii.a,i.r,i.u,si.a,NO.a,DO.a,i.t,xL],pipes:[FL.a,g.e,jL.a,ZL.a],encapsulation:2,changeDetection:0}),e})();function dR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",6),s.Xb(1,"span",7),s.Zc(2),s.oc(3,"stringDurationToTime"),s.Wb(),s.Xb(4,"a",8),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.isExpanded=!t.isExpanded})),s.Xb(5,"span",9),s.Sb(6,"img",10),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.qc(3,1,e.total,e.format))}}function uR(e,t){if(1&e&&(s.Xb(0,"tr"),s.Xb(1,"th",13),s.Xb(2,"span",16),s.Zc(3),s.oc(4,"momentToLocaleDateString"),s.Wb(),s.Wb(),s.Xb(5,"td",15),s.Zc(6),s.oc(7,"stringDurationToTime"),s.Wb(),s.Wb()),2&e){const e=t.$implicit,n=t.index,i=s.nc(2);s.Cb(3),s.ad(s.qc(4,3,e,i.currentLanguage)),s.Cb(2),s.wc("ngClass",i.totalList[n]?"cl-text-dark":"cl-text-gray-9"),s.Cb(1),s.bd(" ",s.qc(7,6,i.totalList[n],i.format)," ")}}function pR(e,t){if(1&e&&(s.Xb(0,"table",11),s.Xb(1,"tbody"),s.Xc(2,uR,8,9,"tr",12),s.Xb(3,"tr"),s.Xb(4,"th",13),s.Xb(5,"span",14),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xb(8,"td",15),s.Zc(9),s.oc(10,"stringDurationToTime"),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.wc("ngForOf",e.week),s.Cb(4),s.ad(s.pc(7,4,"GLOBAL.TOTAL_TIME")),s.Cb(2),s.wc("ngClass",e.isTotalZero?"cl-text-gray-9":"cl-text-dark"),s.Cb(1),s.bd(" ",s.qc(10,6,e.total,e.format)," ")}}function hR(e,t){if(1&e&&(s.Xb(0,"td",20),s.Zc(1),s.oc(2,"stringDurationToTime"),s.Wb()),2&e){const e=t.index,n=s.nc(2);s.wc("ngClass",n.totalList[e]?"cl-text-dark":"cl-text-gray-9"),s.Cb(1),s.bd(" ",s.qc(2,2,n.totalList[e],n.format)," ")}}function mR(e,t){if(1&e&&(s.Vb(0),s.Xc(1,hR,3,5,"td",17),s.Xb(2,"td",18),s.Xb(3,"span",19),s.Zc(4),s.oc(5,"stringDurationToTime"),s.Wb(),s.Wb(),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngForOf",e.week),s.Cb(1),s.wc("ngClass",e.isTotalZero?"cl-text-gray-9":"cl-text-dark"),s.Cb(2),s.ad(s.qc(5,3,e.total,e.format))}}let gR=(()=>{class e{constructor(e){this.translationStorage=e,this.isExpanded=!1}set total(e){this._total=e||Object(ke.duration)(0),this.isTotalZero=0===Object(ke.duration)(this.total).asSeconds()}set expandAll(e){this.isExpanded=e}get expandAll(){return this._expandAll}get total(){return this._total}ngOnInit(){this.currentLanguage=this.translationStorage.getCurrentLang()}ngOnDestroy(){}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Ra.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["timesheet-row-total"],["","timesheet-row-total",""]],inputs:{total:"total",expandAll:"expandAll",totalList:"totalList",week:"week",isDesktop:"isDesktop",format:"format"},decls:8,vars:6,consts:[[1,"cl-px-lg-3"],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-center"],[1,"cl-text-gray-9"],["class","cl-d-flex",4,"ngIf"],["class","cl-table cl-table-bordered cl-remove-cell-borders cl-mt-2 cl-mt-lg-3",4,"ngIf"],[4,"ngIf"],[1,"cl-d-flex"],[1,"cl-text-dark"],[1,"cl-ml-3",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],["src","assets/images/ui-icons/chevron-down.svg"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-mt-2","cl-mt-lg-3"],[4,"ngFor","ngForOf"],[1,"cl-bg-light"],[1,"cl-h6","cl-mb-0"],[1,"cl-bg-light","cl-text-right",3,"ngClass"],[1,"cl-h6"],["class","cl-text-center",3,"ngClass",4,"ngFor","ngForOf"],[1,"cl-timesheet-total-td","cl-text-left",3,"ngClass"],[1,"timesheet-total-pr"],[1,"cl-text-center",3,"ngClass"]],template:function(e,t){1&e&&(s.Xb(0,"td",0),s.Xb(1,"div",1),s.Xb(2,"span",2),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xc(5,dR,7,4,"div",3),s.Wb(),s.Xc(6,pR,11,9,"table",4),s.Wb(),s.Xc(7,mR,6,6,"ng-container",5)),2&e&&(s.Cb(3),s.ad(s.pc(4,4,"GLOBAL.TOTAL_TIME")),s.Cb(2),s.wc("ngIf",!t.isDesktop),s.Cb(1),s.wc("ngIf",!t.isDesktop&&t.isExpanded),s.Cb(1),s.wc("ngIf",t.isDesktop))},directives:[i.u,i.t,i.r],pipes:[g.e,xc.a,jL.a],encapsulation:2,changeDetection:0}),e})();function ER(e,t){if(1&e&&s.Sb(0,"img",14),2&e){const e=s.nc(2);s.wc("ngbTooltip",e.template.projectsAndTasks&&0===e.template.projectsAndTasks.length?"You should delete this template because it's empty":"")}}function fR(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xc(1,ER,1,1,"img",12),s.Xb(2,"button",13),s.jc("click",(function(){return s.Oc(e),s.nc().applyTemplate()})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Ub()}if(2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.template.projectsAndTasks&&0===e.template.projectsAndTasks.length),s.Cb(1),s.wc("disabled",e.template.projectsAndTasks&&0===e.template.projectsAndTasks.length),s.Cb(1),s.bd(" ",s.pc(4,3,"GLOBAL.ACTIVATE_LABEL")," ")}}function SR(e,t){1&e&&(s.Xb(0,"a",15),s.Sb(1,"img",16),s.Zc(2),s.oc(3,"translate"),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"GLOBAL.ACTIVE_LABEL")," "))}function CR(e,t){1&e&&(s.Xb(0,"div"),s.Xb(1,"div"),s.Xb(2,"div",26),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Sb(5,"hr"),s.Wb()),2&e&&(s.Cb(3),s.ad(s.pc(4,1,"TIMESHEET2.TEMPLATE.CONTAINS_ACTIVITIES")))}function AR(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(2).$implicit;s.Cb(1),s.bd(" - ",e.task.name?e.task.name:s.pc(2,1,"GLOBAL.WITHOUT_PROJECT_LABEL")," ")}}function OR(e,t){if(1&e&&(s.Xb(0,"span",32),s.Zc(1),s.Wb()),2&e){const e=s.nc(2).$implicit;s.Cb(1),s.bd(" - ",e.project.clientName," ")}}function vR(e,t){if(1&e&&(s.Xb(0,"span",29),s.Sb(1,"i",30),s.Xb(2,"span"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xc(5,AR,3,3,"span",3),s.Xc(6,OR,2,1,"span",31),s.Wb()),2&e){const e=s.nc().$implicit;s.Cb(1),s.Wc("background",e.project.color,s.Kb),s.Cb(2),s.bd(" ",e.project.name?e.project.name:s.pc(4,5,"GLOBAL.WITHOUT_PROJECT_LABEL")," "),s.Cb(2),s.wc("ngIf",e.task&&e.task.name),s.Cb(1),s.wc("ngIf",e.project.clientName)}}function TR(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"div",27),s.Xc(2,vR,7,7,"span",28),s.Wb(),s.Ub()),2&e){const e=t.$implicit;s.Cb(2),s.wc("ngIf",e.project)}}function IR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",17),s.Xb(1,"h1",18),s.Xb(2,"div",19),s.Zc(3),s.Wb(),s.Wb(),s.Xb(4,"button",20),s.jc("click",(function(){return s.Oc(e),s.nc().closeModal()})),s.Xb(5,"span",21),s.Sb(6,"img",8),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",22),s.Xc(8,CR,6,3,"div",3),s.Xc(9,TR,3,1,"ng-container",23),s.Wb(),s.Xb(10,"div",24),s.Xb(11,"button",25),s.jc("click",(function(){return s.Oc(e),s.nc().closeModal()})),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.ad(e.fullTemplate.name),s.Cb(5),s.wc("ngIf",e.containEntries),s.Cb(1),s.wc("ngForOf",e.fullTemplate.projectsAndTasks),s.Cb(3),s.ad(s.pc(13,4,"GLOBAL.CLOSE_BTN"))}}function wR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",17),s.Xb(1,"h1",33),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",20),s.jc("click",(function(){return s.Oc(e),s.nc().closeModal()})),s.Xb(5,"span",21),s.Sb(6,"img",8),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",34),s.Xb(8,"form"),s.Xb(9,"div",35),s.Xb(10,"label",36),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xb(13,"div",37),s.Xb(14,"input",38),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().newTemplateName=t}))("keyup.enter",(function(){s.Oc(e);const t=s.nc();return t.editTemplate(t.newTemplateName)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(15,"div",39),s.Xb(16,"a",40),s.jc("click",(function(){return s.Oc(e),s.nc().closeModal()})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Xb(19,"button",41),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.editTemplate(t.newTemplateName)})),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,6,"TIMESHEET2.TEMPLATE.EDIT.TITLE")),s.Cb(9),s.ad(s.pc(12,8,"GLOBAL.CHANGE_NAME_LABEL")),s.Cb(3),s.wc("ngModel",e.newTemplateName),s.Cb(3),s.ad(s.pc(18,10,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",""===e.newTemplateName.trim()),s.Cb(1),s.bd(" ",s.pc(21,12,"GLOBAL.SAVE_LABEL")," ")}}const LR=function(e){return{templateName:e}};function RR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",17),s.Xb(1,"h1",33),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",20),s.jc("click",(function(){return s.Oc(e),s.nc().closeModal()})),s.Xb(5,"span",21),s.Sb(6,"img",8),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",34),s.Xb(8,"p",42),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Xb(11,"div",39),s.Xb(12,"a",40),s.jc("click",(function(){return s.Oc(e),s.nc().closeModal()})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Xb(15,"button",43),s.jc("click",(function(){return s.Oc(e),s.nc().deleteTemplate()})),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,4,"GLOBAL.DELETE_BTN")),s.Cb(7),s.ad(s.qc(10,6,"TIMESHEET2.TEMPLATE.DELETE.MODAL.CONTENT",s.Bc(13,LR,e.template.name))),s.Cb(4),s.ad(s.pc(14,9,"GLOBAL.CANCEL_BTN")),s.Cb(3),s.bd(" ",s.pc(17,11,"GLOBAL.DELETE_BTN")," ")}}let yR=(()=>{class e{constructor(e,t){this.tracker2Service=e,this.modalService=t,this.templateApplied=new s.n,this.templateEdited=new s.n,this.templateDeleted=new s.n,this.newTemplateName="",this.containEntries=!1}ngOnInit(){this.template.entries.length>0&&(this.containEntries=!0)}applyTemplate(){0!==this.template.projectsAndTasks.length&&this.templateApplied.emit(!0)}editTemplate(e){this.templateEdited.emit(e)}deleteTemplate(){this.templateDeleted.emit(!0)}openModal(e,t){this.template=t,this.newTemplateName=t.name,this.modalService.open(e,{centered:!0})}openInfoModal(e,t){this.tracker2Service.templateOfId(t.id).subscribe(t=>{this.fullTemplate=t,this.modalService.open(e,{centered:!0})})}closeModal(){this.modalService.dismissAll()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(WA.a),s.Rb(w.q))},e.\u0275cmp=s.Lb({type:e,selectors:[["template-row"]],inputs:{template:"template",hasEntries:"hasEntries",disableManualMode:"disableManualMode"},outputs:{templateApplied:"templateApplied",templateEdited:"templateEdited",templateDeleted:"templateDeleted"},decls:18,vars:3,consts:[[1,"cl-d-flex","cl-flex-column","cl-flex-lg-row","cl-w-100","cl-align-items-start","cl-align-items-lg-center"],[1,"cl-px-2","cl-px-lg-3","cl-py-3","cl-cut-text","cl-w-100","cl-w-lg-auto"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end","cl-template-separator-mob","cl-min-height-40","cl-w-100","cl-w-lg-auto","cl-ml-auto"],[4,"ngIf"],["class","cl-text-success cl-component-divided-left cl-no-divider-border",4,"ngIf"],[1,"cl-component-divided-left",3,"click"],["src","assets/images/ui-icons/info-icon.svg"],["src","assets/images/ui-icons/edit.svg"],["src","assets/images/ui-icons/close.svg"],["infoTemplateModal",""],["editTemplateModal",""],["deleteTemplateModal",""],["src","assets/info-icon.png","class","cl-mr-0","placement","left",3,"ngbTooltip",4,"ngIf"],[1,"cl-component-divided-left","cl-no-divider-border","cl-btn-link","cl-pl-1",3,"disabled","click"],["src","assets/info-icon.png","placement","left",1,"cl-mr-0",3,"ngbTooltip"],[1,"cl-text-success","cl-component-divided-left","cl-no-divider-border"],["src","assets/images/ui-icons/checkmark-green.svg",1,"cl-mr-2"],[1,"cl-modal-header"],[1,"cl-modal-title","cl-cut-text-wrapper"],[1,"cl-cut-text"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],[1,"cl-modal-body","cl-p-3"],[4,"ngFor","ngForOf"],[1,"cl-modal-footer"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-text-gray-6"],[1,"cl-dropdown-item","cl-white-space-normal","cl-p-0"],["class","cl-project-name cl-text-dark",4,"ngIf"],[1,"cl-project-name","cl-text-dark"],[1,"cl-entry__project__dot"],["class","cl-listing-client",4,"ngIf"],[1,"cl-listing-client"],[1,"cl-modal-title"],[1,"cl-modal-body"],[1,"cl-form-group","cl-row","cl-mb-0"],["for","template-name-create",1,"cl-col-sm-3","cl-col-form-label"],[1,"cl-col-sm-9"],["type","text","ngbAutofocus","","id","template-name-create","name","newTemplateName",1,"cl-form-control",3,"ngModel","ngModelChange","keyup.enter"],[1,"cl-modal-footer","cl-text-capitalize"],[3,"click"],["type","button",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[1,"cl-mb-0"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-danger",3,"click"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Zc(2),s.Wb(),s.Xb(3,"div",2),s.Xc(4,fR,5,5,"ng-container",3),s.Xc(5,SR,4,3,"a",4),s.Xb(6,"a",5),s.jc("click",(function(){s.Oc(e);const n=s.Lc(13);return t.openInfoModal(n,t.template)})),s.Sb(7,"img",6),s.Wb(),s.Xb(8,"a",5),s.jc("click",(function(){s.Oc(e);const n=s.Lc(15);return t.openModal(n,t.template)})),s.Sb(9,"img",7),s.Wb(),s.Xb(10,"a",5),s.jc("click",(function(){s.Oc(e);const n=s.Lc(17);return t.openModal(n,t.template)})),s.Sb(11,"img",8),s.Wb(),s.Wb(),s.Wb(),s.Xc(12,IR,14,6,"ng-template",null,9,s.Yc),s.Xc(14,wR,22,14,"ng-template",null,10,s.Yc),s.Xc(16,RR,18,15,"ng-template",null,11,s.Yc)}2&e&&(s.Cb(2),s.ad(t.template.name),s.Cb(2),s.wc("ngIf",!t.template.isActive&&!t.hasEntries&&!t.disableManualMode),s.Cb(1),s.wc("ngIf",t.template.isActive&&!t.hasEntries))},directives:[i.u,w.bb,i.t,v.I,v.t,v.u,v.c,v.s,v.v],pipes:[g.e],encapsulation:2}),e})();var _R=function(e){return e[e.TIME=0]="TIME",e[e.DESCRIPTION=1]="DESCRIPTION",e[e.TAG=2]="TAG",e[e.BILLABLE=3]="BILLABLE",e}({});class kR{constructor(e,t,n,i){this._type=e,this._initialValue=t,this._value=t,this._different=void 0!==i&&i,this._forced=n,this.checkIfInvalid()}get type(){return this._type}set type(e){this._type=e}get initialValue(){return this._initialValue}set initialValue(e){this._initialValue=e}get value(){return this._value}set value(e){this._value=e,this.checkIfInvalid()}get different(){return this._different}set different(e){this._different=e}get forced(){return this._forced}set forced(e){this._forced=e}get invalid(){return this._invalid}set invalid(e){this._invalid=e}checkIfInvalid(){this._type===_R.DESCRIPTION&&(this.invalid=this._forced&&""==this._value),this._type===_R.TAG&&(this.invalid=this._forced&&(!this._value||!this._value.length)),this._type===_R.BILLABLE&&(this.invalid=!1),this._type===_R.TIME&&(this.invalid=this._value instanceof ZA.a&&(!this._value||0===Object(ke.duration)(this._value.duration).asSeconds()))}}const WR=["descriptionInput"];function XR(e,t){if(1&e&&(s.Xb(0,"div",30),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",e.row.project.clientName||e.row.project.client.name," ")}}function NR(e,t){if(1&e&&(s.Xb(0,"div",30),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",e.row.task.name," ")}}function DR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",31),s.Xb(1,"single-date-picker2",32),s.jc("pickedDate",(function(t){return s.Oc(e),s.nc().pickedTime(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.wc("debounce",!1)("dateTime",e.timeValue&&e.timeValue.value)("mode","time_only")}}const PR=function(e){return{value:e}};function MR(e,t){if(1&e&&(s.Xb(0,"div",33),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,"TIMESHEET2.TIME_ENTRY.DESCRIPTION.INFO_MESSAGE",s.Bc(4,PR,e.differentValues[0]))," ")}}function BR(e,t){1&e&&(s.Xb(0,"span",34),s.Zc(1,"*"),s.Wb())}function UR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",28),s.jc("click",(function(){return s.Oc(e),s.nc().overrideDescription()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"TIMESHEET2.EDIT.OVERRIDE.DESCRIPTION")," "))}function GR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"textarea",35,36),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().descriptionValue.value=t}))("ngModelChange",(function(){return s.Oc(e),s.nc().shouldDisableSave()})),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc();s.yc("placeholder"," ",s.pc(2,2,"GLOBAL.FORM_LABEL_DESCRIPTION_PLACEHOLDER"),""),s.wc("ngModel",e.descriptionValue.value)}}function xR(e,t){1&e&&(s.Xb(0,"span",34),s.Zc(1,"*"),s.Wb())}function FR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",28),s.jc("click",(function(){return s.Oc(e),s.nc().tagValue.different=!1})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"TIMESHEET2.EDIT.OVERRIDE.TAGS")," "))}function jR(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.Wb()),2&e){const e=t.$implicit,n=t.last;s.Cb(1),s.cd(" ",e.name,"",n?"":", "," ")}}function ZR(e,t){if(1&e&&(s.Vb(0),s.Xc(1,jR,2,2,"span",44),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngForOf",e.tagValue.value)}}function VR(e,t){1&e&&(s.Zc(0),s.oc(1,"translate")),2&e&&s.bd(" ",s.pc(1,1,"TIMESHEET2.TIME_ENTRY.TAGS.SELECT")," ")}function YR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"tag-dropdown",45),s.jc("close",(function(t){return s.Oc(e),s.nc(2).closeTagDropdown(t)})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("resizeableName","tagPicker")("entryTags",e.tagValue.value)}}function HR(e,t){if(1&e&&(s.Xb(0,"div",37),s.Xb(1,"button",38),s.Xc(2,ZR,2,1,"ng-container",39),s.Xc(3,VR,2,3,"ng-template",null,40,s.Yc),s.Wb(),s.Xb(5,"div",41),s.Xb(6,"div",42),s.Xc(7,YR,1,2,"tag-dropdown",43),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.Lc(4),t=s.nc();s.Cb(2),s.wc("ngIf",null==t.tagValue.value?null:t.tagValue.value.length)("ngIfElse",e)}}function $R(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",28),s.jc("click",(function(){return s.Oc(e),s.nc(2).billableValue.different=!1})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.ad(s.pc(2,1,"TIMESHEET2.EDIT.OVERRIDE.BILLABLE")))}function KR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",48),s.Xb(1,"input",49),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc(2).billableValue.value=t})),s.Wb(),s.Xb(2,"label",50),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(1),s.wc("ngModel",e.billableValue.value),s.Cb(2),s.ad(s.pc(4,2,"GLOBAL.CONFIRM_LABEL"))}}function qR(e,t){if(1&e&&(s.Xb(0,"div",46),s.Xb(1,"label",21),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",18),s.Xc(5,$R,3,3,"a",19),s.Xc(6,KR,5,4,"div",47),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,3,"GLOBAL.BILLABLE_LABEL")),s.Cb(3),s.wc("ngIf",e.billableValue.different),s.Cb(1),s.wc("ngIf",!e.billableValue.different)}}function zR(e,t){1&e&&s.Sb(0,"hr")}function QR(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",28),s.jc("click",(function(){return s.Oc(e),s.nc().$implicit.isSameForAll=!0})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc().$implicit;s.Cb(1),s.cd("",s.pc(2,2,"TIMESHEET2.OVERRIDE")," ",e.customField.name,"")}}function JR(e,t){if(1&e&&(s.Xb(0,"div",53),s.Sb(1,"custom-field-value",54),s.Wb()),2&e){const e=s.nc().$implicit;s.Cb(1),s.wc("customField",e)}}function ey(e,t){if(1&e&&(s.Xb(0,"div",46),s.Xb(1,"label",21),s.Zc(2),s.Wb(),s.Xb(3,"div",51),s.Xc(4,QR,3,4,"a",19),s.Xc(5,JR,2,1,"div",52),s.Wb(),s.Wb()),2&e){const e=t.$implicit;s.Cb(2),s.ad(e.customField.name),s.Cb(2),s.wc("ngIf",!e.isSameForAll),s.Cb(1),s.wc("ngIf",e.isSameForAll)}}const ty=function(e){return{"cl-disabled":e}};let ny=(()=>{class e{constructor(e,t,n,i){this.toaster=e,this.authService=t,this.workspaceService=n,this.translate=i,this.close=new s.n,this.createEntryEmitter=new s.n,this.differentValues=[],this.disableSaveButton=!1,this.ongoingRequest=!1}ngOnInit(){this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.dateFormat=this.user.settings.dateFormat,this.timeFormat=this.user.settings.timeFormat,this.durationFormat=this.workspace.getTimeFormat(),this.entries=this.row.entries[this.index],this.selectedDate=ke(Object(ke.utc)(this.dateRange.start.clone())).add(this.index,"day").format(this.dateFormat),this.customFieldsForProject=this.filterCustomFieldsOfProject(),this.init()}ngAfterViewInit(){this.descriptionInput&&this.entries&&0!==this.entries.length&&this.descriptionInput.nativeElement.focus()}init(){var e;if(this.errorMessages=this.translate.instant(["TIMESHEET2.MESSAGES.SAVE_ERROR_MISSING_ALL","TIMESHEET2.MESSAGES.SAVE_ERROR_MISSING_TIME","TIMESHEET2.MESSAGES.SAVE_ERROR_MISSING_FIELDS"]),!this.entries||!this.entries.length){const t=this.createInterval(this.start,this.row.durationsByDay[this.index]);return this.initTime(t),this.initDesc(""),this.initTags([]),void this.initBillable(this.workspace.taskBillableEnabled&&(null===(e=this.row.task)||void 0===e?void 0:e.id)?this.row.task.billable:this.row.project.billable)}if(1===this.entries.length)return this.initTime(this.entries[0].timeInterval),this.initDesc(this.entries[0].description),this.initTags(this.entries[0].tags),void this.initBillable(this.entries[0].billable);const t=new ZA.a({start:this.start,end:this.start,duration:this.row.durationsByDay[this.index]});this.initTime(t),this.setDescriptionForMultipleEntries(),this.setTagsForMultipleEntries(),this.setBillableForMultipleEntries(),setTimeout(()=>{this.getDifferentValues()})}initDesc(e,t){this.descriptionValue=new kR(_R.DESCRIPTION,e,this.workspace.forceDescription,t)}initTags(e,t){this.tagValue=new kR(_R.TAG,e,this.workspace.forceTags,t)}initBillable(e,t){this.billableValue=new kR(_R.BILLABLE,e,!1,t)}initTime(e,t){this.timeValue=new kR(_R.TIME,e,!1,t)}createInterval(e,t){return new ZA.a({start:e,end:ke(e).add(t).toISOString(),duration:t||Object(ke.duration)(0)})}setDescriptionForMultipleEntries(){const e=!this.entries.every(e=>e.description===this.entries[0].description);this.initDesc(e?"":this.entries[0].description,e)}setTagsForMultipleEntries(){const e=!this.entries.every(e=>Object(sn.c)(e.tags.map(e=>e.id),this.entries[0].tags.map(e=>e.id)));this.initTags(e?[]:this.entries[0].tags,e)}setBillableForMultipleEntries(){const e=!this.entries.every(e=>e.billable===this.entries[0].billable);this.initBillable(!e&&this.entries[0].billable,e)}overrideDescription(){this.descriptionValue.different=!1,setTimeout(()=>{this.descriptionInput.nativeElement.focus()})}getDifferentValues(){this.descriptionValue.different&&this.differentValues.push(this.translate.instant("TIMESHEET2.SHARED.DESCRIPTIONS").toLowerCase()),this.tagValue.different&&this.differentValues.push(this.translate.instant("GLOBAL.TAGS_LABEL").toLowerCase()),this.billableValue.different&&this.differentValues.push(this.translate.instant("GLOBAL.BILLABLE_LABEL").toLowerCase()),this.differentValues.length>0&&(this.differentValues=this.differentValues.join(", ").split(","))}timeChanged(e){this.timeValue.value=e,this.shouldDisableSave()}pickedTime(e){this.timeValue.value=e,this.shouldDisableSave()}closeTagDropdown(e){e&&(this.tagValue.value=e,this.shouldDisableSave())}save(){this.ongoingRequest||(this.ongoingRequest=!0,this.shouldDisableSave(),this.disableSaveButton?this.toastForDisabledSave():setTimeout(()=>{const e=new en.a;e.description=this.descriptionValue.value,e.tags=this.tagValue.value,e.billable=this.billableValue.value,e.project=this.row.project,e.task=this.row.task,e.timeInterval=this.entries&&this.entries.length>1?this.timeValue.value:new ZA.a({start:Object(ke.utc)(this.timeValue.value.start),end:Object(ke.utc)(this.timeValue.value.end),duration:this.timeValue.value.duration});const t=[TO.a.TIMEINTERVAL,TO.a.CUSTOM_FIELDS];this.descriptionValue.different||t.push(TO.a.DESCRIPTION),this.tagValue.different||t.push(TO.a.TAG),this.billableValue.different||t.push(TO.a.BILLABLE),this.createEntryEmitter.emit({entry:e,entriesToEdit:this.entries,changeFields:t,index:this.index,customFieldValues:this.customFieldsForProject.filter(e=>e.isSameForAll)})}))}toastForDisabledSave(){this.disableSaveButton&&this.toaster.pop("error",this.timeValue.invalid&&(this.descriptionValue.invalid||this.tagValue.invalid)?this.errorMessages["TIMESHEET2.MESSAGES.SAVE_ERROR_MISSING_ALL"]:this.timeValue.invalid?this.errorMessages["TIMESHEET2.MESSAGES.SAVE_ERROR_MISSING_TIME"]:this.errorMessages["TIMESHEET2.MESSAGES.SAVE_ERROR_MISSING_FIELDS"])}closeEdit(){this.close.emit(!1)}shouldDisableSave(){this.disableSaveButton=this.descriptionValue.invalid||this.tagValue.invalid||this.timeValue.invalid}filterCustomFieldsOfProject(){if(!this.row.project)return this.customFields.filter(e=>e.status===jA.a.VISIBLE).map(e=>{const t=this.isSameValue(e);return new oO.a({customFieldId:e.id,customField:e,value:t?this.getValue(e):null,isSameForAll:t})});const e=this.customFields.filter(e=>e.status!==jA.a.VISIBLE&&e.projectDefaultValues.filter(e=>e.projectId===this.row.project.id&&e.status===jA.a.VISIBLE).length>0);return[...this.customFields.filter(e=>e.status===jA.a.VISIBLE&&0===e.projectDefaultValues.filter(e=>e.projectId===this.row.project.id&&e.status===jA.a.INVISIBLE).length),...e].map(e=>{const t=this.isSameValue(e);return new oO.a({customFieldId:e.id,customField:e,value:t?this.getValue(e):null,isSameForAll:t})})}getValue(e){if(this.entries&&this.entries.length>0){const t=this.entries[0].customFieldValues.filter(t=>t.customFieldId===e.id)[0];return t?t.value:null}}isSameValue(e){if(this.entries&&this.entries.length>0){const t=this.entries[0].customFieldValues&&this.entries[0].customFieldValues.filter(t=>t.customFieldId===e.id)[0];return this.entries.every(n=>{const i=n.customFieldValues&&n.customFieldValues.filter(t=>t.customFieldId===e.id)[0];return i&&t&&i.value===t.value})}return!1}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(r.a),s.Rb(re.a),s.Rb(l.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["edit-time-modal"]],viewQuery:function(e,t){var n;1&e&&s.gd(WR,!0),2&e&&s.Kc(n=s.kc())&&(t.descriptionInput=n.first)},inputs:{row:"row",index:"index",workspace:"workspace",user:"user",dateRange:"dateRange",start:"start",customFields:"customFields",ongoingRequest:"ongoingRequest"},outputs:{close:"close",createEntryEmitter:"createEntryEmitter"},decls:50,vars:38,consts:[[1,"cl-modal-content"],[1,"cl-modal-header"],["id","exampleModalLabel",1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group","cl-pb-2"],[1,"cl-h4"],[1,""],["class","cl-text-gray-9",4,"ngIf"],[1,"cl-row","cl-d-flex","cl-justify-content-between"],[1,"cl-col","cl-d-flex","cl-justify-content-center","cl-w-100"],[1,"cl-border","cl-px-2","cl-max-height-40","cl-rounded",3,"format","focusOnInput","focusOnInit","timeInterval","timeChanged"],["class","cl-col-8 cl-p-0 detailed-report-bulk-edit",4,"ngIf"],["class","cl-alert cl-alert-warning","role","alert",4,"ngIf"],[1,"cl-form-group","cl-row"],["for","descriptionName",1,"cl-col-sm-4","cl-col-form-label","cl-mb-0"],["class","cl-color-red",4,"ngIf"],[1,"cl-col-sm-8","cl-d-flex","cl-align-items-center"],[3,"click",4,"ngIf"],["class","cl-form-control","name","descriptionName","id","descriptionName","rows","2","autocomplete","off",3,"placeholder","ngModel","ngModelChange",4,"ngIf"],[1,"cl-col-sm-4","cl-col-form-label","cl-mb-0"],[3,"ngClass"],["class","cl-dropdown","dropdownKey","",4,"ngIf"],["class","cl-form-group cl-row cl-mb-0",4,"ngIf"],[4,"ngIf"],["class","cl-form-group cl-row cl-mb-0",4,"ngFor","ngForOf"],[1,"cl-modal-footer","l-text-capitalize"],[3,"click"],["type","button",1,"cl-btn","cl-btn-primary",3,"ngClass","click"],[1,"cl-text-gray-9"],[1,"cl-col-8","cl-p-0","detailed-report-bulk-edit"],[1,"cl-date-picker-white",3,"debounce","dateTime","mode","pickedDate"],["role","alert",1,"cl-alert","cl-alert-warning"],[1,"cl-color-red"],["name","descriptionName","id","descriptionName","rows","2","autocomplete","off",1,"cl-form-control",3,"placeholder","ngModel","ngModelChange"],["descriptionInput",""],["dropdownKey","",1,"cl-dropdown"],["type","button","dropdownKeyButton","",1,"cl-btn","cl-btn-outline-light","cl-w-100","cl-cut-text","cl-text-left","cl-dropdown-toggle"],[4,"ngIf","ngIfElse"],["noTagsTemplate",""],[1,"cl-cut-text-wrapper"],[1,"cl-dropdown"],["class","cl-dropdown-menu","resizeable","",3,"resizeableName","entryTags","close",4,"dropdownKeyContent"],[4,"ngFor","ngForOf"],["resizeable","",1,"cl-dropdown-menu",3,"resizeableName","entryTags","close"],[1,"cl-form-group","cl-row","cl-mb-0"],["class","cl-custom-control cl-custom-switch",4,"ngIf"],[1,"cl-custom-control","cl-custom-switch"],["type","checkbox","id","bill-2","name","billable",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","bill-2",1,"cl-custom-control-label"],[1,"cl-col-sm-8","cl-d-flex","cl-align-items-center","cl-cut-text-wrapper"],["class","cl-w-100",4,"ngIf"],[1,"cl-w-100"],[3,"customField"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"h1",2),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"button",3),s.jc("click",(function(){return t.closeEdit()})),s.Xb(6,"span"),s.Sb(7,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(8,"div",5),s.Xb(9,"div",6),s.Xb(10,"div",7),s.Zc(11),s.Wb(),s.Xb(12,"div",8),s.Zc(13),s.Wb(),s.Xc(14,XR,2,1,"div",9),s.Xc(15,NR,2,1,"div",9),s.Wb(),s.Sb(16,"hr"),s.Xb(17,"form"),s.Xb(18,"div",10),s.Xb(19,"div",11),s.Xb(20,"input-duration",12),s.jc("timeChanged",(function(e){return t.timeChanged(e)})),s.Wb(),s.Wb(),s.Xc(21,DR,2,3,"div",13),s.Wb(),s.Sb(22,"hr"),s.Xc(23,MR,3,6,"div",14),s.Xb(24,"div",15),s.Xb(25,"label",16),s.Zc(26),s.oc(27,"translate"),s.Xc(28,BR,2,0,"span",17),s.Wb(),s.Xb(29,"div",18),s.Xc(30,UR,3,3,"a",19),s.Xc(31,GR,3,4,"textarea",20),s.Wb(),s.Wb(),s.Xb(32,"div",15),s.Xb(33,"label",21),s.Zc(34),s.oc(35,"translate"),s.Xc(36,xR,2,0,"span",17),s.Wb(),s.Xb(37,"div",22),s.Xc(38,FR,3,3,"a",19),s.Xc(39,HR,8,2,"div",23),s.Wb(),s.Wb(),s.Xc(40,qR,7,5,"div",24),s.Xc(41,zR,1,0,"hr",25),s.Xc(42,ey,6,3,"div",26),s.Wb(),s.Wb(),s.Xb(43,"div",27),s.Xb(44,"a",28),s.jc("click",(function(){return t.closeEdit()})),s.Zc(45),s.oc(46,"translate"),s.Wb(),s.Xb(47,"button",29),s.jc("click",(function(){return t.save()})),s.Zc(48),s.oc(49,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.ad(s.pc(4,26,"TIMESHEET2.EDIT.TITLE")),s.Cb(8),s.ad(t.selectedDate),s.Cb(2),s.bd(" ",t.row.project.name," "),s.Cb(1),s.wc("ngIf",t.row.project.clientName||t.row.project.client),s.Cb(1),s.wc("ngIf",t.row.task&&t.row.task.id),s.Cb(5),s.wc("format",t.durationFormat)("focusOnInput",!0)("focusOnInit",!0)("timeInterval",t.timeValue&&t.timeValue.value),s.Cb(1),s.wc("ngIf",!(t.entries&&t.entries.length>1)),s.Cb(2),s.wc("ngIf",t.descriptionValue.different),s.Cb(3),s.bd(" ",s.pc(27,28,"GLOBAL.DESCRIPTION_LABEL")," "),s.Cb(2),s.wc("ngIf",t.workspace.forceDescription),s.Cb(2),s.wc("ngIf",t.descriptionValue.different),s.Cb(1),s.wc("ngIf",!t.descriptionValue.different),s.Cb(3),s.bd(" ",s.pc(35,30,"GLOBAL.TAGS_LABEL")," "),s.Cb(2),s.wc("ngIf",t.workspace.forceTags),s.Cb(1),s.wc("ngClass",t.tagValue.different?"cl-col-sm-8 cl-d-flex cl-align-items-center":"cl-col-sm-8"),s.Cb(1),s.wc("ngIf",t.tagValue.different),s.Cb(1),s.wc("ngIf",!t.tagValue.different),s.Cb(1),s.wc("ngIf",t.workspace.activeBillableHours&&(!t.workspace.onlyAdminsCanChangeBillableStatus||t.isAdminOrOwner)),s.Cb(1),s.wc("ngIf",(null==t.customFieldsForProject?null:t.customFieldsForProject.length)>0),s.Cb(1),s.wc("ngForOf",t.customFieldsForProject),s.Cb(3),s.ad(s.pc(46,32,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("ngClass",s.Bc(36,ty,t.ongoingRequest||t.disableSaveButton)),s.Cb(1),s.bd(" ",s.pc(49,34,"GLOBAL.SAVE_LABEL")," "))},directives:[i.u,v.I,v.t,v.u,BO.a,i.r,i.t,zr.a,v.c,v.s,v.v,ni.a,ii.a,si.a,PO.a,DO.a,v.a,OT.a],pipes:[g.e],encapsulation:2}),e})();const iy=["rowComponent"];function sy(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",34),s.Zc(1),s.oc(2,"stringDurationToTime"),s.oc(3,"translate"),s.Xb(4,"a",35),s.jc("click",(function(){return s.Oc(e),s.nc().fixEntriesWithoutProject()})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"button",36),s.jc("click",(function(){return s.Oc(e),s.nc().closeEntriesAlert()})),s.Xb(8,"span"),s.Zc(9,"\xd7"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.dd(" ",e.entriesAlert," (",s.qc(2,4,e.entriesWithoutTaskTotal,e.format),") ",s.pc(3,7,"TIMESHEET2.TIME_ENTRY.ALERT.WARNING_MESSAGE")," "),s.Cb(4),s.ad(s.pc(6,9,"TIMESHEET2.FIX"))}}function cy(e,t){1&e&&(s.Xb(0,"span",39),s.oc(1,"translate"),s.Sb(2,"img",40),s.Wb()),2&e&&s.wc("ngbTooltip",s.pc(1,1,"TRACKER.APPROVALS.ZONE.MISMATCH"))}function ay(e,t){1&e&&(s.Xb(0,"span",44),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.APPROVED_LABEL")))}function oy(e,t){if(1&e){const e=s.Yb();s.Xb(0,"span",46),s.oc(1,"translate"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"span",47),s.jc("click",(function(){s.Oc(e);const t=s.nc(4),n=s.Lc(42);return t.openModal(n)})),s.oc(5,"translate"),s.Zc(6," \u2715 "),s.Wb(),s.Wb()}if(2&e){const e=s.nc(4);s.wc("title",s.pc(1,3,"APPROVAL.DETAILS.SUBMITTED_BY")+": "+e.approvalRequestCreator),s.Cb(2),s.bd(" ",s.pc(3,5,"GLOBAL.PENDING_APPROVAL")," "),s.Cb(2),s.xc("title",s.pc(5,7,"GLOBAL.WITHDRAW_HEADER_APPROVAL"))}}function ry(e,t){if(1&e&&s.Xc(0,oy,7,9,"span",45),2&e){const e=s.nc(3);s.wc("ngIf","PENDING"==e.approvalStatus)}}function ly(e,t){if(1&e&&(s.Xb(0,"div",41),s.Xc(1,ay,3,3,"span",42),s.Xc(2,ry,1,1,"ng-template",null,43,s.Yc),s.Wb()),2&e){const e=s.Lc(3),t=s.nc(2);s.Cb(1),s.wc("ngIf",t.isApproved)("ngIfElse",e)}}function by(e,t){if(1&e&&(s.Vb(0),s.Xc(1,cy,3,3,"span",37),s.Xc(2,ly,4,2,"div",38),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.timeZoneMissmatch),s.Cb(1),s.wc("ngIf",!e.timeZoneMissmatch)}}function dy(e,t){if(1&e){const e=s.Yb();s.Xb(0,"teammate-picker2",48),s.jc("userSelected",(function(t){return s.Oc(e),s.nc().selectUser(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("hasAddTimeForOthersFeature",e.hasAddTimeForOthersFeature)("selectedUser",e.selectedUser)("workspace",e.workspace)}}function uy(e,t){1&e&&s.Sb(0,"img",49)}function py(e,t){1&e&&s.Sb(0,"img",50)}function hy(e,t){if(1&e&&(s.Xb(0,"span",60),s.Zc(1),s.oc(2,"stringDurationToTime"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.ad(s.qc(2,1,e.total,e.format))}}function my(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",61),s.jc("click",(function(){s.Oc(e);const t=s.nc(2);return t.expandAll=!t.expandAll})),s.Xb(1,"span",62),s.Sb(2,"img",63),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.wc("src",e.expandAll?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",s.Qc)}}function gy(e,t){if(1&e&&(s.Xb(0,"th",67),s.Xb(1,"span",68),s.Zc(2),s.oc(3,"momentToLocaleDateString"),s.Wb(),s.Wb()),2&e){const e=t.$implicit,n=s.nc(3);s.Cb(2),s.ad(s.qc(3,1,e,n.currentLanguage))}}function Ey(e,t){if(1&e&&(s.Vb(0),s.Xc(1,gy,4,4,"th",64),s.Xb(2,"th",65),s.Xb(3,"span",66),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngForOf",e.momentWeek),s.Cb(3),s.ad(s.pc(5,2,"GLOBAL.TOTAL_TIME"))}}function fy(e,t){if(1&e&&s.Sb(0,"time-off-band",74),2&e){const e=s.nc().index,t=s.nc(3);s.wc("dailyTimeOffs",t.weekDayTimeOffs[e])}}function Sy(e,t){if(1&e&&(s.Xb(0,"td",71),s.Xb(1,"div",72),s.Xc(2,fy,1,1,"time-off-band",73),s.Wb(),s.Wb()),2&e){const e=s.nc(3);s.Cb(2),s.wc("ngIf",e.weekHasTimeOff)}}function Cy(e,t){if(1&e&&(s.Xb(0,"tr"),s.Sb(1,"td",69),s.Xc(2,Sy,3,1,"td",70),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.wc("ngForOf",e.week)}}function Ay(e,t){if(1&e){const e=s.Yb();s.Xb(0,"tr",75,76),s.jc("delete",(function(){s.Oc(e);const n=t.$implicit,i=s.nc(2),c=s.Lc(36);return i.openDeleteRowModal(n,c)}))("changeDuration",(function(n){s.Oc(e);const i=t.$implicit;return s.nc(2).changeInputDuration(i,n.index,n.duration)}))("selectedProjectAndTask",(function(n){s.Oc(e);const i=t.$implicit;return s.nc(2).changeProject(n,i)}))("preventOpenPickerOnTab",(function(){return s.Oc(e),s.nc(2).preventOpeningPicker()}))("openNextPicker",(function(n){s.Oc(e);const i=t.index;return s.nc(2).openNextRowPicker(n,i)}))("focusedRow",(function(t){return s.Oc(e),s.nc(2).focusedRow(t)}))("lockedWeek",(function(t){return s.Oc(e),s.nc(2).getLockedWeek(t)}))("openModalEmitter",(function(t){s.Oc(e);const n=s.nc(2),i=s.Lc(38);return n.openEditModal(t,i)})),s.Wb()}if(2&e){const e=t.$implicit,n=t.index,i=s.nc(2);s.wc("timesheetRow",e)("week",i.week)("momentWeek",i.momentWeek)("format",i.format)("isAdminOrOwner",i.isAdminOrOwner)("dateRange",i.dateRange)("workspace",i.workspace)("projectPickerSpecialFilter",i.projectPickerSpecialFilter)("isDesktop",i.isDesktop)("timesheetRows",i.timesheetRows)("selectedUser",i.selectedUser)("forbidManagerEdit",i.forbidManagerEdit)("expandAll",i.expandAll)("userGroups",i.userGroups)("index",n)("disableManualMode",i.disableManualMode)("dailyTimeOffs",i.weekDayTimeOffs)}}function Oy(e,t){if(1&e&&s.Sb(0,"tr",77),2&e){const e=s.nc(2);s.wc("week",e.momentWeek)("format",e.format)("totalList",e.totalList)("total",e.total)("isDesktop",e.isDesktop)("expandAll",e.expandAll)}}function vy(e,t){if(1&e&&(s.Xb(0,"table",51),s.Xb(1,"thead",52),s.Xb(2,"tr"),s.Xb(3,"th",53),s.Xb(4,"div",54),s.Xb(5,"span"),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"div",55),s.Xc(9,hy,3,4,"span",56),s.Xc(10,my,3,1,"a",57),s.Wb(),s.Wb(),s.Wb(),s.Xc(11,Ey,6,4,"ng-container",7),s.Wb(),s.Wb(),s.Xb(12,"tbody"),s.Xc(13,Cy,3,1,"tr",7),s.Xc(14,Ay,2,17,"tr",58),s.Xc(15,Oy,1,6,"tr",59),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Hb("cl-compact",e.isCompactViewOn),s.Cb(6),s.ad(s.pc(7,9,"GLOBAL.PROJECTS_LABEL")),s.Cb(3),s.wc("ngIf",!e.isDesktop),s.Cb(1),s.wc("ngIf",!e.isDesktop),s.Cb(1),s.wc("ngIf",e.isDesktop),s.Cb(2),s.wc("ngIf",e.weekHasTimeOff&&e.isDesktop),s.Cb(1),s.wc("ngForOf",e.timesheetRows),s.Cb(1),s.wc("ngIf",e.totalList)}}function Ty(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",78),s.jc("click",(function(){return s.Oc(e),s.nc().addRow()})),s.Sb(1,"img",79),s.Xb(2,"span",26),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("disabled",e.disableManualMode),s.Cb(3),s.ad(s.pc(4,2,"TIMESHEET2.ACTIONS.NEW_ROW.ADD"))}}function Iy(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",87),s.jc("click",(function(){return s.Oc(e),s.nc(3).copyLastWeek()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"COPY_ACTIVITIES_ONLY"),""))}function wy(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",84),s.Xc(1,Iy,3,3,"button",85),s.Xb(2,"button",86),s.jc("click",(function(){return s.Oc(e),s.nc(2).copyTimeEntries()})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",!e.forbidManagerEdit),s.Cb(1),s.wc("disabled",e.isWeekLocked),s.Cb(1),s.bd(" ",s.pc(4,3,"COPY_ACTIVITIES_AND_TIME")," ")}}function Ly(e,t){if(1&e&&(s.Xb(0,"div",80),s.oc(1,"translate"),s.Xb(2,"button",81),s.Sb(3,"img",82),s.Xb(4,"span",26),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Xc(7,wy,5,5,"div",83),s.Wb()),2&e){const e=s.nc();s.wc("title",s.pc(1,3,e.disableManualMode?"TIMESHEET2.MESSAGES.DISABLED_MANUAL":"")),s.Cb(2),s.wc("disabled",e.disableManualMode||e.hasProjects),s.Cb(3),s.ad(s.pc(6,5,"TIMESHEET2.ACTIONS.COPY.LAST_WEEK"))}}function Ry(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",88),s.jc("click",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(40);return t.openModal(n)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"TIMESHEET2.ACTIONS.APPROVAL")," "))}function yy(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",93),s.Xb(1,"template-row",94),s.jc("templateApplied",(function(){s.Oc(e);const n=t.$implicit;return s.nc(2).applyTemplate(n)}))("templateEdited",(function(n){s.Oc(e);const i=t.$implicit,c=t.index;return s.nc(2).editTemplate(i,c,n)}))("templateDeleted",(function(){s.Oc(e);const n=t.$implicit;return s.nc(2).deleteTemplate(n)})),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc(2);s.Cb(1),s.wc("template",e)("hasEntries",n.hasEntries)("disableManualMode",n.disableManualMode)}}function _y(e,t){if(1&e&&(s.Xb(0,"div",89),s.Xb(1,"div",90),s.Xb(2,"span",91),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Xc(5,yy,2,3,"div",92),s.Wb()),2&e){const e=s.nc();s.Cb(3),s.ad(s.pc(4,2,"TIMESHEET2.TEMPLATE.TITLE")),s.Cb(2),s.wc("ngForOf",e.savedTemplates)}}function ky(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",95),s.Xb(1,"h1",96),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",36),s.jc("click",(function(){return s.Oc(e),s.nc().closeModal()})),s.Xb(5,"span"),s.Sb(6,"img",97),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",98),s.Xb(8,"form"),s.Xb(9,"div",99),s.Xb(10,"div"),s.Xb(11,"input",100),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().newTemplateName=t}))("keyup.enter",(function(){s.Oc(e);const t=s.nc();return t.saveTemplate(t.newTemplateName)})),s.oc(12,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(13,"div",101),s.Xb(14,"input",102),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().saveTimeChecked=t})),s.Wb(),s.Xb(15,"label",103),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(18,"div",104),s.Xb(19,"a",105),s.jc("click",(function(){return s.Oc(e),s.nc().closeModal()})),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Xb(22,"button",106),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.saveTemplate(t.newTemplateName)})),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,9,"TIMESHEET2.TEMPLATE.CREATE.TITLE")),s.Cb(9),s.xc("placeholder",s.pc(12,11,"TIMESHEET2.TEMPLATE.CREATE.NAME")),s.wc("ngModel",e.newTemplateName),s.Cb(3),s.wc("disabled",!1)("ngModel",e.saveTimeChecked),s.Cb(2),s.bd(" ",s.pc(17,13,"TIMESHEET2.TEMPLATE.SAVE_TIME_ALSO")," "),s.Cb(4),s.ad(s.pc(21,15,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",""===e.newTemplateName.trim()),s.Cb(1),s.bd(" ",s.pc(24,17,"GLOBAL.SAVE_LABEL")," ")}}function Wy(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",95),s.Xb(1,"h1",96),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",36),s.jc("click",(function(){return s.Oc(e),s.nc().closeModal()})),s.Xb(5,"span"),s.Sb(6,"img",97),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",98),s.Xb(8,"p"),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Xb(11,"p",107),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Xb(14,"div",104),s.Xb(15,"a",105),s.jc("click",(function(){return s.Oc(e),s.nc().closeModal()})),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Xb(18,"button",108),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.removeRow(t.selectedRow)})),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.ad(s.pc(3,5,"GLOBAL.DELETE_BTN")),s.Cb(7),s.ad(s.pc(10,7,"TIMESHEET2.TIME_ENTRY.DELETE.CONFIRM")),s.Cb(3),s.ad(s.pc(13,9,"TIMESHEET2.TIME_ENTRY.DELETE.INFO_MESSAGE")),s.Cb(4),s.ad(s.pc(17,11,"GLOBAL.CANCEL_BTN")),s.Cb(3),s.bd(" ",s.pc(20,13,"GLOBAL.DELETE_BTN")," "))}function Xy(e,t){if(1&e){const e=s.Yb();s.Xb(0,"edit-time-modal",109),s.jc("close",(function(n){s.Oc(e);const i=t.$implicit,c=s.nc();return i.close(n),c.closeEditModal()}))("createEntryEmitter",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().createOrUpdateFromBulk(n,i)})),s.Wb()}if(2&e){const e=s.nc();s.wc("row",e.selectedTSR)("index",e.index)("workspace",e.workspace)("user",e.user)("dateRange",e.dateRange)("start",e.startForModal)("customFields",e.customFields)("ongoingRequest",e.ongoingRequest)}}const Ny=function(e,t){return{startDate:e,endDate:t}};function Dy(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",110),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().submitApproval(n)}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",111),s.Zc(4),s.oc(5,"translate"),s.oc(6,"momentUtcFormat"),s.oc(7,"momentUtcFormat"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,"GLOBAL.TIME_ENTRY_APPROVE_SUBMIT"))("btnText",s.pc(2,6,"GLOBAL.SUBMIT"))("inProgress",e.inProgress),s.Cb(4),s.bd(" ",s.qc(5,8,"TRACKER.APPROVALS.SUBMIT_APPROVAL_MSG",s.Cc(17,Ny,s.qc(6,11,e.dateRange.start.toISOString(),"MMM D"),s.qc(7,14,e.dateRange.end.toISOString(),"MMM D")))," ")}}function Py(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",110),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().withdrawApproval(n)}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",111),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,"GLOBAL.WITHDRAW_LABEL"))("btnText",s.pc(2,6,"TIMESHEET2.WITHDRAW"))("inProgress",e.inProgress),s.Cb(4),s.bd(" ",s.pc(5,8,"GLOBAL.WITHDRAW_MESSAGE")," ")}}let My=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r,l,b,d,u,p,h,m,g,E,f,S,C,A){this.workspaceService=e,this.approvalService=t,this.notificationService=n,this.authService=i,this.timezoneConverter=s,this.systemSettingsService=c,this.toaster=a,this.tracker2Service=o,this.browserService=r,this.userService=l,this.userGroupService=b,this.tagService=d,this.cd=u,this.router=p,this.modalService=h,this.customFieldService=m,this.translate=g,this.translationStore=E,this.ptoService=f,this.timeOffhelperService=S,this.route=C,this.analyticsService=A,this.newTemplateName="",this.timesheetRows=[],this.savedRows=[],this.canManagerCopyWithTime=!0,this.zoomLevel="week",this.entriesAlert="",this.pickerNeverOpened=!0,this.ongoingRequest=!1,this.customFields=[],this.timeOffs=[],this.weekDayTimeOffs=[],this.weekHasTimeOff=!1,this.saveTimeChecked=!1,this.unsubscribe$=new Fn.a}ngOnInit(){this.currentLanguage=this.translationStore.getCurrentLang(),this.subscribeToBrowserWidth(),this.subscribeToWorkspace(),this.user=this.authService.getUser(),this.projectPickerSpecialFilter=this.user.settings.projectPickerSpecialFilter,this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.timeZone=this.user.settings.timeZone,this.initDateRangeAndSelectedUser(),this.format=this.workspace.getTimeFormat(),this.isCompactViewOn=this.user.settings.isCompactViewOn,this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.hasAddTimeForOthersFeature=this.workspace.hasFeature(is.a.ADD_TIME_FOR_OTHERS);const e=this.workspace.hasFeature(is.a.CUSTOM_FIELDS);e&&this.customFieldService.get().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.customFields=e,this.cd.detectChanges()}),this.canManagerEditUsersTime=this.workspace.hasFeature(is.a.ADD_TIME_FOR_OTHERS)&&this.workspace.hasFeature(is.a.MANAGER_ROLE)&&this.workspace.canManagerEditUsersTime,this.tracker2Service.savedTemplates.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.savedTemplates=e,this.checkIfShouldShowTemplates(),this.cd.detectChanges()}),this.tracker2Service.newTemplate.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.savedTemplates.push(new IL.a(e)),this.checkIfShouldShowTemplates(),this.cd.detectChanges()}),this.userGroupService.userGroups.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.userGroups=e,this.cd.detectChanges()}),e&&this.customFieldService.get().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.customFields=e,this.cd.detectChanges()}),this.notificationService.timeZoneMissmatch$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.timeZoneMissmatch=e,this.cd.markForCheck()}),this.makeWeek(),this.fetchRequests(),this.getEntriesForCurrentWeek(),this.tagService.clearTagsSubject(),this.systemSettingsService.getSystemSettings(),this.tracker2Service.getTemplates(),this.userGroupService.getAllUserGroups()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initDateRangeAndSelectedUser(){this.route.queryParams.pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{e.userId?(this.tmpSelectedUserId=e.userId,this.workspaceService.getUsersByIds([e.userId]).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.selectedUser=e&&e.length?new Ca.a(e[0]):this.user})):this.selectedUser=this.user,e.start&&e.end?(this.dateRange={start:this.timezoneConverter.addOffsetToUTCTime(ke(e.start)),end:this.timezoneConverter.addOffsetToUTCTime(ke(e.end))},this.dateRangeNonUTC={start:ke(e.start),end:ke(e.end)}):this.dateRange=Object(wc.d)(this.user.settings.weekStart,this.timezoneConverter)})}get showSubmitForAll(){var e,t,n,i;return!this.timeZoneMissmatch&&(null===(e=this.timeEntries)||void 0===e?void 0:e.length)&&(null===(t=this.selectedUser)||void 0===t?void 0:t.id)===(null===(n=this.user)||void 0===n?void 0:n.id)&&(null===(i=this.workspace)||void 0===i?void 0:i.timeApprovalEnabled)&&!this.isApproved&&this.approvalStatus!=Ht.PENDING}subscribeToWorkspace(){this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e,this.disableManualMode=this.workspace.disableManualMode,this.subscribeToUserRolesOnce()})}subscribeToUserRolesOnce(){this.authService.isUserAdminOnWorkspace(this.workspace.id).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isTeamManager=!this.isAdminOrOwner&&e.isTeamManager,this.checkTeamManagerPrivileges(),this.cd.detectChanges()})}checkTeamManagerPrivileges(){var e;this.forbidManagerEdit=this.isTeamManager&&this.user.id!==(null===(e=this.selectedUser)||void 0===e?void 0:e.id)&&!this.canManagerEditUsersTime}subscribeToBrowserWidth(){this.browserService.isBreakpointLg$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e,this.cd.detectChanges()})}updateDateRange(e){this.dateRange&&!Object(TL.a)(e.dateRange,this.dateRange)&&(this.dateRange.start=e.dateRange.start,this.dateRange.end=e.dateRange.end,this.dateRange.label=e.dateRange.label,this.zoomLevel=e.zoomLevel,this.makeWeek(),this.getEntriesForCurrentWeek(),this.fetchRequests()),this.makeAllTemplatesInactive()}makeWeek(){var e;const t=ke.utc(this.dateRange.start);this.week=[],this.week.push(ke(t).format("dd, MMM D"));for(let n=1;n<7;n++)this.week.push(ke(t).add(n,"days").format("dd, MMM D"));this.getTimeEntriesInRange((null===(e=this.selectedUser)||void 0===e?void 0:e.id)||this.tmpSelectedUserId,t,this.dateRange.end)}getTimeEntriesInRange(e,t,n){var i;const s=this.tracker2Service.getTimeEntriesForTimesheet(e,t.toISOString(),n.toISOString());let c;if(this.workspace.timeApprovalEnabled&&this.user.id===((null===(i=this.selectedUser)||void 0===i?void 0:i.id)||this.tmpSelectedUserId)){const e=this.dateRange.start.toISOString(),t=ke.utc(this.dateRange.start).format("YYYY-MM-DD");c=Object(Sb.a)(s,this.approvalService.getWeekStatus(e,t))}else c=Object(Sb.a)(s),this.approvalRequestId=null,this.approvalStatus=null;c.pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(([e,t])=>{this.approvalRequestId=null==t?void 0:t.id,this.approvalStatus=null==t?void 0:t.status,this.approvalRequestCreator=null==t?void 0:t.submitterName,this.isApproved=e.length&&e.every(e=>!!e.approvalRequestId),this.timeEntries=e,this.timesheetRows=[],this.entriesWithoutTaskCount=0,this.entriesWithoutTaskTotal=Object(ke.duration)(0),this.fillTimesheetWithEntries(e.filter(e=>e.approvalRequestId),!0),this.fillTimesheetWithEntries(e.filter(e=>!e.approvalRequestId),!1),this.isMe()&&this.addFromSavedRows(),this.sortTimesheetRowsByName(),this.calculateTotals(),this.isApproved||this.disableManualMode||this.addRow(),this.cd.detectChanges()})}refreshIsApproved(){this.workspace.timeApprovalEnabled&&(this.isApproved=this.timeEntries.length&&this.timeEntries.every(e=>!!e.approvalRequestId),this.cd.markForCheck())}fillTimesheetWithEntries(e,t){e.forEach(e=>{if(null===e.timeInterval.end)return;if(!(this.workspace.forceTasks?e.project&&e.task:e.project))return this.entriesWithoutTaskCount++,void(this.entriesWithoutTaskTotal=Object(ke.duration)(this.entriesWithoutTaskTotal).add(Object(ke.duration)(e.timeInterval.duration)));const n=Object(ke.utc)(e.timeInterval.start).clone().add(ke(Object(ke.utc)(e.timeInterval.start)).tz(this.timeZone).utcOffset(),"minutes").startOf("day").diff(this.dateRange.start.clone(),"day"),i=this.timesheetRows.filter(t=>this.areProjectAndTaskTheSame(t.project,t.task,e.project,e.task)).filter(e=>e.isApproved===t)[0];if(!i){const i=[],s=[];return i[n]=Object(ke.duration)(e.timeInterval.duration),s[n]=[e],void this.timesheetRows.push(new LL.a(e.project,e.task,i,s,t))}i.durationsByDay[n]||(i.durationsByDay[n]=Object(ke.duration)(0),i.entries[n]=[]),i.durationsByDay[n]=Object(ke.duration)(i.durationsByDay[n]).add(Object(ke.duration)(e.timeInterval.duration)),i.entries[n]=[...i.entries[n],e]}),this.entriesAlert=this.entriesWithoutTaskCount>0?this.translate.instant("TIMESHEET2.MESSAGES.ENTRIES_ALERT",{count:this.entriesWithoutTaskCount}):""}addFromSavedRows(){const e=this.getSavedRows();e&&(this.savedRows=e.filter(e=>e.date===this.dateRange.start.clone().toISOString()),this.savedRows.length&&this.savedRows.forEach(e=>{this.timesheetRows.filter(t=>this.areProjectAndTaskTheSame(t.project,e.project,t.task,e.task)).length||this.timesheetRows.push(new LL.a(e.project,e.task,[],[]))}))}addRow(){this.timesheetRows.push(new LL.a(null,null,[],[]))}removeRow(e){(e.project||1!==this.timesheetRows.filter(e=>!e.project).length)&&(this.removeDependingOnData(e),this.makeAllTemplatesInactive(),this.checkIfProjectExists())}removeDependingOnData(e){if(e.project){if(!e.entries.length&&this.isMe())return this.removeFromSavedRows(e.project,e.task),void this.timesheetRows.splice(this.timesheetRows.indexOf(e),1);e.entries.length&&(e.entries.every(e=>e.every(e=>!e.isLocked))||this.isAdminOrOwner?this.removeWholeRow(e):this.removeUnlockedEntriesFromRow(e))}else this.timesheetRows.splice(this.timesheetRows.indexOf(e),1)}removeWholeRow(e){const t=[].concat(...e.entries.filter(e=>e&&!!e.length));0!==t.length?this.tracker2Service.deleteMany(t.map(e=>e.id),this.selectedUser.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.timesheetRows.splice(this.timesheetRows.indexOf(e),1),this.deleteEntries(t),this.refreshIsApproved(),this.calculateTotals(),this.closeModal()},()=>{this.closeModal()}):this.closeModal()}removeUnlockedEntriesFromRow(e){const t=LL.a.clone(e),n=this.timezoneConverter.addOffsetToUTCTime(this.dateRange.start.clone()),i=this.timezoneConverter.addOffsetToUTCTime(ke(this.workspace.lockTimeEntries).clone()),s=ke(i).startOf("day").diff(ke(n).startOf("day"),"days"),c=[].concat(...e.entries.slice(s,7).filter(e=>e&&!!e.length));0!==c.length?this.tracker2Service.deleteMany(c.map(e=>e.id),this.selectedUser.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.deleteEntries(t),e.entries.fill([],s,7),e.durationsByDay.fill(null,s,7),this.closeModal(),this.formatRowDurations(e),this.calculateTotals()},()=>{e=t,this.closeModal()}):this.closeModal()}createEntry(e,t,n,i){this.tracker2Service.createForUser(e,this.selectedUser.id,i||[],this.approvalStatus==Ht.PENDING?{message:this.translate.instant("TIMESHEET2.MESSAGES.TIME_SUBMIT_SUCCESS")}:null).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.addEntryToTimesheet(e,t,n),this.closeEditModal(),this.isMe()&&this.removeFromSavedRows(t.project,t.task),this.refreshIsApproved(),this.ongoingRequest=!1},e=>{this.ongoingRequest=!1,this.cd.detectChanges()})}updateEntries(e,t,n){this.tracker2Service.updateMany(e,this.selectedUser.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.replaceEntriesInRow(t,n,e),this.closeEditModal(),this.ongoingRequest=!1},e=>{this.ongoingRequest=!1})}bulkEdit(e,t,n,i,s,c){this.tracker2Service.updateGroup(i,s,n,c).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.getAllEntries(),this.closeEditModal(),this.ongoingRequest=!1},e=>this.ongoingRequest=!1)}updateOne(e,t,n,i,s){const c=e.entries[t].map(e=>e.id);this.tracker2Service.updateGroup(c,i,n,s).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.updateRow(e,t,[n],Object(ke.duration)(n.timeInterval.duration)),this.closeEditModal(),this.ongoingRequest=!1},e=>{this.ongoingRequest=!1,this.cd.detectChanges()})}updateMultiple(e,t,n,i,s,c){const a=Object(ke.duration)(n).subtract(Object(ke.duration)(e.durationsByDay[t])),o=s&&1===s.length&&s[0]===TO.a.TIMEINTERVAL;a.asSeconds()<0?this.subtractAndUpdate(e,t,a,i,s,c):(o||this.bulkEdit(e,t,i,e.entries[t].map(e=>e.id),s.filter(e=>e!==TO.a.TIMEINTERVAL),c||[]),a.asSeconds()>0&&(i.timeInterval=new ZA.a({start:i.timeInterval.start,end:ke(i.timeInterval.start).add(a).toISOString(),duration:a}),this.createEntry(i,e,t,c||[])))}subtractAndUpdate(e,t,n,i,s,c){const a=e.entries[t];a.sort(Object(kc.a)(e=>ke(e.timeInterval.start).unix(),!0)),this.updateEntries(this.subtractFromEntries(a,n,i,s,c),e,t)}subtractFromEntries(e,t,n,i,s){const c=[...e],a=[];let o=0;for(;t.asSeconds()<0;){const n=Object(ke.duration)(e[o].timeInterval.duration);n.asSeconds()>0-t.asSeconds()?(c[o].timeInterval.duration=Object(ke.duration)(e[o].timeInterval.duration).add(t).toISOString(),c[o].timeInterval.end=ke(c[o].timeInterval.end).add(t).toISOString()):(c[o].timeInterval.duration=Object(ke.duration)(0).toISOString(),c[o].timeInterval.end=e[o].timeInterval.start),a.push(c[o]),t=t.add(n),o++}return n?(e.forEach(e=>{0==a.filter(t=>t.id==e.id).length&&a.push(e)}),this.applyChangesToEntries(a,n,i,s)):a}changeProject(e,t){t.entries&&t.entries.length?this.changeProjectOfRowWithEntries(t,e):this.changeProjectOfRowWithoutEntries(t,e)}changeProjectOfRowWithoutEntries(e,t){e.project=t.project,e.task=t.task,this.isMe()&&(this.removeFromSavedRows(e.project,e.task),this.addToSavedRows(t.project,t.task)),this.timesheetRows.every(e=>!!e.project)&&this.addRow()}changeProjectOfRowWithEntries(e,t){const n=[].concat(...e.entries.filter(e=>!!e)),i=new Sa.a;i.projectId=t.project&&t.project.id,i.taskId=t.task&&t.task.id,i.billable=this.decideBillability(t);const s=n.map(e=>e.id);this.tracker2Service.updateGroup(s,[TO.a.PROJECT,TO.a.TASK,TO.a.BILLABLE],i).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(n=>{e.project=t.project,e.task=t.task,e.entries.forEach(e=>{e.forEach(e=>{e.project=t.project,e.task=t.task,e.billable=this.decideBillability(e),e.customFieldValues=n.find(t=>t.id==e.id).customFieldValues})}),this.timesheetRows.every(e=>!!e.project)&&this.addRow(),this.timeEntries=[...this.timeEntries.filter(e=>-1===s.indexOf(e.id)),...[].concat(...e.entries.filter(e=>!!e))],this.timesheetRows=[...this.timesheetRows],this.cd.detectChanges()},e=>{this.getAllEntries()})}updateRow(e,t,n,i){e.entries[t]=n,e.durationsByDay[t]=i;const s=n.map(e=>e.id);this.timeEntries=[...this.timeEntries.filter(e=>-1===s.indexOf(e.id)),...n],this.formatRowDurations(e),this.calculateTotals()}changeInputDuration(e,t,n){if(n=Object(ke.duration)(n,"second").asMilliseconds().toString(),Object(ke.duration)(n).asSeconds()===Object(ke.duration)(0).asSeconds())return void this.removeEntries(e,t);if(0===Object(ke.duration)(n).subtract(Object(ke.duration)(e.durationsByDay[t])).asSeconds())return;const i=this.getStartTimeFromEntries(t);if(e.entries[t]&&1===e.entries[t].length){const i=e.entries[t][0];return i.timeInterval=new ZA.a({start:i.timeInterval.start,end:ke(i.timeInterval.start).add(Object(ke.duration)(n)).toISOString(),duration:Object(ke.duration)(n)}),void this.updateOne(e,t,i,[TO.a.TIMEINTERVAL])}if(!e.entries[t]||!e.entries[t].length){const s=this.createEntryFromTimesheet(e,i,n);return void this.createEntry(new en.a(s,e.project,e.task,this.selectedUser),e,t)}const s=e.entries[t][0],c=s.customFieldValues&&s.customFieldValues.length?s.customFieldValues.map(e=>new oO.a(e)):[];this.updateMultiple(e,t,n,new en.a(s,e.project,e.task,this.selectedUser),[TO.a.TIMEINTERVAL],c)}createOrUpdateFromBulk(e,t){this.ongoingRequest=!0,this.openedModal=t;const n=e.entry,i=e.entriesToEdit,s=e.customFieldValues;if(n.description=n.description.split("\n").join("\n "),i&&0!==i.length)return 1===i.length?(n.id=i[0].id,void this.updateOne(this.selectedTSR,e.index,n,e.changeFields,s)):void this.updateMultiple(this.selectedTSR,e.index,n.timeInterval.duration,n,e.changeFields,s);this.createEntry(n,this.selectedTSR,e.index,s)}removeEntries(e,t){if(!e.entries[t]||!e.entries[t].length)return;const n=LL.a.clone(e);this.tracker2Service.deleteMany(e.entries[t].map(e=>e.id),this.selectedUser.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(n=>{this.deleteEntries(n),e.entries[t]=[],e.durationsByDay[t]=null,this.formatRowDurations(e),this.refreshIsApproved(),this.calculateTotals()},()=>{e=n})}getStartTimeFromEntries(e){const t=(n=this.timeZone,i=this.week[e],this.timeEntries.filter(e=>ke.tz(e.timeInterval.start,n).format("dd, MMM D")===i&&null!==e.timeInterval.end));var n,i;if(0===t.length)return this.getStartTimeFromSettings(e);const s=t.map(e=>ke(e.timeInterval.start).unix()),c=t[s.indexOf(Math.max(...s))].timeInterval.end;return ke(c).format("dd, MMM D")!==this.week[e]?this.getStartTimeFromSettings(e):c}getStartTimeFromSettings(e){const t=this.authService.getUser().settings.myStartOfDay,n=this.dateRange.start.clone().add(e,"day").add(1,"hour"),i=ke(t,"hh:mm"),s=Object(ke.utc)(ke(n.clone())).set("hour",i.hour()).set("minutes",i.minutes());return ke(s.clone().subtract(ke(Object(ke.utc)()).tz(this.timeZone).utcOffset(),"minutes")).toISOString()}addToSavedRows(e,t){this.savedRows=this.getSavedRows(),this.savedRows.push(new _L(this.dateRange.start.toISOString(),e,t)),this.setSavedRows(this.savedRows)}addMultipleToSavedRows(e){this.savedRows=this.getSavedRows(),this.savedRows=[...this.savedRows,...e.map(e=>new _L(this.dateRange.start.toISOString(),e.project,e.task))],this.setSavedRows(this.savedRows)}removeFromSavedRows(e,t){this.savedRows=this.getSavedRows();const n=this.savedRows.filter(n=>n.date!==this.dateRange.start.toISOString()||!this.areProjectAndTaskTheSame(n.project,n.task,e,t)).map(e=>new _L(e.date,e.project,e.task));this.setSavedRows(n)}removeSavedRowsFromThisWeek(){this.savedRows=this.getSavedRows();const e=this.savedRows.filter(e=>e.date!==this.dateRange.start.toISOString()).map(e=>new _L(e.date,e.project,e.task));this.setSavedRows(e)}saveTemplate(e){if(!this.isNameValid(e))return this.savedTemplates.map(t=>t.name.toLowerCase()!==e.toLowerCase())?void this.templateNameExists(e):void this.throwTemplateErrorToast();const t=[];if(this.timesheetRows.forEach(e=>{e.project&&t.push(new wL({task:e.task?e.task.id:null,project:e.project.id}))}),this.saveTimeChecked){let n=[],i=[];this.entriesWithoutTaskCount>0?(i=[...this.timeEntries.filter(e=>null!==e.description&&null!==e.project&&null!==e.tags)],n=[...i.map(e=>e.id)]):n=[...this.timeEntries.map(e=>e.id)];const s=ke.utc(this.dateRange.start).format("YYYY-MM-DD");this.tracker2Service.saveTimeChecked(t,e,n,s),this.closeModal()}else this.tracker2Service.saveTemplate(t,e),this.closeModal()}applyTemplate(e){var t;if(!this.hasEntries)if(this.isMe()&&this.removeSavedRowsFromThisWeek(),e.entries&&(null===(t=e.entries)||void 0===t?void 0:t.length)){const t=ke.utc(this.dateRange.start).format("YYYY-MM-DD");this.tracker2Service.activateTemplate(e.id,t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.savedTemplates.forEach(t=>t.isActive=t.id===e.id);const n=this.authService.getUser().id;this.getTimeEntriesInRange(n,this.dateRange.start,this.dateRange.end)})}else this.savedTemplates.forEach(t=>t.isActive=t.id===e.id),this.timesheetRows=e.projectsAndTasks.map(e=>new LL.a(e.project,e.task,[],[])),this.isMe()&&this.addMultipleToSavedRows(e.projectsAndTasks.map(e=>new kL.a(e.task,e.project))),this.sortTimesheetRowsByName(),this.addRow()}setSaveTimeChecked(){this.saveTimeChecked=!1}editTemplate(e,t,n){this.template=e,this.isNameValid(n)?this.tracker2Service.editTemplateName(this.template.id,n).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.template.name=n,this.savedTemplates[t]=this.template,this.closeModal()}):this.throwTemplateErrorToast(this.template.id)}deleteTemplate(e){this.tracker2Service.deleteTemplate(e.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.savedTemplates.splice(this.savedTemplates.indexOf(e),1),this.checkIfShouldShowTemplates(),this.closeModal()})}isNameValid(e){return e&&!!e.trim()&&this.savedTemplates.every(t=>t.name.toLowerCase()!==e.toLowerCase())}throwTemplateErrorToast(e){this.toaster.pop("error",this.translate.instant(e?"TIMESHEET2.MESSAGES.TEMPLATE_EDIT_FAIL_HEADER":"TIMESHEET2.MESSAGES.TEMPLATE_CREATE_FAIL_HEADER"),this.translate.instant("TIMESHEET2.MESSAGES.TEMPLATE_MANIPULATION_FAIL_BODY"))}templateNameExists(e){const t=`${this.translate.instant("TEMPLATE_WITH_NAME_EXISTS")}\n    ${e} ${this.translate.instant("TEMPLATE_WITH_NAME_EXISTS_PART_TWO")}`;this.toaster.pop("error",this.translate.instant("TIMESHEET2.MESSAGES.TEMPLATE_CREATE_FAIL_HEADER"),t)}openDeleteRowModal(e,t){this.selectedRow=e,e.entries&&e.entries.length?this.openModal(t):this.removeRow(e)}openModal(e){this.modalService.open(e,{centered:!0})}closeModal(){this.modalService.dismissAll(),this.newTemplateName="",this.template=null,this.cd.detectChanges()}submitApproval(e){this.inProgress=!0;const t=ke.utc(this.dateRange.start).format("YYYY-MM-DD");this.approvalService.createSubmitRequest(t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.approvalRequestId=t.id,this.approvalStatus=Ht.PENDING,this.approvalRequestCreator=t.creator.userName,this.inProgress=!1,e.close(),this.cd.detectChanges(),this.analyticsService.addEvent(new Fi.a({event:"Submit",value:"Submit for approval",section:"Timesheet",section2:"Submit week for approval"}))},()=>{this.inProgress=!1})}withdrawApproval(e){this.inProgress=!0,this.approvalService.withdrawSubmission(this.approvalRequestId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.approvalRequestId=null,this.approvalStatus=null,this.inProgress=!1,e.close(),this.cd.detectChanges()},()=>{this.inProgress=!1})}calculateTotals(){this.totalList=[],this.total=Object(ke.duration)(0),this.timesheetRows.forEach(e=>{e.durationsByDay.forEach((e,t)=>{this.totalList[t]||(this.totalList[t]=Object(ke.duration)(0)),this.totalList[t]=Object(ke.duration)(this.totalList[t]).add(Object(ke.duration)(e)),this.total=Object(ke.duration)(this.total).add(Object(ke.duration)(e))})}),this.checkIfProjectExists(),this.checkIfHasEntries(),this.cd.detectChanges()}makeAllTemplatesInactive(){this.savedTemplates&&(this.savedTemplates.map(e=>e.isActive=!1),this.cd.detectChanges())}checkIfHasEntries(){this.hasEntries=this.timesheetRows.some(e=>e.project&&!!e.entries.length),this.cd.detectChanges()}checkIfProjectExists(){this.hasProjects=this.timesheetRows.some(e=>e.project),this.cd.detectChanges()}areProjectAndTaskTheSame(e,t,n,i){return!((e&&e.id)!==(n&&n.id)||(t&&t.id||i&&i.id)&&(t&&t.id)!==(i&&i.id))}copyLastWeek(){this.tracker2Service.getWeekBeforeEntries(this.selectedUser.id,this.dateRange.start.toISOString()).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{if(!e.length)return;this.timesheetRows=[];const t=new Map;e.forEach(e=>{if(e.project){const n=e.project.id+(e.task&&e.task.id||"");t.get(n)||(t.set(n,new LL.a(e.project,e.task,[],[])),this.timesheetRows.push(new LL.a(e.project,e.task,[],[]))),this.analyticsService.addEvent(new Fi.a({event:"Submit",value:"Copy last week",section:"Timesheet"}))}}),this.sortTimesheetRowsByName(),this.isMe()&&e.length&&this.addMultipleToSavedRows(this.timesheetRows.map(e=>new kL.a(e.task,e.project))),this.addRow(),this.checkIfProjectExists(),this.cd.detectChanges()})}copyTimeEntries(){const e=this.dateRange.start,t=this.dateRange.end,n=this.selectedUser.id;this.tracker2Service.copyTimeEntries(e.clone().subtract(7,"days").toISOString(),t.clone().subtract(7,"days").toISOString(),n).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(i=>{this.getTimeEntriesInRange(n,e,t)}),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"ButtonName",section:"Timesheet",section2:"Copy with time"}))}selectUser(e){this.selectedUser=e,this.getTimeEntriesInRange(this.selectedUser.id,this.dateRange.start,this.dateRange.end),this.checkTeamManagerPrivileges(),this.checkIfShouldShowTemplates(),this.isMe()?this.canManagerCopyWithTime=!0:(this.canManagerCopyWithTime=!1,this.toaster.pop("success",this.translate.instant("TIMESHEET2.MESSAGES.SWITCHED_TIMESHEET_SUCCESS",{name:e.name||e.email}))),this.fetchRequests()}toggleCompactView(){this.isCompactViewOn=!this.isCompactViewOn,this.userService.updateCompactViewSettings(this.isCompactViewOn)}isEmptyTimesheet(){return this.timesheetRows.every(e=>!e.project)}isMe(){var e;return this.user.id===((null===(e=this.selectedUser)||void 0===e?void 0:e.id)||this.tmpSelectedUserId)}checkIfShouldShowTemplates(){this.showTemplates=this.savedTemplates&&this.savedTemplates.length>0&&this.isMe()}closeEntriesAlert(){this.entriesAlert=""}deleteEntries(e){const t=e.map(e=>e.id);this.timeEntries=this.timeEntries.filter(e=>-1===t.indexOf(e.id))}openNextRowPicker(e,t){this.timesheetRows&&this.timesheetRows.length===t+1&&this.addRow(),setTimeout(()=>{const e=this.rows.find(e=>e&&e.index==t+1);e&&e.openProjectPicker()})}openFirstPicker(){const e=this.rows.first;e&&e.openProjectPicker()}onKeyboard(e){const t=e.keyCode?e.keyCode:e.which;if(t===_b.i&&this.pickerNeverOpened)this.openFirstPicker(),this.pickerNeverOpened=!1;else if(t===_b.a&&"time-duration"===document.activeElement.parentElement.tagName.toLowerCase()){const e=this.getTimesheetRowByIndex(this.focusedIndex+1);e&&e.openProjectPicker()}}preventOpeningPicker(){this.pickerNeverOpened=!1}getLockedWeek(e){this.isWeekLocked=!1,!0===e&&(this.isWeekLocked=!0)}focusedRow(e){this.focusedIndex=e,this.preventOpeningPicker()}fixEntriesWithoutProject(){const e=this.dateRange.start.toISOString(),t=this.dateRange.end.toISOString();this.router.navigate(["reports","detailed"],{queryParams:{start:e,end:t,filterValuesData:JSON.stringify({[on.k]:[this.selectedUser.id],[on.i.PROJECTS]:[mg.b]})}})}formatRowDurations(e){const t=this.timesheetRows.filter(t=>t.isApproved===e.isApproved&&this.areProjectAndTaskTheSame(t.project,t.task,e.project,e.task))[0]||null;t&&this.getTimesheetRowByIndex(this.timesheetRows.indexOf(t)).getFormattedDurations()}getTimesheetRowByIndex(e){return this.rows.find(t=>t&&t.index==e)}sortTimesheetRowsByName(){this.timesheetRows.sort(Object(kc.d)(e=>e.project.name.toLowerCase(),e=>{var t,n;return(null===(n=null===(t=e.task)||void 0===t?void 0:t.name)||void 0===n?void 0:n.toLowerCase())||""},!1))}openEditModal(e,t){if(this.selectedTSR=e.timesheetRow,this.index=e.index,this.selectedTSR.entries[this.index]&&1===this.selectedTSR.entries[this.index].length)return this.startForModal=this.selectedTSR.entries[this.index][0].timeInterval.start,void this.modalService.open(t,{centered:!0});this.startForModal=this.getStartTimeFromEntries(this.index),this.modalService.open(t,{centered:!0})}getAllEntries(){this.getTimeEntriesInRange(this.selectedUser.id,ke.utc(this.dateRange.start),ke.utc(this.dateRange.end))}addEntryToTimesheet(e,t,n){this.timeEntries.push(e),t.entries[n]&&t.entries[n].length||(t.entries[n]=[],t.durationsByDay[n]=Object(ke.duration)(0)),t.entries[n].push(e),t.durationsByDay[n]=t.durationsByDay[n].add(e.timeInterval.duration),this.calculateTotals(),this.formatRowDurations(t)}replaceEntriesInRow(e,t,n){const i=n.map(e=>e.id);this.timeEntries=[...this.timeEntries.filter(e=>-1===i.indexOf(e.id)),...n],e.entries[t]=[...e.entries[t].filter(e=>-1===i.indexOf(e.id)),...n],e.durationsByDay[t]=Object(XL.a)(e.entries[t].map(e=>e.timeInterval.duration)),this.calculateTotals(),this.formatRowDurations(e)}closeEditModal(){this.openedModal&&(this.pickerNeverOpened=!1,this.openedModal.close(),this.openedModal=null)}getSavedRows(){const e=JSON.parse(localStorage.getItem("savedRows"))||[];return e.length?e.map(e=>new _L(e.date,new RL.a(e.project),e.task?new yL.a(e.task):null)):[]}setSavedRows(e){const t=e.map(e=>e.toJson());localStorage.setItem("savedRows",JSON.stringify(Array.from(new Set(t))))}createEntryFromTimesheet(e,t,n){return new Sa.a({timeInterval:new ZA.a({start:t,end:ke(t).add(Object(ke.duration)(n)),duration:Object(ke.duration)(n)}),billable:this.workspace.taskBillableEnabled&&e.task&&e.task.id?e.task.billable:e.project&&e.project.billable,projectId:e.project?e.project.id:null,taskId:e.task?e.task.id:null,description:"",tagIds:[]})}applyChangesToEntries(e,t,n,i){return e.forEach(e=>{n.indexOf(TO.a.DESCRIPTION)>-1&&(e.description=t.description),n.indexOf(TO.a.TAG)>-1&&(e.tags=t.tags),n.indexOf(TO.a.BILLABLE)>-1&&(e.billable=t.billable),i&&n.indexOf(TO.a.CUSTOM_FIELDS)>-1&&(e.customFieldValues=t.customFieldValues)}),e}decideBillability({project:e,task:t,billable:n}){return this.workspace.taskBillableEnabled&&(null==t?void 0:t.id)?t.billable:e?e.billable:n}fetchRequests(){var e,t,n;if(!this.workspace.hasFeature(is.a.TIME_OFF)||!(null===(e=this.workspace.timeOff)||void 0===e?void 0:e.active))return;this.timeOffs=[];const i=this.ptoService.getHolidaysOf({userId:(null===(t=this.selectedUser)||void 0===t?void 0:t.id)?this.selectedUser.id:this.tmpSelectedUserId,start:this.dateRange.start.toISOString(),end:this.dateRange.end.toISOString()}),s=this.ptoService.getTimeOffRequests({timeLine:!0,status:["APPROVED"],start:this.dateRange.start.toISOString(),end:this.dateRange.end.toISOString(),users:{contains:on.d.CONTAINS,ids:[(null===(n=this.selectedUser)||void 0===n?void 0:n.id)?this.selectedUser.id:this.tmpSelectedUserId]},userGroups:{contains:on.d.CONTAINS,ids:[]}});Object(Sb.a)(i,s).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.timeOffs=this.timeOffhelperService.createHolidaysAndRequests(e[0],e[1].requests,this.tmpSelectedUserId?this.dateRangeNonUTC:this.dateRange,this.user),this.weekDayTimeOffs=this.timeOffhelperService.calculateDailyTimeOffs(this.timeOffs,this.momentWeek,this.timeZone),this.weekHasTimeOff=this.weekDayTimeOffs.some(e=>e.length>0),this.cd.detectChanges()})}getEntriesForCurrentWeek(){const e=[],t="-"===ke.tz(this.timeZone).format("Z")[0]?1:0;for(let n=0;n<7;n++){const i=this.dateRange.start.clone().tz(this.timeZone).startOf("day").add(n+t,"day");e.push(i)}this.momentWeek=e,this.cd.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(rn),s.Rb(Gm.a),s.Rb(re.a),s.Rb(Ic.a),s.Rb(bn.a),s.Rb(r.a),s.Rb(WA.a),s.Rb(Gn.a),s.Rb(Lc.a),s.Rb(WL.a),s.Rb(vn.a),s.Rb(s.h),s.Rb(k.d),s.Rb(w.q),s.Rb(UA.a),s.Rb(g.f),s.Rb(Ra.a),s.Rb(NL.b),s.Rb(DL.a),s.Rb(k.a),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["timesheet2"]],viewQuery:function(e,t){var n;1&e&&s.gd(iy,!0),2&e&&s.Kc(n=s.kc())&&(t.rows=n)},hostBindings:function(e,t){1&e&&s.jc("keyup",(function(e){return t.onKeyboard(e)}),!1,s.Nc)},decls:43,vars:19,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],["class","cl-d-block cl-alert cl-alert-warning",4,"ngIf"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center","cl-mb-3"],[1,"cl-d-flex","cl-align-items-center","cl-col-md-4","cl-mb-3","cl-mb-md-0"],[1,"cl-h1"],[4,"ngIf"],[1,"cl-col-md-8"],[1,"cl-d-flex","cl-align-items-sm-center","cl-justify-content-sm-end","cl-flex-column","cl-flex-sm-row"],[1,"cl-page-header-action","cl-w-md-auto","cl-mr-0","cl-mb-3","cl-mb-sm-0","cl-d-flex"],["dropdown","",1,"cl-page-header-action","cl-w-md-auto","cl-mr-0","cl-mr-sm-2","cl-mb-3","cl-mb-sm-0"],[3,"hasAddTimeForOthersFeature","selectedUser","workspace","userSelected",4,"ngIf"],[1,"cl-page-header-action","cl-d-none","cl-d-lg-block"],["type","button",1,"cl-btn","cl-btn-outline-light",3,"click"],["src","assets/images/ui-icons/comfortable.svg",4,"ngIf"],["src","assets/images/ui-icons/compact.svg",4,"ngIf"],[1,"cl-page-header-action"],[3,"timeEntriesDateRange","isWeekly","dateRangeOut"],[1,"cl-page-component-wrapper"],["class","cl-table cl-table-bordered cl-remove-cell-borders cl-table-timesheet",3,"cl-compact",4,"ngIf"],[1,"cl-page-component-wrapper","cl-d-lg-flex","cl-d-print-none"],["class","cl-btn cl-btn-outline-light cl-d-block cl-d-lg-inline-block cl-mr-0 cl-mr-lg-2 cl-mb-2 cl-mb-lg-0 cl-min-height-40 cl-max-height-40","data-cy","add-new-row",3,"disabled","click",4,"ngIf"],["class","cl-dropdown cl-btn-group cl-d-flex","dropdownKey","",3,"title",4,"ngIf"],["data-cy","save-as-template",1,"cl-btn","cl-btn-outline-light","cl-d-block","cl-d-lg-inline-block","cl-min-height-40","cl-max-height-40",3,"disabled","click"],["src","assets/images/ui-icons/save.svg","alt","save"],[1,"cl-ml-2"],["class","cl-btn cl-btn-outline-primary cl-d-block cl-d-lg-inline-block cl-ml-auto cl-mt-2 cl-mt-lg-0","data-cy","submit-approval",3,"click",4,"ngIf"],["class","cl-card cl-d-print-none",4,"ngIf"],["createTemplateModal",""],["deleteRowModal",""],["editTimeModal",""],["submitApprovalModal",""],["witdhDrawApprovalModal",""],[1,"cl-d-block","cl-alert","cl-alert-warning"],[1,"cl-btn",3,"click"],["type","button",1,"cl-close",3,"click"],["class","cl-ml-3","placement","bottom",3,"ngbTooltip",4,"ngIf"],["class","cl-ml-3",4,"ngIf"],["placement","bottom",1,"cl-ml-3",3,"ngbTooltip"],["src","assets/images/ui-icons/icon-warning.svg"],[1,"cl-ml-3"],["class","cl-badge-approve cl-approve-status-approved cl-text-nowrap",4,"ngIf","ngIfElse"],["pendingTemplate",""],[1,"cl-badge-approve","cl-approve-status-approved","cl-text-nowrap"],["class","cl-badge-approve cl-approve-status-pending",3,"title",4,"ngIf"],[1,"cl-badge-approve","cl-approve-status-pending",3,"title"],[1,"pointer","cl-ml-1",3,"title","click"],[3,"hasAddTimeForOthersFeature","selectedUser","workspace","userSelected"],["src","assets/images/ui-icons/comfortable.svg"],["src","assets/images/ui-icons/compact.svg"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-table-timesheet"],[1,"cl-thead-light"],[1,"cl-h6","cl-mb-0","cl-pl-lg-3"],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-center"],[1,"cl-d-flex","cl-align-items-center"],["class","cl-h4 cl-mb-0",4,"ngIf"],["class","cl-ml-3",3,"click",4,"ngIf"],["timesheet-row","","class","timesheet-row-component",3,"timesheetRow","week","momentWeek","format","isAdminOrOwner","dateRange","workspace","projectPickerSpecialFilter","isDesktop","timesheetRows","selectedUser","forbidManagerEdit","expandAll","userGroups","index","disableManualMode","dailyTimeOffs","delete","changeDuration","selectedProjectAndTask","preventOpenPickerOnTab","openNextPicker","focusedRow","lockedWeek","openModalEmitter",4,"ngFor","ngForOf"],["timesheet-row-total","","class","cl-bg-light cl-table-footer",3,"week","format","totalList","total","isDesktop","expandAll",4,"ngIf"],[1,"cl-h4","cl-mb-0"],[1,"cl-ml-3",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"],["class","cl-text-lg-center",4,"ngFor","ngForOf"],[1,"cl-text-left"],[1,"cl-h6","cl-mb-0","timesheet-total-pr"],[1,"cl-text-lg-center"],[1,"cl-h6"],[1,"cl-time-off-band","cl-timesheet-band"],["class","cl-time-off-band cl-h6 cl-timesheet-band",4,"ngFor","ngForOf"],[1,"cl-time-off-band","cl-h6","cl-timesheet-band"],[1,"cl-timesheet-input-td"],[3,"dailyTimeOffs",4,"ngIf"],[3,"dailyTimeOffs"],["timesheet-row","",1,"timesheet-row-component",3,"timesheetRow","week","momentWeek","format","isAdminOrOwner","dateRange","workspace","projectPickerSpecialFilter","isDesktop","timesheetRows","selectedUser","forbidManagerEdit","expandAll","userGroups","index","disableManualMode","dailyTimeOffs","delete","changeDuration","selectedProjectAndTask","preventOpenPickerOnTab","openNextPicker","focusedRow","lockedWeek","openModalEmitter"],["rowComponent",""],["timesheet-row-total","",1,"cl-bg-light","cl-table-footer",3,"week","format","totalList","total","isDesktop","expandAll"],["data-cy","add-new-row",1,"cl-btn","cl-btn-outline-light","cl-d-block","cl-d-lg-inline-block","cl-mr-0","cl-mr-lg-2","cl-mb-2","cl-mb-lg-0","cl-min-height-40","cl-max-height-40",3,"disabled","click"],["src","assets/images/ui-icons/plus-blue.svg","alt","add"],["dropdownKey","",1,"cl-dropdown","cl-btn-group","cl-d-flex",3,"title"],["dropdownKeyButton","",1,"cl-btn","cl-btn-outline-light","cl-d-block","cl-d-lg-inline-block","cl-mr-0","cl-mr-lg-2","cl-mb-2","cl-mb-lg-0","cl-min-height-40","cl-max-height-40","cl-dropdown-toggle",3,"disabled"],["src","assets/images/ui-icons/template.svg","alt","copy"],["class","cl-dropdown-menu",4,"dropdownKeyContent"],[1,"cl-dropdown-menu"],["class","cl-dropdown-item","clickCloseDropdown","","data-cy","copy-last-week",3,"click",4,"ngIf"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"disabled","click"],["clickCloseDropdown","","data-cy","copy-last-week",1,"cl-dropdown-item",3,"click"],["data-cy","submit-approval",1,"cl-btn","cl-btn-outline-primary","cl-d-block","cl-d-lg-inline-block","cl-ml-auto","cl-mt-2","cl-mt-lg-0",3,"click"],[1,"cl-card","cl-d-print-none"],[1,"cl-card-header","cl-px-2","cl-px-lg-3"],[1,"cl-h6","cl-mb-0"],["class","cl-component-row cl-component-row-divide-md cl-px-0",4,"ngFor","ngForOf"],[1,"cl-component-row","cl-component-row-divide-md","cl-px-0"],[1,"cl-w-100",3,"template","hasEntries","disableManualMode","templateApplied","templateEdited","templateDeleted"],[1,"cl-modal-header"],[1,"cl-modal-title"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group","cl-mb-0"],["type","text","ngbAutofocus","","id","template-name-create","name","newTemplateName",1,"cl-form-control",3,"placeholder","ngModel","ngModelChange","keyup.enter"],[1,"cl-custom-control","cl-custom-checkbox","cl-form-group","cl-mt-3","cl-mb-0"],["type","checkbox","id","saveTime","name","saveTime",1,"cl-custom-control-input",3,"disabled","ngModel","ngModelChange"],["for","saveTime",1,"cl-custom-control-label"],[1,"cl-modal-footer","cl-text-capitalize"],[3,"click"],["type","button",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[1,"cl-mb-0"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-danger",3,"click"],[3,"row","index","workspace","user","dateRange","start","customFields","ongoingRequest","close","createEntryEmitter"],[3,"title","btnText","inProgress","confirmed","close"],[1,"cl-text-dark","cl-mb-0"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xc(2,sy,10,11,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"div",5),s.Xb(6,"h1",6),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Xc(9,by,3,2,"ng-container",7),s.Wb(),s.Xb(10,"div",8),s.Xb(11,"div",9),s.Xb(12,"div",10),s.Xb(13,"div",11),s.Xc(14,dy,1,3,"teammate-picker2",12),s.Wb(),s.Xb(15,"div",13),s.Xb(16,"button",14),s.jc("click",(function(){return t.toggleCompactView()})),s.Xc(17,uy,1,0,"img",15),s.Xc(18,py,1,0,"img",16),s.Wb(),s.Wb(),s.Xb(19,"div",17),s.Xb(20,"datepicker-range",18),s.jc("dateRangeOut",(function(e){return t.updateDateRange(e)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(21,"div",19),s.Xc(22,vy,16,11,"table",20),s.Wb(),s.Xb(23,"div",21),s.Xc(24,Ty,5,4,"button",22),s.Xc(25,Ly,8,7,"div",23),s.Xb(26,"button",24),s.jc("click",(function(){s.Oc(e);const n=s.Lc(34);return t.openModal(n),t.setSaveTimeChecked()})),s.Sb(27,"img",25),s.Xb(28,"span",26),s.Zc(29),s.oc(30,"translate"),s.Wb(),s.Wb(),s.Xc(31,Ry,3,3,"a",27),s.Wb(),s.Xc(32,_y,6,4,"div",28),s.Xc(33,ky,25,19,"ng-template",null,29,s.Yc),s.Xc(35,Wy,21,15,"ng-template",null,30,s.Yc),s.Xc(37,Xy,1,8,"ng-template",null,31,s.Yc),s.Wb(),s.Wb(),s.Xc(39,Dy,8,20,"ng-template",null,32,s.Yc),s.Xc(41,Py,6,10,"ng-template",null,33,s.Yc),s.Wb()}2&e&&(s.Cb(2),s.wc("ngIf",t.entriesAlert),s.Cb(5),s.ad(s.pc(8,15,"GLOBAL.TIMESHEET_LABEL")),s.Cb(2),s.wc("ngIf",null==t.workspace?null:t.workspace.timeApprovalEnabled),s.Cb(5),s.wc("ngIf",t.isAdminOrOwner||t.isTeamManager),s.Cb(3),s.wc("ngIf",!t.isCompactViewOn),s.Cb(1),s.wc("ngIf",t.isCompactViewOn),s.Cb(2),s.wc("timeEntriesDateRange",t.dateRange)("isWeekly",!0),s.Cb(2),s.wc("ngIf",t.week),s.Cb(2),s.wc("ngIf",!t.forbidManagerEdit),s.Cb(1),s.wc("ngIf",t.isAdminOrOwner||t.canManagerEditUsersTime||!t.canManagerEditUsersTime&&t.canManagerCopyWithTime),s.Cb(1),s.wc("disabled",t.isEmptyTimesheet()||!t.isMe()),s.Cb(3),s.ad(s.pc(30,17,"TIMESHEET2.ACTIONS.SAVE.TEMPLATE")),s.Cb(2),s.wc("ngIf",t.showSubmitForAll),s.Cb(1),s.wc("ngIf",t.showTemplates))},directives:[i.u,Nc.a,ws.a,w.bb,PL.a,i.t,ML.a,bR,gR,ni.a,ii.a,si.a,yR,v.I,v.t,v.u,v.c,v.s,v.v,v.a,ny,Si.a],pipes:[g.e,xc.a,jL.a,gv.a],encapsulation:2,changeDetection:0}),e})();var By=n("Vpr3"),Uy=n("QeEd"),Gy=n("lWAS"),xy=n("XLnJ"),Fy=n("BuEj"),jy=n("qrIO"),Zy=n("fANO"),Vy=n("xzCI");class Yy extends Vy.a{constructor(e){super(e),this.isDropdownCheckbox=!0;const t=[...new Set(e.allowedValues)].map(e=>({id:e,name:e}));this.selectableMaps=new Tn.a([new mg.a(this.id,t,{hideTitle:!0})]),this.checkboxValues=new wn.a({map:{[this.id]:[]}}),this.isDropdownCheckbox=!0}setIndicator(){const{numberOfSelected:e,label:t}=this.checkboxValues.getSelectedData(this.selectableMaps,null,!0);this.indicator=e,this.tooltip=t}getApiParamsIfChanged(){return this.isClean()||this.isFilterDisabled?null:this.getApiParams()}getApiParams(){const e=this.selectableMaps.getAllSelectedEntities().map(e=>e.id);return{id:this.id,value:e,type:this.type}}setValuesFromParam(e){if(!e)return;const t=Array.isArray(e.value)&&e.value;this.checkboxValues.pushIds(this.id,t),wn.a.updateMapFromValuesData(this.checkboxValues,this.selectableMaps)}clear(){this.checkboxValues.reset(),this.selectableMaps.setSelected(!1),this.tooltip="",this.indicator=0}isClean(){const{numberOfSelected:e}=this.checkboxValues.getSelectedData(this.selectableMaps,null,!0);return!e}}var Hy=n("f1uh");class $y extends Vy.a{constructor(e){super(e),this.isDropdownSwitch=!0,this.tooltipConfig={[Hy.b.BOTH]:"",[Hy.b.YES]:"GLOBAL.CONFIRM_LABEL",[Hy.b.NO]:"GLOBAL.NO_LABEL"},this.value=Hy.b.BOTH}getApiParamsIfChanged(){return this.isClean()||this.isFilterDisabled?null:this.getApiParams()}getApiParams(){return{id:this.id,value:this.value,type:this.type}}setIndicator(){this.indicator=this.value===Hy.b.BOTH?0:1,this.tooltip=this.tooltipConfig[this.value]}clear(){this.value=Hy.b.BOTH,this.tooltip="",this.indicator=0}isClean(){return this.value===Hy.b.BOTH}}var Ky=function(e){return e.LESS_THAN="LESS_THAN",e.GREATER_THAN="GREATER_THAN",e.EQUAL="EQUAL",e}({}),qy=n("91AR");class zy extends Vy.a{constructor(e){super(e),this.isDropdownNumber=!0,this.resetValue()}get numberOfChecked(){return this.value.filter(e=>e.isChecked).length}setValuesFromParam(e){if(!e||!e.value)return;const t=e.value;this.value.forEach(e=>{const n=t.find(t=>t.type===e.type);e.updateValue(n)})}setIndicator(){this.indicator=this.numberOfChecked}clear(){this.resetValue(),this.tooltip="",this.indicator=0}getApiParamsIfChanged(){return this.isClean()||this.isFilterDisabled?null:this.getApiParams()}getApiParams(){const e=this.value.filter(e=>e.isChecked).map(e=>new qy.a(e));return{id:this.id,value:e,type:this.type}}isClean(){return!this.numberOfChecked}resetValue(){this.value=[new qy.a({type:Ky.EQUAL,value:0,isChecked:!1,label:"REPORTS.MODELS.EXACTLY_LABEL"}),new qy.a({type:Ky.LESS_THAN,value:0,isChecked:!1,label:"REPORTS.MODELS.SMALLER_THAN_LABEL"}),new qy.a({type:Ky.GREATER_THAN,value:0,isChecked:!1,label:"REPORTS.MODELS.LARGER_THAN_LABEL"})]}static areParamsEqaul(e,t){if(e.value.length!==t.value.length)return!1;for(let n=0;n<e.value.length;n++)if(!e.value[n].sameWith(t.value[n]))return!1;return!0}}class Qy extends Vy.a{constructor(e){super(e),this.isDropdownTextual=!0}setValuesFromParam(e){e&&(this.value=e.value||"")}setIndicator(){this.indicator=0,this.value&&this.indicator++,this.tooltip=this.value||""}clear(){this.value="",this.tooltip="",this.indicator=0}getApiParamsIfChanged(){return this.isClean()||this.isFilterDisabled?null:this.getApiParams()}getApiParams(){return{id:this.id,value:this.value,type:this.type}}isClean(){return!this.value}}function Jy(e){const t=e.type;return t===Zy.b.DROPDOWN_MULTIPLE||t===Zy.b.DROPDOWN_SINGLE?new Yy(e):t===Zy.b.CHECKBOX?new $y(e):t===Zy.b.NUMBER?new zy(e):t===Zy.b.LINK||t===Zy.b.TXT?new Qy(e):void console.warn("Custom field type unknown",t)}var e_=n("RkOr"),t_=n("vqWo"),n_=n("Ig2A"),i_=function(e){return e.EXCLUDE="EXCLUDE",e.CALCULATE="CALCULATE",e}({});class s_{constructor(e,t,n,i,s,c,a,o,r,l){this.dateRange=e,this.relativeDateRange=t,this.filterValuesData=n,this.note=i,this.withoutNote=s,this.pagination=c,this.sortData=a,this.zoomLevel=o,this.timeZone=r,this.weekStart=l}generateBodyParams(){const e=navigator.languages&&navigator.languages[0]||navigator.language||"",t={dateRangeStart:this.dateRange.start.toISOString(),dateRangeEnd:this.dateRange.end.toISOString(),sortOrder:this.sortData.sortOrder||bi.a.ASCENDING,note:this.note,withoutNote:this.withoutNote,page:this.pagination.page||1,pageSize:this.pagination.pageSize||In.j,sortColumn:this.sortData.sortColumn||on.i.PROJECTS,zoomLevel:this.zoomLevel?this.zoomLevel.toUpperCase():wa.a.WEEK.toUpperCase(),userLocale:e.replace(/\-/g,"_"),timeZone:this.timeZone,weekStart:this.weekStart};return this.setStatusToObject(t),this.setUserAndUserGroup(t),this.setContainFilters(t),t}setStatusToObject(e){if(!this.filterValuesData[on.i.STATUSES])return;const t=this.filterValuesData[on.i.STATUSES].getContainsFilter(on.b);t&&0!==t.ids.length&&2!==t.ids.length&&(e.billable=t.ids.includes(on.c.BILLABLE));const n=this.filterValuesData[on.i.STATUSES].getContainsFilter(on.a);n&&1===n.ids.length&&(e.approvalState=n.ids.includes("APPROVED")?"APPROVED":"UNAPPROVED");const i=this.filterValuesData[on.i.STATUSES].getContainsFilter(on.g);i&&1===i.ids.length&&(e.invoicingState=i.ids.includes("INVOICED")?"INVOICED":"UNINVOICED")}setContainFilters(e){const t=[on.i.STATUSES,on.i.USERS_AND_GROUP];for(const n in this.filterValuesData){if(t.includes(n))continue;const i=this.filterValuesData[n].getContainsFilter(n);i&&(e[n]=i)}}setUserAndUserGroup(e){if(!this.filterValuesData||!this.filterValuesData[on.i.USERS_AND_GROUP])return;const t=this.filterValuesData[on.i.USERS_AND_GROUP].getContainsFilter(on.k);if(t&&(e[on.k]=t),status===on.l.INACTIVE||status===on.l.PENDING)return;const n=this.filterValuesData[on.i.USERS_AND_GROUP].getContainsFilter(on.f);n&&(e[on.f]=n)}}var c_=n("dRxX"),a_=n("wBNX");let o_=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r,l,b,d,u,h,m,g,E,f,S,C){this.workspaceService=e,this.authService=t,this.cd=n,this.uiSettingsService=i,this.router=s,this.paginationHelperService=c,this.activatedRoute=a,this.reportService=o,this.browserService=r,this.loader=l,this.trackerService=b,this.modalService=d,this.systemSettingsService=u,this.exportReportsService=h,this.customFieldService=m,this.switchReportService=g,this.timezoneConverter=E,this.translate=f,this.translationStore=S,this.analyticsService=C,this.pagination={},this.AmountOption=jy.a,this.unsubscribe$=new p.a}ngOnInit(){this.setBrowserWidth(),this.authService.permissionData$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(({isTeamManager:e,isAdminOrOwner:t,isProjectManager:n,teamManagerUsers:i})=>{this.isTeamManager=!t&&e,this.isAdminOrOwner=t,this.isProjectManager=!t&&n,this.teamManagerUsers=i.map(e=>new Ca.a({id:e.entityId,name:e.name})),this.updateIsManagerAllowedToEdit(),this.setCanSeeRates(),setTimeout(()=>{this.cd.detectChanges()},100)}),this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{e.hasFeature(is.a.CUSTOM_FIELDS)&&this.getCustomFields(),this.hasAddTimeForOthersFeature=e.hasFeature(is.a.ADD_TIME_FOR_OTHERS),this.hasQuickbookPermission=e.hasFeature(is.a.QUICKBOOKS_INTEGRATION)}),this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e,this.setCanSeeRates(),this.updateIsManagerAllowedToEdit(),this.afterWorkspaceSet(),this.initPage(),this.activeBillable=e.activeBillableHours,this.onlyAdminCanSeeAndChangeBillable=e.onlyAdminsCanChangeBillableStatus}),this.getCustomizationSettings()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}afterWorkspaceSet(){}initPage(){this.enabledStandardFilters=this.uiSettingsService.getStandardFilters(this.workspace.id),this.summaryFilterGroups=this.uiSettingsService.getSummaryGroupsBy(this.workspace.id),this.showEstimate=this.uiSettingsService.getSummaryEstimateOn(this.workspace.id),this.customFields=null;const e=this.authService.getUser();this.projectData=new BA.a(this.workspace,e),this.format=this.workspace.getTimeFormat(),this.isAdminOrOwner=this.authService.isAdminOrOwner();const t=this.workspace.onlyAdminsSeePublicProjectsEntries&&this.workspace.onlyAdminsSeeAllTimeEntries;this.hideMembers=t&&!(this.isAdminOrOwner||this.isTeamManager||this.isProjectManager),this.hideUserGroupMembers=t&&this.isTeamManager&&!this.isAdminOrOwner,this.hideAmountsFromUser=!this.isAdminOrOwner&&this.workspace.onlyAdminsSeeBillableRates,this.isRounding=this.uiSettingsService.isWorkspaceRounding(this.workspace.id);const n={keepSelectedAllGlobally:!0,totalsOptions:i_.CALCULATE};this.initSortData(),this.setCanSeeRates(),this.initAmountOption(),this.getRouteParams(),this.getDateParams(),this.getReports(n),this.setSwitchReportService()}setSwitchReportService(){const e=this.getChangedFilterValues(),{exclude:t,filters:n}=Object($n.g)(e),i=this.generatefilterOptions(e);this.switchReportService.queryParams=this.generateQueryParams(t,n,i)}setCanSeeRates(){this.workspace&&(this.canSeeRates=!this.workspace.onlyAdminsSeeBillableRates||this.isAdminOrOwner)}updateIsManagerAllowedToEdit(){var e,t;this.isTeamManagerAllowedToEdit=(null===(e=this.workspace)||void 0===e?void 0:e.hasFeature(is.a.ADD_TIME_FOR_OTHERS))&&(null===(t=this.workspace)||void 0===t?void 0:t.canManagerEditUsersTime)&&this.isTeamManager}initSortData(){let e,t;if(this.TYPE===Fy.a.DETAILED){const n=this.uiSettingsService.getSettings(xn.b.DETAILED_SORT)||{};e=t_.b[n.sortColumn]||t_.b.DATE,t=bi.a[n.sortOrder]||bi.a.DESCENDING}else if(this.TYPE===Fy.a.EXPENSE_DETAILED){const n=this.uiSettingsService.getSettings(xn.b.EXPENSE_DETAILED_SORT)||{};e=c_.b[n.sortColumn]||c_.b.DATE,t=bi.a[n.sortOrder]||bi.a.DESCENDING}else{const n=this.uiSettingsService.getSettings(xn.b.SUMMARY_SORT)||{};e=e_.c[n.sortColumn]||e_.c.GROUP,t=bi.a[n.sortOrder]||bi.a.ASCENDING}this.sortData={sortColumn:e,sortOrder:t}}getRouteParams(){const e=this.paginationHelperService.getUrlParams(this.activatedRoute.snapshot.queryParams,this.workspace.id);this.hideMembers&&(e.filterValuesData[on.i.USERS_AND_GROUP]=this.removeExtraUserAndUserGroups(e.filterValuesData[on.i.USERS_AND_GROUP])),this.quickbooksSelectType=this.isAdminOrOwner&&this.hasQuickbookPermission&&this.TYPE===Fy.a.DETAILED?e.quickbooksSelectType:null,this.filterValuesData=e.filterValuesData,this.description=e.description,this.note=e.note,this.withoutDescription=e.withoutDescription,this.withoutNote=e.withoutNote,this.pagination=e.pagination,this.customFieldParams=e.customFieldParams,this.TYPE===Fy.a.DETAILED&&(this.audit=e.audit),!this.workspace.timeApprovalEnabled&&e.filterValuesData[on.i.STATUSES]&&e.filterValuesData[on.i.STATUSES].removeSingleKey(on.a),!this.workspace.invoicingEnabled&&e.filterValuesData[on.i.STATUSES]&&e.filterValuesData[on.i.STATUSES].removeSingleKey(on.g)}removeExtraUserAndUserGroups(e){return!e||e.exclude||e.getTotalOfChecked()>1?new wn.a:e}getDateParams(){const{start:e,end:t}=this.activatedRoute.snapshot.queryParams,n=this.uiSettingsService.getSettings(xn.b.DATE_REPORTS),i=this.workspace.features.includes(is.a.UNLIMITED_REPORTS),s=this.authService.getUser().settings.weekStart||ho.b.MONDAY;if(e&&t){const{dateRange:n,zoomLevel:s}=this.paginationHelperService.getDateAndZoomLevel({start:e,end:t},null,i);this.dateRange=n,this.zoomLevel=s||wa.a.WEEK}else if(n){const e=Object(_e.f)(n.label,s);this.dateRange=e||{start:ke(n.start),end:ke(n.end)},this.zoomLevel=n.zoomLevel||wa.a.WEEK}else this.dateRange=Object(wc.d)(s,this.timezoneConverter),this.zoomLevel=wa.a.WEEK;if(this.TYPE===Fy.a.WEEKLY){const e=Object(_e.h)(ke.utc(this.dateRange.start),s);this.dateRange.start=e.startOf("day"),this.dateRange.end=e.clone().add(6,"day").endOf("day"),this.zoomLevel=wa.a.WEEK,this.saveDateToStorage(),this.setParamsToUrl()}}updateDateRange({dateRange:e,zoomLevel:t}){this.dateRange=e,this.zoomLevel=t,this.navigate(),this.saveDateToStorage()}saveDateToStorage(){if(!Object(sn.y)(this.dateRange.start,this.dateRange.end))return void this.uiSettingsService.setSettings(xn.b.DATE_REPORTS,null);const e={start:this.dateRange.start.toISOString(),end:this.dateRange.end.toISOString(),label:this.dateRange.label};this.uiSettingsService.setSettings(xn.b.DATE_REPORTS,e)}onRoundingChange(e){this.isRounding=e,this.getReports()}amountOptionChanged(e){this.amountOptions=e,this.uiSettingsService.setAmountOptions(e,this.workspace.id);const t=this.TYPE===Fy.a.SUMMARY&&![e_.c.GROUP,e_.c.DURATION,e_.c.ESTIMATE].includes(e_.c[this.sortData.sortColumn])&&!this.amountOptions.includes(jy.a[this.sortData.sortColumn]);this.TYPE!==Fy.a.SUMMARY||e.length&&!t||(this.sortData.sortColumn=e_.c.GROUP),this.navigate()}setPagination(e){this.pagination.page=e.page||this.pagination.page,this.pagination.pageSize=e.limit||this.pagination.pageSize,this.uiSettingsService.setSettings(xn.b.DETAILED_PAGE_SIZE,this.pagination.pageSize),this.navigate({keepSelectedAllGlobally:!0,totalsOptions:i_.EXCLUDE})}activeFilterChanged(e){this.enabledStandardFilters=e}navigate(e){this.setParamsToUrl(),this.getReports(e)}getReports(e){}getCustomFields(){this.customFieldService.get().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.customFields=e,this.generateCustomFieldFilters(),this.cd.detectChanges()})}generateCustomFieldFilters(){if(!this.customFields)return;const e=[];this.customFields.forEach(t=>{const n=Jy(t);n&&(n.setValuesFromParams(this.customFieldParams),e.push(n))}),this.customFieldFilters=e}openModal(e){this.isModalOpen||(this.isModalOpen=!0,this.modalService.open(e,{centered:!0}).result.then(()=>setTimeout(()=>this.isModalOpen=!1,100),e=>setTimeout(()=>this.isModalOpen=!1,100)))}generatefilterOptions(e){const t={};for(const n in e)e[n]&&e[n].options&&(t[n]=Object(sn.f)(e[n].options));return t}getChangedFilterValues(){const e={};for(const t in this.filterValuesData){const n=this.filterValuesData[t];n.isDirty()&&(e[t]=n)}return e}setParamsToUrl(){const e=this.getChangedFilterValues(),{exclude:t,filters:n}=Object($n.g)(e),i=this.generatefilterOptions(e),s=this.generateQueryParams(t,n,i);if(this.switchReportService.queryParams=this.generateQueryParams(t,n,i),this.TYPE===Fy.a.DETAILED&&(s.page=this.pagination.page,s.pageSize=this.pagination.pageSize,this.audit.isDirty())){const e=this.audit.generateUrlParameters();s.audit=e.audit,s.unit=e.unit,s.compare=e.compare,s.durationInput=e.durationInput}const c=this.router.createUrlTree(this.report?[this.report]:[],{queryParams:s}),a=this.router.serializeUrl(c);this.router.navigateByUrl(a),this.cd.detectChanges()}generateQueryParams(e,t,n){const i=this.isAdminOrOwner&&this.hasQuickbookPermission&&this.TYPE===Fy.a.DETAILED?this.quickbooksSelectType:null;for(const s in n)t.hasOwnProperty(s)||(t=Object.assign(Object.assign({},t),{[s]:[]}));return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({quickbooksSelectType:i},{start:this.dateRange.start.toISOString()}),{end:this.dateRange.end.toISOString()}),{description:this.description||null}),{note:this.note||null}),{withoutDescription:this.withoutDescription||null}),{withoutNote:this.withoutNote||null}),{filterValuesData:Object(sn.r)(t)?null:JSON.stringify(t)}),{exclude:e.length?e.join(","):null}),{filterOptions:Object(sn.r)(n)?null:JSON.stringify(n)}),{customFieldParams:Object(sn.r)(this.customFieldParams)?null:JSON.stringify(this.customFieldParams)})}createReportQuery(){return new xy.b(this.dateRange,this.dateRangeType,this.filterValuesData,this.description,this.audit,this.pagination,this.sortData,this.zoomLevel,this.sharedData,this.isRounding,this.amountOptions,this.amountOptions.length?this.amountOptions[0]:jy.a.HIDE_AMOUNT,this.withoutDescription,this.customFieldParams,this.summaryFilterGroups,this.weeklyGroup,this.quickbooksSelectType,this.showEstimate&&this.hideEstimateColumn,this.totalOptions)}createExpenseReportQuery(){const e=this.authService.getUser().settings;return new s_(this.dateRange,this.dateRangeType,this.filterValuesData,this.note,this.withoutNote,this.pagination,this.sortData,this.zoomLevel,e.timeZone,e.weekStart)}initAmountOption(){let e;if(this.TYPE===Fy.a.WEEKLY){const t=this.uiSettingsService.getWeeklyAmountOption(this.workspace.id);e=t===jy.a.HIDE_AMOUNT?[]:[t]}else e=this.uiSettingsService.getAmountOptions(this.workspace.id);(e.includes(jy.a.COST)||e.includes(jy.a.PROFIT))&&(this.workspace.hasFeature(is.a.LABOR_COST)&&this.workspace.isCostRateActive||(e=[jy.a.EARNED])),this.canSeeRates||(e=[]),this.workspace.activeBillableHours||(e=[]),this.amountOptions=e,this.amountsForTable=e}exportAsPdf(){const e=this.createReportQuery();this.exportReportsService.exportAsPdf(e,this.TYPE,this.entriesCount,this.reportName),this.analyticsService.addEvent(new Fi.a({event:"select",value:"save as PDF",section:"Reports",section2:"Summary/Detailed/Weekly",section3:"Export"}))}exportAsCsv(){const e=this.createReportQuery();this.exportReportsService.exportAsCsv(e,this.TYPE,this.entriesCount,this.reportName),this.analyticsService.addEvent(new Fi.a({event:"select",value:"save as CSV",section:"Reports",section2:"Summary/Detailed/Weekly",section3:"Export"}))}exportAsExcel(){const e=this.createReportQuery();this.exportReportsService.exportAsExcel(e,this.TYPE,this.entriesCount,this.reportName),this.analyticsService.addEvent(new Fi.a({event:"select",value:"save as Excel",section:"Reports",section2:"Summary/Detailed/Weekly",section3:"Export"}))}exportExpenseAsCsv(){const e=this.createExpenseReportQuery();this.exportReportsService.exportAsCsv(e,this.TYPE,this.entriesCount,this.reportName)}exportExpenseAsExcel(){const e=this.createExpenseReportQuery();this.exportReportsService.exportAsExcel(e,this.TYPE,this.entriesCount,this.reportName)}downloadReceipts(){const e=this.createExpenseReportQuery();this.exportReportsService.downloadReceiptsAsync(e)}applyFilter({description:e,valuesData:t,withoutDescription:n,customFieldParams:i,note:s,withoutNote:c,report:a}){this.description=e,this.note=s,this.withoutNote=c,this.withoutDescription=n,this.filterValuesData=t,this.customFieldParams=i,this.report=a,this.navigate()}setBrowserWidth(){this.browserService.isBreakpointLgCustom$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e,this.cd.markForCheck()})}getDateRangeValue(){const e=this.authService.getUser().settings.weekStart||"MONDAY",t=Object(_e.g)(this.dateRange),n=Object(_e.d)(t,e,this.translate,this.translationStore);return this.dateRangeType=n.dateRangeType,n.dateRangeType.label?this.translate.instant(n.dateRangeType.label):""}saveExportSettings(e,t){this.customizeReport=e,this.customizationInProgress=!0,this.reportService.customizeReport(e,this.TYPE).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.reportName=e.name,this.currentSettings=e.reportFields.map(e=>Object($n.e)(this.TYPE)[e]),this.customizationInProgress=!1},e=>{this.customizationInProgress=!1})}getCustomizationSettings(){this.workspace.hasFeature(is.a.CUSTOM_REPORTING)?this.reportService.getCustomizationSettings(this.TYPE).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{const t=e.visibleElements;this.reportName=e.name,this.currentSettings=t.map(e=>Object($n.e)(this.TYPE)[e]),this.currentCustomFieldSettings=e.customFieldIds,this.removeTotalFromSettings()},e=>{}):this.currentSettings=null}removeTotalFromSettings(){if(this.TYPE===Fy.a.WEEKLY&&!this.canSeeRates&&this.currentSettings.includes(n_.a.TOTAL)){const e={name:this.reportName,reportFields:this.currentSettings.filter(e=>e!==n_.a.TOTAL),customFieldIds:this.currentCustomFieldSettings};this.saveExportSettings(e,null)}}shareReport(e,t,n){this.sharedData=e,this.sharedData.showEstimate=this.showEstimate&&this.hideEstimateColumn;const i=this.createReportQuery();this.shareInProgress=!0,this.reportService.saveReport(i,this.TYPE).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(({id:e})=>{this.sharedLink=`${window.location.protocol}//${window.location.host}/shared/${e}`,this.shareInProgress=!1,t.close(),setTimeout(()=>{this.modalService.open(n,{centered:!0})},50)},()=>{this.shareInProgress=!1})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(re.a),s.Rb(s.h),s.Rb(xn.a),s.Rb(k.d),s.Rb(Uy.a),s.Rb(k.a),s.Rb(By.a),s.Rb(Gn.a),s.Rb(Hn.a),s.Rb(WA.a),s.Rb(w.q),s.Rb(bn.a),s.Rb(Gy.a),s.Rb(UA.a),s.Rb(a_.a),s.Rb(Ic.a),s.Rb(g.f),s.Rb(Ra.a),s.Rb(xi.a))},e.\u0275dir=s.Mb({type:e}),e})();var r_=n("R0Ic"),l_=n("EcM4");class b_{constructor(e,t,n,i,s){this.value=e,this.label=t,this.disabled=n,this.popUpText=i,this.checked=s,t||"string"!=typeof e||(this.label=e)}static getDropdownOf(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.value===t)return i}return null}}var d_=n("msBQ"),u_=n("PS6/"),p_=n("VfV2");function h_(e,t){if(1&e){const e=s.Yb();s.Xb(0,"dropdown-items",3),s.jc("onChanged",(function(t){return s.Oc(e),s.nc().setTabs(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("list",e.reportTypes)("initLabel",null==e.selected?null:e.selected.label.toUpperCase())("value",null==e.selected?null:e.selected.label)}}function m_(e,t){1&e&&(s.Xb(0,"span",4),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.REPORTS_LABEL")," "))}function g_(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"a",5),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"a",6),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"a",7),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Xb(10,"a",8),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.Hb("cl-active","SUMMARY"===e.page),s.wc("queryParams",e.switchReportService.queryParams),s.Cb(1),s.ad(s.pc(3,15,"GLOBAL.REPORTS_SUMMARY_LABEL")),s.Cb(2),s.Hb("cl-active","DETAILED"===e.page),s.wc("queryParams",e.switchReportService.queryParams),s.Cb(1),s.ad(s.pc(6,17,"GLOBAL.DETAILED_LABEL")),s.Cb(2),s.Hb("cl-active","WEEKLY"===e.page),s.wc("queryParams",e.switchReportService.queryParams),s.Cb(1),s.ad(s.pc(9,19,"GLOBAL.WEEKLY_REPORTS_LABEL")),s.Cb(2),s.Hb("cl-active","SHARED"===e.page),s.Cb(1),s.ad(s.pc(12,21,"LAYOUT.SIDEBAR.NAVIGATION.SHARED_REPORTS_LABEL"))}}function E_(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"a",9),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.Hb("cl-active","EXPENSE_DETAILED"===e.page),s.wc("queryParams",e.switchReportService.queryParams),s.Cb(1),s.ad(s.pc(3,4,"GLOBAL.DETAILED_LABEL"))}}let f_=(()=>{class e{constructor(e,t,n,i){this.switchReportService=e,this.workspaceService=t,this.translationService=n,this.router=i,this.reportTypes=[new Ea.a("TIME",this.translationService.instant("REPORTS.TYPE.TIME")),new Ea.a("EXPENSE",this.translationService.instant("REPORTS.TYPE.EXPENSES"))],this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.hasExpensesFeature=this.workspace.hasFeature(is.a.EXPENSES)}set page(e){if(this._page=e,this._page===Fy.a.EXPENSE_DETAILED.toString())return this.selected=this.reportTypes[1],void(this.selectedReport=this.reportTypes[1].value);this.selected=this.reportTypes[0],this.selectedReport=this.reportTypes[0].value}get page(){return this._page}setTabs(e){const t=this.switchReportService.queryParams;let n="";this.selectedReport=e,n="EXPENSE"===this.selectedReport?"/reports/expense/detailed":"/reports/summary";const i=this.router.createUrlTree([n],{queryParams:t}),s=this.router.serializeUrl(i);this.router.navigateByUrl(s)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(a_.a),s.Rb(l.a),s.Rb(g.f),s.Rb(k.d))},e.\u0275cmp=s.Lb({type:e,selectors:[["switch-reports"]],inputs:{page:"page"},decls:5,vars:4,consts:[[3,"list","initLabel","value","onChanged",4,"ngIf","ngIfElse"],["onlyTimeReports",""],[4,"ngIf"],[3,"list","initLabel","value","onChanged"],[1,"cl-btn","cl-btn-outline-light","cl-page-switcher-name","cl-d-none","cl-d-sm-inline-flex"],["routerLink","/reports/summary",1,"cl-btn","cl-btn-outline-light",3,"queryParams"],["routerLink","/reports/detailed",1,"cl-btn","cl-btn-outline-light",3,"queryParams"],["routerLink","/reports/weekly",1,"cl-btn","cl-btn-outline-light",3,"queryParams"],["routerLink","/reports/shared",1,"cl-btn","cl-btn-outline-light"],["routerLink","/reports/expense/detailed",1,"cl-btn","cl-btn-outline-light",3,"queryParams"]],template:function(e,t){if(1&e&&(s.Xc(0,h_,1,3,"dropdown-items",0),s.Xc(1,m_,3,3,"ng-template",null,1,s.Yc),s.Xc(3,g_,13,23,"ng-container",2),s.Xc(4,E_,4,6,"ng-container",2)),2&e){const e=s.Lc(2);s.wc("ngIf",t.hasExpensesFeature&&t.workspace.expensesEnabled)("ngIfElse",e),s.Cb(3),s.wc("ngIf","TIME"===t.selectedReport),s.Cb(1),s.wc("ngIf","EXPENSE"===t.selectedReport)}},directives:[i.u,ji.a,k.g],pipes:[g.e],encapsulation:2}),e})();var S_=n("uX6w"),C_=n("VHTb"),A_=n("Rt6l");const O_=["featurePopover"];function v_(e,t){if(1&e){const e=s.Yb();s.Xb(0,"dropdown-checkbox",12),s.jc("onCloseFilter",(function(t){return s.Oc(e),s.nc().auditDropdownChanged(t)}))("onChange",(function(t){return s.Oc(e),s.nc().auditDropdownChanged(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("labelProp","label")("valueProp","value")("isResizeable",!1)("showSearch",!1)("showSelectAll",!1)("selectableMaps",e.auditMaps)}}function T_(e,t){if(1&e&&(s.Xb(0,"div"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",e.auditLabel," ")}}function I_(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",23),s.jc("click",(function(){return s.Oc(e),s.nc(3).resetFilter()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.CLEAR_ALL_BTN")))}function w_(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Sb(1,"hr",14),s.Xb(2,"div",15),s.Xb(3,"div",16),s.Xb(4,"dropdown-items",17),s.jc("onChanged",(function(t){s.Oc(e);const n=s.nc(2);return n.auditFilters.compare=t,n.emit()})),s.Wb(),s.Xb(5,"div",18),s.Xb(6,"input",19,20),s.jc("keyup.enter",(function(){return s.Oc(e),s.Lc(7).blur()}))("inputChange",(function(t){s.Oc(e);const n=s.nc(2);return n.auditFilters.durationInput=t,n.durationInputChanged()})),s.Wb(),s.Wb(),s.Xb(8,"dropdown-items",21),s.jc("onChanged",(function(t){s.Oc(e);const n=s.nc(2);return n.auditFilters.unit=t,n.emit()})),s.Wb(),s.Wb(),s.Xc(9,I_,3,3,"a",22),s.Wb(),s.Ub()}if(2&e){const e=s.nc(2);s.Cb(4),s.wc("list",e.compareDropdown)("value",e.auditFilters.compare)("type","DROPDOWN"),s.Cb(2),s.wc("ngModel",e.auditFilters.durationInput),s.Cb(2),s.wc("list",e.unitsDropdown)("value",e.auditFilters.unit)("type","DROPDOWN"),s.Cb(1),s.wc("ngIf",e.auditFilters.audit.length)}}function L_(e,t){if(1&e&&(s.Xb(0,"div",13),s.Xc(1,w_,10,8,"ng-container",9),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.isDurationSelected)}}const R_=function(){return["/upgrade"]},y_=function(){return{plan:"basic"}};function __(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"a",24),s.jc("click",(function(){return s.Oc(e),s.nc(2).analyticsService.addEventOnSettingsChanged("Enterprise","Workspace settings","Auditlog","Upgrade")})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Zc(4),s.oc(5,"translate"),s.Ub()}2&e&&(s.Cb(1),s.wc("routerLink",s.Ac(8,R_))("queryParams",s.Ac(9,y_)),s.Cb(1),s.ad(s.pc(3,4,"GLOBAL.UPGRADE_BTN")),s.Cb(2),s.bd(" ",s.pc(5,6,"REPORTS.AUDIT.UPGRADE_TO_USE_AUDIT_PART_2")," "))}function k_(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"REPORTS.AUDIT.UPGRADE_TO_USE_AUDIT_COMPLETE")," "))}function W_(e,t){if(1&e&&(s.Xc(0,__,6,10,"ng-container",9),s.Xc(1,k_,3,3,"ng-container",9)),2&e){const e=s.nc();s.wc("ngIf",e.isAdminOrOwner),s.Cb(1),s.wc("ngIf",!e.isAdminOrOwner)}}let X_=(()=>{class e{constructor(e,t,n,i){this.analyticsService=e,this.cd=t,this.workspaceService=n,this.translateService=i,this._auditFilters=new A_.a,this.onChange=new s.n,this.unitsDropdown=[new Un.a("SECONDS",this.translateService.instant("REPORTS.AUDIT.SECONDS_LABEL")),new Un.a("MINUTES",this.translateService.instant("GLOBAL.MINUTES_LABEL")),new Un.a("HOURS",this.translateService.instant("GLOBAL.HOURS_LABEL"))],this.compareDropdown=[new Un.a("SHORTER",this.translateService.instant("REPORTS.AUDIT.SHORTER_TAN_LABEL")),new Un.a("LONGER",this.translateService.instant("REPORTS.AUDIT.LONGER_THAN_LABEL"))],this.durationDebouncer$=new p.a,this.unsubscribe$=new p.a}set auditFilters(e){this._auditFilters=A_.a.clone(e)}get auditFilters(){return this._auditFilters}ngOnInit(){this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.hasPermission=e.hasFeature(is.a.WORKSPACE_TIME_AUDIT)}),this.initAuditMap(),this.durationDebouncer$.pipe(Object(De.a)(180),Object(Lh.a)()).subscribe(()=>this.emit())}ngAfterViewInit(){this.generateLabel(),this.auditLabel&&this.cd.detectChanges()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}auditDropdownChanged({selectableMaps:e}){const t=e.getSelectedEntities("Audit");this.auditFilters.audit=t.map(e=>e.value),this.generateLabel(),this.emit(),t.map(e=>e.label).forEach(e=>{this.analyticsService.addEvent(new Fi.a({event:"switch",value:"ON",section:"Reports",section2:"Detailed",section3:e,section4:"Suspicious duration"}))})}generateLabel(){this.auditLabel=this.auditMaps.getSelectedEntities("Audit").filter(e=>e.value!==A_.b.SUSPICIOUS).map(e=>e.label).join(", ")}emit(){this.hasPermission?this.onChange.emit(this.auditFilters):this.featurePopover.isOpen()?this.featurePopover.close():this.featurePopover.open()}resetFilter(){this.auditFilters=new A_.a,this.auditMaps.setSelected(!1),this.emit()}durationInputChanged(){this.durationDebouncer$.next(this.auditFilters.durationInput)}get isDurationSelected(){return this.auditFilters.audit.includes(A_.b.SUSPICIOUS)}initAuditMap(){const e=[new Un.a(A_.b.NO_PROJECT,this.translateService.instant("GLOBAL.WITHOUT_PROJECT_LABEL")),new Un.a(A_.b.NO_TASK,this.translateService.instant("GLOBAL.WITHOUT_TASK_LABEL")),new Un.a(A_.b.SUSPICIOUS,this.translateService.instant("REPORTS.AUDIT.SUSPICIOUS_LABEL"))],t=new mg.a("Audit",e);t.setSelected(this.auditFilters.audit),this.auditMaps=new Tn.a([t])}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(xi.a),s.Rb(s.h),s.Rb(l.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["audit"]],viewQuery:function(e,t){var n;1&e&&s.gd(O_,!0),2&e&&s.Kc(n=s.kc())&&(t.featurePopover=n.first)},inputs:{auditFilters:"auditFilters",isAdminOrOwner:"isAdminOrOwner"},outputs:{onChange:"onChange"},decls:17,vars:9,consts:[[1,"cl-row","cl-no-gutters","cl-w-100"],[1,"cl-col-lg-custom-auto"],[1,"cl-report-entry-actions","cl-border-bottom-0","cl-d-flex","cl-py-md-3","cl-py-lg-custom-2"],["dropdownKey","",1,"cl-dropdown","cl-d-flex","cl-w-auto"],["dropdownKeyButton","","tabindex","0","triggers","manual","placement","right","container","body",1,"pointer","cl-component-divided-left","cl-no-divider-border","cl-dropdown-toggle","cl-d-flex",3,"ngbPopover"],["featurePopover","ngbPopover"],[3,"labelProp","valueProp","isResizeable","showSearch","showSelectAll","selectableMaps","onCloseFilter","onChange",4,"dropdownKeyContent"],[1,"cl-component-divided-left","cl-justify-content-start"],[1,"cl-text-gray-9","cl-d-none","cl-d-lg-custom-block","cl-mr-2"],[4,"ngIf"],["class","cl-col",4,"ngIf"],["popContent",""],[3,"labelProp","valueProp","isResizeable","showSearch","showSelectAll","selectableMaps","onCloseFilter","onChange"],[1,"cl-col"],[1,"cl-m-0","cl-d-lg-custom-none"],[1,"cl-d-flex","cl-align-items-center","cl-h-100","cl-py-1","cl-py-lg-custom-0","cl-pl-1","cl-pr-2"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-ml-2",3,"list","value","type","onChanged"],[1,"cl-d-flex"],["type","text","inputNumber","",1,"cl-form-control","cl-input-report-main","cl-input-3-digits","cl-ml-2","cl-mr-2","cl-text-center",3,"ngModel","keyup.enter","inputChange"],["durationInputField",""],[1,"cl-px-1",3,"list","value","type","onChanged"],["class","cl-small cl-ml-auto cl-mr-1 cl-my-auto",3,"click",4,"ngIf"],[1,"cl-small","cl-ml-auto","cl-mr-1","cl-my-auto",3,"click"],[3,"routerLink","queryParams","click"]],template:function(e,t){if(1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4,5),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xc(8,v_,1,6,"dropdown-checkbox",6),s.Wb(),s.Xb(9,"div",7),s.Xb(10,"div",8),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xc(13,T_,2,1,"div",9),s.Wb(),s.Wb(),s.Wb(),s.Xc(14,L_,2,1,"div",10),s.Wb(),s.Xc(15,W_,2,2,"ng-template",null,11,s.Yc)),2&e){const e=s.Lc(16);s.Cb(4),s.wc("ngbPopover",e),s.Cb(2),s.bd(" ",s.pc(7,5,"REPORTS.MODELS.AUDIT_LABEL")," "),s.Cb(5),s.bd(" ",s.pc(12,7,t.auditFilters.audit.length&&t.hasPermission?"REPORTS.AUDIT.SHOW_ENTRIES_LABEL_1":"REPORTS.AUDIT.SHOW_ENTRIES_LABEL_2")," "),s.Cb(2),s.wc("ngIf",t.auditFilters.audit.length&&t.hasPermission),s.Cb(1),s.wc("ngIf",t.hasPermission)}},directives:[ni.a,ii.a,w.M,si.a,i.u,Cg.a,ji.a,v.c,jr.a,v.s,v.v,k.g],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var N_=n("QTph"),D_=n("URdK");const P_=["featurePopover"];function M_(e,t){if(1&e&&(s.Xb(0,"span",36),s.Zc(1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",e.numberOfSelected," ")}}function B_(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",32),s.jc("onOpen",(function(){return s.Oc(e),s.nc().isDropdownFilterOpen=!0}))("onClose",(function(){return s.Oc(e),s.nc().isDropdownFilterOpen=!1})),s.Xb(1,"div",33),s.Zc(2),s.oc(3,"translate"),s.Xc(4,M_,2,1,"span",34),s.Wb(),s.Xb(5,"app-user-dropdown",35),s.jc("result",(function(t){return s.Oc(e),s.nc().dropdownResults(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.bd(" ",s.pc(3,5,"GLOBAL.USERS_LABEL")," "),s.Cb(2),s.wc("ngIf",e.numberOfSelected),s.Cb(1),s.wc("shouldResetAfterResult",!0)("users",e.users)("userGroups",e.userGroups)}}function U_(e,t){if(1&e){const e=s.Yb();s.Xb(0,"project-picker",37,38),s.jc("selectedProjectAndTask",(function(t){return s.Oc(e),s.nc().selectProjectAndTask(t)}))("onResize",(function(t){return s.Oc(e),s.Lc(1).onResizeChange(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("selectedProject",e.timeEntry.project)("selectedUserId",null==e.selectedUser?null:e.selectedUser.id)("selectedTask",e.timeEntry.task)("hideWorkspaces",!0)("resizeableName","projectPicker")}}function G_(e,t){if(1&e){const e=s.Yb();s.Xb(0,"tag-dropdown",39),s.jc("close",(function(t){return s.Oc(e),s.nc().selectTags(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("resizeableName","tagPicker")("resizeToLeft",!0)("entryTags",e.timeEntry.tags)}}function x_(e,t){if(1&e){const e=s.Yb();s.Xb(0,"billable-icon",40),s.jc("changed",(function(t){s.Oc(e);const n=s.nc();return n.timeEntry.billable=t,n.checkPermissionPopup()})),s.Wb()}if(2&e){const e=s.nc();s.wc("billable",e.timeEntry.billable)}}function F_(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"custom-fields-values",41),s.jc("entryChanged",(function(t){return s.Oc(e),s.nc().customFieldValueChanged(t)})),s.Wb(),s.Ub()}if(2&e){const e=s.nc();s.Cb(1),s.wc("projectId",null==e.timeEntry.project?null:e.timeEntry.project.id)("customFields",e.customFields)("customFieldValues",e.timeEntry.customFieldValues)}}const j_=function(){return["/upgrade"]},Z_=function(){return{plan:"basic"}};function V_(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",42),s.jc("click",(function(){return s.Oc(e),s.nc().analyticsService.addEventOnSettingsChanged("Basic","Upgrade","Reports","Detailed","Add time for others")})),s.Zc(1),s.oc(2,"translate"),s.Wb(),s.Zc(3),s.oc(4,"translate")}2&e&&(s.wc("routerLink",s.Ac(8,j_))("queryParams",s.Ac(9,Z_)),s.Cb(1),s.ad(s.pc(2,4,"GLOBAL.UPGRADE_BTN")),s.Cb(2),s.bd(" ",s.pc(4,6,"GLOBAL.ADD_TIME_OTHERS_TEXT_PART"),"\n"))}function Y_(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",43),s.Xb(1,"teammate-picker2",44),s.jc("userSelected",(function(t){return s.Oc(e),s.nc().selectUser(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.wc("hasAddTimeForOthersFeature",!0)("excludeLoggedInUser",!0)("userTitle",!0)("workspace",e.workspace)}}let H_=(()=>{class e{constructor(e,t,n,i,c,a,o,r,l,b,d,u){this.analyticsService=e,this.entryHelperService=t,this.workspaceService=n,this.tagService=i,this.cd=c,this.toaster=a,this.trackerService=o,this.authService=r,this.userService=l,this.userGroupV1Service=b,this.userGroupService=d,this.translate=u,this.onAdded=new s.n,this.onDropdownOpen$=new p.a,this.userFilterOptions=on.v,this.unsubscribe$=new p.a}ngOnInit(){this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.hasPermission=e.hasFeature(is.a.ADD_TIME_FOR_OTHERS)});const e=this.workspaceService.getLocalDefaultWorkspace();this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.format=e.getTimeFormat(),this.tagService.clearTagsSubject(),this.tagService.getAllTags(Rn.a.ACTIVE);const t=this.authService.getUser();this.projectData=new BA.a(e,t),this.initEntry(),this.onlyAdminCanSeeAndChangeBillable=this.workspace.onlyAdminsCanChangeBillableStatus,this.activeBillable=this.workspace.activeBillableHours}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}selectTags(e){this.timeEntry.tags=e,this.checkPermissionPopup(),this.cd.markForCheck()}initEntry(e){if(this.timeEntry=new dO.a,!e){const t=ke().set({second:0,millisecond:0}).toISOString();e=new ZA.a({start:t,end:t,duration:ke.duration(ke(t).diff(ke(t))).toISOString()})}this.timeEntry.timeInterval=new ZA.a(e)}checkPermissionPopup(){this.hasPermission||this.featurePopover.open()}createEntry(){this.timeEntry.description=this.timeEntry.description.trim(),this.checkPermissionPopup(),this.hasPermission&&(this.inProgress||this.entryHelperService.isValid(this.timeEntry)&&setTimeout(()=>{this.inProgress=!0,this.trackerService.createTimeEntryForMembers(this.timeEntry,this.getSelectedUsersFilters()).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{const t=e.map(e=>{const t=dO.a.fromTimeEntryAndReportEntry(e,this.timeEntry);return t.refreshEarned(this.amountOption),t});this.onAdded.emit(t),this.initEntry(this.timeEntry.timeInterval),this.numberOfSelected=null,this.inProgress=!1,this.cd.detectChanges()},()=>{this.inProgress=!1,this.cd.detectChanges()})}))}getSelectedUsersFilters(){var e,t;let n,i;if(this.isAdminOrOwner){if(!(this.users&&0!=(null===(e=this.users)||void 0===e?void 0:e.length)||this.userGroups&&0!=(null===(t=this.userGroups)||void 0===t?void 0:t.length)))return this.toaster.pop("error",this.translate.instant("REPORTS.ADD_TIME.SAVE_ENTRY_ERROR_MSG")),void(this.inProgress=!1);n=this.userGroups,i=this.users}else{if(!this.selectedUser)return this.toaster.pop("error",this.translate.instant("REPORTS.ADD_TIME.SAVE_ENTRY_ERROR_MSG")),void(this.inProgress=!1);i={contains:"CONTAINS",ids:[this.selectedUser.id],status:"ACTIVE"},n={contains:"CONTAINS",ids:[],status:"ACTIVE"}}return{groups:n,users:i}}customFieldValueChanged(e){this.timeEntry.customFieldValues=e}selectProjectAndTask(e){this.checkPermissionPopup(),Object(sn.E)(this.timeEntry,e,this.workspaceService.getLocalDefaultWorkspace())}dropdownResults(e){this.checkPermissionPopup(),this.numberOfSelected=e.numberOfSelected,this.users=e.users,this.userGroups=e.userGroups}selectUser(e){this.selectedUser=e}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(xi.a),s.Rb(NA.a),s.Rb(l.a),s.Rb(vn.a),s.Rb(s.h),s.Rb(r.a),s.Rb(WA.a),s.Rb(re.a),s.Rb(Lc.a),s.Rb(N_.a),s.Rb(WL.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["add-time"]],viewQuery:function(e,t){var n;1&e&&s.gd(P_,!0),2&e&&s.Kc(n=s.kc())&&(t.featurePopover=n.first)},inputs:{isAdminOrOwner:"isAdminOrOwner",amountOption:"amountOption",customFields:"customFields",isTeamManager:"isTeamManager"},outputs:{onAdded:"onAdded"},decls:39,vars:31,consts:[[1,"cl-component-row","cl-p-0"],[1,"cl-row","cl-no-gutters","cl-w-100"],[1,"cl-col"],[1,"cl-timetracker-entry-actions","cl-report-entry-actions","cl-d-flex","cl-flex-column","cl-flex-lg-row","cl-p-2","cl-p-xl-0"],[1,"cl-d-flex","cl-mr-auto","cl-w-100"],[1,"cl-px-0","cl-px-lg-custom-2","cl-w-100"],["type","text","tabindex","0","autocomplete","off",1,"cl-form-control","cl-input-timetracker-main","cl-cut-text",3,"placeholder","ngModel","keyup.enter","ngModelChange","change"],["descriptionInput",""],[1,"cl-w-100","cl-m-0","cl-d-block","cl-d-lg-none"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-justify-content-lg-end","cl-w-100","cl-w-lg-auto","cl-min-height-40"],["class","cl-dropdown cl-w-auto cl-d-lg-custom-flex","dropdownKey","",3,"onOpen","onClose",4,"ngIf","ngIfElse"],["dropdownKey","",1,"cl-dropdown","cl-component-divided-left","cl-pr-0","cl-dropdown-large","cl-d-lg-custom-flex","cl-add-time-project"],["project-picker-label","",1,"cl-cut-text",3,"project","task","projectData"],["openUpAtBottom","","class","cl-dropdown-menu","resizeable","",3,"selectedProject","selectedUserId","selectedTask","hideWorkspaces","resizeableName","selectedProjectAndTask","onResize",4,"dropdownKeyContent"],["dropdownKey","","tabCell","",1,"cl-dropdown","cl-lg-custom-down-r-0-wrapper","cl-d-report-add-time-tags"],["dropdownKeyButton","","tabindex","0",1,"pointer",3,"tags"],["class","cl-dropdown-menu cl-entry-tag-dropdown","resizeable","",3,"resizeableName","resizeToLeft","entryTags","close",4,"dropdownKeyContent"],["class","cl-component-divided-left",3,"billable","changed",4,"ngIf"],[1,"cl-col-lg-custom-auto","cl-d-flex","cl-p-2","cl-p-xl-0"],[1,"cl-border-0","cl-flex-wrap","cl-flex-sm-nowrap","cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-justify-content-lg-custom-end","cl-pr-2","cl-w-100"],[1,"cl-d-flex","cl-w-75","cl-w-sm-100",3,"textualDate","focusOnInput","dateTime","canTriggerNextDay","pickedDate"],[1,"cl-component-divided-left","cl-no-divider-border-down-md","cl-pl-1cl-w-50","cl-w-sm-auto","cl-d-flex","cl-justify-content-sm-center","cl-justify-content-start"],[3,"format","focusOnInput","timeInterval","timeChanged"],["triggers","manual","placement","left","container","body",1,"cl-w-50","cl-w-sm-auto",3,"ngbPopover"],["featurePopover","ngbPopover"],["tabindex","0","data-cy","add-time",1,"cl-btn","cl-btn-primary","cl-d-none","cl-d-lg-custom-block",3,"disabled","keyup.enter","keyup.space","click"],["addBtn",""],["tabindex","0",1,"cl-btn","cl-btn-primary","cl-btn-sm","cl-px-1","cl-d-block","cl-ml-auto","cl-d-lg-custom-none",3,"disabled","keyup.enter","keyup.space","click"],["addBtnSm",""],[4,"ngIf"],["popContent",""],["singleUserDropdown",""],["dropdownKey","",1,"cl-dropdown","cl-w-auto","cl-d-lg-custom-flex",3,"onOpen","onClose"],["dropdownKeyButton","","tabindex","0","data-cy","users-dropdown",1,"pointer","cl-component-divided-left","cl-remove-divider-mob","cl-dropdown-toggle","cl-d-flex"],["class","cl-badge cl-badge-filter",4,"ngIf"],[3,"shouldResetAfterResult","users","userGroups","result"],[1,"cl-badge","cl-badge-filter"],["openUpAtBottom","","resizeable","",1,"cl-dropdown-menu",3,"selectedProject","selectedUserId","selectedTask","hideWorkspaces","resizeableName","selectedProjectAndTask","onResize"],["projectPicker",""],["resizeable","",1,"cl-dropdown-menu","cl-entry-tag-dropdown",3,"resizeableName","resizeToLeft","entryTags","close"],[1,"cl-component-divided-left",3,"billable","changed"],[3,"projectId","customFields","customFieldValues","entryChanged"],[3,"routerLink","queryParams","click"],[1,"cl-dropdown","cl-w-100","cl-component-divided-left","cl-remove-divider-mob"],[3,"hasAddTimeForOthersFeature","excludeLoggedInUser","userTitle","workspace","userSelected"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"div",5),s.Xb(6,"input",6,7),s.jc("keyup.enter",(function(){return s.Oc(e),s.Lc(7).blur()}))("ngModelChange",(function(e){return t.timeEntry.description=e}))("change",(function(){return t.checkPermissionPopup()})),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Sb(9,"hr",8),s.Xb(10,"div",9),s.Xc(11,B_,6,7,"div",10),s.Xb(12,"div",11),s.Sb(13,"div",12),s.Xc(14,U_,2,5,"project-picker",13),s.Wb(),s.Xb(15,"div",14),s.Sb(16,"tag-names",15),s.Xc(17,G_,1,3,"tag-dropdown",16),s.Wb(),s.Xc(18,x_,1,1,"billable-icon",17),s.Wb(),s.Wb(),s.Wb(),s.Xb(19,"div",18),s.Xb(20,"div",19),s.Xb(21,"single-date-picker2",20),s.jc("pickedDate",(function(e){return t.timeEntry.timeInterval=e,t.checkPermissionPopup()})),s.Wb(),s.Xb(22,"div",21),s.Xb(23,"input-duration",22),s.jc("timeChanged",(function(e){return t.timeEntry.timeInterval=e,t.checkPermissionPopup()})),s.Wb(),s.Wb(),s.Xb(24,"div",23,24),s.Xb(26,"button",25,26),s.jc("keyup.enter",(function(){return t.createEntry()}))("keyup.space",(function(){return t.createEntry()}))("click",(function(){s.Oc(e);const n=s.Lc(27);return t.createEntry(),n.blur()})),s.Zc(28),s.oc(29,"translate"),s.Wb(),s.Xb(30,"button",27,28),s.jc("keyup.enter",(function(){return t.createEntry()}))("keyup.space",(function(){return t.createEntry()}))("click",(function(){s.Oc(e);const n=s.Lc(31);return t.createEntry(),n.blur()})),s.Zc(32),s.oc(33,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(34,F_,2,3,"ng-container",29),s.Xc(35,V_,5,10,"ng-template",null,30,s.Yc),s.Xc(37,Y_,2,4,"ng-template",null,31,s.Yc)}if(2&e){const e=s.Lc(36),n=s.Lc(38);s.Cb(6),s.xc("placeholder",s.pc(8,25,"TRACKER.TIME_TRACKER.ENTRY.DESCRIPTION")),s.wc("ngModel",t.timeEntry.description),s.Db("title",t.timeEntry.description),s.Cb(5),s.wc("ngIf",t.isAdminOrOwner)("ngIfElse",n),s.Cb(1),s.Hb("cl-disabled",!t.isAdminOrOwner&&!t.selectedUser),s.Cb(1),s.wc("project",t.timeEntry.project)("task",t.timeEntry.task)("projectData",t.projectData),s.Cb(3),s.wc("tags",t.timeEntry.tags),s.Cb(2),s.wc("ngIf",t.activeBillable&&(!t.onlyAdminCanSeeAndChangeBillable||t.isAdminOrOwner)),s.Cb(3),s.wc("textualDate",!0)("focusOnInput",!0)("dateTime",t.timeEntry.timeInterval)("canTriggerNextDay",!0),s.Cb(2),s.wc("format",t.format)("focusOnInput",!0)("timeInterval",t.timeEntry.timeInterval),s.Cb(1),s.wc("ngbPopover",e),s.Cb(2),s.wc("disabled",t.inProgress),s.Cb(2),s.bd(" ",s.pc(29,27,"GLOBAL.ADD_LABEL")," "),s.Cb(2),s.wc("disabled",t.inProgress),s.Cb(2),s.bd(" ",s.pc(33,29,"GLOBAL.ADD_LABEL")," "),s.Cb(2),s.wc("ngIf",null==t.customFields?null:t.customFields.length)}},directives:[v.c,v.s,v.v,i.u,ni.a,IO.a,si.a,XO,ii.a,zr.a,BO.a,w.M,D_.a,NO.a,DO.a,PO.a,MO.a,YO.a,k.g,PL.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();const $_=["featurePopover"];function K_(e,t){if(1&e&&(s.Xb(0,"div",11),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",e.label," ")}}const q_=function(){return{value:"quickbooks"}};function z_(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",12,13),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1),n=s.nc(),i=s.Lc(10);return t.blur(),n.openConfirmModal(i)})),s.Zc(2),s.oc(3,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("disabled",!e.numberOfEntries||e.errorResponse),s.Cb(2),s.bd(" ",s.qc(3,2,"GLOBAL.SEND_TO_PARAM",s.Ac(5,q_))," ")}}function Q_(e,t){1&e&&(s.Xb(0,"div",18),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"REPORTS.QUICK_BOOKS.NOT_SENT_ENTRIES_WARNING")," "))}const J_=function(){return{value:"QuickBooks"}},ek=function(e){return{count:e}};function tk(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",14),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().sendToQuickbooks(),n.close()}))("close",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xc(3,Q_,4,3,"div",15),s.Xb(4,"p",16),s.Zc(5),s.oc(6,"translate"),s.Xb(7,"span",17),s.Zc(8),s.Wb(),s.Zc(9),s.oc(10,"translate"),s.Xb(11,"span",17),s.Zc(12),s.oc(13,"timeFormat"),s.Wb(),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.qc(1,9,"GLOBAL.SEND_TO_PARAM",s.Ac(24,J_)))("btnText",s.pc(2,12,"GLOBAL.SEND_LABEL"))("inProgress",!1),s.Cb(3),s.wc("ngIf",e.hasLongTimeEntry),s.Cb(2),s.bd(" ",s.pc(6,14,"REPORTS.QUICK_BOOKS.SEND_CONFIRM.PART_1")," "),s.Cb(3),s.ad(e.numberOfEntries),s.Cb(1),s.bd(" ",s.qc(10,16,"REPORTS.QUICK_BOOKS.SEND_CONFIRM.PART_2",s.Bc(25,ek,e.numberOfEntries))," "),s.Cb(3),s.bd("(",s.qc(13,19,e.duration,e.format),")"),s.Cb(2),s.bd(" ",s.pc(15,22,"REPORTS.QUICK_BOOKS.SEND_CONFIRM.PART_3")," ")}}const nk=function(){return["/upgrade"]};function ik(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",19),s.jc("click",(function(){return s.Oc(e),s.nc().analyticsService.addEventOnSettingsChanged("Basic","Upgrade","Reports","Detailed","Quickbooks","Send to Quickbooks")})),s.Zc(1),s.oc(2,"translate"),s.Wb(),s.Zc(3),s.oc(4,"translate")}2&e&&(s.wc("routerLink",s.Ac(7,nk)),s.Cb(1),s.ad(s.pc(2,3,"REPORTS.QUICK_BOOKS.UPGRADE_MESSAGE.PART_1")),s.Cb(2),s.bd(" ",s.pc(4,5,"REPORTS.QUICK_BOOKS.UPGRADE_MESSAGE.PART_2"),"\n"))}let sk=(()=>{class e{constructor(e,t,n,i){this.analyticsService=e,this.cd=t,this.modalService=n,this.translate=i,this.onChange=new s.n,this.onSendToQuickbooks=new s.n,this.quickbooksDropdown=[new Un.a("NOT_SENT",this.translate.instant("REPORTS.QUICK_BOOKS.SHOW_NOT_SENT_LABEL"),this.translate.instant("REPORTS.QUICK_BOOKS.SHOWING_NOT_SENT_LABEL")),new Un.a("SENT",this.translate.instant("REPORTS.QUICK_BOOKS.SHOW_SENT_LABEL"),this.translate.instant("REPORTS.QUICK_BOOKS.SHOWING_SENT_LABEL"))],this.unsubscribe$=new p.a}set quickbooksSelectType(e){this._quickbooksSelectType=e}get quickbooksSelectType(){return this._quickbooksSelectType}ngOnInit(){}ngAfterViewInit(){}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}get numberOfEntries(){var e;return(null===(e=this.timeEntries)||void 0===e?void 0:e.length)||0}get label(){const e=Un.a.getDropdownOf(this.quickbooksDropdown,this.quickbooksSelectType);return(null==e?void 0:e.placeholder)||""}openConfirmModal(e){const t=new DA.a(0);(this.timeEntries||[]).forEach(e=>{t.add(e.timeInterval.duration)}),this.duration=t.asString(),this.modalService.open(e,{centered:!0})}sendToQuickbooks(){this.onSendToQuickbooks.emit(),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"Send to Quickbooks",section:"Reports",section2:"Detailed",section3:"Quickbooks",section4:"Send to Quickbooks"}))}onDropdownChange(e){this.hasQuickbookPermission?(this.quickbooksSelectType=e,this.onChange.emit(this.quickbooksSelectType)):this.featurePopover.isOpen()?this.featurePopover.close():this.featurePopover.open()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(xi.a),s.Rb(s.h),s.Rb(w.q),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["quickbooks"]],viewQuery:function(e,t){var n;1&e&&s.gd($_,!0),2&e&&s.Kc(n=s.kc())&&(t.featurePopover=n.first)},inputs:{hasQuickbookPermission:"hasQuickbookPermission",quickbooksSelectType:"quickbooksSelectType",isAdminOrOwner:"isAdminOrOwner",timeEntries:"timeEntries",format:"format",errorResponse:"errorResponse",hasLongTimeEntry:"hasLongTimeEntry"},outputs:{onChange:"onChange",onSendToQuickbooks:"onSendToQuickbooks"},decls:13,vars:7,consts:[[1,"cl-row","cl-no-gutters","cl-w-100"],[1,"cl-col-lg-custom-auto"],[1,"cl-report-entry-actions","cl-border-bottom-0","cl-d-flex","cl-py-2"],[1,"cl-dropdown","cl-d-flex","cl-w-auto","cl-align-items-center"],["triggers","manual","placement","right","container","body",1,"cl-ml-2",3,"ngbPopover","overrideLabel","list","value","type","onChanged"],["featurePopover","ngbPopover"],[1,"cl-component-divided-left","cl-justify-content-start"],["class","cl-mr-3",4,"ngIf"],["class","cl-btn cl-quickbooks-btn-green",3,"disabled","click",4,"ngIf"],["confirmModal",""],["popContent",""],[1,"cl-mr-3"],[1,"cl-btn","cl-quickbooks-btn-green",3,"disabled","click"],["sendBtn",""],[3,"title","btnText","inProgress","confirmed","close"],["class","cl-alert cl-d-block cl-alert-warning cl-mb-3",4,"ngIf"],[1,"cl-text-dark","cl-mb-0"],[1,"cl-h2"],[1,"cl-alert","cl-d-block","cl-alert-warning","cl-mb-3"],[3,"routerLink","click"]],template:function(e,t){if(1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"dropdown-items",4,5),s.jc("onChanged",(function(e){return t.onDropdownChange(e)})),s.Wb(),s.Wb(),s.Xb(6,"div",6),s.Xc(7,K_,2,1,"div",7),s.Xc(8,z_,4,6,"button",8),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(9,tk,16,27,"ng-template",null,9,s.Yc),s.Xc(11,ik,5,8,"ng-template",null,10,s.Yc)),2&e){const e=s.Lc(12);s.Cb(4),s.wc("ngbPopover",e)("overrideLabel","QUICKBOOKS")("list",t.quickbooksDropdown)("value",t.quickbooksSelectType)("type","DROPDOWN"),s.Cb(3),s.wc("ngIf",t.label),s.Cb(1),s.wc("ngIf","NOT_SENT"===t.quickbooksSelectType)}},directives:[ji.a,w.M,i.u,Si.a,k.g],pipes:[g.e,dv.a],encapsulation:2,changeDetection:0}),e})();var ck=n("AIwn"),ak=n("/pT+"),ok=n("nQ1P");n("Y9C3");const rk=["dropdown"],lk=["scheduleFeaturePopover"],bk=function(){return["/upgrade"]},dk=function(){return{plan:"basic"}};function uk(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",24),s.jc("click",(function(){return s.Oc(e),s.nc(2).analyticsService.addEventOnSettingsChanged("Basic","Upgrade","Reports","Detailed","Summary export settings")}))("click",(function(){return s.Oc(e),s.nc(2).closeModal()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.wc("routerLink",s.Ac(5,bk))("queryParams",s.Ac(6,dk)),s.Cb(1),s.ad(s.pc(2,3,"GLOBAL.UPGRADE_BTN")))}function pk(e,t){if(1&e&&(s.Xb(0,"div",22),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xc(4,uk,3,7,"a",23),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.bd(" ",s.pc(3,2,"GLOBAL.BASIC_FEATURE_LABEL")," "),s.Cb(2),s.wc("ngIf",e.isAdminOrOwner)}}function hk(e,t){1&e&&s.Sb(0,"div",25)}function mk(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",28),s.Xb(1,"input",29),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().addElement(t)})),s.Wb(),s.Xb(2,"label",30),s.Zc(3),s.Wb(),s.Wb()}if(2&e){const e=s.nc(),t=e.index,n=e.$implicit;s.Cb(1),s.xc("id",t),s.wc("checked",n.checked)("disabled",n.disabled),s.Cb(1),s.xc("for",t),s.Cb(1),s.ad(n.label)}}const gk=function(e,t){return{"cl-col-md-12":e," cl-col-md-6":t}};function Ek(e,t){if(1&e&&(s.Xb(0,"div",26),s.Xc(1,mk,4,5,"div",27),s.Wb()),2&e){const e=t.$implicit,n=s.nc();s.wc("ngClass",s.Cc(2,gk,"DETAILED"!==n.reportType,"DETAILED"==n.reportType)),s.Cb(1),s.wc("ngIf",!e.disabled)}}function fk(e,t){1&e&&(s.Xb(0,"label",12),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"REPORTS.CUSTOMIZE.DISPLAY_CASE_2")))}function Sk(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",33),s.Xb(1,"div",28),s.Xb(2,"input",29),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc(2).addElement(n)})),s.Wb(),s.Xb(3,"label",34),s.Zc(4),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit,n=t.index;s.Cb(2),s.yc("id","o+",n,""),s.wc("checked",e.checked)("disabled",e.disabled),s.Cb(1),s.yc("for","o+",n,""),s.Cb(1),s.ad(e.label)}}function Ck(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",36),s.Xb(1,"div",28),s.Xb(2,"input",37,38),s.jc("click",(function(){s.Oc(e);const n=t.$implicit,i=t.index;return s.nc(3).addCustomField(n,i)})),s.Wb(),s.Xb(4,"label",34),s.Zc(5),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit,n=t.index,i=s.nc(3);s.Cb(2),s.yc("id","p+",n,""),s.wc("checked",i.containsCustomField(e)),s.Cb(2),s.yc("for","p+",n,""),s.Cb(1),s.ad(e.name)}}function Ak(e,t){if(1&e&&(s.Vb(0),s.Xc(1,Ck,6,4,"div",35),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngForOf",e.customFields)}}function Ok(e,t){if(1&e&&(s.Xb(0,"div",7),s.Xc(1,Sk,5,5,"div",31),s.Xc(2,Ak,2,1,"ng-container",32),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngForOf",e.options.csvXlsxOptions),s.Cb(1),s.wc("ngIf","DETAILED"==e.reportType&&e.customFields&&0!==e.customFields.length)}}function vk(e,t){1&e&&(s.Xb(0,"label",12),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"REPORTS.CUSTOMIZE.DISPLAY_CASE_3")))}function Tk(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",26),s.Xb(1,"div",28),s.Xb(2,"input",29),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc(2).addElement(n)})),s.Wb(),s.Xb(3,"label",34),s.Zc(4),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit,n=t.index,i=s.nc(2);s.wc("ngClass",s.Cc(6,gk,"DETAILED"!==i.reportType,"DETAILED"==i.reportType)),s.Cb(2),s.yc("id","z+",n,""),s.wc("checked",e.checked)("disabled",e.disabled),s.Cb(1),s.yc("for","z+",n,""),s.Cb(1),s.ad(e.label)}}function Ik(e,t){if(1&e&&(s.Xb(0,"div",7),s.Xc(1,Tk,5,9,"div",13),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngForOf",e.options.pdfOptions)}}function wk(e,t){1&e&&(s.Xb(0,"label",12),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"REPORTS.CUSTOMIZE.DISPLAY_CASE_3")))}let Lk=(()=>{class e{constructor(e,t,n,i,c,a,o,r){this.analyticsService=e,this.formBuilder=t,this.cd=n,this.router=i,this.modalService=c,this.userGroupServiceOld=a,this.workspaceService=o,this.translate=r,this.reportName="",this.scheduledReport=null,this.onOpen=new s.n,this.onClose=new s.n,this.onSave=new s.n,this.ReportFilter=on.i,this.unsubscribe$=new p.a,this.ScheduledReportType=ok.a,this.isSelfHosted=bo.a.environment.selfHosted,this.Features=is.a}set checkedCustomFields(e){e&&(e.forEach(e=>{var t;return null===(t=this.customFieldIds)||void 0===t?void 0:t.push(new v.g(e))}),this._checkedCustomFields=e)}get checkedCustomFields(){return this._checkedCustomFields}set currentSettings(e){if(void 0!==e)return e?void(e&&(this.reportFields&&this.reportFields.clear(),e.forEach(e=>{var t;return null===(t=this.reportFields)||void 0===t?void 0:t.push(new v.g(e))}),this._currentSettings=e,this.options&&this.setChecked())):(this._currentSettings=Object.keys(Object($n.e)(this.reportType)).map(e=>Object($n.e)(this.reportType)[e]),void(this._currentSettings=this._currentSettings.filter(e=>"RTL"!=e)))}get currentSettings(){return this._currentSettings}set options(e){e&&(this._options=e)}get options(){return this._options}ngOnInit(){this.onOpen.emit(),this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.customizeForm=this.formBuilder.group({name:[this.reportName,[]],reportFields:[this.formBuilder.array([],v.G.required)],customFieldIds:[this.formBuilder.array([],v.G.required)]}),this.hasCustomReportsFeature=this.workspace.hasFeature(is.a.CUSTOM_REPORTING),this.allCheckedInit()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}allCheckedInit(){var e,t,n,i,s,c,a,o,r,l;let b=(null===(t=null===(e=this.options)||void 0===e?void 0:e.pdfOptions)||void 0===t?void 0:t.length)+(null===(i=null===(n=this.options)||void 0===n?void 0:n.csvXlsxOptions)||void 0===i?void 0:i.length)+(null===(c=null===(s=this.options)||void 0===s?void 0:s.allOptions)||void 0===c?void 0:c.length);b=this.reportType===Fy.a.DETAILED?b+((null===(a=this.customFields)||void 0===a?void 0:a.length)||0):b;let d=(null===(o=this.currentSettings)||void 0===o?void 0:o.length)+(null===(r=this.checkedCustomFields)||void 0===r?void 0:r.length);d=(null===(l=this.currentSettings)||void 0===l?void 0:l.includes("RTL"))?d-1:d,this.allSelected=b===d}setChecked(){this.options.allOptions.forEach(e=>{e.checked=this.currentSettings.indexOf(e.value)>-1}),this.options.pdfOptions.forEach(e=>{e.checked=this.currentSettings.indexOf(e.value)>-1}),this.options.csvXlsxOptions.forEach(e=>{e.checked=this.currentSettings.indexOf(e.value)>-1})}get reportFields(){var e,t;return null===(t=null===(e=this.customizeForm)||void 0===e?void 0:e.get("reportFields"))||void 0===t?void 0:t.value}get customFieldIds(){var e;return null===(e=this.customizeForm)||void 0===e?void 0:e.get("customFieldIds").value}get placeholder(){return this.translate.instant("REPORTS.CUSTOMIZE.REPORT_PLACEHOLDER",{report:this.getTypeTranslation()})}getTypeTranslation(){switch(this.reportType){case Fy.a.DETAILED:return this.translate.instant("GLOBAL.DETAILED_LABEL");case Fy.a.SUMMARY:return this.translate.instant("GLOBAL.REPORTS_SUMMARY_LABEL");case Fy.a.WEEKLY:return this.translate.instant("GLOBAL.WEEKLY_REPORTS_LABEL");default:Object(u_.a)(this.reportType)}}disableButton(){return this.reportFields.length+this.customFieldIds.length<1&&"DETAILED"==this.reportType}navigateToUpgrade(){this.modalService.dismissAll(),this.router.navigate(["/upgrade"])}closeModal(){this.onClose.emit()}checkIfChecked(e){var t;return null===(t=this.currentSettings)||void 0===t?void 0:t.includes(e)}containsCustomField(e){var t;return null===(t=this.checkedCustomFields)||void 0===t?void 0:t.includes(e.id)}checkIfAllSelected(){var e,t,n,i,s,c,a,o,r,l,b;const d=(null===(t=null===(e=this.reportFields)||void 0===e?void 0:e.value)||void 0===t?void 0:t.length)+(null===(i=null===(n=this.customFieldIds)||void 0===n?void 0:n.value)||void 0===i?void 0:i.length);let u=(null===(c=null===(s=this.options)||void 0===s?void 0:s.pdfOptions)||void 0===c?void 0:c.length)+(null===(o=null===(a=this.options)||void 0===a?void 0:a.csvXlsxOptions)||void 0===o?void 0:o.length)+(null===(l=null===(r=this.options)||void 0===r?void 0:r.allOptions)||void 0===l?void 0:l.length);u=this.reportType===Fy.a.DETAILED?u+((null===(b=this.customFields)||void 0===b?void 0:b.length)||0):u,this.allSelected=this.elementExists("RTL")?d-1===u:d===u}addCustomField(e,t){this.customFieldIds.value.findIndex(t=>t===e.id)>-1?(this.customFieldIds.removeAt(this.customFieldIds.value.findIndex(t=>t===e.id)),document.getElementById("p+"+t).checked=!1):(this.customFieldIds.push(new v.g(e.id)),document.getElementById("p+"+t).checked=!0),this.checkIfAllSelected()}addRTL(){this.addElement(new b_("RTL"))}addElement(e){this.elementExists(e.value)?(this.removeElement(e.value),e.checked=!1):(this.reportFields.push(new v.g(e.value)),e.checked=!0),this.checkIfAllSelected()}elementExists(e){return this.reportFields.value.findIndex(t=>t===e)>-1}removeElement(e){this.reportFields.removeAt(this.reportFields.value.findIndex(t=>t===e))}selectAll(){var e;this.options.allOptions.forEach(e=>this.add(e)),this.options.pdfOptions.forEach(e=>this.add(e)),this.options.csvXlsxOptions.forEach(e=>this.add(e)),null===(e=this.customFields)||void 0===e||e.forEach((e,t)=>this.addCF(e,t)),this.allSelected=!this.allSelected}addCF(e,t){if(this.allSelected)document.getElementById("p+"+t)&&(document.getElementById("p+"+t).checked=!1),this.customFieldIds.removeAt(this.customFieldIds.value.findIndex(t=>t===e.id));else{if(this.customFieldIds.value.findIndex(t=>t===e.id)>-1)return;this.customFieldIds.push(new v.g(e.id)),document.getElementById("p+"+t)&&(document.getElementById("p+"+t).checked=!0)}}add(e){if(this.allSelected)return this.removeElement(e.value),void(e.checked=!1);this.elementExists(e.value)||(this.reportFields.push(new v.g(e.value)),e.checked=!0)}onSubmit(){setTimeout(()=>{var e,t;if(this.inProgress)return;const n={name:null===(t=null===(e=this.customizeForm.value)||void 0===e?void 0:e.name)||void 0===t?void 0:t.trim(),reportFields:this.customizeForm.value.reportFields.value,customFieldIds:this.customizeForm.value.customFieldIds.value};this.onSave.emit(n),this.closeModal()})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(xi.a),s.Rb(v.f),s.Rb(s.h),s.Rb(k.d),s.Rb(w.q),s.Rb(WL.a),s.Rb(l.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["customize-report"]],viewQuery:function(e,t){var n;1&e&&(s.gd(rk,!0),s.gd(lk,!0)),2&e&&(s.Kc(n=s.kc())&&(t.dropdownItems=n.first),s.Kc(n=s.kc())&&(t.scheduleFeaturePopover=n.first))},inputs:{inProgress:"inProgress",reportType:"reportType",canSeeRates:"canSeeRates",reportName:"reportName",customFields:"customFields",_checkedCustomFields:"_checkedCustomFields",checkedCustomFields:"checkedCustomFields",isCostRateActive:"isCostRateActive",scheduledReport:"scheduledReport",isAdminOrOwner:"isAdminOrOwner",currentSettings:"currentSettings",options:"options"},outputs:{onOpen:"onOpen",onClose:"onClose",onSave:"onSave"},decls:38,vars:34,consts:[["class","cl-form-group cl-mt-2 cl-mt-lg-0",4,"ngIf"],["novalidate","",3,"formGroup","ngSubmit"],[1,"cl-modal-body"],["class","cl-blocker cl-ml-n3 cl-mt-n3",4,"ngIf"],[1,"cl-form-group"],["for","reportName"],["type","text","ngbAutofocus","","autocomplete","off","formControlName","name","id","reportName",1,"cl-form-control",3,"readOnly","ngModel","placeholder","ngModelChange"],[1,"cl-form-row"],[1,"cl-form-group","cl-cold-md-12"],[1,"cl-custom-control","cl-custom-checkbox","cl-z-index-0","cl-z-index-0"],["type","checkbox","id","selectAll",1,"cl-custom-control-input",3,"checked","disabled","click"],["for","selectAll",1,"cl-custom-control-label"],[1,"cl-col-form-label"],["class","cl-form-group",3,"ngClass",4,"ngFor","ngForOf"],["class","cl-col-form-label",4,"ngIf"],["class","cl-form-row",4,"ngIf"],[1,"cl-custom-control","cl-custom-switch"],["type","checkbox","name","rtl","id","rtl",1,"cl-custom-control-input",3,"checked","change"],["for","rtl",1,"cl-custom-control-label"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"click","keyup.enter"],["type","submit","tabindex","0",1,"cl-btn","cl-btn-primary",3,"disabled"],[1,"cl-form-group","cl-mt-2","cl-mt-lg-0"],["class","cl-btn",3,"routerLink","queryParams","click",4,"ngIf"],[1,"cl-btn",3,"routerLink","queryParams","click"],[1,"cl-blocker","cl-ml-n3","cl-mt-n3"],[1,"cl-form-group",3,"ngClass"],["class","cl-custom-control cl-custom-checkbox cl-z-index-0",4,"ngIf"],[1,"cl-custom-control","cl-custom-checkbox","cl-z-index-0"],["type","checkbox",1,"cl-custom-control-input",3,"checked","disabled","id","click"],[1,"cl-custom-control-label","cl-text-break",3,"for"],["class","cl-form-group cl-col-md-6",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"cl-form-group","cl-col-md-6"],[1,"cl-custom-control-label",3,"for"],["class","cl-form-group cl-col-md-6 cl-text-break",4,"ngFor","ngForOf"],[1,"cl-form-group","cl-col-md-6","cl-text-break"],["type","checkbox",1,"cl-custom-control-input",3,"checked","id","click"],["cfInput",""]],template:function(e,t){1&e&&(s.Xc(0,pk,5,4,"div",0),s.Xb(1,"form",1),s.jc("ngSubmit",(function(){return t.onSubmit()})),s.Xb(2,"div",2),s.Xc(3,hk,1,0,"div",3),s.Xb(4,"div",4),s.Xb(5,"label",5),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"input",6),s.jc("ngModelChange",(function(e){return t.reportName=e})),s.Wb(),s.Wb(),s.Xb(9,"div",7),s.Xb(10,"div",8),s.Xb(11,"div",9),s.Xb(12,"input",10),s.jc("click",(function(){return t.selectAll()})),s.Wb(),s.Xb(13,"label",11),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(16,"label",12),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Xb(19,"div",7),s.Xc(20,Ek,2,5,"div",13),s.Wb(),s.Xc(21,fk,3,3,"label",14),s.Xc(22,Ok,3,2,"div",15),s.Xc(23,vk,3,3,"label",14),s.Xc(24,Ik,2,1,"div",15),s.Xc(25,wk,3,3,"label",14),s.Xb(26,"div",16),s.Xb(27,"input",17),s.jc("change",(function(){return t.addRTL()})),s.Wb(),s.Xb(28,"label",18),s.Zc(29),s.oc(30,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(31,"div",19),s.Xb(32,"a",20),s.jc("click",(function(){return t.closeModal()}))("keyup.enter",(function(){return t.closeModal()})),s.Zc(33),s.oc(34,"translate"),s.Wb(),s.Xb(35,"button",21),s.Zc(36),s.oc(37,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.wc("ngIf",!1===t.hasCustomReportsFeature),s.Cb(1),s.wc("formGroup",t.customizeForm),s.Cb(2),s.wc("ngIf",!t.hasCustomReportsFeature),s.Cb(3),s.ad(s.pc(7,22,"REPORTS.SHARED.REPORT_NAME_LABEL")),s.Cb(2),s.xc("placeholder",t.placeholder),s.wc("readOnly",!t.hasCustomReportsFeature)("ngModel",t.reportName),s.Cb(4),s.wc("checked",t.allSelected)("disabled",!1),s.Cb(2),s.ad(s.pc(15,24,"GLOBAL.SELECT_ALL_LABEL")),s.Cb(3),s.ad(s.pc(18,26,"REPORTS.CUSTOMIZE.DISPLAY_CASE_1")),s.Cb(3),s.wc("ngForOf",t.options.allOptions),s.Cb(1),s.wc("ngIf","WEEKLY"!==t.reportType),s.Cb(1),s.wc("ngIf","WEEKLY"!==t.reportType),s.Cb(1),s.wc("ngIf","SUMMARY"==t.reportType),s.Cb(1),s.wc("ngIf","SUMMARY"==t.reportType),s.Cb(1),s.wc("ngIf","SUMMARY"!==t.reportType),s.Cb(2),s.wc("checked",t.checkIfChecked("RTL")),s.Cb(2),s.bd(" ",s.pc(30,28,"REPORTS.CUSTOMIZE.DISPLAY_CASE_4")," "),s.Cb(4),s.ad(s.pc(34,30,"GLOBAL.CLOSE_BTN")),s.Cb(2),s.wc("disabled",!t.hasCustomReportsFeature||t.inProgress||t.disableButton()),s.Cb(1),s.ad(s.pc(37,32,"GLOBAL.SAVE_LABEL")))},directives:[i.u,v.I,v.t,v.k,v.c,v.s,v.i,i.t,To.a,k.g,i.r],pipes:[g.e],encapsulation:2}),e})();var Rk=n("r5nx");const yk=["detailedHeader"],_k=["syncModal"],kk=["successModal"],Wk=["incompleteModal"],Xk=["syncBillableWarningModal"],Nk=["detailedRows"];function Dk(e,t){if(1&e){const e=s.Yb();s.Xb(0,"reports-filter",37),s.jc("onApply",(function(t){return s.Oc(e),s.nc(2).applyFilter(t)}))("emitClearFilters",(function(){return s.Oc(e),s.nc(2).defaultFilter()})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("hideMembers",e.hideMembers)("hideUserGroupMembers",e.hideUserGroupMembers)("description",e.description)("valuesData",e.filterValuesData)("note",e.note)("withoutNote",e.withoutNote)("withoutDescription",e.withoutDescription)("customFieldFilters",e.customFieldFilters)}}function Pk(e,t){if(1&e&&(s.Xb(0,"span",38),s.Zc(1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",null==e.audit?null:e.audit.numberOfSelected," ")}}const Mk=function(e){return{rotate180:e}};function Bk(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",39),s.jc("click",(function(){s.Oc(e);const t=s.nc(2);return t.showAddTime=!t.showAddTime})),s.Zc(1),s.oc(2,"translate"),s.Sb(3,"img",25),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.pc(2,2,"GLOBAL.ADD_TIME_FOR_OTHERS")," "),s.Cb(2),s.wc("ngClass",s.Bc(4,Mk,e.showAddTime))}}function Uk(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",40),s.jc("click",(function(){return s.Oc(e),s.nc(2).toggleQuckbooks()})),s.Sb(1,"img",41),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(1),s.wc("ngClass",s.Bc(1,Mk,"NOT_SENT"===e.quickbooksSelectType||"SENT"===e.quickbooksSelectType))}}function Gk(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",42),s.Xb(1,"audit",43),s.jc("onChange",(function(t){return s.Oc(e),s.nc(2).onAuditChange(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.wc("@fade",void 0),s.Cb(1),s.wc("auditFilters",e.audit)("isAdminOrOwner",e.isAdminOrOwner)}}function xk(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"add-time",44),s.jc("onAdded",(function(t){return s.Oc(e),s.nc(2).addNewEntries(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.wc("@fade",void 0),s.Cb(1),s.wc("isAdminOrOwner",e.isAdminOrOwner)("isTeamManager",e.isTeamManager)("customFields",e.customFields)("amountOptions",e.amountOptions)}}function Fk(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"quickbooks",46),s.jc("onSendToQuickbooks",(function(){return s.Oc(e),s.nc(3).quickbooksTimeEntriesSync()}))("onChange",(function(t){return s.Oc(e),s.nc(3).onQuickbookChange(t)})),s.Wb(),s.Ub()}if(2&e){const e=s.nc(3);s.Cb(1),s.wc("quickbooksSelectType",e.quickbooksSelectType)("timeEntries",e.timeEntries)("format",e.format)("errorResponse",e.errorResponse)("hasQuickbookPermission",e.hasQuickbookPermission)("hasLongTimeEntry",e.hasLongTimeEntry)}}const jk=function(e){return["/workspaces",e,"settings"]},Zk=function(){return{quickbooks:"true"}};function Vk(e,t){if(1&e&&(s.Xb(0,"div",47),s.Xb(1,"div",48),s.Xb(2,"div",49),s.Xb(3,"div",50),s.Xb(4,"div",51),s.Xb(5,"div",52),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"button",53),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc(3);s.Cb(6),s.ad(s.pc(7,4,"REPORTS.DETAILED_REPORT.QUICKBOOKS.RECONNECT_INFO")),s.Cb(2),s.wc("routerLink",s.Bc(8,jk,e.workspace.id))("queryParams",s.Ac(10,Zk)),s.Cb(1),s.bd(" ",s.pc(10,6,"REPORTS.DETAILED_REPORT.QUICKBOOKS.RECCONECT_BTN")," ")}}function Yk(e,t){if(1&e&&(s.Xb(0,"div",42),s.Xc(1,Fk,2,6,"ng-container",29),s.Xc(2,Vk,11,11,"div",45),s.Wb()),2&e){const e=s.nc(2);s.wc("@fade",void 0),s.Cb(1),s.wc("ngIf",e.isQuickBooksConnected&&!e.isQuickBooksTokenExpired),s.Cb(1),s.wc("ngIf",e.isQuickBooksConnected&&e.isQuickBooksTokenExpired)}}const Hk=function(e){return{"cl-disabled":e}};function $k(e,t){if(1&e){const e=s.Yb();s.Xb(0,"tr",58),s.Xb(1,"td",59),s.Xb(2,"custom-fields-values",60,61),s.jc("entryChanged",(function(t){return s.Oc(e),s.nc().$implicit.customFieldValues=t})),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.Lc(3),t=s.nc().$implicit,n=s.nc(2);s.wc("ngClass",s.Bc(9,Hk,n.editEntryDisabled(t))),s.Cb(1),s.Hb("cl-remove-padding-and-border",!e.customFieldValuesModified.length),s.Cb(1),s.wc("timeEntryId",t.id)("customFields",n.customFields)("isLocked",t.isLocked||n.userId!==t.user.id)("disableEdit",!!t.approvalRequestId)("projectId",null==t.project?null:t.project.id)("customFieldValues",t.customFieldValues)}}function Kk(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",54),s.Xb(2,"tr",55,56),s.jc("onDelete",(function(n){s.Oc(e);const i=t.index;return s.nc(2).removeEntry(n,i)}))("onDuplicate",(function(n){s.Oc(e);const i=t.index;return s.nc(2).pushEntry(n,i+1)}))("onEarnedChange",(function(){return s.Oc(e),s.nc(2).updateTotalEarned()}))("onSelectChange",(function(){return s.Oc(e),s.nc(2).calculateNumberOfSelected()})),s.Wb(),s.Xc(4,$k,4,11,"tr",57),s.Wb(),s.Ub()}if(2&e){const e=t.$implicit,n=s.nc(2);s.Cb(2),s.wc("onlyAdminsSeeBillableRates",n.workspace.onlyAdminsSeeBillableRates)("currency",n.workspace.currency)("totalInfo",n.totalInfo)("managedUsers",n.teamManagerUsers)("hasAddTimeForOthersFeature",n.hasAddTimeForOthersFeature)("isAdminOrOwner",n.isAdminOrOwner)("isTeamManager",n.isTeamManager)("canTeamManagerEditEntry",n.isManagerAllowedToEditEntry(e))("disableManualMode",n.disableManualMode)("timeEntry",e)("expandAll",n.expandAll)("format",n.format)("invoicingEnabled",n.workspace.invoicingEnabled)("activeBillableHours",n.workspace.activeBillableHours)("onlyAdminCanSeeAndChangeBillable",n.workspace.onlyAdminsCanChangeBillableStatus)("disableEdit",n.editEntryDisabled(e))("ngClass",s.Bc(22,Hk,n.editEntryDisabled(e)))("isRounding",n.isRounding)("amountOptions",n.amountOptions)("projectData",n.projectData)("isDesktop",n.isDesktop),s.Cb(2),s.wc("ngIf",null==n.customFields?null:n.customFields.length)}}function qk(e,t){if(1&e){const e=s.Yb();s.Xb(0,"pager",62),s.jc("pageChanged",(function(t){return s.Oc(e),s.nc(2).setPagination(t)}))("limitChanged",(function(t){return s.Oc(e),s.nc(2).setPagination(t)})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("page",e.pagination.page)("limit",e.pagination.pageSize)("total",e.entriesCount)}}function zk(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",12),s.Xb(1,"div",13),s.Xb(2,"div",14),s.Xb(3,"div",15),s.Sb(4,"switch-reports",16),s.Wb(),s.Xb(5,"div",17),s.Xb(6,"div",18),s.Xb(7,"div",19),s.Xb(8,"datepicker-range",20),s.jc("dateRangeOut",(function(t){return s.Oc(e),s.nc().updateDateRange(t)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(9,Dk,1,8,"reports-filter",21),s.Xb(10,"div",22),s.Xb(11,"a",23),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.showAudit=!t.showAudit})),s.Zc(12),s.oc(13,"translate"),s.Xc(14,Pk,2,1,"span",24),s.Sb(15,"img",25),s.Wb(),s.Vb(16),s.Xc(17,Bk,4,6,"a",26),s.Xc(18,Uk,2,3,"a",27),s.Ub(),s.Wb(),s.Xc(19,Gk,2,3,"div",28),s.Vb(20),s.Xc(21,xk,2,5,"div",29),s.Xc(22,Yk,3,3,"div",28),s.Ub(),s.Xb(23,"table-info",30),s.jc("shareReports",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(5);return t.openModal(n)}))("customizeReport",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(7);return t.openModal(n)}))("exportAsPdf",(function(){return s.Oc(e),s.nc().exportAsPdf()}))("exportAsCsv",(function(){return s.Oc(e),s.nc().exportAsCsv()}))("exportAsExcel",(function(){return s.Oc(e),s.nc().exportAsExcel()}))("onRoundingChange",(function(t){return s.Oc(e),s.nc().onRoundingChange(t)}))("onAmountOptionChange",(function(t){return s.Oc(e),s.nc().amountOptionChanged(t)})),s.Wb(),s.Xb(24,"div",31),s.Xb(25,"table",32),s.Xb(26,"thead"),s.Xb(27,"tr",33,34),s.jc("bulkEdit",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(11);return t.openModal(n)}))("bulkDelete",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(3);return t.openModal(n)}))("onMarkAs",(function(t){s.Oc(e);const n=s.nc(),i=s.Lc(13);return n.markAsInvoiced=t,n.openModal(i)}))("onSelectAllChange",(function(t){return s.Oc(e),s.nc().setAllChange(t)}))("onExpandAll",(function(t){return s.Oc(e),s.nc().expandAllRows(t)}))("onChange",(function(t){return s.Oc(e),s.nc().columnOrderChanged(t)})),s.Wb(),s.Wb(),s.Xb(29,"tbody"),s.Xc(30,Kk,5,24,"ng-container",35),s.Wb(),s.Wb(),s.Wb(),s.Xc(31,qk,1,3,"pager",36),s.Wb()}if(2&e){const e=s.nc();s.Cb(4),s.wc("page","DETAILED"),s.Cb(4),s.wc("timeEntriesDateRange",e.dateRange),s.Cb(1),s.wc("ngIf",e.filterValuesData),s.Cb(3),s.bd(" ",s.pc(13,37,"GLOBAL.TIME_AUDIT_TITLE")," "),s.Cb(2),s.wc("ngIf",null==e.audit?null:e.audit.numberOfSelected),s.Cb(1),s.wc("ngClass",s.Bc(39,Mk,e.showAudit)),s.Cb(2),s.wc("ngIf",e.isAdminOrOwner||e.isTeamManagerAllowedToEdit),s.Cb(1),s.wc("ngIf",e.isAdminOrOwner&&e.isQuickBooksConnected),s.Cb(1),s.wc("ngIf",e.showAudit),s.Cb(2),s.wc("ngIf",e.showAddTime&&(e.isAdminOrOwner||e.isTeamManagerAllowedToEdit)),s.Cb(1),s.wc("ngIf",e.isAdminOrOwner&&("NOT_SENT"===e.quickbooksSelectType||"SENT"===e.quickbooksSelectType)),s.Cb(1),s.wc("amountOptions",e.amountOptions)("totalNumberOfEntries",e.entriesCount)("isCostRateActive",e.workspace.isCostRateActive)("isRounding",e.isRounding)("totalInfo",e.totalInfo)("isAdminOrOwner",e.isAdminOrOwner)("canSeeRates",e.canSeeRates),s.Cb(2),s.Hb("cl-billable-not-active",!e.workspace.activeBillableHours)("cl-only-admin",e.workspace.onlyAdminsCanChangeBillableStatus&&!e.isAdminOrOwner),s.Cb(2),s.wc("invoicingEnabled",e.workspace.invoicingEnabled)("areAllCheckedEntriesInvoiced",e.areAllCheckedEntriesInvoiced)("numberOfEntries",null==e.timeEntries?null:e.timeEntries.length)("numberOfAvailableEntries",e.numberOfAvailableEntries)("numberOfSelected",e.numberOfSelected)("entriesOnOtherPages",e.entriesOnOtherPages)("isAdminOrOwner",e.isAdminOrOwner)("isDesktop",e.isDesktop)("amountOptions",e.amountOptions)("sortOrder",e.sortData.sortOrder)("sortColumn",e.sortData.sortColumn)("activeBillableHours",e.workspace.activeBillableHours)("onlyAdminCanSeeAndChangeBillable",e.workspace.onlyAdminsCanChangeBillableStatus),s.Cb(3),s.wc("ngForOf",e.timeEntries),s.Cb(1),s.wc("ngIf",e.showPagination)}}const Qk=function(e){return{count:e}};function Jk(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.qc(2,1,"REPORTS.DETAILED_REPORT.DELETE_MODAL_BODY_INFO_WITH_PARAM",s.Bc(4,Qk,e.numberOfTimeEntriesSelected))," ")}}function eW(e,t){1&e&&(s.Zc(0),s.oc(1,"translate")),2&e&&s.bd(" ",s.pc(1,1,"REPORTS.DETAILED_REPORT.DELETE_MODAL_BODY_INFO")," ")}function tW(e,t){if(1&e){const e=s.Yb();s.Xb(0,"delete-confirm-modal",63),s.jc("onDelete",(function(){s.Oc(e);const n=t.$implicit;return s.nc().deleteManyConfirmed(n)}))("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",64),s.Xc(4,Jk,3,6,"ng-container",65),s.Wb(),s.Xc(5,eW,2,3,"ng-template",null,66,s.Yc),s.Wb()}if(2&e){const e=s.Lc(6),t=s.nc();s.wc("title",s.pc(1,5,"GLOBAL.DELETE_BTN"))("inProgress",t.isDeleteInProgress)("btnText",s.pc(2,7,"GLOBAL.DELETE_BTN")),s.Cb(4),s.wc("ngIf",t.isAdminOrOwner||!t.bulkEditDataService.isSelectedAllGlobally)("ngIfElse",e)}}function nW(e,t){if(1&e){const e=s.Yb();s.Xb(0,"modal-header",67),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"share-report",68),s.jc("onShare",(function(n){s.Oc(e);const i=t.$implicit,c=s.nc(),a=s.Lc(9);return c.shareReport(n,i,a)}))("onClose",(function(){return t.$implicit.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,5,"REPORTS.SHARED.SHARE_BTN")),s.Cb(2),s.wc("inProgress",e.shareInProgress)("dateRangeLabel",e.getDateRangeValue())("dateRangeType",e.dateRangeType)("isAdminOrOwner",e.isAdminOrOwner)}}function iW(e,t){if(1&e){const e=s.Yb();s.Xb(0,"modal-header",67),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"customize-report",69),s.jc("onOpen",(function(){return s.Oc(e),s.nc().getCustomizationSettings()}))("onSave",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().saveExportSettings(n,i)}))("onClose",(function(){return t.$implicit.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,11,"REPORTS.DETAILED_REPORT.SETTINGS_TOOLTIP")),s.Cb(2),s.wc("inProgress",e.customizationInProgress)("reportType",e.TYPE)("canSeeRates",e.canSeeRates)("isAdminOrOwner",e.isAdminOrOwner)("currentSettings",e.currentSettings)("reportName",e.reportName)("customFields",e.customFields)("checkedCustomFields",e.currentCustomFieldSettings)("isCostRateActive",e.workspace.isCostRateActive)("options",e.exportOptions)}}function sW(e,t){if(1&e&&(s.Xb(0,"modal-header",67),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"div",70),s.Xb(3,"text-copy",71),s.jc("onClose",(function(){return t.$implicit.close()})),s.Xb(4,"small",72),s.Sb(5,"img",73),s.oc(6,"translate"),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(9,"div",74),s.Xb(10,"a",75),s.jc("keyup.space",(function(){return t.$implicit.close()}))("keyup.enter",(function(){return t.$implicit.close()}))("click",(function(){return t.$implicit.close()})),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.wc("title",s.pc(1,5,"GLOBAL.LINK_CREATED_TITLE")),s.Cb(3),s.wc("text",e.sharedLink),s.Cb(2),s.wc("ngbTooltip",s.pc(6,7,"REPORTS.SHARED.SHARE_LINK_BTN")),s.Cb(2),s.bd(" ",s.pc(8,9,"REPORTS.SHARED.CREATE_LINK_INFO")," "),s.Cb(4),s.ad(s.pc(12,11,"GLOBAL.CLOSE_BTN"))}}function cW(e,t){if(1&e){const e=s.Yb();s.Xb(0,"time-entry-bulk-edit",76),s.jc("onEdit",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().onEdit(n,i)}))("onUpdate",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return n.close(),i.navigateToUpgrade()}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.Wb()}if(2&e){const e=s.nc();s.wc("hideDates",!e.isAdminOrOwner&&e.disableManualMode)("timeEntries",e.timeEntriesSelected)("overrideEntiesLength",e.getBulkEditTitleCount())("enableEditUser",e.isAdminOrOwner)("entriesOwners",e.selectedEntriesOwners)("isRounding",e.isRounding)("hideWorkspacesInPicker",!0)("autofillWithSameData",!e.bulkEditDataService.isSelectedAllGlobally)("preventSendRequest",e.bulkEditDataService.isSelectedAllGlobally)("inProgress",e.inProgressEditGlobally)("customFields",e.customFields)}}function aW(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"REPORTS.DETAILED_REPORT.NEW_INVOICE_MODAL_INFO_1")," "))}function oW(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"REPORTS.DETAILED_REPORT.NEW_INVOICE_MODAL_INFO_2")," "))}function rW(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",77),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return i.invoiceMarkAs(i.markAsInvoiced),n.close()}))("close",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",78),s.Xc(4,aW,3,3,"ng-container",29),s.Xc(5,oW,3,3,"ng-container",29),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,e.markAsInvoiced?"REPORTS.DETAILED_REPORT.MARK_INVOICED_BTN":"REPORTS.DETAILED_REPORT.MARK_UNINVOICED_BTN"))("btnText",s.pc(2,6,e.markAsInvoiced?"REPORTS.DETAILED_REPORT.NEW_INVOICE_BTN":"REPORTS.DETAILED_REPORT.NEW_UNINVOICE_BTN")),s.Cb(4),s.wc("ngIf",e.markAsInvoiced),s.Cb(1),s.wc("ngIf",!e.markAsInvoiced)}}function lW(e,t){1&e&&(s.Xb(0,"div",79),s.Xb(1,"div",80),s.Sb(2,"img",81),s.Wb(),s.Xb(3,"div",82),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"p",83),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Xb(9,"div",74),s.Xb(10,"a",84),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(4),s.ad(s.pc(5,3,"GLOBAL.SUCCESS_MSG")),s.Cb(3),s.bd(" ",s.pc(8,5,"REPORTS.DETAILED_REPORT.QUICKBOOKS.ALL_SENT_SUCCESS_MSG")," "),s.Cb(4),s.ad(s.pc(12,7,"GLOBAL.CLOSE_BTN")))}const bW=function(e,t){return{count:e,length:t}},dW=function(){return{quickbooks:!0}};function uW(e,t){if(1&e&&(s.Xb(0,"div",85),s.Xb(1,"h1",86),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",87),s.jc("click",(function(){return t.$implicit.close()})),s.Xb(5,"span"),s.Sb(6,"img",88),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",89),s.Xb(8,"p",80),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Xb(11,"p",83),s.Zc(12),s.oc(13,"translate"),s.Xb(14,"a",90),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(15),s.oc(16,"lowercase"),s.oc(17,"translate"),s.Wb(),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Wb(),s.Xb(20,"div",74),s.Xb(21,"button",91),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(22),s.oc(23,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,9,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_INCOMPLETED_MSG")),s.Cb(7),s.bd(" ",s.qc(10,11,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_INCOMPLETED_INFO_1",s.Cc(24,bW,null==e.syncData?null:e.syncData.timeEntriesSent,e.sentEntriesCount))," "),s.Cb(3),s.bd(" ",s.pc(13,14,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_INCOMPLETED_INFO_2_PART_1"),""),s.Cb(2),s.wc("routerLink",s.Bc(27,jk,e.workspace.id))("fragment","integrations")("queryParams",s.Ac(29,dW)),s.Cb(1),s.ad(s.pc(16,16,s.pc(17,18,"GLOBAL.USERS_CUSTOMERS_SYNC_MSG"))),s.Cb(3),s.bd(" ",s.pc(19,20,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_INCOMPLETED_INFO_2_PART_2")," "),s.Cb(4),s.ad(s.pc(23,22,"GLOBAL.CLOSE_BTN"))}}function pW(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_ERROR_INFO_1")," "))}function hW(e,t){if(1&e){const e=s.Yb();s.Zc(0),s.oc(1,"translate"),s.Xb(2,"a",97),s.jc("click",(function(){return s.Oc(e),s.nc(2).closeAllModals()})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Zc(5),s.oc(6,"translate")}if(2&e){const e=s.nc(2);s.bd(" ",s.pc(1,4,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_ERROR_INFO_2_PART_1")," "),s.Cb(2),s.yc("routerLink","/workspaces/",e.workspace.id,"/settings"),s.Cb(1),s.ad(s.pc(4,6,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_ERROR_INFO_2_PART_2")),s.Cb(2),s.bd(" ",s.pc(6,8,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_ERROR_INFO_2_PART_3")," ")}}function mW(e,t){if(1&e&&(s.Xb(0,"div"),s.Zc(1),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.cd("",e.name,", ",e.email,"")}}function gW(e,t){if(1&e&&(s.Xb(0,"div",101),s.Xc(1,mW,2,2,"div",35),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",null==e.syncData?null:e.syncData.usersToSync)}}function EW(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",98),s.Xb(1,"p",83),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"strong"),s.Zc(5),s.Wb(),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"a",99),s.jc("click",(function(){s.Oc(e);const t=s.nc(2);return t.expandedUsers=!t.expandedUsers})),s.Zc(9),s.oc(10,"translate"),s.oc(11,"translate"),s.Wb(),s.Xc(12,gW,2,1,"div",100),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.bd(" ",s.pc(3,5,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_ERROR_INFO_3_PART_1"),""),s.Cb(3),s.ad(null==e.syncData||null==e.syncData.usersToSync?null:e.syncData.usersToSync.length),s.Cb(1),s.bd(" ",s.pc(7,7,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_ERROR_INFO_3_PART_2")," "),s.Cb(3),s.ad(e.expandedUsers?s.pc(10,9,"GLOBAL.HIDE_DETAILS_LABEL"):s.pc(11,11,"GLOBAL.SEE_DETAILS_LABEL")),s.Cb(3),s.wc("ngIf",e.expandedUsers)}}function fW(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.Ub()),2&e){const e=s.nc().$implicit;s.Cb(1),s.bd(" - ",e.parentCustomer.name,"")}}function SW(e,t){if(1&e&&(s.Xb(0,"div"),s.Zc(1),s.Xc(2,fW,2,1,"ng-container",29),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.bd(" ",e.name," "),s.Cb(1),s.wc("ngIf",e.parentCustomer)}}function CW(e,t){if(1&e&&(s.Xb(0,"div",101),s.Xc(1,SW,3,2,"div",35),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",null==e.syncData?null:e.syncData.customersToSync)}}function AW(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"p",83),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"strong"),s.Zc(5),s.Wb(),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"a",99),s.jc("click",(function(){s.Oc(e);const t=s.nc(2);return t.expandedCustomers=!t.expandedCustomers})),s.Zc(9),s.oc(10,"translate"),s.oc(11,"translate"),s.Wb(),s.Xc(12,CW,2,1,"div",100),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.bd(" ",s.pc(3,5,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_ERROR_INFO_4_PART_1"),""),s.Cb(3),s.ad(null==e.syncData||null==e.syncData.customersToSync?null:e.syncData.customersToSync.length),s.Cb(1),s.bd(" ",s.pc(7,7,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_ERROR_INFO_4_PART_2")," "),s.Cb(3),s.ad(e.expandedCustomers?s.pc(10,9,"GLOBAL.HIDE_DETAILS_LABEL"):s.pc(11,11,"GLOBAL.SEE_DETAILS_LABEL")),s.Cb(3),s.wc("ngIf",e.expandedCustomers)}}function OW(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"a",102),s.jc("click",(function(){return s.Oc(e),s.nc().$implicit.close()})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",103),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().syncUsers(t)})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Ub()}if(2&e){const e=s.nc(2);s.Cb(2),s.ad(s.pc(3,3,"GLOBAL.CLOSE_BTN")),s.Cb(2),s.wc("disabled",e.syncInProgress),s.Cb(1),s.bd(" ",s.pc(6,5,"REPORTS.DETAILED_REPORT.QUICKBOOKS.CREATE_MISSING_USR_BTN")," ")}}function vW(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",91),s.jc("click",(function(){return s.Oc(e),s.nc().$implicit.close()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.CONFIRM_OK_BTN")," "))}function TW(e,t){if(1&e&&(s.Xb(0,"div",85),s.Xb(1,"h1",86),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",87),s.jc("click",(function(){return t.$implicit.close()})),s.Xb(5,"span"),s.Sb(6,"img",88),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",92),s.Xb(8,"div",93),s.Xc(9,pW,3,3,"ng-container",65),s.Xc(10,hW,7,10,"ng-template",null,94,s.Yc),s.Wb(),s.Xc(12,EW,13,13,"div",95),s.Xc(13,AW,13,13,"div",29),s.Wb(),s.Xb(14,"div",74),s.Xc(15,OW,7,7,"ng-container",65),s.Xc(16,vW,3,3,"ng-template",null,96,s.Yc),s.Wb()),2&e){const e=s.Lc(11),t=s.Lc(17),n=s.nc();s.Cb(2),s.ad(s.pc(3,7,"REPORTS.DETAILED_REPORT.QUICKBOOKS.SYNC_ERROR_MSG")),s.Cb(7),s.wc("ngIf",(null==n.syncData||null==n.syncData.usersToSync?null:n.syncData.usersToSync.length)&&!(null!=n.syncData&&null!=n.syncData.customersToSync&&n.syncData.customersToSync.length))("ngIfElse",e),s.Cb(3),s.wc("ngIf",null==n.syncData||null==n.syncData.usersToSync?null:n.syncData.usersToSync.length),s.Cb(1),s.wc("ngIf",null==n.syncData||null==n.syncData.customersToSync?null:n.syncData.customersToSync.length),s.Cb(2),s.wc("ngIf",(null==n.syncData||null==n.syncData.usersToSync?null:n.syncData.usersToSync.length)&&!(null!=n.syncData&&null!=n.syncData.customersToSync&&n.syncData.customersToSync.length))("ngIfElse",t)}}function IW(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",85),s.Xb(1,"h1",86),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",87),s.jc("click",(function(){return t.$implicit.close()})),s.Xb(5,"span"),s.Sb(6,"img",88),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",92),s.Xb(8,"p",83),s.Zc(9),s.oc(10,"translate"),s.Xb(11,"strong"),s.Zc(12),s.Wb(),s.Zc(13),s.oc(14,"translate"),s.oc(15,"translate"),s.Wb(),s.Wb(),s.Xb(16,"div",74),s.Xb(17,"a",102),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Xb(20,"button",91),s.jc("click",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return n.close(),i.showMissingProjectBillableEntries()})),s.Zc(21),s.oc(22,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,7,"REPORTS.DETAILED_REPORT.BILLABLE_SYNC_TITLE")),s.Cb(7),s.bd(" ",s.pc(10,9,"REPORTS.DETAILED_REPORT.BILLABLE_SYNC_INFO_PART_1"),""),s.Cb(3),s.ad(e.missingProjectBillableEntries.length),s.Cb(1),s.cd(" ",s.pc(14,11,"REPORTS.DETAILED_REPORT.BILLABLE_SYNC_INFO_PART_2")," ",s.pc(15,13,"REPORTS.DETAILED_REPORT.BILLABLE_SYNC_INFO_PART_3")," "),s.Cb(5),s.ad(s.pc(19,15,"GLOBAL.CANCEL_BTN")),s.Cb(3),s.bd(" ",s.pc(22,17,"REPORTS.DETAILED_REPORT.SHOW_INCOMPLETE_BTN")," ")}}let wW=(()=>{class e extends o_{constructor(e,t,n,i,s,c,a,o,r,l,b,d,u,p,h,m,g,E,f,S,C,A,O,v){super(e,t,n,i,s,c,a,o,r,b,d,u,p,h,g,E,f,A,O,v),this.tagService=l,this.bulkEditDataService=m,this.invoiceService=S,this.integrationService=C,this.translate=A,this.translationStore=O,this.analyticsService=v,this.TYPE=Fy.a.DETAILED,this.exportOptions={allOptions:[new b_(d_.a.PROJECT,this.translate.instant("GLOBAL.PROJECT_LABEL")),new b_(d_.a.CLIENT,this.translate.instant("GLOBAL.CLIENT_LABEL")),new b_(d_.a.TASK,this.translate.instant("GLOBAL.TASK_LABEL")),new b_(d_.a.DESCRIPTION,this.translate.instant("GLOBAL.DESCRIPTION_LABEL")),new b_(d_.a.USER,this.translate.instant("GLOBAL.USER_LABEL")),new b_(d_.a.TAGS,this.translate.instant("GLOBAL.TAGS_LABEL")),new b_(d_.a.START_DATE,this.translate.instant("REPORTS.DETAILED_REPORT.START_DATE_LABEL")),new b_(d_.a.START_TIME,this.translate.instant("GLOBAL.FORM_LABEL_START_TIME")),new b_(d_.a.END_TIME,this.translate.instant("REPORTS.DETAILED_REPORT.END_TIME_LABEL")),new b_(d_.a.DURATION,this.translate.instant("REPORTS.DETAILED_REPORT.DURATION_HOURS_LABEL"))],csvXlsxOptions:[new b_(d_.a.EMAIL,this.translate.instant("GLOBAL.EMAIL_LABEL")),new b_(d_.a.BILLABLE,this.translate.instant("GLOBAL.BILLABLE_LABEL")),new b_(d_.a.END_DATE,this.translate.instant("REPORTS.DETAILED_REPORT.END_DATE_LABEL")),new b_(d_.a.DECIMAL_DURATION,this.translate.instant("REPORTS.DETAILED_REPORT.DURATION_DECIMAL_LABEL")),new b_(d_.a.GROUP,this.translate.instant("GLOBAL.GROUP_LABEL"))],pdfOptions:[]}}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace(),super.ngOnInit(),this.userId=this.authService.getUser().id,this.tagService.clearTagsSubject(),this.tagService.getAllTags(Rn.a.ACTIVE),this.showAudit=this.audit.isDirty(),this.setExportOptions(),this.checkQuickBooks()}setExportOptions(){const e=!this.workspace.hasFeature(is.a.CUSTOM_REPORTING)||!this.workspace.isCostRateActive;let t="";e&&(t=this.translate.instant("REPORTS.DETAILED_REPORT.UPGRADE_TOOLTIP")),this.workspace.hasFeature(is.a.CUSTOM_REPORTING)&&!this.workspace.isCostRateActive&&(t=this.translate.instant("REPORTS.DETAILED_REPORT.ENABLE_COST_RATE_IN_SETTINGS_TOOLTIP")),this.workspace.hasFeature(is.a.INVOICING)&&this.workspace.invoicingEnabled&&(this.exportOptions.csvXlsxOptions.push(new b_(d_.a.INVOICED,this.translate.instant("GLOBAL.INVOICED_LABEL"))),this.exportOptions.csvXlsxOptions.push(new b_(d_.a.INVOICE_ID,this.translate.instant("REPORTS.DETAILED_REPORT.NEW_INVOICE_BTN")+" ID"))),this.exportOptions.allOptions.find(e=>e.value===d_.a.CLIENT).label=Object(u_.a)(this.workspaceService.generateClientLabel(this.workspace.getProjectGroupingLabel())),this.canSeeRates&&this.activeBillable&&(!this.onlyAdminCanSeeAndChangeBillable||this.isAdminOrOwner)&&(this.exportOptions.csvXlsxOptions.push(new b_(d_.a.BILLABLE_RATE,this.translate.instant("REPORTS.DETAILED_REPORT.BILLABLE_AMOUNT_LABEL"))),this.exportOptions.csvXlsxOptions.push(new b_(d_.a.COST_RATE,this.translate.instant("GLOBAL.COST_RATE_LABEL"),e,t)),this.exportOptions.allOptions.push(new b_(d_.a.BILLABLE_AMOUNT,this.translate.instant("REPORTS.DETAILED_REPORT.BILLABLE_AMOUNT_LABEL"))),this.exportOptions.allOptions.push(new b_(d_.a.COST_AMOUNT,this.translate.instant("REPORTS.DETAILED_REPORT.COST_AMOUNT_LABEL"),e,t)),this.exportOptions.allOptions.push(new b_(d_.a.PROFIT,this.translate.instant("REPORTS.DETAILED_REPORT.PROFIT_AMOUNT_LABEL"),e,t))),(!this.activeBillable||this.activeBillable&&this.onlyAdminCanSeeAndChangeBillable&&!this.isAdminOrOwner)&&(this.exportOptions.csvXlsxOptions=this.exportOptions.csvXlsxOptions.filter(e=>e.value!=d_.a.BILLABLE),this.exportOptions.csvXlsxOptions=this.exportOptions.csvXlsxOptions.filter(e=>e.value!=d_.a.BILLABLE_RATE),this.exportOptions.csvXlsxOptions=this.exportOptions.csvXlsxOptions.filter(e=>e.value!=d_.a.COST_RATE),this.exportOptions.allOptions=this.exportOptions.allOptions.filter(e=>e.value!=d_.a.BILLABLE_AMOUNT),this.exportOptions.allOptions=this.exportOptions.allOptions.filter(e=>e.value!=d_.a.COST_AMOUNT),this.exportOptions.allOptions=this.exportOptions.allOptions.filter(e=>e.value!=d_.a.PROFIT));const n=!this.workspace.hasFeature(is.a.CUSTOM_REPORTING)||!this.workspace.timeApprovalEnabled;this.exportOptions.csvXlsxOptions.push(new b_(d_.a.APPROVAL,this.translate.instant("REPORTS.MODELS.APPROVAL_LABEL"),n)),this.exportOptions.allOptions=this.exportOptions.allOptions.filter(e=>!e.disabled),this.exportOptions.pdfOptions=this.exportOptions.pdfOptions.filter(e=>!e.disabled),this.exportOptions.csvXlsxOptions=this.exportOptions.csvXlsxOptions.filter(e=>!e.disabled)}get timeEntriesSelected(){return this.timeEntries.filter(e=>e.bulkEdit)}get numberOfTimeEntriesSelected(){return this.bulkEditDataService.isSelectedAllGlobally?this.timeEntriesSelected.length+this.entriesOnOtherPages:this.timeEntriesSelected.length}get selectedEntriesOwners(){return[...new Set(this.timeEntriesSelected.map(e=>e.user.id))]}get disableManualMode(){return this.workspace.disableManualMode}checkQuickBooks(){this.isAdminOrOwner&&this.workspace.hasFeature(is.a.QUICKBOOKS_INTEGRATION)&&this.integrationService.isQuickbooksConnected(this.workspace.id).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isQuickBooksConnected=e.connectionExist,e.connectionExist?this.integrationService.isTokenValid(this.workspace.id).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isQuickBooksTokenExpired=!e.tokenValid,this.cd.markForCheck()}):this.cd.markForCheck()})}getBulkEditTitleCount(){return this.isAdminOrOwner||!this.bulkEditDataService.isSelectedAllGlobally?this.numberOfTimeEntriesSelected:this.translate.instant("REPORTS.DETAILED_REPORT.BULK_TITLE_COUNT")}onAuditChange(e){this.audit=e,this.navigate()}onQuickbookChange(e){this.quickbooksSelectType=e,this.navigate()}toggleQuckbooks(){this.onQuickbookChange("ALL"!==this.quickbooksSelectType&&this.quickbooksSelectType?"ALL":"NOT_SENT")}quickbooksTimeEntriesSync(){if(this.sentEntriesCount=0,this.timeEntriesSyncInProgress)return;this.timeEntriesSyncInProgress=!0,this.loader.show("REPORTS.DETAILED_REPORT.DEFAULT_LOADER_INFO");const e=this.timeEntries.map(e=>e.id);this.reportService.quickbooksEntriesSync(e,!!this.isRounding).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{var n,i;this.syncData=t,this.sentEntriesCount=e.length;const s=!!(null===(n=null==t?void 0:t.usersToSync)||void 0===n?void 0:n.length)||!!(null===(i=null==t?void 0:t.customersToSync)||void 0===i?void 0:i.length);this.openModal(s?this.syncModal:(null==t?void 0:t.timeEntriesSent)===this.sentEntriesCount?this.successModal:this.incompleteModal),this.loader.hide(),this.getReports(),this.timeEntriesSyncInProgress=!1},e=>{var t,n;(null===(n=null===(t=e.error)||void 0===t?void 0:t.payload)||void 0===n?void 0:n.length)&&(this.missingProjectBillableEntries=e.error.payload.map(e=>new Sa.a(e)),this.openModal(this.syncBillableWarningModal)),this.timeEntriesSyncInProgress=!1,this.loader.hide()})}syncUsers(e){this.syncUserInProgress=!0,this.loader.show("REPORTS.DETAILED_REPORT.CREATE_MISSING_LOADER_INFO");const t=this.syncData.usersToSync.map(e=>e.id);this.integrationService.doUsersSync(this.workspace.id,t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.syncData=null,this.syncUserInProgress=!1,e.close(),this.loader.hide()},()=>{this.syncUserInProgress=!1,this.loader.hide()})}closeAllModals(){this.modalService.dismissAll()}onEdit(e,t){e?this.bulkEditGlobally(e,t):this.getReports()}getReports(e){this.loader.show("GLOBAL.LOADER_LOADING"),this.totalOptions=(null==e?void 0:e.totalsOptions)?e.totalsOptions:i_.CALCULATE;const t=this.createReportQuery(),n=this.bulkEditDataService.isSelectedAllGlobally;this.reportService.detailedResponse.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(({totals:t,timeentries:i})=>{if(this.errorResponse=!1,this.totalInfo=this.totalOptions===i_.CALCULATE?t:this.totalInfo,!t.totalAmounts&&this.amountOptions&&(this.totalInfo.totalAmounts=this.amountOptions.length?[new p_.a(this.amountOptions[0],t.totalAmount)]:[]),this.entriesOnOtherPages=this.totalInfo.entriesCount-i.length,this.entriesCount=this.totalInfo.entriesCount,this.showPagination=this.entriesCount>=In.j||this.entriesCount>=this.pagination.pageSize,i.forEach(e=>e.setAmounts(this.amountOptions)),this.timeEntries=i,this.calculateLongEntries(),this.calculateNumberOfSelected(),0===i.length&&1!==this.pagination.page)return this.pagination.page=1,void this.getReports();n&&e&&e.keepSelectedAllGlobally&&(this.cd.detectChanges(),this.setAllChange(!0),setTimeout(()=>{this.detailedHeader.selectAllGlobally()})),this.loader.hide()},()=>{this.errorResponse=!0,this.cd.markForCheck(),this.loader.hide()}),this.reportService.getDetailedReport(t)}getCustomFields(){this.customFieldService.get().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.customFields=e,this.generateCustomFieldFilters(),this.cd.detectChanges()})}generateCustomFieldFilters(){if(!this.customFields)return;const e=[];this.customFields.forEach(t=>{const n=Jy(t);n&&(n.setValuesFromParams(this.customFieldParams),e.push(n))}),this.customFieldFilters=e}expandAllRows(e){this.expandAll=e,this.cd.detectChanges()}addNewEntries(e){this.timeEntries=[...e,...this.timeEntries],this.updateTableInfoForAddedEntries(e),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"Add",section:"Reports",section2:"Detailed",section3:"Add time for others"}))}updateTableInfoForAddedEntries(e){const t=new DA.a;e.forEach(e=>{t.add(e.timeInterval.duration)});const n=e[0].billable;this.totalInfo.editDuration(t.asString(),n,!0),this.updateTotalEarned()}columnOrderChanged(e){this.sortData=e,this.navigate(),this.uiSettingsService.setSettings(xn.b.DETAILED_SORT,this.sortData)}removeEntry(e,t){this.timeEntries.splice(t,1),this.calculateNumberOfSelected(),this.updateTotalEarned(),this.totalInfo.editDuration(e.timeInterval.duration,e.billable,!1)}updateTotalEarned(){this.totalInfo.updatetotalAmountOnCurrentPage(this.timeEntries),this.calculateLongEntries()}pushEntry(e,t){this.timeEntries.splice(t,0,e),this.updateTableInfoForAddedEntries([e])}showMissingProjectBillableEntries(){const e=Object.assign({},this.filterValuesData);e.projects.reset(),e.projects.updateSingleMap("projects","without",!0,"Without project"),e.statuses.reset(),e.statuses.updateSingleMap("billing","BILLABLE",!0,"Billable"),this.filterValuesData=e,this.setParamsToUrl(),this.navigate()}editEntryDisabled(e){return!!e.approvalRequestId||!this.isAdminOrOwner&&(!!e.isLocked||this.userId!==e.user.id&&!this.isManagerAllowedToEditEntry(e))}isManagerAllowedToEditEntry(e){return this.isTeamManagerAllowedToEdit&&this.teamManagerUsers.some(t=>t.id===e.user.id)}setAllChange(e){this.detailedRows.forEach(t=>{t.setIsSelected(e)}),this.calculateNumberOfSelected()}calculateNumberOfSelected(){if(!this.timeEntries)return this.numberOfSelected=0,void(this.numberOfAvailableEntries=0);const e=this.timeEntries.filter(e=>e.bulkEdit).length;this.numberOfSelected=e,this.cd.detectChanges(),this.numberOfAvailableEntries=this.detailedRows.filter(e=>!e.disableEdit).length,this.workspace.invoicingEnabled&&(this.areAllCheckedEntriesInvoiced=this.timeEntries.filter(e=>e.bulkEdit).every(e=>e.hasInvoice))}invoiceMarkAs(e){const t=this.timeEntriesSelected.map(e=>e.id),n=this.bulkEditDataService.isSelectedAllGlobally;if(this.loader.showBar(),!n)return void this.bulkEntriesInvoiceStatus(t,e);const i=this.createReportQuery();this.reportService.getEntryIds(i).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(n=>{this.bulkEntriesInvoiceStatus([...t,...n],e)},()=>{this.loader.hide()})}bulkEntriesInvoiceStatus(e,t){const n=[...new Set(e)];this.invoiceService.bulkEntriesInvoiceStatus(n,t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.getReports(),this.detailedHeader.onBulkComplete(),this.loader.hide()},()=>this.loader.hide())}deleteManyConfirmed(e){this.isDeleteInProgress=!0;const t=this.timeEntriesSelected.map(e=>e.id);if(!this.bulkEditDataService.isSelectedAllGlobally)return void this.deleteTimeEntryMany(e,t);const n=this.createReportQuery();this.reportService.getEntryIds(n).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(n=>{this.deleteTimeEntryMany(e,[...t,...n])},()=>this.isDeleteInProgress=!1)}deleteTimeEntryMany(e,t){this.trackerService.deleteTimeEntryMany(t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.isDeleteInProgress=!1,e.close(),this.getReports(),this.detailedHeader.onBulkComplete()},()=>{this.isDeleteInProgress=!1})}bulkEditGlobally({ids:e,changeFields:t,timeEntry:n,customFieldValues:i},s){this.inProgressEditGlobally=!0;const c=this.createReportQuery();this.reportService.getEntryIds(c).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(c=>{const a=[...e,...c],o=[...new Set(a)];this.bulkEditMany(s,o,t,n,i)},()=>this.inProgressEditGlobally=!1)}bulkEditMany(e,t,n,i,s){this.trackerService.updateGroup(t,n,i,s).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.inProgressEditGlobally=!1,e.close(),this.getReports(),this.detailedHeader.onBulkComplete()},()=>this.inProgressEditGlobally=!1)}navigateToUpgrade(){this.router.navigate(["/upgrade"])}calculateLongEntries(){this.hasLongTimeEntry=this.timeEntries.some(e=>!!e.timeInterval.duration&&ke.duration(e.timeInterval.duration).asMinutes()>1435)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(re.a),s.Rb(s.h),s.Rb(xn.a),s.Rb(k.d),s.Rb(Uy.a),s.Rb(k.a),s.Rb(By.a),s.Rb(Gn.a),s.Rb(vn.a),s.Rb(Hn.a),s.Rb(WA.a),s.Rb(w.q),s.Rb(bn.a),s.Rb(Gy.a),s.Rb(l_.a),s.Rb(UA.a),s.Rb(a_.a),s.Rb(Ic.a),s.Rb(ti),s.Rb(ut),s.Rb(g.f),s.Rb(Ra.a),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["detailed-reports"]],viewQuery:function(e,t){var n;1&e&&(s.gd(yk,!0),s.gd(_k,!0),s.gd(kk,!0),s.gd(Wk,!0),s.gd(Xk,!0),s.gd(Nk,!0)),2&e&&(s.Kc(n=s.kc())&&(t.detailedHeader=n.first),s.Kc(n=s.kc())&&(t.syncModal=n.first),s.Kc(n=s.kc())&&(t.successModal=n.first),s.Kc(n=s.kc())&&(t.incompleteModal=n.first),s.Kc(n=s.kc())&&(t.syncBillableWarningModal=n.first),s.Kc(n=s.kc())&&(t.detailedRows=n))},features:[s.zb],decls:22,vars:1,consts:[[1,"cl-page-wrapper"],["class","cl-container-fluid",4,"ngIf"],["delete",""],["shareModal",""],["customizeModal",""],["linkCreatedModal",""],["editModal",""],["invoiceBulkModal",""],["successModal",""],["incompleteModal",""],["syncModal",""],["syncBillableWarningModal",""],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center","cl-justify-content-between"],[1,"cl-col-auto","cl-mb-3","cl-mb-md-0","cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-justify-content-md-start"],[1,"cl-btn-group",3,"page"],[1,"cl-col-auto"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-sm-end"],[1,"cl-page-header-action","cl-w-100","cl-w-md-auto"],[3,"timeEntriesDateRange","dateRangeOut"],["class","cl-d-block",3,"hideMembers","hideUserGroupMembers","description","valuesData","note","withoutNote","withoutDescription","customFieldFilters","onApply","emitClearFilters",4,"ngIf"],[1,"cl-mb-3","cl-d-flex","cl-justify-content-between","cl-justify-content-md-start"],["data-cy","audit",1,"cl-btn","cl-btn-outline-light","cl-relative",3,"click"],["class","cl-badge cl-badge-filter",4,"ngIf"],["src","assets/images/ui-icons/chevron-down.svg",1,"cl-transition1","cl-ml-2","cl-mr-1",3,"ngClass"],["class","cl-btn cl-btn-outline-light cl-ml-2","data-cy","add-time-for-others",3,"click",4,"ngIf"],["class","cl-btn cl-btn-outline-light cl-ml-2 cl-quickbooks-logo",3,"click",4,"ngIf"],["class","cl-collapse",4,"ngIf"],[4,"ngIf"],[1,"cl-card","cl-border-bottom-0","cl-mb-0",3,"amountOptions","totalNumberOfEntries","isCostRateActive","isRounding","totalInfo","isAdminOrOwner","canSeeRates","shareReports","customizeReport","exportAsPdf","exportAsCsv","exportAsExcel","onRoundingChange","onAmountOptionChange"],[1,"cl-page-component-wrapper"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-responsive","cl-text-gray-6","cl-detailed-reports-table"],["detailed-header","",3,"invoicingEnabled","areAllCheckedEntriesInvoiced","numberOfEntries","numberOfAvailableEntries","numberOfSelected","entriesOnOtherPages","isAdminOrOwner","isDesktop","amountOptions","sortOrder","sortColumn","activeBillableHours","onlyAdminCanSeeAndChangeBillable","bulkEdit","bulkDelete","onMarkAs","onSelectAllChange","onExpandAll","onChange"],["detailedHeader",""],[4,"ngFor","ngForOf"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],[1,"cl-d-block",3,"hideMembers","hideUserGroupMembers","description","valuesData","note","withoutNote","withoutDescription","customFieldFilters","onApply","emitClearFilters"],[1,"cl-badge","cl-badge-filter"],["data-cy","add-time-for-others",1,"cl-btn","cl-btn-outline-light","cl-ml-2",3,"click"],[1,"cl-btn","cl-btn-outline-light","cl-ml-2","cl-quickbooks-logo",3,"click"],["src","assets/images/ui-icons/chevron-down.svg",1,"cl-transition1",3,"ngClass"],[1,"cl-collapse"],[1,"cl-card","cl-border-bottom",3,"auditFilters","isAdminOrOwner","onChange"],[1,"cl-card","cl-border-bottom",3,"isAdminOrOwner","isTeamManager","customFields","amountOptions","onAdded"],["class","cl-card cl-border-bottom",4,"ngIf"],[1,"cl-card","cl-border-bottom",3,"quickbooksSelectType","timeEntries","format","errorResponse","hasQuickbookPermission","hasLongTimeEntry","onSendToQuickbooks","onChange"],[1,"cl-card","cl-border-bottom"],[1,"cl-row","cl-no-gutters","cl-w-100"],[1,"cl-col-lg-custom-auto"],[1,"cl-report-entry-actions","cl-border-bottom-0","cl-d-flex","cl-py-2"],[1,"cl-component-divided-left","cl-justify-content-start"],[1,"cl-mr-3"],["fragment","integrations",1,"cl-btn","cl-quickbooks-btn-green",3,"routerLink","queryParams"],[1,"cl-row-hover-shadow"],["detailed-row","",3,"onlyAdminsSeeBillableRates","currency","totalInfo","managedUsers","hasAddTimeForOthersFeature","isAdminOrOwner","isTeamManager","canTeamManagerEditEntry","disableManualMode","timeEntry","expandAll","format","invoicingEnabled","activeBillableHours","onlyAdminCanSeeAndChangeBillable","disableEdit","ngClass","isRounding","amountOptions","projectData","isDesktop","onDelete","onDuplicate","onEarnedChange","onSelectChange"],["detailedRows",""],[3,"ngClass",4,"ngIf"],[3,"ngClass"],["colspan","8",1,"cl-py-0","cl-border-top-0","cl-detailed-reports-custom-fields-row"],[3,"timeEntryId","customFields","isLocked","disableEdit","projectId","customFieldValues","entryChanged"],["ref",""],[3,"page","limit","total","pageChanged","limitChanged"],[3,"title","inProgress","btnText","onDelete","onClose"],[1,"cl-h2","cl-cut-text-wrap"],[4,"ngIf","ngIfElse"],["unknownNumberTemplate",""],[3,"title","onClose"],[3,"inProgress","dateRangeLabel","dateRangeType","isAdminOrOwner","onShare","onClose"],[3,"inProgress","reportType","canSeeRates","isAdminOrOwner","currentSettings","reportName","customFields","checkedCustomFields","isCostRateActive","options","onOpen","onSave","onClose"],[1,"cl-modal-body"],[3,"text","onClose"],[1,"form-text","text-gray-9"],["src","assets/images/ui-icons/info-9.svg","placement","top",1,"cl-mr-2",3,"ngbTooltip"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"keyup.space","keyup.enter","click"],[3,"hideDates","timeEntries","overrideEntiesLength","enableEditUser","entriesOwners","isRounding","hideWorkspacesInPicker","autofillWithSameData","preventSendRequest","inProgress","customFields","onEdit","onUpdate","close"],[3,"title","btnText","confirmed","close"],[1,"cl-text-muted","cl-cut-text-wrap"],[1,"cl-modal-body","cl-text-center","cl-py-4"],[1,"cl-mb-3"],["src","assets/images/illustrations/success.svg",1,"cl-img-fluid"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-mb-0"],["ngbAutofocus","",1,"cl-color-blue",3,"click"],[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body","cl-py-3"],[3,"routerLink","fragment","queryParams","click"],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-modal-body","cl-py-4"],[1,"cl-alert","cl-d-block","cl-alert-warning","cl-mb-3"],["warningSyncTemplate",""],["class","cl-mb-2",4,"ngIf"],["okBtnTemplate",""],["fragment","integrations",3,"routerLink","click"],[1,"cl-mb-2"],[1,"cl-mb-1","cl-d-inline-block",3,"click"],["class","cl-scroll-area cl-ml-2","style","max-height: 100px; overflow-y: auto;",4,"ngIf"],[1,"cl-scroll-area","cl-ml-2",2,"max-height","100px","overflow-y","auto"],[1,"cl-color-blue",3,"click"],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xc(1,zk,32,41,"div",1),s.Wb(),s.Xc(2,tW,7,9,"ng-template",null,2,s.Yc),s.Xc(4,nW,3,7,"ng-template",null,3,s.Yc),s.Xc(6,iW,3,13,"ng-template",null,4,s.Yc),s.Xc(8,sW,13,13,"ng-template",null,5,s.Yc),s.Xc(10,cW,1,11,"ng-template",null,6,s.Yc),s.Xc(12,rW,6,8,"ng-template",null,7,s.Yc),s.Xc(14,lW,13,9,"ng-template",null,8,s.Yc),s.Xc(16,uW,24,30,"ng-template",null,9,s.Yc),s.Xc(18,TW,18,9,"ng-template",null,10,s.Yc),s.Xc(20,IW,23,19,"ng-template",null,11,s.Yc)),2&e&&(s.Cb(1),s.wc("ngIf",t.workspace))},directives:[i.u,f_,ws.a,i.r,S_.a,t_.a,i.t,C_.a,X_,H_,sk,k.e,ck.a,YO.a,Pi.a,Xd.a,Wd.a,ak.a,Lk,Rk.a,w.bb,$T,Si.a,k.g],pipes:[g.e,i.q],encapsulation:2,data:{animation:[Object(r_.m)("fade",[Object(r_.l)(":leave",[Object(r_.e)("140ms",Object(r_.k)({opacity:0}))]),Object(r_.l)(":enter",[Object(r_.k)({opacity:0}),Object(r_.e)("200ms",Object(r_.k)({opacity:1}))])])]}}),e})();var LW=n("6gTr"),RW=n("t2hA"),yW=n("EBvn");function _W(e,t){if(1&e){const e=s.Yb();s.Xb(0,"reports-filter",28),s.jc("onApply",(function(t){return s.Oc(e),s.nc(2).applyFilter(t)}))("activeFilterChanged",(function(t){return s.Oc(e),s.nc(2).activeFilterChanged(t.standard)}))("emitClearFilters",(function(){return s.Oc(e),s.nc(2).defaultFilter()})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("hideMembers",e.hideMembers)("hideUserGroupMembers",e.hideUserGroupMembers)("description",e.description)("valuesData",e.filterValuesData)("description",e.description)("withoutDescription",e.withoutDescription)("customFieldFilters",e.customFieldFilters)}}const kW=function(){return[]};function WW(e,t){if(1&e&&s.Sb(0,"bar-chart",29),2&e){const e=s.nc(2);s.wc("barChartLabels",e.chartData.dates)("barChartAllLabels",e.chartData.barChartAllLabels)("projectCountByDate",s.Ac(14,kW))("canSeeRates",e.canSeeRates)("isBillabilityType",e.isBillabilityType)("currency",e.workspace.hourlyRate.currency)("format",e.format)("chartDataDurationUnit","seconds")("tooltipConfig",e.tooltipConfig)("billableTimes",e.chartData.durationLabel)("barChartColors",e.chartData.colors)("barChartData",e.chartData.chartData)("barChartEarnings",e.chartData.earnings)("totalDurationByDate",e.chartData.totalDurationByDate)}}function XW(e,t){if(1&e&&s.Sb(0,"summary-group",30),2&e){const e=t.$implicit,n=s.nc(2);s.wc("currency",null==n.workspace?null:n.workspace.hourlyRate.currency)("format",n.format)("hideAmount",n.hideAmount)("showEstimate",n.showEstimate&&n.hideEstimateColumn)("filterGroups",n.summaryFilterGroupsClone)("isExpanded",n.isExpanded)("userFormat",n.userFormat)("activeBillableHours",n.workspace.activeBillableHours)("onlyAdminCanSeeAndChangeBillable",n.workspace.onlyAdminsCanChangeBillableStatus)("enableLinks",!0)("dateRange",n.dateRange)("enabledStandardFilters",n.enabledStandardFilters)("group",e)("amountOptions",n.amountsForTable)("reduceTable",n.reduceTable)}}function NW(e,t){if(1&e&&s.Sb(0,"doughnut-chart",31),2&e){const e=s.nc(2);s.wc("doughnutChart",e.doughnutChart)("doughnutChartColors",e.doughnutChartColors)("doughnutChartData",e.doughnutChartData)("totalTime",null==e.totalInfo?null:e.totalInfo.totalTime)("doughnutChartLabels",e.doughnutChartLabels)("format",e.format)("canSeeRates",e.canSeeRates)("isBillabilityType",!1)("tooltipToLeft",!0)}}function DW(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",5),s.Xb(1,"div",6),s.Xb(2,"div",7),s.Xb(3,"div",8),s.Sb(4,"switch-reports",9),s.Wb(),s.Xb(5,"div",10),s.Xb(6,"div",11),s.Xb(7,"div",12),s.Xb(8,"datepicker-range",13),s.jc("dateRangeOut",(function(t){return s.Oc(e),s.nc().updateDateRange(t)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(9,_W,1,7,"reports-filter",14),s.Xb(10,"table-info",15),s.jc("shareReports",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(5);return t.openModal(n)}))("customizeReport",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(3);return t.openModal(n)}))("exportAsPdf",(function(){return s.Oc(e),s.nc().exportAsPdf()}))("exportAsCsv",(function(){return s.Oc(e),s.nc().exportAsCsv()}))("exportAsExcel",(function(){return s.Oc(e),s.nc().exportAsExcel()}))("onRoundingChange",(function(t){return s.Oc(e),s.nc().onRoundingChange(t)}))("onAmountOptionChange",(function(t){return s.Oc(e),s.nc().amountOptionChanged(t)}))("reduceTableChange",(function(t){return s.Oc(e),s.nc().reduceTableChange(t)})),s.Wb(),s.Xb(11,"div",16),s.Xb(12,"div",17),s.Xb(13,"div",18),s.Xc(14,WW,1,15,"bar-chart",19),s.Wb(),s.Wb(),s.Wb(),s.Xb(15,"div",20),s.Xb(16,"summary-group-header",21),s.jc("onGroupByChanged",(function(t){return s.Oc(e),s.nc().groupByChanged(t)}))("onShowEstimateChanged",(function(t){return s.Oc(e),s.nc().showEstimateChanged(t)}))("onHideEstimateChanged",(function(t){return s.Oc(e),s.nc().hideEstimate(t)})),s.Wb(),s.Xb(17,"div",22),s.Xb(18,"div",23),s.Xb(19,"summary-group-title",24),s.jc("onChange",(function(t){return s.Oc(e),s.nc().columnOrderChanged(t)}))("onExpand",(function(t){return s.Oc(e),s.nc().isExpanded=t})),s.Wb(),s.Xc(20,XW,1,15,"summary-group",25),s.Wb(),s.Xb(21,"div",26),s.Xb(22,"div",18),s.Xc(23,NW,1,9,"doughnut-chart",27),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(4),s.wc("page","SUMMARY"),s.Cb(4),s.wc("timeEntriesDateRange",e.dateRange),s.Cb(1),s.wc("ngIf",e.filterValuesData),s.Cb(1),s.wc("amountOptions",e.amountOptions)("totalNumberOfEntries",e.rowsCount)("limitLabel","Max 3,000 rows per PDF")("isCostRateActive",e.workspace.isCostRateActive)("isRounding",e.isRounding)("totalInfo",e.totalInfo)("isAdminOrOwner",e.isAdminOrOwner)("canSeeRates",e.canSeeRates)("isSummary",!0),s.Cb(4),s.wc("ngIf",e.chartData),s.Cb(2),s.wc("filterGroups",e.summaryFilterGroups)("projectGroupingLabel",e.projectGroupingLabel)("showEstimate",e.showEstimate)("hasEstimateFeature",e.hasEstimateFeature)("isAdminOrOwner",e.isAdminOrOwner),s.Cb(2),s.Hb("cl-col-lg-custom-8",!e.reduceTable)("cl-col-lg-custom-9",e.reduceTable),s.Cb(1),s.wc("isExpanded",e.isExpanded)("sortOrder",e.sortData.sortOrder)("sortColumn",e.sortData.sortColumn)("summaryFilterGroups",e.summaryFilterGroupsClone)("showEstimate",e.showEstimate&&e.hideEstimateColumn)("amountOptions",e.amountsForTable)("showOnlyFirstAmount",e.showOnlyFirstAmount),s.Cb(1),s.wc("ngForOf",e.groups),s.Cb(1),s.Hb("cl-col-lg-custom-4",!e.reduceTable)("cl-col-lg-custom-3",e.reduceTable),s.Cb(2),s.wc("ngIf",e.doughnutChart)}}function PW(e,t){if(1&e){const e=s.Yb();s.Xb(0,"modal-header",32),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"customize-report",33),s.jc("onOpen",(function(){return s.Oc(e),s.nc().getCustomizationSettings()}))("onSave",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().saveExportSettings(n,i)}))("onClose",(function(){return t.$implicit.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,11,"REPORTS.SUMMARY.EXPORT_SETTINGS_TOOLTIP")),s.Cb(2),s.wc("inProgress",e.customizationInProgress)("reportType",e.TYPE)("canSeeRates",e.canSeeRates)("isAdminOrOwner",e.isAdminOrOwner)("currentSettings",e.currentSettings)("reportName",e.reportName)("customFields",e.customFields)("checkedCustomFields",e.currentCustomFieldSettings)("isCostRateActive",e.workspace.isCostRateActive)("options",e.exportOptions)}}function MW(e,t){if(1&e){const e=s.Yb();s.Xb(0,"modal-header",32),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"share-report",34),s.jc("onShare",(function(n){s.Oc(e);const i=t.$implicit,c=s.nc(),a=s.Lc(7);return c.shareReport(n,i,a)}))("onClose",(function(){return t.$implicit.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,5,"REPORTS.SHARED.SHARE_BTN")),s.Cb(2),s.wc("inProgress",e.shareInProgress)("dateRangeLabel",e.getDateRangeValue())("dateRangeType",e.dateRangeType)("isAdminOrOwner",e.isAdminOrOwner)}}function BW(e,t){if(1&e&&(s.Xb(0,"modal-header",32),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"div",35),s.Xb(3,"text-copy",36),s.jc("onClose",(function(){return t.$implicit.close()})),s.Xb(4,"small",37),s.Sb(5,"img",38),s.oc(6,"translate"),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(9,"div",39),s.Xb(10,"a",40),s.jc("keyup.space",(function(){return t.$implicit.close()}))("keyup.enter",(function(){return t.$implicit.close()}))("click",(function(){return t.$implicit.close()})),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.wc("title",s.pc(1,5,"GLOBAL.LINK_CREATED_TITLE")),s.Cb(3),s.wc("text",e.sharedLink),s.Cb(2),s.wc("ngbTooltip",s.pc(6,7,"REPORTS.SHARED.SHARE_LINK_BTN")),s.Cb(2),s.bd(" ",s.pc(8,9,"REPORTS.SHARED.CREATE_LINK_INFO")," "),s.Cb(4),s.ad(s.pc(12,11,"GLOBAL.CLOSE_BTN"))}}let UW=(()=>{class e extends o_{constructor(e,t,n,i,s,c,a,o,r,l,b,d,u,p,h,m,g,E,f,S,C,A){super(e,t,n,i,s,c,a,o,r,l,b,d,u,p,m,E,f,S,C,A),this.bulkEditDataService=h,this.userService=g,this.translateService=S,this.translationStore=C,this.analyticsService=A,this.TYPE=Fy.a.SUMMARY,this.isExpanded=!1,this.exportOptions={allOptions:[new b_(LW.a.DURATION,this.translateService.instant("REPORTS.DETAILED_REPORT.DURATION_HOURS_LABEL"))],csvXlsxOptions:[new b_(LW.a.DECIMAL_DURATION,this.translateService.instant("REPORTS.DETAILED_REPORT.DURATION_DECIMAL_LABEL"))],pdfOptions:[new b_(LW.a.BAR_CHART,this.translateService.instant("REPORTS.SUMMARY.BAR_CHART_TITLE")),new b_(LW.a.PIE_CHART_1,this.translateService.instant("REPORTS.SUMMARY.PIE_CHART_WITH_GROUP",{groupNumber:1})),new b_(LW.a.PIE_CHART_2,this.translateService.instant("REPORTS.SUMMARY.PIE_CHART_WITH_GROUP",{groupNumber:2})),new b_(LW.a.PIE_CHART_3,this.translateService.instant("REPORTS.SUMMARY.PIE_CHART_WITH_GROUP",{groupNumber:3}))]},this.reduceColumnWidth=!1}ngOnInit(){super.ngOnInit(),this.userFormat=this.userService.getDateFormatForUser()||"DD.MM.YYYY",this.hasEstimateFeature=this.workspace.hasFeature(is.a.SUMMARY_ESTIMATE),this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.activeBillable=this.workspace.activeBillableHours,this.onlyAdminCanSeeAndChangeBillable=this.workspace.onlyAdminsCanChangeBillableStatus,this.reduceTable=this.amountOptions.length>1,this.calculateTableColumns()}afterWorkspaceSet(){this.projectGroupingLabel=this.workspace.projectGroupingLabel||"client"}getReports(){this.loader.show("GLOBAL.LOADER_LOADING");const e=this.createReportQuery(),t=this.amountOptions,n=this.zoomLevel,i={start:e.dateRange.start.clone(),end:e.dateRange.end.clone()};this.reportService.summaryResponse.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(({totals:e,chart:s,groups:c})=>{let a;this.hideAmount=t.length<1,this.totalInfo=e,!e.totalAmounts&&this.amountOptions&&(this.totalInfo.totalAmounts=this.amountOptions.length?[new p_.a(this.amountOptions[0],e.totalAmount)]:[],this.showOnlyFirstAmount=!0),this.entriesCount=e.entriesCount,this.summaryFilterGroupsClone=this.summaryFilterGroups.slice(),this.summaryFilterGroups[0]!==e_.a.PROJECT&&c.forEach(e=>{const t=Object(wc.e)(a);a=t.lastRandom,e.color=e.name?t.randomRgba:In.p}),c.forEach(e=>e.setAmounts(this.amountOptions)),this.groups=c,this.rowsCount=Object($n.a)(c),this.isBillabilityType=s[0]&&(!!s[0].totalAmount||0===s[0].totalAmount)&&(!this.onlyAdminCanSeeAndChangeBillable||this.isAdminOrOwner),s=Object($n.h)(s,i,n),this.chartData=Object($n.i)(s,n,t,this.format,this.translateService,this.translationStore),this.tooltipConfig={hideTableBody:!t.includes(jy.a.EARNED)||this.onlyAdminCanSeeAndChangeBillable&&!this.isAdminOrOwner};const o=this.summaryFilterGroups[0],r=Object($n.c)(this.groups,this.totalInfo.totalTime,o,this.userFormat);this.doughnutChart=r.doughnutChart,this.doughnutChartColors=r.doughnutChartColors,this.doughnutChartData=r.doughnutChartData,this.doughnutChartLabels=r.doughnutChartLabels,this.amountsForTable=this.amountOptions,this.calculateTableColumns(),this.cd.detectChanges(),this.loader.hide()},()=>{this.loader.hide()}),this.reportService.getSummaryReport(e),this.workspace.activeBillableHours||(this.reportService.summaryResponse.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(({})=>{this.hideAmount=!0}),this.reportService.getSummaryReport(e))}columnOrderChanged(e){this.sortData=e,this.navigate(),this.uiSettingsService.setSettings(xn.b.SUMMARY_SORT,this.sortData)}groupByChanged(e){this.summaryFilterGroups=e,this.uiSettingsService.setSummaryGroupsBy(e,this.workspace.id),this.navigate()}showEstimateChanged(e){this.showEstimate=e,this.uiSettingsService.setSummaryEstimateOn(e,this.workspace.id),this.calculateTableColumns(),this.cd.detectChanges()}hideEstimate(e){this.uiSettingsService.setSummaryShowEstimate(e&&this.hasEstimateFeature,this.workspace.id),this.hideEstimateColumn=this.uiSettingsService.getSummaryShowEstimate(this.workspace.id)}reduceTableChange(e){this.reduceTable=e}calculateTableColumns(){let e=1;this.showEstimate&&e++,e+=this.amountOptions.length,e>3&&(this.reduceColumnWidth=!0)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(re.a),s.Rb(s.h),s.Rb(xn.a),s.Rb(k.d),s.Rb(Uy.a),s.Rb(k.a),s.Rb(By.a),s.Rb(Gn.a),s.Rb(Hn.a),s.Rb(WA.a),s.Rb(w.q),s.Rb(bn.a),s.Rb(Gy.a),s.Rb(l_.a),s.Rb(UA.a),s.Rb(Lc.a),s.Rb(a_.a),s.Rb(Ic.a),s.Rb(g.f),s.Rb(Ra.a),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["summary-reports"]],features:[s.zb],decls:8,vars:1,consts:[[1,"cl-page-wrapper"],["class","cl-container-fluid",4,"ngIf"],["customizeModal",""],["shareModal",""],["linkCreatedModal",""],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center","cl-justify-content-between"],[1,"cl-col-auto","cl-mb-3","cl-mb-md-0","cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-justify-content-md-start"],[1,"cl-btn-group",3,"page"],[1,"cl-col-auto"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-sm-end"],[1,"cl-page-header-action","cl-w-100","cl-w-md-auto"],[3,"timeEntriesDateRange","dateRangeOut"],[3,"hideMembers","hideUserGroupMembers","description","valuesData","withoutDescription","customFieldFilters","onApply","activeFilterChanged","emitClearFilters",4,"ngIf"],[1,"cl-card","cl-border-bottom-0","cl-mb-0",3,"amountOptions","totalNumberOfEntries","limitLabel","isCostRateActive","isRounding","totalInfo","isAdminOrOwner","canSeeRates","isSummary","shareReports","customizeReport","exportAsPdf","exportAsCsv","exportAsExcel","onRoundingChange","onAmountOptionChange","reduceTableChange"],[1,"cl-card"],[1,"cl-card-body","cl-p-0"],[1,"cl-main-chart-container"],[3,"barChartLabels","barChartAllLabels","projectCountByDate","canSeeRates","isBillabilityType","currency","format","chartDataDurationUnit","tooltipConfig","billableTimes","barChartColors","barChartData","barChartEarnings","totalDurationByDate",4,"ngIf"],[1,"cl-card","cl-reset-component-row-last-child"],[1,"cl-card-header","cl-pl-2","cl-pl-lg-3","cl-pr-0",3,"filterGroups","projectGroupingLabel","showEstimate","hasEstimateFeature","isAdminOrOwner","onGroupByChanged","onShowEstimateChanged","onHideEstimateChanged"],[1,"cl-row","cl-m-0"],[1,"cl-p-0","cl-reports-summary-table-col"],[1,"cl-card-header","cl-bg-white","cl-d-lg-flex","small","cl-px-2","cl-px-lg-3",3,"isExpanded","sortOrder","sortColumn","summaryFilterGroups","showEstimate","amountOptions","showOnlyFirstAmount","onChange","onExpand"],[3,"currency","format","hideAmount","showEstimate","filterGroups","isExpanded","userFormat","activeBillableHours","onlyAdminCanSeeAndChangeBillable","enableLinks","dateRange","enabledStandardFilters","group","amountOptions","reduceTable",4,"ngFor","ngForOf"],[1,"p-0","col-9"],[3,"doughnutChart","doughnutChartColors","doughnutChartData","totalTime","doughnutChartLabels","currency","format","canSeeRates","isBillabilityType","tooltipToLeft",4,"ngIf"],[3,"hideMembers","hideUserGroupMembers","description","valuesData","withoutDescription","customFieldFilters","onApply","activeFilterChanged","emitClearFilters"],[3,"barChartLabels","barChartAllLabels","projectCountByDate","canSeeRates","isBillabilityType","currency","format","chartDataDurationUnit","tooltipConfig","billableTimes","barChartColors","barChartData","barChartEarnings","totalDurationByDate"],[3,"currency","format","hideAmount","showEstimate","filterGroups","isExpanded","userFormat","activeBillableHours","onlyAdminCanSeeAndChangeBillable","enableLinks","dateRange","enabledStandardFilters","group","amountOptions","reduceTable"],[3,"doughnutChart","doughnutChartColors","doughnutChartData","totalTime","doughnutChartLabels","currency","format","canSeeRates","isBillabilityType","tooltipToLeft"],[3,"title","onClose"],[3,"inProgress","reportType","canSeeRates","isAdminOrOwner","currentSettings","reportName","customFields","checkedCustomFields","isCostRateActive","options","onOpen","onSave","onClose"],[3,"inProgress","dateRangeLabel","dateRangeType","isAdminOrOwner","onShare","onClose"],[1,"cl-modal-body"],[3,"text","onClose"],[1,"form-text","text-gray-9"],["src","assets/images/ui-icons/info-9.svg","placement","top",1,"cl-mr-2",3,"ngbTooltip"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"keyup.space","keyup.enter","click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xc(1,DW,24,35,"div",1),s.Wb(),s.Xc(2,PW,3,13,"ng-template",null,2,s.Yc),s.Xc(4,MW,3,7,"ng-template",null,3,s.Yc),s.Xc(6,BW,13,13,"ng-template",null,4,s.Yc)),2&e&&(s.Cb(1),s.wc("ngIf",t.workspace))},directives:[i.u,f_,ws.a,S_.a,RW.a,e_.b,i.t,C_.a,ya.a,yW.a,_a.a,Wd.a,Lk,ak.a,Rk.a,w.bb],pipes:[g.e],encapsulation:2,changeDetection:0}),e})(),GW=(()=>{class e{constructor(e,t){this.subdomainService=e,this.router=t}canActivate(){return this.subdomainService.isSubdomainNotSelfhosted()&&this.router.navigate(["/tracker"]),!0}}return e.\u0275fac=function(t){return new(t||e)(s.fc(Lb.a),s.fc(k.d))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var xW=n("8IBD"),FW=n("1Y3z"),jW=function(e){return e.MEMBERS="MEMBERS",e.GROUPS="GROUPS",e.REMINDERS="REMINDERS",e}({});function ZW(e,t){1&e&&(s.Xb(0,"div"),s.Zc(1," admin sam "),s.Wb())}function VW(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",10),s.Xb(1,"a",11),s.jc("click",(function(){return s.Oc(e),s.nc(3).changeSort("hourlyRate")})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc(3);s.Cb(1),s.Hb("cl-up","hourlyRate"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","hourlyRate"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING),s.Cb(1),s.cd("",s.pc(3,6,"GLOBAL.BILLABLE_RATE_LABEL")," (",e.currency,")")}}function YW(e,t){if(1&e&&(s.Xb(0,"th"),s.Xb(1,"div",8),s.Xc(2,VW,4,8,"div",9),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.wc("ngIf",e.canSeeRates)}}function HW(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",13),s.Xb(1,"a",4),s.jc("click",(function(){return s.Oc(e),s.nc(3).changeSort("costRate")})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc(3);s.Cb(1),s.Hb("cl-up","costRate"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","costRate"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING),s.Cb(1),s.cd("",s.pc(3,6,"GLOBAL.COST_RATE_LABEL")," (",e.currency,")")}}function $W(e,t){if(1&e&&(s.Xb(0,"th"),s.Xc(1,HW,4,8,"div",12),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",e.canSeeRates&&e.hasLaborCostFeature&&e.isCostRateActive&&e.activeBillable)}}function KW(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xc(1,ZW,2,0,"div",2),s.Xb(2,"th",3),s.Xb(3,"a",4),s.jc("click",(function(){return s.Oc(e),s.nc().changeSort("name")})),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Xb(6,"th"),s.Xb(7,"div",5),s.Xb(8,"a",4),s.jc("click",(function(){return s.Oc(e),s.nc().changeSort("email")})),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xc(11,YW,3,1,"th",2),s.Xc(12,$W,2,1,"th",2),s.Xb(13,"th"),s.Xb(14,"div"),s.Xb(15,"a",6),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(18,"th",7),s.Xb(19,"div",5),s.Xb(20,"a",4),s.jc("click",(function(){return s.Oc(e),s.nc().changeSort("access")})),s.Zc(21),s.oc(22,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.isCurrentUserAdminOrOwner),s.Cb(2),s.Hb("cl-up","name"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","name"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING),s.Cb(1),s.bd(" ",s.pc(5,19,"GLOBAL.NAME_LABEL"),""),s.Cb(4),s.Hb("cl-up","email"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","email"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING),s.Cb(1),s.ad(s.pc(10,21,"GLOBAL.EMAIL_LABEL")),s.Cb(2),s.wc("ngIf",e.activeBillable&&e.isAdminOrOwner),s.Cb(1),s.wc("ngIf",e.activeBillable&&e.isAdminOrOwner),s.Cb(4),s.ad(s.pc(17,23,"GLOBAL.ROLE_LABEL")),s.Cb(4),s.Hb("cl-up","access"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","access"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING),s.Cb(1),s.ad(s.pc(22,25,"GLOBAL.GROUP_LABEL"))}}function qW(e,t){if(1&e){const e=s.Yb();s.Xb(0,"th",14),s.Xb(1,"div",15),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"div",16),s.Xb(5,"a",17),s.jc("click",(function(){return s.Oc(e),s.nc().expandAll()})),s.Xb(6,"span",18),s.Sb(7,"img",19),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.bd("",s.pc(3,2,"GLOBAL.NAME_LABEL")," "),s.Cb(5),s.wc("src",e.isExpandAll?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",s.Qc)}}let zW=(()=>{class e{constructor(e,t,n){this.workspaceService=e,this.authService=t,this.cd=n,this.onChangeSortOrder=new s.n,this.onChangeSortColumn=new s.n,this.onExpandAll=new s.n,this.isExpandAll=!1,this.SortOrder=bi.a,this.unsubscribe$=new p.a}ngOnInit(){this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e,this.activeBillable=this.workspace.activeBillableHours,this.cd.detectChanges()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}expandAll(){this.isExpandAll=!this.isExpandAll,this.onExpandAll.emit(this.isExpandAll)}changeSort(e){e!==this.sortColumn?this.onChangeSortColumn.emit(e):this.onChangeSortOrder.emit()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(re.a),s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["members-header"],["","members-header",""]],inputs:{isDesktop:"isDesktop",sortColumn:"sortColumn",sortOrder:"sortOrder",canSeeRates:"canSeeRates",activeBillable:"activeBillable",hasLaborCostFeature:"hasLaborCostFeature",isCostRateActive:"isCostRateActive",currency:"currency"},outputs:{onChangeSortOrder:"onChangeSortOrder",onChangeSortColumn:"onChangeSortColumn",onExpandAll:"onExpandAll"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["mobileTemplate",""],[4,"ngIf"],[1,"cl-pl-lg-3"],[1,"cl-text-gray-6","cl-sort-by",3,"click"],[1,"cl-ml-lg-custom-n2"],[1,"cl-h5","cl-mb-0","cl-hover-no-underline","cl-cursor-text","cl-text-gray-6-dark-mode"],["colspan","2"],[1,"cl-d-flex"],["class","cl-ml-lg-custom-n2 cl-team-table-members-billable-rate",4,"ngIf"],[1,"cl-ml-lg-custom-n2","cl-team-table-members-billable-rate"],[1,"cl-text-gray-6","cl-sort-by","cl-text-uppercase",3,"click"],["class","cl-team-table-members-cost-rate",4,"ngIf"],[1,"cl-team-table-members-cost-rate"],["colspan","6",1,"cl-pl-lg-3"],[1,"cl-h5","cl-mb-0","cl-d-flex","cl-justify-content-between","cl-align-items-center"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-ml-auto",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"]],template:function(e,t){if(1&e&&(s.Xc(0,KW,23,27,"ng-container",0),s.Xc(1,qW,8,4,"ng-template",null,1,s.Yc)),2&e){const e=s.Lc(2);s.wc("ngIf",t.isDesktop)("ngIfElse",e)}},directives:[i.u],pipes:[g.e],encapsulation:2}),e})();var QW=n("sNAh"),JW=(n("k2Yt"),n("g7VG")),eX=n("5WIt"),tX=n("K785"),nX=n("MxRx"),iX=n("9Gc3"),sX=n("Fnfa");function cX(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"displayNames"),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.ad(s.pc(2,1,e.selectedEntityName))}}const aX=function(e){return{"cl-dropdown-toggle pointer":e}};function oX(e,t){if(1&e&&(s.Xb(0,"span",8),s.Xc(1,cX,3,3,"span",4),s.Wb()),2&e){const e=s.nc(2);s.xc("title",e.selectedEntityName),s.wc("ngClass",s.Bc(3,aX,e.isAdminOrOwner)),s.Cb(1),s.wc("ngIf",e.selectedEntityName.length>0)}}const rX=function(e){return{"cl-dropdown-toggle":e}};function lX(e,t){if(1&e&&(s.Xb(0,"span",5),s.Xb(1,"div",6),s.Xc(2,oX,2,5,"span",7),s.Wb(),s.Wb()),2&e){const e=s.nc(),t=s.Lc(3);s.wc("ngClass",s.Bc(3,rX,e.isAdminOrOwner)),s.Cb(2),s.wc("ngIf",e.selectedEntityName.length>0)("ngIfElse",t)}}function bX(e,t){1&e&&(s.Xb(0,"a",11),s.Sb(1,"img",12),s.Xb(2,"span",13),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.ad(s.pc(4,1,"GLOBAL.GROUP_LABEL")))}function dX(e,t){if(1&e&&(s.Xb(0,"a",14),s.Sb(1,"img",12),s.Xb(2,"span",13),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.wc("ngClass",e.isAdminOrOwner?"":"cl-cursor-default"),s.Cb(3),s.ad(s.pc(4,2,"GLOBAL.ACCESS_LABEL"))}}function uX(e,t){if(1&e&&(s.Xc(0,bX,5,3,"a",9),s.Xc(1,dX,5,4,"a",10)),2&e){const e=s.nc();s.wc("ngIf",e.isAdminOrOwner&&"userGroups"===e.mode),s.Cb(1),s.wc("ngIf",e.isAdminOrOwner&&"users"===e.mode)}}function pX(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",e.selectedEntityName," ")}}function hX(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.cd(" ",s.pc(2,2,"GLOBAL.TEAM_LABEL"),""," ("+e.userSize+")"," ")}}function mX(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.EVERYONE_LABEL")," "))}function gX(e,t){if(1&e&&s.Xc(0,mX,3,3,"ng-container",4),2&e){const e=s.nc(2);s.wc("ngIf",e.userSize>1)}}function EX(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.bd(" (",s.pc(2,1,"TEAMS.REMINDERS.CREATE.SENTENCE.SECOND_PART"),") "))}function fX(e,t){if(1&e&&(s.Xb(0,"a",15),s.Xc(1,pX,2,1,"ng-container",4),s.Xc(2,hX,3,4,"ng-container",16),s.Xc(3,gX,1,1,"ng-template",null,17,s.Yc),s.Xc(5,EX,3,3,"ng-container",4),s.Wb()),2&e){const e=s.Lc(4),t=s.nc();s.Cb(1),s.wc("ngIf",1===t.userSize),s.Cb(1),s.wc("ngIf",t.userSize>1&&!t.isIncludingNew)("ngIfElse",e),s.Cb(3),s.wc("ngIf",0===t.userSize)}}function SX(e,t){if(1&e){const e=s.Yb();s.Xb(0,"dropdown-checkbox",19),s.jc("loadMore",(function(){return s.Oc(e),s.nc(2).getMoreUsers()}))("onFilterOptionChange",(function(t){return s.Oc(e),s.nc(2).onAssigneeFilterOptionChanged(t)}))("onChange",(function(t){return s.Oc(e),s.nc(2).onAssigneeFilterChanged(t)}))("onNoneSelected",(function(t){s.Oc(e);const n=s.nc(2);return n.isDisabledClose=t&&n.disableCloseIfNoSelected}))("onSearchChange",(function(t){return s.Oc(e),s.nc(2).onAssigneeFilterSearchChanged(t)})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("showSelectAll",!e.mode)("isResizeable",!1)("showTitles",!0)("searchValue",e.userQuery.name)("checkboxValues",e.checkboxValuesData)("selectableMaps",e.filterMaps)("placeholder",e.placeholder)("preventOfflineFiltering",!0)("filterOptions",e.userFilterOptions)("resetScrollOnFilterChange",!0)("showIncludeNew",e.showIncludeNew&&!e.mode)("isIncludingNew",e.isIncludingNew)("countMap",e.userCount)("noResetOnFilterChange",!0)}}function CX(e,t){1&e&&(s.Xb(0,"div"),s.Xc(1,SX,1,14,"dropdown-checkbox",18),s.Wb())}let AX=(()=>{class e{constructor(e,t,n,i){this.workspaceService=e,this.userGroupService=t,this.cd=n,this.translate=i,this.selectedEntityName=[],this.userSize=0,this.userAndUserGroups=new s.n,this.sendErrorOnEdit=new s.n,this.reachedLimit={},this.userQuery={page:1,limit:50,name:"",statuses:["ACTIVE","PENDING"]},this.userGroupsQuery={page:1,limit:50,name:""},this.checkboxValuesData=new wn.a,this.userCount=new hg.a,this.showIncludeNew=!0,this.isIncludingNew=!1,this.isDisabledClose=!1}set userIds(e){this._userIds=e,this.init()}get userIds(){return this._userIds}set userGroupIds(e){this._userGroupIds=e,this.init()}get userGroupIds(){return this._userGroupIds}ngOnInit(){switch(this.userFilterOptions=this.userOptions(),this.mode){case"userGroups":this.placeholder=this.translate.instant("TEAMS.MEMBERS.INFO.GROUP.PLACEHOLDER");break;case"users":this.placeholder=this.translate.instant("TEAMS.USERS.FIND");break;default:this.placeholder=this.translate.instant("TEAMS.MEMBERS.GROUPS.FIND")}this.init()}fetchUsersAndGroups(){"userGroups"===this.mode&&(this.userFilterOptions=[]),this.mode&&"userGroups"!==this.mode||this.getUserGroups(),this.mode&&"users"!==this.mode||this.getUsers()}getUsers(){this.reachedLimit.users||this.workspaceService.getReportsFilterTeamMembers(this.userQuery).subscribe(({count:e,users:t})=>{!!this.userQuery.name||this.userCount.set("users",e),1===this.userQuery.page&&this.filterMaps.resetMap("users");const n={label:this.translate.instant("GLOBAL.USERS_LABEL")};this.filterMaps.pushToMap("users",t,n);const i=this.filterMaps.countSelectablesOf("users");this.reachedLimit.users=i>=e||t.length<this.userQuery.limit})}getUserGroups(){var e;1===(null===(e=this.userQuery.statuses)||void 0===e?void 0:e.length)&&this.userQuery.statuses.includes(fI.a.INACTIVE)?this.filterMaps.removeMap("userGroups"):this.reachedLimit.userGroups||this.userGroupService.getUserGroups(this.userGroupsQuery).subscribe(({groups:e,count:t})=>{if(0===t)return void this.filterMaps.removeMap(nX.b);const n=e.length,i=e.filter(e=>"Admins"!==e.name);e=i,!!this.userGroupsQuery.name||this.userCount.set("userGroups",t),1===this.userGroupsQuery.page&&this.filterMaps.resetMap("userGroups");const s={label:this.translate.instant("GLOBAL.GROUPS_LABEL")};this.filterMaps.pushToMap("userGroups",e,s,!0);const c=this.filterMaps.countSelectablesOf("userGroups");this.reachedLimit.userGroups=c>=t||n<this.userGroupsQuery.limit})}getMoreUsers(){this.userQuery.page++,this.userGroupsQuery.page++,this.fetchUsersAndGroups()}onAssigneeFilterChanged(e){this.userSize=e.numberOfSelected,this.selectedEntityName=e.checkboxValues.names.filter(e=>""!=e),this.isIncludingNew=e.includingNew,this.isIncludingNew&&(this.selectedEntityName=[this.translate.instant("GLOBAL.EVERYONE_LABEL")]);let t={contains:e.checkboxValues.exclude?on.d.DOES_NOT_CONTAIN:on.d.CONTAINS,ids:e.checkboxValues.map.userGroups,status:"ALL"},n={contains:e.checkboxValues.exclude?on.d.DOES_NOT_CONTAIN:on.d.CONTAINS,ids:e.checkboxValues.map.users,status:e.checkboxValues.options.status};this.isIncludingNew&&(n={contains:on.d.CONTAINS,ids:["everyone"],status:"ALL"},t=null),this.userAndUserGroups.emit({users:n,userGroups:t,numberSelected:this.userSize}),this.cd.detectChanges()}onAssigneeFilterSearchChanged(e){this.resetQuery(),this.userQuery.name=e,this.userQuery.email=e,this.userGroupsQuery.name=e,this.fetchUsersAndGroups()}resetQuery(){this.userQuery.name="",this.userQuery.email="",this.userGroupsQuery.name="",this.userQuery.page=1,this.userGroupsQuery.page=1,this.reachedLimit.userGroups=!1,this.reachedLimit.users=!1}onAssigneeFilterOptionChanged(e){this.resetQuery(),e.value===fI.a.ALL?(this.userQuery.statuses=[fI.a.ACTIVE,fI.a.INACTIVE,fI.a.INVITED],this.showIncludeNew=!0):e.value===fI.a.ACTIVE?(this.userQuery.statuses=[fI.a.ACTIVE,fI.a.INVITED],this.showIncludeNew=!0):(this.userQuery.statuses=[e.value],this.showIncludeNew=!1),this.fetchUsersAndGroups(),this.isIncludingNew=!1}init(){var e,t,n;this.reachedLimit.userGroups=!1,this.reachedLimit.users=!1;const i=[];this.mode&&"users"!==this.mode||i.push(new mg.a("users")),this.mode&&"userGroups"!==this.mode||i.unshift(new mg.a("userGroups",null,{label:this.translate.instant("GLOBAL.GROUPS_LABEL")})),this.filterMaps=new Tn.a(i),this.checkboxValuesData=new wn.a,this.checkboxValuesData.names=this.selectedEntityName,1===(null===(e=this.userIds)||void 0===e?void 0:e.length)&&"everyone"===this.userIds[0]?this.isIncludingNew=!0:((null===(t=this.userIds)||void 0===t?void 0:t.length)&&this.checkboxValuesData.pushIds("users",[...this.userIds]),(null===(n=this.userGroupIds)||void 0===n?void 0:n.length)&&this.checkboxValuesData.pushIds("userGroups",[...this.userGroupIds]))}fetchUsers(){this.resetQuery(),this.fetchUsersAndGroups()}sendErrorForUpdate(){this.isDisabledClose&&this.sendErrorOnEdit.emit()}userOptions(){return[new tX.a({key:"status",options:[new Ea.a(fI.a.ALL,this.translate.instant("GLOBAL.ALL_LABEL")),new Ea.a(fI.a.ACTIVE,this.translate.instant("GLOBAL.ACTIVE_LABEL")),new Ea.a(fI.a.INACTIVE,this.translate.instant("GLOBAL.INACTIVE_LABEL"))]})]}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(WL.a),s.Rb(s.h),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["members-dropdown"],["","members-dropdown",""]],inputs:{selectedEntityName:"selectedEntityName",disableCloseIfNoSelected:"disableCloseIfNoSelected",userSize:"userSize",userIds:"userIds",userGroupIds:"userGroupIds",isAdminOrOwner:"isAdminOrOwner",mode:"mode"},outputs:{userAndUserGroups:"userAndUserGroups",sendErrorOnEdit:"sendErrorOnEdit"},decls:7,vars:6,consts:[["dropdownKey","",1,"cl-dropdown","cl-dropdown-large","cl-dropdown-mobile-w-100","cl-d-inline-block",3,"disableCloseDropdownKey","onTryingToClose","onOpen"],["dropdownKeyButton","","tabindex","0","class","cl-no-arrow cl-component-divided-left cl-d-flex cl-w-100",3,"ngClass",4,"ngIf","ngIfElse"],["noUserGroups",""],["reminder",""],[4,"ngIf"],["dropdownKeyButton","","tabindex","0",1,"cl-no-arrow","cl-component-divided-left","cl-d-flex","cl-w-100",3,"ngClass"],[1,"cl-cut-text-wrapper","cl-w-100","cl-d-flex","cl-justify-content-start"],["class","cl-badge cl-badge-tag cl-cut-text",3,"title","ngClass",4,"ngIf","ngIfElse"],[1,"cl-badge","cl-badge-tag","cl-cut-text",3,"title","ngClass"],["class","cl-d-flex cl-align-items-center pointer","dropdownKeyButton","","tabindex","0",4,"ngIf"],["class","cl-d-flex cl-align-items-center pointer","dropdownKeyButton","","tabindex","0",3,"ngClass",4,"ngIf"],["dropdownKeyButton","","tabindex","0",1,"cl-d-flex","cl-align-items-center","pointer"],["src","assets/images/ui-icons/plus-blue.svg"],[1,"cl-ml-2","cl-color-blue"],["dropdownKeyButton","","tabindex","0",1,"cl-d-flex","cl-align-items-center","pointer",3,"ngClass"],["dropdownKeyButton","","tabindex","0"],[4,"ngIf","ngIfElse"],["everyone",""],[3,"showSelectAll","isResizeable","showTitles","searchValue","checkboxValues","selectableMaps","placeholder","preventOfflineFiltering","filterOptions","resetScrollOnFilterChange","showIncludeNew","isIncludingNew","countMap","noResetOnFilterChange","loadMore","onFilterOptionChange","onChange","onNoneSelected","onSearchChange",4,"dropdownKeyContent"],[3,"showSelectAll","isResizeable","showTitles","searchValue","checkboxValues","selectableMaps","placeholder","preventOfflineFiltering","filterOptions","resetScrollOnFilterChange","showIncludeNew","isIncludingNew","countMap","noResetOnFilterChange","loadMore","onFilterOptionChange","onChange","onNoneSelected","onSearchChange"]],template:function(e,t){if(1&e&&(s.Xb(0,"div",0),s.jc("onTryingToClose",(function(){return t.sendErrorForUpdate()}))("onOpen",(function(){return t.fetchUsers()})),s.Xc(1,lX,3,5,"span",1),s.Xc(2,uX,2,2,"ng-template",null,2,s.Yc),s.Xc(4,fX,6,4,"ng-template",null,3,s.Yc),s.Xc(6,CX,2,0,"div",4),s.Wb()),2&e){const e=s.Lc(5);s.Hb("cl-w-100","userGroups"===t.mode||"users"===t.mode),s.wc("disableCloseDropdownKey",t.isDisabledClose),s.Cb(1),s.wc("ngIf","userGroups"===t.mode||"users"===t.mode)("ngIfElse",e),s.Cb(5),s.wc("ngIf",t.isAdminOrOwner)}},directives:[ni.a,iX.a,i.u,ii.a,i.r,si.a,Cg.a],pipes:[sX.a,g.e],encapsulation:2}),e})(),OX=(()=>{class e{constructor(e,t,n){this.workspaceService=e,this.formBuilder=t,this.analyticsService=n,this.onClose=new s.n}ngOnInit(){this.form=this.formBuilder.group({transfer:["",[v.G.required]],inProgress:[!1,[Bi.a.requiredFalse]]})}get transfer(){return this.form.get("transfer")}closeModal(){this.onClose.emit(!1)}textMatch(){return"transfer"!==this.transfer.value.toLowerCase()}confirm(){this.setInProgress(!0),"transfer"===this.transfer.value.trim().toLowerCase()&&(this.setInProgress(!1),this.workspaceService.transferOwnerRole(this.user.id),this.closeModal()),this.setInProgress(!1),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"Transfer",section:"Team",section2:"Members",section3:"Transfer ownership"}))}setInProgress(e){this.form.patchValue({inProgress:e})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(v.f),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["transfer-owner-role"]],inputs:{user:"user"},outputs:{onClose:"onClose"},decls:22,vars:19,consts:[[3,"formGroup","ngSubmit"],[1,"cl-modal-body","cl-text-center","cl-py-4"],[1,"cl-mb-3"],["src","assets/images/illustrations/transfer-owner-role.svg",1,"cl-img-fluid"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-mb-3","cl-text-gray-6"],[1,"cl-form-group","cl-mb-0","cl-text-left"],["formControlName","transfer","autofocus","",1,"cl-form-control",3,"type"],[1,"cl-modal-footer"],[3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"]],template:function(e,t){1&e&&(s.Xb(0,"form",0),s.jc("ngSubmit",(function(){return t.confirm()})),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Sb(3,"img",3),s.Wb(),s.Xb(4,"div",4),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"p",5),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Xb(10,"div",6),s.Xb(11,"label"),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Sb(14,"input",7),s.Wb(),s.Wb(),s.Xb(15,"div",8),s.Xb(16,"a",9),s.jc("click",(function(){return t.closeModal()})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Xb(19,"button",10),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.wc("formGroup",t.form),s.Cb(5),s.ad(s.pc(6,9,"TEAMS.MEMBERS.INFO.ROLE_TYPE.OWNER.TRANSFER_MODAL.TITLE")),s.Cb(3),s.cd("",s.pc(9,11,"TEAMS.MEMBERS.INFO.ROLE_TYPE.OWNER.TRANSFER_MODAL.INFO_MESSAGE")," ",t.user.name,"?"),s.Cb(4),s.ad(s.pc(13,13,"TEAMS.MEMBERS.INFO.ROLE_TYPE.OWNER.TRANSFER_MODAL.CONFIRM")),s.Cb(2),s.wc("type","text"),s.Cb(3),s.ad(s.pc(18,15,"GLOBAL.NEVERMIND_CANCEL_BTN")),s.Cb(2),s.wc("disabled",t.form.invalid||t.textMatch()),s.Cb(1),s.bd(" ",s.pc(21,17,"TEAMS.MEMBERS.INFO.ROLE_TYPE.OWNER.TRANSFER_MODAL.OK"),""))},directives:[v.I,v.t,v.k,v.c,v.s,v.i],pipes:[g.e],encapsulation:2}),e})(),vX=(()=>{class e{constructor(e){this.copyService=e,this.onClose=new s.n}ngOnInit(){}copyUrl(e){this.copyService.copyToClipboard(e)}closeModal(){this.onClose.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(ie.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["invite-link"]],inputs:{url:"url"},outputs:{onClose:"onClose"},decls:19,vars:10,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-input-group","cl-mb-0"],["type","text","readonly","",1,"cl-form-control",3,"value"],["urlInput",""],[1,"cl-input-group-append"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-outline-light",3,"click"],[1,"cl-modal-footer"],[3,"click"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.closeModal()})),s.Xb(5,"span"),s.Sb(6,"img",3),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",4),s.Xb(8,"div",5),s.Sb(9,"input",6,7),s.Xb(11,"div",8),s.Xb(12,"button",9),s.jc("click",(function(){s.Oc(e);const n=s.Lc(10);return t.copyUrl(n)})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(15,"div",10),s.Xb(16,"a",11),s.jc("click",(function(){return t.closeModal()})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.ad(s.pc(3,4,"GLOBAL.LINK_CREATED_TITLE")),s.Cb(7),s.wc("value",t.url),s.Cb(4),s.ad(s.pc(14,6,"GLOBAL.COPY_LABEL")),s.Cb(4),s.ad(s.pc(18,8,"GLOBAL.CLOSE_BTN")))},pipes:[g.e],encapsulation:2}),e})();var TX=n("jpmO"),IX=n("nLyk");const wX=function(e){return{name:e}};function LX(e,t){if(1&e&&(s.Xb(0,"h1",21),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.ad(s.qc(2,1,"TEAMS.MEMBERS.INFO.ROLE_TYPE.WHOSE",s.Bc(4,wX,e.user.name)))}}function RX(e,t){1&e&&(s.Xb(0,"h1",22),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"TEAMS.MEMBERS.INFO.ROLE_TYPE.USER_ROLE")))}function yX(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"input",23),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().isCurrentOwner=t})),s.Wb(),s.Xb(2,"label",24),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"p",14),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.wc("ngModel",e.isCurrentOwner),s.Cb(2),s.bd(" ",s.pc(4,3,"GLOBAL.OWNER_LABEL")," "),s.Cb(3),s.ad(s.pc(7,5,"TEAMS.MEMBERS.INFO.ROLE_TYPE.OWNER.INFO_MESSAGE"))}}function _X(e,t){if(1&e){const e=s.Yb();s.Xb(0,"input",25),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().isAdmin=t}))("ngModelChange",(function(){return s.Oc(e),s.nc().checkIsChanged()})),s.Wb(),s.Xb(1,"label",26),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"p",14),s.Zc(5),s.oc(6,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("ngModel",e.isAdmin)("disabled",!e.isCurrentOwner&&e.backupRoleData.isAdmin),s.Cb(2),s.bd(" ",s.pc(3,4,"GLOBAL.ADMIN_LABEL")," "),s.Cb(3),s.ad(s.pc(6,6,"TEAMS.MEMBERS.INFO.ROLE_TYPE.ADMIN.INFO_MESSAGE"))}}function kX(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",27),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",28),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.addEventOnUpgrade(),t.navToUpgrade()})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,2,"TEAMS.FEATURE.STANDARD")," "),s.Cb(3),s.ad(s.pc(6,4,"GLOBAL.UPGRADE_BTN")))}function WX(e,t){if(1&e&&(s.Xb(0,"span",38),s.Zc(1),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.bd(" ",e.numberOfSelected[e.ReportFilter.PROJECTS]," ")}}function XX(e,t){if(1&e){const e=s.Yb();s.Xb(0,"dropdown-checkbox",39),s.jc("onSelectAllWithTextInput",(function(t){s.Oc(e);const n=s.nc(3);return n.selectAllProjectIds(t,n.ReportFilter.PROJECTS)}))("loadMore",(function(){return s.Oc(e),s.nc(3).getProjects()}))("onFilterOptionChange",(function(t){s.Oc(e);const n=s.nc(3);return n.clearOptionFilter(n.ReportFilter.PROJECTS,t),n.getProjects()}))("onSearchChange",(function(t){s.Oc(e);const n=s.nc(3);return n.onSearchChange(n.ReportFilter.PROJECTS,t),n.getProjects()}))("onCloseFilter",(function(t){s.Oc(e);const n=s.nc(3);return n.setIndicatorOf(n.ReportFilter.PROJECTS,t,!1)}))("onChange",(function(t){s.Oc(e);const n=s.nc(3);return n.valuesData[n.ReportFilter.PROJECTS]=t.checkboxValues,n.filterMaps[n.ReportFilter.PROJECTS]=t.selectableMaps,n.setIndicatorOf(n.ReportFilter.PROJECTS,t),n.checkIsChanged()})),s.oc(1,"translate"),s.Wb()}if(2&e){const e=s.nc(3);s.wc("placeholder",s.pc(1,10,"GLOBAL.PROJECT_FIND"))("filterName","projects")("countNumber",e.counts[e.ReportFilter.PROJECTS])("singleMapProperty",e.ReportFilter.PROJECTS)("checkboxValues",e.valuesData[e.ReportFilter.PROJECTS])("selectableMaps",e.filterMaps[e.ReportFilter.PROJECTS])("filterOptions",e.projectFilterOptions)("searchValue",e.query[e.ReportFilter.PROJECTS].name)("inProgressSelectAll",e.inProgressSelectAll[e.ReportFilter.PROJECTS])("inProgressLoading",e.inProgressLoading[e.ReportFilter.PROJECTS])}}function NX(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",31),s.jc("onClose",(function(){s.Oc(e);const t=s.nc(2);return t.isOpenedMap[t.ReportFilter.PROJECTS]=!1}))("onOpen",(function(){s.Oc(e);const t=s.nc(2);return 1===t.query[t.ReportFilter.PROJECTS].page&&t.getProjects(),t.isOpenedMap[t.ReportFilter.PROJECTS]=!0})),s.Xb(1,"div",32),s.Xb(2,"div",33),s.Xc(3,WX,2,1,"span",34),s.Xb(4,"span",35),s.Zc(5),s.oc(6,"translate"),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Sb(8,"div",36),s.Wb(),s.Xc(9,XX,2,12,"dropdown-checkbox",37),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(3),s.wc("ngIf",e.numberOfSelected[e.ReportFilter.PROJECTS]),s.Cb(2),s.bd(" ",e.isProjectDirty?s.pc(6,2,"GLOBAL.PROJECTS_LABEL"):s.pc(7,4,"GLOBAL.ADD_PROJECT_LABEL")," ")}}function DX(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"div",29),s.Xc(2,NX,10,6,"div",30),s.Wb(),s.Ub()),2&e){const e=s.nc();s.Cb(2),s.wc("ngIf",!e.valuesData[e.ReportFilter.PROJECTS].isFilterDisabled)}}function PX(e,t){if(1&e&&(s.Xb(0,"span",38),s.Zc(1),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.bd(" ",e.numberOfSelected[e.ReportFilter.USERS_AND_GROUP]," ")}}function MX(e,t){if(1&e){const e=s.Yb();s.Xb(0,"dropdown-checkbox",41),s.jc("loadMore",(function(){return s.Oc(e),s.nc(3).loadMoreUsers()}))("onSelectAllWithTextInput",(function(t){return s.Oc(e),s.nc(3).selectAllUserIds(t)}))("onSearchChange",(function(t){s.Oc(e);const n=s.nc(3);return n.onSearchChange(n.ReportFilter.USERS_AND_GROUP,t),n.checkGroup(),n.getUsersAndUserGroups()}))("onFilterOptionChange",(function(t){s.Oc(e);const n=s.nc(3);return n.clearOptionFilter(n.ReportFilter.USERS_AND_GROUP,t),n.checkGroup(),n.getUsersAndUserGroups()}))("onCloseFilter",(function(t){s.Oc(e);const n=s.nc(3);return n.setIndicatorOf(n.ReportFilter.USERS_AND_GROUP,t)}))("onChange",(function(t){s.Oc(e);const n=s.nc(3);return n.valuesData[n.ReportFilter.USERS_AND_GROUP]=t.checkboxValues,n.filterMaps[n.ReportFilter.USERS_AND_GROUP]=t.selectableMaps,n.setIndicatorOf(n.ReportFilter.USERS_AND_GROUP,t),n.checkIsChanged()})),s.oc(1,"translate"),s.Wb()}if(2&e){const e=s.nc(3);s.xc("placeholder",s.pc(1,11,"TEAMS.MEMBERS.GROUPS.FIND")),s.wc("preventOfflineFiltering",!0)("filterName","team")("noResetOnFilterChange",!0)("checkboxValues",e.valuesData[e.ReportFilter.USERS_AND_GROUP])("selectableMaps",e.filterMaps[e.ReportFilter.USERS_AND_GROUP])("filterOptions",e.userFilterOptions)("searchValue",e.query[e.ReportFilter.USERS_AND_GROUP].name)("countMap",e.userCount)("inProgressSelectAll",e.inProgressSelectAll[e.ReportFilter.USERS_AND_GROUP])("inProgressLoading",e.inProgressLoading[e.USERS]||e.inProgressLoading[e.GROUPS])}}function BX(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",31),s.jc("onClose",(function(){s.Oc(e);const t=s.nc(2);return t.isOpenedMap[t.ReportFilter.USERS_AND_GROUP]=!1}))("onOpen",(function(){s.Oc(e);const t=s.nc(2);return 1===t.query[t.ReportFilter.USERS_AND_GROUP].page&&t.getUsersAndUserGroups(),t.isOpenedMap[t.ReportFilter.USERS_AND_GROUP]=!0})),s.Xb(1,"div",32),s.Xb(2,"div",33),s.Xc(3,PX,2,1,"span",34),s.Xb(4,"span",35),s.Zc(5),s.oc(6,"translate"),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Sb(8,"div",36),s.Wb(),s.Xc(9,MX,2,13,"dropdown-checkbox",40),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(3),s.wc("ngIf",e.numberOfSelected[e.ReportFilter.USERS_AND_GROUP]),s.Cb(2),s.bd(" ",e.isUserDirty?s.pc(6,2,"GLOBAL.USERS_LABEL"):s.pc(7,4,"TEAMS.USERS.SELECT")," ")}}function UX(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"div",29),s.Xc(2,BX,10,6,"div",30),s.Wb(),s.Ub()),2&e){const e=s.nc();s.Cb(2),s.wc("ngIf",!e.valuesData[e.ReportFilter.USERS_AND_GROUP].isFilterDisabled)}}let GX=(()=>{class e{constructor(e,t,n,i,c,a,o,r,l){this.router=e,this.projectService=t,this.workspaceService=n,this.userService=i,this.cd=c,this.roleService=a,this.userGroupV1Service=o,this.translate=r,this.analyticsService=l,this.valuesData={},this.onClose=new s.n,this.onSave=new s.n,this.onInProgress=new s.n,this.unsubscribe$=new p.a,this.initialEntities={},this.numberOfSelected={},this.inProgressSelectAll={},this.inProgressLoading={},this.query={},this.filterMaps={[on.i.PROJECTS]:null,[on.i.USERS_AND_GROUP]:null},this.isOpenedMap={},this.counts={[on.i.PROJECTS]:null,[on.i.USERS_AND_GROUP]:null},this.ReportFilter=on.i,this.userCount=new hg.a,this.projectFilterOptions=on.r,this.userFilterOptions=on.v,this.hasChanged=!1,this.backupValuesData={},this.backupRoleData={},this.USERS=on.k,this.GROUPS=on.f,this.isOwner=!1}get isAdmin(){return this._isAdmin}set isAdmin(e){this._isAdmin=e}set saveInProgress(e){const t=e!==this._saveInProgress;this._saveInProgress=e,t&&this.onInProgress.emit(e)}get saveInProgress(){return this._saveInProgress}ngOnInit(){this.resetQuery(),this.filterMaps[on.i.PROJECTS]=new Tn.a([new mg.a(on.i.PROJECTS)]),this.filterMaps[on.i.USERS_AND_GROUP]=new Tn.a([new mg.a(on.i.USERS_AND_GROUP)]),this.valuesData[on.i.PROJECTS]=new wn.a,this.valuesData[on.i.USERS_AND_GROUP]=new wn.a({options:Object(on.q)()}),this.roleService.roles$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.user.roles=e,this.initValuesFromUser(),this.setAllIndicators(),this.setIsProjectDirty(),this.setIsUserDirty(),this.setBackupValues(),this.cd.detectChanges()}),this.roleService.getRolesForUser(this.user.id),this.user.roles.forEach(e=>{"WORKSPACE_OWN"===e.role&&(this.isOwner=!0)})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}setBackupValues(){this.backupRoleData.isAdmin=this.isAdmin,this.backupRoleData.isProjectManager=this.isProjectManager,this.backupRoleData.isTeamManager=this.isTeamManager;for(const e in this.valuesData)e===on.i.USERS_AND_GROUP?(this.backupValuesData[on.k]=this.valuesData[e].getContainsFilter(on.k),this.backupValuesData[on.f]=this.valuesData[e].getContainsFilter(on.f)):this.backupValuesData[e]=this.valuesData[e].getContainsFilter(e)}checkIsChanged(){this.hasChanged=this.calculateIsChange()}calculateIsChange(){if(this.backupRoleData.isAdmin!==this.isAdmin)return!0;if(this.backupRoleData.isProjectManager!==this.isProjectManager)return!0;if(this.backupRoleData.isTeamManager!==this.isTeamManager)return!0;for(const e in this.valuesData)if(e===on.i.USERS_AND_GROUP){const t=this.backupValuesData[on.k],n=this.valuesData[e].getContainsFilter(on.k),i=this.backupValuesData[on.f],s=this.valuesData[e].getContainsFilter(on.f),c=wn.a.isContainsFiltersSame(n,t),a=wn.a.isContainsFiltersSame(s,i);if(!c||!a)return!0}else{const t=this.backupValuesData[e],n=this.valuesData[e].getContainsFilter(e);if(!wn.a.isContainsFiltersSame(n,t))return!0}return!1}initValuesFromUser(){if(this.user.refreshRoles(),this.isAdmin=this.user.isAdmin,this.isProjectManager=this.user.isProjectManager,this.isTeamManager=this.user.isTeamManager,this.isProjectManager){this.valuesData[on.i.PROJECTS].options.status=Rn.a.ALL;const e=b.a.getRoleEntities(this.user.roles,h.a.PROJECT_MANAGER);this.initialEntities[on.i.PROJECTS]=e,this.valuesData[on.i.PROJECTS].pushIds(on.i.PROJECTS,e.map(e=>e.entityId))}if(this.isTeamManager){this.valuesData[on.i.USERS_AND_GROUP].options.status=on.l.ALL;const e=b.a.getRoleEntities(this.user.roles,h.a.TEAM_MANAGER);this.initialEntities[on.i.USERS_AND_GROUP]=e.filter(e=>!e.source||e.source.id===e.entityId),this.valuesData[on.i.USERS_AND_GROUP].pushIds(on.k,e.filter(e=>!e.source).map(e=>e.entityId)),this.valuesData[on.i.USERS_AND_GROUP].pushIds(on.f,this.removeDuplicates(e.filter(e=>e.source).map(e=>e.source.id)))}}removeDuplicates(e){return e.filter((e,t,n)=>t===n.findIndex(t=>t===e))}setIsProjectDirty(){this.isProjectDirty=this.valuesData[on.i.PROJECTS].isDirty()}setIsUserDirty(){this.isUserDirty=this.valuesData[on.i.USERS_AND_GROUP].isDirty()}get isValid(){return!(this.isProjectManager&&!this.isProjectDirty||this.isTeamManager&&!this.isUserDirty)}getUsersAndUserGroups(){this.getUserGroups(),this.getUsers()}closeModal(){this.onClose.emit(!1)}save(){setTimeout(()=>{if(!this.isValid)return;const e=[];if(this.isAdmin){const t=new b.a({role:h.a.ADMIN});e.push(t)}if(this.isProjectManager){const t=new b.a({role:h.a.PROJECT_MANAGER,entity:this.valuesData[on.i.PROJECTS].getContainsFilter(on.i.PROJECTS)});e.push(t)}if(this.isTeamManager){const t=new b.a({role:h.a.TEAM_MANAGER,entity:this.valuesData[on.i.USERS_AND_GROUP].getContainsFilter(on.k)});e.push(t);const n=new b.a({role:h.a.TEAM_MANAGER,entity:this.valuesData[on.i.USERS_AND_GROUP].getContainsFilter(on.f)});n.entity.sourceType="USER_GROUP",e.push(n)}this.saveChanges(e)})}saveChanges(e){this.saveInProgress=!0,this.workspaceService.getLocalDefaultWorkspace().hasFeature(is.a.MANAGER_ROLE)?this.roleService.updateRoles(e,this.user.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.saveInProgress=!1,this.onSave.emit(e)},()=>this.saveInProgress=!1):this.updateAdminRole(e)}navToUpgrade(){this.closeModal(),this.router.navigate(["/upgrade"])}setAllIndicators(){if(this.valuesData)for(const e in this.filterMaps)this.generateIndicatorOf(e)}generateIndicatorOf(e){if(!this.initialEntities[e])return;const t=this.initialEntities[e];this.numberOfSelected[e]=t.length,t&&t.map(e=>e.name)}getProjects(e=this.query[on.i.PROJECTS]){if(this.reachedLimit[on.i.PROJECTS])return;const t=Object.assign({},e);t.status=this.valuesData[on.i.PROJECTS].options.status,this.setInProgressLoading(on.i.PROJECTS,!0),this.projectService.getProjects(t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{1===e.page&&this.filterMaps[on.i.PROJECTS].resetAll(),this.query[on.i.PROJECTS].page++;const n=this.transformResponse(t,"clientName","No client");for(const e in n)this.filterMaps[on.i.PROJECTS].pushToMap(e,n[e]);const i=t.length<e.limit;this.reachedLimit[on.i.PROJECTS]=i,i&&!e.name&&(this.counts[on.i.PROJECTS]=this.filterMaps[on.i.PROJECTS].count()),this.setInProgressLoading(on.i.PROJECTS,!1)},()=>this.setInProgressLoading(on.i.PROJECTS,!1))}loadMoreUsers(){this.query[on.i.USERS_AND_GROUP].page++,this.getUsersAndUserGroups()}get hideUserGroup(){const e=this.valuesData[on.i.USERS_AND_GROUP].options.status;return e===on.l.INACTIVE||e===on.l.PENDING}getUserGroups(e=this.query[on.i.USERS_AND_GROUP]){this.reachedLimit[on.f]||this.hideUserGroup||(this.setInProgressLoading(on.f,!0),this.userGroupV1Service.getUserGroups(e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(({groups:t,count:n})=>{const i=t.length,s=t.filter(e=>"Admins"!==e.name);t=s,!!e.name||this.userCount.set(on.f,n),1===e.page&&this.filterMaps[on.i.USERS_AND_GROUP].resetMap(on.f);const c={label:this.translate.instant("GLOBAL.GROUPS_LABEL")};this.filterMaps[on.i.USERS_AND_GROUP].unshiftToMap(on.f,t,c);const a=this.filterMaps[on.i.USERS_AND_GROUP].countSelectablesOf(on.f);this.reachedLimit[on.f]=a>=n||i<e.limit,this.setInProgressLoading(on.f,!1),this.cd.detectChanges()},()=>this.setInProgressLoading(on.f,!1)))}getUsers(e=this.query[on.i.USERS_AND_GROUP]){this.reachedLimit[on.k]||(e.statuses=this.valuesData[on.i.USERS_AND_GROUP].options.status,e.email=e.name,this.setInProgressLoading(on.k,!0),this.workspaceService.getReportsFilterTeamMembers(e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(({count:t,users:n})=>{!!e.name||this.userCount.set(on.k,t),1===e.page&&this.filterMaps[on.i.USERS_AND_GROUP].resetMap(on.k);const i={label:this.translate.instant("GLOBAL.USERS_LABEL")};this.filterMaps[on.i.USERS_AND_GROUP].pushToMap(on.k,n,i);const s=this.filterMaps[on.i.USERS_AND_GROUP].countSelectablesOf(on.k);this.reachedLimit[on.k]=s>=t||n.length<e.limit,this.setInProgressLoading(on.k,!1)},()=>this.setInProgressLoading(on.k,!1)))}transformResponse(e,t,n){const i={};return e.forEach(e=>{const s=e[t]||n;i[s]||(i[s]=[]),i[s].push(e)}),i}setInProgressLoading(e,t){this.inProgressLoading[e]=t,this.cd.markForCheck()}setInProgress(e,t=!1){this.inProgressSelectAll[e]=t,this.cd.markForCheck()}clearOptionFilter(e,t,n=!0){this.query[e].page=1,this.query[e].name=t.searchTerm,e===on.i.USERS_AND_GROUP?(this.reachedLimit[on.k]=!1,this.reachedLimit[on.f]=!1,n&&this.userCount.reset()):(this.reachedLimit[e]=!1,n&&(this.counts[e]=null))}onSearchChange(e,t){this.clearOptionFilter(e,{searchTerm:t},!1)}setIndicatorOf(e,{numberOfSelected:t,numberOfSelectedApproximately:n}){e===on.i.PROJECTS?this.setIsProjectDirty():this.setIsUserDirty(),this.numberOfSelected[e]=t||n,this.cd.markForCheck()}resetQuery(){this.query[on.i.USERS_AND_GROUP]={page:1,limit:In.f,name:""},this.query[on.i.PROJECTS]={page:1,limit:In.f,name:"",billable:TX.a.BOTH,sortColumn:IX.a.CLIENT_NAME},this.reachedLimit={}}selectAllUserIds(e){const t=on.i.USERS_AND_GROUP,n={status:this.valuesData[t].options.status,name:e.searchTerm};this.setInProgress(t,!0),this.userService.getUserIds(n).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(n=>this.setFilterIds(e,t,n),()=>this.setInProgress(t))}selectAllProjectIds(e,t){const n={status:this.valuesData[t].options.status,name:e.searchTerm};this.setInProgress(t,!0),this.projectService.getProjectIds(n).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(n=>this.setFilterIds(e,t,n),()=>this.setInProgress(t))}setFilterIds(e,t,n){let i=e.isSelected;this.valuesData[t].exclude&&(i=!i),this.valuesData[t].toggleMultipleIds(t,n,i),this.isOpenedMap[t]||this.generateIndicatorOf(t),this.setInProgress(t),this.checkIsChanged()}checkGroup(){this.hideUserGroup&&(this.filterMaps[on.i.USERS_AND_GROUP].removeMap(on.f),this.userCount.remove(on.f),this.valuesData[on.i.USERS_AND_GROUP].removeSingleKey(on.f))}updateAdminRole(e){(e.find(e=>e.role===h.a.ADMIN)?this.roleService.giveAdminRole(this.user.id):this.roleService.removeAdminRole(this.user.id)).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.saveInProgress=!1,this.onSave.emit(e)},()=>this.saveInProgress=!1)}addEventOnUpgrade(){this.analyticsService.addEvent(new Fi.a({event:"submit",uevent:"submit",value:"Standard",amount:"",section:"Team",section2:"Role",section3:"Manager Role",section4:"Upgrade"}))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.d),s.Rb(_n.a),s.Rb(l.a),s.Rb(Lc.a),s.Rb(s.h),s.Rb(E),s.Rb(N_.a),s.Rb(g.f),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["role-modal"]],inputs:{user:"user",hasManagerRoleFeature:"hasManagerRoleFeature",isCurrentOwner:"isCurrentOwner",isClickedRoleOwner:"isClickedRoleOwner"},outputs:{onClose:"onClose",onSave:"onSave",onInProgress:"onInProgress"},decls:41,vars:32,consts:[[1,"cl-modal-header"],["class","cl-modal-title cl-text-break",4,"ngIf"],["class","cl-modal-title",4,"ngIf"],["type","button",1,"cl-close","cl-px-3",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group","cl-col-md-12"],[1,"cl-custom-control","cl-custom-checkbox"],[4,"ngIf","ngIfElse"],["notOwner",""],["class","cl-mb-2",4,"ngIf"],[1,"cl-custom-control","cl-custom-checkbox","cl-z-index-2"],["type","checkbox","id","role-project-manager","tabindex","0",1,"cl-custom-control-input",3,"ngModel","disabled","ngModelChange"],["for","role-project-manager",1,"cl-custom-control-label"],[1,"cl-text-gray-9"],[4,"ngIf"],["type","checkbox","id","role-team-manager","tabindex","0",1,"cl-custom-control-input",3,"ngModel","disabled","ngModelChange"],["for","role-team-manager",1,"cl-custom-control-label"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["ngbAutofocus","","type","button",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[1,"cl-modal-title","cl-text-break"],[1,"cl-modal-title"],["type","checkbox","disabled","","ngbAutofocus","","id","role-owner","tabindex","0",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","role-owner",1,"cl-custom-control-label"],["type","checkbox","ngbAutofocus","","id","role-admin","tabindex","0",1,"cl-custom-control-input",3,"ngModel","disabled","ngModelChange"],["for","role-admin",1,"cl-custom-control-label"],[1,"cl-mb-2"],[1,"cl-btn",3,"click"],[1,"cl-d-report-filter-item"],["dropdownKey","","class","cl-dropdown cl-dropdown-large cl-d-flex cl-w-100",3,"onClose","onOpen",4,"ngIf"],["dropdownKey","",1,"cl-dropdown","cl-dropdown-large","cl-d-flex","cl-w-100",3,"onClose","onOpen"],[1,"cl-d-flex","cl-w-100"],["dropdownKeyButton","","tabindex","0","placement","bottom",1,"cl-dropdown"],["class","cl-badge cl-badge-filter","style","z-index: 1;",4,"ngIf"],[1,"cl-dropdown-item-label","cl-btn","cl-btn-outline-light","cl-w-100","cl-text-left","cl-dropdown-toggle","cl-cut-text","pointer"],["clickCloseDropdown","",1,"cl-flex-grow-1"],[3,"placeholder","filterName","countNumber","singleMapProperty","checkboxValues","selectableMaps","filterOptions","searchValue","inProgressSelectAll","inProgressLoading","onSelectAllWithTextInput","loadMore","onFilterOptionChange","onSearchChange","onCloseFilter","onChange",4,"dropdownKeyContent"],[1,"cl-badge","cl-badge-filter",2,"z-index","1"],[3,"placeholder","filterName","countNumber","singleMapProperty","checkboxValues","selectableMaps","filterOptions","searchValue","inProgressSelectAll","inProgressLoading","onSelectAllWithTextInput","loadMore","onFilterOptionChange","onSearchChange","onCloseFilter","onChange"],[3,"placeholder","preventOfflineFiltering","filterName","noResetOnFilterChange","checkboxValues","selectableMaps","filterOptions","searchValue","countMap","inProgressSelectAll","inProgressLoading","loadMore","onSelectAllWithTextInput","onSearchChange","onFilterOptionChange","onCloseFilter","onChange",4,"dropdownKeyContent"],[3,"placeholder","preventOfflineFiltering","filterName","noResetOnFilterChange","checkboxValues","selectableMaps","filterOptions","searchValue","countMap","inProgressSelectAll","inProgressLoading","loadMore","onSelectAllWithTextInput","onSearchChange","onFilterOptionChange","onCloseFilter","onChange"]],template:function(e,t){if(1&e&&(s.Xb(0,"div",0),s.Xc(1,LX,3,6,"h1",1),s.Xc(2,RX,3,3,"h1",2),s.Xb(3,"button",3),s.jc("click",(function(){return t.closeModal()})),s.Xb(4,"span"),s.Sb(5,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(6,"div",5),s.Xb(7,"div",6),s.Xb(8,"div",7),s.Xc(9,yX,8,7,"div",8),s.Xc(10,_X,7,8,"ng-template",null,9,s.Yc),s.Wb(),s.Sb(12,"hr"),s.Xc(13,kX,7,6,"div",10),s.Xb(14,"div"),s.Xb(15,"div",11),s.Xb(16,"input",12),s.jc("ngModelChange",(function(e){return t.isProjectManager=e}))("ngModelChange",(function(){return t.checkIsChanged()})),s.Wb(),s.Xb(17,"label",13),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Xb(20,"p",14),s.Zc(21),s.oc(22,"translate"),s.Wb(),s.Xc(23,DX,3,1,"ng-container",15),s.Wb(),s.Sb(24,"hr"),s.Xb(25,"div",7),s.Xb(26,"input",16),s.jc("ngModelChange",(function(e){return t.isTeamManager=e}))("ngModelChange",(function(){return t.checkIsChanged()})),s.Wb(),s.Xb(27,"label",17),s.Zc(28),s.oc(29,"translate"),s.Wb(),s.Xb(30,"p",14),s.Zc(31),s.oc(32,"translate"),s.Wb(),s.Xc(33,UX,3,1,"ng-container",15),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(34,"div",18),s.Xb(35,"a",19),s.jc("click",(function(){return t.closeModal()})),s.Zc(36),s.oc(37,"translate"),s.Wb(),s.Xb(38,"button",20),s.jc("click",(function(){return t.save()})),s.Zc(39),s.oc(40,"translate"),s.Wb(),s.Wb()),2&e){const e=s.Lc(11);s.Cb(1),s.wc("ngIf",t.user.name),s.Cb(1),s.wc("ngIf",!t.user.name),s.Cb(7),s.wc("ngIf",t.isClickedRoleOwner)("ngIfElse",e),s.Cb(4),s.wc("ngIf",!t.hasManagerRoleFeature),s.Cb(1),s.Hb("cl-disabled",!t.hasManagerRoleFeature),s.Cb(2),s.wc("ngModel",t.isProjectManager)("disabled",!t.hasManagerRoleFeature),s.Cb(2),s.bd(" ",s.pc(19,20,"TEAMS.MEMBERS.INFO.ROLE_TYPE.PM.TITLE")," "),s.Cb(3),s.ad(s.pc(22,22,"TEAMS.MEMBERS.INFO.ROLE_TYPE.PM.INFO_MESSAGE")),s.Cb(2),s.wc("ngIf",t.isProjectManager),s.Cb(3),s.wc("ngModel",t.isTeamManager)("disabled",!t.hasManagerRoleFeature),s.Cb(2),s.bd(" ",s.pc(29,24,"TEAMS.MEMBERS.INFO.ROLE_TYPE.TM.TITLE")," "),s.Cb(3),s.ad(s.pc(32,26,"TEAMS.MEMBERS.INFO.ROLE_TYPE.TM.INFO_MESSAGE")),s.Cb(2),s.wc("ngIf",t.isTeamManager),s.Cb(3),s.ad(s.pc(37,28,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",t.saveInProgress||!t.isValid||!t.hasChanged),s.Cb(1),s.bd(" ",s.pc(40,30,"GLOBAL.SAVE_LABEL")," ")}},directives:[i.u,v.a,v.s,v.v,To.a,ni.a,ii.a,si.a,Cg.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var xX=n("W8tW");const FX=["dropdownItems"],jX=function(){return["/upgrade"]},ZX=function(){return{plan:"basic"}};function VX(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",4),s.Xb(1,"info"),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",28),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.closeModal(),t.addEventOnUpgrade()})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,4,"WORKSPACE.FEATURE.MANY.BASIC"),""),s.Cb(2),s.wc("routerLink",s.Ac(8,jX))("queryParams",s.Ac(9,ZX)),s.Cb(1),s.ad(s.pc(6,6,"GLOBAL.UPGRADE_BTN")))}function YX(e,t){1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"TEAMS.MEMBERS.EDIT_PROFILE.DISABLED_REASON.WORKSPACE")," "))}function HX(e,t){1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"TEAMS.MEMBERS.EDIT_PROFILE.DISABLED_REASON.PENDING")," "))}function $X(e,t){1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"TEAMS.MEMBERS.EDIT_PROFILE.DISABLED_REASON.INACTIVE")," "))}function KX(e,t){if(1&e&&(s.Xb(0,"div",29),s.Xc(1,YX,3,3,"span",30),s.Xc(2,HX,3,3,"span",30),s.Xc(3,$X,3,3,"span",30),s.Wb()),2&e){const e=s.nc();s.wc("ngSwitch",e.disabledReason),s.Cb(1),s.wc("ngSwitchCase","WORKSPACE"),s.Cb(1),s.wc("ngSwitchCase","PENDING"),s.Cb(1),s.wc("ngSwitchCase","INACTIVE")}}function qX(e,t){1&e&&(s.Xb(0,"span",31),s.Xb(1,"a",32),s.oc(2,"translate"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(1),s.xc("ngbTooltip",s.pc(2,2,"TEAMS.MEMBERS.EDIT_PROFILE.CHANGE_EMAIL_TOOLTIP")),s.Cb(2),s.ad(s.pc(4,4,"GLOBAL.CHANGE_LABEL")))}function zX(e,t){if(1&e){const e=s.Yb();s.Xb(0,"span",33),s.Xb(1,"a",34,35),s.jc("click",(function(){s.Oc(e);const t=s.Lc(2),n=s.nc(),i=s.Lc(64);return t.blur(),n.openModal(i)}))("keyup.enter",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(64);return t.openModal(n)})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()}2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"GLOBAL.CHANGE_LABEL")," "))}function QX(e,t){if(1&e){const e=s.Yb();s.Xb(0,"modal-header",0),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"change-email",36),s.jc("onEmailSet",(function(t){return s.Oc(e),s.nc().emailChanged(t)}))("onClose",(function(){return t.$implicit.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,3,"USER_PROFILE.SETTINGS.EMAIL.CHANGE.TITLE")),s.Cb(2),s.wc("userId",e.userId)("doNotSubmit",!0)}}let JX=(()=>{class e{constructor(e,t,n,i,c,a,o){this.modalService=e,this.cd=t,this.authService=n,this.translate=i,this.memberProfileService=c,this.analyticsService=a,this.toaster=o,this.defaultWorkCapacity=7,this.isValid=!1,this.unsubscribe$=new Fn.a,this.onClose=new s.n,this.onSave=new s.n,this.onInProgress=new s.n}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}ngOnInit(){this.initializeDayOfWeek(),this.initializeMemberData()}initializeMemberData(){this.memberProfileService.getMemberProfile(this.userId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.originalProfileInfo=Object(sn.f)(e),this.name=e.name,this.email=e.email,this.weekStart=e.weekStart||ho.b.MONDAY,this.dropdownItems.setValue(this.weekStart,null,!1),this.initWorkCapacity(e.workCapacity),this.canChangePassword=e.hasPassword,this.workspaceNumber=e.workspaceNumber,this.hasPendingRequest=e.hasPendingApprovalRequest,this.disabledReason=this.getDisabledReason(),this.cd.detectChanges()})}nameChanged(){this.shouldUpdateName()&&(""!=this.name&&(this.isValid=!0),this.request=Object.assign(Object.assign({},this.request),{name:this.name}))}shouldUpdateName(){return this.name!==this.originalProfileInfo.name&&!this.disabledReason}emailChanged(e){this.email=e,this.shouldUpdateEmail()&&(this.isValid=!0,this.request=Object.assign(Object.assign({},this.request),{email:this.email}),this.toaster.pop("success",this.translate.instant("SERVICES.AUTHENTIFICATION.EMAIL.CHANGE.SUCCESS_MESSAGE.TITLE"),this.translate.instant("SERVICES.AUTHENTIFICATION.EMAIL.CHANGE.SUCCESS_MESSAGE.SUBTITLE")))}shouldUpdateEmail(){return this.email!==this.originalProfileInfo.email&&!this.disabledReason&&this.canChangePassword}openModal(e){this.modalService.open(e,{beforeDismiss:()=>!this.inProgress,centered:!0})}workCapacityChanged(){this.workCapacity||(this.workCapacity=7),this.shouldUpdateWorkCapacity()&&(this.isValid=!0,this.workCapacity.toString().indexOf(",")>-1&&(this.workCapacity=parseFloat(this.workCapacity.toString().replace(",","."))),this.request=Object.assign(Object.assign({},this.request),{workCapacity:Object(ke.duration)(this.workCapacity,"h").toISOString()}))}shouldUpdateWorkCapacity(){return this.workCapacity!==this.originalProfileInfo.workCapacity}weekStartChanged(e){this.weekStart=e,this.shouldUpdateWeekStart()&&(this.isValid=!0,this.request=Object.assign(Object.assign({},this.request),{weekStart:this.weekStart}))}shouldUpdateWeekStart(){return this.reasonInitialized&&this.weekStart!==this.originalProfileInfo.weekStart&&!this.disabledReason&&!this.hasPendingRequest}closeModal(){this.onClose.emit(!1)}save(){this.inProgress=!0,this.onInProgress.emit(!0),this.memberProfileService.updateMemberProfile(this.userId,this.request).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.inProgress=!1,this.onSave.emit(e.name),this.updateUserIfCurrent()},()=>{this.inProgress=!1,this.onInProgress.emit(!1)}),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"Save",section:"Team",section2:"Edit member profile"}))}initializeDayOfWeek(){this.dayOfWeek=[new Ea.a("MONDAY","TEAMS.REMINDERS.WEEKDAYS.MONDAY"),new Ea.a("TUESDAY","TEAMS.REMINDERS.WEEKDAYS.TUESDAY"),new Ea.a("WEDNESDAY","TEAMS.REMINDERS.WEEKDAYS.WEDNESDAY"),new Ea.a("THURSDAY","TEAMS.REMINDERS.WEEKDAYS.THURSDAY"),new Ea.a("FRIDAY","TEAMS.REMINDERS.WEEKDAYS.FRIDAY"),new Ea.a("SATURDAY","TEAMS.REMINDERS.WEEKDAYS.SATURDAY"),new Ea.a("SUNDAY","TEAMS.REMINDERS.WEEKDAYS.SUNDAY")]}getDisabledReason(){return this.reasonInitialized=!0,this.hasEditMemberProfileFeature?"PENDING"===this.status?"PENDING":"INACTIVE"===this.status?"INACTIVE":this.workspaceNumber>1&&this.authService.getUser().id!==this.userId?"WORKSPACE":void 0:null}updateUserIfCurrent(){if(this.authService.getUser().id==this.userId&&(this.shouldUpdateWeekStart()||this.shouldUpdateName())){const e=this.authService.getUser();e.settings.weekStart=this.weekStart,e.name=this.name,this.authService.saveUserAndEmit(e)}}initWorkCapacity(e){this.workCapacity=e||this.defaultWorkCapacity,e||this.addDefaultWorkCapacityToRequest()}addDefaultWorkCapacityToRequest(){this.request=Object.assign(Object.assign({},this.request),{workCapacity:Object(ke.duration)(this.workCapacity,"h").toISOString()}),this.isValid=!0}addEventOnUpgrade(){this.analyticsService.addEvent(new Fi.a({event:"submit",value:"Basic",Section:"Team",section2:"Edit member profile",section4:"Upgrade"}))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q),s.Rb(s.h),s.Rb(re.a),s.Rb(g.f),s.Rb(xX.a),s.Rb(xi.a),s.Rb(r.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["profile-modal"]],viewQuery:function(e,t){var n;1&e&&s.gd(FX,!0),2&e&&s.Kc(n=s.kc())&&(t.dropdownItems=n.first)},inputs:{userId:"userId",status:"status",hasEditMemberProfileFeature:"hasEditMemberProfileFeature"},outputs:{onClose:"onClose",onSave:"onSave",onInProgress:"onInProgress"},decls:65,vars:68,consts:[[3,"title","onClose"],[1,"cl-modal-body"],["class","cl-form-group",4,"ngIf"],["class","cl-alert cl-alert-info cl-fade cl-show cl-text-break","role","alert",3,"ngSwitch",4,"ngIf"],[1,"cl-form-group"],[1,"cl-h2","cl-mb-0"],[1,"cl-text-gray-9"],["type","text","tabindex","0",1,"cl-form-control",3,"ngModel","disabled","change","keyup.enter","ngModelChange"],["userNameInput",""],[1,"cl-input-group"],["type","email","autocomplete","off","readonly","",1,"cl-form-control","cl-cut-text",3,"ngModel"],[1,"cl-input-group-append"],["class","cl-input-group-text",4,"ngIf"],["class","cl-input-group-text cl-bg-white",4,"ngIf"],[1,"cl-mt-0"],[1,"cl-text-gray-9","cl-w-lg-75"],[3,"list","value","isDisabled","ngbTooltip","onChanged"],["dropdownItems",""],[1,"cl-row","cl-align-items-center","cl-justify-content-start"],[1,"cl-col-4"],[1,"cl-form-group","cl-m-0"],["type","text","inputNumber","","tabindex","0",1,"cl-form-control","cl-w-100","cl-input-5-digits",3,"ngModel","decimal","change","keyup.enter","ngModelChange"],["workCapacityInput",""],[1,"cl-col-5"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue","cl-no-outline",3,"keyup.enter","click"],["type","button","tabindex","0",1,"cl-btn","cl-btn-primary",3,"disabled","click"],["changeEmailModal",""],[1,"cl-btn",3,"routerLink","queryParams","click"],["role","alert",1,"cl-alert","cl-alert-info","cl-fade","cl-show","cl-text-break",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"cl-input-group-text"],["placement","bottom",1,"cl-color-blue","cl-disabled-not-allowed",3,"ngbTooltip"],[1,"cl-input-group-text","cl-bg-white"],["tabindex","0",1,"cl-color-blue",3,"click","keyup.enter"],["emailBtn",""],[3,"userId","doNotSubmit","onEmailSet","onClose"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"modal-header",0),s.jc("onClose",(function(){return t.closeModal()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"div",1),s.Xc(3,VX,7,10,"div",2),s.Xc(4,KX,4,4,"div",3),s.Xb(5,"div",4),s.Xb(6,"div",5),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Xb(9,"div",6),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Wb(),s.Xb(12,"div",4),s.Xb(13,"label"),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Xb(16,"input",7,8),s.jc("change",(function(){return t.nameChanged()}))("keyup.enter",(function(){return s.Oc(e),s.Lc(17).blur()}))("ngModelChange",(function(e){return t.name=e})),s.Wb(),s.Wb(),s.Xb(18,"div",4),s.Xb(19,"label"),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Xb(22,"div",9),s.Sb(23,"input",10),s.Xb(24,"div",11),s.Xc(25,qX,5,6,"span",12),s.Xc(26,zX,5,3,"span",13),s.Wb(),s.Wb(),s.Wb(),s.Sb(27,"hr",14),s.Xb(28,"div",4),s.Xb(29,"div",5),s.Zc(30),s.oc(31,"translate"),s.Wb(),s.Xb(32,"div",15),s.Zc(33),s.oc(34,"translate"),s.Wb(),s.Wb(),s.Xb(35,"div",4),s.Xb(36,"dropdown-items",16,17),s.jc("onChanged",(function(e){return t.weekStartChanged(e)})),s.oc(38,"translate"),s.Wb(),s.Wb(),s.Sb(39,"hr",14),s.Xb(40,"div",4),s.Xb(41,"div",5),s.Zc(42),s.oc(43,"translate"),s.Wb(),s.Xb(44,"div",15),s.Zc(45),s.oc(46,"translate"),s.Wb(),s.Wb(),s.Xb(47,"div",18),s.Xb(48,"div",19),s.Xb(49,"div",20),s.Xb(50,"input",21,22),s.jc("change",(function(){return t.workCapacityChanged()}))("keyup.enter",(function(){return s.Oc(e),s.Lc(51).blur()}))("ngModelChange",(function(e){return t.workCapacity=e})),s.Wb(),s.Wb(),s.Wb(),s.Xb(52,"div",23),s.Xb(53,"span"),s.Zc(54),s.oc(55,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(56,"div",24),s.Xb(57,"a",25),s.jc("keyup.enter",(function(){return t.closeModal()}))("click",(function(){return t.closeModal()})),s.Zc(58),s.oc(59,"translate"),s.Wb(),s.Xb(60,"button",26),s.jc("click",(function(){return t.save()})),s.Zc(61),s.oc(62,"translate"),s.Wb(),s.Wb(),s.Xc(63,QX,3,5,"ng-template",null,27,s.Yc)}2&e&&(s.xc("title",s.pc(1,42,"TEAMS.MEMBERS.EDIT_PROFILE.TITLE")),s.Cb(3),s.wc("ngIf",!t.hasEditMemberProfileFeature),s.Cb(1),s.wc("ngIf",!!t.disabledReason),s.Cb(1),s.Hb("disable-area",!t.hasEditMemberProfileFeature||!!t.disabledReason),s.Cb(2),s.ad(s.pc(8,44,"USER_PROFILE.SETTINGS.PERSONAL.TITLE")),s.Cb(3),s.bd(" ",s.pc(11,46,"TEAMS.MEMBERS.EDIT_PROFILE.PERSONAL_INFO_MESSAGE")," "),s.Cb(2),s.Hb("disable-area",!t.hasEditMemberProfileFeature||!!t.disabledReason),s.Cb(2),s.ad(s.pc(15,48,"GLOBAL.NAME_LABEL")),s.Cb(2),s.wc("ngModel",t.name)("disabled",!!t.disabledReason),s.Cb(2),s.Hb("disable-area",!t.hasEditMemberProfileFeature||!!t.disabledReason),s.Cb(2),s.ad(s.pc(21,50,"GLOBAL.EMAIL_LABEL")),s.Cb(3),s.wc("ngModel",t.email),s.Cb(2),s.wc("ngIf",!t.canChangePassword),s.Cb(1),s.wc("ngIf",t.canChangePassword),s.Cb(2),s.Hb("disable-area",!t.hasEditMemberProfileFeature||!!t.disabledReason),s.Cb(2),s.ad(s.pc(31,52,"USER_PROFILE.SETTINGS.TIME_SETTINGS.WEEK.START")),s.Cb(3),s.bd(" ",s.pc(34,54,"TEAMS.MEMBERS.EDIT_PROFILE.WEEK_START_INFO_MESSAGE")," "),s.Cb(2),s.Hb("disable-area",!t.hasEditMemberProfileFeature||!!t.disabledReason),s.Cb(1),s.xc("ngbTooltip",t.hasPendingRequest?s.pc(38,56,"TEAMS.MEMBERS.EDIT_PROFILE.WEEK_START_TOOLTIP"):""),s.wc("list",t.dayOfWeek)("value",t.weekStart)("isDisabled",!!t.disabledReason||t.hasPendingRequest),s.Cb(4),s.Hb("disable-area",!t.hasEditMemberProfileFeature),s.Cb(2),s.ad(s.pc(43,58,"TEAMS.MEMBERS.EDIT_PROFILE.WORK_CAPACITY.TITLE")),s.Cb(3),s.bd(" ",s.pc(46,60,"TEAMS.MEMBERS.EDIT_PROFILE.WORK_CAPACITY.INFO_MESSAGE")," "),s.Cb(4),s.Hb("disable-area",!t.hasEditMemberProfileFeature),s.Cb(1),s.wc("ngModel",t.workCapacity)("decimal",!0),s.Cb(2),s.Hb("disable-area",!t.hasEditMemberProfileFeature),s.Cb(2),s.ad(s.pc(55,62,"TEAMS.MEMBERS.EDIT_PROFILE.WORK_CAPACITY.LABEL")),s.Cb(4),s.ad(s.pc(59,64,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",!t.hasEditMemberProfileFeature||!t.isValid),s.Cb(1),s.bd(" ",s.pc(62,66,"GLOBAL.SAVE_LABEL")," "))},directives:[Wd.a,i.u,v.c,v.s,v.v,ji.a,w.bb,jr.a,To.a,k.g,i.y,i.z,GI],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function eN(e,t){1&e&&s.Tb(0)}function tN(e,t){if(1&e&&(s.Xb(0,"div",18),s.Xb(1,"span",19),s.Zc(2),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Wc("text-decoration","INACTIVE"==e.membershipStatus?"line-through":""),s.Cb(1),s.xc("title",e.getUserName()),s.Cb(1),s.ad(e.getUserName())}}function nN(e,t){if(1&e&&(s.Xb(0,"div",20),s.Xb(1,"span",19),s.Zc(2),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.xc("title",e.user.email),s.Cb(1),s.ad(e.user.email)}}function iN(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",28),s.Xb(1,"span",29),s.Xb(2,"a",30),s.jc("click",(function(){s.Oc(e);const t=s.nc(3),n=s.Lc(26);return t.openModal(n,"md")})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(3),s.ad(s.pc(4,1,"GLOBAL.CHANGE_LABEL")))}function sN(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",23),s.Xb(1,"div",24),s.Xb(2,"input",25,26),s.jc("keyup.enter",(function(){return s.Oc(e),s.Lc(3).blur()})),s.Wb(),s.Xc(4,iN,5,3,"div",27),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.wc("ngModel",e.hourlyRatePlaceholder),s.Cb(2),s.wc("ngIf",e.isCurrentUserAdminOrOwner)}}function cN(e,t){if(1&e&&(s.Xb(0,"div",21),s.Xc(1,sN,5,2,"div",22),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.canSeeRates)}}function aN(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",28),s.Xb(1,"span",29),s.Xb(2,"a",30),s.jc("click",(function(){s.Oc(e);const t=s.nc(3),n=s.Lc(28);return t.openModal(n,"md")})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(3),s.ad(s.pc(4,1,"GLOBAL.CHANGE_LABEL")))}function oN(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",32),s.Xb(1,"div",24),s.Xb(2,"input",33,34),s.jc("keyup.enter",(function(){return s.Oc(e),s.Lc(3).blur()})),s.Wb(),s.Xc(4,aN,5,3,"div",27),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.wc("ngModel",e.costRatePlaceholder),s.Cb(2),s.wc("ngIf",e.isCurrentUserAdminOrOwner)}}function rN(e,t){if(1&e&&s.Xc(0,oN,5,2,"div",31),2&e){const e=s.nc();s.wc("ngIf",e.canSeeRates&&e.hasHistoricRatesFeature&&!!e.workspace&&e.workspace.isCostRateActive)}}function lN(e,t){if(1&e&&(s.Xb(0,"span",41),s.oc(1,"translate"),s.Zc(2),s.oc(3,"translate"),s.Wb()),2&e){const e=s.nc(3);s.Hb("pointer",e.isOwner),s.xc("title",s.pc(1,4,"TEAMS.MEMBERS.INFO.ROLE_TYPE.PM.TITLE")),s.Cb(2),s.ad(s.pc(3,6,"TEAMS.MEMBERS.INFO.ROLE_TYPE.PM.TITLE"))}}function bN(e,t){if(1&e&&(s.Xb(0,"span",41),s.oc(1,"translate"),s.Zc(2),s.oc(3,"translate"),s.Wb()),2&e){const e=s.nc(3);s.Hb("pointer",e.isOwner),s.xc("title",s.pc(1,4,"TEAMS.MEMBERS.INFO.ROLE_TYPE.TM.TITLE")),s.Cb(2),s.ad(s.pc(3,6,"TEAMS.MEMBERS.INFO.ROLE_TYPE.TM.TITLE"))}}function dN(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"span",39),s.oc(2,"translate"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xc(5,lN,4,8,"span",40),s.Xc(6,bN,4,8,"span",40),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.Hb("pointer",e.isOwner),s.xc("title",s.pc(2,6,"GLOBAL.OWNER_LABEL")),s.Cb(2),s.ad(s.pc(4,8,"GLOBAL.OWNER_LABEL")),s.Cb(2),s.wc("ngIf",e.user.isProjectManager),s.Cb(1),s.wc("ngIf",e.user.isTeamManager)}}function uN(e,t){if(1&e&&(s.Xb(0,"span",39),s.oc(1,"translate"),s.Zc(2),s.oc(3,"translate"),s.Wb()),2&e){const e=s.nc(3);s.Hb("pointer",e.isCurrentUserAdminOrOwner),s.xc("title",s.pc(1,4,"GLOBAL.ADMIN_LABEL")),s.Cb(2),s.ad(s.pc(3,6,"GLOBAL.ADMIN_LABEL"))}}function pN(e,t){if(1&e&&(s.Xb(0,"span",41),s.oc(1,"translate"),s.Zc(2),s.oc(3,"translate"),s.Wb()),2&e){const e=s.nc(3);s.Hb("pointer",e.isCurrentUserAdminOrOwner),s.xc("title",s.pc(1,4,"TEAMS.MEMBERS.INFO.ROLE_TYPE.PM.TITLE")),s.Cb(2),s.ad(s.pc(3,6,"TEAMS.MEMBERS.INFO.ROLE_TYPE.PM.TITLE"))}}function hN(e,t){if(1&e&&(s.Xb(0,"span",41),s.oc(1,"translate"),s.Zc(2),s.oc(3,"translate"),s.Wb()),2&e){const e=s.nc(3);s.Hb("pointer",e.isCurrentUserAdminOrOwner),s.xc("title",s.pc(1,4,"TEAMS.MEMBERS.INFO.ROLE_TYPE.TM.TITLE")),s.Cb(2),s.ad(s.pc(3,6,"TEAMS.MEMBERS.INFO.ROLE_TYPE.TM.TITLE"))}}function mN(e,t){1&e&&(s.Xb(0,"span"),s.Xb(1,"span",46),s.Zc(2,"-"),s.Wb(),s.Wb())}function gN(e,t){if(1&e&&(s.Xb(0,"a",44),s.Sb(1,"img",45),s.Xb(2,"span",46),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xc(5,mN,3,0,"span",47),s.Wb()),2&e){const e=s.nc(3);s.Cb(3),s.ad(s.pc(4,2,"GLOBAL.ROLE_LABEL")),s.Cb(2),s.wc("ngIf",!e.isCurrentUserAdminOrOwner&&e.user.isRegular)}}function EN(e,t){if(1&e&&(s.Xc(0,uN,4,8,"span",42),s.Xc(1,pN,4,8,"span",40),s.Xc(2,hN,4,8,"span",40),s.Xc(3,gN,6,4,"a",43)),2&e){const e=s.nc(2);s.wc("ngIf",e.user.isAdmin),s.Cb(1),s.wc("ngIf",e.user.isProjectManager),s.Cb(1),s.wc("ngIf",e.user.isTeamManager),s.Cb(1),s.wc("ngIf",e.isCurrentUserAdminOrOwner&&e.user.isRegular)}}function fN(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",35),s.Xb(1,"span",36),s.jc("click",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(30);return t.openModalDecider(n,t.user)})),s.Xc(2,dN,7,10,"ng-container",37),s.Xc(3,EN,4,4,"ng-template",null,38,s.Yc),s.Wb(),s.Wb()}if(2&e){const e=s.Lc(4),t=s.nc();s.Cb(2),s.wc("ngIf",t.user.id==t.ownerId)("ngIfElse",e)}}function SN(e,t){if(1&e){const e=s.Yb();s.Xb(0,"members-dropdown",48),s.jc("userAndUserGroups",(function(t){return s.Oc(e),s.nc().closeEditTeamDropdown(t)})),s.Wb()}if(2&e){const e=s.nc();s.Hb("pointer",e.isCurrentUserAdminOrOwner),s.wc("isAdminOrOwner",e.isCurrentUserAdminOrOwner)("selectedEntityName",e.userGroupNames)("userGroupIds",e.userGroupIds)("mode","userGroups")}}function CN(e,t){1&e&&(s.Xb(0,"a",50),s.Sb(1,"img",45),s.Xb(2,"span",51),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.ad(s.pc(4,1,"GLOBAL.GROUP_LABEL")))}function AN(e,t){if(1&e&&s.Xc(0,CN,5,3,"a",49),2&e){const e=s.nc();s.wc("ngIf",e.isCurrentUserAdminOrOwner)}}function ON(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"button",62),s.jc("click",(function(){s.Oc(e);const t=s.nc(4),n=s.Lc(32);return t.openModal(n,"mg")})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Ub()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"TEAMS.MEMBERS.EDIT_PROFILE.TITLE")," "))}function vN(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",63),s.jc("click",(function(){s.Oc(e);const t=s.nc(4),n=s.Lc(20);return t.openModal(n)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"TEAMS.MEMBERS.INFO.ROLE_TYPE.OWNER.TRANSFER")," "))}function TN(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"button",62),s.jc("click",(function(){s.Oc(e);const t=s.nc(4);return t.resendInvite(t.user.id)})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Ub()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"TEAMS.MEMBERS.ADD.INVITE_EMAIL")," "))}function IN(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",64),s.jc("click",(function(){s.Oc(e);const t=s.nc(4);return t.changeMembershipStatus(t.user)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc(4);s.Cb(1),s.bd(" ",s.pc(2,1,e.changeStatusText)," ")}}function wN(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",65),s.jc("click",(function(){s.Oc(e);const t=s.nc(4),n=s.Lc(24);return!t.user.name&&t.getInviteLink(n)})),s.oc(1,"translate"),s.Zc(2),s.oc(3,"translate"),s.Wb()}if(2&e){const e=s.nc(4);s.wc("placement","left")("ngClass",e.user.name?"cl-opacity-5 cl-cursor-default":"")("ngbTooltip",e.user.name?s.pc(1,5,"TEAMS.MEMBERS.ADD.ERROR_MESSAGE.HAS_ACCOUNT"):""),s.Db("clickCloseDropdown",e.user.name?null:""),s.Cb(2),s.bd(" ",s.pc(3,7,"TEAMS.MEMBERS.INVITE_LINK.COPY")," ")}}function LN(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"button",62),s.jc("click",(function(){s.Oc(e);const t=s.nc(4),n=s.Lc(32);return t.openModal(n,"mg")})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Ub()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"TEAMS.MEMBERS.EDIT_PROFILE.TITLE")," "))}function RN(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"button",66),s.jc("click",(function(){s.Oc(e);const t=s.nc(4),n=s.Lc(22);return t.openModal(n)})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Ub()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"GLOBAL.REMOVE_USER_TITLE")," "))}function yN(e,t){if(1&e&&(s.Xb(0,"div",57),s.Xb(1,"div",58),s.Xc(2,ON,4,3,"ng-container",47),s.Xc(3,vN,3,3,"button",59),s.Xc(4,TN,4,3,"ng-container",47),s.Xc(5,IN,3,3,"button",60),s.Xc(6,wN,4,9,"button",61),s.Xc(7,LN,4,3,"ng-container",47),s.Xc(8,RN,4,3,"ng-container",47),s.Wb(),s.Wb()),2&e){const e=s.nc(3);s.Cb(2),s.wc("ngIf",e.canEditMemberProfile()&&"ACTIVE"===e.membershipStatus),s.Cb(1),s.wc("ngIf",e.showRegularSettings()&&"ACTIVE"==e.membershipStatus&&e.currentUserId===e.ownerId),s.Cb(1),s.wc("ngIf",e.showRegularSettings()&&e.ownerId!==e.user.id&&e.canResend),s.Cb(1),s.wc("ngIf",e.showRegularSettings()&&"PENDING"!==e.membershipStatus&&(!e.user.isAdmin||e.currentUserId===e.ownerId)),s.Cb(1),s.wc("ngIf",e.showRegularSettings()&&"PENDING"===e.membershipStatus),s.Cb(1),s.wc("ngIf",e.canEditMemberProfile()&&("PENDING"===e.membershipStatus||"INACTIVE"===e.membershipStatus)),s.Cb(1),s.wc("ngIf",e.showRegularSettings()&&e.canDelete())}}const _N=function(e){return{"cl-dropdown-toggle":e}};function kN(e,t){if(1&e&&(s.Xb(0,"div",53),s.Xb(1,"div",54),s.Sb(2,"img",55),s.Wb(),s.Xc(3,yN,9,7,"div",56),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngClass",s.Bc(1,_N,e.isCurrentUserAdminOrOwner))}}function WN(e,t){if(1&e&&s.Xc(0,kN,4,3,"div",52),2&e){const e=s.nc();s.wc("ngIf",e.showRegularSettings()||e.canEditMemberProfile())}}function XN(e,t){if(1&e&&(s.Xb(0,"transfer-owner-role",67),s.jc("onClose",(function(){return t.$implicit.close()})),s.Wb()),2&e){const e=s.nc();s.wc("user",e.user)}}function NN(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",68),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().removeConfirmed(n)}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",69),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,5,"GLOBAL.REMOVE_USER_TITLE"))("btnText",s.pc(2,7,"GLOBAL.REMOVE_LABEL"))("isDanger",!0)("inProgress",e.inProgress),s.Cb(4),s.bd("",s.pc(5,9,"GLOBAL.REMOVE_INFO_MESSAGE")," ")}}function DN(e,t){if(1&e&&(s.Xb(0,"invite-link",70),s.jc("onClose",(function(){return t.$implicit.close()})),s.Wb()),2&e){const e=s.nc();s.wc("url",e.invitationCode)}}function PN(e,t){if(1&e){const e=s.Yb();s.Xb(0,"hourly-rate",71),s.jc("onClose",(function(){return t.$implicit.close()}))("saveRate",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().updateHourlyRate(n),i.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("user",e.user)("type",e.rateType.WORKSPACE_MEMBER)("hourlyRate",e.hourlyRate)("hasHistoricRateFeature",e.hasHistoricRatesFeature)}}function MN(e,t){if(1&e){const e=s.Yb();s.Xb(0,"cost-rate",72),s.jc("onClose",(function(){return t.$implicit.close()}))("saveRate",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().updateCostRate(n),i.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("user",e.user)("type",e.rateType.WORKSPACE_MEMBER)("costRate",e.costRate)("hasHistoricRateFeature",e.hasHistoricRatesFeature)}}function BN(e,t){if(1&e){const e=s.Yb();s.Xb(0,"role-modal",73),s.jc("onInProgress",(function(t){return s.Oc(e),s.nc().inProgressRole=t}))("onSave",(function(n){s.Oc(e);const i=t.$implicit,c=s.nc();return c.user.roles=n,c.closeModal(i)}))("onClose",(function(){s.Oc(e);const n=t.$implicit;return s.nc().closeModal(n)})),s.Wb()}if(2&e){const e=s.nc();s.wc("user",e.user)("isCurrentOwner",e.isCurrentUserOwner())("isClickedRoleOwner",e.isClickedUserOwner)("hasManagerRoleFeature",e.hasManagerRoleFeature)}}function UN(e,t){if(1&e){const e=s.Yb();s.Xb(0,"profile-modal",74),s.jc("onClose",(function(){s.Oc(e);const n=t.$implicit;return s.nc().closeModal(n)}))("onSave",(function(n){s.Oc(e);const i=t.$implicit,c=s.nc();return c.updateName(n),c.closeModal(i)}))("onInProgress",(function(t){return s.Oc(e),s.nc().inProgressProfile=t})),s.Wb()}if(2&e){const e=s.nc();s.wc("userId",e.user.id)("status",e.membershipStatus)("hasEditMemberProfileFeature",e.hasEditMemberProfileFeature)}}const GN=function(e){return{labels:e}},xN=function(e,t,n,i){return[e,t,n,i]},FN=function(e,t,n,i,s){return[e,t,n,i,s]},jN=function(e,t,n,i,s,c,a){return[e,t,n,i,s,c,a]};let ZN=(()=>{class e{constructor(e,t,n,i,c,a,o){this.modalService=e,this.accountsUsersService=t,this.cd=n,this.userGroupService=i,this.workspaceService=c,this.authService=a,this.translate=o,this.onDeleted=new s.n,this.seatsTaken=new s.n,this.userGroupNames=[],this.memberships=[],this.canResend=!1,this.shouldOpen=!1,this.unsubscribe$=new p.a,this.allUserGroupIds=[],this.UGlist=[],this.selectedUgs=[],this.userGroupIds=[],this.userGroupsToRemove=[],this.userGroupsToAdd=[],this.allUserGroupNames=[],this.showRate=!1,this.focus=!1,this.rateType=po.a,this.hourlyRate=new QW.a,this.costRate=new JW.a,this.isClickedUserOwner=!1}set groupsRequiredForRowLabel(e){this._groupsRequiredForRowLabel=e,this.filterNames()}get groupsRequiredForRowLabel(){return this._groupsRequiredForRowLabel}ngOnInit(){this.translations=this.translate.instant("GLOBAL.ACTIVATE_LABEL"),this.cd.detectChanges(),this.filterNames(),this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e,this.activeBillable=this.workspace.activeBillableHours}),this.getHourlyRateForTeamMember(),this.canResendInvite(),this.setCostRateLabel(),this.setHourlyRateLabel(),this.cd.detectChanges(),this.activeBillable=this.workspace.activeBillableHours,this.isOwner=this.isCurrentUserOwner(),this.user.id===this.ownerId&&Array.from(document.querySelectorAll(".cl-badge")).forEach(e=>e.addEventListener("click",e=>{this.isClickedUserOwner=!0}))}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}getInviteLink(e){this.user.name||this.authService.getInvitationLink(this.user.id,this.workspace.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.invitationCode=JSON.parse(t).link,this.openModal(e)})}showRegularSettings(){return(this.currentUserId===this.ownerId||!this.user.isAdmin)&&this.ownerId!==this.user.id&&this.isCurrentUserAdminOrOwner&&this.currentUserId!==this.user.id}canDelete(){return this.membershipStatus!=Xc.a.ACTIVE&&!(this.user.isAdmin&&this.ownerId!=this.currentUserId)}isCurrentUserOwner(){return this.currentUserId===this.ownerId}openModalDecider(e,t){this.isCurrentUserOwner()&&this.isClickedUserOwner&&this.openModal(e,"md"),this.isCurrentUserAdminOrOwner&&this.user.id!==this.ownerId&&this.openModal(e,"md")}displayRate(){this.showRate=!0,this.focus=!0}setCostRateLabel(){this.costRatePlaceholder=Object(sn.m)(this.costRate)}setHourlyRateLabel(){this.hourlyRatePlaceholder=Object(sn.n)(this.hourlyRate)}getHourlyRateForTeamMember(){if(!this.user)return null;const e=this.user.memberships.filter(e=>e.targetId===this.workspace.id)[0];return this.hourlyRate.amount=null===e.hourlyRate?0:e.hourlyRate.amount/100,this.costRate.amount=e.costRate&&e.costRate.amount/100,this.costRate.currency=this.workspace.costRate.currency,this.hourlyRate.currency=this.workspace.hourlyRate.currency,this.cd.detectChanges(),null}filterNames(){this.userGroupNames=[],this.groupsRequiredForRowLabel.filter(e=>e.userIds.indexOf(this.user.id)>-1).forEach(e=>this.userGroupNames.push(e.name)),this.userGroupIds=this.groupsRequiredForRowLabel.filter(e=>e.userIds.indexOf(this.user.id)>-1).map(e=>e.id),this.cd.detectChanges()}openModal(e,t="lg"){this.modalService.open(e,{beforeDismiss:()=>!this.inProgressRole&&!this.inProgressProfile,size:t,centered:!0})}closeModal(e){this.inProgressRole||this.inProgressProfile||(this.inProgressRole=!1,this.inProgressProfile=!1,e.close())}updateHourlyRate(e){const t=new QW.a({amount:e.amount?e.amount:0,currency:this.workspace.hourlyRate.currency||"USD",since:e.since});this.user.id&&(this.hourlyRate.amount=t.amount,this.workspaceService.setHourlyRateForUserId(this.user.id,t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.setHourlyRateLabel(),this.cd.markForCheck()}))}updateCostRate(e){const t=new JW.a({amount:null!==e.amount?e.amount:null,currency:this.workspace.hourlyRate.currency||"USD",since:e.since});this.user.id&&(this.costRate.amount=t.amount,this.workspaceService.setCostRateForUser(this.user.id,t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.setCostRateLabel(),this.cd.markForCheck()}))}canResendInvite(){const e=this.user.memberships.filter(e=>e.targetId===this.workspace.id)[0];this.membershipStatus=e.membershipStatus,this.canResend=e.membershipStatus==Xc.a.PENDING,this.changeStatusText=e.membershipStatus==Xc.a.INACTIVE?"GLOBAL.ACTIVATE_LABEL":"TEAMS.MEMBERS.DEACTIVATE_LABEL",this.cd.detectChanges()}changeMembershipStatus(e){if(this.membershipStatus==Xc.a.ACTIVE)this.workspaceService.setStatus(e.id,eX.a.INACTIVE),this.membershipStatus=Xc.a.INACTIVE,this.changeStatusText="GLOBAL.ACTIVATE_LABEL",this.user.memberships.filter(e=>e.targetId===this.workspace.id)[0].membershipStatus="3";else{if(this.isAllSeatsTaken&&this.workspace.featureSubscriptionType&&mo.a[this.workspace.featureSubscriptionType].bySeat)return void this.seatsTaken.emit(!0);this.workspaceService.setStatus(e.id,eX.a.ACTIVE),this.membershipStatus=Xc.a.ACTIVE,this.changeStatusText="TEAMS.MEMBERS.DEACTIVATE_LABEL",this.user.memberships.filter(e=>e.targetId===this.workspace.id)[0].membershipStatus="1"}this.cd.detectChanges()}resendInvite(e){this.workspaceService.resendInvite(e)}removeConfirmed(e){this.inProgress||(this.inProgress=!0,this.accountsUsersService.removeUserAccount(this.user.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.onDeleted.emit(),this.inProgress=!1,this.workspaceService.getDefaultWorkspace(),e.close()},()=>{this.inProgress=!1,this.cd.detectChanges()}))}getUserName(){return this.membershipStatus==Xc.a.PENDING?this.doesHaveAName():this.isCurrentUser()}doesHaveAName(){const e=this.translate.instant("GLOBAL.PENDING_USER_LABEL");return this.user.name?`${this.user.name} ${e}`:""+e}isCurrentUser(){const e=this.translate.instant("TEAMS.CURRENT_USER_LABEL");return this.user.id===this.currentUserId?`${this.user.name} ${e}`:this.user.name}closeEditTeamDropdown(e){this.transformMapsToIdsUpdate(e),this.closeAllDropdowns()}transformMapsToIdsUpdate(e){this.updateUserGroupIds(e.userGroups.ids)}updateUserGroupIds(e){if(this.userGroupIds.indexOf("everyone")>-1)this.userGroupNames=this.allUserGroupNames,this.userGroupIds=this.allUserGroupIds;else{const t=this.userGroupIds;this.userGroupIds=[],e&&(this.userGroupIds=e),this.userGroupsToRemove=t.filter(t=>!(null==e?void 0:e.includes(t))),this.userGroupsToAdd=this.userGroupIds}}closeAllDropdowns(){const e=[];e.push(this.user.id),this.userGroupsToAdd.length>0&&this.userGroupService.addUserToUserGroup(this.userGroupsToAdd,e),this.userGroupsToRemove.length>0&&this.userGroupService.removeUserFromUserGroup(this.userGroupsToRemove,e),this.shouldOpen=!1}updateName(e){this.inProgressProfile=!1,this.user.name!==e&&(this.user.name=e,this.cd.detectChanges())}canEditMemberProfile(){return!(this.ownerId===this.user.id&&!this.isOwner)&&this.isCurrentUserAdminOrOwner}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q),s.Rb(H),s.Rb(s.h),s.Rb(WL.a),s.Rb(l.a),s.Rb(re.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["members-row"],["","members-row",""]],inputs:{isCurrentUserAdminOrOwner:"isCurrentUserAdminOrOwner",isDesktop:"isDesktop",user:"user",labels:"labels",ownerId:"ownerId",showGroup:"showGroup",isOwner:"isOwner",currentUserId:"currentUserId",expandAll:"expandAll",canSeeRates:"canSeeRates",activeBillable:"activeBillable",hasManagerRoleFeature:"hasManagerRoleFeature",hasHistoricRatesFeature:"hasHistoricRatesFeature",hasEditMemberProfileFeature:"hasEditMemberProfileFeature",isAllSeatsTaken:"isAllSeatsTaken",groupsRequiredForRowLabel:"groupsRequiredForRowLabel"},outputs:{onDeleted:"onDeleted",seatsTaken:"seatsTaken"},decls:33,vars:39,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cl-d-none",3,"isDesktop","isExpanded","templates"],["responsive",""],["col1",""],["col2",""],["col3",""],["col4",""],["col5",""],["col6",""],["noUserGroups",""],["col7",""],["transferOwnerRoleModal",""],["removeModal",""],["inviteLink",""],["hourlyRateModal",""],["costRateModal",""],["roleModal",""],["profileModal",""],[1,"cl-d-inline-flex","cl-cut-text-wrapper","cl-w-100","cl-py-0","cl-py-lg-custom-2","cl-pl-lg-2","cl-pl-lg-custom-0","cl-pr-2"],[1,"cl-cut-text",3,"title"],[1,"cl-component-divided-left","cl-cursor-default","cl-d-flex","cl-justify-content-start"],[1,"cl-d-flex","cl-flex-column","cl-flex-lg-row"],["class","cl-component-divided-left cl-team-table-members-billable-rate",4,"ngIf"],[1,"cl-component-divided-left","cl-team-table-members-billable-rate"],[1,"cl-input-group","cl-input-group-sm"],["type","text","name","hourlyRate","spellcheck","false","inputNumber","","autocomplete","off","readonly","",1,"cl-form-control","cl-text-lg-left","tr-reset-min-h","cl-cursor-disabled",3,"ngModel","keyup.enter"],["hourlyRateInput",""],["class","cl-input-group-append",4,"ngIf"],[1,"cl-input-group-append"],[1,"cl-input-group-text","cl-bg-white"],[1,"cl-color-blue",3,"click"],["class","cl-component-divided-left cl-team-table-members-cost-rate",4,"ngIf"],[1,"cl-component-divided-left","cl-team-table-members-cost-rate"],["type","text","name","costRate","spellcheck","false","inputNumber","","autocomplete","off","readonly","",1,"cl-form-control","cl-text-lg-left","tr-reset-min-h","cl-cursor-disabled",3,"ngModel","keyup.enter"],["costRateInput",""],[1,"cl-component-divided-left","cl-cut-text-wrapper","cl-w-100"],[1,"cl-w-100","cl-d-flex",3,"click"],[4,"ngIf","ngIfElse"],["notOwnerTemplate",""],[1,"cl-badge","cl-badge-tag","cl-bg-primary","cl-text-white","cl-mr-1",3,"title"],["class","cl-badge cl-badge-tag cl-mr-1 cl-cut-text",3,"pointer","title",4,"ngIf"],[1,"cl-badge","cl-badge-tag","cl-mr-1","cl-cut-text",3,"title"],["class","cl-badge cl-badge-tag cl-bg-primary cl-text-white cl-mr-1",3,"pointer","title",4,"ngIf"],["class","cl-d-flex cl-color-blue cl-align-items-center pointer",4,"ngIf"],[1,"cl-d-flex","cl-color-blue","cl-align-items-center","pointer"],["src","assets/images/ui-icons/plus-blue.svg"],[1,"cl-ml-2"],[4,"ngIf"],[3,"isAdminOrOwner","selectedEntityName","userGroupIds","mode","userAndUserGroups"],["class","cl-d-flex pointer",4,"ngIf"],[1,"cl-d-flex","pointer"],[1,"cl-ml-2","cl-color-blue"],["class","cl-dropdown cl-d-flex cl-justify-content-end","dropdownKey","",4,"ngIf"],["dropdownKey","",1,"cl-dropdown","cl-d-flex","cl-justify-content-end"],["dropdownKeyButton","","tabindex","0",1,"cl-component-divided-left","cl-component-divided-left-reset-divider","position-relative","cl-justify-content-center","cl-d-flex","cl-no-arrow","pointer",3,"ngClass"],["src","assets/images/ui-icons/menu-dots-vertical.svg"],["class","cl-dropdown-menu cl-dropdown-position-laptop cl-dropdown-menu-right",4,"dropdownKeyContent"],[1,"cl-dropdown-menu","cl-dropdown-position-laptop","cl-dropdown-menu-right"],[1,"cl-scroll-area"],["class","cl-dropdown-item","clickCloseDropdown","","data-cy","transfer",3,"click",4,"ngIf"],["class","cl-dropdown-item","clickCloseDropdown","","data-cy","deactivate",3,"click",4,"ngIf"],["class","cl-dropdown-item","data-cy","copy-invite-link",3,"placement","ngClass","ngbTooltip","click",4,"ngIf"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"click"],["clickCloseDropdown","","data-cy","transfer",1,"cl-dropdown-item",3,"click"],["clickCloseDropdown","","data-cy","deactivate",1,"cl-dropdown-item",3,"click"],["data-cy","copy-invite-link",1,"cl-dropdown-item",3,"placement","ngClass","ngbTooltip","click"],["clickCloseDropdown","","data-cy","remove-user",1,"cl-dropdown-item","cl-text-danger",3,"click"],[3,"user","onClose"],[3,"title","btnText","isDanger","inProgress","confirmed","close"],[1,"cl-mb-0"],[3,"url","onClose"],[3,"user","type","hourlyRate","hasHistoricRateFeature","onClose","saveRate"],[3,"user","type","costRate","hasHistoricRateFeature","onClose","saveRate"],[3,"user","isCurrentOwner","isClickedRoleOwner","hasManagerRoleFeature","onInProgress","onSave","onClose"],[3,"userId","status","hasEditMemberProfileFeature","onClose","onSave","onInProgress"]],template:function(e,t){if(1&e&&(s.Xc(0,eN,1,0,"ng-container",0),s.Sb(1,"responsive-row",1,2),s.Xc(3,tN,3,4,"ng-template",null,3,s.Yc),s.Xc(5,nN,3,2,"ng-template",null,4,s.Yc),s.Xc(7,cN,2,1,"ng-template",null,5,s.Yc),s.Xc(9,rN,1,1,"ng-template",null,6,s.Yc),s.Xc(11,fN,5,2,"ng-template",null,7,s.Yc),s.Xc(13,SN,1,6,"ng-template",null,8,s.Yc),s.Xc(15,AN,1,1,"ng-template",null,9,s.Yc),s.Xc(17,WN,1,1,"ng-template",null,10,s.Yc),s.Xc(19,XN,1,1,"ng-template",null,11,s.Yc),s.Xc(21,NN,6,11,"ng-template",null,12,s.Yc),s.Xc(23,DN,1,1,"ng-template",null,13,s.Yc),s.Xc(25,PN,1,4,"ng-template",null,14,s.Yc),s.Xc(27,MN,1,4,"ng-template",null,15,s.Yc),s.Xc(29,BN,1,4,"ng-template",null,16,s.Yc),s.Xc(31,UN,1,3,"ng-template",null,17,s.Yc)),2&e){const e=s.Lc(2),n=s.Lc(4),i=s.Lc(6),c=s.Lc(8),a=s.Lc(10),o=s.Lc(12),r=s.Lc(14),l=s.Lc(18);s.wc("ngTemplateOutlet",e.template)("ngTemplateOutletContext",s.Bc(5,GN,t.labels)),s.Cb(1),s.wc("isDesktop",t.isDesktop)("isExpanded",t.expandAll)("templates",t.activeBillable||t.isCurrentUserAdminOrOwner?t.activeBillable&&!t.isCurrentUserAdminOrOwner?s.Ec(12,xN,n,i,o,r):!t.activeBillable&&t.isCurrentUserAdminOrOwner?s.Fc(17,FN,n,i,o,r,l):s.Hc(t.isCurrentUserAdminOrOwner&&t.activeBillable?23:31,jN,n,i,c,a,o,r,l):s.Ec(7,xN,n,i,o,r))}},directives:[i.B,Ei.a,i.u,v.c,jr.a,v.s,v.v,AX,ni.a,ii.a,i.r,si.a,w.bb,OX,Si.a,vX,wo.a,Lo.a,GX,JX],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();const VN=["captchaElem"];function YN(e,t){1&e&&(s.Xb(0,"div",20),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"TEAMS.MEMBERS.ADD.ERROR_MESSAGE.VALID")," "))}function HN(e,t){if(1&e&&(s.Xb(0,"div",20),s.Xb(1,"strong"),s.Zc(2),s.Wb(),s.Zc(3),s.oc(4,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.ad(e.emails.errors.invalidEmails),s.Cb(1),s.bd(" ",s.pc(4,2,"TEAMS.MEMBERS.ADD.ERROR_MESSAGE.NOT_VALID.MANY")," ")}}function $N(e,t){if(1&e&&(s.Xb(0,"div",20),s.Xb(1,"strong"),s.Zc(2),s.Wb(),s.Zc(3),s.oc(4,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.ad(e.emails.errors.invalidEmail),s.Cb(1),s.bd(" ",s.pc(4,2,"TEAMS.MEMBERS.ADD.ERROR_MESSAGE.NOT_VALID.ONE")," ")}}function KN(e,t){if(1&e&&(s.Xb(0,"div",20),s.Xb(1,"strong"),s.Zc(2),s.Wb(),s.Zc(3),s.oc(4,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.ad(e.emails.errors.duplicatedEmails),s.Cb(1),s.bd(" ",s.pc(4,2,"TEAMS.MEMBERS.ADD.ERROR_MESSAGE.INVITED.MANY")," ")}}function qN(e,t){if(1&e&&(s.Xb(0,"div",20),s.Xb(1,"strong"),s.Zc(2),s.Wb(),s.Zc(3),s.oc(4,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.ad(e.emails.errors.duplicatedEmail),s.Cb(1),s.bd(" ",s.pc(4,2,"TEAMS.MEMBERS.ADD.ERROR_MESSAGE.INVITED.ONE")," ")}}function zN(e,t){if(1&e&&(s.Vb(0,18),s.Xc(1,YN,3,3,"div",19),s.Xc(2,HN,5,4,"div",19),s.Xc(3,$N,5,4,"div",19),s.Xc(4,KN,5,4,"div",19),s.Xc(5,qN,5,4,"div",19),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.emails.errors.required),s.Cb(1),s.wc("ngIf",e.emails.errors.invalidEmails),s.Cb(1),s.wc("ngIf",e.emails.errors.invalidEmail),s.Cb(1),s.wc("ngIf",e.emails.errors.duplicatedEmails),s.Cb(1),s.wc("ngIf",e.emails.errors.duplicatedEmail)}}function QN(e,t){if(1&e&&(s.Xb(0,"small",21),s.Zc(1),s.oc(2,"translate"),s.oc(3,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",e.captchaActive?s.pc(2,1,"TEAMS.MEMBERS.ADD.INFO_MESSAGE.UP_TO_5"):s.pc(3,3,"TEAMS.MEMBERS.ADD.INFO_MESSAGE.MULTIPLE")," ")}}function JN(e,t){if(1&e){const e=s.Yb();s.Xb(0,"form",23),s.Xb(1,"ngx-recaptcha2",24,25),s.jc("reset",(function(){return s.Oc(e),s.nc(2).handleReset()}))("expire",(function(){return s.Oc(e),s.nc(2).handleExpire()}))("load",(function(){return s.Oc(e),s.nc(2).handleLoad()}))("success",(function(t){return s.Oc(e),s.nc(2).handleSuccess(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.wc("formGroup",e.aFormGroup),s.Cb(1),s.wc("siteKey",e.googleCaptchaSiteKey)}}function eD(e,t){if(1&e&&(s.Xb(0,"div"),s.Xc(1,JN,3,2,"form",22),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.captchaActive&&e.googleCaptchaSiteKey)}}let tD=(()=>{class e{constructor(e,t,n,i){this.formBuilder=e,this.workspaceService=t,this.systemSettingsService=n,this.analyticsService=i,this.emailsInvited=new s.n,this.onClose=new s.n,this.onAdded=new s.n,this.googleCaptchaSiteKey=bo.a.environment.googleCaptchaSiteKey,this.unsubscribe$=new Fn.a,this.sendEmail=!0}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.aFormGroup=this.formBuilder.group({recaptcha:["",v.G.required]});const e=(this.autofillEmails||[]).join(", ")||"";var t;this.emailsFormGroup=this.formBuilder.group({emails:[e,[v.G.required]]},{validator:(t=this.filteredUsersToShow,e=>{const n=e.controls.emails;let i=n.value.replace(/,/g," ").split(" ");i=i.map(e=>e.trim().toLowerCase()).filter(e=>!!e),i=i.filter((e,t,n)=>n.indexOf(e)===t);const s=t?t.map(e=>e.email.toLowerCase()):[];let c=[],a=[];i.forEach(e=>{s.indexOf(e)>-1&&c.push(e),Object(sn.A)(e)||a.push(e)}),c=c.map(e=>"'"+e+"'"),a=a.map(e=>"'"+e+"'");const o={};n.getError("required")&&(o.required=!0),1===c.length?o.duplicatedEmail=c[0]:c.length>1&&(o.duplicatedEmails=c.join(" ,")),1===a.length?o.invalidEmail=a[0]:a.length>1&&(o.invalidEmails=a.join(" ,")),n.setErrors(a.length||c.length||o.required?o:null)})}),this.workspaceService.payment.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.captchaActive=!e.paid,this.gotResponse=!0}),this.systemSettingsService.systemSettings.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{e.specialFeaturesActivated&&this.isAdmin?this.workspaceService.getPaymentDate():this.gotResponse=!0}),this.systemSettingsService.getSystemSettings()}get emails(){return this.emailsFormGroup.get("emails")}get emailsInvalid(){return this.emails.dirty&&this.emails.touched&&!!this.emails.errors}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}closeModal(){this.onClose.emit(!0)}handleReset(){this.captchaValue=""}handleExpire(){this.captchaValue=""}handleLoad(){}handleSuccess(e){this.captchaValue=e}get isCaptchaValid(){return!(this.captchaActive&&!this.captchaValue)}inviteUser(){if(!this.isCaptchaValid||this.emailsFormGroup.invalid||this.inProgress)return;let e=this.emails.value.replace(/,/g," ").split(" ");e=e.map(e=>e.trim().toLowerCase()).filter(e=>!!e),e=e.filter((e,t,n)=>n.indexOf(e)===t),this.inProgress=!0,this.workspaceService.inviteUsers(e,null,this.captchaValue,this.sendEmail).subscribe(()=>{this.onAdded.emit(),this.inProgress=!1,this.workspaceService.getDefaultWorkspace(),this.closeModal(),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"add",amount:null==e?void 0:e.length,section:"Team",section2:"Members",section3:"Add member by email"}))},()=>{this.captchaElem&&this.captchaElem.resetCaptcha(),this.inProgress=!1})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(v.f),s.Rb(l.a),s.Rb(bn.a),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["add-members"]],viewQuery:function(e,t){var n;1&e&&s.gd(VN,!0),2&e&&s.Kc(n=s.kc())&&(t.captchaElem=n.first)},inputs:{filteredUsersToShow:"filteredUsersToShow",isAdmin:"isAdmin",autofillEmails:"autofillEmails"},outputs:{emailsInvited:"emailsInvited",onClose:"onClose",onAdded:"onAdded"},decls:29,vars:28,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group","cl-mb-0",3,"formGroup","ngSubmit"],["ngbAutofocus","","formControlName","emails",1,"cl-form-control",3,"placeholder","keyup.enter"],["input",""],["class","cl-mt-1",4,"ngIf"],["class","cl-form-text cl-text-gray-9 cl-mt-1",4,"ngIf"],[1,"cl-custom-control","cl-custom-checkbox","cl-mt-3"],["type","checkbox","id","sendEmail",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","sendEmail",1,"cl-custom-control-label","cl-color-gray"],[4,"ngIf"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","button",1,"cl-btn","cl-btn-primary",3,"disabled","title","click"],[1,"cl-mt-1"],["class","cl-invalid-feedback",4,"ngIf"],[1,"cl-invalid-feedback"],[1,"cl-form-text","cl-text-gray-9","cl-mt-1"],["class","cl-mt-3",3,"formGroup",4,"ngIf"],[1,"cl-mt-3",3,"formGroup"],["formControlName","recaptcha",3,"siteKey","reset","expire","load","success"],["captchaElem",""]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.closeModal()})),s.Xb(5,"span",3),s.Sb(6,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",5),s.Xb(8,"form",6),s.jc("ngSubmit",(function(){return t.inviteUser()})),s.Xb(9,"input",7,8),s.jc("keyup.enter",(function(){s.Oc(e);const t=s.Lc(10);return t.blur(),t.focus()})),s.oc(11,"translate"),s.Wb(),s.Xc(12,zN,6,5,"ng-container",9),s.Xc(13,QN,4,5,"small",10),s.Wb(),s.Xb(14,"div",11),s.Xb(15,"input",12),s.jc("ngModelChange",(function(e){return t.sendEmail=e})),s.Wb(),s.Xb(16,"label",13),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb(),s.Xc(19,eD,2,1,"div",14),s.Wb(),s.Xb(20,"div",15),s.Xb(21,"a",16),s.jc("click",(function(){return t.closeModal()})),s.Zc(22),s.oc(23,"translate"),s.Wb(),s.Xb(24,"button",17),s.jc("click",(function(){return t.inviteUser()})),s.oc(25,"translate"),s.oc(26,"translate"),s.Zc(27),s.oc(28,"translate"),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.ad(s.pc(3,14,"TEAMS.MEMBERS.ADD.TITLE")),s.Cb(6),s.wc("formGroup",t.emailsFormGroup),s.Cb(1),s.Hb("cl-is-invalid",t.emailsInvalid),s.xc("placeholder",s.pc(11,16,"TEAMS.MEMBERS.ADD.PLACEHOLDER")),s.Cb(3),s.wc("ngIf",t.emailsInvalid),s.Cb(1),s.wc("ngIf",t.gotResponse),s.Cb(2),s.wc("ngModel",t.sendEmail),s.Cb(2),s.ad(s.pc(18,18,"TEAMS.MEMBERS.ADD.INVITE_EMAIL")),s.Cb(2),s.wc("ngIf",t.gotResponse),s.Cb(3),s.ad(s.pc(23,20,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",!t.isCaptchaValid||t.emailsFormGroup.invalid||t.inProgress)("title",t.isCaptchaValid?s.pc(25,22,"GLOBAL.SUBMIT"):s.pc(26,24,"TEAMS.MEMBERS.ADD.ERROR_MESSAGE.RECAPTCHA")),s.Cb(3),s.bd(" ",s.pc(28,26,"GLOBAL.ADD_LABEL")," "))},directives:[v.I,v.t,v.k,v.c,v.s,v.i,i.u,v.a,v.v,K.b],pipes:[g.e],encapsulation:2}),e})();const nD=["plusButton"];function iD(e,t){1&e&&(s.Xb(0,"div",22),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"SUBSCRIPTION_TABS.USER_SEATS.ADD_SEATS_LABEL")))}const sD=function(e){return{count:e}};function cD(e,t){if(1&e&&(s.Xb(0,"div"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.ad(s.qc(2,1,"SUBSCRIPTION_TABS.USER_SEATS.SEATS_OF_COUNT_LABEL",s.Bc(4,sD,e.unusedSeats)))}}function aD(e,t){if(1&e&&(s.Xb(0,"div",23),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.cd("x $",e.amount?e.amount:e.currentType.fullPrice," ",s.pc(2,2,e.isMonthly(e.currentType.value)?"SUBSCRIPTION_TABS.USER_SEATS.PER_SEAT_MONTH_LABEL":"SUBSCRIPTION_TABS.USER_SEATS.PER_SEAT_YEAR_LABEL"),"")}}function oD(e,t){1&e&&(s.Xb(0,"div",24),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"SUBSCRIPTION_TABS.USER_SEATS.REMOVE_SEAT_NO_REFUND_WARNING")," "))}function rD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",9),s.Xb(1,"div",10),s.Xc(2,iD,3,3,"div",11),s.Xb(3,"div",12),s.Xb(4,"div",13),s.Xb(5,"a",14,15),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.quantity=t.quantity==t.defaultQuantity?t.quantity:t.quantity-1})),s.Xb(7,"strong"),s.Zc(8,"-"),s.Wb(),s.Wb(),s.Wb(),s.Sb(9,"input",16),s.Xb(10,"div",17),s.Xb(11,"a",18),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.quantity=t.isAdd||t.quantity!=t.unusedSeats?t.quantity+1:t.quantity})),s.Xb(12,"strong"),s.Zc(13,"+"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(14,cD,3,6,"div",19),s.Xc(15,aD,3,4,"div",20),s.Wb(),s.Xc(16,oD,3,3,"div",21),s.Wb()}if(2&e){const e=s.nc();s.Hb("cl-d-flex",e.isAdd),s.Cb(1),s.Hb("cl-mb-3",!e.isAdd),s.Cb(1),s.wc("ngIf",e.isAdd),s.Cb(7),s.wc("ngModel",e.quantity),s.Cb(5),s.wc("ngIf",!e.isAdd),s.Cb(1),s.wc("ngIf",e.isAdd),s.Cb(1),s.wc("ngIf",!e.isAdd)}}function lD(e,t){1&e&&(s.Xb(0,"div",28),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"SUBSCRIPTION_TABS.USER_SEATS.PRICE_CHANGE_WARNING")," "))}function bD(e,t){if(1&e&&(s.Xb(0,"div"),s.Xb(1,"div",29),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"span",30),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Xb(7,"div",29),s.Zc(8),s.oc(9,"translate"),s.Xb(10,"span",30),s.Zc(11),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.bd(" ",s.pc(3,4,"SUBSCRIPTION_TABS.USER_SEATS.NUMBER_OF_ADDITIONAL_SEATS_LABEL_PART_1")," "),s.Cb(3),s.ad(s.qc(6,6,"SUBSCRIPTION_TABS.USER_SEATS.NUMBER_OF_ADDITIONAL_SEATS_LABEL_PART_2",s.Bc(11,sD,e.quantity))),s.Cb(3),s.bd(" ",s.pc(9,9,"SUBSCRIPTION_TABS.USER_SEATS.EST_PRICE_LABEL")," "),s.Cb(3),s.bd("$",e.price,"")}}function dD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",31),s.Xb(1,"input",32),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc(2).agreement=t})),s.Wb(),s.Xb(2,"label",33),s.Xb(3,"span",34),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"span",35),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(1),s.wc("ngModel",e.agreement),s.Cb(3),s.ad(s.pc(5,3,"GLOBAL.TOS_READ")),s.Cb(3),s.ad(s.pc(8,5,"GLOBAL.REFUNDS_EXPLANATION"))}}function uD(e,t){if(1&e&&(s.Xb(0,"div",9),s.Xc(1,lD,3,3,"div",25),s.Xc(2,bD,12,13,"div",19),s.Xb(3,"div",26),s.Xc(4,dD,9,7,"div",27),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.isAdd&&e.confirm),s.Cb(1),s.wc("ngIf",e.confirm),s.Cb(2),s.wc("ngIf",e.isAdd&&e.confirm)}}function pD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",36),s.jc("click",(function(){return s.Oc(e),s.nc().previewPrice()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("disabled",e.quantity<1||e.inProgress),s.Cb(1),s.ad(s.pc(2,2,"GLOBAL.NEXT_LABEL"))}}function hD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",36),s.jc("click",(function(){return s.Oc(e),s.nc().save()})),s.Zc(1),s.oc(2,"translate"),s.oc(3,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("disabled",e.quantity<1||e.inProgress||e.isAdd&&!e.agreement),s.Cb(1),s.ad(e.isAdd?s.pc(2,2,"SUBSCRIPTION_TABS.USER_SEATS.PAY_SAVE_BTN"):s.pc(3,4,"GLOBAL.SAVE_LABEL"))}}let mD=(()=>{class e{constructor(e,t,n){this.paymentService=e,this.loader=t,this.analyticsService=n,this.unusedSeats=0,this.currentQuantity=0,this.closeModal=new s.n,this.saveQuantity=new s.n,this.agreement=!1,this.unsubscribe$=new Fn.a,this.isMonthly=mo.h,this.defaultQuantity=0,this.quantity=1}close(){this.closeModal.emit(!0)}save(){this.quantity>0&&this.saveQuantity.emit(this.quantity)}ngAfterViewInit(){setTimeout(()=>{this.plusButton.nativeElement.focus()})}ngOnInit(){this.activeUsers>this.currentQuantity&&(this.defaultQuantity=this.activeUsers-this.currentQuantity,this.quantity=this.defaultQuantity)}previewPrice(){this.loader.show(),this.paymentService.previewPriceOnlyQuantity(this.quantity+this.currentQuantity).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.loader.hide(),this.price=e.price,this.analyticsService.addEvent(new Fi.a({event:"submit",amount:this.quantity,section:"Subscription",section2:"User seats",section3:"Buy more seats"})),this.confirm=!0})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(dC.a),s.Rb(Hn.a),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["user-seats-modal"]],viewQuery:function(e,t){var n;1&e&&s.gd(nD,!0),2&e&&s.Kc(n=s.kc())&&(t.plusButton=n.first)},inputs:{isAdd:"isAdd",activeUsers:"activeUsers",unusedSeats:"unusedSeats",currentQuantity:"currentQuantity",currentType:"currentType",amount:"amount",inProgress:"inProgress"},outputs:{closeModal:"closeModal",saveQuantity:"saveQuantity"},decls:15,vars:10,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],["class","cl-modal-body",3,"cl-d-flex",4,"ngIf"],["class","cl-modal-body",4,"ngIf"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"click"],["type","button","class","cl-btn cl-btn-primary","tabindex","0",3,"disabled","click",4,"ngIf"],[1,"cl-modal-body"],[1,"cl-d-flex","cl-align-items-center","cl-flex-column","cl-flex-sm-row"],["class","cl-text-gray-3 cl-w-50 cl-mr-2",4,"ngIf"],[1,"cl-input-group","cl-mr-1","cl-pl-4","cl-my-2","cl-my-sm-0"],[1,"cl-input-group-prepend"],["tabindex","0","ngbAutofocus","",1,"cl-btn","cl-btn-outline-light","cl-text-primary","cl-min-width-40",3,"click"],["plusButton",""],["readonly","","min","0",1,"cl-form-control","cl-input-seats","cl-cursor-disabled",3,"ngModel"],[1,"cl-input-group-append"],["tabindex","0",1,"cl-btn","cl-btn-outline-light","cl-text-primary","cl-min-width-40",3,"click"],[4,"ngIf"],["class","cl-text-gray-9 cl-w-50",4,"ngIf"],["class","cl-alert cl-alert-warning cl-w-100 cl-mb-0",4,"ngIf"],[1,"cl-text-gray-3","cl-w-50","cl-mr-2"],[1,"cl-text-gray-9","cl-w-50"],[1,"cl-alert","cl-alert-warning","cl-w-100","cl-mb-0"],["class","cl-alert cl-alert-warning cl-w-100 cl-mb-0 cl-px-2",4,"ngIf"],[1,"cl-d-flex","cl-align-items-center","cl-mt-3","cl-flex-column","cl-flex-sm-row"],["class","cl-custom-control cl-custom-checkbox cl-custom-control-inline",4,"ngIf"],[1,"cl-alert","cl-alert-warning","cl-w-100","cl-mb-0","cl-px-2"],[1,"cl-mt-2","cl-text-gray-3"],[1,"cl-h2"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline"],["type","checkbox","id","agreementCheckbox",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","agreementCheckbox",1,"cl-custom-control-label"],[1,"cl-font-weight-bold"],[1,"cl-color-grey","cl-d-block"],["type","button","tabindex","0",1,"cl-btn","cl-btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.close()})),s.Xb(5,"span"),s.Sb(6,"img",3),s.Wb(),s.Wb(),s.Wb(),s.Xc(7,rD,17,9,"div",4),s.Xc(8,uD,5,3,"div",5),s.Xb(9,"div",6),s.Xb(10,"a",7),s.jc("click",(function(){return t.close()})),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xc(13,pD,3,4,"button",8),s.Xc(14,hD,4,6,"button",8),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,6,t.isAdd?"SUBSCRIPTION_TABS.USER_SEATS.BUY_SEATS_TITLE":"SUBSCRIPTION_TABS.USER_SEATS.REMOVE_SEATS_TITLE")),s.Cb(5),s.wc("ngIf",!t.confirm),s.Cb(1),s.wc("ngIf",t.confirm),s.Cb(3),s.ad(s.pc(12,8,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("ngIf",!t.confirm&&t.isAdd),s.Cb(1),s.wc("ngIf",t.confirm||!t.isAdd))},directives:[i.u,v.c,v.s,v.v,v.a],pipes:[g.e],encapsulation:2}),e})();const gD=["subscriptionFailedModal"],ED=["addMembersModal"],fD=["allSeatsTaken"];function SD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"dropdown-items",19),s.jc("onChanged",(function(t){return s.Oc(e),s.nc().changeGroupShow(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("list",e.statuses)("value",e.pagination.status)}}function CD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"button",20),s.jc("click",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(19),i=s.Lc(21);return t.openAddMemberModal(n,i)})),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"span",21),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.wc("disabled",!e.isLoaded),s.Cb(1),s.bd(" ",s.pc(3,4,"GLOBAL.ADD_LABEL")," "),s.Cb(3),s.ad(s.pc(6,6,"GLOBAL.NEW_LABEL_PART")),s.Cb(2),s.bd(" ",s.pc(8,8,"GLOBAL.LOCATION_COLUMN_AND_SENTENCE_PART"),"")}}function AD(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"tr",25),s.jc("onDeleted",(function(){s.Oc(e);const n=t.index;return s.nc(2).onDeleted(n)}))("seatsTaken",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(19),i=s.Lc(21);return t.activatingMember=!0,t.openAddMemberModal(n,i)})),s.Wb(),s.Ub()}if(2&e){const e=t.$implicit,n=s.nc(2);s.Cb(1),s.wc("labels",n.labels)("user",e)("ownerId",n.ownerId)("isDesktop",n.isDesktop)("showGroup",n.groupToShow)("isOwner",n.isOwner)("isCurrentUserAdminOrOwner",n.isAdminOrOwner)("canSeeRates",n.canSeeRates)("activeBillable",n.workspace.activeBillableHours)("currentUserId",n.currentUserId)("expandAll",n.expandAll)("hasManagerRoleFeature",n.hasManagerRoleFeature)("hasHistoricRatesFeature",n.hasHistoricRatesFeature)("hasEditMemberProfileFeature",n.hasEditMemberProfileFeature)("isAllSeatsTaken",n.quantity<=n.activeMembersLength)("groupsRequiredForRowLabel",n.groupsRequiredForRowLabel)}}function OD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"table",22),s.Xb(1,"thead"),s.Xb(2,"tr",23),s.jc("onChangeSortOrder",(function(){return s.Oc(e),s.nc().changeSortOrder()}))("onChangeSortColumn",(function(t){return s.Oc(e),s.nc().changeSortColumn(t)}))("onExpandAll",(function(t){return s.Oc(e),s.nc().expandAllRows(t)})),s.Wb(),s.Wb(),s.Xb(3,"tbody"),s.Xc(4,AD,2,16,"ng-container",24),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Hb("cl-team-table-members-regular",!e.isAdminOrOwner)("cl-billable-not-acive",!e.activeBillable),s.Cb(2),s.wc("sortOrder",e.pagination.sortOrder)("sortColumn",e.pagination.sortColumn)("isDesktop",e.isDesktop)("canSeeRates",e.canSeeRates)("isCostRateActive",null==e.workspace?null:e.workspace.isCostRateActive)("activeBillable",e.workspace.activeBillableHours)("hasLaborCostFeature",e.hasHistoricRatesFeature)("currency",null==e.workspace||null==e.workspace.hourlyRate?null:e.workspace.hourlyRate.currency),s.Cb(2),s.wc("ngForOf",e.users)}}function vD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"pager",26,27),s.jc("pageChanged",(function(t){return s.Oc(e),s.nc().setPaginationUrl(t)}))("limitChanged",(function(t){return s.Oc(e),s.nc().setPaginationUrl(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("page",null==e.pagination?null:e.pagination.page)("limit",null==e.pagination?null:e.pagination.pageSize)("total",e.totalUserCount)}}function TD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"add-members",28),s.jc("onClose",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return n.close(),i.missingUsers=null}))("onAdded",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return i.getRouteParams(),n.close(),i.missingUsers=null})),s.Wb()}if(2&e){const e=s.nc();s.wc("filteredUsersToShow",e.users)("autofillEmails",e.missingUsers)("isAdmin",e.isAdminOrOwner)}}function ID(e,t){1&e&&(s.Xb(0,"p",37),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"TEAMS.SEATS.NO_AVAILABLE.INFO_MESSAGE")))}function wD(e,t){1&e&&(s.Xb(0,"p",37),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"TEAMS.SEATS.UPGRADE_INFO_MESSAGE")))}function LD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",29),s.Xb(1,"h1",30),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb(),s.Xb(4,"div",31),s.Xb(5,"div",32),s.Xc(6,ID,3,3,"p",33),s.Xc(7,wD,3,3,"p",33),s.Wb(),s.Wb(),s.Xb(8,"div",34),s.Xb(9,"a",35),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Xb(12,"button",36),s.jc("click",(function(){s.Oc(e);const n=t.$implicit,i=s.nc(),c=s.Lc(23);return i.buySeats(c),n.close()})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,5,"TEAMS.SEATS.NO_AVAILABLE.TITLE")),s.Cb(4),s.wc("ngIf",!e.activatingMember),s.Cb(1),s.wc("ngIf",e.activatingMember),s.Cb(3),s.ad(s.pc(11,7,"GLOBAL.CLOSE_BTN")),s.Cb(3),s.ad(s.pc(14,9,"TEAMS.SEATS.BUY"))}}function RD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"user-seats-modal",38),s.jc("closeModal",(function(){return t.$implicit.close()}))("saveQuantity",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().saveQuantity(n,i)})),s.Wb()}if(2&e){const e=s.nc();s.wc("isAdd",!0)("inProgress",e.inProgress)("currentQuantity",e.quantity)("activeUsers",e.activeMembersLength)("currentType",e.getPlan(e.workspace.featureSubscriptionType))("amount",e.amount)}}function yD(e,t){1&e&&(s.Xb(0,"subscription-incomplete-modal",39),s.jc("close",(function(){return t.$implicit.close()})),s.Wb())}let _D=(()=>{class e{constructor(e,t,n,i,c,a,o,r,l,b,d,u,h){this.activatedRoute=e,this.browserService=t,this.router=n,this.teamsDataService=i,this.uiSettingsService=c,this.cd=a,this.modalService=o,this.workspaceService=r,this.userGroupService=l,this.userGroupV1Service=b,this.loader=d,this.paymentService=u,this.systemSettingsService=h,this.recalculateQuantity=new s.n,this.unsubscribe$=new p.a,this.pageDebouncer$=new p.a,this.labels=["GLOBAL.NAME_LABEL","GLOBAL.EMAIL_LABEL","GLOBAL.BILLABLE_RATE_LABEL","GLOBAL.COST_RATE_LABEL","GLOBAL.ROLE_LABEL","GLOBAL.GROUP_LABEL","GLOBAL.EDIT_LABEL"],this.getPlan=mo.c,this.activatingMember=!1,this.groupToShow="GLOBAL.SHOW_ALL_LABEL",this.isViewInited=!1,this.isCheckedMissingUsers=!1,this.groupsQuery={name:"",sortColumn:"name",sortOrder:bi.a.ASCENDING,page:1,limit:50},this.gotAllGroups=!1,this.groupsRequiredForRowLabel=[]}set isAdminOrOwner(e){this._isAdminOrOwner=e,this.setCanSeeRates()}get isAdminOrOwner(){return this._isAdminOrOwner}set isLoaded(e){this._isLoaded=e,e&&this.isViewInited&&!this.isCheckedMissingUsers&&this.checkMissingUsers()}get isLoaded(){return this._isLoaded}ngOnInit(){this.loader.showBar(),this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e,this.hasHistoricRatesFeature=e.hasFeature(is.a.HISTORIC_RATES),this.hasManagerRoleFeature=e.hasFeature(is.a.MANAGER_ROLE),this.hasEditMemberProfileFeature=e.hasFeature(is.a.EDIT_MEMBER_PROFILE),this.activeBillable=this.workspace.activeBillableHours,this.activeBillable||(this.labels=this.labels.filter(e=>"GLOBAL.BILLABLE_RATE_LABEL"!=e&&"GLOBAL.COST_RATE_LABEL"!=e)),this.setCanSeeRates(),this.cd.detectChanges()}),this.statuses=[new Un.a("ALL","GLOBAL.SHOW_ALL_LABEL"),new Un.a("ACTIVE","TEAMS.MEMBERS.STATUS_LABELS.ACTIVE_LABEL"),new Un.a("INACTIVE","TEAMS.MEMBERS.STATUS_LABELS.INACTIVE_LABEL"),new Un.a("PENDING","TEAMS.MEMBERS.STATUS_LABELS.INVITED_LABEL")],this.initPagination(),this.setBrowserWidth(),this.getRouteParams(),this.setRouteDebouncer(),this.activeBillable&&this.isAdminOrOwner||(this.labels=this.labels.filter(e=>"GLOBAL.BILLABLE_RATE_LABEL"!=e&&"GLOBAL.COST_RATE_LABEL"!=e))}ngAfterViewInit(){this.isViewInited=!0,this.isLoaded&&!this.isCheckedMissingUsers&&this.checkMissingUsers()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}setCanSeeRates(){this.workspace&&(this.canSeeRates=(!this.workspace.onlyAdminsSeeBillableRates||this.isAdminOrOwner)&&this.activeBillable)}expandAllRows(e){this.expandAll=e}changeGroupShow(e){this.pagination.status=e,this.pageDebouncer$.next()}openAddMemberModal(e,t){var n,i;(null===(n=this.workspace)||void 0===n?void 0:n.featureSubscriptionType)&&mo.a[null===(i=this.workspace)||void 0===i?void 0:i.featureSubscriptionType].bySeat&&this.quantity<=this.activeMembersLength?this.modalService.open(t,{centered:!0}):this.modalService.open(e,{size:"lg",centered:!0})}changeSortColumn(e){this.pagination.sortColumn=e,this.pagination.sortOrder=bi.a.ASCENDING,this.pageDebouncer$.next()}changeSortOrder(){this.pagination.sortOrder=this.pagination.sortOrder===bi.a.ASCENDING?bi.a.DESCENDING:bi.a.ASCENDING,this.pageDebouncer$.next()}onSearchChange(){this.initPagination(),this.pageDebouncer$.next()}setPaginationUrl(e){this.pagination.page=e.page||this.pagination.page,this.pagination.pageSize=e.limit||this.pagination.pageSize,this.pageDebouncer$.next()}setLocalStorageSettings(){this.uiSettingsService.setSettings(xn.b.TEAMS_MEMBERS,{pageSize:this.pagination.pageSize,sortOrder:this.pagination.sortOrder,sortColumn:this.pagination.sortColumn,status:this.pagination.status})}onDeleted(e){this.users.splice(e,1),this.cd.detectChanges()}initPagination(){const e=this.uiSettingsService.getSettings(xn.b.TEAMS_MEMBERS)||{};this.pagination={page:1,pageSize:e.pageSize||In.y,sortOrder:bi.a[e.sortOrder]||bi.a.ASCENDING,sortColumn:e.sortColumn||"name",status:e.status||"ALL"}}setRouteDebouncer(){this.pageDebouncer$.pipe(Object(De.a)(250),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.setLocalStorageSettings(),this.router.navigate([],{queryParams:Object.assign(Object.assign({},this.pagination),{searchEmail:this.searchEmail}),relativeTo:this.activatedRoute,fragment:jW.MEMBERS.toLowerCase()})})}getRouteParams(){this.activatedRoute.queryParams.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{const t=this.activatedRoute.snapshot.fragment;t&&t!==jW.MEMBERS.toLowerCase()||(this.searchEmail=e.searchEmail||"",e.status&&(this.pagination.status=this.findGroup(e.status)),Object(sn.u)(e.page)&&e.page>0&&(this.pagination.page=Number(e.page)),Object(sn.u)(e.pageSize)&&e.pageSize>0&&e.pageSize<=200&&(this.pagination.pageSize=Number(e.pageSize)),bi.a[e.sortOrder]&&(this.pagination.sortOrder=e.sortOrder),this.getEverything(),this.cd.detectChanges())}),this.cd.detectChanges()}findGroup(e){const t=this.statuses.filter(t=>t.value===e);return t.length?t[0].value:null}getEverything(){const e={page:this.pagination.page,limit:this.pagination.pageSize,sortColumn:this.pagination.sortColumn||"name",sortOrder:this.pagination.sortOrder||bi.a.ASCENDING,email:this.searchEmail,statuses:"ALL"===this.pagination.status?"":[this.pagination.status],nameOnlySort:!1};this.userGroupService.getUserGroups(this.groupsQuery).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(),this.workspaceService.getUsers(e).subscribe(e=>{this.users=e.users;const t=this.users.map(e=>e.id);this.userGroupService.getGroupNamesForUsers(t).subscribe(e=>{this.groupsRequiredForRowLabel=e.filter(e=>"Admins"!=e.name),this.cd.detectChanges()}),this.totalUserCount=e.count,this.isMultiplePages=this.totalUserCount>In.y||this.totalUserCount>this.pagination.pageSize,this.users&&0===this.users.length&&this.pagination.page>1&&(this.pagination.page=1,this.router.navigate([],{relativeTo:this.activatedRoute,fragment:jW.MEMBERS.toLowerCase()})),this.loader.hide(),this.cd.detectChanges()})}setBrowserWidth(){this.browserService.isBreakpointLgCustom$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e,this.cd.detectChanges()})}buySeats(e){this.modalService.open(e,{centered:!0})}saveQuantity(e,t){this.loader.show(),this.inProgress=!0,this.paymentService.updateQuantity(e+this.quantity,this.quantity).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspaceService.payment.next(e),this.inProgress=!1,t.close(),this.loader.hide()},e=>{e.error&&e.error.message&&e.error.message.includes("incomplete")&&this.modalService.open(this.subscriptionFailedModal),this.loader.hide(),this.inProgress=!1})}checkMissingUsers(){var e;this.isCheckedMissingUsers=!0,this.missingUsers=this.teamsDataService.missingUsers,this.teamsDataService.missingUsers=null,(null===(e=this.missingUsers)||void 0===e?void 0:e.length)&&this.openAddMemberModal(this.addMembersModal,this.allSeatsTaken)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.a),s.Rb(Gn.a),s.Rb(k.d),s.Rb(o),s.Rb(xn.a),s.Rb(s.h),s.Rb(w.q),s.Rb(l.a),s.Rb(WL.a),s.Rb(N_.a),s.Rb(Hn.a),s.Rb(dC.a),s.Rb(bn.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["members-tab"]],viewQuery:function(e,t){var n;1&e&&(s.gd(gD,!0),s.gd(ED,!0),s.gd(fD,!0)),2&e&&(s.Kc(n=s.kc())&&(t.subscriptionFailedModal=n.first),s.Kc(n=s.kc())&&(t.addMembersModal=n.first),s.Kc(n=s.kc())&&(t.allSeatsTaken=n.first))},inputs:{isAdminOrOwner:"isAdminOrOwner",currentUserId:"currentUserId",ownerId:"ownerId",isOwner:"isOwner",quantity:"quantity",amount:"amount",activeMembersLength:"activeMembersLength",isLoaded:"isLoaded"},outputs:{recalculateQuantity:"recalculateQuantity"},decls:26,vars:11,consts:[[1,"cl-relative"],[1,"cl-row","cl-align-items-center","cl-mb-2","cl-mb-lg-custom-3"],[1,"cl-col-12","cl-col-lg-custom-4"],[1,"cl-d-flex"],["class","cl-d-inline-block",3,"list","value","onChanged",4,"ngIf"],[1,"cl-form-group","cl-mb-2","cl-mb-lg-custom-0","cl-ml-2","cl-w-100"],["type","text",1,"cl-form-control",3,"ngModel","placeholder","ngModelChange"],[1,"cl-col-6","cl-col-lg-custom-4","cl-ml-auto","cl-text-right"],[4,"ngIf"],[1,"cl-card","cl-border-bottom-0","cl-mb-0"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],["class","cl-table cl-table-bordered cl-remove-cell-borders cl-text-gray-6 cl-team-table-members",3,"cl-team-table-members-regular","cl-billable-not-acive",4,"ngIf"],[1,"cl-mt-2","cl-mt-lg-3"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],["addMembersModal",""],["allSeatsTaken",""],["userSeatsModal",""],["subscriptionFailedModal",""],[1,"cl-d-inline-block",3,"list","value","onChanged"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[1,"cl-d-none","cl-d-md-inline"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6","cl-team-table-members"],["members-header","",3,"sortOrder","sortColumn","isDesktop","canSeeRates","isCostRateActive","activeBillable","hasLaborCostFeature","currency","onChangeSortOrder","onChangeSortColumn","onExpandAll"],[4,"ngFor","ngForOf"],["members-row","",3,"labels","user","ownerId","isDesktop","showGroup","isOwner","isCurrentUserAdminOrOwner","canSeeRates","activeBillable","currentUserId","expandAll","hasManagerRoleFeature","hasHistoricRatesFeature","hasEditMemberProfileFeature","isAllSeatsTaken","groupsRequiredForRowLabel","onDeleted","seatsTaken"],[3,"page","limit","total","pageChanged","limitChanged"],["pager",""],[3,"filteredUsersToShow","autofillEmails","isAdmin","onClose","onAdded"],[1,"cl-modal-header"],[1,"cl-modal-title"],[1,"cl-modal-body","cl-text-center","cl-pt-4"],[1,"cl-text-left"],["class","cl-mb-0",4,"ngIf"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-mb-0"],[3,"isAdd","inProgress","currentQuantity","activeUsers","currentType","amount","closeModal","saveQuantity"],[3,"close"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xc(4,SD,1,2,"dropdown-items",4),s.Xb(5,"div",5),s.Xb(6,"input",6),s.jc("ngModelChange",(function(){return t.onSearchChange()}))("ngModelChange",(function(e){return t.searchEmail=e})),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(8,"div",7),s.Xc(9,CD,9,10,"div",8),s.Wb(),s.Wb(),s.Xb(10,"div",9),s.Xb(11,"div",10),s.Xb(12,"span",11),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xc(15,OD,5,13,"table",12),s.Xb(16,"div",13),s.Xc(17,vD,2,3,"pager",14),s.Xc(18,TD,1,3,"ng-template",null,15,s.Yc),s.Xc(20,LD,15,11,"ng-template",null,16,s.Yc),s.Xc(22,RD,1,6,"ng-template",null,17,s.Yc),s.Wb(),s.Wb(),s.Xc(24,yD,1,0,"ng-template",null,18,s.Yc)),2&e&&(s.Cb(4),s.wc("ngIf",!!t.pagination),s.Cb(2),s.xc("placeholder",s.pc(7,7,"TEAMS.MEMBERS.SEARCH")),s.wc("ngModel",t.searchEmail),s.Cb(3),s.wc("ngIf",t.isAdminOrOwner),s.Cb(4),s.ad(s.pc(14,9,"GLOBAL.MEMBERS_LABEL")),s.Cb(2),s.wc("ngIf",!!t.workspace&&!!t.pagination),s.Cb(2),s.wc("ngIf",t.isMultiplePages))},directives:[i.u,v.c,v.s,v.v,ji.a,zW,i.t,ZN,Pi.a,tD,mD,yC],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function kD(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"th",2),s.Xb(2,"a",3),s.jc("click",(function(){return s.Oc(e),s.nc().changeSort("name")})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Xb(5,"th",4),s.Xb(6,"div",5),s.Xb(7,"div",6),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Sb(10,"th",7),s.Sb(11,"th",8),s.Ub()}if(2&e){const e=s.nc();s.Cb(2),s.Hb("cl-up","name"===e.sortColumn&&e.sortOrder===e.SortOrder.ASCENDING)("cl-down","name"===e.sortColumn&&e.sortOrder===e.SortOrder.DESCENDING),s.Cb(1),s.ad(s.pc(4,6,"GLOBAL.NAME_LABEL")),s.Cb(5),s.ad(s.pc(9,8,"GLOBAL.ACCESS_LABEL"))}}function WD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"th",9),s.Xb(1,"div",10),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"div",11),s.Xb(5,"a",12),s.jc("click",(function(){return s.Oc(e),s.nc().expandAll()})),s.Xb(6,"span",13),s.Sb(7,"img",14),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.bd("",s.pc(3,2,"GLOBAL.ACCESS_LABEL")," "),s.Cb(5),s.wc("src",e.isExpandAll?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",s.Qc)}}let XD=(()=>{class e{constructor(){this.onChangeSortOrder=new s.n,this.onChangeSortColumn=new s.n,this.onExpandAll=new s.n,this.SortOrder=bi.a,this.unsubscribe$=new p.a,this.isExpandAll=!1}ngOnInit(){}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}expandAll(){this.isExpandAll=!this.isExpandAll,this.onExpandAll.emit(this.isExpandAll)}changeSort(e){e!==this.sortColumn?this.onChangeSortColumn.emit(e):this.onChangeSortOrder.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["groups-header"],["","groups-header",""]],inputs:{isDesktop:"isDesktop",sortColumn:"sortColumn",sortOrder:"sortOrder"},outputs:{onChangeSortOrder:"onChangeSortOrder",onChangeSortColumn:"onChangeSortColumn",onExpandAll:"onExpandAll"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["mobileTemplate",""],[1,"cl-pl-lg-3","cl-responsive-table-td-0"],[1,"cl-text-gray-6","cl-sort-by",3,"click"],[1,"cl-responsive-table-td-1"],[1,"cl-ml-lg-custom-n2"],[1,"cl-h5","cl-mb-0","cl-text-gray-6-dark-mode"],[1,"cl-responsive-table-td-2"],[1,"cl-responsive-table-td-3"],["colspan","4",1,"cl-pl-lg-3"],[1,"cl-h5","cl-mb-0","cl-d-flex","cl-justify-content-between","cl-align-items-center"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-ml-auto",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"]],template:function(e,t){if(1&e&&(s.Xc(0,kD,12,10,"ng-container",0),s.Xc(1,WD,8,4,"ng-template",null,1,s.Yc)),2&e){const e=s.Lc(2);s.wc("ngIf",t.isDesktop)("ngIfElse",e)}},directives:[i.u],pipes:[g.e],encapsulation:2}),e})();var ND=n("vrD5"),DD=n("Oieg"),PD=n("YjdQ"),MD=n("T+Hu");let BD=(()=>{class e{constructor(){this.onClose=new s.n,this.onUpdate=new s.n,this.inProgress=!1}ngOnInit(){this.newName=Object(sn.H)(this.currentName)}closeModal(){this.onClose.emit(!1)}update(){null==this.newName||this.newName.trim().length<1||(this.onUpdate.emit(Object(sn.H)(this.newName)),this.onClose.emit(!1))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["edit-group"]],inputs:{inProgress:"inProgress",currentName:"currentName"},outputs:{onClose:"onClose",onUpdate:"onUpdate"},decls:21,vars:14,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group","cl-row","cl-mb-0"],[1,"cl-col-sm-3","cl-col-form-label","cl-mb-0"],[1,"cl-col-sm-9"],["type","text","inputString","","ngbAutofocus","","preventMultipleSpaces","",1,"cl-form-control",3,"ngModel","inputChange","keyup.enter"],[1,"cl-modal-footer","cl-text-capitalize"],[3,"click"],["type","button",1,"cl-btn","cl-btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.closeModal()})),s.Xb(5,"span"),s.Sb(6,"img",3),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",4),s.Xb(8,"div",5),s.Xb(9,"label",6),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Xb(12,"div",7),s.Xb(13,"input",8),s.jc("inputChange",(function(e){return t.newName=e}))("keyup.enter",(function(){return t.update()})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(14,"div",9),s.Xb(15,"a",10),s.jc("click",(function(){return t.closeModal()})),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Xb(18,"button",11),s.jc("click",(function(){return t.update()})),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,6,"TEAMS.MEMBERS.GROUPS.EDIT.TITLE")),s.Cb(8),s.ad(s.pc(11,8,"GLOBAL.CHANGE_NAME_LABEL")),s.Cb(3),s.wc("ngModel",t.newName),s.Cb(3),s.ad(s.pc(17,10,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",t.inProgress),s.Cb(1),s.ad(s.pc(20,12,"GLOBAL.SAVE_LABEL")))},directives:[v.c,vo,ND.a,v.s,v.v],pipes:[g.e],encapsulation:2}),e})();function UD(e,t){1&e&&s.Tb(0)}function GD(e,t){if(1&e&&(s.Xb(0,"div",9),s.Xb(1,"span",10),s.Zc(2),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.xc("title",e.userGroup.name),s.Cb(1),s.ad(e.userGroup.name)}}function xD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"members-dropdown",11),s.jc("userAndUserGroups",(function(t){return s.Oc(e),s.nc().closeEditTeamDropdown(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("userIds",e.userIds)("mode","users")("isAdminOrOwner",e.isAdminOrOwner)("selectedEntityName",e.userGroupNames)}}function FD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",13),s.Xb(1,"a",14),s.jc("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(12);return t.openModal(n,"lg")})),s.Sb(2,"img",15),s.Wb(),s.Wb()}}function jD(e,t){if(1&e&&s.Xc(0,FD,3,0,"div",12),2&e){const e=s.nc();s.wc("ngIf",e.isAdminOrOwner)}}function ZD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",13),s.Xb(1,"a",14),s.jc("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(14);return t.openModal(n,"md")})),s.Sb(2,"img",16),s.Wb(),s.Wb()}}function VD(e,t){if(1&e&&s.Xc(0,ZD,3,0,"div",12),2&e){const e=s.nc();s.wc("ngIf",e.isAdminOrOwner)}}function YD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"edit-group",17),s.jc("onClose",(function(){return t.$implicit.close()}))("onUpdate",(function(t){return s.Oc(e),s.nc().updateGroup(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("inProgress",e.inProgress)("currentName",e.userGroup.name)}}function HD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",18),s.jc("confirmed",(function(n){s.Oc(e);const i=t.$implicit,c=s.nc();return i.close(n),c.deleteGroup()}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"uppercase"),s.oc(3,"translate"),s.Xb(4,"p",19),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,"GLOBAL.DELETE_BTN"))("isDanger",!0)("btnText",s.pc(2,6,s.pc(3,8,"GLOBAL.DELETE_BTN"))),s.Cb(5),s.bd("\n",s.pc(6,10,"TEAMS.MEMBERS.GROUPS.DELETE.CONFIRM")+e.userGroup.name+"?","\n")}}const $D=function(e){return{labels:e}},KD=function(e,t,n,i){return[e,t,n,i]};let qD=(()=>{class e{constructor(e,t,n,i,c,a){this.modalService=e,this.cd=t,this.userGroupService=n,this.workspaceService=i,this.translate=c,this.analyticsService=a,this.currentStatus="ACTIVE",this.onDeleted=new s.n,this.onUserFilterChanged=new s.n,this.usersCopy=[],this.inProgress=!1,this.userGroupNames=[],this.memberships=[],this.shouldOpen=!1,this.unsubscribe$=new p.a,this.Ulist=[],this.userGroupIds=[],this.usersToRemove=[],this.usersToAdd=[],this.userIds=[],this.query={page:1,name:""},this.userFilterOptions=[new Ea.a("ALL","GLOBAL.ALL_LABEL"),new Ea.a(on.l.ACTIVE,"GLOBAL.ACTIVE_LABEL"),new Ea.a(on.l.INACTIVE,"GLOBAL.INACTIVE_LABEL")]}get accessUsers(){return this._accessUsers}set accessUsers(e){e&&(this._accessUsers=e,this.usersCopy=this.accessUsers.map(e=>e.id),this.userIds=this.accessUsers.map(e=>e.id),this.filterNames())}get dropDownUsers(){return this._dropDownUsers}set dropDownUsers(e){this._dropDownUsers=e,this.addToList(e,!1)}ngOnInit(){this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}deleteGroup(){this.inProgress=!0,this.userGroupService.delete(this.userGroup).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.inProgress=!1,this.onDeleted.emit(),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"delete",section:"Team",section2:"Groups"}))},()=>{this.inProgress=!1}),this.cd.detectChanges()}updateGroup(e){this.inProgress=!0;const t=DD.a.clone(this.userGroup);t.name=e,this.userGroupService.update(t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.userGroup.name=e,this.inProgress=!1,this.cd.detectChanges()},()=>{this.inProgress=!1}),this.cd.detectChanges()}filterNames(){if(this.accessUsers.length===this.totalUsers)this.userGroupNames=[this.translate.instant("GLOBAL.EVERYONE_LABEL")];else{const e=[];this.accessUsers.forEach(t=>e.push(t.name)),this.userGroupNames=e}}openModal(e,t){this.modalService.open(e,{size:t,centered:!0})}changeMembershipStatus(e){"1"==e.memberships.filter(e=>e.targetId===this.workspace.id)[0].membershipStatus?this.workspaceService.setStatus(e.id,eX.a.INACTIVE):this.workspaceService.setStatus(e.id,eX.a.ACTIVE)}resendInvite(e){this.workspaceService.resendInvite(e)}addToList(e,t){const n=t?this.Ulist[0].value.map(e=>e):[];this.Ulist=[],this.Ulist.push(Object(MD.b)("Users",this.translate.instant("GLOBAL.USERS_LABEL"),[...e.map(e=>new PD.a(e)),...n])),this.cd.detectChanges()}openEditTeamDropdown(e){this.shouldOpen=!!e.id}closeEditTeamDropdown(e){this.transformMapsToIdsUpdate(e),this.closeAllDropdowns()}transformMapsToIdsUpdate(e){this.updateUserGroupIds(e.users.ids),this.cd.detectChanges()}updateUserGroupIds(e){const t=[...this.usersCopy];this.userIds=e?[...new Set([...e])]:[],this.userIds.length===this.totalUsers?this.userGroupNames=[this.translate.instant("GLOBAL.EVERYONE_LABEL")]:this.loadUserForNameList(this.userIds),this.usersToAdd=this.userIds.filter(e=>!t.includes(e)),this.usersToRemove=t.filter(e=>!this.userIds.includes(e)),this.usersCopy=[...this.userIds],this.cd.detectChanges()}closeAllDropdowns(){const e=[];e.push(this.userGroup.id),this.usersToAdd.length>0&&this.userGroupService.addUserToUserGroup(e,this.usersToAdd),this.usersToRemove.length>0&&this.userGroupService.removeUserFromUserGroup(e,this.usersToRemove),this.shouldOpen=!1,this.query.page=1,this.query.name="",this.onUserFilterChanged.emit("ALL"),this.cd.detectChanges()}onSearchChange(e){this.query.page=1,this.query.name=e,this.getUsers({page:this.query.page,limit:50,sortColumn:"name",sortOrder:bi.a.ASCENDING,name:this.query.name,statuses:this.currentStatus},!1)}resetEntityList(){""!==this.query.name&&(this.query={page:1,name:""},this.addToList(this.dropDownUsers,!1))}loadMore(){const e={page:++this.query.page,limit:50,sortColumn:"name",sortOrder:bi.a.ASCENDING,name:this.query.name};this.getUsers(e,!0)}getUsers(e,t){this.totalUsers!==this.userIds.length&&this.workspaceService.getUsersByIds(null,e).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.addToList(e,t),this.cd.detectChanges()})}loadUserForNameList(e){e&&e.length?this.workspaceService.getUsersByIds(e).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.userGroupNames=e.map(e=>e.name),this.cd.detectChanges()}):this.userGroupNames=[]}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q),s.Rb(s.h),s.Rb(WL.a),s.Rb(l.a),s.Rb(g.f),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["groups-row"],["","groups-row",""]],inputs:{isDesktop:"isDesktop",accessUsers:"accessUsers",dropDownUsers:"dropDownUsers",labels:"labels",showGroup:"showGroup",currentStatus:"currentStatus",userGroup:"userGroup",isAdminOrOwner:"isAdminOrOwner",ownerId:"ownerId",currentUserId:"currentUserId",expandAll:"expandAll",totalUsers:"totalUsers",index:"index"},outputs:{onDeleted:"onDeleted",onUserFilterChanged:"onUserFilterChanged"},decls:15,vars:12,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cl-d-none",3,"isDesktop","templates","isExpanded"],["responsive",""],["col1",""],["col2",""],["col3",""],["col4",""],["editGroupModal",""],["deleteGroupModal",""],[1,"cl-d-inline-flex","cl-cut-text-wrapper","cl-w-100","cl-py-0","cl-py-lg-custom-2","cl-pr-3","cl-pl-lg-2","cl-pl-lg-custom-0"],[1,"cl-cut-text",3,"title"],[3,"userIds","mode","isAdminOrOwner","selectedEntityName","userAndUserGroups"],["class","cl-d-flex cl-align-items-center cl-justify-content-end cl-w-100 cl-w-lg-auto cl-ml-auto",4,"ngIf"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end","cl-w-100","cl-w-lg-auto","cl-ml-auto"],[1,"cl-component-divided-left",3,"click"],["src","assets/images/ui-icons/edit.svg"],["src","assets/images/ui-icons/close.svg"],[3,"inProgress","currentName","onClose","onUpdate"],[3,"title","isDanger","btnText","confirmed","close"],[1,"cl-mb-0"]],template:function(e,t){if(1&e&&(s.Xc(0,UD,1,0,"ng-container",0),s.Sb(1,"responsive-row",1,2),s.Xc(3,GD,3,2,"ng-template",null,3,s.Yc),s.Xc(5,xD,1,4,"ng-template",null,4,s.Yc),s.Xc(7,jD,1,1,"ng-template",null,5,s.Yc),s.Xc(9,VD,1,1,"ng-template",null,6,s.Yc),s.Xc(11,YD,1,2,"ng-template",null,7,s.Yc),s.Xc(13,HD,7,12,"ng-template",null,8,s.Yc)),2&e){const e=s.Lc(2),n=s.Lc(4),i=s.Lc(6),c=s.Lc(8),a=s.Lc(10);s.wc("ngTemplateOutlet",e.template)("ngTemplateOutletContext",s.Bc(5,$D,t.labels)),s.Cb(1),s.wc("isDesktop",t.isDesktop)("templates",s.Ec(7,KD,n,i,c,a))("isExpanded",t.expandAll)}},directives:[i.B,Ei.a,AX,i.u,BD,Si.a],pipes:[g.e,i.I],encapsulation:2,changeDetection:0}),e})();function zD(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",16),s.Xb(1,"div",17),s.Xb(2,"input",18),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().newGroupName=t}))("keyup.enter",(function(){return s.Oc(e),s.nc().createUserGroup()})),s.oc(3,"translate"),s.Wb(),s.Wb(),s.Xb(4,"div",19),s.Xb(5,"button",20),s.jc("click",(function(){return s.Oc(e),s.nc().createUserGroup()})),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.xc("placeholder",s.pc(3,3,"TEAMS.MEMBERS.GROUPS.ADD.PLACEHOLDER")),s.wc("ngModel",e.newGroupName),s.Cb(4),s.ad(s.pc(7,5,"GLOBAL.ADD_LABEL"))}}function QD(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"tr",22),s.jc("onDeleted",(function(){s.Oc(e);const n=t.$implicit;return s.nc(2).onDeleted(n.id)}))("onUserFilterChanged",(function(t){return s.Oc(e),s.nc(2).userFilterChanged(t)})),s.Wb(),s.Ub()}if(2&e){const e=t.$implicit,n=s.nc(2);s.Cb(1),s.wc("labels",n.labels)("accessUsers",n.userGroupsUsers.get(e.id))("dropDownUsers",n.initialDropdownUsers)("isDesktop",n.isDesktop)("currentStatus",n.userStatus)("showGroup",n.groupToShow)("userGroup",e)("isAdminOrOwner",n.isAdminOrOwner)("ownerId",n.ownerId)("currentUserId",n.currentUserId)("expandAll",n.expandAll)("totalUsers",n.totalUsers)}}function JD(e,t){if(1&e&&(s.Vb(0),s.Xc(1,QD,2,12,"ng-container",21),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngForOf",e.userGroups)}}function eP(e,t){if(1&e){const e=s.Yb();s.Xb(0,"pager",23,24),s.jc("pageChanged",(function(t){return s.Oc(e),s.nc().setPaginationUrl(t)}))("limitChanged",(function(t){return s.Oc(e),s.nc().setPaginationUrl(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("page",null==e.pagination?null:e.pagination.page)("limit",null==e.pagination?null:e.pagination.pageSize)("total",e.totalGroupCount)}}function tP(e,t){1&e&&(s.Xb(0,"add-members",25),s.jc("onClose",(function(){return t.$implicit.close()})),s.Wb())}let nP=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r,l){this.activatedRoute=e,this.browserService=t,this.router=n,this.uiSettingsService=i,this.cd=s,this.modalService=c,this.workspaceService=a,this.userGroupService=o,this.loader=r,this.analyticsService=l,this.unsubscribe$=new p.a,this.userGroupsUsers=new Map,this.pageDebouncer$=new p.a,this.labels=["GLOBAL.NAME_LABEL","GLOBAL.MEMBERS_LABEL","GLOBAL.EDIT_LABEL","GLOBAL.DELETE_BTN"],this.groupToShow="GLOBAL.SHOW_ALL_LABEL",this.userGroups=[],this.userStatus="ACTIVE"}ngOnInit(){this.loader.showBar(),this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspaceId=e.id}),this.initPagination(),this.setBrowserWidth(),this.getRouteParams(),this.setRouteDebouncer()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}expandAllRows(e){this.expandAll=e}createUserGroup(){this.userGroupService.create(Object(sn.H)(this.newGroupName),this.workspaceId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.newGroupName="",e&&(this.userGroups.unshift(e),this.userGroupsUsers.set(e.id,[])),this.cd.detectChanges(),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"add",section:"Team",section2:"Groups"}))})}changeSortColumn(e){this.pagination.sortColumn=e,this.pagination.sortOrder=bi.a.ASCENDING,this.pageDebouncer$.next()}changeSortOrder(){this.pagination.sortOrder=this.pagination.sortOrder===bi.a.ASCENDING?bi.a.DESCENDING:bi.a.ASCENDING,this.pageDebouncer$.next()}setPaginationUrl(e){this.pagination.page=e.page||this.pagination.page,this.pagination.pageSize=e.limit||this.pagination.pageSize,this.pageDebouncer$.next()}onDeleted(e){this.userGroups=this.userGroups.filter(t=>t.id!==e),this.userGroupsUsers.delete(e),this.cd.detectChanges()}userFilterChanged(e){this.userStatus=e,this.getUsersForDropdown()}saveLocalStorageSetiings(){this.uiSettingsService.setSettings(xn.b.TEAM_GROUP,{pageSize:this.pagination.pageSize,sortOrder:this.pagination.sortOrder})}initPagination(){const e=this.uiSettingsService.getSettings(xn.b.TEAM_GROUP)||{};this.pagination={page:1,pageSize:e.pageSize||In.y,sortOrder:bi.a[e.sortOrder]||bi.a.ASCENDING,sortColumn:e.sortColumn||"name"}}setRouteDebouncer(){this.pageDebouncer$.pipe(Object(De.a)(250)).subscribe(()=>{this.saveLocalStorageSetiings(),this.router.navigate([],{queryParams:this.pagination,relativeTo:this.activatedRoute,fragment:jW.GROUPS.toLowerCase()})})}getRouteParams(){this.activatedRoute.queryParams.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.activatedRoute.snapshot.fragment===jW.GROUPS.toLowerCase()&&(Object(sn.u)(e.page)&&e.page>0&&(this.pagination.page=Number(e.page)),Object(sn.u)(e.pageSize)&&e.pageSize>0&&e.pageSize<=200&&(this.pagination.pageSize=Number(e.pageSize)),bi.a[e.sortOrder]&&(this.pagination.sortOrder=e.sortOrder),this.getEverything())})}getEverything(){const e={sortOrder:this.pagination.sortOrder?this.pagination.sortOrder:bi.a.ASCENDING,page:this.pagination.page,limit:this.pagination.pageSize};this.userGroups=[],this.userGroupService.getUserGroups(e).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.userGroups=e.groups.filter(e=>"Admins"!==e.name),this.cd.detectChanges(),this.totalGroupCount=e.count-1,this.isMultiplePages=this.totalGroupCount>In.y||this.totalGroupCount>this.pagination.pageSize;const t=this.userGroups.some(e=>!!e.userIds)?[...new Set([].concat.apply([],this.userGroups.map(e=>e.userIds)))]:null;t&&t.length>0&&this.workspaceService.getUsersByIds(t).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.userGroups.forEach(t=>{this.userGroupsUsers.set(t.id,e.filter(e=>t.userIds.includes(e.id.toString())))}),this.cd.detectChanges()}),this.loader.hide(),this.cd.detectChanges()}),this.getUsersForDropdown(),this.getUsersCount()}getUsersForDropdown(){this.workspaceService.getUsersByIds(null,{sortColumn:"name",sortOrder:bi.a.ASCENDING,page:1,limit:In.y,status:this.userStatus}).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.initialDropdownUsers=e,this.cd.detectChanges()})}setBrowserWidth(){this.browserService.isBreakpointLgCustom$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e,this.cd.detectChanges()})}getUsersCount(){this.workspaceService.getUserCount().pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.totalUsers=e,this.cd.detectChanges()})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.a),s.Rb(Gn.a),s.Rb(k.d),s.Rb(xn.a),s.Rb(s.h),s.Rb(w.q),s.Rb(l.a),s.Rb(WL.a),s.Rb(Hn.a),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["groups-tab"]],inputs:{isAdminOrOwner:"isAdminOrOwner",ownerId:"ownerId",currentUserId:"currentUserId"},decls:21,vars:9,consts:[[1,"cl-relative"],[1,"cl-tab-pane"],[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-row","cl-align-items-center"],[1,"cl-col-lg-custom-4","cl-ml-auto"],[1,"cl-form-group","cl-mb-0"],["class","cl-form-row",4,"ngIf"],[1,"cl-card","cl-border-bottom-0","cl-mb-0"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6","cl-team-table-groups"],["groups-header","",3,"sortOrder","sortColumn","isDesktop","onChangeSortOrder","onChangeSortColumn","onExpandAll"],[4,"ngIf"],[1,"cl-mt-2","cl-mt-lg-3"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],["addMembersModal",""],[1,"cl-form-row"],[1,"cl-col"],["type","text","preventMultipleSpaces","",1,"cl-form-control",3,"ngModel","placeholder","ngModelChange","keyup.enter"],[1,"cl-col-auto"],[1,"cl-btn","cl-btn-primary",3,"click"],[4,"ngFor","ngForOf"],["groups-row","",3,"labels","accessUsers","dropDownUsers","isDesktop","currentStatus","showGroup","userGroup","isAdminOrOwner","ownerId","currentUserId","expandAll","totalUsers","onDeleted","onUserFilterChanged"],[3,"page","limit","total","pageChanged","limitChanged"],["pager",""],[3,"onClose"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"div",5),s.Xc(6,zD,8,7,"div",6),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",7),s.Xb(8,"div",8),s.Xb(9,"span",9),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(12,"table",10),s.Xb(13,"thead"),s.Xb(14,"tr",11),s.jc("onChangeSortOrder",(function(){return t.changeSortOrder()}))("onChangeSortColumn",(function(e){return t.changeSortColumn(e)}))("onExpandAll",(function(e){return t.expandAllRows(e)})),s.Wb(),s.Wb(),s.Xb(15,"tbody"),s.Xc(16,JD,2,1,"ng-container",12),s.Wb(),s.Wb(),s.Xb(17,"div",13),s.Xc(18,eP,2,3,"pager",14),s.Xc(19,tP,1,0,"ng-template",null,15,s.Yc),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(6),s.wc("ngIf",t.isAdminOrOwner),s.Cb(4),s.ad(s.pc(11,7,"GLOBAL.GROUPS_LABEL")),s.Cb(4),s.wc("sortOrder",t.pagination.sortOrder)("sortColumn",t.pagination.sortColumn)("isDesktop",t.isDesktop),s.Cb(2),s.wc("ngIf",!!t.userGroups&&t.userGroups.length>0&&!!t.initialDropdownUsers&&!!t.userGroupsUsers),s.Cb(2),s.wc("ngIf",t.isMultiplePages))},directives:[i.u,XD,v.c,ND.a,v.s,v.v,i.t,qD,Pi.a,tD],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var iP=n("SxV6"),sP=n("4500");function cP(e,t){if(1&e){const e=s.Yb();s.Xb(0,"members-dropdown",17),s.jc("userAndUserGroups",(function(t){return s.Oc(e),s.nc().updateUsers(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("isAdminOrOwner",!0)("userIds",e.newReminder.users)}}function aP(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",18),s.Xb(1,"div",19),s.Xb(2,"input",20,21),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().newReminder.hours=t}))("keyup.enter",(function(){return s.Oc(e),s.Lc(3).blur()})),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.wc("ngModel",e.newReminder.hours)("minNumber",0)}}function oP(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"displayDayOfWeek"),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.pc(2,1,e.newReminder.days)," ")}}function rP(e,t){1&e&&(s.Zc(0),s.oc(1,"translate")),2&e&&s.bd(" ",s.pc(1,1,"TEAMS.REMINDERS.CREATE.SENTENCE.SEVENTH_PART.SELECT")," ")}function lP(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",30),s.Xb(1,"div",31),s.jc("click",(function(){s.Oc(e);const n=t.index;return s.nc(3).toggleDay(n)})),s.Sb(2,"input",32),s.Xb(3,"label",33),s.Xb(4,"div",34),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit,n=t.index,i=s.nc(3);s.Cb(2),s.wc("checked",i.newReminder.days.indexOf(n)>-1),s.Cb(3),s.ad(s.pc(6,2,e))}}function bP(e,t){if(1&e&&(s.Xb(0,"div",27),s.Xb(1,"div",28),s.Xc(2,lP,7,4,"div",29),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.wc("ngForOf",e.days)}}function dP(e,t){if(1&e&&(s.Xb(0,"span",22),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"a",23),s.Xc(5,oP,3,3,"ng-container",24),s.Xc(6,rP,2,3,"ng-template",null,25,s.Yc),s.Wb(),s.Xc(8,bP,3,1,"div",26),s.Wb()),2&e){const e=s.Lc(7),t=s.nc();s.Cb(2),s.bd("",s.pc(3,3,"TEAMS.REMINDERS.CREATE.SENTENCE.SEVENTH_PART.DAY_ON_MONDAY")," "),s.Cb(3),s.wc("ngIf",t.newReminder.days.length>0)("ngIfElse",e)}}let uP=(()=>{class e{constructor(e,t,n,i,c,a){this.reminderService=e,this.toaster=t,this.workspaceService=n,this.translate=i,this.cd=c,this.analyticsService=a,this.unsubscribe$=new Fn.a,this.isTeamDropdownOpen=!1,this.inProgress=!1,this.containsFilter={ids:[],contains:EI.a.CONTAINS,status:on.l.ACTIVE},this.allSelected=!1,this.createdReminder=new s.n,this.lessMore=[new Un.a(!0,"TEAMS.SHARED.LESS_LABEL"),new Un.a(!1,"TEAMS.REMINDERS.MORE_LABEL")],this.dateRanges=[new Un.a("day","TEAMS.REMINDERS.DATE_RANGE.DAY_LABEL"),new Un.a("week","TEAMS.REMINDERS.DATE_RANGE.WEEK_LABEL"),new Un.a("month","GLOBAL.MONTH_LABEL")],this.filterOptions=[new Un.a(on.l.ALL,"GLOBAL.ALL_LABEL"),new Un.a(on.l.ACTIVE,"GLOBAL.ACTIVE_LABEL"),new Un.a(on.l.INACTIVE,"GLOBAL.INACTIVE_LABEL")],this.days=["TEAMS.REMINDERS.WEEKDAYS.MONDAY","TEAMS.REMINDERS.WEEKDAYS.TUESDAY","TEAMS.REMINDERS.WEEKDAYS.WEDNESDAY","TEAMS.REMINDERS.WEEKDAYS.THURSDAY","TEAMS.REMINDERS.WEEKDAYS.FRIDAY","TEAMS.REMINDERS.WEEKDAYS.SATURDAY","TEAMS.REMINDERS.WEEKDAYS.SUNDAY"],this.receiverLabels=new Map([["TEAMS.REMINDERS.RECEIVER_LABELS.THEM",mI.USERS],["TEAMS.REMINDERS.RECEIVER_LABELS.THEIR_MANAGERS",mI.MANAGERS],["TEAMS.REMINDERS.RECEIVER_LABELS.ALL_ADMINS",mI.ADMINS]]),this.query={page:1,limit:50,name:"",statuses:[on.l.ACTIVE,on.l.INACTIVE,on.l.PENDING]},this.show=!0}ngOnInit(){this.isTeamDropdownOpen=!1,this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.newReminder=new gI,this.newReminder.less=!0,this.newReminder.days=this.workspace.workingDays.map(e=>ho.a[e].valueOf()),this.initReceivers()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}setLess(e){this.newReminder.less=e}setRange(e){this.newReminder.dateRange=e}openTeamDropdown(){this.isTeamDropdownOpen=!0}addReminder(){var e;if(this.inProgress=!0,"day"==this.newReminder.dateRange.toLowerCase()){if(0===this.newReminder.days.length)return this.reminderService.toastForEmptyDays(!0),void(this.inProgress=!1)}else this.newReminder.days=[0,1,2,3,4,5,6];if(!(null===(e=this.containsFilter.ids)||void 0===e?void 0:e.length)&&this.containsFilter.contains!=EI.a.DOES_NOT_CONTAIN)return this.toaster.pop("error",this.translate.instant("TEAMS.REMINDERS.ERRORS.NO_ASSIGNEES_ADDED")),void(this.inProgress=!1);this.reminderService.createReminder(this.newReminder,this.activeWorkspaceId,this.containsFilter).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.resetReminder(),this.createdReminder.emit(e),this.inProgress=!1,this.resetMembersDropdown(),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"add",section:"Team",section2:"Reminders"}))},()=>{this.inProgress=!1})}resetMembersDropdown(){this.show=!1,setTimeout(()=>{this.show=!0,this.cd.detectChanges()},100)}toggleDay(e){const t=this.newReminder.days.indexOf(e);-1!==t?this.newReminder.days.splice(t,1):this.newReminder.days.push(e),this.newReminder.days=[...this.newReminder.days]}resetReminder(){this.newReminder=new gI,this.newReminder.less=!0,this.allSelected=!1,this.newReminder.days=this.workspace.workingDays.map(e=>ho.a[e].valueOf()),this.initReceivers()}initReceivers(){this.receiversDropdown=[new Un.a(!0,"TEAMS.REMINDERS.RECEIVER_LABELS.THEM"),new Un.a(!1,"TEAMS.REMINDERS.RECEIVER_LABELS.THEIR_MANAGERS"),new Un.a(!1,"TEAMS.REMINDERS.RECEIVER_LABELS.ALL_ADMINS")]}onStatusChange(e){this.newReminder.receivers=Un.a.getLabelsOf(e,!0).map(e=>this.receiverLabels.get(e))}updateUsers(e){this.containsFilter.contains=e.users.contains,this.containsFilter.status=e.users.status,this.containsFilter.ids=e.users.ids?e.users.ids:[],e.userGroups&&e.userGroups.ids&&(this.containsFilter.ids=[...this.containsFilter.ids,...e.userGroups.ids])}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(SI),s.Rb(r.a),s.Rb(l.a),s.Rb(g.f),s.Rb(s.h),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["new-reminder"]],inputs:{activeWorkspaceId:"activeWorkspaceId",currentStatus:"currentStatus"},outputs:{createdReminder:"createdReminder"},decls:41,vars:42,consts:[[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-row"],[1,"cl-col-12"],[1,"cl-form-group","cl-mb-0"],[1,"cl-form-row","cl-align-items-center","cl-justify-content-lg-end"],[1,"cl-col-auto"],["class","cl-mx-1",3,"isAdminOrOwner","userIds","userAndUserGroups",4,"ngIf"],[1,"cl-d-inline-block","cl-mx-1",3,"type","list","value","onChanged"],["dropdownKey","",1,"cl-dropdown","cl-mx-1","cl-dropdown-position-mobile"],["dropdownKeyButton","","tabindex","0","ngDefaultControl","",3,"ngModel","ngModelChange"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["dropdownClose","","tabindex","0",1,"cl-no-focus-tabindex"],[1,"cl-mr-1"],[1,"cl-d-inline-block",3,"type","list","value","onChanged"],["class","cl-dropdown cl-mx-1","dropdownKey","",4,"ngIf"],[1,"cl-d-inline-block","cl-mx-1",3,"type","verboseTitle","lowercaseTitle","disableFirst","list","showPlaceholder","onChange"],["type","button",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[1,"cl-mx-1",3,"isAdminOrOwner","userIds","userAndUserGroups"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-p-3","cl-my-n1"],["type","number","name","hours","autocomplete","off","inputNumber","",1,"cl-form-control",3,"ngModel","minNumber","ngModelChange","keyup.enter"],["hours",""],["dropdownKey","",1,"cl-dropdown","cl-mx-1"],["dropdownKeyButton",""],[4,"ngIf","ngIfElse"],["selectDays",""],["class","cl-dropdown-menu cl-prevent-close",4,"dropdownKeyContent"],[1,"cl-dropdown-menu","cl-prevent-close"],[1,"cl-scroll-area"],["class","cl-dropdown-item cl-dropdown-item-checkbox cl-cut-text-wrapper",4,"ngFor","ngForOf"],[1,"cl-dropdown-item","cl-dropdown-item-checkbox","cl-cut-text-wrapper"],[1,"cl-custom-control","cl-custom-checkbox",3,"click"],["type","checkbox",1,"cl-custom-control-input",3,"checked"],[1,"cl-custom-control-label"],[1,"cl-cut-text"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"div",5),s.Xb(6,"div"),s.Xb(7,"span"),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Xc(10,cP,1,2,"members-dropdown",6),s.Xb(11,"span"),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xb(14,"dropdown-items",7),s.jc("onChanged",(function(e){return t.newReminder.less=e})),s.oc(15,"translate"),s.oc(16,"translate"),s.Wb(),s.Xb(17,"span"),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Xb(20,"span",8),s.Xb(21,"a",9),s.jc("ngModelChange",(function(e){return t.newReminder.hours=e})),s.Zc(22),s.Wb(),s.Xc(23,aP,4,2,"div",10),s.Sb(24,"span",11),s.Wb(),s.Xb(25,"span",12),s.Zc(26),s.oc(27,"translate"),s.Wb(),s.Xb(28,"dropdown-items",13),s.jc("onChanged",(function(e){return t.newReminder.dateRange=e})),s.Wb(),s.Xc(29,dP,9,5,"span",14),s.Xb(30,"span"),s.Zc(31),s.oc(32,"translate"),s.Wb(),s.Xb(33,"dropdown-checkbox-list",15),s.jc("onChange",(function(e){return t.onStatusChange(e)})),s.Wb(),s.Xb(34,"span"),s.Zc(35),s.oc(36,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(37,"div",5),s.Xb(38,"button",16),s.jc("click",(function(){return t.addReminder()})),s.Zc(39),s.oc(40,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(8),s.ad(s.pc(9,24,"GLOBAL.PART_OF_SENTENCE")),s.Cb(2),s.wc("ngIf",t.show),s.Cb(2),s.ad(s.pc(13,26,"TEAMS.REMINDERS.CREATE.SENTENCE.THIRD_PART")),s.Cb(2),s.wc("type","TEXT")("list",t.lessMore)("value",t.newReminder.less?s.pc(15,28,"TEAMS.SHARED.LESS_LABEL"):s.pc(16,30,"TEAMS.REMINDERS.CREATE.SENTENCE.FOURTH_PART.MORE")),s.Cb(4),s.ad(s.pc(19,32,"TEAMS.REMINDERS.CREATE.SENTENCE.FIFTH_PART")),s.Cb(3),s.wc("ngModel",t.newReminder.hours),s.Cb(1),s.ad(t.newReminder.hours),s.Cb(4),s.ad(s.pc(27,34,"TEAMS.REMINDERS.CREATE.SENTENCE.SIXTH_PART")),s.Cb(2),s.wc("type","TEXT")("list",t.dateRanges)("value",t.newReminder.dateRange),s.Cb(1),s.wc("ngIf","day"==t.newReminder.dateRange.toLowerCase()),s.Cb(2),s.ad(s.pc(32,36,"TEAMS.REMINDERS.CREATE.SENTENCE.EIGHTH_PART")),s.Cb(2),s.wc("type","TEXT")("verboseTitle",!0)("lowercaseTitle",!1)("disableFirst",!0)("list",t.receiversDropdown)("showPlaceholder",!1),s.Cb(2),s.ad(s.pc(36,38,"TEAMS.REMINDERS.CREATE.SENTENCE.NINTH_PART")),s.Cb(3),s.wc("disabled",t.inProgress),s.Cb(1),s.ad(s.pc(40,40,"GLOBAL.ADD_LABEL")))},directives:[i.u,ji.a,ni.a,ii.a,v.c,v.s,v.v,si.a,ri,AX,v.y,jr.a,i.t],pipes:[g.e,sP.a],encapsulation:2,changeDetection:0}),e})();function pP(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",12),s.Xb(1,"div",13),s.Xb(2,"input",14,15),s.jc("blur",(function(){return s.Oc(e),s.nc().editHours()}))("keyup.enter",(function(){return s.Oc(e),s.Lc(3).blur()}))("ngModelChange",(function(t){return s.Oc(e),s.nc().reminder.hours=t})),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.wc("ngModel",e.reminder.hours)("minNumber",0)}}function hP(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",22),s.Xb(1,"div",23),s.jc("click",(function(){s.Oc(e);const n=t.index;return s.nc(3).toggleDay(n)})),s.Sb(2,"input",24),s.Xb(3,"label",25),s.Xb(4,"div",26),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit,n=t.index,i=s.nc(3);s.Cb(2),s.wc("checked",i.reminder.days.indexOf(n)>-1),s.Cb(3),s.ad(s.pc(6,2,e))}}function mP(e,t){if(1&e&&(s.Xb(0,"div",19),s.Xb(1,"div",20),s.Xc(2,hP,7,4,"div",21),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.wc("ngForOf",e.days)}}function gP(e,t){if(1&e){const e=s.Yb();s.Xb(0,"span",16),s.jc("onClose",(function(){s.Oc(e);const t=s.nc();return t.updateReminder(t.reminder)})),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"a",17),s.Zc(5),s.oc(6,"displayDayOfWeek"),s.Wb(),s.Xc(7,mP,3,1,"div",18),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,2,"TEAMS.REMINDERS.CREATE.SENTENCE.SEVENTH_PART.DAY_ON_MONDAY")),s.Cb(3),s.ad(s.pc(6,4,e.reminder.days))}}function EP(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",27),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return i.deleteReminder(i.reminder,n)}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"uppercase"),s.oc(3,"translate"),s.Xb(4,"p",28),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,5,"TEAMS.REMINDERS.DELETE.TITLE"))("btnText",s.pc(2,7,s.pc(3,9,"GLOBAL.DELETE_BTN")))("isDanger",!0)("inProgress",e.inProgress),s.Cb(5),s.ad(s.pc(6,11,"TEAMS.REMINDERS.DELETE.CONFIRM"))}}let fP=(()=>{class e{constructor(e,t,n,i){this.reminderService=e,this.modalService=t,this.toaster=n,this.translate=i,this.totalsExist=!1,this.numberOfSelectedEntities=0,this.reminders=[],this._userGroups=[],this.initUsersLoaded=!1,this.deletedReminder=new s.n,this.onReminderUpdated=new s.n,this.unsubscribe$=new Fn.a,this.userFilterOptions=[new Un.a("ALL","All"),new Un.a(on.l.ACTIVE,"Active"),new Un.a(on.l.INACTIVE,"Inactive")],this.ReportFilter=on.i,this.projectValuesData=new wn.a,this.lessMore=[new Un.a(!0,"TEAMS.SHARED.LESS_LABEL"),new Un.a(!1,"TEAMS.REMINDERS.MORE_LABEL")],this.dateRanges=[new Un.a("DAY","TEAMS.REMINDERS.DATE_RANGE.DAY_LABEL"),new Un.a("WEEK","TEAMS.REMINDERS.DATE_RANGE.WEEK_LABEL"),new Un.a("MONTH","GLOBAL.MONTH_LABEL")],this.receiverLabels=new Map([["TEAMS.REMINDERS.RECEIVER_LABELS.THEM",mI.USERS],["TEAMS.REMINDERS.RECEIVER_LABELS.THEIR_MANAGERS",mI.MANAGERS],["TEAMS.REMINDERS.RECEIVER_LABELS.ALL_ADMINS",mI.ADMINS]]),this.receiversDropdown=[],this.userGroupIds=[],this.userIds=[],this.selectedEntityName=[],this.days=["TEAMS.REMINDERS.WEEKDAYS.MONDAY","TEAMS.REMINDERS.WEEKDAYS.TUESDAY","TEAMS.REMINDERS.WEEKDAYS.WEDNESDAY","TEAMS.REMINDERS.WEEKDAYS.THURSDAY","TEAMS.REMINDERS.WEEKDAYS.FRIDAY","TEAMS.REMINDERS.WEEKDAYS.SATURDAY","TEAMS.REMINDERS.WEEKDAYS.SUNDAY"]}set usersCount(e){e&&(this._usersCount=e,this.calculateTotal())}get usersCount(){return this._usersCount}set userGroups(e){this._userGroups=e,this.setUserAndUserGroupIds(),this.setUsersAndGroupsLabel(),this.calculateTotal()}get userGroups(){return this._userGroups}set allUsers(e){e&&0!==e.length&&(this._allUsers=e,this.setUserAndUserGroupIds(),this.setUsersAndGroupsLabel(),this.initUsersLoaded=!0,this._allUsers=e)}get allUsers(){return this._allUsers}ngOnInit(){for(const[e,t]of this.receiverLabels)this.receiversDropdown.push(new Un.a(this.reminder.receivers.includes(t),e));this.reminderUsersBefore=[...this.reminder.users]}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}setUsersAndGroupsLabel(e=!1){var t,n,i,s,c,a;(e||this.selectedEntityName!==[])&&(this.allUsers||this.userGroups)&&(this.getNumberOfSelectedEntities(),this.selectedEntityName=[this.translate.instant("GLOBAL.NONE_LABEL")],1===this.reminder.users.length&&(this.selectedEntityName="everyone"===(null===(n=null===(t=this.reminder)||void 0===t?void 0:t.users[0])||void 0===n?void 0:n.toLowerCase())?[this.translate.instant("GLOBAL.EVERYONE_LABEL")]:[(null===(s=null===(i=this.userGroups)||void 0===i?void 0:i.find(e=>{var t;return e.id==(null===(t=this.reminder)||void 0===t?void 0:t.users[0])}))||void 0===s?void 0:s.name)||(null===(a=null===(c=this.allUsers)||void 0===c?void 0:c.find(e=>{var t;return e.id===(null===(t=this.reminder)||void 0===t?void 0:t.users[0])}))||void 0===a?void 0:a.name)]))}setAllSelected(e){this.allSelectedReminder=e,this.areAllUsersSelected()}toggleDay(e){const t=this.reminder.days.indexOf(e);if(-1!==t){if(1===this.reminder.days.length)return;this.reminder.days.splice(t,1)}else this.reminder.days.push(e);this.reminder.days=[...this.reminder.days]}deleteReminder(e,t){this.inProgress=!0,this.reminderService.deleteReminder(e.id,this.activeWorkspaceId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.deletedReminder.emit(),this.inProgress=!1,t.close(),this.closeAllDropdowns()},()=>this.inProgress=!1)}editDateRange(e){this.reminderService.updateReminder(e,this.activeWorkspaceId),this.closeAllDropdowns()}editLess(e,t){e.less!==t?(e.less=t,this.reminderService.updateReminder(e,this.activeWorkspaceId),this.closeAllDropdowns()):this.closeAllDropdowns()}editHours(){this.reminderService.updateReminder(this.reminder,this.activeWorkspaceId)}editReceivers(e){this.reminderService.updateReminder(e,this.activeWorkspaceId)}calculateTotal(){var e;this.userGroups&&this.usersCount&&(this.totalEntities=this.usersCount+(null===(e=this.userGroups)||void 0===e?void 0:e.length),this.areAllUsersSelected(),this.totalsExist=!0)}areAllUsersSelected(){this.allEntitiesSelected=this.allSelectedReminder||this.totalEntities===this.reminder.users.length}updateReminder(e){const t=this.reminder.users.filter(e=>!this.reminderUsersBefore.includes(e));e.containsFilter||(e.containsFilter={ids:e.users,contains:this.allSelectedReminder?EI.a.DOES_NOT_CONTAIN:EI.a.CONTAINS,status:this.currentUserStatus}),this.reminderService.updateReminder(e,this.activeWorkspaceId),this.reminderUsersBefore=[...this.reminder.users],this.onReminderUpdated.emit(t)}closeAllDropdowns(){if(this.daysDropdown){const e=this.reminders.filter(e=>e.id==this.daysDropdown)[0];if(0==e.days.length)return void this.reminderService.toastForEmptyDays(!1);this.updateReminder(e)}}openDeleteModal(e){this.modalService.open(e,{centered:!0})}onStatusChange(e){this.reminder.receivers=Un.a.getLabelsOf(e,!0).map(e=>this.receiverLabels.get(e)),this.reminderService.updateReminder(this.reminder,this.activeWorkspaceId)}getNumberOfSelectedEntities(){this.numberOfSelectedEntities=this.allSelectedReminder?this.totalEntities-this.reminder.users.length:this.reminder.users.length,this.oneEntitySelected()}oneEntitySelected(){this.teamDropdown||(this.onlyOneEntitySelected=1===this.numberOfSelectedEntities&&!this.allSelectedReminder)}updateUsers(e){var t,n;this.reminder.containsFilter={ids:[],contains:(null===(t=e.users)||void 0===t?void 0:t.contains)||EI.a.CONTAINS,status:(null===(n=e.users)||void 0===n?void 0:n.status)||on.l.ALL},e.users&&e.users.ids&&(this.reminder.containsFilter.ids=[...this.reminder.containsFilter.ids,...e.users.ids]),e.userGroups&&e.userGroups.ids&&(this.reminder.containsFilter.ids=[...this.reminder.containsFilter.ids,...e.userGroups.ids]),this.updateReminder(this.reminder)}setUserAndUserGroupIds(){if(this.allUsers){const e=this.allUsers.map(e=>e.id);this.userIds=this.reminder.users.filter(t=>e.includes(t)||"everyone"===t),this.userGroupIds=this.reminder.users.filter(t=>!e.includes(t))}else if(this.userGroups){const e=this.userGroups.map(e=>e.id);this.userIds=this.reminder.users.filter(t=>!e.includes(t)),this.userGroupIds=this.reminder.users.filter(t=>e.includes(t))}}errorOnUpdate(){this.toaster.pop("error",this.translate.instant("SERVICES.REMINDER.UPDATE.ERROR_MESSAGE"),this.translate.instant("SERVICES.REMINDER.UPDATE.NO_TEAM_MEMBERS_ERROR_MESSAGE"))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(SI),s.Rb(w.q),s.Rb(r.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["reminder-row"]],inputs:{workspace:"workspace",reminder:"reminder",activeWorkspaceId:"activeWorkspaceId",usersCount:"usersCount",reminders:"reminders",userGroups:"userGroups",allUsers:"allUsers",currentUserStatus:"currentUserStatus"},outputs:{deletedReminder:"deletedReminder",onReminderUpdated:"onReminderUpdated"},decls:33,vars:39,consts:[[1,"cl-mx-1",3,"selectedEntityName","userSize","disableCloseIfNoSelected","userIds","userGroupIds","isAdminOrOwner","userAndUserGroups","sendErrorOnEdit"],[1,"cl-d-inline-block","cl-ml-1",3,"type","list","value","onChanged"],["dropdownKey","",1,"cl-dropdown","cl-dropdown-position-mobile","cl-mx-1"],["dropdownKeyButton","","tabindex","0","ngDefaultControl","",3,"ngModel","ngModelChange"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["dropdownClose","","tabindex","0",1,"cl-no-focus-tabindex"],[1,"cl-d-inline-block",3,"type","list","value","onChanged"],["class","cl-dropdown cl-mx-1","dropdownKey","",3,"onClose",4,"ngIf"],[1,"cl-d-inline-block",3,"type","disableFirst","verboseTitle","lowercaseTitle","list","showPlaceholder","onChange"],[1,"cl-component-divided-left","cl-d-flex","cl-w-auto",3,"click"],["src","assets/images/ui-icons/close.svg"],["deleteModal",""],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-p-3","cl-my-n1"],["type","number","name","hours","autocomplete","off","inputNumber","",1,"cl-form-control",3,"ngModel","minNumber","blur","keyup.enter","ngModelChange"],["hours",""],["dropdownKey","",1,"cl-dropdown","cl-mx-1",3,"onClose"],["dropdownKeyButton",""],["class","cl-dropdown-menu cl-prevent-close",4,"dropdownKeyContent"],[1,"cl-dropdown-menu","cl-prevent-close"],[1,"cl-scroll-area"],["class","cl-dropdown-item cl-dropdown-item-checkbox cl-cut-text-wrapper",4,"ngFor","ngForOf"],[1,"cl-dropdown-item","cl-dropdown-item-checkbox","cl-cut-text-wrapper"],[1,"cl-custom-control","cl-custom-checkbox",3,"click"],["type","checkbox",1,"cl-custom-control-input",3,"checked"],[1,"cl-custom-control-label"],[1,"cl-cut-text"],[3,"title","btnText","isDanger","inProgress","confirmed","close"],[1,"cl-mb-0"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"members-dropdown",0),s.jc("userAndUserGroups",(function(e){return t.updateUsers(e)}))("sendErrorOnEdit",(function(){return t.errorOnUpdate()})),s.Wb(),s.Xb(5,"span"),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"dropdown-items",1),s.jc("onChanged",(function(e){return t.editLess(t.reminder,e)})),s.Wb(),s.Xb(9,"span"),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Xb(12,"span",2),s.Xb(13,"a",3),s.jc("ngModelChange",(function(e){return t.reminder.hours=e})),s.Zc(14),s.Wb(),s.Xc(15,pP,4,2,"div",4),s.Wb(),s.Sb(16,"span",5),s.Xb(17,"span"),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Xb(20,"dropdown-items",6),s.jc("onChanged",(function(e){return t.reminder.dateRange=e,t.editDateRange(t.reminder)})),s.Wb(),s.Xc(21,gP,8,6,"span",7),s.Xb(22,"span"),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Xb(25,"dropdown-checkbox-list",8),s.jc("onChange",(function(e){return t.onStatusChange(e)})),s.Wb(),s.Xb(26,"span"),s.Zc(27),s.oc(28,"translate"),s.Wb(),s.Wb(),s.Xb(29,"a",9),s.jc("click",(function(){s.Oc(e);const n=s.Lc(32);return t.openDeleteModal(n)})),s.Sb(30,"img",10),s.Wb(),s.Xc(31,EP,7,13,"ng-template",null,11,s.Yc)}2&e&&(s.Cb(2),s.ad(s.pc(3,27,"GLOBAL.PART_OF_SENTENCE")),s.Cb(2),s.wc("selectedEntityName",t.selectedEntityName)("userSize",t.numberOfSelectedEntities)("disableCloseIfNoSelected",!0)("userIds",t.userIds)("userGroupIds",t.userGroupIds)("isAdminOrOwner",!0),s.Cb(2),s.ad(s.pc(7,29,"TEAMS.REMINDERS.CREATE.SENTENCE.THIRD_PART")),s.Cb(2),s.wc("type","TEXT")("list",t.lessMore)("value",t.reminder.less),s.Cb(2),s.bd(" ",s.pc(11,31,"TEAMS.REMINDERS.CREATE.SENTENCE.FIFTH_PART"),""),s.Cb(3),s.wc("ngModel",t.reminder.hours),s.Cb(1),s.ad(t.reminder.hours),s.Cb(4),s.bd("",s.pc(19,33,"TEAMS.REMINDERS.CREATE.SENTENCE.SIXTH_PART")," "),s.Cb(2),s.wc("type","TEXT")("list",t.dateRanges)("value",t.reminder.dateRange),s.Cb(1),s.wc("ngIf","day"==t.reminder.dateRange.toLowerCase()),s.Cb(2),s.bd("",s.pc(24,35,"TEAMS.REMINDERS.CREATE.SENTENCE.EIGHTH_PART")," "),s.Cb(2),s.wc("type","TEXT")("disableFirst",!1)("verboseTitle",!0)("lowercaseTitle",!1)("list",t.receiversDropdown)("showPlaceholder",!1),s.Cb(2),s.bd(" ",s.pc(28,37,"TEAMS.REMINDERS.CREATE.SENTENCE.NINTH_PART"),""))},directives:[AX,ji.a,ni.a,ii.a,v.c,v.s,v.v,si.a,i.u,ri,v.y,jr.a,i.t,Si.a],pipes:[g.e,sP.a,i.I],encapsulation:2}),e})();const SP=function(){return["/upgrade"]},CP=function(){return{plan:"standard"}};function AP(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",9),s.Xb(1,"div",10),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",11),s.jc("click",(function(){return s.Oc(e),s.nc().analyticsService.addEventOnSettingsChanged("Standard","Upgrade","Team","Reminders","","Upgrade")})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,4,"TEAMS.FEATURE.STANDARD")," "),s.Cb(2),s.wc("routerLink",s.Ac(8,SP))("queryParams",s.Ac(9,CP)),s.Cb(1),s.bd(" ",s.pc(6,6,"GLOBAL.UPGRADE_BTN")," "))}function OP(e,t){1&e&&s.Sb(0,"div",12)}function vP(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"reminder-row",13),s.jc("deletedReminder",(function(){s.Oc(e);const n=t.index;return s.nc().deleteReminder(n)}))("onReminderUpdated",(function(t){return s.Oc(e),s.nc().getMissingUsers(t)})),s.Wb(),s.Ub()}if(2&e){const e=t.$implicit,n=s.nc();s.Cb(1),s.wc("reminder",e)("activeWorkspaceId",n.activeWorkspaceId)("usersCount",n.usersCount)("reminders",n.reminders)("allUsers",n.allUsers)("currentUserStatus",n.userStatus)("workspace",n.workspace)("userGroups",n.userGroups)}}let TP=(()=>{class e{constructor(e,t,n,i,s,c,a,o){this.userService=e,this.userGroupService=t,this.workspaceService=n,this.reminderService=i,this.uiService=s,this.cd=c,this.translate=a,this.analyticsService=o,this.reminders=[],this.teamMaps=[],this.userGroups=[],this.allUsers=[],this.userStatus=on.l.ACTIVE,this.gotAllUserNames=!1,this.unsubscribe$=new Fn.a,this.userGroupIds=[],this.usersCount=0,this.loadedAllUsers=!1,this.searchName="",this.currentPage=1}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.hasRemindersFeature=this.workspace.hasFeature(is.a.TARGETS_AND_REMINDERS),this.initialize(),this.reminderService.reminderUpdated.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.getUserNames(e.users),this.reminders=this.reminders.map(t=>t.id===e.id?e:t)})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initialize(){this.uiService.setSettings(xn.b.REMINDER_USER_FILTER,"ALL"),this.getUserStatus(),this.hasRemindersFeature&&(this.activeWorkspaceId=this.workspaceService.getDefaultWorkspaceId(),this.userGroupService.userGroups.pipe(Object(iP.a)()).subscribe(e=>{this.userGroups=e.filter(e=>"Admins"!==e.name),this.userGroupIds=this.userGroups.map(e=>e.id)}),this.getReminders(),this.userGroupService.getAllUserGroups(this.activeWorkspaceId))}getUserStatus(){this.userStatus=this.uiService.getSettings(xn.b.REMINDER_USER_FILTER)||"ACTIVE"}addNewReminder(e){this.getMissingUsers(e.users,e)}deleteReminder(e){this.reminders.splice(e,1),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"delete",section:"Team",section2:"Reminders"}))}getMissingUsers(e,t){const n=e.filter(e=>!this.allUsers.map(e=>e.id).includes(e));n.length>0?this.workspaceService.getUsersByIds(n).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.allUsers=[...this.allUsers,...e],this.removeDuplicatesFromAllUsers(),t&&this.reminders.unshift(t)}):t&&this.reminders.unshift(t)}getReminders(){this.reminderService.getReminders(this.activeWorkspaceId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.reminders=e;let t=[];e.forEach(e=>t=[...t,...e.users]),this.getUserNames(t)})}getUserNames(e){this.workspaceService.getUsersByIds(e).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.allUsers=[...this.allUsers,...e],this.removeDuplicatesFromAllUsers(),this.cd.detectChanges()})}removeDuplicatesFromAllUsers(){this.allUsers=this.allUsers.filter((e,t,n)=>t===n.findIndex(t=>t.id===e.id))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(q.a),s.Rb(WL.a),s.Rb(l.a),s.Rb(SI),s.Rb(xn.a),s.Rb(s.h),s.Rb(g.f),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["reminders"]],decls:13,vars:8,consts:[[1,"cl-tab-pane","cl-fade","cl-show","cl-active"],["class","cl-form-group",4,"ngIf"],[1,"cl-relative"],["class","cl-blocker",4,"ngIf"],[3,"activeWorkspaceId","currentStatus","createdReminder"],[1,"cl-card","cl-border-bottom"],[1,"cl-card-header","cl-px-2","cl-px-lg-3"],[1,"cl-h6","cl-mb-0"],[4,"ngFor","ngForOf"],[1,"cl-form-group"],[1,"cl-alert","cl-alert-info","cl-mb-0"],[1,"cl-btn",3,"routerLink","queryParams","click"],[1,"cl-blocker"],[1,"cl-component-row","cl-pr-0","cl-d-flex","cl-w-100","cl-justify-content-between","cl-align-items-center",3,"reminder","activeWorkspaceId","usersCount","reminders","allUsers","currentUserStatus","workspace","userGroups","deletedReminder","onReminderUpdated"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xc(1,AP,7,10,"div",1),s.Xb(2,"div",2),s.Xc(3,OP,1,0,"div",3),s.Vb(4),s.Xb(5,"new-reminder",4),s.jc("createdReminder",(function(e){return t.addNewReminder(e)})),s.Wb(),s.Ub(),s.Xb(6,"div",5),s.Xb(7,"div",6),s.Xb(8,"span",7),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Vb(11),s.Xc(12,vP,2,8,"ng-container",8),s.Ub(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(1),s.wc("ngIf",!1===t.hasRemindersFeature),s.Cb(2),s.wc("ngIf",!t.hasRemindersFeature),s.Cb(2),s.wc("activeWorkspaceId",t.activeWorkspaceId)("currentStatus",t.userStatus),s.Cb(4),s.ad(s.pc(10,6,"TEAMS.REMINDERS.TITLE")),s.Cb(3),s.wc("ngForOf",t.reminders))},directives:[i.u,uP,i.t,k.g,fP],pipes:[g.e],encapsulation:2}),e})();const IP=function(){return["/subscription"]};function wP(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"div",20),s.Xb(2,"span"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"a",21),s.jc("click",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(30);return t.openFeaturesInfo(n)})),s.Sb(6,"img",22),s.Wb(),s.Xb(7,"a",23),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Xb(10,"div",24),s.Sb(11,"div",25),s.Wb(),s.Xb(12,"p",26),s.Zc(13),s.oc(14,"translate"),s.oc(15,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.ad(s.pc(4,13,"GLOBAL.USER_SEATS_TITLE")),s.Cb(4),s.wc("routerLink",s.Ac(21,IP)),s.Cb(1),s.ad(s.pc(9,15,"GLOBAL.MANAGE_LABEL")),s.Cb(3),s.Wc("width",e.percentage+"%"),s.Hb("cl-progress-bar-success-blue",!e.isUsedAllSeats)("cl-bg-danger",e.isUsedAllSeats),s.Cb(2),s.ed("",e.activeMembers," ",s.pc(14,17,"TEAMS.SEATS.USED.SENTENCE.ACTIVE_OF")," ",e.quantity," ",s.pc(15,19,"TEAMS.SEATS.USED.SENTENCE.FROM_QUANTITY_USED"),"")}}const LP=function(){return["/teams"]};function RP(e,t){if(1&e&&(s.Xb(0,"li",8),s.Xb(1,"a",27),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.Hb("cl-active","REMINDERS"===e.activePill),s.wc("routerLink",s.Ac(6,LP)),s.Cb(1),s.bd(" ",s.pc(3,4,"TEAMS.REMINDERS.TITLE"),"")}}function yP(e,t){if(1&e){const e=s.Yb();s.Xb(0,"members-tab",28),s.jc("recalculateQuantity",(function(t){return s.Oc(e),s.nc().recalculateQuantity(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("isAdminOrOwner",e.isAdminOrOwner)("currentUserId",e.currentUserId)("quantity",e.quantity)("amount",e.amount)("isOwner",e.isOwner)("ownerId",e.ownerId)("activeMembersLength",e.activeMembers)("isLoaded",e.isPaymentDataLoaded)}}function _P(e,t){if(1&e&&s.Sb(0,"groups-tab",29),2&e){const e=s.nc();s.wc("isAdminOrOwner",e.isAdminOrOwner)("ownerId",e.ownerId)("currentUserId",e.currentUserId)}}function kP(e,t){1&e&&s.Sb(0,"reminders")}function WP(e,t){1&e&&(s.Xb(0,"add-members",30),s.jc("onClose",(function(){return t.$implicit.close()})),s.Wb())}function XP(e,t){1&e&&(s.Xb(0,"transfer-owner-role",30),s.jc("onClose",(function(){return t.$implicit.close()})),s.Wb())}function NP(e,t){1&e&&(s.Xb(0,"features-info",31),s.jc("close",(function(){return t.$implicit.close()})),s.Wb()),2&e&&s.wc("type","user-seats")}let DP=(()=>{class e{constructor(e,t,n,i,s){this.activatedRoute=e,this.router=t,this.authService=n,this.modalService=i,this.workspaceService=s,this.unsubscribe$=new p.a,this.activePill="MEMBERS",this.activeMembers=0,this.quantity=0,this.PaymentType=mo.a}ngOnInit(){this.currentUserId=JSON.parse(localStorage.getItem("user")).id,this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.getOwnerId(),this.authService.permissionData$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(({isAdminOrOwner:e})=>{this.isAdminOrOwner=e}),this.activatedRoute.fragment.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{const t=jW[(e||"").toUpperCase()];this.activePill=t||jW.MEMBERS,t||this.router.navigate([])}),this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.featureType=this.workspace.featureSubscriptionType&&mo.a[this.workspace.featureSubscriptionType.replace("SPECIAL","PLUS")],this.workspaceService.payment.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.quantity=e.quantity,this.amount=e.amount,this.activeMembers=this.workspace.memberships.filter(e=>e.isActiveOrPending).length,this.percentage=e.quantity?100*this.activeMembers/e.quantity:0,this.isUsedAllSeats=this.percentage>=100,this.isPaymentDataLoaded=!0}),this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e;const t=e.memberships.filter(e=>e.isActiveOrPending);this.recalculateQuantity(t?t.length:0)}),this.featureType&&this.featureType.bySeat&&this.isAdminOrOwner?this.workspaceService.getPaymentDate(this.workspace.id):this.isPaymentDataLoaded=!0}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}getOwnerId(){this.workspaceService.getWorkspaceOwner().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.ownerId=e.ownerId,this.isOwner=e.isOwner})}recalculateQuantity(e){this.percentage=this.quantity?100*e/this.quantity:0,this.activeMembers=e,this.isUsedAllSeats=this.percentage>=100}openFeaturesInfo(e){this.modalService.open(e,{size:"lg",centered:!0})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.a),s.Rb(k.d),s.Rb(re.a),s.Rb(w.q),s.Rb(l.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["teams2"]],decls:31,vars:22,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper","cl-d-flex","cl-justify-content-between","cl-align-items-center"],[1,"cl-h1"],[4,"ngIf"],[1,"cl-scroll-tabs-wrapper"],["tabs","",1,"cl-nav","cl-nav-tabs","cl-m-0","cl-scroll-tabs"],["tabs","tabs"],[1,"cl-nav-item"],["fragment","members",1,"cl-nav-link",3,"routerLink"],["fragment","groups",1,"cl-nav-link",3,"routerLink"],["class","cl-nav-item",4,"ngIf"],[1,"cl-card"],[1,"cl-card-body"],[1,"cl-tab-content"],[3,"isAdminOrOwner","currentUserId","quantity","amount","isOwner","ownerId","activeMembersLength","isLoaded","recalculateQuantity",4,"ngIf"],[3,"isAdminOrOwner","ownerId","currentUserId",4,"ngIf"],["addMembersModal",""],["transferOwnerRoleModal",""],["featuresInfoModal",""],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-center","cl-mb-2"],[1,"cl-ml-1","cl-mr-5","cl-d-inline-flex",3,"click"],["src","assets/ui-icons/info-9.svg"],["fragment","payment",1,"cl-color-blue","cl-small",3,"routerLink"],[1,"cl-progress",2,"height","5px"],["role","progressbar",1,"cl-progress-bar"],[1,"cl-mt-1","cl-mb-0"],["fragment","reminders",1,"cl-nav-link",3,"routerLink"],[3,"isAdminOrOwner","currentUserId","quantity","amount","isOwner","ownerId","activeMembersLength","isLoaded","recalculateQuantity"],[3,"isAdminOrOwner","ownerId","currentUserId"],[3,"onClose"],[3,"type","close"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"h1",3),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,wP,16,22,"div",4),s.Wb(),s.Xb(7,"div",5),s.Xb(8,"ul",6,7),s.Xb(10,"li",8),s.Xb(11,"a",9),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Xb(14,"li",8),s.Xb(15,"a",10),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Wb(),s.Xc(18,RP,4,7,"li",11),s.Wb(),s.Wb(),s.Xb(19,"div",12),s.Xb(20,"div",13),s.Xb(21,"div",14),s.Xc(22,yP,1,8,"members-tab",15),s.Xc(23,_P,1,3,"groups-tab",16),s.Xc(24,kP,1,0,"reminders",4),s.Wb(),s.Wb(),s.Wb(),s.Xc(25,WP,1,0,"ng-template",null,17,s.Yc),s.Xc(27,XP,1,0,"ng-template",null,18,s.Yc),s.Wb(),s.Wb(),s.Xc(29,NP,1,1,"ng-template",null,19,s.Yc)),2&e&&(s.Cb(4),s.ad(s.pc(5,14,"GLOBAL.TEAM_LABEL")),s.Cb(2),s.wc("ngIf",t.featureType&&t.featureType.bySeat&&t.isAdminOrOwner),s.Cb(5),s.Hb("cl-active","MEMBERS"===t.activePill),s.wc("routerLink",s.Ac(20,LP)),s.Cb(1),s.bd(" ",s.pc(13,16,"GLOBAL.MEMBERS_LABEL"),""),s.Cb(3),s.Hb("cl-active","GROUPS"===t.activePill),s.wc("routerLink",s.Ac(21,LP)),s.Cb(1),s.bd(" ",s.pc(17,18,"GLOBAL.GROUPS_LABEL"),""),s.Cb(2),s.wc("ngIf",t.isAdminOrOwner),s.Cb(4),s.wc("ngIf","MEMBERS"==t.activePill),s.Cb(1),s.wc("ngIf","GROUPS"==t.activePill),s.Cb(1),s.wc("ngIf","REMINDERS"==t.activePill&&t.isAdminOrOwner))},directives:[i.u,lo.a,k.g,_D,nP,TP,tD,OX,BC],pipes:[g.e],encapsulation:2}),e})(),PP=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(){if(this.workspaceService.getLocalDefaultWorkspace().canSeeTracker)return!0;this.router.navigate(["timesheet"])}}return e.\u0275fac=function(t){return new(t||e)(s.fc(l.a),s.fc(k.d))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var MP=n("NTZZ"),BP=n("rnVd");class UP{constructor(e){var t,n;this._id=e&&e.id,this._name=e&&e.name,this._dateRangeStart=e&&e.dateRangeStart,this._dateRangeEnd=e&&e.dateRangeEnd,this._dateRangeType=BP.a[e&&e.dateRangeType],this._users=e&&e.users,this._userGroups=e&&e.userGroups,this._clients=e&&e.clients,this._projects=e&&e.projects,this._tasks=e&&e.tasks,this._tags=e&&e.tags,this._billable=e&&e.billable,this._description=e&&e.description,this._rounding=e&&e.rounding,this._amounts=e&&e.amounts,this._customFields=e&&e.customFields,this._userAndGroupNames=this.getUserAndGroupNames(),this._clientNames=e&&e.clients.map(e=>e.name).join(", ")||"",this._projectNames=e&&e.projects.map(e=>e.name).join(", ")||"",this._taskNames=e&&e.tasks.map(e=>e.name).join(", ")||"",this._tagNames=e&&e.tags.map(e=>e.name).join(", ")||"",this._exportElements=e&&(null===(t=null==e?void 0:e.exportElements)||void 0===t?void 0:t.map(e=>d_.a[e]||LW.a[e]||n_.a[e]).join(", "))||"",this._exportCustomFields=e&&(null===(n=null==e?void 0:e.exportCustomFields)||void 0===n?void 0:n.map(e=>e.name).join(", "))||""}getUserAndGroupNames(){const e=[];return this.userGroups&&this.userGroups.length&&e.push(this._userGroups.map(e=>e.name)),this.users&&this.users.length&&e.push(this._users.map(e=>e.name)),e.join(", ")}getAmount(e){switch(jy.a[e]){case jy.a.EARNED:return"Show amount";case jy.a.COST:return"Show cost";case jy.a.PROFIT:return"Show profit";case jy.a.HIDE_AMOUNT:return"Hide amount";default:return""}}get id(){return this._id}set id(e){this._id=e}get name(){return this._name}set name(e){this._name=e}get exportElements(){return this._exportElements}get formattedExportElements(){return this.exportElements+this.formattedCustomFieldsString}get formattedCustomFieldsString(){var e;return(null===(e=this.exportCustomFields)||void 0===e?void 0:e.length)>0?this.comma+this.exportCustomFields:""}get comma(){var e,t;return(null===(e=this.exportElements)||void 0===e?void 0:e.length)>0&&(null===(t=this.exportCustomFields)||void 0===t?void 0:t.length)>0?", ":""}set exportElements(e){this._exportElements=e}get exportCustomFields(){return this._exportCustomFields}get dateRangeStart(){return this._dateRangeStart}set dateRangeStart(e){this._dateRangeStart=e}get dateRangeEnd(){return this._dateRangeEnd}set dateRangeEnd(e){this._dateRangeEnd=e}get dateRangeType(){return this._dateRangeType}set dateRangeType(e){this._dateRangeType=e}get users(){return this._users}set users(e){this._users=e}get userGroups(){return this._userGroups}set userGroups(e){this._userGroups=e}get clients(){return this._clients}set clients(e){this._clients=e}get projects(){return this._projects}set projects(e){this._projects=e}get tasks(){return this._tasks}set tasks(e){this._tasks=e}get tags(){return this._tags}set tags(e){this._tags=e}get billable(){return this._billable}set billable(e){this._billable=e}get description(){return this._description}set description(e){this._description=e}get rounding(){return this._rounding}set rounding(e){this._rounding=e}get amounts(){return this._amounts}set amount(e){this._amounts=e}get customFields(){return this._customFields}set customFields(e){this._customFields=e}get formattedRange(){return this._formattedRange}set formattedRange(e){this._formattedRange=e}get userAndGroupNames(){return this._userAndGroupNames}set userAndGroupNames(e){this._userAndGroupNames=e}get userNames(){return this._userNames}set userNames(e){this._userNames=e}get userGroupNames(){return this._userGroupNames}set userGroupNames(e){this._userGroupNames=e}get clientNames(){return this._clientNames}set clientNames(e){this._clientNames=e}get projectNames(){return this._projectNames}set projectNames(e){this._projectNames=e}get taskNames(){return this._taskNames}set taskNames(e){this._taskNames=e}get tagNames(){return this._tagNames}set tagNames(e){this._tagNames=e}}function GP(e,t){1&e&&s.Tb(0)}function xP(e,t){if(1&e&&(s.Xb(0,"div",7),s.Xb(1,"div",8),s.Xb(2,"a",9),s.Zc(3),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.wc("href",e.report.link,s.Qc),s.Cb(1),s.bd(" ",e.report.name," ")}}function FP(e,t){1&e&&(s.Xb(0,"div",12),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.PUBLIC_LABEL")," "))}function jP(e,t){1&e&&(s.Xb(0,"div",12),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"REPORTS.SHARE_REPORT.LOCKED_DATEAS_LABEL")," "))}function ZP(e,t){1&e&&(s.Xb(0,"div",12),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"REPORTS.SHARE_REPORT.SCHEDULED_LABEL")," "))}function VP(e,t){if(1&e&&(s.Xb(0,"div",10),s.Xc(1,FP,3,3,"div",11),s.Xc(2,jP,3,3,"div",11),s.Xc(3,ZP,3,3,"div",11),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.report.isPublic),s.Cb(1),s.wc("ngIf",e.report.fixedDate),s.Cb(1),s.wc("ngIf",e.report.scheduledReport)}}function YP(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",13),s.Xb(1,"div",14),s.Sb(2,"input",15,16),s.Xb(4,"div",17),s.Xb(5,"button",18),s.jc("click",(function(){s.Oc(e);const t=s.Lc(3);return s.nc().copyInputUrl(t)})),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.wc("ngModel",e.report.link),s.Cb(4),s.bd(" ",s.pc(7,2,"GLOBAL.COPY_LABEL")," ")}}function HP(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",23),s.Xb(1,"div",24),s.Xb(2,"a",25),s.jc("click",(function(){return s.Oc(e),s.nc(2).openEditModal()})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"a",25),s.jc("click",(function(){return s.Oc(e),s.nc(2).filterInfo()})),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"a",25),s.jc("click",(function(){return s.Oc(e),s.nc(2).deleteReport()})),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(3),s.bd(" ",s.pc(4,3,"REPORTS.SHARE_REPORT.EDIT_SETTINGS_BTN")," "),s.Cb(3),s.bd(" ",s.pc(7,5,"REPORTS.SHARED.FILTER_INFO_LABEL")," "),s.Cb(3),s.bd(" ",s.pc(10,7,"GLOBAL.DELETE_BTN")," "))}function $P(e,t){1&e&&(s.Xb(0,"div",19),s.Xb(1,"div",20),s.Sb(2,"img",21),s.Wb(),s.Xc(3,HP,11,9,"div",22),s.Wb())}const KP=function(e){return{labels:e}},qP=function(e,t,n,i){return[e,t,n,i]};let zP=(()=>{class e{constructor(e,t,n){this.toaster=e,this.cd=t,this.translate=n,this.navigate=new s.n,this.edit=new s.n,this.reportFilterInfo=new s.n,this.delete=new s.n}ngAfterViewInit(){this.cd.detectChanges()}copyInputUrl(e){e.select(),document.execCommand("copy"),this.toaster.pop("success",this.translate.instant("GLOBAL.COPIED_NOTIFICATION"),e.value)}openEditModal(){this.edit.emit(this.report)}filterInfo(){this.reportFilterInfo.emit(this.report)}deleteReport(){this.delete.emit(this.report)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(r.a),s.Rb(s.h),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["shared-reports-row"],["","shared-reports-row",""]],inputs:{labels:"labels",isDesktop:"isDesktop",report:"report"},outputs:{navigate:"navigate",edit:"edit",reportFilterInfo:"reportFilterInfo",delete:"delete"},decls:11,vars:11,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cl-d-none",3,"isDesktop","templates"],["responsive",""],["col1",""],["col2",""],["col3",""],["col4",""],[1,"cl-d-inline-flex","cl-cut-text-wrapper","cl-w-100"],[1,"cl-cut-text"],["target","_blank",1,"cl-text-gray-6",3,"href"],[1,"cl-component-divided-left"],["class","cl-badge cl-badge-tag cl-no-hover cl-mr-2",4,"ngIf"],[1,"cl-badge","cl-badge-tag","cl-no-hover","cl-mr-2"],[1,"cl-component-divided-left","cl-w-100"],[1,"cl-input-group","cl-input-group-sm"],["type","text","readonly","",1,"cl-form-control","tr-reset-min-h",3,"ngModel"],["linkInput",""],[1,"cl-input-group-append"],["type","button",1,"cl-btn","cl-btn-outline-light",3,"click"],["dropdown","",1,"cl-dropdown","cl-d-flex","cl-justify-content-end"],["closeDropdown","",1,"cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow","cl-hover-pointer"],["src","assets/images/ui-icons/menu-dots-vertical.svg","closeDropdown",""],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownContent"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-scroll-area"],["closeDropdown","",1,"cl-dropdown-item",3,"click"]],template:function(e,t){if(1&e&&(s.Xc(0,GP,1,0,"ng-container",0),s.Sb(1,"responsive-row",1,2),s.Xc(3,xP,4,2,"ng-template",null,3,s.Yc),s.Xc(5,VP,4,3,"ng-template",null,4,s.Yc),s.Xc(7,YP,8,4,"ng-template",null,5,s.Yc),s.Xc(9,$P,4,0,"ng-template",null,6,s.Yc)),2&e){const e=s.Lc(2),n=s.Lc(4),i=s.Lc(6),c=s.Lc(8),a=s.Lc(10);s.wc("ngTemplateOutlet",e.template)("ngTemplateOutletContext",s.Bc(4,KP,t.labels)),s.Cb(1),s.wc("isDesktop",t.isDesktop)("templates",s.Ec(6,qP,n,i,c,a))}},directives:[i.B,Ei.a,i.u,v.c,v.s,v.v,Nc.a,Dc.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var QP=n("G7Sd");function JP(e,t){if(1&e&&(s.Xb(0,"div",6),s.Xb(1,"label",7),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",8),s.Xb(5,"div",14),s.Zc(6),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,2,"GLOBAL.TEAM_LABEL")),s.Cb(4),s.bd(" ",e.reportFilterInfo.userAndGroupNames," ")}}function eM(e,t){if(1&e&&(s.Xb(0,"div",6),s.Xb(1,"label",7),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",8),s.Xb(5,"div",14),s.Zc(6),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,2,"GLOBAL.CLIENTS_LABEL")),s.Cb(4),s.bd(" ",e.reportFilterInfo.clientNames," ")}}function tM(e,t){if(1&e&&(s.Xb(0,"div",6),s.Xb(1,"label",7),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",8),s.Xb(5,"div",14),s.Zc(6),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,2,"GLOBAL.PROJECT_LABEL")),s.Cb(4),s.bd(" ",e.reportFilterInfo.projectNames," ")}}function nM(e,t){if(1&e&&(s.Xb(0,"div",6),s.Xb(1,"label",7),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",8),s.Xb(5,"span",14),s.Zc(6),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,2,"GLOBAL.TASK_LABEL")),s.Cb(4),s.bd(" ",e.reportFilterInfo.taskNames," ")}}function iM(e,t){if(1&e&&(s.Xb(0,"div",6),s.Xb(1,"label",7),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",8),s.Xb(5,"div",14),s.Zc(6),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,2,"GLOBAL.TAG_LABEL")),s.Cb(4),s.bd(" ",e.reportFilterInfo.tagNames," ")}}function sM(e,t){if(1&e&&(s.Xb(0,"div",6),s.Xb(1,"label",7),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",8),s.Xb(5,"div",14),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,2,"GLOBAL.BILLING_LABEL")),s.Cb(4),s.bd(" ",s.pc(7,4,e.reportFilterInfo.billable?"GLOBAL.BILLABLE_LABEL":"REPORTS.SHARED.NON_BILLABLE_LABEL")," ")}}function cM(e,t){if(1&e&&(s.Xb(0,"div",6),s.Xb(1,"label",7),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",8),s.Xb(5,"div",14),s.Zc(6),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,2,"GLOBAL.DESCRIPTION_LABEL")),s.Cb(4),s.bd(" ",e.reportFilterInfo.description," ")}}function aM(e,t){if(1&e&&(s.Xb(0,"div",6),s.Xb(1,"label",7),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",8),s.Xb(5,"div",14),s.Zc(6),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,2,"GLOBAL.CUSTOM_FIELDS_LABEL")),s.Cb(4),s.bd(" ",e.reportFilterInfo.customFields.toString()," ")}}function oM(e,t){if(1&e&&(s.Xb(0,"div",6),s.Xb(1,"label",7),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",8),s.Xb(5,"div",9),s.Zc(6),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,2,"REPORTS.SHARED.ROUNDING_LABEL")),s.Cb(4),s.bd(" ",e.reportFilterInfo.rounding," ")}}function rM(e,t){if(1&e&&(s.Xb(0,"div",6),s.Xb(1,"label",7),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",8),s.Xb(5,"div",15),s.Zc(6),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,2,"REPORTS.SHARED.EXPORT_LABEL")),s.Cb(4),s.bd(" ",e.exportElementsTranslated," ")}}let lM=(()=>{class e{constructor(e){this.translate=e,this.onClose=new s.n,this.amountOption=jy.a,this.detailedExportElementTranslations=new Map([[d_.a.PROJECT,"GLOBAL.PROJECT_LABEL"],[d_.a.CLIENT,"GLOBAL.CLINENT_LABEL"],[d_.a.TASK,"GLOBAL.TASK_LABEL"],[d_.a.DESCRIPTION,"GLOBAL.DESCRIPTION_LABEL"],[d_.a.USER,"GLOBAL.USER_LABEL"],[d_.a.TAGS,"GLOBAL.TAGS_LABEL"],[d_.a.START_DATE,"REPORTS.DETAILED_REPORT.START_DATE_LABEL"],[d_.a.START_TIME,"GLOBAL.FORM_LABEL_START_TIME"],[d_.a.END_TIME,"REPORTS.DETAILED_REPORT.END_TIME_LABEL"],[d_.a.DURATION,"REPORTS.SHARED.DURATION_LABEL"],[d_.a.BILLABLE_AMOUNT,"REPORTS.DETAILED_REPORT.BILLABLE_AMOUNT_LABEL"],[d_.a.COST_AMOUNT,"REPORTS.DETAILED_REPORT.COST_AMOUNT_LABEL"],[d_.a.PROFIT,"GLOBAL.PROFIT_LABEL"],[d_.a.EMAIL,"GLOBAL.EMAIL_LABEL"],[d_.a.BILLABLE,"GLOBAL.BILLABLE_LABEL"],[d_.a.END_DATE,"REPORTS.DETAILED_REPORT.END_DATE_LABEL"],[d_.a.DECIMAL_DURATION,"REPORTS.DETAILED_REPORT.DECIMAL_DURATION_LABEL"],[d_.a.COST_RATE,"GLOBAL.COST_RATE_LABEL"],[d_.a.APPROVAL,"REPORTS.MODELS.APPROVAL_LABEL"],[d_.a.BILLABLE_RATE,"GLOBAL.BILLABLE_RATE_LABEL"],[d_.a.RTL,"INVOICES.SETTINGS.TEXT_DISPLAY.LABEL"],[d_.a.GROUP,"GLOBAL.GROUP_LABEL"]])}set reportFilterInfo(e){this._reportFilterInfo=e;let t=[];e.exportElements&&(t=t.concat(e.exportElements.split(",").map(e=>{const t=this.detailedExportElementTranslations.get(d_.a[e.trim()]);return t?this.translate.instant(t):this.replaceUnderline(e.trim())}))),e.formattedCustomFieldsString&&(t=t.concat(e.formattedCustomFieldsString.split(",").map(e=>e.trim()))),this.exportElementsTranslated=t.filter(String).join(", ")}get reportFilterInfo(){return this._reportFilterInfo}closeModal(){this.onClose.emit()}replaceUnderline(e){return e.replace(/_/g," ").toLowerCase()}getAmountsLabel(){return Fy.a[this.reportType]===Fy.a.SUMMARY?this.summaryAmountLabel():this.amountLabel()}summaryAmountLabel(){var e;if(!this.reportFilterInfo.amounts||!(null===(e=this.reportFilterInfo.amounts)||void 0===e?void 0:e.length))return this.translate.instant("REPORTS.TABLE_INFO.HIDE_AMOUNT_LABEL");if(3==this.reportFilterInfo.amounts.length)return this.translate.instant("REPORTS.TABLE_INFO.SHOW_ALL_LABEL");let t=this.translate.instant("GLOBAL.SHOW_LABEL")+" ";return this.reportFilterInfo.amounts.forEach(e=>{switch(e){case jy.a.EARNED:t+=this.translate.instant("GLOBAL.AMOUNT_LABEL_SM")+", ";break;case jy.a.PROFIT:t+=this.translate.instant("GLOBAL.PROFIT_LABEL_SM")+", ";break;case jy.a.COST:t+=this.translate.instant("GLOBAL.COST_LABEL_SM")+", "}}),t.substring(0,t.length-2)}amountLabel(){var e;if(!this.reportFilterInfo.amounts||!(null===(e=this.reportFilterInfo.amounts)||void 0===e?void 0:e.length))return this.translate.instant("REPORTS.TABLE_INFO.HIDE_AMOUNT_LABEL");switch(this.reportFilterInfo.amounts[0]){case jy.a.PROFIT:return this.translate.instant("REPORTS.TABLE_INFO.SHOW_PROFIT_LABEL");case jy.a.COST:return this.translate.instant("REPORTS.TABLE_INFO.SHOW_COST_LABEL");default:return this.translate.instant("REPORTS.TABLE_INFO.SHOW_AMOUNT_LABEL")}}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["filter-info"]],inputs:{reportFilterInfo:"reportFilterInfo",showExport:"showExport",reportType:"reportType"},outputs:{onClose:"onClose"},decls:39,vars:26,consts:[[1,"cl-modal-content"],[1,"cl-modal-header"],["id","exampleModalLabel",1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-group","cl-row","cl-align-items-center"],[1,"cl-col-sm-2","cl-col-form-label","cl-mb-0"],[1,"cl-col-sm-10"],[1,"cl-text-gray-9"],["class","cl-form-group cl-row cl-align-items-center",4,"ngIf"],["ngbAutofocus","",1,"cl-empty-element"],[1,"cl-modal-footer"],[3,"click"],[1,"cl-badge-tag","cl-d-inline-flex","cl-py-1","cl-px-2"],[1,"cl-text-gray-9","cl-text-capitalize"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"h1",2),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"button",3),s.jc("click",(function(){return t.closeModal()})),s.Xb(6,"span"),s.Sb(7,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(8,"div",5),s.Xb(9,"div",6),s.Xb(10,"label",7),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xb(13,"div",8),s.Xb(14,"div",9),s.Zc(15),s.oc(16,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xc(17,JP,7,4,"div",10),s.Xc(18,eM,7,4,"div",10),s.Xc(19,tM,7,4,"div",10),s.Xc(20,nM,7,4,"div",10),s.Xc(21,iM,7,4,"div",10),s.Xc(22,sM,8,6,"div",10),s.Xc(23,cM,7,4,"div",10),s.Xc(24,aM,7,4,"div",10),s.Xc(25,oM,7,4,"div",10),s.Xb(26,"div",6),s.Xb(27,"label",7),s.Zc(28),s.oc(29,"translate"),s.Wb(),s.Xb(30,"div",8),s.Xb(31,"div",9),s.Zc(32),s.Wb(),s.Wb(),s.Wb(),s.Xc(33,rM,7,4,"div",10),s.Wb(),s.Sb(34,"button",11),s.Xb(35,"div",12),s.Xb(36,"a",13),s.jc("click",(function(){return t.closeModal()})),s.Zc(37),s.oc(38,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.ad(s.pc(4,16,"REPORTS.SHARED.FILTER_INFO_LABEL")),s.Cb(8),s.ad(s.pc(12,18,"GLOBAL.DATE_LABEL")),s.Cb(4),s.ad(s.pc(16,20,t.reportFilterInfo.formattedRange)),s.Cb(2),s.wc("ngIf",t.reportFilterInfo.userAndGroupNames),s.Cb(1),s.wc("ngIf",t.reportFilterInfo.clientNames),s.Cb(1),s.wc("ngIf",t.reportFilterInfo.projectNames),s.Cb(1),s.wc("ngIf",t.reportFilterInfo.taskNames),s.Cb(1),s.wc("ngIf",t.reportFilterInfo.tagNames),s.Cb(1),s.wc("ngIf",null!=t.reportFilterInfo.billable),s.Cb(1),s.wc("ngIf",t.reportFilterInfo.description),s.Cb(1),s.wc("ngIf",t.reportFilterInfo.customFields&&t.reportFilterInfo.customFields.length),s.Cb(1),s.wc("ngIf",t.reportFilterInfo.rounding),s.Cb(3),s.ad(s.pc(29,22,"GLOBAL.AMOUNT_LABEL")),s.Cb(4),s.bd(" ",t.getAmountsLabel()," "),s.Cb(1),s.wc("ngIf",t.showExport&&(null==t.reportFilterInfo.formattedExportElements?null:t.reportFilterInfo.formattedExportElements.length)>0),s.Cb(4),s.ad(s.pc(38,24,"GLOBAL.CLOSE_BTN")))},directives:[i.u],pipes:[g.e],encapsulation:2}),e})();function bM(e,t){1&e&&(s.Xb(0,"div",12),s.Xb(1,"div",13),s.Xb(2,"span",14),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.ad(s.pc(4,1,"REPORTS.SHARE_REPORT.MY_REPORTS_HEADER")))}function dM(e,t){1&e&&(s.Xb(0,"thead"),s.Xb(1,"tr"),s.Xb(2,"th",19),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"th"),s.Xb(6,"span",20),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Xb(9,"th"),s.Xb(10,"span",20),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb(),s.Xb(13,"th",21),s.Xb(14,"div",22),s.Zc(15),s.oc(16,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.ad(s.pc(4,4,"GLOBAL.NAME_LABEL")),s.Cb(4),s.ad(s.pc(8,6,"GLOBAL.LABEL_TEXT")),s.Cb(4),s.ad(s.pc(12,8,"GLOBAL.ENDPONT_URL")),s.Cb(4),s.ad(s.pc(16,10,"GLOBAL.EDIT_LABEL")))}function uM(e,t){if(1&e){const e=s.Yb();s.Xb(0,"tr",23),s.jc("edit",(function(t){s.Oc(e);const n=s.nc(2),i=s.Lc(12);return n.openEditModal(t,i)}))("reportFilterInfo",(function(t){s.Oc(e);const n=s.nc(2),i=s.Lc(14);return n.filterInfo(t,i)}))("delete",(function(t){s.Oc(e);const n=s.nc(2),i=s.Lc(10);return n.deleteReport(t,i)})),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc(2);s.wc("labels",n.labels)("isDesktop",n.isDesktop)("report",e)}}function pM(e,t){if(1&e&&(s.Xb(0,"div",15),s.Xb(1,"table",16),s.Xc(2,dM,17,12,"thead",17),s.Xb(3,"tbody"),s.Xc(4,uM,1,3,"tr",18),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.wc("ngIf",e.isDesktop),s.Cb(2),s.wc("ngForOf",e.reports)}}function hM(e,t){if(1&e){const e=s.Yb();s.Xb(0,"pager",24),s.jc("pageChanged",(function(t){return s.Oc(e),s.nc().setPaginationUrl(t)}))("limitChanged",(function(t){return s.Oc(e),s.nc().setPaginationUrl(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("page",e.page)("limit",e.limit)("total",e.reportsCount)}}function mM(e,t){1&e&&(s.Xb(0,"empty-shared-report",25),s.oc(1,"translate"),s.Xb(2,"h4"),s.Zc(3),s.oc(4,"translate"),s.Sb(5,"br"),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb()),2&e&&(s.wc("imagePath","assets/images/illustrations/shared_location.svg")("title",s.pc(1,5,"REPORTS.SHARE_REPORT.EMPTY_REPORT.FILTER_TOOLTIP"))("hideHeader",!0),s.Cb(3),s.ad(s.pc(4,7,"REPORTS.SHARE_REPORT.EMPTY_REPORT.APPLY_FILTER_INFO_PART_1")),s.Cb(3),s.ad(s.pc(7,9,"REPORTS.SHARE_REPORT.EMPTY_REPORT.APPLY_FILTER_INFO_PART_2")))}function gM(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",26),s.jc("confirmed",(function(n){s.Oc(e);const i=t.$implicit,c=s.nc();return i.close(n),c.confirmDelete()}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",27),s.Zc(4),s.oc(5,"translate"),s.Xb(6,"b"),s.Zc(7),s.Wb(),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,7,"REPORTS.SHARE_REPORT.DELETE_REPORT_TOOLTIP"))("inProgress",!1)("isDanger",!0)("btnText",s.pc(2,9,"GLOBAL.DELETE_BTN")),s.Cb(4),s.bd(" ",s.pc(5,11,"REPORTS.SHARE_REPORT.DELETE_REPORT_INFO_PART_1"),""),s.Cb(3),s.ad(e.selectedReport.name),s.Cb(1),s.bd(" ",s.pc(9,13,"REPORTS.SHARE_REPORT.DELETE_REPORT_INFO_PART_2")," ")}}function EM(e,t){if(1&e){const e=s.Yb();s.Xb(0,"modal-header",28),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"share-report",29),s.jc("onShare",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().updateReport(n,i)}))("onClose",(function(){return t.$implicit.close()})),s.oc(3,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,11,"REPORTS.SHARE_REPORT.EDIT_REPORT_TOOLTIP")),s.Cb(2),s.wc("reportName",e.selectedReport.name)("isSaved",!0)("isPublic",e.selectedReport.isPublic)("fixedDate",e.selectedReport.fixedDate)("dateRangeType",e.selectedReport.filters.dateRangeType)("visibleToUserGroup",e.selectedReport.visibleToUserGroups&&e.selectedReport.visibleToUserGroups.length>0?e.selectedReport.visibleToUserGroups[0].id:"")("scheduledReport",e.selectedReport.scheduledReport)("confirmButtonCopy",s.pc(3,13,"CALENDAR.SHARED.UPDATE_BTN"))("isAdminOrOwner",e.isAdminOrOwner)("inProgress",!1)}}function fM(e,t){if(1&e&&(s.Xb(0,"filter-info",30),s.jc("onClose",(function(){return t.$implicit.close()})),s.Wb()),2&e){const e=s.nc();s.wc("reportFilterInfo",e.reportFilterInfo)("showExport",e.showExport)("reportType",e.selectedReport.type)}}let SM=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r,l,b){this.reportService=e,this.authService=t,this.modalService=n,this.toaster=i,this.router=s,this.activatedRoute=c,this.browserService=a,this.cd=o,this.workspaceService=r,this.switchReportService=l,this.analyticsService=b,this.page=1,this.limit=In.j,this.AmountOptions=jy.a,this.labels=["Name","Label","Url","Edit"],this.isMultiplePages=!1,this.unsubscribe$=new p.a}ngOnInit(){this.user=this.authService.getUser(),this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.showExport=this.workspace.hasFeature(is.a.CUSTOM_REPORTING),this.getRouteParams(),this.setBrowserWidth()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}setBrowserWidth(){this.browserService.isBreakpointLg$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e})}getReports(){this.reportService.getSharedReports(this.page,this.limit).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.reports=e.reports,this.reportsCount=e.count,this.isMultiplePages=this.reportsCount>In.j||this.reportsCount>this.limit,this.cd.detectChanges()},()=>{this.reports=[]})}deleteReport(e,t){this.selectedReport=e,this.modalService.open(t,{centered:!0})}confirmDelete(){this.reportService.deleteReport(this.selectedReport.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.reports.splice(this.reports.indexOf(this.selectedReport),1),this.cd.detectChanges()})}openEditModal(e,t){this.selectedReport=e,this.modalService.open(t,{centered:!0})}updateReport(e,t){this.reportService.updateSavedReport(this.selectedReport.id,{name:e.name,isPublic:e.isPublic,fixedDate:e.fixedDate,visibleToUsers:[],visibleToUserGroups:e.visibleToUserGroup?[e.visibleToUserGroup]:[]}).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(n=>{this.reports[this.reports.indexOf(this.selectedReport)]=new MP.a(n),this.updateScheduled(e),t.close(),this.cd.detectChanges(),this.analyticsService.addEvent(new Fi.a({event:"submit",uevent:"submit",value:"Pro",section:"Reports",section2:"Shared",section3:"Edit sharing report",section4:"Upgrade"}))})}filterInfo(e,t){this.selectedReport=e,this.reportService.getFilterInfo(e.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.reportFilterInfo=new UP(e),this.reportFilterInfo.formattedRange=this.setFormattedRange(this.reportFilterInfo.dateRangeStart,this.reportFilterInfo.dateRangeEnd,this.reportFilterInfo.dateRangeType,this.user.settings.dateFormat),this.modalService.open(t,{centered:!0})})}setFormattedRange(e,t,n,i){return n&&n!=BP.a.ABSOLUTE?n.label:Object(ke.utc)(e).format(i).concat(" - ").concat(Object(ke.utc)(t).format(i))}setPaginationUrl(e){this.pager.setPaginationManually(e),this.page=this.pager.page,this.limit=this.pager.limit,this.addParamsToRoute(),this.getReports()}addParamsToRoute(){this.router.navigate([],{queryParams:{page:this.page,limit:this.limit}})}getRouteParams(){this.activatedRoute.queryParams.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.page=Number(e.page)||1,this.limit=Number(e.limit)||In.j,this.getReports()})}updateScheduled(e){if(!e.scheduledReport&&!this.selectedReport.scheduledReport)return;if(!e.scheduledReport)return void this.reportService.deleteScheduledReport(this.selectedReport.id);const t={scheduledReport:{type:e.scheduledReport.type,recipients:e.scheduledReport.recipients},visibleToUserGroups:e.visibleToUserGroup?[e.visibleToUserGroup]:[]},n=this.reports.filter(e=>e.id===this.selectedReport.id)[0];this.reportService.updateScheduledReport(this.selectedReport.id,t).subscribe(e=>{this.reports[this.reports.indexOf(n)]=new MP.a(e),this.cd.detectChanges()})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(By.a),s.Rb(re.a),s.Rb(w.q),s.Rb(r.a),s.Rb(k.d),s.Rb(k.a),s.Rb(Gn.a),s.Rb(s.h),s.Rb(l.a),s.Rb(a_.a),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["shared-reports"]],viewQuery:function(e,t){var n;1&e&&s.gd(Pi.a,!0),2&e&&s.Kc(n=s.kc())&&(t.pager=n.first)},decls:15,vars:5,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-btn-group",3,"page"],["class","cl-card cl-border-bottom-0 cl-mb-0",4,"ngIf"],["class","cl-page-component-wrapper",4,"ngIf"],[1,"cl-mt-3"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],[3,"imagePath","title","hideHeader",4,"ngIf"],["deleteModal",""],["editModal",""],["filterInfoModal",""],[1,"cl-card","cl-border-bottom-0","cl-mb-0"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],[1,"cl-page-component-wrapper"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-shared-report-table"],[4,"ngIf"],["shared-reports-row","","class","cl-hover-shadow",3,"labels","isDesktop","report","edit","reportFilterInfo","delete",4,"ngFor","ngForOf"],[1,"cl-h5","cl-mb-0","cl-pl-lg-3","cl-w-50"],[1,"cl-h5","cl-ml-lg-custom-n2"],[2,"width","46px"],[1,"cl-h5","cl-mb-0","cl-text-lg-custom-right","cl-d-block","cl-d-lg-custom-none"],["shared-reports-row","",1,"cl-hover-shadow",3,"labels","isDesktop","report","edit","reportFilterInfo","delete"],[3,"page","limit","total","pageChanged","limitChanged"],[3,"imagePath","title","hideHeader"],[3,"title","inProgress","isDanger","btnText","confirmed","close"],[1,"cl-text-muted","cl-cut-text-wrap"],[3,"title","onClose"],[3,"reportName","isSaved","isPublic","fixedDate","dateRangeType","visibleToUserGroup","scheduledReport","confirmButtonCopy","isAdminOrOwner","inProgress","onShare","onClose"],[3,"reportFilterInfo","showExport","reportType","onClose"]],template:function(e,t){1&e&&(s.Xb(0,"main",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Sb(3,"switch-reports",3),s.Wb(),s.Xc(4,bM,5,3,"div",4),s.Xc(5,pM,5,2,"div",5),s.Xb(6,"div",6),s.Xc(7,hM,1,3,"pager",7),s.Wb(),s.Xc(8,mM,8,11,"empty-shared-report",8),s.Wb(),s.Wb(),s.Xc(9,gM,10,15,"ng-template",null,9,s.Yc),s.Xc(11,EM,4,15,"ng-template",null,10,s.Yc),s.Xc(13,fM,1,3,"ng-template",null,11,s.Yc)),2&e&&(s.Cb(3),s.wc("page","SHARED"),s.Cb(1),s.wc("ngIf",t.reports&&t.reports.length>0),s.Cb(1),s.wc("ngIf",t.reports&&t.reports.length>0),s.Cb(2),s.wc("ngIf",t.isMultiplePages),s.Cb(1),s.wc("ngIf",t.reports&&0==t.reports.length))},directives:[f_,i.u,i.t,zP,Pi.a,QP.a,Si.a,Wd.a,ak.a,lM],pipes:[g.e],encapsulation:2}),e})();var CM=n("uHlu"),AM=n("6Dzi"),OM=n("1+qu");function vM(e,t){if(1&e){const e=s.Yb();s.Xb(0,"reports-filter",22),s.jc("onApply",(function(t){return s.Oc(e),s.nc(2).applyFilter(t)}))("emitClearFilters",(function(){return s.Oc(e),s.nc(2).defaultFilter()})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("hideMembers",e.hideMembers)("hideUserGroupMembers",e.hideUserGroupMembers)("description",e.description)("valuesData",e.filterValuesData)("description",e.description)("withoutDescription",e.withoutDescription)("customFieldFilters",e.customFieldFilters)}}function TM(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"div",23),s.Sb(2,"tr",25),s.Wb(),s.Ub()),2&e){const e=t.$implicit,n=s.nc(4);s.Cb(2),s.wc("lang",n.currentLang)("group",e)("week",n.week)("format",n.format)("currency",null==n.workspace?null:n.workspace.hourlyRate.currency)("showCurrency",n.amountOptions.length>0)("isProject",!n.isGroupByProject)("showTime",n.showTime)("isExpandedMobileView",n.isExpandedMobileView)("isDesktop",n.isDesktop)}}function IM(e,t){if(1&e&&(s.Vb(0),s.Xc(1,TM,3,10,"ng-container",19),s.Ub()),2&e){const e=s.nc().$implicit;s.Cb(1),s.wc("ngForOf",e.children)}}function wM(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"div",23),s.Sb(2,"tr",24),s.Wb(),s.Xc(3,IM,2,1,"ng-container",21),s.Ub()),2&e){const e=t.$implicit,n=s.nc(2);s.Cb(2),s.wc("lang",n.currentLang)("group",e)("level",1)("week",n.week)("format",n.format)("isProject",n.isGroupByProject)("showTime",n.showTime)("currency",null==n.workspace?null:n.workspace.hourlyRate.currency)("showCurrency",n.amountOptions.length>0)("isDesktop",n.isDesktop)("isExpandedMobileView",n.isExpandedMobileView)("isExpanded",n.isExpanded),s.Cb(1),s.wc("ngIf",e.isExpanded)}}function LM(e,t){if(1&e&&s.Sb(0,"tr",26),2&e){const e=s.nc(2);s.wc("lang",e.currentLang)("group",e.totalsByDay)("week",e.week)("currency",null==e.workspace?null:e.workspace.hourlyRate.currency)("showCurrency",e.amountOptions.length>0)("format",e.format)("isProject",!1)("showTime",e.showTime)("isExpandedMobileView",e.isExpandedMobileView)("isDesktop",e.isDesktop)}}function RM(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",28),s.Xb(1,"span"),s.Xb(2,"button",29),s.jc("click",(function(){return s.Oc(e),s.nc(3).loadUsers()})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"REPORTS.SUMMARY.SHOW_USERS_WITHOUT_TIME_BTN")," "))}function yM(e,t){if(1&e&&(s.Vb(0),s.Xc(1,RM,5,3,"div",27),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",!e.allActiveUsers)}}function _M(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",5),s.Xb(1,"div",6),s.Xb(2,"div",7),s.Xb(3,"div",8),s.Sb(4,"switch-reports",9),s.Wb(),s.Xb(5,"div",10),s.Xb(6,"div",11),s.Xb(7,"div",12),s.Xb(8,"datepicker-range",13),s.jc("dateRangeOut",(function(t){return s.Oc(e),s.nc().updateDateRange(t)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(9,vM,1,7,"reports-filter",14),s.Xb(10,"table-info",15),s.jc("shareReports",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(3);return t.openModal(n)}))("customizeReport",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(5);return t.openModal(n)}))("exportAsPdf",(function(){return s.Oc(e),s.nc().exportAsPdf()}))("exportAsCsv",(function(){return s.Oc(e),s.nc().exportAsCsv()}))("exportAsExcel",(function(){return s.Oc(e),s.nc().exportAsExcel()}))("onRoundingChange",(function(t){return s.Oc(e),s.nc().onRoundingChange(t)}))("onWeeklyGroupChange",(function(t){return s.Oc(e),s.nc().onWeeklyGroupChange(t)}))("onAmountOptionChange",(function(t){return s.Oc(e),s.nc().amountOptionChanged(t)})),s.Wb(),s.Xb(11,"div",16),s.Xb(12,"table",17),s.jc("scrolled",(function(){return s.Oc(e),s.nc().loadMoreUsers()})),s.Xb(13,"thead"),s.Xb(14,"tr",18),s.jc("onExpandMobileView",(function(t){return s.Oc(e),s.nc().isExpandedMobileView=t}))("onExpand",(function(t){return s.Oc(e),s.nc().isExpanded=t})),s.oc(15,"translate"),s.Wb(),s.Wb(),s.Xb(16,"tbody"),s.Xc(17,wM,4,13,"ng-container",19),s.Xc(18,LM,1,10,"tr",20),s.Wb(),s.Wb(),s.Xc(19,yM,2,1,"ng-container",21),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(4),s.wc("page","WEEKLY"),s.Cb(4),s.wc("isWeekly",!0)("timeEntriesDateRange",e.dateRange),s.Cb(1),s.wc("ngIf",e.filterValuesData),s.Cb(1),s.wc("amountOptions",e.amountOptions)("totalNumberOfEntries",e.entriesCount)("isWeekly",!0)("weeklyGroup",e.weeklyGroup)("isCostRateActive",e.workspace.isCostRateActive)("isRounding",e.isRounding)("totalInfo",e.totalInfo)("isAdminOrOwner",e.isAdminOrOwner)("canSeeRates",e.canSeeRates),s.Cb(2),s.wc("infiniteScrollDistance",3)("infiniteScrollThrottle",150)("scrollWindow",!0)("alwaysCallback",!e.allActiveUsersAreLoaded),s.Cb(2),s.wc("mainLabel",s.pc(15,25,e.isGroupByProject?"GLOBAL.PROJECT_LABEL":"GLOBAL.USER_LABEL"))("isDesktop",e.isDesktop)("isExpanded",e.isExpanded)("isExpandedMobileView",e.isExpandedMobileView)("week",e.week),s.Cb(3),s.wc("ngForOf",e.groups),s.Cb(1),s.wc("ngIf",e.totalsByDay),s.Cb(1),s.wc("ngIf",e.isUsersWithoutTimeEnabled)}}function kM(e,t){if(1&e){const e=s.Yb();s.Xb(0,"modal-header",30),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"share-report",31),s.jc("onShare",(function(n){s.Oc(e);const i=t.$implicit,c=s.nc(),a=s.Lc(7);return c.shareReport(n,i,a)}))("onClose",(function(){return t.$implicit.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,5,"REPORTS.SHARED.SHARE_BTN")),s.Cb(2),s.wc("inProgress",e.shareInProgress)("dateRangeLabel",e.getDateRangeValue())("dateRangeType",e.dateRangeType)("isAdminOrOwner",e.isAdminOrOwner)}}function WM(e,t){if(1&e){const e=s.Yb();s.Xb(0,"modal-header",30),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"customize-report",32),s.jc("onOpen",(function(){return s.Oc(e),s.nc().getCustomizationSettings()}))("onSave",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().saveExportSettings(n,i)}))("onClose",(function(){return t.$implicit.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,11,"REPORTS.SUMMARY.CUSTOMIZE_TOOLTIP")),s.Cb(2),s.wc("inProgress",e.customizationInProgress)("reportType",e.TYPE)("canSeeRates",e.canSeeRates&&e.workspace.activeBillableHours)("isAdminOrOwner",e.isAdminOrOwner)("currentSettings",e.currentSettings)("reportName",e.reportName)("customFields",e.customFields)("checkedCustomFields",e.currentCustomFieldSettings)("isCostRateActive",e.workspace.isCostRateActive)("options",e.exportOptions)}}function XM(e,t){if(1&e&&(s.Xb(0,"modal-header",30),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"div",33),s.Xb(3,"text-copy",34),s.jc("onClose",(function(){return t.$implicit.close()})),s.Xb(4,"small",35),s.Sb(5,"img",36),s.oc(6,"translate"),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(9,"div",37),s.Xb(10,"a",38),s.jc("keyup.space",(function(){return t.$implicit.close()}))("keyup.enter",(function(){return t.$implicit.close()}))("click",(function(){return t.$implicit.close()})),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.wc("title",s.pc(1,5,"GLOBAL.LINK_CREATED_TITLE")),s.Cb(3),s.wc("text",e.sharedLink),s.Cb(2),s.wc("ngbTooltip",s.pc(6,7,"REPORTS.SHARED.SHARE_LINK_BTN")),s.Cb(2),s.bd(" ",s.pc(8,9,"REPORTS.SHARED.CREATE_LINK_INFO")," "),s.Cb(4),s.ad(s.pc(12,11,"GLOBAL.CLOSE_BTN"))}}let NM=(()=>{class e extends o_{constructor(e,t,n,i,s,c,a,o,r,l,b,d,u,p,h,m,g,E,f,S,C){super(e,t,n,i,s,c,a,o,r,l,b,d,u,p,m,g,E,f,S,C),this.bulkEditDataService=h,this.translateService=f,this.translationStore=S,this.analyticsService=C,this.isExpanded=!1,this.TYPE=Fy.a.WEEKLY,this.exportOptions={allOptions:[new b_(n_.a.SUBGROUP,this.translate.instant("REPORTS.WEEKLY.SHOW_SUBGROUP_BTN"))],csvXlsxOptions:[],pdfOptions:[]},this.userParams={limit:50,statuses:["ACTIVE"],page:1}}ngOnInit(){super.ngOnInit(),this.currentLang=this.translationStore.getCurrentLang(),this.user=this.authService.getUser(),this.timeZone=this.user.settings.timeZone,this.activeBillable=this.workspace.activeBillableHours,this.onlyAdminCanSeeAndChangeBillable=this.workspace.onlyAdminsCanChangeBillableStatus,this.setExportOptions()}setExportOptions(){this.canSeeRates&&this.workspace.activeBillableHours&&(!this.workspace.onlyAdminsCanChangeBillableStatus||this.isAdminOrOwner)&&this.exportOptions.allOptions.push(new b_(n_.a.TOTAL,this.translate.instant("REPORTS.WEEKLY.SHOW_TOTAL_BTN"))),(!this.activeBillable||this.activeBillable&&this.onlyAdminCanSeeAndChangeBillable&&!this.isAdminOrOwner)&&(this.exportOptions.allOptions=this.exportOptions.allOptions.filter(e=>e.value!=n_.a.TOTAL))}get isUsersWithoutTimeEnabled(){return!(!this.isAdminOrOwner&&!this.isTeamManager||this.isGroupByProject||this.isTeamFilterApplied)}afterWorkspaceSet(){this.weeklyGroup=this.uiSettingsService.getWeeklyGroup(this.workspace.id)}getReports(){var e,t;this.loader.show("GLOBAL.LOADER_LOADING");const n=this.createReportQuery();this.isTeamFilterApplied=(null===(e=this.filterValuesData[on.i.USERS_AND_GROUP])||void 0===e?void 0:e.isDirty())&&!(null===(t=this.filterValuesData[on.i.USERS_AND_GROUP])||void 0===t?void 0:t.isSelectedAll()),this.amountOptionBackup=this.amountOptions.length?this.amountOptions[0]:jy.a.HIDE_AMOUNT,this.reportService.weeklyResponse.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(({totals:e,groups:t,totalsByDay:n})=>{n.name=this.translateService.instant("GLOBAL.TOTAL_TIME"),this.totalsByDay=n,this.week=Object($n.d)(this.dateRange.start,this.timeZone),this.groups=t,this.isGroupByProject="PROJECT"===this.weeklyGroup,this.showTime=this.amountOptionBackup===jy.a.HIDE_AMOUNT,this.totalInfo=e,!e.totalAmounts&&this.amountOptions&&(this.totalInfo.totalAmounts=this.amountOptions.length?[new p_.a(this.amountOptions[0],e.totalAmount)]:[]),this.entriesCount=e.entriesCount,this.addUsersWithoutTimeToGroup(this.allActiveUsers),this.cd.detectChanges(),this.loader.hide()},()=>this.loader.hide()),this.reportService.getWeeklyReport(n)}loadMoreUsers(){this.allActiveUsers&&this.loadUsers()}loadUsers(){this.loadAllUsersInProgress||this.isUsersWithoutTimeEnabled&&(this.allActiveUsersAreLoaded||(this.loadAllUsersInProgress=!0,this.workspaceService.getUsers(this.userParams).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(({users:e,count:t})=>{this.userParams.page++,this.allActiveUsers?this.allActiveUsers.push(...e):this.allActiveUsers=e,this.addUsersWithoutTimeToGroup(e),this.allActiveUsersAreLoaded=this.allActiveUsers.length===t||e.length<this.userParams.limit,this.loadAllUsersInProgress=!1,this.cd.detectChanges()},()=>this.loadAllUsersInProgress=!1),this.isTeamManager&&this.workspaceService.getUsersByIds(this.teamManagerUsers.map(e=>e.id)).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.allActiveUsers=e||[],this.addUsersWithoutTimeToGroup(this.allActiveUsers),this.cd.detectChanges()})))}addUsersWithoutTimeToGroup(e){if(!this.isUsersWithoutTimeEnabled)return;if(!(null==e?void 0:e.length))return;const t=Object(wc.a)(wa.a.WEEK,this.dateRange),n=this.groups.map(e=>e.id);e.forEach(e=>{if(n.includes(e.id))return;const i={id:e.id,name:e.name,days:t.map(e=>({date:e}))},s=new CM.a(i);this.groups.push(s)})}onWeeklyGroupChange(e){this.weeklyGroup=e,this.uiSettingsService.setWeeklyGroup(e,this.workspace.id),this.navigate()}amountOptionChanged(e){const t=e.length?e[0]:jy.a.HIDE_AMOUNT;this.amountOptions[0]!==e[0]&&(this.amountOptions=e.length?[e[0]]:[]),this.amountOptionBackup=t,this.uiSettingsService.setWeeklyAmountOption(t,this.workspace.id),this.navigate()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(re.a),s.Rb(s.h),s.Rb(xn.a),s.Rb(k.d),s.Rb(Uy.a),s.Rb(k.a),s.Rb(By.a),s.Rb(Gn.a),s.Rb(Hn.a),s.Rb(WA.a),s.Rb(w.q),s.Rb(bn.a),s.Rb(Gy.a),s.Rb(l_.a),s.Rb(UA.a),s.Rb(a_.a),s.Rb(Ic.a),s.Rb(g.f),s.Rb(Ra.a),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["weekly-reports"]],features:[s.zb],decls:8,vars:1,consts:[[1,"cl-page-wrapper"],["class","cl-container-fluid",4,"ngIf"],["shareModal",""],["customizeModal",""],["linkCreatedModal",""],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center","cl-justify-content-between"],[1,"cl-col-auto","cl-mb-3","cl-mb-md-0","cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-justify-content-md-start"],[1,"cl-btn-group",3,"page"],[1,"cl-col-auto"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-sm-end"],[1,"cl-page-header-action","cl-w-100","cl-w-md-auto"],[3,"isWeekly","timeEntriesDateRange","dateRangeOut"],[3,"hideMembers","hideUserGroupMembers","description","valuesData","withoutDescription","customFieldFilters","onApply","emitClearFilters",4,"ngIf"],[1,"cl-card","cl-border-bottom-0","cl-mb-0",3,"amountOptions","totalNumberOfEntries","isWeekly","weeklyGroup","isCostRateActive","isRounding","totalInfo","isAdminOrOwner","canSeeRates","shareReports","customizeReport","exportAsPdf","exportAsCsv","exportAsExcel","onRoundingChange","onWeeklyGroupChange","onAmountOptionChange"],[1,"cl-page-component-wrapper"],["infiniteScroll","",1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6","cl-table-weekly-report",3,"infiniteScrollDistance","infiniteScrollThrottle","scrollWindow","alwaysCallback","scrolled"],["weekly-group-header","",3,"mainLabel","isDesktop","isExpanded","isExpandedMobileView","week","onExpandMobileView","onExpand"],[4,"ngFor","ngForOf"],["weekly-group","","class","cl-bg-light cl-table-footer",3,"lang","group","week","currency","showCurrency","format","isProject","showTime","isExpandedMobileView","isDesktop",4,"ngIf"],[4,"ngIf"],[3,"hideMembers","hideUserGroupMembers","description","valuesData","withoutDescription","customFieldFilters","onApply","emitClearFilters"],[1,"cl-row-hover-shadow"],["weekly-group","",3,"lang","group","level","week","format","isProject","showTime","currency","showCurrency","isDesktop","isExpandedMobileView","isExpanded"],["weekly-group","",1,"cl-component-row-colored",3,"lang","group","week","format","currency","showCurrency","isProject","showTime","isExpandedMobileView","isDesktop"],["weekly-group","",1,"cl-bg-light","cl-table-footer",3,"lang","group","week","currency","showCurrency","format","isProject","showTime","isExpandedMobileView","isDesktop"],["class","cl-or-divider cl-mt-3",4,"ngIf"],[1,"cl-or-divider","cl-mt-3"],[1,"cl-btn","cl-btn-sm","cl-btn-outline-light","cl-w-max-content",3,"click"],[3,"title","onClose"],[3,"inProgress","dateRangeLabel","dateRangeType","isAdminOrOwner","onShare","onClose"],[3,"inProgress","reportType","canSeeRates","isAdminOrOwner","currentSettings","reportName","customFields","checkedCustomFields","isCostRateActive","options","onOpen","onSave","onClose"],[1,"cl-modal-body"],[3,"text","onClose"],[1,"form-text","text-gray-9"],["src","assets/images/ui-icons/info-9.svg","placement","top",1,"cl-mr-2",3,"ngbTooltip"],[1,"cl-modal-footer"],["tabindex","0",1,"cl-color-blue",3,"keyup.space","keyup.enter","click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xc(1,_M,20,27,"div",1),s.Wb(),s.Xc(2,kM,3,7,"ng-template",null,2,s.Yc),s.Xc(4,WM,3,13,"ng-template",null,3,s.Yc),s.Xc(6,XM,13,13,"ng-template",null,4,s.Yc)),2&e&&(s.Cb(1),s.wc("ngIf",t.workspace))},directives:[i.u,f_,ws.a,S_.a,Ae.a,AM.a,i.t,C_.a,OM.a,Wd.a,ak.a,Lk,Rk.a,w.bb],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var DM=n("uudg"),PM=n("w1tV"),MM=n("TuVw"),BM=n("wN+/");class UM{constructor(e){this._copy=e&&e.copy||"",this._uri=e&&e.uri||""}get copy(){return this._copy}set copy(e){this._copy=e}get uri(){return this._uri}set uri(e){this._uri=e}}let GM=(()=>{class e{constructor(e){this.authService=e,this.close=new s.n}closeModal(){this.close.emit(!0)}resendEmail(){this.authService.resendVerifyEmail()}ngOnInit(){this.email=this.authService.getUser().email}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(re.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["verify-email-modal"]],outputs:{close:"close"},decls:17,vars:13,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],[1,"cl-modal-body"],[1,"cl-text-break","cl-text-color"],[1,"margin"],[1,"cl-modal-footer"],[3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2,"Verify email"),s.Wb(),s.Wb(),s.Xb(3,"div",2),s.Xb(4,"div",3),s.Xb(5,"div",4),s.Zc(6),s.oc(7,"translate"),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(9,"div",5),s.Xb(10,"div"),s.Xb(11,"a",6),s.jc("click",(function(){return t.closeModal()})),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Xb(14,"button",7),s.jc("click",(function(){return t.resendEmail(),t.closeModal()})),s.Zc(15),s.oc(16,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(6),s.dd(" ",s.pc(7,5,"WORKSPACE.INTEGRATION.PUMBLE.VERIFY_EMAIL_MSG_1")," ",t.email," ",s.pc(8,7,"WORKSPACE.INTEGRATION.PUMBLE.VERIFY_EMAIL_MSG_2")," "),s.Cb(6),s.bd(" ",s.pc(13,9,"GLOBAL.CLOSE_BTN")," "),s.Cb(3),s.ad(s.pc(16,11,"EMAIL_PREFERENCES.INFO_VERIFY.LINK")))},pipes:[g.e],encapsulation:2,changeDetection:0}),e})();const xM=["approvalListModal"],FM=["emailNotVerifiedModal"];function jM(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",9),s.jc("click",(function(){return s.Oc(e),s.nc().markAsReadAll()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.CLEAR_ALL_BTN")," "))}function ZM(e,t){1&e&&(s.Xb(0,"span",10),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"LAYOUT.NOTIFICATIONS.NO_NEW_NOTIFICATIONS_LABEL")," "))}function VM(e,t){if(1&e&&(s.Xb(0,"p",14),s.Xb(1,"strong"),s.Zc(2),s.Wb(),s.Zc(3),s.oc(4,"translate"),s.Xb(5,"strong"),s.Zc(6),s.Wb(),s.Zc(7),s.oc(8,"translate"),s.Wb()),2&e){const e=s.nc().$implicit;s.Cb(2),s.ad(e.data.invitedBy),s.Cb(1),s.bd(" ",s.pc(4,4,"LAYOUT.NOTIFICATIONS.WORKSPACE_INVITATION.ACCESS_INVITATION.PART_1")," "),s.Cb(3),s.ad(e.data.workspaceName),s.Cb(1),s.bd(" ",s.pc(8,6,"LAYOUT.NOTIFICATIONS.WORKSPACE_INVITATION.ACCESS_INVITATION.PART_2")," ")}}const YM=function(e){return{workspaceName:e}};function HM(e,t){if(1&e&&(s.Xb(0,"p",14),s.Zc(1),s.oc(2,"translate"),s.Xb(3,"strong"),s.Zc(4),s.Wb(),s.Zc(5),s.oc(6,"translate"),s.Xb(7,"strong"),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Zc(10),s.oc(11,"translate"),s.Wb()),2&e){const e=s.nc().$implicit;s.Cb(1),s.bd(" ",s.pc(2,5,"LAYOUT.NOTIFICATIONS.WORKSPACE_INVITATION.FULL_ACCOUNT_ACCESS_INVITATION.PART_1")," "),s.Cb(3),s.ad(e.data.workspaceName),s.Cb(1),s.bd(" ",s.qc(6,7,"LAYOUT.NOTIFICATIONS.WORKSPACE_INVITATION.FULL_ACCOUNT_ACCESS_INVITATION.PART_2",s.Bc(14,YM,e.data.workspaceName))," "),s.Cb(3),s.bd(" ",s.pc(9,10,"LAYOUT.NOTIFICATIONS.WORKSPACE_INVITATION.FULL_ACCOUNT_ACCESS_INVITATION.PART_3")," "),s.Cb(2),s.bd(" ",s.pc(11,12,"LAYOUT.NOTIFICATIONS.WORKSPACE_INVITATION.FULL_ACCOUNT_ACCESS_INVITATION.PART_4")," ")}}function $M(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",10),s.Xb(1,"div",11),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,VM,9,8,"p",12),s.Xc(5,HM,12,16,"p",12),s.Xb(6,"button",13),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc().accept(n)})),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Xb(9,"a",9),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc().decline(n)})),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit;s.Cb(2),s.bd(" ",s.pc(3,5,"LAYOUT.NOTIFICATIONS.WORKSPACE_INVITATION.TITLE")," "),s.Cb(2),s.wc("ngIf",!e.data.isUsingFullAccess),s.Cb(1),s.wc("ngIf",e.data.isUsingFullAccess),s.Cb(2),s.bd(" ",s.pc(8,7,"LAYOUT.NOTIFICATIONS.ACCEPT_LABEL")," "),s.Cb(3),s.bd(" ",s.pc(11,9,"LAYOUT.NOTIFICATIONS.DECLINE_LABEL")," ")}}function KM(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",10),s.Xb(1,"div",11),s.Zc(2),s.Xb(3,"a",15),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc().markAsRead(n.id)})),s.Sb(4,"img",16),s.Wb(),s.Wb(),s.Xb(5,"p",14),s.Zc(6),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit;s.Cb(2),s.bd(" ",e.data.title," "),s.Cb(4),s.bd(" ",e.data.message," ")}}function qM(e,t){if(1&e&&s.Sb(0,"img",22),2&e){const e=s.nc().$implicit;s.wc("src",e.image.imagePath,s.Qc)}}function zM(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",10),s.Xb(1,"div",11),s.Zc(2),s.Xb(3,"a",15),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc().readNews(n.id)})),s.Sb(4,"img",16),s.Wb(),s.Wb(),s.Xb(5,"p",17),s.Zc(6),s.Wb(),s.Xb(7,"a",18),s.Zc(8),s.Wb(),s.Xb(9,"div",19),s.Xb(10,"a",20),s.Xc(11,qM,1,1,"img",21),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit;s.Cb(2),s.bd(" ",e.title," "),s.Cb(4),s.bd(" ",e.message," "),s.Cb(1),s.xc("href",e.link,s.Qc),s.Cb(1),s.ad(e.linkText),s.Cb(2),s.xc("href",e.link,s.Qc),s.Cb(1),s.wc("ngIf",e.image.imagePath)}}const QM=function(e){return{suggestedTimeZone:e}};function JM(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",10),s.Xb(1,"div",11),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"p",14),s.Zc(5),s.oc(6,"translate"),s.Xb(7,"a",23),s.jc("click",(function(){return s.Oc(e),s.nc().goToSettings()})),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Xb(12,"a",9),s.jc("click",(function(){return s.Oc(e),s.nc().changeTimeZone()})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.bd(" ",s.pc(3,5,"LAYOUT.NOTIFICATIONS.TIMEZONE_MISMATCH.TITLE")," "),s.Cb(3),s.bd(" ",s.pc(6,7,"LAYOUT.NOTIFICATIONS.TIMEZONE_MISMATCH.NOTIFICATION.PART_1")," "),s.Cb(3),s.ad(s.pc(9,9,"LAYOUT.NOTIFICATIONS.TIMEZONE_MISMATCH.NOTIFICATION.PART_2")),s.Cb(2),s.bd(" ",s.pc(11,11,"LAYOUT.NOTIFICATIONS.TIMEZONE_MISMATCH.NOTIFICATION.PART_3")," "),s.Cb(3),s.ad(s.qc(14,13,"LAYOUT.NOTIFICATIONS.TIMEZONE_MISMATCH.CHANGE_TIMEZONE_NOTIFICATION",s.Bc(16,QM,e.suggestedTimeZone)))}}function eB(e,t){1&e&&(s.Xb(0,"strong"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"LAYOUT.NOTIFICATIONS.WORKSPACE_INVITATION.FULL_ACCOUNT_ACCESS_INVITATION.PART_3")))}function tB(e,t){1&e&&(s.Xb(0,"a",28),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.LEARN_MORE_LINK")," "))}function nB(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",11),s.Zc(2),s.Xb(3,"a",15),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().markAsRead(t.id)})),s.Sb(4,"img",16),s.Wb(),s.Wb(),s.Xb(5,"p",17),s.Zc(6),s.Xc(7,eB,3,3,"strong",26),s.Zc(8),s.Wb(),s.Xc(9,tB,3,3,"a",27),s.Ub()}if(2&e){const e=s.nc().$implicit;s.Cb(2),s.bd(" ",e.data.title?e.data.title:"Special features"," "),s.Cb(4),s.bd(" ",e.data.message.split("full access")[0]," "),s.Cb(1),s.wc("ngIf",e.data.message.includes("full access")),s.Cb(1),s.bd(" ",e.data.message.split("full access")[1]," "),s.Cb(1),s.wc("ngIf","Privacy notice"!==e.data.title)}}function iB(e,t){1&e&&(s.Xb(0,"a",31),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.LEARN_MORE_LINK")," "))}function sB(e,t){1&e&&(s.Xb(0,"a",32),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.LEARN_MORE_LINK")," "))}function cB(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",11),s.Zc(2),s.Xb(3,"a",15),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().markAsRead(t.id)})),s.Sb(4,"img",16),s.Wb(),s.Wb(),s.Xb(5,"p",14),s.Zc(6),s.Sb(7,"br"),s.Xc(8,iB,3,3,"a",29),s.Xc(9,sB,3,3,"a",30),s.Wb(),s.Ub()}if(2&e){const e=s.nc().$implicit;s.Cb(2),s.bd(" ",e.data.title," "),s.Cb(4),s.bd(" ",e.data.message.replace("For more information, please see here.","")," "),s.Cb(2),s.wc("ngIf",e.data.message.includes("enabled")&&e.data.title.includes("Screenshots")),s.Cb(1),s.wc("ngIf",e.data.message.includes("enabled")&&e.data.title.includes("GPS"))}}function aB(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",11),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"p",14),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"a",9),s.jc("click",(function(){return s.Oc(e),s.nc(2).resendEmail()})),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Ub()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,3,"LAYOUT.NOTIFICATIONS.VERIFY_EMAIL_LABEL")," "),s.Cb(3),s.bd(" ",s.pc(6,5,"LAYOUT.NOTIFICATIONS.UNVERIFIED_EMAIL_NOTIFICATION")," "),s.Cb(3),s.ad(s.pc(9,7,"LAYOUT.NOTIFICATIONS.RESEND_EMAIL_LABEL")))}function oB(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",11),s.Xb(2,"span"),s.Zc(3),s.Wb(),s.Xb(4,"a",15),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().markAsRead(t.id)})),s.Sb(5,"img",16),s.Wb(),s.Wb(),s.Xb(6,"p",17),s.Zc(7),s.Wb(),s.Ub()}if(2&e){const e=s.nc().$implicit;s.Cb(3),s.ad(e.data.title),s.Cb(4),s.bd(" ",e.data.message," ")}}function rB(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",11),s.Xb(2,"span"),s.Zc(3),s.Wb(),s.Xb(4,"a",15),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().markAsRead(t.id)})),s.Sb(5,"img",16),s.Wb(),s.Wb(),s.Xb(6,"p",14),s.Zc(7),s.Wb(),s.Xb(8,"a",9),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit,n=s.nc();return n.receiveUpdates(),n.markAsRead(t.id)})),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Ub()}if(2&e){const e=s.nc().$implicit;s.Cb(3),s.ad(e.data.title),s.Cb(4),s.bd(" ",e.data.message," "),s.Cb(2),s.ad(s.pc(10,3,"LAYOUT.NOTIFICATIONS.RECEIVE_UPDATES_LABEL"))}}function lB(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",11),s.Xb(2,"span"),s.Zc(3),s.Wb(),s.Wb(),s.Xb(4,"p",14),s.Zc(5),s.Wb(),s.Xb(6,"a",9),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc().goToSubscription(t.data.workspaceId)})),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Ub()}if(2&e){const e=s.nc().$implicit;s.Cb(3),s.ad(e.data.title),s.Cb(2),s.bd(" ",e.data.message," "),s.Cb(2),s.bd(" ",s.pc(8,3,"GLOBAL.GO_TO_SUBSCRIPTION_LABEL")," ")}}function bB(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",11),s.Xb(2,"span"),s.Zc(3),s.Wb(),s.Wb(),s.Xb(4,"p",14),s.Zc(5),s.Wb(),s.Xb(6,"a",9),s.jc("click",(function(){return s.Oc(e),s.nc(2).subscriptionModalOpen()})),s.Zc(7," Get promo code "),s.Wb(),s.Ub()}if(2&e){const e=s.nc().$implicit;s.Cb(3),s.ad(e.data.title),s.Cb(2),s.bd(" ",e.data.message," ")}}function dB(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"div",24),s.Xc(2,nB,10,5,"ng-container",25),s.Xc(3,cB,10,4,"ng-container",25),s.Xc(4,aB,10,9,"ng-container",25),s.Xc(5,oB,8,2,"ng-container",25),s.Xc(6,rB,11,5,"ng-container",25),s.Xc(7,lB,9,5,"ng-container",25),s.Xc(8,bB,8,2,"ng-container",25),s.Wb(),s.Ub()),2&e){const e=t.$implicit;s.Cb(1),s.wc("ngSwitch",e.type),s.Cb(1),s.wc("ngSwitchCase","FEATURE_SUBSCRIPTION"),s.Cb(1),s.wc("ngSwitchCase","MONITORING"),s.Cb(1),s.wc("ngSwitchCase","ACCOUNT_VERIFICATION"),s.Cb(1),s.wc("ngSwitchCase","WORKSPACE_CHANGED"),s.Cb(1),s.wc("ngSwitchCase","USER_SETTINGS"),s.Cb(1),s.wc("ngSwitchCase","PAYMENT_FAILED"),s.Cb(1),s.wc("ngSwitchCase","PUMBLE_COUPON")}}function uB(e,t){1&e&&(s.Xb(0,"verify-email-modal",33),s.jc("close",(function(){return t.$implicit.close()})),s.Wb())}function pB(e,t){if(1&e&&(s.Xb(0,"li"),s.Zc(1),s.oc(2,"momentFormat"),s.oc(3,"momentFormat"),s.Wb()),2&e){const e=t.$implicit,n=s.nc(3);s.Cb(1),s.cd(" ",s.qc(2,2,e.start,n.user.settings.dateFormat)," - ",s.qc(3,5,e.end,n.user.settings.dateFormat)," ")}}function hB(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"div",36),s.Zc(2),s.Wb(),s.Xb(3,"ul",37),s.Xc(4,pB,4,8,"li",6),s.Wb(),s.Ub()),2&e){const e=t.$implicit;s.Cb(2),s.ad(e.name),s.Cb(2),s.wc("ngForOf",e.ranges)}}function mB(e,t){if(1&e){const e=s.Yb();s.Xb(0,"delete-confirm-modal",34),s.jc("onDelete",(function(){s.Oc(e);const n=t.$implicit;return s.nc().confirmWithdrawnAll(n)}))("onClose",(function(){return t.$implicit.close(!1)})),s.oc(1,"translate"),s.oc(2,"lowercase"),s.oc(3,"translate"),s.Xb(4,"p",35),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xc(7,hB,5,2,"ng-container",6),s.Wb()}if(2&e){const e=s.nc();s.wc("title","Change time zone")("btnText",s.pc(1,7,"USER_PROFILE.UNSUBMIT"))("showConfirmation",!0)("confirmationText",s.pc(2,9,s.pc(3,11,"USER_PROFILE.UNSUBMIT")))("inProgress",e.inProgress),s.Cb(5),s.bd(" ",s.pc(6,13,"LAYOUT.NOTIFICATIONS.TIMEZONE_UPDATE_WARNING")," "),s.Cb(2),s.wc("ngForOf",e.pendingApprovals)}}let gB=(()=>{class e{constructor(e,t,n,i,c,a,o,r,l){this.router=e,this.notificationService=t,this.authService=n,this.userService=i,this.loader=c,this.modalService=a,this.approvalService=o,this.cd=r,this.workspaceService=l,this.workspaceChangedEvent=new s.n,this.invitationNotifications=[],this.fileImportNotifications=[],this.notificationsWithoutInvitation=[],this.newsNotifications=[],this.unsubscribe$=new p.a,this.allNotifications=[]}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.notificationService.newsNotifications$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.newsNotifications=e,this.calculateCount(this.allNotifications),this.cd.detectChanges()}),this.notificationService.unreadNotifications$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.allNotifications=e,e.some(e=>e.type===xm.a.WORKSPACE_CHANGED)&&this.workspaceChangedEvent.emit(),this.invitationNotifications=e.filter(e=>e.type===xm.a.WORKSPACE_INVITATION),this.fileImportNotifications=e.filter(e=>e.type===xm.a.FILE_IMPORT_COMPLETED),this.notificationsWithoutInvitation=e.filter(e=>e.type!==xm.a.WORKSPACE_INVITATION&&e.type!==xm.a.TIME_ZONE);const t=e.filter(e=>e.type===xm.a.TIME_ZONE)[0];this.suggestedTimeZone=this.generateSuggestedTimeZone(t),this.calculateCount(this.allNotifications),this.cd.detectChanges()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}calculateCount(e){const t=e.filter(e=>e.type!==xm.a.ACCOUNT_VERIFICATION&&e.type!==xm.a.TIME_ZONE).length+this.newsNotifications.length;this.clearBtnEnabled=t>0&&this.notificationsWithoutInvitation.length>0}changeTimeZone(){var e;(null===(e=this.user)||void 0===e?void 0:e.id)&&this.suggestedTimeZone&&(this.loader.showBar(),this.userService.updateTimeZone(this.suggestedTimeZone,this.user.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.loader.hide(),this.notificationService.removeTimezoneNotification()},e=>{this.loader.hide(),4007===e.error.code&&(this.modalService.open(this.approvalListModal,{centered:!0}),this.checkApprovalSubmittedStatus())}))}checkApprovalSubmittedStatus(){this.approvalService.getAllPendingRequestsForAllWorkspaces().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>this.pendingApprovals=e)}confirmWithdrawnAll(e){this.loader.showBar(),this.inProgress=!0,this.approvalService.withdrawAllRequestsForAllWorkspaces().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.inProgress=!1,this.loader.hide(),this.changeTimeZone(),e.close()},e=>{this.inProgress=!1,this.loader.hide()})}accept(e){this.user&&this.userService.changeWorkspaceStatus(this.user,{status:1,notificationId:e.id,workspaceId:e.data.workspaceId}).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{e||this.modalService.open(this.emailNotVerifiedModal,{centered:!0})})}decline(e){this.user&&this.userService.removeDeclinedUserFromWorkspace(this.user,{status:2,notificationId:e.id,workspaceId:e.data.workspaceId})}markAsReadAll(){0===this.notificationsWithoutInvitation.length&&0===this.newsNotifications.length||(this.notificationService.markAsReadMany(this.notificationsWithoutInvitation.filter(e=>e.type!==xm.a.ACCOUNT_VERIFICATION&&e.type!==xm.a.PAYMENT_FAILED).map(e=>e.id)),0!==this.newsNotifications.length&&this.notificationService.readNews(this.newsNotifications.map(e=>e.id)))}markAsRead(e){this.notificationService.markAsRead(e)}readNews(e){this.notificationService.readNews(new Array(e))}goToSettings(){this.router.navigate(["user/settings"])}resendEmail(){this.authService.resendVerifyEmail()}receiveUpdates(){this.user.settings.sendNewsletter=!0,this.userService.updateSettings(this.user).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{})}goToSubscription(e){e===this.workspace.id?this.router.navigate(["subscription"],{fragment:"payment"}):this.userService.setDefaultUserWorkspace(e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>this.router.navigate(["subscription"],{fragment:"payment"}))}subscriptionModalOpen(){this.router.navigate(["subscription"],{queryParams:{pumbleCoupon:!0}})}generateSuggestedTimeZone(e){const t=e&&tn.tz.guess();if(!t)return"";if(In.w.indexOf(t)>-1){const e=tn.tz(t).format("Z"),n=tn.tz.names();for(let t=0;t<n.length;t++){const i=n[t];if(e===tn.tz(i).format("Z")&&-1===In.w.indexOf(i))return i}}return t}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.d),s.Rb(Gm.a),s.Rb(re.a),s.Rb(Lc.a),s.Rb(Hn.a),s.Rb(w.q),s.Rb(rn),s.Rb(s.h),s.Rb(l.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["notifications"],["","notifications",""]],viewQuery:function(e,t){var n;1&e&&(s.Uc(xM,!0),s.Uc(FM,!0)),2&e&&(s.Kc(n=s.kc())&&(t.approvalListModal=n.first),s.Kc(n=s.kc())&&(t.emailNotVerifiedModal=n.first))},inputs:{user:"user"},outputs:{workspaceChangedEvent:"workspaceChangedEvent"},decls:16,vars:10,consts:[[1,"cl-scroll-area"],[1,"cl-dropdown-notification-clear-all"],[1,"cl-h5","cl-mb-0"],["class","cl-small cl-color-blue",3,"click",4,"ngIf"],["class","cl-dropdown-item",4,"ngIf"],["class","cl-dropdown-item",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["emailNotVerifiedModal",""],["approvalListModal",""],[1,"cl-small","cl-color-blue",3,"click"],[1,"cl-dropdown-item"],[1,"cl-dropdown-notification-item-title","cl-h2"],["class","cl-dropdown-notification-item-desc cl-small",4,"ngIf"],[1,"cl-btn","cl-btn-primary","cl-btn-sm","cl-mr-3",3,"click"],[1,"cl-dropdown-notification-item-desc","cl-small"],[3,"click"],["src","assets/ui-icons/close.svg"],[1,"cl-dropdown-notification-item-desc","cl-small","cl-text-break"],["target","_blank","rel","noopener noreferrer",1,"cl-small","cl-color-blue",3,"href"],[1,"notification-image-container"],["target","_blank",3,"href"],["class","notification-image",3,"src",4,"ngIf"],[1,"notification-image",3,"src"],["clickCloseDropdown","",3,"click"],[1,"cl-dropdown-item",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngIf"],["href","https://clockify.me/help/category/extra-features","class","cl-small cl-color-blue","target","_blank",4,"ngIf"],["href","https://clockify.me/help/category/extra-features","target","_blank",1,"cl-small","cl-color-blue"],["href","https://clockify.me/help/extra-features/screenshots","target","_blank",4,"ngIf"],["href","https://clockify.me/help/extra-features/gps-tracking","target","_blank",4,"ngIf"],["href","https://clockify.me/help/extra-features/screenshots","target","_blank"],["href","https://clockify.me/help/extra-features/gps-tracking","target","_blank"],[3,"close"],[3,"title","btnText","showConfirmation","confirmationText","inProgress","onDelete","onClose"],[1,"cl-text-dark"],[1,"cl-h2"],[1,"cl-list-unstyled","cl-ml-0"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"span",2),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xc(5,jM,3,3,"a",3),s.Wb(),s.Xc(6,ZM,3,3,"span",4),s.Xc(7,$M,12,11,"div",5),s.Xc(8,KM,7,2,"div",5),s.Xc(9,zM,12,6,"div",5),s.Xc(10,JM,15,18,"div",4),s.Xc(11,dB,9,8,"ng-container",6),s.Wb(),s.Xc(12,uB,1,0,"ng-template",null,7,s.Yc),s.Xc(14,mB,8,15,"ng-template",null,8,s.Yc)),2&e&&(s.Cb(3),s.bd(" ",s.pc(4,8,"LAYOUT.NOTIFICATIONS.TITLE")," "),s.Cb(2),s.wc("ngIf",t.clearBtnEnabled),s.Cb(1),s.wc("ngIf",0===(null==t.newsNotifications?null:t.newsNotifications.length)&&0===(null==t.invitationNotifications?null:t.invitationNotifications.length)&&0===(null==t.notificationsWithoutInvitation?null:t.notificationsWithoutInvitation.length)&&!t.suggestedTimeZone),s.Cb(1),s.wc("ngForOf",t.invitationNotifications),s.Cb(1),s.wc("ngForOf",t.fileImportNotifications),s.Cb(1),s.wc("ngForOf",t.newsNotifications),s.Cb(1),s.wc("ngIf",t.suggestedTimeZone),s.Cb(1),s.wc("ngForOf",t.notificationsWithoutInvitation))},directives:[i.u,i.t,i.y,i.z,GM,Xd.a],pipes:[g.e,i.q,Ro.a],encapsulation:2,changeDetection:0}),e})(),EB=(()=>{class e{constructor(e,t){this.renderer=e,this.elementRef=t,this.toggleClass="cl-show"}clicked(e){const t=this.toggleElement||this.elementRef.nativeElement;t.classList.contains(this.toggleClass)?this.renderer.removeClass(t,this.toggleClass):this.renderer.addClass(t,this.toggleClass)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.F),s.Rb(s.l))},e.\u0275dir=s.Mb({type:e,selectors:[["","toggleClass",""]],hostBindings:function(e,t){1&e&&s.jc("click",(function(){return t.clicked()}))},inputs:{toggleClass:"toggleClass",toggleElement:"toggleElement"},exportAs:["toggleClass"]}),e})(),fB=(()=>{class e{constructor(e,t,n,i){this.renderer=e,this.activatedRoute=t,this.navigationService=n,this.element=i,this.activeClass="cl-active",this.activeFragments=[],this.paramsInUrl={fragment:"",urlParts:[]},this.unsubscribe$=new p.a}set routerLink(e){e&&(this.urlParts=e.map(e=>e.replace(/\//,"")))}ngOnInit(){this.activatedRoute.fragment.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.paramsInUrl.fragment=(e||"").toLowerCase(),this.isLinkActive()}),this.navigationService.routeParams$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.paramsInUrl=e,this.isLinkActive()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}isLinkActive(){const e=this.linkElement||this.element.nativeElement;if(this.renderer.removeClass(e,this.activeClass),!Object(sn.c)(this.paramsInUrl.urlParts,this.urlParts))return;const t=!!this.activeFragments.length;t&&!this.activeFragments.includes(this.paramsInUrl.fragment)||!t&&this.paramsInUrl.fragment||this.renderer.addClass(e,this.activeClass)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.F),s.Rb(k.a),s.Rb(ao.a),s.Rb(s.l))},e.\u0275dir=s.Mb({type:e,selectors:[["","activeLink",""]],inputs:{activeClass:"activeClass",activeFragments:"activeFragments",routerLink:"routerLink",linkElement:"linkElement"}}),e})();const SB=["topbarNotifications"],CB=["workspacePickerTooltip"],AB=["topbarDropdowns"];function OB(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",56),s.Xb(1,"a",57,58),s.jc("click",(function(){s.Oc(e);const t=s.Lc(2);return s.nc(3).blurElementAndSendEvent(t,"contact for demo")})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"button",59),s.jc("click",(function(){return s.Oc(e),s.nc(3).discardContactSalesNotification()})),s.Zc(6,"\xd7"),s.Wb(),s.Wb()}2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"LAYOUT.SIDEBAR.CONTACT_SUPPORT.CONTACT_FOR_DEMO_LABEL")," "))}const vB=function(e){return{remainingTrialDays:e}};function TB(e,t){if(1&e&&(s.Xb(0,"span",63),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(4);s.Cb(1),s.ad(s.qc(2,1,"LAYOUT.SIDEBAR.CONTACT_SUPPORT.TRIAL_EXPIRATION_NOTIFICATION",s.Bc(4,vB,e.remainingTrialDays)))}}function IB(e,t){1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"LAYOUT.SIDEBAR.CONTACT_SUPPORT.TRIAL_EXPIRING_TOMORROW_NOTIFICATION")))}function wB(e,t){1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"LAYOUT.SIDEBAR.CONTACT_SUPPORT.TRIAL_EXPIRING_TODAY_NOTIFICATION")))}function LB(e,t){if(1&e&&(s.Xb(0,"p",60),s.Xc(1,TB,3,6,"span",61),s.Xc(2,IB,3,3,"span",10),s.Xc(3,wB,3,3,"span",10),s.Xb(4,"a",62),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngIf",e.remainingTrialDays>1),s.Cb(1),s.wc("ngIf",1===e.remainingTrialDays),s.Cb(1),s.wc("ngIf",0===e.remainingTrialDays),s.Cb(2),s.bd(" ",s.pc(6,4,"LAYOUT.SIDEBAR.CONTACT_SUPPORT.CONTACT_SALES_LABEL")," ")}}function RB(e,t){if(1&e&&(s.Xb(0,"div",53),s.Xc(1,OB,7,3,"div",54),s.Xc(2,LB,7,6,"p",55),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",!!e.constactSalesNotification),s.Cb(1),s.wc("ngIf",e.workspace.featureSubscriptionType===e.PaymentTypeEnum.TRIAL&&e.isAdmin)}}function yB(e,t){if(1&e&&(s.mc(),s.lc(),s.Vb(0),s.Xc(1,RB,3,2,"div",52),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",!!e.constactSalesNotification||e.workspace.featureSubscriptionType===e.PaymentTypeEnum.TRIAL&&e.isAdmin)}}const _B=function(e){return[e]};function kB(e,t){if(1&e&&s.Sb(0,"span",79),2&e){const e=s.nc().$implicit;s.wc("ngClass",s.Bc(1,_B,e.bgClass))}}function WB(e,t){1&e&&(s.Xb(0,"span",80),s.Sb(1,"img",81),s.Xb(2,"span",82),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"GLOBAL.ACTIVE_LABEL")," "))}const XB=function(e){return{"cl-active":e}};function NB(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"a",75),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc(3).changeDefaultWorkspace(n)})),s.Xc(2,kB,1,3,"span",76),s.Xb(3,"span",77),s.Zc(4),s.Wb(),s.Xc(5,WB,5,3,"span",78),s.Wb(),s.Ub()}if(2&e){const e=t.$implicit,n=s.nc(3);s.Cb(1),s.xc("title",e.name),s.wc("ngClass",s.Bc(5,XB,e.id===n.activeWorkspaceId)),s.Cb(1),s.wc("ngIf",!n.isSelfHosted&&"FREE"!==e.subscriptionPlanTitle.toUpperCase()),s.Cb(2),s.ad(e.name),s.Cb(1),s.wc("ngIf",e.id===n.activeWorkspaceId)}}function DB(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",67),s.Xb(1,"div",68),s.Xb(2,"div",69),s.Xb(3,"div",70),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"span",71),s.Xb(7,"a",72),s.jc("click",(function(){return s.Oc(e),s.nc(2).addEventsLinks("Manage workspaces")})),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(10,"div",73),s.Xc(11,NB,6,7,"ng-container",74),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(4),s.ad(s.pc(5,3,"GLOBAL.WORKSPACES_LABEL")),s.Cb(4),s.bd(" ",s.pc(9,5,"GLOBAL.MANAGE_LABEL")," "),s.Cb(3),s.wc("ngForOf",e.workspaces)}}function PB(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",64,25),s.jc("onOpen",(function(){return s.Oc(e),s.Lc(3).close()})),s.Xb(2,"div",65,66),s.oc(4,"translate"),s.Zc(5),s.Wb(),s.Xc(6,DB,12,7,"div",23),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.wc("ngbTooltip",s.pc(4,3,"LAYOUT.SIDEBAR.SWITCH_WORKSPACE_TOOLTIP"))("autoClose",!1),s.Cb(3),s.bd(" ",null==e.workspace?null:e.workspace.name," ")}}function MB(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",86,87),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1);return s.nc(2).blurElementAndSendEvent(t,"Upgrade","Upgrade")})),s.Zc(2),s.oc(3,"translate"),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"GLOBAL.UPGRADE_BTN")," "))}function BB(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"a",89,87),s.jc("click",(function(){s.Oc(e);const t=s.Lc(2);return s.nc(3).blurElementAndSendEvent(t,"Upgrade","Upgrade")})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()}2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"GLOBAL.UPGRADE_BTN")," "))}function UB(e,t){if(1&e&&s.Xc(0,BB,5,3,"div",88),2&e){const e=s.nc(2);s.wc("ngIf",e.everHadPaidSubscription)("ngIfElse",e.OnlyInvoices)}}function GB(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"div",83),s.Xc(2,MB,4,3,"a",84),s.Xc(3,UB,1,2,"ng-template",null,85,s.Yc),s.Wb(),s.Ub()),2&e){const e=s.Lc(4),t=s.nc();s.Cb(2),s.wc("ngIf",!t.everHadPaidSubscription&&!t.hasOpenInvoice&&!t.hasPaidInvoice)("ngIfElse",e)}}function xB(e,t){if(1&e&&(s.Xb(0,"a",90),s.Xb(1,"span",41),s.Sb(2,"img",91),s.Wb(),s.Wb()),2&e){const e=s.nc();s.wc("href",e.supportLinks[0].uri,s.Qc),s.Cb(2),s.wc("src","assets/nav-icons/help.svg",s.Qc)}}function FB(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",95),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc(3).addEventsLinks(n.copy)})),s.Zc(1),s.Wb()}if(2&e){const e=t.$implicit;s.wc("href",e.uri,s.Qc),s.Cb(1),s.bd("",e.copy," ")}}function jB(e,t){if(1&e&&(s.Xb(0,"div",67),s.Xb(1,"div",73),s.Xc(2,FB,2,2,"a",94),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.wc("ngForOf",e.supportLinks)}}function ZB(e,t){1&e&&(s.Xb(0,"div",92,25),s.Xb(2,"a",93),s.Sb(3,"img",91),s.Wb(),s.Xc(4,jB,3,1,"div",23),s.Wb()),2&e&&(s.Cb(3),s.wc("src","assets/nav-icons/help.svg",s.Qc))}function VB(e,t){if(1&e&&(s.Xb(0,"span",96),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",e.unreadNotifications+e.newsNotifications," ")}}function YB(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",67),s.Xb(1,"div",97),s.jc("workspaceChangedEvent",(function(){return s.Oc(e),s.nc().checkAndChangeWorkspace()})),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.wc("user",e.user)}}function HB(e,t){if(1&e&&s.Sb(0,"span",79),2&e){const e=s.nc().$implicit;s.wc("ngClass",s.Bc(1,_B,e.bgClass))}}function $B(e,t){1&e&&(s.Xb(0,"span",80),s.Sb(1,"img",81),s.Xb(2,"span",82),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"GLOBAL.ACTIVE_LABEL")," "))}function KB(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"a",75),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc(5).changeDefaultWorkspace(n)})),s.Xc(2,HB,1,3,"span",76),s.Xb(3,"span",77),s.Zc(4),s.Wb(),s.Xc(5,$B,5,3,"span",78),s.Wb(),s.Ub()}if(2&e){const e=t.$implicit,n=s.nc(5);s.Cb(1),s.xc("title",e.name),s.wc("ngClass",s.Bc(5,XB,e.id===n.activeWorkspaceId)),s.Cb(1),s.wc("ngIf",!n.isSelfHosted&&"FREE"!==e.subscriptionPlanTitle.toUpperCase()),s.Cb(2),s.ad(e.name),s.Cb(1),s.wc("ngIf",e.id===n.activeWorkspaceId)}}function qB(e,t){if(1&e&&(s.Xb(0,"div",67),s.Xb(1,"div",68),s.Xb(2,"div",69),s.Xb(3,"div",70),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"span",71),s.Xb(7,"a",121),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(10,"div",73),s.Xc(11,KB,6,7,"ng-container",74),s.Wb(),s.Wb()),2&e){const e=s.nc(4);s.Cb(4),s.ad(s.pc(5,3,"GLOBAL.WORKSPACES_LABEL")),s.Cb(4),s.bd(" ",s.pc(9,5,"GLOBAL.MANAGE_LABEL")," "),s.Cb(3),s.wc("ngForOf",e.workspaces)}}function zB(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",117),s.Xb(1,"div",118,25),s.jc("onOpen",(function(){return s.Oc(e),s.Lc(4).close()})),s.Xb(3,"div",119,66),s.oc(5,"translate"),s.Xb(6,"span",120),s.Zc(7),s.Wb(),s.Wb(),s.Xc(8,qB,12,7,"div",23),s.Wb(),s.Wb()}if(2&e){const e=s.nc(3);s.Cb(3),s.wc("ngbTooltip",s.pc(5,3,"LAYOUT.SIDEBAR.SWITCH_WORKSPACE_TOOLTIP"))("autoClose",!1),s.Cb(4),s.ad(null==e.workspace?null:e.workspace.name)}}function QB(e,t){1&e&&(s.Xb(0,"a",124),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.UPGRADE_BTN")," "))}function JB(e,t){1&e&&(s.Xb(0,"a",125),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.UPGRADE_BTN")," "))}function eU(e,t){if(1&e&&(s.Vb(0),s.Xc(1,QB,3,3,"a",122),s.Xc(2,JB,3,3,"ng-template",null,123,s.Yc),s.Ub()),2&e){const e=s.Lc(3),t=s.nc(3);s.Cb(1),s.wc("ngIf",!t.everHadPaidSubscription)("ngIfElse",e)}}function tU(e,t){if(1&e&&(s.Xb(0,"div",115),s.Xb(1,"div",68),s.Xb(2,"div",69),s.Xc(3,zB,9,5,"div",116),s.Xc(4,eU,4,2,"ng-container",10),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(3),s.wc("ngIf",!e.isSubdomain),s.Cb(1),s.wc("ngIf",e.showUpgradeLink)}}function nU(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",98),s.Xb(1,"div",68),s.Xb(2,"div",99),s.Xb(3,"div",100),s.Zc(4),s.Wb(),s.Xb(5,"div",101),s.Zc(6),s.Wb(),s.Wb(),s.Wb(),s.Xc(7,tU,5,2,"div",102),s.Xb(8,"a",103),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Xb(11,"div",104),s.Xb(12,"div",105),s.Xb(13,"input",106),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc().user.settings.darkTheme=t}))("ngModelChange",(function(){return s.Oc(e),s.nc().themeChange()})),s.Wb(),s.Xb(14,"label",107),s.Zc(15),s.oc(16,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(17,"a",108),s.jc("click",(function(){return s.Oc(e),s.nc().addEventsLinks("Download apps")})),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Xb(20,"a",109),s.jc("click",(function(){return s.Oc(e),s.nc().addEventsLinks("Try chat app")})),s.Xb(21,"span",110),s.Zc(22),s.oc(23,"translate"),s.Wb(),s.Xb(24,"span",111),s.Zc(25),s.oc(26,"translate"),s.Wb(),s.Wb(),s.Xb(27,"a",112),s.Zc(28),s.oc(29,"translate"),s.Wb(),s.Sb(30,"div",113),s.Xb(31,"a",114),s.jc("click",(function(){return s.Oc(e),s.nc().logout()})),s.Zc(32),s.oc(33,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(4),s.ad(null==e.user?null:e.user.name),s.Cb(2),s.ad(null==e.user?null:e.user.email),s.Cb(1),s.wc("ngIf",!e.isSubdomain||e.showUpgradeLink),s.Cb(2),s.bd(" ",s.pc(10,11,"GLOBAL.PROFILE_SETTINGS_LABEL")," "),s.Cb(4),s.wc("ngModel",e.user.settings.darkTheme),s.Cb(2),s.bd(" ",s.pc(16,13,"LAYOUT.SIDEBAR.PROFILE_DROPDOWN.DARK_THEME_LABEL")," "),s.Cb(3),s.bd(" ",s.pc(19,15,"LAYOUT.SIDEBAR.PROFILE_DROPDOWN.DOWNLOAD_LABEL")," "),s.Cb(4),s.bd(" ",s.pc(23,17,"LAYOUT.SIDEBAR.PROFILE_DROPDOWN.TRY_CHAT_APP_LABEL")," "),s.Cb(3),s.bd(" ",s.pc(26,19,"GLOBAL.NEW_LABEL_PART")," "),s.Cb(3),s.bd(" ",s.pc(29,21,"LAYOUT.SIDEBAR.PROFILE_DROPDOWN.HELP_LABEL")," "),s.Cb(4),s.bd(" ",s.pc(33,23,"LAYOUT.DEFAULT_LAYOUT.LOG_OUT_BTN")," ")}}function iU(e,t){1&e&&(s.Xb(0,"div",128),s.Xb(1,"a",129),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"LAYOUT.SIDEBAR.NAVIGATION.TIMESHEET_LABEL")," "))}function sU(e,t){if(1&e&&(s.Xb(0,"li",39),s.Xb(1,"a",126),s.Xb(2,"span",41),s.Sb(3,"img",127),s.Wb(),s.Xb(4,"span",43),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Xc(7,iU,4,3,"div",44),s.Wb()),2&e){const e=s.nc();s.Cb(5),s.ad(s.pc(6,2,"LAYOUT.SIDEBAR.NAVIGATION.TIMESHEET_LABEL")),s.Cb(2),s.wc("ngIf",e.isDesktop&&!e.isSidebarOpen)}}function cU(e,t){1&e&&s.Sb(0,"span",134)}function aU(e,t){1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"LAYOUT.SIDEBAR.NAVIGATION.TIMETRACKER_LABEL")))}function oU(e,t){1&e&&(s.Xb(0,"div",128),s.Xb(1,"a",135),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"LAYOUT.SIDEBAR.NAVIGATION.TIMETRACKER_LABEL")," "))}function rU(e,t){if(1&e&&(s.Xb(0,"li",39),s.Xb(1,"a",130),s.Xb(2,"span",41),s.Sb(3,"img",131),s.Wb(),s.Xb(4,"span",43),s.Xc(5,cU,1,0,"span",132),s.Xc(6,aU,3,3,"ng-template",null,133,s.Yc),s.Wb(),s.Wb(),s.Xc(8,oU,4,3,"div",44),s.Wb()),2&e){const e=s.Lc(7),t=s.nc();s.Cb(5),s.wc("ngIf",!t.isTrackerPage&&t.timerIsRunning)("ngIfElse",e),s.Cb(3),s.wc("ngIf",t.isDesktop&&!t.isSidebarOpen)}}function lU(e,t){1&e&&(s.Xb(0,"div",128),s.Xb(1,"a",136),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"GLOBAL.CALENDAR_LABEL")," "))}function bU(e,t){1&e&&(s.Xb(0,"div",128),s.Xb(1,"a",139),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"EXPENSES.TITLE")," "))}function dU(e,t){if(1&e&&(s.Xb(0,"li",39),s.Xb(1,"a",137),s.Xb(2,"span",41),s.Sb(3,"img",138),s.Wb(),s.Xb(4,"span",43),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Xc(7,bU,4,3,"div",44),s.Wb()),2&e){const e=s.nc();s.Cb(5),s.ad(s.pc(6,2,"EXPENSES.TITLE")),s.Cb(2),s.wc("ngIf",e.isDesktop&&!e.isSidebarOpen)}}function uU(e,t){1&e&&(s.Xb(0,"span",149),s.Zc(1,"\u2022"),s.Wb())}function pU(e,t){1&e&&(s.Vb(0),s.Xb(1,"span",150),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Sb(4,"hr",45),s.Ub()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"WORKSPACE.PTO.TITLE")," "))}function hU(e,t){if(1&e&&(s.Xb(0,"li",39,140),s.Xb(2,"span",141),s.Xb(3,"span",41),s.Sb(4,"img",142),s.Wb(),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"a",143),s.Xb(8,"span",41),s.Sb(9,"img",142),s.Wb(),s.Xb(10,"span",43),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xc(13,uU,2,0,"span",144),s.Wb(),s.Xb(14,"div",145),s.Xb(15,"div"),s.Xc(16,pU,5,3,"ng-container",10),s.Xb(17,"a",146),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Xb(20,"a",147),s.Zc(21),s.oc(22,"translate"),s.Wb(),s.Xb(23,"a",148),s.Zc(24),s.oc(25,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.Lc(1),t=s.nc();s.Cb(2),s.wc("toggleElement",e),s.Cb(3),s.bd("",s.pc(6,8,"WORKSPACE.PTO.TITLE")," "),s.Cb(6),s.ad(s.pc(12,10,"WORKSPACE.PTO.TITLE")),s.Cb(2),s.wc("ngIf",t.hasPendingRequests),s.Cb(3),s.wc("ngIf",t.isDesktop&&!t.isSidebarOpen),s.Cb(2),s.bd(" ",s.pc(19,12,"PTO.REQUESTS_LABEL")," "),s.Cb(3),s.bd(" ",s.pc(22,14,"PTO.TIMELINE_LABEL")," "),s.Cb(3),s.bd(" ",s.pc(25,16,"GLOBAL.BALANCE_LABEL")," ")}}function mU(e,t){1&e&&(s.Xb(0,"div",128),s.Xb(1,"a",151),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"GLOBAL.DASHBOARD_LABEL")," "))}function gU(e,t){1&e&&(s.Vb(0),s.Xb(1,"span",150),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Sb(4,"hr",45),s.Ub()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"GLOBAL.REPORTS_LABEL")," "))}function EU(e,t){1&e&&(s.Xb(0,"span",162),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.TIME_LABEL")," "))}function fU(e,t){if(1&e&&(s.Xb(0,"div"),s.Xb(1,"span",162),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"a",163),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.bd(" ",s.pc(3,3,"GLOBAL.EXPENSE_LABEL")," "),s.Cb(2),s.wc("queryParams",e.switchReportService.queryParams),s.Cb(1),s.bd(" ",s.pc(6,5,"GLOBAL.DETAILED_LABEL")," ")}}function SU(e,t){if(1&e&&(s.Xb(0,"li",39,152),s.Xb(2,"span",153),s.Xb(3,"span",41),s.Sb(4,"img",154),s.Wb(),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"a",155),s.Xb(8,"span",41),s.Sb(9,"img",154),s.Wb(),s.Xb(10,"span",43),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb(),s.Xb(13,"div",156),s.Xb(14,"div"),s.Xc(15,gU,5,3,"ng-container",10),s.Xc(16,EU,3,3,"span",157),s.Xb(17,"a",158),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Xb(20,"a",159),s.Zc(21),s.oc(22,"translate"),s.Wb(),s.Xb(23,"a",160),s.Zc(24),s.oc(25,"translate"),s.Wb(),s.Xb(26,"a",161),s.Zc(27),s.oc(28,"translate"),s.Wb(),s.Xc(29,fU,7,7,"div",10),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.Lc(1),t=s.nc();s.Cb(2),s.wc("toggleElement",e),s.Cb(3),s.bd("",s.pc(6,14,"GLOBAL.REPORTS_LABEL")," "),s.Cb(2),s.wc("queryParams",t.switchReportService.queryParams),s.Cb(4),s.ad(s.pc(12,16,"GLOBAL.REPORTS_LABEL")),s.Cb(4),s.wc("ngIf",t.isDesktop&&!t.isSidebarOpen),s.Cb(1),s.wc("ngIf",t.hasExpensesFeature&&t.workspace.expensesEnabled),s.Cb(1),s.wc("queryParams",t.switchReportService.queryParams),s.Cb(1),s.bd(" ",s.pc(19,18,"GLOBAL.REPORTS_SUMMARY_LABEL")," "),s.Cb(2),s.wc("queryParams",t.switchReportService.queryParams),s.Cb(1),s.bd(" ",s.pc(22,20,"GLOBAL.DETAILED_LABEL")," "),s.Cb(2),s.wc("queryParams",t.switchReportService.queryParams),s.Cb(1),s.bd(" ",s.pc(25,22,"GLOBAL.WEEKLY_REPORTS_LABEL")," "),s.Cb(3),s.bd(" ",s.pc(28,24,"LAYOUT.SIDEBAR.NAVIGATION.SHARED_REPORTS_LABEL")," "),s.Cb(2),s.wc("ngIf",t.hasExpensesFeature&&t.workspace.expensesEnabled)}}const CU=function(){return["/activity/screenshots"]},AU=function(){return["/activity/locations"]};function OU(e,t){if(1&e&&(s.Xb(0,"div",128),s.Xb(1,"a",166),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.wc("routerLink",e.workspace.screenshotsEnabled?s.Ac(4,CU):s.Ac(5,AU)),s.Cb(1),s.bd(" ",s.pc(3,2,"GLOBAL.ACTIVITY_LABEL")," ")}}function vU(e,t){if(1&e&&(s.Xb(0,"li",39),s.Xb(1,"a",164),s.Xb(2,"span",41),s.Sb(3,"img",165),s.Wb(),s.Xb(4,"span",43),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Xc(7,OU,4,6,"div",44),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("routerLink",e.workspace.screenshotsEnabled?s.Ac(5,CU):s.Ac(6,AU)),s.Cb(4),s.bd(" ",s.pc(6,3,"GLOBAL.ACTIVITY_LABEL")," "),s.Cb(2),s.wc("ngIf",e.isDesktop&&!e.isSidebarOpen)}}function TU(e,t){1&e&&(s.Vb(0),s.Xb(1,"span",150),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Sb(4,"hr",45),s.Ub()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"GLOBAL.ACTIVITY_LABEL")," "))}function IU(e,t){if(1&e&&(s.Xb(0,"li",39,167),s.Xb(2,"span",153),s.Xb(3,"span",41),s.Sb(4,"img",165),s.Wb(),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"a",168),s.Xb(8,"span",41),s.Sb(9,"img",165),s.Wb(),s.Xb(10,"span",43),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb(),s.Xb(13,"div",156),s.Xb(14,"div",73),s.Xc(15,TU,5,3,"ng-container",10),s.Xb(16,"a",169),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Xb(19,"a",170),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.Lc(1),t=s.nc(2);s.Cb(2),s.wc("toggleElement",e),s.Cb(3),s.bd("",s.pc(6,7,"GLOBAL.ACTIVITY_LABEL")," "),s.Cb(2),s.wc("routerLink",t.workspace.screenshotsEnabled?s.Ac(15,CU):s.Ac(16,AU)),s.Cb(4),s.ad(s.pc(12,9,"GLOBAL.ACTIVITY_LABEL")),s.Cb(4),s.wc("ngIf",t.isDesktop&&!t.isSidebarOpen),s.Cb(2),s.bd(" ",s.pc(18,11,"GLOBAL.SCREENSHOT_TITLE")," "),s.Cb(3),s.bd(" ",s.pc(21,13,"GLOBAL.LOCATIONS_LABEL")," ")}}function wU(e,t){if(1&e&&(s.Vb(0),s.Xc(1,vU,8,7,"li",38),s.Xc(2,IU,22,17,"li",38),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",!e.workspace.screenshotsEnabled||!e.workspace.locationsEnabled),s.Cb(1),s.wc("ngIf",e.workspace.screenshotsEnabled&&e.workspace.locationsEnabled)}}function LU(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"li"),s.Sb(2,"hr",45),s.Wb(),s.Xb(3,"li",46),s.Xb(4,"span",47),s.Xb(5,"span",48),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Ub()),2&e){const e=s.nc();s.Cb(2),s.Hb("cl-d-none",e.isSidebarOpen),s.Cb(1),s.Hb("cl-d-none",!e.isSidebarOpen),s.Cb(3),s.bd(" ",s.pc(7,5,"GLOBAL.MANAGE_LABEL")," ")}}function RU(e,t){1&e&&(s.Xb(0,"span",174),s.Zc(1,"\u2022"),s.Wb())}function yU(e,t){1&e&&(s.Xb(0,"div",128),s.Xb(1,"a",175),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"GLOBAL.APPROVALS_LABEL")," "))}function _U(e,t){if(1&e&&(s.Xb(0,"li",39),s.Xb(1,"a",171),s.Xb(2,"span",41),s.Sb(3,"img",172),s.Wb(),s.Xb(4,"span",43),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xc(7,RU,2,0,"span",173),s.Wb(),s.Xc(8,yU,4,3,"div",44),s.Wb()),2&e){const e=s.nc();s.Cb(5),s.bd(" ",s.pc(6,3,"GLOBAL.APPROVALS_LABEL")," "),s.Cb(2),s.wc("ngIf",e.pendingCount>0),s.Cb(1),s.wc("ngIf",e.isDesktop&&!e.isSidebarOpen)}}function kU(e,t){1&e&&(s.Xb(0,"div",128),s.Xb(1,"a",178),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"GLOBAL.PROJECTS_LABEL")," "))}function WU(e,t){if(1&e&&(s.Xb(0,"li",39),s.Xb(1,"a",176),s.Xb(2,"span",41),s.Sb(3,"img",177),s.Wb(),s.Xb(4,"span",43),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Xc(7,kU,4,3,"div",44),s.Wb()),2&e){const e=s.nc();s.Cb(5),s.bd(" ",s.pc(6,2,"GLOBAL.PROJECTS_LABEL")," "),s.Cb(2),s.wc("ngIf",e.isDesktop&&!e.isSidebarOpen)}}function XU(e,t){1&e&&(s.Xb(0,"div",128),s.Xb(1,"a",181),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"GLOBAL.TEAM_LABEL")," "))}function NU(e,t){if(1&e&&(s.Xb(0,"li",39),s.Xb(1,"a",179),s.Xb(2,"span",41),s.Sb(3,"img",180),s.Wb(),s.Xb(4,"span",43),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Xc(7,XU,4,3,"div",44),s.Wb()),2&e){const e=s.nc();s.Cb(5),s.ad(s.pc(6,2,"GLOBAL.TEAM_LABEL")),s.Cb(2),s.wc("ngIf",e.isDesktop&&!e.isSidebarOpen)}}function DU(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.CLIENT_LABEL")))}function PU(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.CATEGORY_LABEL")))}function MU(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.DEPARTMENT_LABEL")))}function BU(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.ad(e.projectGroupingLabel)}}function UU(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.CLIENT_LABEL")))}function GU(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.CATEGORY_LABEL")))}function xU(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.DEPARTMENT_LABEL")))}function FU(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.ad(e.projectGroupingLabel)}}const jU=function(){return["/clients"]};function ZU(e,t){if(1&e&&(s.Xb(0,"div",128),s.Xb(1,"a",194),s.Vb(2,185),s.Xc(3,UU,3,3,"ng-container",186),s.Xc(4,GU,3,3,"ng-container",186),s.Xc(5,xU,3,3,"ng-container",186),s.Xc(6,FU,2,1,"ng-container",187),s.Ub(),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("routerLink",s.Ac(5,jU)),s.Cb(1),s.wc("ngSwitch",e.projectGroupingLabel),s.Cb(1),s.wc("ngSwitchCase","clients"),s.Cb(1),s.wc("ngSwitchCase","categories"),s.Cb(1),s.wc("ngSwitchCase","departments")}}const VU=function(){return["/tags"]};function YU(e,t){1&e&&(s.Xb(0,"div",128),s.Xb(1,"a",166),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(1),s.wc("routerLink",s.Ac(4,VU)),s.Cb(1),s.bd(" ",s.pc(3,2,"GLOBAL.TAGS_LABEL")," "))}function HU(e,t){1&e&&(s.Xb(0,"div",128),s.Xb(1,"a",197),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"GLOBAL.INVOICES_LABEL")," "))}function $U(e,t){if(1&e&&(s.Xb(0,"li",39),s.Xb(1,"a",195),s.Xb(2,"span",41),s.Sb(3,"img",196),s.Wb(),s.Xb(4,"span",43),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Xc(7,HU,4,3,"div",44),s.Wb()),2&e){const e=s.nc(2);s.Cb(5),s.bd(" ",s.pc(6,2,"GLOBAL.INVOICES_LABEL")," "),s.Cb(2),s.wc("ngIf",e.isDesktop&&!e.isSidebarOpen)}}function KU(e,t){1&e&&(s.Vb(0),s.Xb(1,"span",150),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Sb(4,"hr",45),s.Ub()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"GLOBAL.SCHEDULE_LABEL")," "))}function qU(e,t){if(1&e&&(s.Xb(0,"li",39,198),s.Xb(2,"span",153),s.Xb(3,"span",41),s.Sb(4,"img",199),s.Wb(),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"a",200),s.Xb(8,"span",41),s.Sb(9,"img",199),s.Wb(),s.Xb(10,"span",43),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb(),s.Xb(13,"div",156),s.Xb(14,"div"),s.Xc(15,KU,5,3,"ng-container",10),s.Xb(16,"a",201),s.oc(17,"async"),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Xb(20,"a",202),s.oc(21,"async"),s.Zc(22),s.oc(23,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.Lc(1),t=s.nc(2);s.Cb(2),s.wc("toggleElement",e),s.Cb(3),s.bd("",s.pc(6,10,"GLOBAL.SCHEDULE_LABEL")," "),s.Cb(6),s.ad(s.pc(12,12,"GLOBAL.SCHEDULE_LABEL")),s.Cb(4),s.wc("ngIf",t.isDesktop&&!t.isSidebarOpen),s.Cb(1),s.Hb("cl-active","projects"===s.pc(17,14,t.activeFragment)),s.Cb(2),s.bd(" ",s.pc(19,16,"GLOBAL.PROJECTS_LABEL")," "),s.Cb(2),s.Hb("cl-active","team"===s.pc(21,18,t.activeFragment)),s.Cb(2),s.bd(" ",s.pc(23,20,"GLOBAL.TEAM_LABEL")," ")}}const zU=function(){return["/subscription"]};function QU(e,t){1&e&&(s.Xb(0,"div",128),s.Xb(1,"a",207),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(1),s.wc("routerLink",s.Ac(4,zU)),s.Cb(1),s.bd(" ",s.pc(3,2,"LAYOUT.SIDEBAR.NAVIGATION.SUBSCRIPTION_LABEL")," "))}const JU=function(){return["","payment","invoices","plans"]};function eG(e,t){if(1&e&&(s.Xb(0,"li",203,204),s.Xb(2,"a",205),s.Xb(3,"span",41),s.Sb(4,"img",206),s.Wb(),s.Xb(5,"span",43),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xc(8,QU,4,5,"div",44),s.Wb()),2&e){const e=s.Lc(1),t=s.nc(2);s.Cb(2),s.wc("linkElement",e)("activeFragments",s.Ac(7,JU))("routerLink",s.Ac(8,zU)),s.Cb(4),s.bd(" ",s.pc(7,5,"LAYOUT.SIDEBAR.NAVIGATION.SUBSCRIPTION_LABEL")," "),s.Cb(2),s.wc("ngIf",t.isDesktop&&!t.isSidebarOpen)}}const tG=function(e){return["/workspaces",e,"settings"]};function nG(e,t){if(1&e&&(s.Xb(0,"div",128),s.Xb(1,"a",208),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("routerLink",s.Bc(4,tG,e.activeWorkspaceId)),s.Cb(1),s.bd(" ",s.pc(3,2,"LAYOUT.SIDEBAR.NAVIGATION.SETTINGS_LABEL")," ")}}const iG=function(){return["","general","settings","permissions","alerts","accounts","auth","custom_fields","integrations","import"]};function sG(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"li",39),s.Xb(2,"a",182),s.Xb(3,"span",41),s.Sb(4,"img",183),s.Wb(),s.Xb(5,"span",184),s.Vb(6,185),s.Xc(7,DU,3,3,"ng-container",186),s.Xc(8,PU,3,3,"ng-container",186),s.Xc(9,MU,3,3,"ng-container",186),s.Xc(10,BU,2,1,"ng-container",187),s.Ub(),s.Wb(),s.Wb(),s.Xc(11,ZU,7,6,"div",44),s.Wb(),s.Xb(12,"li",39),s.Xb(13,"a",188),s.Xb(14,"span",41),s.Sb(15,"img",189),s.Wb(),s.Xb(16,"span",43),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb(),s.Xc(19,YU,4,5,"div",44),s.Wb(),s.Xc(20,$U,8,4,"li",38),s.Xc(21,qU,24,22,"li",38),s.Xc(22,eG,9,9,"li",190),s.Xb(23,"li",39,191),s.Xb(25,"a",192),s.Xb(26,"span",41),s.Sb(27,"img",193),s.Wb(),s.Xb(28,"span",43),s.Zc(29),s.oc(30,"translate"),s.Wb(),s.Wb(),s.Xc(31,nG,4,6,"div",44),s.Wb(),s.Ub()),2&e){const e=s.Lc(24),t=s.nc();s.Cb(2),s.wc("routerLink",s.Ac(21,jU)),s.Cb(4),s.wc("ngSwitch",t.projectGroupingLabel),s.Cb(1),s.wc("ngSwitchCase","clients"),s.Cb(1),s.wc("ngSwitchCase","categories"),s.Cb(1),s.wc("ngSwitchCase","departments"),s.Cb(2),s.wc("ngIf",t.isDesktop&&!t.isSidebarOpen),s.Cb(2),s.wc("routerLink",s.Ac(22,VU)),s.Cb(4),s.ad(s.pc(18,17,"GLOBAL.TAGS_LABEL")),s.Cb(2),s.wc("ngIf",t.isDesktop&&!t.isSidebarOpen),s.Cb(1),s.wc("ngIf",t.hasInvoiceFeature&&t.workspace.invoicingEnabled),s.Cb(1),s.wc("ngIf",t.hasSchedulingFeature&&t.workspace.schedulingEnabled&&(t.isAdmin||t.isTeamManager||t.isProjectManager)),s.Cb(1),s.wc("ngIf",!t.isSelfHosted&&t.everHadPaidSubscription),s.Cb(3),s.wc("linkElement",e)("activeFragments",s.Ac(23,iG))("routerLink",s.Bc(24,tG,t.activeWorkspaceId)),s.Cb(4),s.bd(" ",s.pc(30,19,"LAYOUT.SIDEBAR.NAVIGATION.SETTINGS_LABEL")," "),s.Cb(2),s.wc("ngIf",t.isDesktop&&!t.isSidebarOpen)}}let cG=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r,l,b,d,u,h,m,g,E,f,S,C,A){this.authService=e,this.router=t,this.notificationService=n,this.workspaceService=i,this.userService=s,this.stopwatchService=c,this.systemSettingsService=a,this.trackerService=o,this.paymentService=r,this.browserService=l,this.synchronizationService=b,this.subdomainService=d,this.uiSettingsService=u,this.cd=h,this.sidebarStateService=m,this.approvalService=g,this.switchReportService=E,this.ptoService=f,this.translateService=S,this.analyticsService=C,this.route=A,this.PaymentTypeEnum=mo.b,this.notifications=[],this.projectGroupingLabel="",this.supportLinks=[],this.unsubscribe$=new Fn.a,this.unreadNotifications=0,this.newsNotifications=0,this.darkThemeDebouncer$=new p.a,this.isSelfHosted=bo.a.environment.selfHosted}ngOnInit(){this.isForbiddenZone=In.g.includes(ke.tz.guess()),this.isAdmin=this.authService.isAdminOrOwner(),this.isSubdomain=this.subdomainService.isSubdomainNotSelfhosted(),this.subscribeToRoute(),this.subscribeToTrackerTime(),this.user=this.authService.getUser(),this.paymentService.onTrialStart$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.remainingTrialDays=7,this.cd.markForCheck()}),this.browserService.isBreakpointLg$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>this.isDesktop=e),this.systemSettingsService.systemSettings.pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.systemSettings=e}),this.systemSettingsService.getSystemSettings(),this.workspaceService.createdWorkspace$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.pendingCount=0,this.setWorkspace(e),this.newWorkspaceId=e.id}),this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Zt.a)(()=>{const e=!this.newWorkspaceId;return this.newWorkspaceId=null,e}),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{const t=(this.workspace&&this.workspace.id)!==e.id;this.setWorkspace(e),this.hasPendingRequests=!1,this.cd.detectChanges(),t&&(this.checkEntriesInProgress(),this.checkPendingTimeOffRequests())}),this.authService.user.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.user=e,this.cd.detectChanges()}),this.systemSettingsService.customLinkSettings.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{if(this.supportLinks=[],this.hasCustomLinks=!1,this.standardLinks=!e||e&&!e.enabled,this.standardLinks){const e=[new UM({uri:"https://clockify.me/help/",copy:this.translateService.instant("LAYOUT.DOCUMENTATION")}),new UM({uri:"https://clockify.me/tutorials",copy:this.translateService.instant("LAYOUT.TUTORIALS")}),new UM({uri:"https://clockify.me/help/contact",copy:this.translateService.instant("LAYOUT.CONTACT")})];this.supportLinks=[...this.supportLinks,...e]}e&&e.enabled&&e.customLinks&&(this.hasCustomLinks=!0,this.supportLinks=[...this.supportLinks,...e.customLinks]),this.cd.detectChanges()}),this.subscribeToUpgradePlan(),this.authService.permissionData$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(({isAdminOrOwner:e,isTeamManager:t,isProjectManager:n})=>{this.isAdmin=e,this.isTeamManager=t,this.isProjectManager=n,this.setFeatures(),this.checkSubscription(),(e||t)&&this.checkApprovalCount(),this.cd.detectChanges()}),this.userService.membershipForUser.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{e.userId===this.user.id&&(this.user.memberships.push(new MM.a(e)),this.notificationService.getNotification(),this.workspaceService.getAllWorkspaces())}),this.notificationService.newsNotifications$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.newsNotifications=e.length,this.cd.detectChanges()}),this.notificationService.unreadNotifications$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(({length:e})=>{const t=e||0;(t>this.unreadNotifications&&t>0||this.newsNotifications)&&this.topbarNotifications&&this.topbarNotifications.showDropdown(),this.unreadNotifications=t,this.cd.detectChanges()}),this.notificationService.contactSalesNotifications$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.constactSalesNotification=(e||[]).find(e=>e.type===xm.a.CONTACT_SALES&&e.data.workspaceId===this.workspace.id&&!Object(mo.e)(this.workspace.featureSubscriptionType)&&!Object(mo.f)(this.workspace.featureSubscriptionType)),this.cd.detectChanges()}),this.approvalService.pendingCount$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.pendingCount=e,this.cd.markForCheck()}),this.checkPendingTimeOffRequests(),this.systemSettingsService.getCustomLinksSettings(),this.isSubdomain||(this.subscribeToWorkspaces(),this.workspaceService.getAllWorkspaces()),this.checkWorkspceTooltip(),this.setTimerIndicator(),this.subscribeToDarkThemeChanges(),this.subscribeToSidebarState(),this.activeFragment=this.route.fragment.pipe(Object(PM.a)(),Object(Pe.a)(this.unsubscribe$))}blurElementAndSendEvent(e,t,n){e.blur(),this.addEventsLinks(t,n)}addEventsLinks(e,t){this.analyticsService.addEvent(new Fi.a({event:"submit",value:e,section:"Main",section4:t||""}))}themeChange(){this.darkThemeDebouncer$.next(),this.analyticsService.addEvent(new Fi.a({event:"switch",value:this.user.settings.darkTheme,section:"Main"}))}checkPendingTimeOffRequests(){var e;this.workspace.hasFeature(is.a.TIME_OFF)&&(null===(e=this.workspace.timeOff)||void 0===e?void 0:e.active)&&(this.ptoService.hasPendingRequests.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.hasPendingRequests=e,this.cd.detectChanges()}),this.ptoService.getTimeOffRequests({status:["PENDING"]}).subscribe())}get showUpgradeLink(){var e;return!this.isSelfHosted&&this.isAdmin&&(!this.everHadPaidSubscription||Object(mo.g)(null===(e=this.workspace)||void 0===e?void 0:e.featureSubscriptionType))}subscribeToSidebarState(){this.sidebarStateService.sidebarState$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isSidebarOpen=e,this.cd.markForCheck()})}checkWorkspceTooltip(){this.uiSettingsService.getSettings(xn.b.SHOW_WORKSPACE_TOOLTIP)&&!this.isSubdomain&&(this.workspacePickerTooltip&&(this.workspacePickerTooltip.open(),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"Change workspace",section:"Main"}))),this.uiSettingsService.setSettings(xn.b.SHOW_WORKSPACE_TOOLTIP,!1))}subscribeToDarkThemeChanges(){this.darkThemeDebouncer$.pipe(Object(De.a)(500),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>this.updateUser())}updateUser(){this.userService.updateSettings(this.user).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe()}checkApprovalCount(){this.authService.permissionData$.pipe(Object(Zt.a)(e=>null!==e),Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(({isAdmin:e,isTeamManager:t})=>{this.workspace.timeApprovalEnabled&&(e||t)?this.approvalService.getApprovalCount([Ht.PENDING]):this.approvalService.setPendingCount(0)})}subscribeToUpgradePlan(){this.paymentService.onChargeCard$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.everHadPaidSubscription||this.checkSubscription()})}checkSubscription(){this.isAdmin&&!this.isSelfHosted&&(this.paymentService.trialSubscription$.pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.remainingTrialDays=e?this.calculateTrialDays(e.endDate):null,this.cd.markForCheck()}),this.paymentService.everHadPaidSubscription.pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.everHadPaidSubscription=e,this.cd.markForCheck()}),this.paymentService.trialSubscription$.pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.remainingTrialDays=e?this.calculateTrialDays(e.endDate):null,this.cd.markForCheck()}),this.paymentService.invoices$.pipe(Object(Pe.a)(this.unsubscribe$),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.hasOpenInvoice=e&&e.some(e=>"open"===e.status),this.hasPaidInvoice=e&&e.some(e=>"paid"===e.status),this.cd.markForCheck()}),this.paymentService.getEverHadSubscription(),this.paymentService.getInvoices())}calculateTrialDays(e){const t=ke.tz().startOf("D").toISOString();if(this.trialEndsToday(e,t))return 0;const n=ke(e).diff(ke(t),"days");return n>0?n:-1}trialEndsToday(e,t){return ke(t).isSame(ke(e))}discardContactSalesNotification(){this.notificationService.markAsRead(this.constactSalesNotification.id),this.constactSalesNotification=null}setWorkspace(e){var t;const n=(null===(t=this.workspace)||void 0===t?void 0:t.id)!==e.id;this.workspace=e,this.setFeatures(),this.projectGroupingLabel=this.workspaceService.generateClientsLabel(e.projectGroupingLabel),n&&this.notificationService.getNotification(),this.cd.detectChanges()}setFeatures(){var e,t,n,i;this.hasInvoiceFeature=this.workspace.hasFeature(is.a.INVOICING),this.hasExpensesFeature=this.workspace.hasFeature(is.a.EXPENSES),this.hasApprovalFeature=this.workspace.hasFeature(is.a.APPROVAL),this.hasScreenshotsFeature=this.workspace.hasFeature(is.a.SCREENSHOTS),this.hasLocationsFeature=this.workspace.hasFeature(is.a.LOCATIONS),this.hasSchedulingFeature=this.workspace.hasFeature(is.a.SCHEDULING),this.showApprovalLink=this.workspace.timeApprovalEnabled&&this.hasApprovalFeature&&(this.isAdmin||this.isTeamManager),this.showActivityLink=(this.workspace.screenshotsEnabled||this.workspace.locationsEnabled)&&(this.hasScreenshotsFeature||this.hasLocationsFeature),this.showProjectLink=-1==(null===(e=this.workspace)||void 0===e?void 0:e.adminOnlyPages.indexOf("PROJECT"))||this.isAdmin||this.isProjectManager,this.showTeamLink=-1==(null===(t=this.workspace)||void 0===t?void 0:t.adminOnlyPages.indexOf("TEAM"))||this.isAdmin,this.showTimeOff=null===(i=null===(n=this.workspace)||void 0===n?void 0:n.timeOff)||void 0===i?void 0:i.active}setTimerIndicator(){this.checkEntriesInProgress(),this.synchronizationService.onStompEntryChange$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.router.url.startsWith("/tracker")||(e!==BM.a.TIME_ENTRY_STOPPED?e!==BM.a.TIME_ENTRY_STARTED&&e!==BM.a.TIME_ENTRY_DELETED||this.trackerService.getTimeEntryInProgress(!0).subscribe():this.stopwatchService.stop())})}checkEntriesInProgress(){this.router.url.startsWith("/tracker")||this.trackerService.getTimeEntryInProgress(!0).subscribe()}subscribeToRoute(){let e=this.router.url.replace("/","");e=e.split("?")[0],this.isTrackerPage="tracker"===e,this.router.events.pipe(Object(Zt.a)(e=>e instanceof k.b),Object(Pe.a)(this.unsubscribe$)).subscribe(({url:e})=>{this.isDesktop||this.setSidebarState(!1);let t=e.replace("/","");t=t.split("?")[0],this.isTrackerPage="tracker"===t,this.cd.detectChanges()})}addSupportLink(){if(!this.standardLinks)return;if(this.isForbiddenZone)return;this.supportLinks=this.supportLinks.filter(e=>"https://calendly.com/clockify-support/call"!=e.uri);const e=[new UM({uri:"https://calendly.com/clockify-support/call",copy:this.translateService.instant("GLOBAL.CALL_SUPPORT_LABEL")})];this.supportLinks=[...this.supportLinks,...e],this.cd.detectChanges()}subscribeToTrackerTime(){this.stopwatchService.stateChanged.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.timerIsRunning=e===VA.b.STARTED,this.cd.detectChanges()})}navigateToHome(){this.isTrackerPage?this.browserService.scrollToTop():this.router.navigate(["tracker"])}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}get activeWorkspaceId(){return this.workspace&&this.workspace.id||""}subscribeToWorkspaces(){this.workspaceService.workspaces$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspaces=e,this.cd.detectChanges()},e=>{this.workspaces&&1===this.workspaces.length&&this.userService.setDefaultUserWorkspace(this.workspaces[0].id,this.workspaces[0])})}changeDefaultWorkspace(e){e.id===this.workspace.id||(this.analyticsService.addEvent(new Fi.a({event:"submit",value:"Change workspace",section:"Main",section2:"Workspaces"})),this.userService.setDefaultUserWorkspace(e.id,e))}setSidebarStateOnMobile(e){this.isDesktop||this.setSidebarState(e)}setSidebarState(e){this.sidebarStateService.setSidebar(e)}logout(){this.authService.logout()}checkAndChangeWorkspace(){this.workspaceService.getWorkspaceById(this.workspace.id).pipe(Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{},()=>{const e=this.workspaces.filter(e=>e.id!==this.workspace.id);e.length?this.changeDefaultWorkspace(e[0]):this.logout()})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(re.a),s.Rb(k.d),s.Rb(Gm.a),s.Rb(l.a),s.Rb(Lc.a),s.Rb(VA.a),s.Rb(bn.a),s.Rb(WA.a),s.Rb(dC.a),s.Rb(Gn.a),s.Rb(MA.a),s.Rb(Lb.a),s.Rb(xn.a),s.Rb(s.h),s.Rb(FA.a),s.Rb(rn),s.Rb(a_.a),s.Rb(NL.b),s.Rb(g.f),s.Rb(xi.a),s.Rb(k.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["sidebar-and-topbar"],["","sidebar-and-topbar",""]],viewQuery:function(e,t){var n;1&e&&(s.gd(SB,!0),s.gd(CB,!0),s.gd(AB,!0)),2&e&&(s.Kc(n=s.kc())&&(t.topbarNotifications=n.first),s.Kc(n=s.kc())&&(t.workspacePickerTooltip=n.first),s.Kc(n=s.kc())&&(t.topbarDropdowns=n))},decls:81,vars:41,consts:[["id","topbar-menu",1,"cl-navbar","cl-pl-0","cl-pr-lg-3","cl-d-flex","cl-align-items-center","cl-border-bottom","cl-top-bar","cl-new-layer","cl-d-print-none"],[1,"cl-d-flex","cl-justify-content-between","cl-align-items-center","cl-w-100"],[1,"cl-d-flex","cl-align-items-center","top-bar-nav-align"],["type","button",1,"cl-navbar-toggler",3,"click"],["hamburgerBtn",""],[1,"cl-navbar-toggler-icon"],[1,"cl-logo-mob"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 134 33","fill","none",1,"pointer",3,"click"],["d","M14.4 9.79995L20 4.19995L21.6 5.79995L16 11.4L14.4 9.79995ZM12.1 15.6C11 15.6 10.1 14.7 10.1 13.6C10.1 12.5 11 11.6 12.1 11.6C13.2 11.6 14.1 12.5 14.1 13.6C14.1 14.7 13.2 15.6 12.1 15.6ZM21.7 21.4L20.1 23L14.5 17.4L16.1 15.7999L21.7 21.4Z","fill","#222222",1,"cl-logo-hands"],["d","M124.7 29.1C124.2 30.3 123.4 31.2 122.5 31.9C121.5 32.6 120.5 32.9 119.3 32.9C117.7 32.9 116.2 32.3 114.8 31.1L116.5 28C117.3 28.7 118.1 29.1 119 29.1C119.8 29.1 120.5 28.8 121.1 28.2C121.6 27.6 121.9 26.9 121.9 26.2C121.9 25.9 119.5 19.7 114.6 7.7H118.7L124.1 21L129.5 7.7H133.6L124.7 29.1ZM110.8 3.4C110 3.4 109.4 3.7 108.9 4.2C108.4 4.7 108.2 5.4 108.2 6.2V7.7H112.9V10.7H108.2V25.7H104.4V10.7H102.1V7.7H104.4V6.3C104.4 4.4 105 2.9 106.1 1.8C107.2 0.699999 108.6 0.100002 110.2 0.100002C111.8 0.100002 113.3 0.700001 114.6 1.9L113 4.6C112.3 3.8 111.6 3.4 110.8 3.4ZM96.2 4.8C95.5 4.8 95 4.6 94.5 4.1C94 3.6 93.8 3.1 93.8 2.4C93.8 1.7 94 1.2 94.5 0.700001C95 0.200001 95.5 0 96.2 0C96.9 0 97.4 0.200001 97.9 0.700001C98.4 1.2 98.6 1.7 98.6 2.4C98.6 3.1 98.4 3.6 97.9 4.1C97.5 4.6 96.9 4.8 96.2 4.8ZM86.4 25.7L81.1 17.8L78.4 20.6V25.7H74.6V0.600002H78.4V15.3L85.7 7.7H90.6L83.8 14.8L91.1 25.7H86.4V25.7ZM65.4 22.5C66.3 22.5 67.2 22.3 68 21.8L70.4 24.2C68.7 25.3 66.8 25.9 64.8 25.9C62.3 25.9 60.1 25 58.3 23.3C56.5 21.6 55.6 19.4 55.6 16.6C55.6 13.8 56.5 11.6 58.4 9.9C60.3 8.2 62.6 7.3 65.3 7.3C67.1 7.3 68.8 7.7 70.2 8.6L67.5 11.3C66.7 11 66 10.8 65.2 10.8C63.6 10.8 62.3 11.3 61.1 12.4C59.9 13.4 59.4 14.8 59.4 16.5C59.4 18.2 60 19.6 61.1 20.7C62.3 21.9 63.7 22.5 65.4 22.5ZM43.1 26C40.4 26 38.1 25.1 36.3 23.3C34.5 21.5 33.6 19.3 33.6 16.7C33.6 14.1 34.5 11.9 36.3 10.1C38.1 8.3 40.4 7.4 43.1 7.4C45.8 7.4 48.1 8.3 49.9 10.1C51.7 11.9 52.6 14.1 52.6 16.7C52.6 19.3 51.7 21.5 49.9 23.3C48.1 25.1 45.8 26 43.1 26ZM47.2 12.4C46.1 11.3 44.8 10.8 43.1 10.8C41.5 10.8 40.1 11.3 39 12.4C37.9 13.5 37.4 14.9 37.4 16.6C37.4 18.3 37.9 19.8 39 20.8C40.1 21.9 41.4 22.4 43.1 22.4C44.7 22.4 46.1 21.9 47.2 20.8C48.3 19.7 48.8 18.3 48.8 16.6C48.8 15 48.3 13.5 47.2 12.4ZM25.9 0.600002H29.7V25.7H25.9V0.600002ZM12.2 22.2C13.3 22.2 14.4 22 15.4 21.6L18.2 24.4C16.4 25.4 14.4 25.9 12.3 25.9C5.5 25.9 0 20.4 0 13.6C0 6.8 5.5 1.3 12.3 1.3C14.5 1.3 16.5 1.9 18.2 2.8L15.5 5.5C14.5 5.1 13.4 4.9 12.3 4.9C7.5 4.9 3.7 8.8 3.7 13.5C3.6 18.3 7.4 22.2 12.2 22.2ZM98.1 25.7H94.3V7.7H98.1V25.7Z","fill","#03A9F4"],[4,"ngIf"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end","cl-cut-text-wrapper"],[1,"cl-d-none","cl-d-lg-inline-flex","cl-cut-text-wrapper"],["dropdownKey","","class","cl-dropdown cl-dropdown-top-bar-ws cl-d-flex cl-justify-content-end cl-cut-text-wrapper",3,"onOpen",4,"ngIf"],[1,"cl-d-none","cl-d-lg-inline-flex"],["target","_blank",3,"href",4,"ngIf"],["dropdownKey","","class","cl-dropdown cl-d-flex cl-ml-3",4,"ngIf"],[1,"cl-d-flex","cl-align-items-center"],["dropdownKey","",1,"cl-dropdown","cl-dropdown-large"],["topbarNotifications","dropdownKey","topbarDropdowns","dropdownKey"],["tabindex","0","dropdownKeyButton","",1,"cl-dropdown-toggle","cl-no-arrow","cl-d-flex","cl-component-divided-left"],["src","assets/nav-icons/notification.svg"],["class","cl-badge cl-badge-pill cl-notification-badge",4,"ngIf"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],["dropdownKey","",1,"cl-dropdown","cl-component-divided-left","cl-pr-0"],["topbarDropdowns","dropdownKey"],["tabindex","0","dropdownKeyButton","",1,"cl-p-0","cl-dropdown-toggle","cl-no-arrow","cl-d-flex"],[3,"classSize","src","name"],["class","cl-dropdown-menu cl-dropdown-menu-right cl-dropdown-menu-user-profile",4,"dropdownKeyContent"],["id","sidebar-menu",1,"cl-layout-aside"],[1,"cl-navbar","cl-navbar-expand-lg","cl-navbar-light"],[1,"cl-navbar-collapse","cl-offcanvas-collapse"],[1,"cl-sidebar-wrapper"],[1,"cl-sidebar-header"],["type","button",1,"cl-navbar-toggler","cl-d-block",3,"click"],[1,"cl-sidebar-container"],[1,"cl-navbar-container"],[1,"cl-navbar-nav"],["class","cl-nav-item cl-dropdown","routerLinkActive","cl-active",4,"ngIf"],["routerLinkActive","cl-active",1,"cl-nav-item","cl-dropdown"],["routerLink","/calendar",1,"cl-nav-link","cl-indigo"],[1,"cl-nav-icon-wrapper"],["src","assets/nav-icons/calendar.svg"],[1,"cl-nav-link-copy"],["class","cl-dropdown-menu cl-dropdown-menu-nav",4,"ngIf"],[1,"cl-m-0"],[1,"cl-pl-3"],[1,"cl-nav-link","cl-ml-1"],[1,"cl-h5","cl-mb-0"],["routerLink","/dashboard",1,"cl-nav-link","cl-light-green"],["src","assets/nav-icons/dashboard.svg"],[1,"cl-offcanvas-collapse-bg",3,"click"],["class","cl-d-none cl-d-lg-inline-flex cl-align-items-center cl-contact-wrapper",4,"ngIf"],[1,"cl-d-none","cl-d-lg-inline-flex","cl-align-items-center","cl-contact-wrapper"],["class","cl-btn-group cl-mr-2",4,"ngIf"],["class","cl-alert cl-alert-primary cl-d-inline-flex cl-p-1 cl-border-0 cl-mb-0 cl-px-2 cl-topbar-alert cl-cut-text cl-flex-wrap cl-w-50 cl-w-xl-100",4,"ngIf"],[1,"cl-btn-group","cl-mr-2"],["href","https://clockify.me/help/contact/sales","target","_blank",1,"cl-btn","cl-btn-sm","cl-btn-outline-primary","cl-transform-none","no-wrap",3,"click"],["contactLink",""],["type","button",1,"cl-btn","cl-btn-sm","cl-btn-outline-primary","cl-border-left-0","cl-lh-0","cl-font-size-lg",2,"font-size","20px",3,"click"],[1,"cl-alert","cl-alert-primary","cl-d-inline-flex","cl-p-1","cl-border-0","cl-mb-0","cl-px-2","cl-topbar-alert","cl-cut-text","cl-flex-wrap","cl-w-50","cl-w-xl-100"],["class","cl-mr-1 cl-cut-text",4,"ngIf"],["href","https://clockify.me/help/contact/sales","target","_blank",1,"cl-cut-text"],[1,"cl-mr-1","cl-cut-text"],["dropdownKey","",1,"cl-dropdown","cl-dropdown-top-bar-ws","cl-d-flex","cl-justify-content-end","cl-cut-text-wrapper",3,"onOpen"],["dropdownKeyButton","","triggers","manual","placement","bottom","tabindex","0","data-cy","workspace-dropdown",1,"cl-dropdown-toggle","pointer","cl-cut-text",3,"ngbTooltip","autoClose"],["workspacePickerTooltip","ngbTooltip"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-dropdown-menu-header"],[1,"cl-item-between","cl-w-100"],[1,"cl-dropdown-header","cl-h5","cl-pl-2"],[1,"cl-dropdown-item-workspace-right","cl-mr-2"],["routerLink","/workspaces","clickCloseDropdown","",1,"cl-ml-2","cl-d-inline",3,"click"],[1,"cl-scroll-area"],[4,"ngFor","ngForOf"],["clickCloseDropdown","",1,"cl-dropdown-item","cl-dropdown-item-workspace","cl-cut-text-wrapper","cl-relative",3,"title","ngClass","click"],["class","cl-ws-plan-border",3,"ngClass",4,"ngIf"],[1,"cl-cut-text"],["class","cl-dropdown-item-workspace-right",4,"ngIf"],[1,"cl-ws-plan-border",3,"ngClass"],[1,"cl-dropdown-item-workspace-right"],["src","assets/ui-icons/checkmark-green.svg"],[1,"cl-dropdown-active-workspace-label","cl-d-none","cl-d-lg-inline"],[1,"cl-d-inline-flex","cl-mr-3","cl-mr-lg-0","cl-no-outline"],["routerLink","/upgrade","class","cl-btn cl-btn-sm cl-btn-outline-primary cl-ml-3","clickCloseDropdown","",3,"click",4,"ngIf","ngIfElse"],["FreePlanDesktopTempl",""],["routerLink","/upgrade","clickCloseDropdown","",1,"cl-btn","cl-btn-sm","cl-btn-outline-primary","cl-ml-3",3,"click"],["upgrade",""],[4,"ngIf","ngIfElse"],["routerLink","/subscription","fragment","plans","clickCloseDropdown","",1,"cl-btn","cl-btn-sm","cl-btn-outline-primary","cl-ml-3",3,"click"],["target","_blank",3,"href"],[3,"src"],["dropdownKey","",1,"cl-dropdown","cl-d-flex","cl-ml-3"],["dropdownKeyButton","","tabindex","0",1,"cl-dropdown-toggle","cl-no-arrow","cl-component-divided-left"],["class","cl-dropdown-item","target","_blank",3,"href","click",4,"ngFor","ngForOf"],["target","_blank",1,"cl-dropdown-item",3,"href","click"],[1,"cl-badge","cl-badge-pill","cl-notification-badge"],["notifications","",3,"user","workspaceChangedEvent"],[1,"cl-dropdown-menu","cl-dropdown-menu-right","cl-dropdown-menu-user-profile"],[1,"cl-dropdown-header","cl-pl-2","cl-cut-text-wrapper"],[1,"cl-cut-text","cl-h4","cl-mb-2","cl-text-dark"],[1,"cl-cut-text","cl-text-gray-9","cl-small"],["class","cl-d-lg-none",4,"ngIf"],["routerLink","/user/settings","clickCloseDropdown","",1,"cl-dropdown-item"],[1,"cl-dropdown-item"],[1,"cl-custom-control","cl-custom-switch","cl-custom-switch-right"],["type","checkbox","id","darkThemeTopbar",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","darkThemeTopbar",1,"cl-custom-control-label","cl-w-100"],["href","https://clockify.me/apps","target","_blank",1,"cl-dropdown-item",3,"click"],["href","https://pumble.com/","target","_blank",1,"cl-dropdown-item","cl-item-between",3,"click"],[1,"cl-whitespace-pre-line"],[1,"cl-badge","cl-badge-success","cl-ml-3","cl-mr-n1"],["href","https://clockify.me/help","target","_blank",1,"cl-dropdown-item","cl-d-lg-none"],[1,"cl-dropdown-divider","cl-border-light"],["data-cy","logout",1,"cl-dropdown-item",3,"click"],[1,"cl-d-lg-none"],["class","cl-cut-text-wrapper",4,"ngIf"],[1,"cl-cut-text-wrapper"],["dropdownKey","",1,"cl-dropdown",3,"onOpen"],["dropdownKeyButton","","triggers","manual","placement","bottom","tabindex","0",1,"cl-dropdown-toggle","cl-pl-2","pointer","cl-cut-text","cl-w-100",3,"ngbTooltip","autoClose"],[1,"cl-pr-1"],["routerLink","/workspaces","clickCloseDropdown","",1,"cl-ml-2","cl-d-inline"],["routerLink","/upgrade","class","cl-btn cl-btn-sm cl-btn-outline-primary cl-ml-1 cl-mr-2","clickCloseDropdown","",4,"ngIf","ngIfElse"],["FreePlanMobTempl",""],["routerLink","/upgrade","clickCloseDropdown","",1,"cl-btn","cl-btn-sm","cl-btn-outline-primary","cl-ml-1","cl-mr-2"],["routerLink","/subscription","fragment","plans","clickCloseDropdown","",1,"cl-btn","cl-btn-sm","cl-btn-outline-primary","cl-ml-1","cl-mr-2"],["routerLink","/timesheet",1,"cl-nav-link","cl-blue"],["src","assets/nav-icons/timesheet.svg"],[1,"cl-dropdown-menu","cl-dropdown-menu-nav"],["routerLink","/timesheet",1,"cl-dropdown-item","cl-text-uppercase"],["routerLink","/tracker",1,"cl-nav-link","cl-orange"],["src","assets/nav-icons/time-tracker.svg"],["stopwatch-seconds","",4,"ngIf","ngIfElse"],["trackerTemplate",""],["stopwatch-seconds",""],["routerLink","/tracker",1,"cl-dropdown-item","cl-text-uppercase"],["routerLink","/calendar",1,"cl-dropdown-item","cl-text-uppercase"],["routerLink","/expenses",1,"cl-nav-link","cl-indigo"],["src","assets/nav-icons/expenses.svg"],["routerLink","/expenses",1,"cl-dropdown-item","cl-text-uppercase"],["ptoLi",""],[1,"cl-z0","cl-nav-link","cl-dropdown-toggle","cl-green","cl-d-lg-none","pointer",3,"toggleClass","toggleElement"],["src","assets/nav-icons/timeOff.svg"],["routerLink","/time-off",1,"cl-nav-link","cl-dropdown-toggle","cl-green","cl-d-none","cl-d-lg-flex"],["class","cl-text-warning cl-ml-auto cl-h1 cl-mb-0 cl-approval-bullet",4,"ngIf"],[1,"cl-dropdown-menu","cl-green","cl-dropdown-menu-nav"],["routerLinkActive","cl-active","routerLink","/time-off/requests",1,"cl-dropdown-item"],["routerLinkActive","cl-active","routerLink","/time-off/timeline",1,"cl-dropdown-item"],["routerLinkActive","cl-active","routerLink","/time-off/balance",1,"cl-dropdown-item"],[1,"cl-text-warning","cl-ml-auto","cl-h1","cl-mb-0","cl-approval-bullet"],[1,"cl-px-3","cl-py-2","cl-d-inline-block","cl-text-uppercase"],["routerLink","/dashboard",1,"cl-dropdown-item","cl-text-uppercase"],["reportsLi",""],[1,"cl-z0","cl-nav-link","cl-dropdown-toggle","cl-pink","cl-d-lg-none","pointer",3,"toggleClass","toggleElement"],["src","assets/nav-icons/reports.svg"],["routerLink","/reports/summary",1,"cl-nav-link","cl-dropdown-toggle","cl-pink","cl-d-none","cl-d-lg-flex",3,"queryParams"],[1,"cl-dropdown-menu","cl-pink","cl-dropdown-menu-nav"],["class","cl-h5 cl-mb-0 cl-px-3 cl-py-2 cl-d-inline-block cl-text-uppercase",4,"ngIf"],["routerLinkActive","cl-active","routerLink","/reports/summary",1,"cl-dropdown-item",3,"queryParams"],["routerLinkActive","cl-active","routerLink","/reports/detailed",1,"cl-dropdown-item",3,"queryParams"],["routerLinkActive","cl-active","routerLink","/reports/weekly",1,"cl-dropdown-item",3,"queryParams"],["routerLinkActive","cl-active","routerLink","/reports/shared",1,"cl-dropdown-item"],[1,"cl-h5","cl-mb-0","cl-px-3","cl-py-2","cl-d-inline-block","cl-text-uppercase"],["routerLinkActive","cl-active","routerLink","/reports/expense/detailed",1,"cl-dropdown-item",3,"queryParams"],[1,"cl-nav-link","cl-pink",3,"routerLink"],["src","assets/nav-icons/activity.svg"],[1,"cl-dropdown-item","cl-text-uppercase",3,"routerLink"],["activityLi",""],[1,"cl-nav-link","cl-dropdown-toggle","cl-pink","cl-d-none","cl-d-lg-flex",3,"routerLink"],["routerLinkActive","cl-active","routerLink","/activity/screenshots",1,"cl-dropdown-item"],["routerLinkActive","cl-active","routerLink","/activity/locations",1,"cl-dropdown-item"],["routerLink","/approvals",1,"cl-nav-link","cl-light-green"],["src","assets/nav-icons/approvals.svg"],["class","cl-text-warning cl-ml-auto cl-mr-2 cl-h1 cl-mb-0 cl-approval-bullet",4,"ngIf"],[1,"cl-text-warning","cl-ml-auto","cl-mr-2","cl-h1","cl-mb-0","cl-approval-bullet"],["routerLink","/approvals",1,"cl-dropdown-item","cl-text-uppercase"],["routerLink","/projects",1,"cl-nav-link","cl-yellow"],["src","assets/nav-icons/projects.svg"],["routerLink","/projects",1,"cl-dropdown-item","cl-text-uppercase"],["routerLink","/teams",1,"cl-nav-link","cl-purple"],["src","assets/nav-icons/teams.svg"],["routerLink","/teams",1,"cl-dropdown-item","cl-text-uppercase"],[1,"cl-nav-link","cl-deep-orange","cl-pr-2",3,"routerLink"],["src","assets/nav-icons/clients.svg"],[1,"cl-nav-link-copy","cl-cut-text"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"cl-nav-link","cl-deep-purple",3,"routerLink"],["src","assets/nav-icons/tags.svg"],["class","cl-nav-item cl-dropdown",4,"ngIf"],["settingsLi",""],["activeLink","","fragment","settings",1,"cl-nav-link","cl-teal",3,"linkElement","activeFragments","routerLink"],["src","assets/nav-icons/settings.svg"],[1,"cl-dropdown-item","cl-text-uppercase","cl-cut-text",3,"routerLink"],["routerLink","/invoices",1,"cl-nav-link","cl-green"],["src","assets/nav-icons/invoices"],["routerLink","/invoices",1,"cl-dropdown-item","cl-text-uppercase"],["schedulingLi",""],["src","assets/nav-icons/scheduling.svg"],["routerLink","/scheduling","fragment","projects",1,"cl-nav-link","cl-dropdown-toggle","cl-pink","cl-d-none","cl-d-lg-flex"],["routerLink","/scheduling","fragment","projects",1,"cl-dropdown-item"],["routerLink","/scheduling","fragment","team",1,"cl-dropdown-item"],[1,"cl-nav-item","cl-dropdown"],["subscriptionLi",""],["activeLink","","fragment","payment",1,"cl-nav-link","cl-teal",3,"linkElement","activeFragments","routerLink"],["src","assets/nav-icons/subscription.svg"],["fragment","payment",1,"cl-dropdown-item","cl-text-uppercase",3,"routerLink"],["fragment","settings",1,"cl-dropdown-item","cl-text-uppercase",3,"routerLink"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"button",3,4),s.jc("click",(function(){s.Oc(e);const n=s.Lc(4);return t.setSidebarState(!t.isSidebarOpen),n.blur()})),s.Sb(5,"span",5),s.Wb(),s.Xb(6,"div",6),s.mc(),s.Xb(7,"svg",7),s.jc("click",(function(){return t.navigateToHome()})),s.Sb(8,"path",8),s.Sb(9,"path",9),s.Wb(),s.Wb(),s.Xc(10,yB,2,1,"ng-container",10),s.Wb(),s.lc(),s.Xb(11,"div",11),s.Xb(12,"div",12),s.Xc(13,PB,7,5,"div",13),s.Wb(),s.Xc(14,GB,5,2,"ng-container",10),s.Xb(15,"div",14),s.Xc(16,xB,3,2,"a",15),s.Xc(17,ZB,5,1,"div",16),s.Wb(),s.Xb(18,"div",17),s.Xb(19,"div",18,19),s.Xb(22,"a",20),s.Sb(23,"img",21),s.Xc(24,VB,2,1,"span",22),s.Wb(),s.Xc(25,YB,2,1,"div",23),s.Wb(),s.Xb(26,"div",24,25),s.Xb(28,"a",26),s.Sb(29,"avatar",27),s.Wb(),s.Xc(30,nU,34,25,"div",28),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(31,"aside",29),s.Xb(32,"nav",30),s.Xb(33,"div",31),s.Xb(34,"div",32),s.Xb(35,"div",33),s.Xb(36,"button",34,4),s.jc("click",(function(){s.Oc(e);const n=s.Lc(4);return t.setSidebarState(!t.isSidebarOpen),n.blur()})),s.Sb(38,"span",5),s.Wb(),s.Xb(39,"div",6),s.mc(),s.Xb(40,"svg",7),s.jc("click",(function(){return t.navigateToHome()})),s.Sb(41,"path",8),s.Sb(42,"path",9),s.Wb(),s.Wb(),s.Wb(),s.lc(),s.Xb(43,"div",35),s.Xb(44,"div",36),s.Xb(45,"ul",37),s.Xc(46,sU,8,4,"li",38),s.Xc(47,rU,9,3,"li",38),s.Xb(48,"li",39),s.Xb(49,"a",40),s.Xb(50,"span",41),s.Sb(51,"img",42),s.Wb(),s.Xb(52,"span",43),s.Zc(53),s.oc(54,"translate"),s.Wb(),s.Wb(),s.Xc(55,lU,4,3,"div",44),s.Wb(),s.Xc(56,dU,8,4,"li",38),s.Xc(57,hU,26,18,"li",38),s.Xb(58,"li"),s.Sb(59,"hr",45),s.Wb(),s.Xb(60,"li",46),s.Xb(61,"span",47),s.Xb(62,"span",48),s.Zc(63),s.oc(64,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(65,"li",39),s.Xb(66,"a",49),s.Xb(67,"span",41),s.Sb(68,"img",50),s.Wb(),s.Xb(69,"span",43),s.Zc(70),s.oc(71,"translate"),s.Wb(),s.Wb(),s.Xc(72,mU,4,3,"div",44),s.Wb(),s.Xc(73,SU,30,26,"li",38),s.Xc(74,wU,3,2,"ng-container",10),s.Xc(75,LU,8,7,"ng-container",10),s.Xc(76,_U,9,5,"li",38),s.Xc(77,WU,8,4,"li",38),s.Xc(78,NU,8,4,"li",38),s.Xc(79,sG,32,26,"ng-container",10),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(80,"div",51),s.jc("click",(function(){return t.setSidebarState(!1)})),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(10),s.wc("ngIf",!t.isSelfHosted&&!t.isForbiddenZone),s.Cb(3),s.wc("ngIf",!t.isSubdomain),s.Cb(1),s.wc("ngIf",t.showUpgradeLink),s.Cb(2),s.wc("ngIf",1===(null==t.supportLinks?null:t.supportLinks.length)),s.Cb(1),s.wc("ngIf",(null==t.supportLinks?null:t.supportLinks.length)>1),s.Cb(7),s.wc("ngIf",t.unreadNotifications||t.newsNotifications),s.Cb(5),s.wc("classSize","cl-no-image-wrapper-sm")("src",null==t.user?null:t.user.profilePicture)("name",null==t.user?null:t.user.name),s.Cb(2),s.Hb("cl-get-out",!t.isSidebarOpen),s.Cb(2),s.Hb("cl-open",t.isSidebarOpen),s.Cb(13),s.wc("ngIf",null==t.workspace?null:t.workspace.canSeeTimeSheet),s.Cb(1),s.wc("ngIf",null==t.workspace?null:t.workspace.canSeeTracker),s.Cb(6),s.ad(s.pc(54,35,"GLOBAL.CALENDAR_LABEL")),s.Cb(2),s.wc("ngIf",t.isDesktop&&!t.isSidebarOpen),s.Cb(1),s.wc("ngIf",t.hasExpensesFeature&&t.workspace.expensesEnabled),s.Cb(1),s.wc("ngIf",t.showTimeOff),s.Cb(2),s.Hb("cl-d-none",t.isSidebarOpen),s.Cb(1),s.Hb("cl-d-none",!t.isSidebarOpen),s.Cb(3),s.ad(s.pc(64,37,"LAYOUT.SIDEBAR.NAVIGATION.ANALYZE_LABEL")),s.Cb(7),s.ad(s.pc(71,39,"GLOBAL.DASHBOARD_LABEL")),s.Cb(2),s.wc("ngIf",t.isDesktop&&!t.isSidebarOpen),s.Cb(1),s.wc("ngIf",-1==(null==t.workspace?null:t.workspace.adminOnlyPages.indexOf("REPORTS"))||t.isAdmin||t.isTeamManager||t.isProjectManager),s.Cb(1),s.wc("ngIf",t.showActivityLink),s.Cb(1),s.wc("ngIf",t.isAdmin||t.showApprovalLink||t.showProjectLink||t.showTeamLink),s.Cb(1),s.wc("ngIf",t.showApprovalLink),s.Cb(1),s.wc("ngIf",t.showProjectLink),s.Cb(1),s.wc("ngIf",t.showTeamLink),s.Cb(1),s.wc("ngIf",t.isAdmin),s.Cb(1),s.Hb("cl-open",t.isSidebarOpen))},directives:[i.u,ni.a,ii.a,si.a,Pc.a,k.f,k.g,w.bb,i.t,i.r,gB,v.a,v.s,v.v,HA,EB,i.y,i.z,i.A,fB],pipes:[g.e,i.b],encapsulation:2,changeDetection:0}),e})();const aG=["admin"],oG=["emailVerifiedConnectionModals"],rG=["emailNotVerifiedModal"];function lG(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",4,5),s.jc("click",(function(){return s.Oc(e),s.Lc(1).open()})),s.oc(2,"translate"),s.Sb(3,"img",6),s.Xb(4,"span",7),s.Zc(5,"CHAT"),s.Wb(),s.Wb()}2&e&&(s.xc("ngbPopover",s.pc(2,3,"WORKSPACE.INTEGRATION.PUMBLE.POPOVER_USER")),s.wc("autoClose",!1)("closeDelay",3e3))}function bG(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",9,10),s.jc("click",(function(){s.Oc(e);const t=s.Lc(1);return s.nc(4).setIsOpened(!0),t.close()})),s.oc(2,"translate"),s.Sb(3,"img",6),s.Xb(4,"span",7),s.Zc(5,"CHAT"),s.Wb(),s.Wb()}2&e&&(s.xc("ngbPopover",s.pc(2,2,"WORKSPACE.INTEGRATION.PUMBLE.POPOVER_ADMIN")),s.wc("autoClose",!1))}function dG(e,t){if(1&e&&(s.Xb(0,"div"),s.Xc(1,bG,6,4,"div",8),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngIf",!e.isOpened)}}function uG(e,t){if(1&e&&(s.Xb(0,"div"),s.Xc(1,lG,6,5,"div",3),s.Xc(2,dG,2,1,"div",0),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",!e.isClockifyAdmin),s.Cb(1),s.wc("ngIf",e.isClockifyAdmin)}}function pG(e,t){if(1&e&&(s.Xb(0,"div",33),s.Xb(1,"div",34),s.Sb(2,"avatar",35),s.Xb(3,"div",36),s.Zc(4),s.Wb(),s.Wb(),s.Wb()),2&e){const e=t.$implicit;s.Cb(2),s.wc("classSize","cl-no-image-wrapper-sm")("src",e.profilePicture)("name",e.name),s.Cb(2),s.ad(e.name)}}const hG=function(e,t){return{"pumble-widget-container--appear":e,"pumble-widget-container--isClosing":t}};function mG(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Xb(1,"div",11),s.Xb(2,"div",12),s.Xb(3,"div",13),s.Xb(4,"div",14),s.Xb(5,"div",15),s.Sb(6,"img",16),s.Wb(),s.Xb(7,"div",17),s.Xb(8,"a",18),s.Xb(9,"img",19),s.jc("click",(function(){return s.Oc(e),s.nc(2).setIsOpened(!1)})),s.Wb(),s.Wb(),s.Wb(),s.Xb(10,"div",20),s.Xb(11,"img",21),s.jc("click",(function(){return s.Oc(e),s.nc(2).setIsOpened(!1)})),s.Wb(),s.Wb(),s.Wb(),s.Xb(12,"div",22),s.Xb(13,"div",23),s.Xb(14,"p",24),s.Zc(15),s.oc(16,"translate"),s.Wb(),s.Xb(17,"a",18),s.mc(),s.Xb(18,"svg",25),s.Sb(19,"path",26),s.Sb(20,"path",27),s.Wb(),s.Wb(),s.lc(),s.Xb(21,"button",28),s.jc("click",(function(){return s.Oc(e),s.nc(2).openConnectionModal()})),s.Zc(22),s.oc(23,"translate"),s.Wb(),s.Xb(24,"button",29),s.jc("click",(function(){return s.Oc(e),s.nc(2).hideChatWidget()})),s.Zc(25),s.oc(26,"translate"),s.Wb(),s.Wb(),s.Xb(27,"div",30),s.Xc(28,pG,5,4,"div",31),s.Wb(),s.Sb(29,"div",32),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(1),s.wc("ngClass",s.Cc(11,hG,e.isOpened,!e.isOpened)),s.Cb(14),s.ad(s.pc(16,5,"WORKSPACE.INTEGRATION.PUMBLE.CHAT")),s.Cb(7),s.bd(" ",s.pc(23,7,"WORKSPACE.INTEGRATION.PUMBLE.ENABLE_CHAT"),""),s.Cb(3),s.ad(s.pc(26,9,"WORKSPACE.INTEGRATION.PUMBLE.HIDE_CHAT")),s.Cb(3),s.wc("ngForOf",e.contacts)}}function gG(e,t){if(1&e&&(s.Xb(0,"div"),s.Xc(1,uG,3,2,"div",0),s.Xc(2,mG,30,14,"div",0),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",!e.isOpened),s.Cb(1),s.wc("ngIf",e.isClockifyAdmin)}}function EG(e,t){1&e&&(s.Xb(0,"verify-email-modal",37),s.jc("close",(function(){return t.$implicit.close()})),s.Wb())}function fG(e,t){if(1&e&&(s.Xb(0,"pumble-integration-modals",38),s.jc("close",(function(){return t.$implicit.close()})),s.Wb()),2&e){const e=s.nc();s.wc("workspaceId",e.workspace.id)("integration",null)("connected",e.isConnected)("pumbleSettings",e.pumbleSettings)}}let SG=(()=>{class e{constructor(e,t,n,i,s,c,a){this.workspaceService=e,this.cd=t,this.authService=n,this.modalService=i,this.pumbleService=s,this.translateService=c,this.toaster=a,this.isConnected=!1,this.isChatEnabled=!1,this.isClockifyAdmin=!1,this.unsubscribe$=new p.a,this.isEmailVerified=!1,this.pumbleSettings=new xu,this.contacts=[]}ngOnInit(){var e;this.isOpened=!1,this.checkIfConnected(),this.isClockifyAdmin=this.authService.isAdminOrOwner(),this.isEmailVerified="ACTIVE"==this.authService.getUser().status,this.isNew="true"===localStorage.getItem("bannerClicked"),this.isClockifyAdmin=this.authService.isAdminOrOwner(),this.isSelfHosted=null===(e=null==bo.a?void 0:bo.a.environment)||void 0===e?void 0:e.selfHosted}ngAfterViewInit(){this.isNew&&this.isChatEnabled&&!this.isConnected&&this.isClockifyAdmin&&setTimeout(()=>{this.adminPopover.open()},1e3)}checkIfConnected(){this.workspaceService.isPumbleActivated$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isConnected=e,this.cd.detectChanges()}),this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e,this.fillContactsList(e.showChatWidget),this.checkConnectionAndMount(e),this.cd.detectChanges()})}checkConnectionAndMount(e){this.workspaceService.checkIfPumbleIsConnected(e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.workspaceService.isPumbleActivated$.next(t.connected),t.connected&&this.workspaceService.mountPumble(e.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.pumbleService.mountPumble(e.integrationToken)})})}openModal(e){this.modalService.open(e,{centered:!0})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}fillContactsList(e){this.contacts=[],this.isChatEnabled=!1,this.workspaceService.getActiveMembers("").pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{t.forEach(e=>{e.id===this.authService.getUser().id||this.contacts.includes(e)||this.contacts.push({name:e.name,profilePicture:e.profilePicture})}),this.contacts.length>6&&(this.contacts=this.contacts.slice(0,7)),this.contacts.length>0&&(this.isChatEnabled=e),this.cd.detectChanges()})}setIsOpened(e){e&&this.isNew&&(localStorage.setItem("bannerClicked","true"),this.adminPopover.close()),this.isOpened=e,this.cd.detectChanges()}hideChatWidget(){this.workspace.showChatWidget=!1,this.workspaceService.updateWorkspaceSettings(this.workspace),this.isOpened=!1,this.cd.detectChanges()}openConnectionModal(){this.isEmailVerified?this.getPumbleWorkspaces():this.openModal(this.emailNotVerifiedModal)}getPumbleWorkspaces(){this.workspaceService.getIntegrationToken(this.workspace.id).pipe(Dh(1e4)).subscribe(e=>{this.workspaceService.getPumbleWorkspaces(e.integrationToken).pipe(Dh(2e3)).subscribe(e=>{this.pumbleSettings.pumbleWorkspaces=[],e.workspaces&&(this.pumbleSettings.hasPumbleAccount=!0,e.workspaces.length>0&&(this.pumbleSettings.isPumbleAdmin=!0,e.workspaces.forEach(e=>{this.pumbleSettings.pumbleWorkspaces.push(new Ph(e.id,e.name))}))),this.openModal(this.connectionModals),this.cd.detectChanges()},e=>{this.toaster.pop("error",this.translateService.instant("WORKSPACE.INTEGRATION.PUMBLE.NETWORK_CONNECTION_ERROR"))})})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(s.h),s.Rb(re.a),s.Rb(w.q),s.Rb(Gu.a),s.Rb(g.f),s.Rb(a.d))},e.\u0275cmp=s.Lb({type:e,selectors:[["chat-widget"]],viewQuery:function(e,t){var n;1&e&&(s.gd(aG,!0),s.gd(oG,!0),s.gd(rG,!0)),2&e&&(s.Kc(n=s.kc())&&(t.adminPopover=n.first),s.Kc(n=s.kc())&&(t.connectionModals=n.first),s.Kc(n=s.kc())&&(t.emailNotVerifiedModal=n.first))},inputs:{workspaceId:"workspaceId"},decls:5,vars:1,consts:[[4,"ngIf"],["emailNotVerifiedModal",""],["emailVerifiedConnectionModals",""],["class","floating-chat-button","placement","top-right","popoverClass","pumble-popover-class",3,"ngbPopover","autoClose","closeDelay","click",4,"ngIf"],["placement","top-right","popoverClass","pumble-popover-class",1,"floating-chat-button",3,"ngbPopover","autoClose","closeDelay","click"],["p","ngbPopover"],["src","assets/integrations/chat-icon.svg",1,"pointer","cl-margin-right","cl-margin-left"],[1,"cl-margin-right-sm"],["class","floating-chat-button cl-padding-right","placement","top-right","popoverClass","pumble-popover-class","triggers","manual",3,"ngbPopover","autoClose","click",4,"ngIf"],["placement","top-right","popoverClass","pumble-popover-class","triggers","manual",1,"floating-chat-button","cl-padding-right",3,"ngbPopover","autoClose","click"],["admin","ngbPopover"],[1,"pumble-widget-container",3,"ngClass"],[1,"pumble-widget","cl-d-flex","cl-flex-column"],[1,"pumble-widget__main-container","cl-d-flex","cl-flex-column","cl-bg-white"],[1,"pumble-widget__header-container","cl-d-flex","cl-justify-content-between","cl-align-items-center"],[1,"pumble-widget__header-side","pumble-widget__header-side--left"],["src","assets/integrations/search-light.svg"],[1,"pumble-widget__header-center"],["href","https://pumble.com","target","_blank"],["src","assets/integrations/pumble-logo.svg",3,"click"],[1,"pumble-widget__header-side","pumble-widget","__header-side","--right","pointer"],["src","assets/integrations/times-light.svg",1,"hover-icon",3,"click"],[1,"pumble-contacts-container","cl-position-relative"],[1,"pumble-connect-popup","cl-position-absolute","cl-bg-white","cl-text-center","cl-d-flex","cl-flex-column","cl-justify-content-center"],[1,"cl-mb-3"],["width","67","height","31","viewBox","0 0 67 31","fill","none","xmlns","http://www.w3.org/2000/svg",1,"cl-mb-3","cl-mx-auto"],["fill-rule","evenodd","clip-rule","evenodd","d","M55.8798 28.9043C45.9237 25.0824 25.4395 25.5518 11.0603 27.2448C9.05895 27.4795 8.01625 30.2452 9.74848 30.8319C20.9492 27.2783 43.8887 27.3118 51.9613 28.9713C54.2149 29.3568 55.4762 29.625 55.8798 28.9043ZM45.9573 15.4441C46.815 15.6117 47.7232 15.4776 48.6482 15.1256L48.9845 15.2262L47.9418 15.595L48.665 15.7794L47.6559 16.1146L48.3455 16.3325L47.5382 16.6175C47.3364 16.718 47.1346 16.8186 46.9328 16.8857C47.6055 19.7855 43.2833 24.2611 40.1552 24.1437C39.1461 24.0935 38.2716 22.6016 38.2548 22.1658C38.0025 21.3277 37.9689 20.1376 38.507 18.4949C39.0788 16.7683 39.9029 14.9412 40.8783 13.1309C37.1952 13.6673 32.9739 13.4494 30.1485 12.3095C28.3995 11.1529 28.2649 8.95708 29.3749 8.67212C32.2003 11.3876 37.397 12.3263 41.551 11.9408C42.8628 9.62757 44.3596 7.39818 45.7387 5.55433C46.1255 5.48728 46.63 5.68842 47.0673 6.02367L47.1009 6.0572C47.3196 6.22482 47.5046 6.42597 47.6559 6.64388C49.7582 9.12471 47.9923 11.0691 44.7464 12.209C42.4929 15.8296 40.4074 19.7353 39.9702 22.2161C41.9715 21.7635 44.5614 19.3833 45.1669 17.3047C44.7969 17.288 44.5278 17.1706 44.3596 17.003C43.9224 16.5672 43.8887 15.2765 44.696 14.9748C44.7128 14.9077 44.8473 14.8574 44.9482 14.9077C45.3351 15.0586 45.6882 15.2262 45.9573 15.4441ZM45.4528 11.0356C47.1682 10.3148 48.11 9.20852 47.6223 7.81724C46.9328 8.80622 46.1928 9.89577 45.4528 11.0356ZM57.343 7.38142C57.3262 7.29761 57.3093 7.2138 57.2757 7.12999C57.2589 6.86179 57.1916 6.76122 57.1075 6.76122C56.6534 6.00691 55.7117 5.43699 55.0894 5.53757C52.3817 9.14147 49.2873 14.1702 47.8577 18.5116C46.6805 22.1323 48.2277 23.6074 48.9173 23.7247C49.0518 23.8253 49.22 23.8923 49.3882 23.9091C50.0441 23.0877 51.7931 20.3219 53.3235 19.1151C53.4917 18.981 53.5926 18.8301 53.6262 18.6792L53.1554 18.8469L53.5926 18.3105C53.5758 18.2937 53.5758 18.2769 53.559 18.2769C52.4322 18.9139 50.8345 20.0537 49.5564 21.1936C50.5991 17.7573 53.7271 12.5777 56.418 8.68889C56.2835 10.4657 55.4762 11.857 54.2989 12.8627H54.3326L54.0131 13.0974C53.9458 13.1477 53.8617 13.2147 53.7776 13.265L53.5085 13.4662L54.1139 13.4829L53.3067 14.0696H53.929L53.0881 14.7066L53.6767 14.7233C55.7117 13.4159 57.0907 11.22 57.2757 7.482L57.343 7.38142ZM14.4575 16.8186C13.768 17.64 13.1793 19.2659 12.9271 20.7745C14.592 19.6682 15.9206 18.1261 17.2324 15.9805C17.4342 15.5447 17.6192 15.1424 17.7874 14.8239C18.6115 14.7568 20.1251 16.2822 20.1251 16.8019C19.4188 17.6232 18.847 19.2659 18.5947 20.7745C19.0992 20.3219 19.6542 19.8694 20.2092 19.4503L20.7474 19.2659L20.0578 20.1376L20.7474 19.8694L20.0747 20.6907L20.4951 20.5399C19.6542 21.5959 18.9142 22.719 18.5442 23.1883L18.5274 23.2051C18.4265 23.2051 18.3424 23.1715 18.2583 23.138C17.2829 22.8531 16.072 21.6294 16.0047 21.1098C15.9711 20.8416 15.9543 20.5566 15.9879 20.2717C14.8779 21.4618 13.768 22.5513 12.8766 23.1548V23.1883H12.8093C11.8003 23.0374 10.4212 21.6629 10.3539 21.1098C10.0848 19.1821 11.4303 16.2487 12.1366 14.8239C12.9439 14.7736 14.4743 16.299 14.4575 16.8186ZM37.4139 19.4838C36.8589 19.9029 36.2871 20.3555 35.7993 20.8081C36.0516 19.2827 36.6402 17.64 37.3298 16.8186C37.3298 16.299 35.8162 14.7736 34.9921 14.8407L34.908 14.9915H34.8912C32.9403 16.4498 31.1072 18.5619 29.7281 20.2884C30.014 18.9307 30.5522 17.5394 31.1744 16.8019C31.1744 16.2822 29.6608 14.7568 28.8368 14.8239L28.7527 14.9748H28.7358C26.8186 16.4163 25.0191 18.4781 23.64 20.1878C23.9259 18.8469 24.4473 17.5059 25.0696 16.7851C25.0696 16.2655 23.5559 14.7401 22.7319 14.8071C22.0255 16.2319 20.6801 19.1486 20.9492 21.093C21.0165 21.6462 22.3619 22.9704 23.3541 23.1548L23.3878 23.1715C23.4214 23.1715 23.455 23.1883 23.4887 23.1883C23.4887 23.1548 23.4719 23.1213 23.4719 23.071C24.565 21.7635 25.7759 20.2381 27.2222 19.0312C27.0541 19.7688 26.97 20.4896 27.0541 21.093C27.1382 21.6629 28.5845 23.0877 29.5936 23.1883L29.5767 23.1212C30.6867 21.797 31.9144 20.2549 33.3776 19.0312C33.2094 19.7688 33.1253 20.4896 33.2094 21.093C33.2767 21.6126 34.5044 22.8698 35.4966 23.138C35.5807 23.1715 35.6648 23.1883 35.7489 23.1883C36.1189 22.719 36.8589 21.5791 37.7166 20.5231L37.2961 20.674L37.9688 19.8526L37.2793 20.1208L37.9688 19.2492L37.4139 19.4838ZM59.5629 13.8684C59.9329 16.0308 58.9239 17.4556 56.9562 17.7741C57.6457 16.366 58.5707 15.025 59.5629 13.8684ZM56.7712 18.1764C56.1825 19.4838 55.8294 20.8248 55.8294 22.1155C60.0002 22.2328 64.6251 17.6567 64.8101 12.5442C65.1969 11.7899 66.021 14.0864 66.0882 14.4719C66.2228 15.1256 66.2396 15.8296 66.1051 16.4834C65.2642 20.1208 60.4879 24.5293 56.5525 24.0935C56.4685 24.0767 56.3003 24.0096 56.0985 23.8755V23.9091C50.9186 21.1936 55.123 14.7066 58.4866 11.1697C58.5034 11.1697 58.5202 11.1529 58.537 11.1529L58.5202 11.1194C58.5875 11.1194 58.6548 11.1194 58.7388 11.1362C59.1929 11.1529 59.7311 11.4714 60.1516 11.857C61.0429 12.4939 61.8838 13.3991 61.8838 13.9187C62.3715 17.355 60.1011 19.4 56.7712 18.1764Z","fill","#673AB7"],["d","M10.0319 9.59909C13.6092 9.94077 21.8075 9.14112 23.4292 5.82205C21.3428 2.00914 8.60732 2.5675 3.52443 5.24009C0.756201 6.67974 1.13954 8.50295 3.55184 10.1778C1.44705 10.5303 -2.51991 6.5682 2.25847 3.11674C8.51203 -1.40028 25.5841 -1.51094 24.5588 6.14843C23.9622 10.6074 17.5453 12.2028 10.3774 11.9861C9.65637 16.2559 6.30019 22.274 2.45923 23.7702L3.05156 22.9901L2.38647 23.169L3.01474 22.4533L2.38647 22.6967C5.52779 18.6712 6.51506 15.8981 6.30334 9.00471C6.30334 9.00471 8.04667 9.40947 10.0319 9.59909Z","fill","#673AB7"],[1,"enable-chat-btn","cl-mb-3","cl-no-focus",3,"click"],[1,"hide-chat-btn","cl-no-focus",3,"click"],[1,"contact-row-wrapper"],["class","cl-d-flex cl-flex-column",4,"ngFor","ngForOf"],["classname","enable-chat-popup"],[1,"cl-d-flex","cl-flex-column"],[1,"cl-d-flex","cl-align-items-center","contact-row"],[1,"contact-image",3,"classSize","src","name"],[1,"contact-name","cl-pl-2"],[3,"close"],[3,"workspaceId","integration","connected","pumbleSettings","close"]],template:function(e,t){1&e&&(s.Xc(0,gG,3,2,"div",0),s.Xc(1,EG,1,0,"ng-template",null,1,s.Yc),s.Xc(3,fG,1,4,"ng-template",null,2,s.Yc)),2&e&&s.wc("ngIf",!t.isConnected&&t.isChatEnabled&&!t.isSelfHosted)},directives:[i.u,w.M,i.r,i.t,Pc.a,Uu,Qu],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();const CG=function(e){return{userName:e}};function AG(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",4),s.Xb(1,"div",5),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"a",6),s.jc("click",(function(){return s.Oc(e),s.nc().switchBack()})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.bd(" ",s.qc(3,2,"LAYOUT.DEFAULT_LAYOUT.LOGGED_IN_USER_NOTIFICATION",s.Bc(7,CG,e.loggedInAsUsername))," "),s.Cb(3),s.ad(s.pc(6,5,"LAYOUT.DEFAULT_LAYOUT.LOG_OUT_BTN"))}}let OG=(()=>{class e{constructor(e,t,n,i,s,c,o,r,l,b){this.router=e,this.browserService=t,this.navigationService=n,this.viewportScroller=i,this.authService=s,this.cd=c,this.syncService=o,this.sidebarStateService=r,this.originalOwnerService=l,this.sidebarScrollService=b,this.unsubscribe$=new p.a,this.toasterConfig=new a.a({positionClass:"toast-bottom-right",showCloseButton:!0,iconClasses:{success:"cl2-d-lg-none",error:"d-lg-none",warning:"d-lg-none"}})}ngOnInit(){this.syncService.start(),this.browserService.isBreakpointLg$.pipe(Object(Lh.a)(),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{const t=this.isDesktop&&!e;this.isDesktop=e,t&&this.sidebarStateService.setSidebar(!1),this.setBodyScroll(),this.calculateHeight()}),this.browserService.onHeightResize$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.calculateHeight()}),this.navigationService.currentRoute.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>this.viewportScroller.scrollToPosition([0,0])),this.checkLoggedInUser(),this.subscribeToSidebarState(),this.sidebarScrollService.addScrollListener()}ngOnDestroy(){this.sidebarScrollService.removeScrollListener(),this.sidebarScrollService.enableBodyScroll(),this.syncService.stop(),this.unsubscribe$.next(!0),this.unsubscribe$.complete()}checkLoggedInUser(){this.originalOwnerService.getOwner()&&(this.loggedInAsUsername=this.authService.getUser().name)}subscribeToSidebarState(){this.sidebarStateService.sidebarState$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isSidebarOpen=e,this.cd.markForCheck(),this.setBodyScroll()})}switchBack(){this.authService.switchBackToAccount()}setBodyScroll(){this.isSidebarOpen&&!this.isDesktop?this.sidebarScrollService.disableBodyScroll():this.sidebarScrollService.enableBodyScroll()}calculateHeight(){if(!this.isDesktop)return void(this.minHeight="100vh");const e=window.innerHeight;this.minHeight=e<750?"750px":"100vh"}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.d),s.Rb(Gn.a),s.Rb(ao.a),s.Rb(i.J),s.Rb(re.a),s.Rb(s.h),s.Rb(MA.a),s.Rb(FA.a),s.Rb(DM.a),s.Rb(xA))},e.\u0275cmp=s.Lb({type:e,selectors:[["default-layout"]],decls:7,vars:6,consts:[[1,"cl-main-wrapper"],["id","layout-main",1,"cl-layout-main"],["class","cl-fixed-bottom",4,"ngIf"],[3,"toasterconfig"],[1,"cl-fixed-bottom"],[1,"cl-alert","cl-alert-info","cl-mb-0"],[1,"cl-btn",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Sb(1,"sidebar-and-topbar"),s.Xb(2,"main",1),s.Xc(3,AG,7,9,"div",2),s.Sb(4,"router-outlet"),s.Wb(),s.Wb(),s.Sb(5,"chat-widget"),s.Sb(6,"toaster-container",3)),2&e&&(s.Cb(2),s.Wc("min-height",t.minHeight),s.Hb("cl-sidebar-layout-open",!t.isSidebarOpen),s.Cb(1),s.wc("ngIf",t.loggedInAsUsername),s.Cb(3),s.wc("toasterconfig",t.toasterConfig))},directives:[cG,i.u,k.i,SG,a.b],pipes:[g.e],encapsulation:2}),e})();function vG(e,t){1&e&&s.Tb(0)}function TG(e,t){if(1&e&&(s.Xb(0,"a",12),s.Zc(1),s.Wb()),2&e){const e=s.nc(2);s.zc("routerLink","/workspaces/",e.webhook.workspaceId,"/webhooks/",e.webhook.id,""),s.Cb(1),s.bd(" ",e.webhook.name," ")}}function IG(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"span",13),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"span",14),s.Zc(5),s.Wb(),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngbTooltip","Only workspace admins can have active webhooks."),s.Cb(1),s.bd(" ",s.pc(3,3,"GLOBAL.INACTIVE_LABEL")," "),s.Cb(3),s.bd(" ",e.webhook.name," ")}}function wG(e,t){if(1&e&&(s.Xb(0,"div",8),s.Xb(1,"div",9),s.Xc(2,TG,2,3,"a",10),s.Xc(3,IG,6,5,"ng-container",11),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.wc("ngIf",e.webhook.enabled),s.Cb(1),s.wc("ngIf",!e.webhook.enabled)}}function LG(e,t){if(1&e&&(s.Xb(0,"div",15),s.Xb(1,"div",16),s.Xb(2,"div",9),s.Zc(3),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(3),s.ad(e.webhook.webhookEventLabel)}}function RG(e,t){if(1&e&&(s.Xb(0,"div",15),s.Xb(1,"div",16),s.Xb(2,"div",9),s.Zc(3),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(3),s.ad(e.webhook.url)}}function yG(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",17),s.Xb(1,"div",15),s.Xb(2,"div",18),s.Sb(3,"input",19),s.Xb(4,"div",20),s.Xb(5,"button",21),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.authInputType="password"==t.authInputType?"text":"password"})),s.Sb(6,"img",22),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.xc("type",e.authInputType),s.xc("value",e.webhook.authToken)}}function _G(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"a",31),s.jc("click",(function(){return s.Oc(e),s.nc(3).emitEdit()})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Sb(4,"div",32),s.Ub()}2&e&&(s.Cb(2),s.ad(s.pc(3,1,"GLOBAL.EDIT_LABEL")))}function kG(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",28),s.Xb(1,"div",29),s.Xc(2,_G,5,3,"ng-container",11),s.Xb(3,"a",30),s.jc("click",(function(){return s.Oc(e),s.nc(2).emitDelete()})),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.wc("ngIf",e.webhook.enabled),s.Cb(2),s.ad(s.pc(5,2,"GLOBAL.DELETE_BTN"))}}function WG(e,t){1&e&&(s.Xb(0,"div",23),s.Xb(1,"div",24),s.Xb(2,"div",25),s.Sb(3,"img",26),s.Wb(),s.Xc(4,kG,6,4,"div",27),s.Wb(),s.Wb())}const XG=function(){return["Name","Event","URL","Siging secret",""]},NG=function(e){return{labels:e}},DG=function(e,t,n,i,s){return[e,t,n,i,s]};let PG=(()=>{class e{constructor(e){this.cd=e,this.authInputType="password",this.edit=new s.n,this.delete=new s.n}ngAfterViewInit(){this.cd.detectChanges()}emitEdit(){this.edit.emit()}emitDelete(){this.delete.emit()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["webhook-row"],["","webhook-row",""]],inputs:{webhook:"webhook",isDesktop:"isDesktop"},outputs:{edit:"edit",delete:"delete"},decls:13,vars:14,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cl-d-none",3,"isDesktop","isExpanded","templates"],["responsive",""],["col1",""],["col2",""],["col3",""],["col4",""],["col5",""],[1,"cl-py-0","cl-py-lg-custom-2","cl-pl-lg-2","cl-pl-lg-custom-0","cl-pr-2","cl-cut-text-wrapper","cl-responsive-table-main-item"],[1,"cl-cut-text"],["class","cl-text-dark",3,"routerLink",4,"ngIf"],[4,"ngIf"],[1,"cl-text-dark",3,"routerLink"],[1,"cl-badge","cl-badge-danger","cl-cursor-default","cl-no-hover","cl-mr-2",3,"ngbTooltip"],[1,"cl-text-dark"],[1,"cl-component-divided-left","cl-w-100"],[1,"cl-cut-text-wrapper"],[1,"cl-p-0","cl-lh-0"],[1,"cl-input-group","cl-input-group-sm"],["readonly","",1,"cl-form-control","tr-reset-min-h",3,"type","value"],[1,"cl-input-group-append"],["type","button",1,"cl-btn","cl-btn-outline-light",3,"click"],["src","assets/images/ui-icons/eye.svg"],[1,"cl-p-0"],["dropdownKey","",1,"cl-dropdown","cl-d-flex","cl-justify-content-end"],["role","button","dropdownKeyButton","",1,"cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow","pointer"],["src","assets/images/ui-icons/menu-dots-vertical.svg"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownKeyContent"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-scroll-area","cl-text-capitalize"],["clickCloseDropdown","",1,"cl-dropdown-item","cl-text-danger",3,"click"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"click"],[1,"cl-dropdown-divider"]],template:function(e,t){if(1&e&&(s.Xc(0,vG,1,0,"ng-container",0),s.Sb(1,"responsive-row",1,2),s.Xc(3,wG,4,2,"ng-template",null,3,s.Yc),s.Xc(5,LG,4,1,"ng-template",null,4,s.Yc),s.Xc(7,RG,4,1,"ng-template",null,5,s.Yc),s.Xc(9,yG,7,2,"ng-template",null,6,s.Yc),s.Xc(11,WG,5,0,"ng-template",null,7,s.Yc)),2&e){const e=s.Lc(2),n=s.Lc(4),i=s.Lc(6),c=s.Lc(8),a=s.Lc(10),o=s.Lc(12);s.wc("ngTemplateOutlet",e.template)("ngTemplateOutletContext",s.Bc(6,NG,s.Ac(5,XG))),s.Cb(1),s.wc("isDesktop",t.isDesktop)("isExpanded",!1)("templates",s.Fc(8,DG,n,i,c,a,o))}},directives:[i.B,Ei.a,i.u,k.g,w.bb,ni.a,ii.a,si.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();class MG{constructor(e,t,n,i,s=[]){this.name=e,this.url=t,this.webhookEvent=n,this.triggerSourceType=i,this.triggerSource=s}}function BG(e,t){if(1&e&&(s.Xb(0,"label"),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.ad(e.title)}}function UG(e,t){if(1&e&&(s.Xb(0,"div",11),s.Zc(1),s.Wb()),2&e){const e=s.nc().$implicit;s.Cb(1),s.bd(" ",e.label," ")}}function GG(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",12),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc(3).setSelected(n.entity)})),s.Zc(1),s.Wb()}if(2&e){const e=t.$implicit;s.Cb(1),s.bd(" ",(null==e.entity?null:e.entity.label)||e.entity," ")}}const xG=function(e){return{"cl-dropdown-section":e}};function FG(e,t){if(1&e&&(s.Xb(0,"div",7),s.Xb(1,"div",8),s.Xc(2,UG,2,1,"div",9),s.Xc(3,GG,2,1,"a",10),s.Wb(),s.Wb()),2&e){const e=t.$implicit;s.Cb(1),s.wc("ngClass",s.Bc(3,xG,!e.hideTitle)),s.Cb(1),s.wc("ngIf",!e.hideTitle),s.Cb(1),s.wc("ngForOf",e.value)}}function jG(e,t){if(1&e&&(s.Xb(0,"div",4),s.Xb(1,"div",5),s.Xc(2,FG,4,5,"div",6),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Hb("cl-dropdown-menu-right",e.positionRight),s.Cb(2),s.wc("ngForOf",null==e.groupsOfSelectables?null:e.groupsOfSelectables.maps)}}var ZG=function(e){return e.STANDARD="STANDARD",e.SMALL="SMALL",e.TEXT="TEXT",e.DROPDOWN="DROPDOWN",e}({});let VG=(()=>{class e{constructor(e){this.cd=e,this.type=ZG.STANDARD,this.isDisabled=!1,this.configClasses={[ZG.STANDARD]:"cl-btn cl-btn-outline-light cl-w-100 cl-text-left cl-dropdown-toggle cl-cut-text pointer",[ZG.SMALL]:"cl-btn cl-btn-sm cl-btn-outline-light cl-dropdown-toggle pointer",[ZG.TEXT]:"cl-dropdown-link-text",[ZG.DROPDOWN]:"cl-w-100 cl-text-left pointer cl-dropdown-toggle cl-cut-text"},this.onChange=()=>{},this.onTouched=()=>{}}set groupsOfSelectables(e){this._groupsOfSelectables=e}get groupsOfSelectables(){return this._groupsOfSelectables}set value(e){this._value=e,this.onChange(e),this.onTouched()}get value(){return this._value}ngOnInit(){this.selectedLabel=this.value?this.value.label:this.initLabel,this.classes=this.configClasses[this.type]||""}setSelected(e){this.value=e.id,this.selectedLabel=e.label}writeValue(e){e&&(this.value=e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["dropdown-item-groups"]],inputs:{groupsOfSelectables:"groupsOfSelectables",value:"value",initLabel:"initLabel",type:"type",title:"title",isDisabled:"isDisabled"},features:[s.Bb([{provide:v.q,useExisting:Object(s.U)(()=>e),multi:!0}])],decls:5,vars:4,consts:[[4,"ngIf"],[1,"cl-dropdown",3,"dropdownKey"],["tabindex","0","dropdownKeyButton","",3,"ngClass","click"],["class","cl-dropdown-menu","openUpAtBottom","",3,"cl-dropdown-menu-right",4,"dropdownKeyContent"],["openUpAtBottom","",1,"cl-dropdown-menu"],[1,"cl-scroll-area"],["class","cl-dropdown-section-wrapper",4,"ngFor","ngForOf"],[1,"cl-dropdown-section-wrapper"],[3,"ngClass"],["class","cl-dropdown-header cl-h5",4,"ngIf"],["class","cl-dropdown-item cl-cut-text","clickCloseDropdown","",3,"click",4,"ngFor","ngForOf"],[1,"cl-dropdown-header","cl-h5"],["clickCloseDropdown","",1,"cl-dropdown-item","cl-cut-text",3,"click"]],template:function(e,t){1&e&&(s.Xc(0,BG,2,1,"label",0),s.Xb(1,"div",1),s.Xb(2,"span",2),s.jc("click",(function(){return t.onTouched()})),s.Zc(3),s.Wb(),s.Xc(4,jG,3,3,"div",3),s.Wb()),2&e&&(s.wc("ngIf",t.title),s.Cb(1),s.wc("dropdownKey",t.isDisabled),s.Cb(1),s.wc("ngClass",t.classes),s.Cb(1),s.ad(t.selectedLabel))},directives:[i.u,ni.a,ii.a,i.r,si.a,i.t],encapsulation:2,changeDetection:0}),e})();function YG(e,t){1&e&&(s.Xb(0,"small",18),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WEBHOOKS.CREATE.NAME.ERROR_MESSAGE")," "))}function HG(e,t){1&e&&(s.Xb(0,"small",18),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WEBHOOKS.CREATE.ENDPONT.ERROR_MESSAGE")," "))}function $G(e,t){1&e&&(s.Xb(0,"small",18),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WEBHOOKS.CREATE.EVENT.ERROR_MESSAGE")," "))}function KG(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",7),s.Xb(1,"div",19),s.Xb(2,"label"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xb(5,"a",20),s.jc("click",(function(){return s.Oc(e),s.nc().generateNewToken()})),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xb(8,"div",21),s.Sb(9,"input",22),s.Xb(10,"div",23),s.Xb(11,"button",24),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.tokenFieldType="password"==t.tokenFieldType?"text":"password"})),s.Sb(12,"img",25),s.Wb(),s.Wb(),s.Wb(),s.Xb(13,"small",26),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.ad(s.pc(4,6,"WEBHOOKS.EDIT.SIGNING_SECRET.TITLE")),s.Cb(3),s.ad(s.pc(7,8,"WEBHOOKS.EDIT.SIGNING_SECRET.RESET")),s.Cb(3),s.xc("type",e.tokenFieldType),s.xc("value",null==e.webhook?null:e.webhook.authToken),s.Cb(4),s.wc("hidden",!e.signingCopyVisible),s.Cb(1),s.ad(s.pc(15,10,"WEBHOOKS.EDIT.SIGNING_SECRET.INFO_MESSAGE"))}}let qG=(()=>{class e{constructor(e,t,n,i){this.webhookService=e,this.dropdownCheckboxParamBuilder=t,this.translateService=n,this.analyticsService=i,this.close=new s.n,this.signingSecretChanged=new s.n,this.tokenFieldType="password",this.signingCopyVisible=!1,this.waitingForResponse=!1,this.unsubscribe$=new p.a}get name(){return this.webhookForm.get("name")}get url(){return this.webhookForm.get("url")}get event(){return this.webhookForm.get("event")}ngOnInit(){this.webhookEvents=this.getSelectableMapOfEvents(),this.webhookForm=new v.j({name:new v.g(this.webhook&&this.webhook.name||"",[Bi.a.required,Bi.a.maxLength(30),Bi.a.minLength(2)]),url:new v.g(this.webhook&&this.webhook.url||"",[Bi.a.required]),event:new v.g(this.webhook&&{event:this.webhook.webhookEvent,triggerSourceType:this.webhook.triggerSourceType}||"",v.G.required)}),this.webhookForm.get("event").valueChanges.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>this.onEventChanged(e))}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}closeModalWindow(){this.close.emit(!1)}createOrModifyWebhook(){this.waitingForResponse=!0;const e=this.webhookForm.value,t=new MG(e.name.trim(),e.url.trim(),e.event.event,e.event.triggerSourceType);this.webhook?this.webhookService.update(this.workspace.id,this.webhook.id,t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>this.close.emit(e)):this.webhookService.create(this.workspace.id,t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{var n;this.analyticsService.addEvent(new Fi.a({event:"submit",value:"name",section:"Profile settings",section2:"Webhooks",section4:"Webhooks"})),this.analyticsService.addEvent(new Fi.a({event:"select",value:null===(n=null==e?void 0:e.event)||void 0===n?void 0:n.event,section:"Profile settings",section2:"Webhooks",section3:"Event",section4:"Webhooks"})),this.close.emit(t)}),this.waitingForResponse=!1}getSelectableMapOfEvents(){return new Tn.a([{webhookEvent:fn.NEW_TIMER_STARTED,triggerSourceType:An.USER_ID},{webhookEvent:fn.NEW_TIMER_STARTED,triggerSourceType:An.WORKSPACE_ID},{webhookEvent:fn.TIMER_STOPPED,triggerSourceType:An.USER_ID},{webhookEvent:fn.TIMER_STOPPED,triggerSourceType:An.WORKSPACE_ID},{webhookEvent:fn.NEW_TIME_ENTRY,triggerSourceType:An.USER_ID},{webhookEvent:fn.NEW_TIME_ENTRY,triggerSourceType:An.WORKSPACE_ID},{webhookEvent:fn.TIME_ENTRY_UPDATED,triggerSourceType:An.USER_ID},{webhookEvent:fn.TIME_ENTRY_UPDATED,triggerSourceType:An.WORKSPACE_ID},{webhookEvent:fn.TIME_ENTRY_DELETED,triggerSourceType:An.USER_ID},{webhookEvent:fn.TIME_ENTRY_DELETED,triggerSourceType:An.WORKSPACE_ID},{webhookEvent:fn.NEW_CLIENT,triggerSourceType:An.WORKSPACE_ID},{webhookEvent:fn.NEW_PROJECT,triggerSourceType:An.WORKSPACE_ID},{webhookEvent:fn.NEW_TASK,triggerSourceType:An.WORKSPACE_ID},{webhookEvent:fn.NEW_TAG,triggerSourceType:An.WORKSPACE_ID},{webhookEvent:fn.NEW_INVOICE,triggerSourceType:An.WORKSPACE_ID},{webhookEvent:fn.INVOICE_UPDATED,triggerSourceType:An.WORKSPACE_ID},{webhookEvent:fn.NEW_APPROVAL_REQUEST,triggerSourceType:An.USER_ID},{webhookEvent:fn.NEW_APPROVAL_REQUEST,triggerSourceType:An.WORKSPACE_ID},{webhookEvent:fn.APPROVAL_REQUEST_STATUS_UPDATED,triggerSourceType:An.USER_ID},{webhookEvent:fn.APPROVAL_REQUEST_STATUS_UPDATED,triggerSourceType:An.WORKSPACE_ID}].map(({webhookEvent:e,triggerSourceType:t})=>{const n={id:{event:e,triggerSourceType:t},label:this.webhookService.generateWebhooksLabel(e,t)};return new mg.a(n.label,[n],{hideTitle:!0})}))}onEventChanged(e){}generateNewToken(){this.webhookService.generateNewToken(this.workspace.id,this.webhook.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.webhook=e,this.signingCopyVisible=!0,this.signingSecretChanged.emit({id:this.webhook.id,authToken:this.webhook.authToken}),setTimeout(()=>this.signingCopyVisible=!1,2e3)})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(On),s.Rb(Nn),s.Rb(g.f),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["new-webhook"]],inputs:{workspace:"workspace",webhook:"webhook",isAdminOrOwner:"isAdminOrOwner"},outputs:{close:"close",signingSecretChanged:"signingSecretChanged"},decls:39,vars:36,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[3,"formGroup","ngSubmit"],[1,"cl-modal-body"],[1,"cl-form-group"],["for","name"],["formControlName","name","id","name","name","name","type","text","ngbAutofocus","","autocomplete","off",1,"cl-form-control",3,"placeholder"],["class","cl-form-text cl-text-danger",4,"ngIf"],["for","url"],["formControlName","url","id","url","name","url","type","url","placeholder","https://example.com/endpoint","autocomplete","off",1,"cl-form-control"],["formControlName","event",3,"groupsOfSelectables","initLabel"],["class","cl-form-group",4,"ngIf"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"],[1,"cl-form-text","cl-text-danger"],[1,"cl-d-flex","cl-justify-content-between"],[1,"cl-small",3,"click"],[1,"cl-input-group"],["readonly","",1,"cl-form-control",3,"type","value"],[1,"cl-input-group-append"],["type","button",1,"cl-btn","cl-btn-outline-light",3,"click"],["src","assets/images/ui-icons/eye.svg"],[1,"cl-form-text","cl-text-success",3,"hidden"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.oc(4,"translate"),s.Wb(),s.Xb(5,"button",2),s.jc("click",(function(){return t.closeModalWindow()})),s.Xb(6,"span",3),s.Sb(7,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(8,"form",5),s.jc("ngSubmit",(function(){return t.createOrModifyWebhook()})),s.Xb(9,"div",6),s.Xb(10,"div",7),s.Xb(11,"label",8),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Sb(14,"input",9),s.oc(15,"translate"),s.Xc(16,YG,3,3,"small",10),s.Wb(),s.Xb(17,"div",7),s.Xb(18,"label",11),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Sb(21,"input",12),s.Xc(22,HG,3,3,"small",10),s.Wb(),s.Xb(23,"div",7),s.Xb(24,"label"),s.Zc(25),s.oc(26,"translate"),s.Wb(),s.Sb(27,"dropdown-item-groups",13),s.oc(28,"translate"),s.Xc(29,$G,3,3,"small",10),s.Wb(),s.Xc(30,KG,16,12,"div",14),s.Wb(),s.Xb(31,"div",15),s.Xb(32,"a",16),s.jc("click",(function(){return t.closeModalWindow()})),s.Zc(33),s.oc(34,"translate"),s.Wb(),s.Xb(35,"button",17),s.Zc(36),s.oc(37,"translate"),s.oc(38,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.cd("",t.webhook?s.pc(3,16,"WEBHOOKS.EDIT.TITLE"):s.pc(4,18,"WEBHOOKS.CREATE.TITLE")," ",t.workspace.name,""),s.Cb(6),s.wc("formGroup",t.webhookForm),s.Cb(4),s.ad(s.pc(13,20,"GLOBAL.NAME_LABEL")),s.Cb(2),s.xc("placeholder",s.pc(15,22,"WEBHOOKS.CREATE.NAME.PLACEHOLDER")),s.Cb(2),s.wc("ngIf",t.name.invalid&&(t.name.dirty||t.name.touched)),s.Cb(3),s.ad(s.pc(20,24,"WEBHOOKS.CREATE.ENDPONT.TITLE")),s.Cb(3),s.wc("ngIf",t.url.invalid&&(t.url.dirty||t.url.touched)),s.Cb(3),s.ad(s.pc(26,26,"WEBHOOKS.CREATE.EVENT.TITLE")),s.Cb(2),s.wc("groupsOfSelectables",t.webhookEvents)("initLabel",(null==t.webhook?null:t.webhook.webhookEventLabel)||s.pc(28,28,"WEBHOOKS.CREATE.EVENT.SELECT")),s.Cb(2),s.wc("ngIf",t.event.invalid&&(t.event.dirty||t.event.touched)),s.Cb(1),s.wc("ngIf",t.webhook),s.Cb(3),s.ad(s.pc(34,30,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",t.webhookForm.invalid||t.waitingForResponse),s.Cb(1),s.ad(t.webhook?s.pc(37,32,"GLOBAL.SAVE_LABEL"):s.pc(38,34,"GLOBAL.CREATE_LABEL")))},directives:[v.I,v.t,v.k,v.c,v.s,v.i,i.u,VG],pipes:[g.e],encapsulation:2}),e})();function zG(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",36),s.Xb(2,"tr",37),s.jc("edit",(function(){s.Oc(e);const n=t.$implicit,i=s.nc(),c=s.Lc(69);return i.openModal(c,n)}))("delete",(function(){s.Oc(e);const n=t.$implicit,i=s.nc(),c=s.Lc(71);return i.openModal(c,n)})),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=t.$implicit,n=s.nc();s.Cb(2),s.wc("isDesktop",n.isDesktop)("webhook",e)}}function QG(e,t){if(1&e){const e=s.Yb();s.Xb(0,"new-webhook",38),s.jc("signingSecretChanged",(function(t){return s.Oc(e),s.nc().updateSigningSecret(t)}))("close",(function(n){s.Oc(e);const i=t.$implicit,c=s.nc();return i.close(n),c.createOrModifyWebhookClosed(n)})),s.Wb()}if(2&e){const e=s.nc();s.wc("isAdminOrOwner",e.adminOrOwnerWorkspaces.has(e.selectedWorkspace.id))("workspace",e.selectedWorkspace)("webhook",e.selectedWebhook)}}const JG=function(e){return{value:e}};function ex(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",39),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().delete(n)}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"uppercase"),s.oc(3,"translate"),s.Xb(4,"p",40),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,5,"GLOBAL.DELETE_BTN"))("isDanger",!0)("btnText",s.pc(2,7,s.pc(3,9,"GLOBAL.DELETE_BTN")))("inProgress",e.isDeleting),s.Cb(5),s.bd(" ",s.qc(6,11,"WEBHOOKS.DELETE.CONFIRM",s.Bc(14,JG,e.selectedWebhook.name))," ")}}function tx(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"WEBHOOKS.CREATE.ERROR_MESSAGE")," "))}function nx(e,t){1&e&&(s.Zc(0),s.oc(1,"translate")),2&e&&s.bd(" ",s.pc(1,1,"WEBHOOKS.CREATE.LIMIT")," ")}function ix(e,t){if(1&e&&(s.Xc(0,tx,3,3,"ng-container",41),s.Xc(1,nx,2,3,"ng-template",null,42,s.Yc)),2&e){const e=s.Lc(2),t=s.nc();s.wc("ngIf",!t.adminOrOwnerWorkspaces.has(t.selectedWorkspace.id))("ngIfElse",e)}}const sx=function(){return["/user/settings"]},cx=function(e){return{"cl-disabled":e}};let ax=(()=>{class e{constructor(e,t,n,i,s,c){this.webhookService=e,this.workspaceService=t,this.modalService=n,this.browserService=i,this.subdomainService=s,this.cd=c,this.unsubscribe$=new Fn.a,this.webhooks=[],this.workspacesForDropdown=[],this.adminOrOwnerWorkspaces=new Set,this.isDesktop=!1,this.hiddenEvents=[fn.USER_ACTIVATED_ON_WORKSPACE,fn.USER_DEACTIVATED_ON_WORKSPACE,fn.USER_DELETED_FROM_WORKSPACE,fn.USER_EMAIL_CHANGED,fn.USER_JOINED_WORKSPACE,fn.USER_UPDATED]}ngOnInit(){this.subdomainService.isSubdomainNotSelfhosted()&&this.workspaceService.getPermissionsForUserOnWorkspaces([this.workspaceService.getDefaultWorkspaceId()]),this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.selectedWorkspace=e,this.getForWorkspace(this.selectedWorkspace.id)}),this.workspaceService.workspaces$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspaces=e,this.workspacesForDropdown=e.map(e=>new Un.a(e.id,e.name)),this.workspaceService.getPermissionsForUserOnWorkspaces(e.map(e=>e.id))}),this.workspaceService.workspacesPermissionsForUser.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{e.forEach(e=>{e.hasAdminPermission()&&this.adminOrOwnerWorkspaces.add(e.objectId)})}),this.browserService.isBreakpointLgCustom$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e,this.cd.detectChanges()})}get canCreate(){return!(!this.adminOrOwnerWorkspaces.has(this.selectedWorkspace.id)||this.webhooks.length>=10||this.workspaceWebhookCount>=100)}getForWorkspace(e){this.inProgress=!0,this.webhookService.getForWorkspace(e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(({webhooks:e,workspaceWebhookCount:t})=>{this.webhooks=e.filter(e=>!this.hiddenEvents.includes(e.webhookEvent)),this.workspaceWebhookCount=t,this.inProgress=!1,this.cd.detectChanges()},()=>this.inProgress=!1)}openModal(e,t){this.selectedWebhook=t,this.modalService.open(e,{centered:!0})}showAdminTooltip(e){e.open()}createOrModifyWebhookClosed(e){if(e){if(this.selectedWebhook){const t=this.webhooks.findIndex(t=>t.id==e.id);return this.webhooks[t]=e,this.cd.detectChanges(),void(this.selectedWebhook=void 0)}this.webhooks.unshift(e),this.workspaceWebhookCount=this.webhooks.length,this.cd.detectChanges()}}workspaceChange({value:e}){this.selectedWorkspace=this.workspaces.find(t=>t.id==e),this.getForWorkspace(this.selectedWorkspace.id)}delete(e){this.isDeleting=!0,this.webhookService.delete(this.selectedWorkspace.id,this.selectedWebhook.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{const n=this.webhooks.find(e=>e.id==this.selectedWebhook.id);this.webhooks.splice(this.webhooks.indexOf(n),1),this.workspaceWebhookCount=this.webhooks.length,e.close(),this.isDeleting=!1,this.cd.detectChanges()},()=>{this.isDeleting=!1,this.cd.detectChanges()})}updateSigningSecret(e){const t=this.webhooks.findIndex(t=>t.id==e.id);this.webhooks[t].authToken=e.authToken,this.cd.detectChanges()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(On),s.Rb(l.a),s.Rb(w.q),s.Rb(Gn.a),s.Rb(Lb.a),s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["webhooks"]],decls:74,vars:48,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-end"],[1,"cl-col-auto"],[1,"cl-breadcrumb","cl-p-0","cl-mb-2","cl-bg-transparent","cl-ml-0"],[1,"cl-breadcrumb-item"],[3,"routerLink"],[1,"cl-mb-2","cl-mb-lg-0"],[1,"cl-col"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end"],["triggers","manual","placement","left",1,"cl-btn","cl-btn-outline-primary",3,"ngClass","ngbPopover","click"],["createPopupPopover","ngbPopover"],[1,"cl-card"],[1,"cl-card-body"],[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-d-flex","cl-align-items-center"],[3,"list","placeholder","value","onChangedDropdown"],[1,"cl-pl-2"],[1,"cl-card","cl-border-bottom-0","cl-mb-0"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],[1,"cl-text-dark"],[1,"cl-d-inline-block","cl-mx-1"],["data-toggle-column","last",1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6"],[3,"hidden"],[1,"cl-pl-lg-3",2,"width","30%"],[1,"cl-h5","cl-mb-0"],[2,"width","20%"],[1,"cl-ml-lg-custom-n2"],[2,"width","46px"],[1,"cl-h5","cl-mb-0","cl-text-lg-custom-right","cl-d-block","cl-d-lg-custom-none"],[4,"ngFor","ngForOf"],["modalCreateOrModifyWebhook",""],["modalDeleteWebhook",""],["createPopupTemplate",""],[1,"cl-row-hover-shadow"],["webhook-row","",3,"isDesktop","webhook","edit","delete"],[3,"isAdminOrOwner","workspace","webhook","signingSecretChanged","close"],[3,"title","isDanger","btnText","inProgress","confirmed","close"],[1,"cl-cut-text-wrap"],[4,"ngIf","ngIfElse"],["limitTemplate",""]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"main",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"nav"),s.Xb(6,"ol",5),s.Xb(7,"li",6),s.Xb(8,"a",7),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(11,"h1",8),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Xb(14,"div",9),s.Xb(15,"div",10),s.Xb(16,"button",11,12),s.jc("click",(function(){s.Oc(e);const n=s.Lc(17),i=s.Lc(69);return!t.canCreate&&t.showAdminTooltip(n),t.canCreate&&t.openModal(i)})),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(20,"div",13),s.Xb(21,"div",14),s.Xb(22,"div",15),s.Xb(23,"div",16),s.Xb(24,"dropdown-items",17),s.jc("onChangedDropdown",(function(e){return t.workspaceChange(e)})),s.oc(25,"translate"),s.Wb(),s.Xb(26,"span",18),s.Zc(27),s.oc(28,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(29,"div",19),s.Xb(30,"div",20),s.Xb(31,"div",21),s.Xb(32,"span",22),s.Zc(33),s.oc(34,"translate"),s.Wb(),s.Xb(35,"span",23),s.Zc(36,"-"),s.Wb(),s.Xb(37,"span"),s.Zc(38),s.oc(39,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(40,"table",24),s.Xb(41,"thead",25),s.Xb(42,"tr"),s.Xb(43,"th",26),s.Xb(44,"div",27),s.Zc(45),s.oc(46,"translate"),s.Wb(),s.Wb(),s.Xb(47,"th",28),s.Xb(48,"div",29),s.Xb(49,"div",27),s.Zc(50),s.oc(51,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(52,"th",28),s.Xb(53,"div",29),s.Xb(54,"div",27),s.Zc(55),s.oc(56,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(57,"th"),s.Xb(58,"div",29),s.Xb(59,"div",27),s.Zc(60),s.oc(61,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(62,"th",30),s.Xb(63,"div",31),s.Zc(64),s.oc(65,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(66,"tbody"),s.Xc(67,zG,3,2,"ng-container",32),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(68,QG,1,3,"ng-template",null,33,s.Yc),s.Xc(70,ex,7,16,"ng-template",null,34,s.Yc),s.Xc(72,ix,3,2,"ng-template",null,35,s.Yc)}if(2&e){const e=s.Lc(73);s.Cb(8),s.wc("routerLink",s.Ac(45,sx)),s.Cb(1),s.ad(s.pc(10,21,"GLOBAL.PROFILE_SETTINGS_LABEL")),s.Cb(3),s.ad(s.pc(13,23,"GLOBAL.WEBHOOKS_TITLE")),s.Cb(4),s.wc("ngClass",s.Bc(46,cx,t.inProgress))("ngbPopover",e),s.Cb(2),s.ad(s.pc(19,25,"GLOBAL.CREATE_NEW_TITLE")),s.Cb(6),s.wc("list",t.workspacesForDropdown)("placeholder",s.pc(25,27,"WEBHOOKS.SEARCH.WORKSPACE"))("value",t.selectedWorkspace.name),s.Cb(3),s.cd(" (",t.workspaceWebhookCount," ",s.pc(28,29,"WEBHOOKS.OUT_OF")," 100) "),s.Cb(6),s.ad(s.pc(34,31,"WEBHOOKS.LOG.YOUR")),s.Cb(5),s.cd("",t.webhooks.length," ",s.pc(39,33,"WEBHOOKS.OUT_OF")," 10"),s.Cb(3),s.wc("hidden",!t.isDesktop),s.Cb(4),s.ad(s.pc(46,35,"GLOBAL.NAME_LABEL")),s.Cb(5),s.ad(s.pc(51,37,"WEBHOOKS.CREATE.EVENT.TITLE")),s.Cb(5),s.ad(s.pc(56,39,"GLOBAL.ENDPONT_URL")),s.Cb(5),s.ad(s.pc(61,41,"WEBHOOKS.EDIT.SIGNING_SECRET.TITLE")),s.Cb(4),s.ad(s.pc(65,43,"GLOBAL.EDIT_LABEL")),s.Cb(3),s.wc("ngForOf",t.webhooks)}},directives:[k.g,i.r,w.M,ji.a,i.t,PG,qG,Si.a,i.u],pipes:[g.e,i.I],encapsulation:2,changeDetection:0}),e})();var ox=n("yUBi");function rx(e,t){if(1&e&&(s.Xb(0,"textarea",19),s.Zc(1),s.oc(2,"prettyJson"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.ad(s.pc(2,1,e.log.responseBody))}}function lx(e,t){1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"WEBHOOKS.RESPONSE.NO_BODY")))}function bx(e,t){if(1&e&&(s.Xb(0,"div",10),s.Xb(1,"div",11),s.Xb(2,"div",1),s.Xb(3,"div",2),s.Xb(4,"span",12),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Xb(7,"div",6),s.Xb(8,"span"),s.Zc(9),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(10,"div",11),s.Xb(11,"div",13),s.Xb(12,"div",14),s.Xb(13,"span",12),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Wb(),s.Xb(16,"div",15),s.Xc(17,rx,3,3,"textarea",16),s.Xc(18,lx,3,3,"span",17),s.Wb(),s.Wb(),s.Wb(),s.Xb(19,"div",18),s.Xb(20,"div",13),s.Xb(21,"div",14),s.Xb(22,"span",12),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Wb(),s.Xb(25,"div",15),s.Xb(26,"textarea",19),s.Zc(27),s.oc(28,"prettyJson"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(5),s.ad(s.pc(6,7,"WEBHOOKS.HTTPS_STATUS")),s.Cb(4),s.ad(e.log.statusCode),s.Cb(5),s.ad(s.pc(15,9,"WEBHOOKS.RESPONSE.TITLE")),s.Cb(3),s.wc("ngIf",e.log.responseBody),s.Cb(1),s.wc("ngIf",!e.log.responseBody),s.Cb(5),s.ad(s.pc(24,11,"WEBHOOKS.LOG.REQUEST.TITLE")),s.Cb(4),s.ad(s.pc(28,13,e.log.requestBody))}}let dx=(()=>{class e{constructor(e){this.cd=e,this.isExpanded=!1,this.resend=new s.n}ngAfterViewInit(){this.cd.detectChanges()}emitResend(){this.resend.emit()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["webhook-log-row"],["","webhook-log-row",""]],inputs:{log:"log"},outputs:{resend:"resend"},decls:18,vars:13,consts:[[1,"cl-component-row","cl-border-bottom","cl-pr-0"],[1,"cl-row","cl-w-100"],[1,"cl-col-6","cl-col-lg-4","cl-d-flex","cl-align-items-center"],[1,"cl-badge-same-entries-wrapper"],[1,"cl-badge","cl-badge-same-entries","cl-ml-0",3,"click"],["src","assets/images/ui-icons/chevron-down.svg"],[1,"cl-col-auto","cl-d-flex","cl-align-items-center"],[1,"cl-col-auto","cl-ml-auto","cl-mr-n2","cl-mr-lg-0","cl-d-flex","cl-align-items-center"],[1,"cl-btn","cl-btn-sm","cl-btn-outline-light",3,"click"],["class","cl-bg-light cl-border-bottom",4,"ngIf"],[1,"cl-bg-light","cl-border-bottom"],[1,"cl-component-row","cl-border-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-text-gray-9","cl-text-uppercase"],[1,"cl-row","cl-w-100","cl-align-items-start"],[1,"cl-col-12","cl-col-lg-4","cl-d-flex","cl-align-items-center","cl-mb-2","cl-mb-lg-0"],[1,"cl-col-12","cl-col-lg-8","cl-d-flex","cl-align-items-center","cl-pr-0","cl-pr-lg-2"],["class","cl-form-control cl-bg-white","rows","6","readonly","",4,"ngIf"],[4,"ngIf"],[1,"cl-component-row","cl-border-0","cl-pl-2","cl-pl-lg-3","cl-pr-0","cl-py-3"],["rows","6","readonly","",1,"cl-form-control","cl-bg-white"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"a",3),s.Xb(4,"span",4),s.jc("click",(function(){return t.isExpanded=!t.isExpanded})),s.Sb(5,"img",5),s.Wb(),s.Wb(),s.Xb(6,"span"),s.Zc(7),s.Wb(),s.Wb(),s.Xb(8,"div",6),s.Xb(9,"span"),s.Zc(10),s.oc(11,"translate"),s.oc(12,"translate"),s.Wb(),s.Wb(),s.Xb(13,"div",7),s.Xb(14,"a",8),s.jc("click",(function(){return t.emitResend()})),s.Zc(15),s.oc(16,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(17,bx,29,15,"div",9)),2&e&&(s.Cb(7),s.ad(t.log.respondedAt),s.Cb(2),s.Eb(t.log.statusCode>199&&t.log.statusCode<300?"cl-text":"cl-text-danger"),s.Cb(1),s.bd(" ",t.log.statusCode>199&&t.log.statusCode<300?s.pc(11,7,"WEBHOOKS.SUCCEEDED"):s.pc(12,9,"GLOBAL.FAILED_MESSAGE")," "),s.Cb(5),s.ad(s.pc(16,11,"WEBHOOKS.RESEND")),s.Cb(2),s.wc("ngIf",t.isExpanded))},directives:[i.u],pipes:[g.e,ox.a],encapsulation:2,changeDetection:0}),e})();function ux(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",29),s.Xb(1,"a",30),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.filterByStatus(t.webhookLogStatus.ALL)})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"a",30),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.filterByStatus(t.webhookLogStatus.FAILED)})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"a",30),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.filterByStatus(t.webhookLogStatus.SUCCEEDED)})),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.ad(s.pc(3,3,"GLOBAL.SHOW_ALL_LABEL")),s.Cb(3),s.ad(s.pc(6,5,"GLOBAL.FAILED_MESSAGE")),s.Cb(3),s.ad(s.pc(9,7,"WEBHOOKS.SUCCEEDED")))}function px(e,t){if(1&e){const e=s.Yb();s.Xb(0,"webhook-log-row",31),s.jc("resend",(function(){s.Oc(e);const n=t.$implicit;return s.nc().resend(n.id)})),s.Wb()}2&e&&s.wc("log",t.$implicit)}const hx=function(){return["/user/settings"]},mx=function(){return["/webhooks"]};let gx=(()=>{class e{constructor(e,t,n){this.route=e,this.webhooksService=t,this.cd=n,this.unsubscribe$=new Fn.a,this.page=1,this.pageSize=50,this.status=gn.ALL,this.webhookLogStatus=gn}ngOnInit(){this.selectedWorkspaceId=this.route.snapshot.params.workspaceId,this.webhookId=this.route.snapshot.params.webhookId,this.intiWebhook(),this.getLogCount(),this.getLogs()}intiWebhook(){this.webhooksService.getById(this.selectedWorkspaceId,this.webhookId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.webhook=e,this.cd.detectChanges()})}sendTest(){this.webhooksService.test(this.selectedWorkspaceId,this.webhookId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>this.reloadLogsWithWait())}resend(e){this.webhooksService.resend(this.selectedWorkspaceId,this.webhookId,e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>this.reloadLogsWithWait())}getLogCount(){this.webhooksService.getLogCount(this.selectedWorkspaceId,this.webhookId,this.status).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.logCount=e,this.cd.detectChanges()})}getLogs(){this.webhooksService.getLogs(this.selectedWorkspaceId,this.webhookId,this.page,this.pageSize,this.status).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.logs=e,this.cd.detectChanges()})}filterByStatus(e){this.page=1,this.status=e,this.getLogCount(),this.getLogs()}changePage(e){this.page=e.page,this.getLogs()}changePageSize(e){this.pageSize=e.limit,this.page=e.page,this.getLogs()}reloadLogsWithWait(){setTimeout(()=>{this.getLogCount(),this.getLogs()},2e3)}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.a),s.Rb(On),s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["webhook"]],decls:49,vars:34,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-end"],[1,"cl-col-auto"],[1,"cl-breadcrumb","cl-p-0","cl-mb-2","cl-bg-transparent","cl-ml-0"],[1,"cl-breadcrumb-item"],[3,"routerLink"],[1,"cl-mb-2","cl-mb-lg-0"],[1,"cl-mb-3","cl-mb-lg-0","cl-text-gray-6"],[1,"cl-col"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end"],[1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-alert","cl-alert-info"],[1,"cl-card"],[1,"cl-card-body"],[1,"cl-pb-2","cl-pb-lg-3"],["dropdownKey","",1,"cl-dropdown"],["type","button","dropdownKeyButton","",1,"cl-btn","cl-btn-outline-light","cl-dropdown-toggle"],["class","cl-dropdown-menu",4,"dropdownKeyContent"],[1,"cl-card","cl-border-bottom","cl-mb-0"],[1,"cl-card-header","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-row","cl-w-100"],[1,"cl-col-6","cl-col-lg-4","cl-d-flex","cl-align-items-center"],[1,"cl-h6","cl-mb-0"],[1,"cl-col-auto","cl-d-flex","cl-align-items-center"],[3,"log","resend",4,"ngFor","ngForOf"],[1,"cl-mt-3","cl-mb-n2"],[3,"visible","page","limit","total","pageChanged","limitChanged"],[1,"cl-dropdown-menu"],["clickCloseDropdown","",1,"cl-dropdown-item",3,"click"],[3,"log","resend"]],template:function(e,t){1&e&&(s.Xb(0,"main",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"nav"),s.Xb(6,"ol",5),s.Xb(7,"li",6),s.Xb(8,"a",7),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Xb(11,"li",6),s.Xb(12,"a",7),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(15,"h1",8),s.Zc(16),s.Wb(),s.Xb(17,"p",9),s.Zc(18),s.Wb(),s.Wb(),s.Xb(19,"div",10),s.Xb(20,"div",11),s.Xb(21,"a",12),s.jc("click",(function(){return t.sendTest()})),s.Zc(22),s.oc(23,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(24,"div",13),s.Zc(25),s.oc(26,"translate"),s.Wb(),s.Xb(27,"div",14),s.Xb(28,"div",15),s.Xb(29,"div",16),s.Xb(30,"div",17),s.Xb(31,"button",18),s.Zc(32),s.oc(33,"translate"),s.Wb(),s.Xc(34,ux,10,9,"div",19),s.Wb(),s.Wb(),s.Xb(35,"div",20),s.Xb(36,"div",21),s.Xb(37,"div",22),s.Xb(38,"div",23),s.Xb(39,"span",24),s.Zc(40),s.oc(41,"translate"),s.Wb(),s.Wb(),s.Xb(42,"div",25),s.Xb(43,"span",24),s.Zc(44),s.oc(45,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(46,px,1,1,"webhook-log-row",26),s.Wb(),s.Xb(47,"div",27),s.Xb(48,"pager",28),s.jc("pageChanged",(function(e){return t.changePage(e)}))("limitChanged",(function(e){return t.changePageSize(e)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(8),s.wc("routerLink",s.Ac(32,hx)),s.Cb(1),s.ad(s.pc(10,18,"GLOBAL.PROFILE_SETTINGS_LABEL")),s.Cb(3),s.wc("routerLink",s.Ac(33,mx)),s.Cb(1),s.ad(s.pc(14,20,"GLOBAL.WEBHOOKS_TITLE")),s.Cb(3),s.ad(null==t.webhook?null:t.webhook.name),s.Cb(2),s.bd(" ",null==t.webhook?null:t.webhook.webhookEventLabel,""),s.Cb(4),s.ad(s.pc(23,22,"WEBHOOKS.TEST")),s.Cb(3),s.bd(" ",s.pc(26,24,"WEBHOOKS.LOG.INFO_MESSAGE")," "),s.Cb(7),s.dd("",s.pc(33,26,"GLOBAL.SHOW_LABEL")," ",t.status.toLowerCase()," (",t.logCount,")"),s.Cb(8),s.ad(s.pc(41,28,"WEBHOOKS.LOG.HEADER.DATE")),s.Cb(4),s.ad(s.pc(45,30,"GLOBAL.STATUS_LABEL")),s.Cb(2),s.wc("ngForOf",t.logs),s.Cb(2),s.wc("visible",t.logCount>0)("page",t.page)("limit",t.pageSize)("total",t.logCount))},directives:[k.g,ni.a,ii.a,si.a,i.t,Pi.a,dx],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var Ex=function(e){return e.PENDING="PENDING",e.UNSUBMITTED="UNSUBMITTED",e.ARCHIVED="ARCHIVED",e}({}),fx=function(e){return e[e.PAGE=0]="PAGE",e[e.GROUPBY=1]="GROUPBY",e[e.TEAMMATE=2]="TEAMMATE",e[e.SHOWFILTER=3]="SHOWFILTER",e[e.DATE=4]="DATE",e}({});let Sx=(()=>{class e{constructor(){this.filterChanged=new s.n,this.emitSelected=new s.n,this.teamPageLimit=In.j,this.unsubscribe$=new p.a}set approvalGroups(e){this._approvalGroups=e,e[0]instanceof Kt&&(this.hasNoTeamManagers=this.checkIfNoManagers(e))}get approvalGroups(){return this._approvalGroups}changedPagination(e){this.filterChanged.emit({type:fx.PAGE,page:e.page||this.page,pageSize:e.limit||this.pageSize})}changedGroupBy(e){this.filterChanged.emit({type:fx.GROUPBY,groupBy:e})}changedShowFilter(e){this.filterChanged.emit({type:fx.SHOWFILTER,showFilter:e})}userDropdownClosed(e){this.emitSelected.emit(e)}checkIfNoManagers(e){return!e.map(e=>e.items).reduce((function(e,t){return e.concat(t)}),[]).some(e=>!!e.userManagers&&!!e.userManagers.length)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["ng-component"]],inputs:{approvalGroups:"approvalGroups",durationFormat:"durationFormat",page:"page",pageSize:"pageSize",totalCount:"totalCount",isMultiplePages:"isMultiplePages",inProgress:"inProgress",noResultMessage:"noResultMessage",isAdminOrOwner:"isAdminOrOwner",isTeamManager:"isTeamManager",teamFilterCount:"teamFilterCount",userFilter:"userFilter",userGroupFilter:"userGroupFilter"},outputs:{filterChanged:"filterChanged",emitSelected:"emitSelected"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();const Cx=function(e,t,n){return{"cl-pl-lg-3":e,"cl-col-lg-auto":t,"cl-col-lg-1":n}},Ax=function(e){return{"cl-float-right cl-pr-3":e}};function Ox(e,t){if(1&e&&(s.Xb(0,"th",3),s.Xb(1,"div",4),s.Xb(2,"a",5),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e){const e=t.$implicit,n=t.index,i=t.last;s.wc("ngClass",s.Dc(5,Cx,0===n,0===n,0!==n)),s.Cb(1),s.wc("ngClass",s.Bc(9,Ax,i)),s.Cb(2),s.bd(" ",s.pc(4,3,e)," ")}}function vx(e,t){if(1&e&&(s.Vb(0),s.Xc(1,Ox,5,11,"th",2),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngForOf",e.labels)}}function Tx(e,t){if(1&e){const e=s.Yb();s.Xb(0,"th",6),s.Xb(1,"div",7),s.Zc(2),s.oc(3,"translate"),s.Xb(4,"div",8),s.Xb(5,"a",9),s.jc("click",(function(){return s.Oc(e),s.nc().expandAll()})),s.Xb(6,"span",10),s.Sb(7,"img",11),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.bd(" ",s.pc(3,2,e.labels[0])," "),s.Cb(5),s.wc("src",e.isExpandAll?"assets/images/ui-icons/chevron-up.svg":"/assets/images/ui-icons/chevron-down.svg",s.Qc)}}let Ix=(()=>{class e{constructor(){this.onExpandAll=new s.n,this.isExpandAll=!1}ngOnInit(){}expandAll(){this.isExpandAll=!this.isExpandAll,this.onExpandAll.emit(this.isExpandAll)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["approval-group-header"],["","approval-group-header",""]],inputs:{isDesktop:"isDesktop",labels:"labels"},outputs:{onExpandAll:"onExpandAll"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["mobileTemplate",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"cl-d-flex","cl-align-items-center",3,"ngClass"],[1,"cl-h5","cl-mb-0","cl-hover-no-underline","cl-cursor-text","cl-text-gray-6-dark-mode"],["colspan","4",1,"cl-pl-lg-3"],[1,"cl-h5","cl-mb-0","cl-d-flex","cl-justify-content-between","cl-text-uppercase","cl-align-items-center"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-ml-auto",3,"click"],[1,"cl-badge","cl-badge-same-entries","cl-mx-0"],[3,"src"]],template:function(e,t){if(1&e&&(s.Xc(0,vx,2,1,"ng-container",0),s.Xc(1,Tx,8,4,"ng-template",null,1,s.Yc)),2&e){const e=s.Lc(2);s.wc("ngIf",t.isDesktop)("ngIfElse",e)}},directives:[i.u,i.t,i.r],pipes:[g.e],encapsulation:2}),e})();var wx=n("bzkB");function Lx(e,t){1&e&&s.Tb(0)}function Rx(e,t){if(1&e&&(s.Xb(0,"span"),s.Zc(1),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.bd(" ",e.approvalGroupItem.label||e.approvalGroupItem.userName," ")}}function yx(e,t){if(1&e&&(s.Xb(0,"del"),s.Zc(1),s.Wb()),2&e){const e=s.nc(3);s.Cb(1),s.bd(" ",e.approvalGroupItem.label," ")}}const _x=function(){return["/timesheet"]},kx=function(e){return["/approvals",e]},Wx=function(){return{}};function Xx(e,t){if(1&e&&(s.Xb(0,"a",12),s.Xc(1,Rx,2,1,"span",13),s.Xc(2,yx,2,1,"ng-template",null,14,s.Yc),s.Wb()),2&e){const e=s.Lc(3),t=s.nc(2);s.wc("routerLink",t.hasTimesheet?s.Ac(4,_x):s.Bc(5,kx,t.approvalGroupItem.approvalRequestId))("queryParams",t.hasTimesheet?t.querryParams:s.Ac(7,Wx)),s.Cb(1),s.wc("ngIf",t.approvalGroupItem.approvalState!==t.ApprovalStatus.WITHDRAWN_APPROVAL)("ngIfElse",e)}}function Nx(e,t){if(1&e&&(s.Xb(0,"span",15),s.Zc(1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",e.approvalGroupItem.userName," ")}}function Dx(e,t){if(1&e&&(s.Xb(0,"div",9),s.Xc(1,Xx,4,8,"a",10),s.Xc(2,Nx,2,1,"ng-template",null,11,s.Yc),s.Wb()),2&e){const e=s.Lc(3),t=s.nc();s.Cb(1),s.wc("ngIf",t.approvalGroupItem.approvalRequestId||t.hasTimesheet)("ngIfElse",e)}}function Px(e,t){if(1&e&&(s.Xb(0,"div",16),s.Xb(1,"div",17),s.Xb(2,"span",18),s.Zc(3),s.Wb(),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.xc("title",e.formatedManagers||""),s.Cb(1),s.bd(" ",e.formatedManagers||"-"," ")}}function Mx(e,t){if(1&e&&(s.Xb(0,"a",12),s.Xb(1,"span"),s.Zc(2),s.oc(3,"timeFormat"),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.wc("routerLink",e.hasTimesheet?s.Ac(6,_x):s.Bc(7,kx,e.approvalGroupItem.approvalRequestId))("queryParams",e.hasTimesheet?e.querryParams:s.Ac(9,Wx)),s.Cb(2),s.bd(" ",s.qc(3,3,e.approvalGroupItem.total,e.format)," ")}}function Bx(e,t){if(1&e&&(s.Xb(0,"span",15),s.Zc(1),s.oc(2,"timeFormat"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.qc(2,1,e.approvalGroupItem.total,e.format)," ")}}const Ux=function(e){return{"cl-ml-auto cl-pr-2":e}};function Gx(e,t){if(1&e&&(s.Xb(0,"div",16),s.Xb(1,"div",19),s.Xc(2,Mx,4,10,"a",10),s.Xc(3,Bx,3,4,"ng-template",null,20,s.Yc),s.Wb(),s.Wb()),2&e){const e=s.Lc(4),t=s.nc();s.Cb(1),s.wc("ngClass",s.Bc(3,Ux,"col3"===t.selectedColumns[t.selectedColumns.length-1])),s.Cb(1),s.wc("ngIf",t.approvalGroupItem.approvalRequestId||t.hasTimesheet)("ngIfElse",e)}}function xx(e,t){1&e&&(s.Xb(0,"div",22),s.Xb(1,"span",23),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"GLOBAL.APPROVED_LABEL")," "))}function Fx(e,t){1&e&&(s.Xb(0,"div",22),s.Xb(1,"span",24),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"APPROVAL.SHARED.WITHDRAW")," "))}function jx(e,t){if(1&e&&(s.Xb(0,"div",16),s.Xc(1,xx,4,3,"div",21),s.Xc(2,Fx,4,3,"div",21),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.approvalGroupItem.approvalState===e.ApprovalStatus.APPROVED),s.Cb(1),s.wc("ngIf",e.approvalGroupItem.approvalState===e.ApprovalStatus.WITHDRAWN_APPROVAL)}}function Zx(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",30),s.Xb(1,"div",31),s.Xb(2,"a",32),s.jc("click",(function(){s.Oc(e);const t=s.nc(3),n=s.Lc(15);return t.openModal(n)})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(3),s.ad(s.pc(4,1,"GLOBAL.SUBMIT")))}function Vx(e,t){1&e&&(s.Xb(0,"div",26),s.Xb(1,"div",27),s.Sb(2,"img",28),s.Wb(),s.Xc(3,Zx,5,3,"div",29),s.Wb())}function Yx(e,t){if(1&e&&s.Xc(0,Vx,4,0,"div",25),2&e){const e=s.nc();s.wc("ngIf",e.isAdminOrOwner||e.isTeamManager)}}const Hx=function(e,t,n){return{startDate:e,endDate:t,userName:n}};function $x(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",33),s.Xb(1,"h1",34),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",35),s.jc("click",(function(){return t.$implicit.close()})),s.Xb(5,"span",36),s.Sb(6,"img",37),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",38),s.Zc(8),s.oc(9,"translate"),s.oc(10,"momentFormat"),s.oc(11,"momentFormat"),s.Wb(),s.Xb(12,"div",39),s.Xb(13,"a",40),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Xb(16,"button",41),s.jc("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc().submitApproval(),n.close()})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,4,"GLOBAL.TIME_ENTRY_APPROVE_SUBMIT")),s.Cb(6),s.bd("",s.qc(9,6,"APPROVAL.MODALS.SUBMIT_FOR_APPROVAL",s.Dc(19,Hx,s.qc(10,9,e.getSubmitModalWeekStart(),"MMM D"),s.qc(11,12,e.getSubmitModalWeekEnd(),"MMM D"),e.approvalGroupItem.userName))," "),s.Cb(6),s.ad(s.pc(15,15,"GLOBAL.CANCEL_BTN")),s.Cb(3),s.bd(" ",s.pc(18,17,"GLOBAL.SUBMIT")," ")}}const Kx=function(e){return{labels:e}},qx=function(e,t,n,i,s,c){return[e,t,n,i,s,c]};let zx=(()=>{class e{constructor(e,t,n,i,c,a){this.cd=e,this.modal=t,this.authService=n,this.toaster=i,this.translate=c,this.approvalService=a,this._hasTimesheet=!1,this.submittedForApproval=new s.n,this.ApprovalStatus=Ht,this.parametersSetted=!1,this.error=new p.a}get approvalGroupItem(){return this._approvalGroupItem}set approvalGroupItem(e){this._approvalGroupItem=e,e instanceof $t&&(this.formatedManagers=this.formatManagers(e.userManagers)),this.setQueryParams()}set hasTimesheet(e){this._hasTimesheet=e,this.setQueryParams()}get hasTimesheet(){return this._hasTimesheet}ngOnInit(){this.isAdminOrOwner=this.authService.isAdminOrOwner()}ngAfterViewInit(){this.cd.detectChanges()}setQueryParams(){this.parametersSetted||this.hasTimesheet&&this.approvalGroupItem instanceof cn&&(this.querryParams={userId:this.approvalGroupItem.userId,start:this.approvalGroupItem.dateRange.start,end:this.approvalGroupItem.dateRange.end},this.parametersSetted=!0)}formatManagers(e){return null==e?void 0:e.map(e=>e.name).join(", ")}getSubmitModalWeekStart(){return this.approvalGroupWeekStart.toISOString()}getSubmitModalWeekEnd(){return ke(this.approvalGroupWeekStart).add(6,"day").toISOString()}submitApproval(){this.approvalService.submitApproval(this.approvalGroupItem.userId,this.approvalGroupWeekStart).subscribe(e=>{this.submittedForApproval.emit(),this.toaster.pop("success",this.translate.instant("APPROVAL.MESSAGES.SUBMIT_SUCCESS"))},e=>this.error.next(e))}openModal(e){this.modal.open(e,{centered:!0,size:"md"})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.h),s.Rb(w.q),s.Rb(re.a),s.Rb(r.a),s.Rb(g.f),s.Rb(rn))},e.\u0275cmp=s.Lb({type:e,selectors:[["approval-group-row"],["","approval-group-row",""]],inputs:{approvalGroupItem:"approvalGroupItem",isDesktop:"isDesktop",labels:"labels",format:"format",selectedColumns:"selectedColumns",expandAll:"expandAll",isTeamManager:"isTeamManager",approvalGroupWeekStart:"approvalGroupWeekStart",hasTimesheet:"hasTimesheet"},outputs:{submittedForApproval:"submittedForApproval"},decls:16,vars:21,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cl-d-none",3,"isDesktop","templates","isExpanded"],["responsive",""],["col1",""],["col2",""],["col3",""],["col4",""],["col5",""],["submitForOthers",""],[1,"cl-d-inline-flex","cl-cut-text-wrapper","cl-w-100","cl-py-0","cl-py-lg-custom-2","cl-pr-3"],["class","cl-cut-text cl-brown cl-text-dark cl-text-decoration-none",3,"routerLink","queryParams",4,"ngIf","ngIfElse"],["noDecoratedName",""],[1,"cl-cut-text","cl-brown","cl-text-dark","cl-text-decoration-none",3,"routerLink","queryParams"],[4,"ngIf","ngIfElse"],["strikedText",""],[1,"cl-cut-text"],[1,"cl-component-divided-left","cl-d-flex","cl-text-dark","cl-text-decoration-none"],[1,"cl-cut-text-wrapper","cl-w-100","cl-d-flex","cl-justify-content-center","cl-justify-content-lg-start"],[1,"cl-cut-text",3,"title"],[1,"cl-justify-content-center","cl-justify-content-lg-start",3,"ngClass"],["noDecoratedTotal",""],["class","cl-ml-auto cl-pr-2",4,"ngIf"],[1,"cl-ml-auto","cl-pr-2"],[1,"cl-badge-approve","cl-approve-status-approved","no-wrap"],[1,"cl-badge-approve","cl-badge-status-dark-gray","no-wrap"],["class","cl-dropdown cl-d-flex cl-justify-content-end cl-hover-pointer","dropdown","",4,"ngIf"],["dropdown","",1,"cl-dropdown","cl-d-flex","cl-justify-content-end","cl-hover-pointer"],["role","button","closeDropdown","",1,"cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow"],["closeDropdown","","src","assets/images/ui-icons/menu-dots-vertical.svg"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownContent"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-scroll-area"],[1,"cl-dropdown-item",3,"click"],[1,"cl-modal-header"],[1,"cl-modal-title","cl-text-center"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-modal-footer"],["ngbAutofocus","",1,"cl-color-blue",3,"click"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"]],template:function(e,t){if(1&e&&(s.Xc(0,Lx,1,0,"ng-container",0),s.Sb(1,"responsive-row",1,2),s.oc(3,"columnDecider"),s.Xc(4,Dx,4,2,"ng-template",null,3,s.Yc),s.Xc(6,Px,4,2,"ng-template",null,4,s.Yc),s.Xc(8,Gx,5,5,"ng-template",null,5,s.Yc),s.Xc(10,jx,3,2,"ng-template",null,6,s.Yc),s.Xc(12,Yx,1,1,"ng-template",null,7,s.Yc),s.Xc(14,$x,19,23,"ng-template",null,8,s.Yc)),2&e){const e=s.Lc(2),n=s.Lc(5),i=s.Lc(7),c=s.Lc(9),a=s.Lc(11),o=s.Lc(13);s.wc("ngTemplateOutlet",e.template)("ngTemplateOutletContext",s.Bc(12,Kx,t.labels)),s.Cb(1),s.wc("isDesktop",t.isDesktop)("templates",s.tc(3,5,s.Gc(14,qx,t.selectedColumns,n,i,c,a,o)))("isExpanded",t.expandAll)}},directives:[i.B,Ei.a,i.u,k.g,i.r,Nc.a,Dc.a],pipes:[wx.a,dv.a,g.e,Ro.a],encapsulation:2}),e})();function Qx(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",6),s.Xb(1,"tr",7),s.jc("submittedForApproval",(function(){s.Oc(e);const n=t.$implicit;return s.nc(2).removeUnsubmittedGroupItem(n)})),s.Wb(),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc(2);s.Cb(1),s.wc("approvalGroupItem",e)("approvalGroupWeekStart",n.weekStartMoment)("isDesktop",n.isDesktop)("labels",n.labels)("format",n.format)("selectedColumns",n.columns)("hasTimesheet",n.approvalType===n.ApprovalTab.UNSUBMITTED&&n.hasTimesheet)("expandAll",n.expandAll)("isTeamManager",n.isTeamManager)}}function Jx(e,t){if(1&e){const e=s.Yb();s.Xb(0,"table",3),s.Xb(1,"thead"),s.Xb(2,"tr",4),s.jc("onExpandAll",(function(t){return s.Oc(e),s.nc().expandAllRows(t)})),s.Wb(),s.Wb(),s.Xb(3,"tbody"),s.Xc(4,Qx,2,9,"div",5),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.wc("labels",e.labels)("isDesktop",e.isDesktop),s.Cb(2),s.wc("ngForOf",e.approvalGroup.items)}}let eF=(()=>{class e{constructor(e,t,n,i){this.tranlationStore=e,this.translate=t,this.browserService=n,this.cd=i,this.hasTimesheet=!1,this.emptiedApprovalGroup=new s.n,this.ApprovalTab=Ex,this.unsubscribe$=new p.a}ngOnInit(){this.parseApprovalGroupPeriodStart(),this.formatTitle(),this.generateTableColumns(),this.setBrowserWidth()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}formatDateRange(e){const t=this.tranlationStore.getCurrentLang();return e.split(" - ").map(e=>ke.utc(e.trim()).startOf("day").locale(t).format("MMM D, YYYY")).join(" - ")}formatTitle(){"WEEK"===this.groupBy?this.approvalGroup.title=this.formatDateRange(this.approvalGroup.title):this.approvalGroup.items=this.approvalGroup.items.map(e=>(e.label=this.formatDateRange(e.label),e))}generateTableColumns(){let e=[],t=[];this.approvalType===Ex.PENDING?(e=e.concat(["TEAMS.MEMBERS.INFO.ROLE_TYPE.TM.TITLE","GLOBAL.TIME_LABEL"]),t=t.concat(["col2","col3"])):this.approvalType===Ex.UNSUBMITTED?(e.push("GLOBAL.TIME_LABEL"),t.push("col3"),t.push("col5")):(e=e.concat(["GLOBAL.TIME_LABEL","GLOBAL.STATUS_LABEL"]),t=t.concat(["col3","col4"])),e.unshift("WEEK"===this.groupBy?"PAGES.DASHBOARD.TEAM_ACTIVITIES.HEADER.MEMBER":"GLOBAL.DATE_LABEL"),t.unshift("col1"),this.labels=e,this.columns=t}setBrowserWidth(){this.browserService.isBreakpointLgCustom$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isDesktop=e,this.cd.detectChanges()})}expandAllRows(e){this.expandAll=e,this.cd.detectChanges()}removeUnsubmittedGroupItem(e){this.approvalGroup.items=this.approvalGroup.items.filter(t=>{if(e.userId.trim()!=t.userId.trim()||e.dateRange.start.toString()!==t.dateRange.start.toString()||e.dateRange.end.toString()!==t.dateRange.end.toString())return t}),this.approvalGroup.items.length||this.emptiedApprovalGroup.emit(this.approvalGroup.title)}parseApprovalGroupPeriodStart(){const e=this.approvalGroup.title.split(" - ")[0];this.weekStartMoment=ke.utc(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Ra.a),s.Rb(g.f),s.Rb(Gn.a),s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["approval-group"]],inputs:{approvalGroup:"approvalGroup",format:"format",groupBy:"groupBy",approvalType:"approvalType",hasTimesheet:"hasTimesheet",isTeamManager:"isTeamManager"},outputs:{emptiedApprovalGroup:"emptiedApprovalGroup"},decls:4,vars:2,consts:[[1,"cl-card-header","cl-px-2","cl-px-lg-3","cl-border-bottom-0"],[1,"cl-text-break"],["class","cl-invoice-list-table cl-table cl-remove-cell-borders cl-text-gray-6",4,"ngIf"],[1,"cl-invoice-list-table","cl-table","cl-remove-cell-borders","cl-text-gray-6"],["approval-group-header","",3,"labels","isDesktop","onExpandAll"],["class","cl-row-hover-shadow",4,"ngFor","ngForOf"],[1,"cl-row-hover-shadow"],["approval-group-row","",3,"approvalGroupItem","approvalGroupWeekStart","isDesktop","labels","format","selectedColumns","hasTimesheet","expandAll","isTeamManager","submittedForApproval"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Zc(2),s.Wb(),s.Wb(),s.Xc(3,Jx,5,3,"table",2)),2&e&&(s.Cb(2),s.ad(t.approvalGroup.title),s.Cb(1),s.wc("ngIf",!!t.approvalGroup))},directives:[i.u,Ix,i.t,zx],encapsulation:2,changeDetection:0}),e})();function tF(e,t){if(1&e&&(s.Xb(0,"span",21),s.Zc(1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",e.teamFilterCount>=e.teamPageLimit?e.teamPageLimit+"+":e.teamFilterCount," ")}}function nF(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",16),s.Xb(1,"div",17),s.Sb(2,"span",18),s.Zc(3),s.oc(4,"translate"),s.Xc(5,tF,2,1,"span",19),s.Wb(),s.Xb(6,"app-user-dropdown",20),s.jc("result",(function(t){return s.Oc(e),s.nc().emitSelected.emit(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.bd(" ",s.pc(4,6,"GLOBAL.TEAM_LABEL")," "),s.Cb(2),s.wc("ngIf",e.teamFilterCount&&0!==e.teamFilterCount),s.Cb(1),s.wc("withPending",!0)("users",e.userFilter)("forceFilter",!e.isAdminOrOwner)("userGroups",e.userGroupFilter)}}const iF=function(e){return{"cl-disabled":e}};function sF(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",22),s.jc("click",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(21);return t.openModal(n)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("ngClass",s.Bc(4,iF,e.inProgress||!(null!=e.approvalGroups&&e.approvalGroups.length)||e.hasNoTeamManagers)),s.Cb(1),s.bd(" ",s.pc(2,2,"APPROVAL.SHARED.REMIND_SUBMIT_ALL_BUTTON")," ")}}function cF(e,t){if(1&e&&(s.Xb(0,"div",23),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",e.noResultMessage," ")}}function aF(e,t){if(1&e&&s.Sb(0,"approval-group",25),2&e){const e=t.$implicit,n=s.nc(2);s.wc("approvalType",n.ApprovalTab.PENDING)("format",n.durationFormat)("approvalGroup",e)("groupBy",n.groupBy)}}function oF(e,t){if(1&e&&(s.Vb(0),s.Xc(1,aF,1,4,"approval-group",24),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngForOf",e.approvalGroups)}}function rF(e,t){if(1&e){const e=s.Yb();s.Xb(0,"pager",26),s.jc("pageChanged",(function(t){return s.Oc(e),s.nc().changedPagination(t)}))("limitChanged",(function(t){return s.Oc(e),s.nc().changedPagination(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("page",e.page)("limit",e.pageSize)("total",e.totalCount)}}function lF(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",27),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().approveAll(n)}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",28),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,"APPROVAL.SHARED.APPROVE_ALL"))("btnText",s.pc(2,6,"APPROVAL.SHARED.APPROVE_ALL"))("inProgress",e.inProgress),s.Cb(4),s.bd(" ",s.pc(5,8,"APPROVAL.MODALS.APPROVE_ALL_BODY"),". ")}}function bF(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",27),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().remindToApprove(n)}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",28),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,"APPROVAL.MODALS.REMIND_ALL_TITLE"))("btnText",s.pc(2,6,"GLOBAL.SEND_LABEL"))("inProgress",e.inProgress),s.Cb(4),s.bd(" ",s.pc(5,8,"APPROVAL.MODALS.REMIND_ALL_BODY")," ")}}let dF=(()=>{class e extends Sx{constructor(e,t){super(),this.workspaceService=e,this.modalService=t,this.approved=new s.n,this.reminded=new s.n,this.ApprovalTab=Ex}ngOnInit(){const e=this.workspaceService.getLocalDefaultWorkspace();this.hasAddTimeForOthersFeature=e.hasFeature(is.a.ADD_TIME_FOR_OTHERS),this.groupByOptions=[new Ea.a("WEEK","APPROVAL.SORT_BY.WEEK"),new Ea.a("PEOPLE","APPROVAL.SORT_BY.PEOPLE")]}openModal(e){this.modalService.open(e,{centered:!0})}approveAll(e){this.approved.emit(e)}remindToApprove(e){this.reminded.emit(e)}usersSelected(e){this.emitSelected.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(w.q))},e.\u0275cmp=s.Lb({type:e,selectors:[["pending-tab"]],inputs:{groupBy:"groupBy"},outputs:{approved:"approved",reminded:"reminded"},features:[s.zb],decls:22,vars:14,consts:[[1,"cl-tab-content"],[1,"cl-tab-pane","cl-fade","cl-active","cl-show"],[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-d-flex","cl-justify-content-between","cl-flex-wrap"],[1,"cl-d-flex","cl-justify-content-between","cl-pb-1","cl-mr-2"],[1,"cl-d-inline-block","cl-mr-2",3,"list","value","onChanged"],["class","cl-dropdown cl-dropdown-large","dropdownKey","",4,"ngIf"],[1,"cl-d-flex","cl-flex-row"],[3,"ngbTooltip"],["class","cl-btn cl-btn-outline-primary cl-mr-2","data-cy","remind-to-approve",3,"ngClass","click",4,"ngIf"],["data-cy","approve-all",1,"cl-btn","cl-btn-primary",3,"disabled","click"],["class","cl-h2 cl-mb-0 cl-border cl-p-5 cl-text-center cl-mb-3",4,"ngIf"],[4,"ngIf"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],["approveAllModal",""],["remindToApproveModal",""],["dropdownKey","",1,"cl-dropdown","cl-dropdown-large"],["role","button","dropdownKeyButton","",1,"cl-dropdown-item-label","cl-btn","cl-btn-outline-light","cl-w-100","cl-text-left","cl-dropdown-toggle","cl-cut-text","pointer"],[1,"cl-dropdown-prefix","cl-d-none","cl-d-sm-inline"],["class","cl-badge cl-badge-button cl-pl-1",4,"ngIf"],[3,"withPending","users","forceFilter","userGroups","result"],[1,"cl-badge","cl-badge-button","cl-pl-1"],["data-cy","remind-to-approve",1,"cl-btn","cl-btn-outline-primary","cl-mr-2",3,"ngClass","click"],[1,"cl-h2","cl-mb-0","cl-border","cl-p-5","cl-text-center","cl-mb-3"],["class","cl-card cl-d-block",3,"approvalType","format","approvalGroup","groupBy",4,"ngFor","ngForOf"],[1,"cl-card","cl-d-block",3,"approvalType","format","approvalGroup","groupBy"],[3,"page","limit","total","pageChanged","limitChanged"],[3,"title","btnText","inProgress","confirmed","close"],[1,"cl-text-dark","cl-mb-0"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"dropdown-items",5),s.jc("onChanged",(function(e){return t.changedGroupBy(e)})),s.Wb(),s.Xc(6,nF,7,8,"div",6),s.Wb(),s.Xb(7,"div",7),s.Xb(8,"div",8),s.oc(9,"translate"),s.Xc(10,sF,3,6,"button",9),s.Wb(),s.Xb(11,"div"),s.Xb(12,"button",10),s.jc("click",(function(){s.Oc(e);const n=s.Lc(19);return t.openModal(n)})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(15,cF,2,1,"div",11),s.Xc(16,oF,2,1,"ng-container",12),s.Xc(17,rF,1,3,"pager",13),s.Wb(),s.Wb(),s.Xc(18,lF,6,10,"ng-template",null,14,s.Yc),s.Xc(20,bF,6,10,"ng-template",null,15,s.Yc)}2&e&&(s.Cb(5),s.wc("list",t.groupByOptions)("value",t.groupBy),s.Cb(1),s.wc("ngIf",t.isAdminOrOwner||t.isTeamManager),s.Cb(2),s.wc("ngbTooltip",t.hasNoTeamManagers?s.pc(9,10,"APPROVAL.REMINDER.ASSIGN_TEAM_MANAGER_TOOLTIP"):""),s.Cb(2),s.wc("ngIf",t.isAdminOrOwner),s.Cb(2),s.wc("disabled",t.inProgress||!(null!=t.approvalGroups&&t.approvalGroups.length)),s.Cb(1),s.bd(" ",s.pc(14,12,"APPROVAL.SHARED.APPROVE_ALL")," "),s.Cb(2),s.wc("ngIf",!t.inProgress&&0===(null==t.approvalGroups?null:t.approvalGroups.length)),s.Cb(1),s.wc("ngIf",!!t.approvalGroups),s.Cb(1),s.wc("ngIf",(null==t.approvalGroups?null:t.approvalGroups.length)&&t.isMultiplePages))},directives:[ji.a,i.u,w.bb,ni.a,ii.a,D_.a,i.r,i.t,eF,Pi.a,Si.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function uF(e,t){if(1&e&&(s.Xb(0,"span",17),s.Zc(1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",e.teamFilterCount>=e.teamPageLimit?e.teamPageLimit+"+":e.teamFilterCount," ")}}function pF(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",12),s.Xb(1,"div",13),s.Sb(2,"span",14),s.Zc(3),s.oc(4,"translate"),s.Xc(5,uF,2,1,"span",15),s.Wb(),s.Xb(6,"app-user-dropdown",16),s.jc("result",(function(t){return s.Oc(e),s.nc().emitSelected.emit(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.bd(" ",s.pc(4,6,"GLOBAL.TEAM_LABEL")," "),s.Cb(2),s.wc("ngIf",0!==e.teamFilterCount),s.Cb(1),s.wc("withPending",!0)("users",e.userFilter)("forceFilter",!e.isAdminOrOwner)("userGroups",e.userGroupFilter)}}const hF=function(e){return{"cl-disabled":e}};function mF(e,t){if(1&e){const e=s.Yb();s.Xb(0,"button",18),s.jc("click",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(13);return t.openModal(n)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("ngClass",s.Bc(4,hF,e.inProgress||!(null!=e.approvalGroups&&e.approvalGroups.length))),s.Cb(1),s.bd(" ",s.pc(2,2,"APPROVAL.SHARED.REMIND_SUBMIT_BUTTON")," ")}}function gF(e,t){if(1&e&&(s.Xb(0,"div",19),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",e.noResultMessage," ")}}function EF(e,t){if(1&e){const e=s.Yb();s.Xb(0,"approval-group",21),s.jc("onSelectIds",(function(t){return s.Oc(e),s.nc(2).selectedUsers=t}))("emptiedApprovalGroup",(function(t){return s.Oc(e),s.nc(2).emptyApprovalGroup(t)})),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc(2);s.wc("approvalType",n.ApprovalTab.UNSUBMITTED)("hasTimesheet",n.hasTimesheet)("format",n.durationFormat)("approvalGroup",e)("groupBy","WEEK")("isTeamManager",n.isTeamManager)}}function fF(e,t){if(1&e&&(s.Vb(0),s.Xc(1,EF,1,6,"approval-group",20),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngForOf",e.approvalGroups)}}function SF(e,t){if(1&e){const e=s.Yb();s.Xb(0,"pager",22),s.jc("pageChanged",(function(t){return s.Oc(e),s.nc().changedPagination(t)}))("limitChanged",(function(t){return s.Oc(e),s.nc().changedPagination(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("page",e.page)("limit",e.pageSize)("total",e.totalCount)}}const CF=function(e){return{users:e}};function AF(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",23),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().remindToSubmit(n)}))("close",(function(n){return s.Oc(e),t.$implicit.close(n)})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",24),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,"APPROVAL.MODALS.REMIND_SELECTED_TITLE"))("btnText",s.pc(2,6,"GLOBAL.SEND_LABEL"))("inProgress",e.inProgress),s.Cb(4),s.bd(" ",s.qc(5,8,"APPROVAL.MODALS.REMIND_SELECTED_BODY",s.Bc(11,CF,e.selectedNames))," ")}}let OF=(()=>{class e extends Sx{constructor(e,t,n){super(),this.modalService=e,this.cd=t,this.analyticsService=n,this.ApprovalTab=Ex,this.remindedToSubmit=new s.n}ngOnInit(){}openModal(e){this.selectedNames=this.approvalGroups.map(e=>e.items).reduce((e,t)=>e.concat(t),[]).map(e=>e.userName).join(", "),this.cd.markForCheck(),this.modalService.open(e,{centered:!0})}remindToSubmit(e){this.remindedToSubmit.emit(e),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"Remind to submit",section:"Approvals",section2:"Unsubmitted"}))}updateDateRange(e){if(this.dateRange&&this.dateRange.start.isSame(e.dateRange.start))return;const t={start:e.dateRange.start.clone(),end:e.dateRange.end.clone(),label:e.dateRange.label};this.filterChanged.emit({type:fx.DATE,dateRange:t})}emptyApprovalGroup(e){this.approvalGroups=this.approvalGroups.filter(t=>t.title!==e)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q),s.Rb(s.h),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["unsubmitted-tab"]],inputs:{dateRange:"dateRange",hasTimesheet:"hasTimesheet"},outputs:{remindedToSubmit:"remindedToSubmit"},features:[s.zb],decls:14,vars:9,consts:[[1,"cl-tab-content"],[1,"cl-tab-pane","cl-fade","cl-active","cl-show"],[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-d-flex","cl-justify-content-between","cl-flex-wrap"],[1,"cl-d-flex","cl-flex-wrap","cl-flex-row","cl-pb-1","cl-mr-2"],[1,"cl-autocomplete-dropdown","cl-mr-2","cl-pb-1",3,"addOptionsContainer","timeEntriesDateRange","isWeekly","opensTo","dateRangeOut"],["class","cl-dropdown cl-dropdown-large","dropdownKey","",4,"ngIf"],["class","cl-btn cl-btn-outline-primary cl-mr-1",3,"ngClass","click",4,"ngIf"],["class","cl-h2 cl-mb-0 cl-border cl-p-5 cl-text-center cl-mb-3",4,"ngIf"],[4,"ngIf"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],["remindToSubmitModal",""],["dropdownKey","",1,"cl-dropdown","cl-dropdown-large"],["role","button","dropdownKeyButton","",1,"cl-dropdown-item-label","cl-btn","cl-btn-outline-light","cl-w-100","cl-text-left","cl-dropdown-toggle","cl-cut-text","pointer"],[1,"cl-dropdown-prefix","cl-d-none","cl-d-sm-inline"],["class","cl-badge cl-badge-button cl-pl-1",4,"ngIf"],[3,"withPending","users","forceFilter","userGroups","result"],[1,"cl-badge","cl-badge-button","cl-pl-1"],[1,"cl-btn","cl-btn-outline-primary","cl-mr-1",3,"ngClass","click"],[1,"cl-h2","cl-mb-0","cl-border","cl-p-5","cl-text-center","cl-mb-3"],["class","cl-card cl-d-block",3,"approvalType","hasTimesheet","format","approvalGroup","groupBy","isTeamManager","onSelectIds","emptiedApprovalGroup",4,"ngFor","ngForOf"],[1,"cl-card","cl-d-block",3,"approvalType","hasTimesheet","format","approvalGroup","groupBy","isTeamManager","onSelectIds","emptiedApprovalGroup"],[3,"page","limit","total","pageChanged","limitChanged"],[3,"title","btnText","inProgress","confirmed","close"],[1,"cl-text-dark","cl-mb-0"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"datepicker-range",5),s.jc("dateRangeOut",(function(e){return t.updateDateRange(e)})),s.Wb(),s.Xc(6,pF,7,8,"div",6),s.Wb(),s.Xb(7,"div"),s.Xc(8,mF,3,6,"button",7),s.Wb(),s.Wb(),s.Wb(),s.Xc(9,gF,2,1,"div",8),s.Xc(10,fF,2,1,"ng-container",9),s.Xc(11,SF,1,3,"pager",10),s.Wb(),s.Wb(),s.Xc(12,AF,6,13,"ng-template",null,11,s.Yc)),2&e&&(s.Cb(5),s.wc("addOptionsContainer",!0)("timeEntriesDateRange",t.dateRange)("isWeekly",!0)("opensTo","right"),s.Cb(1),s.wc("ngIf",t.isAdminOrOwner||t.isTeamManager),s.Cb(2),s.wc("ngIf",t.isAdminOrOwner),s.Cb(1),s.wc("ngIf",!t.inProgress&&0===(null==t.approvalGroups?null:t.approvalGroups.length)),s.Cb(1),s.wc("ngIf",!!t.approvalGroups),s.Cb(1),s.wc("ngIf",(null==t.approvalGroups?null:t.approvalGroups.length)&&t.isMultiplePages))},directives:[ws.a,i.u,ni.a,ii.a,D_.a,i.r,i.t,eF,Pi.a,Si.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function vF(e,t){if(1&e&&(s.Xb(0,"span",15),s.Zc(1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",e.teamFilterCount>=e.teamPageLimit?e.teamPageLimit+"+":e.teamFilterCount," ")}}function TF(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",10),s.Xb(1,"div",11),s.Sb(2,"span",12),s.Zc(3),s.oc(4,"translate"),s.Xc(5,vF,2,1,"span",13),s.Wb(),s.Xb(6,"app-user-dropdown",14),s.jc("result",(function(t){return s.Oc(e),s.nc().emitSelected.emit(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.bd(" ",s.pc(4,6,"GLOBAL.TEAM_LABEL")," "),s.Cb(2),s.wc("ngIf",0!==e.teamFilterCount),s.Cb(1),s.wc("withPending",!0)("users",e.userFilter)("forceFilter",!e.isAdminOrOwner)("userGroups",e.userGroupFilter)}}function IF(e,t){if(1&e&&(s.Xb(0,"div",16),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",e.noResultMessage," ")}}function wF(e,t){if(1&e&&s.Sb(0,"approval-group",18),2&e){const e=t.$implicit,n=s.nc(2);s.wc("approvalType",n.ApprovalTab.ARCHIVED)("format",n.durationFormat)("approvalGroup",e)("groupBy",n.groupBy)}}function LF(e,t){if(1&e&&(s.Vb(0),s.Xc(1,wF,1,4,"approval-group",17),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngForOf",e.approvalGroups)}}function RF(e,t){if(1&e){const e=s.Yb();s.Xb(0,"pager",19),s.jc("pageChanged",(function(t){return s.Oc(e),s.nc().changedPagination(t)}))("limitChanged",(function(t){return s.Oc(e),s.nc().changedPagination(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("page",e.page)("limit",e.pageSize)("total",e.totalCount)}}let yF=(()=>{class e extends Sx{constructor(e){super(),this.workspaceService=e,this.ApprovalTab=Ex}ngOnInit(){const e=this.workspaceService.getLocalDefaultWorkspace();this.hasAddTimeForOthersFeature=e.hasFeature(is.a.ADD_TIME_FOR_OTHERS),this.groupByOptions=[new Ea.a("WEEK","APPROVAL.SORT_BY.WEEK"),new Ea.a("PEOPLE","APPROVAL.SORT_BY.PEOPLE")],this.showFilterOptions=[new Ea.a("ALL","GLOBAL.SHOW_ALL_LABEL"),new Ea.a("APPROVED","APPROVAL.SHOW_APPROVED_LABEL"),new Ea.a("WITHDRAWN","APPROVAL.SHOW_WITHDRAWN_LABEL")]}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["archived-tab"]],inputs:{groupBy:"groupBy",showFilter:"showFilter"},features:[s.zb],decls:10,vars:8,consts:[[1,"cl-tab-content"],[1,"cl-tab-pane","cl-fade","cl-active","cl-show"],[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-d-flex","cl-pb-1"],[1,"cl-d-inline-block","cl-mr-2",3,"list","value","onChanged"],["class","cl-dropdown cl-dropdown-large cl-mr-2","dropdownKey","",4,"ngIf"],[1,"cl-d-inline-block",3,"list","value","onChanged"],["class","cl-h2 cl-mb-0 cl-border cl-p-5 cl-text-center cl-mb-3",4,"ngIf"],[4,"ngIf"],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],["dropdownKey","",1,"cl-dropdown","cl-dropdown-large","cl-mr-2"],["role","button","dropdownKeyButton","",1,"cl-dropdown-item-label","cl-btn","cl-btn-outline-light","cl-w-100","cl-text-left","cl-dropdown-toggle","cl-cut-text","pointer"],[1,"cl-dropdown-prefix","cl-d-none","cl-d-sm-inline"],["class","cl-badge cl-badge-button cl-pl-1",4,"ngIf"],[3,"withPending","users","forceFilter","userGroups","result"],[1,"cl-badge","cl-badge-button","cl-pl-1"],[1,"cl-h2","cl-mb-0","cl-border","cl-p-5","cl-text-center","cl-mb-3"],["class","cl-card cl-d-block",3,"approvalType","format","approvalGroup","groupBy",4,"ngFor","ngForOf"],[1,"cl-card","cl-d-block",3,"approvalType","format","approvalGroup","groupBy"],[3,"page","limit","total","pageChanged","limitChanged"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"dropdown-items",4),s.jc("onChanged",(function(e){return t.changedGroupBy(e)})),s.Wb(),s.Xc(5,TF,7,8,"div",5),s.Xb(6,"dropdown-items",6),s.jc("onChanged",(function(e){return t.changedShowFilter(e)})),s.Wb(),s.Wb(),s.Wb(),s.Xc(7,IF,2,1,"div",7),s.Xc(8,LF,2,1,"ng-container",8),s.Xc(9,RF,1,3,"pager",9),s.Wb(),s.Wb()),2&e&&(s.Cb(4),s.wc("list",t.groupByOptions)("value",t.groupBy),s.Cb(1),s.wc("ngIf",t.isAdminOrOwner||t.isTeamManager),s.Cb(1),s.wc("list",t.showFilterOptions)("value",t.showFilter),s.Cb(1),s.wc("ngIf",!t.inProgress&&0===(null==t.approvalGroups?null:t.approvalGroups.length)),s.Cb(1),s.wc("ngIf",!!t.approvalGroups),s.Cb(1),s.wc("ngIf",(null==t.approvalGroups?null:t.approvalGroups.length)&&t.isMultiplePages))},directives:[ji.a,i.u,ni.a,ii.a,D_.a,i.t,eF,Pi.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();const _F=function(e){return{value:e}};function kF(e,t){if(1&e){const e=s.Yb();s.Xb(0,"pending-tab",16),s.jc("filterChanged",(function(t){return s.Oc(e),s.nc().filterChanged(t)}))("emitSelected",(function(t){return s.Oc(e),s.nc().userDropdownClosed(t)}))("approved",(function(t){return s.Oc(e),s.nc().approveAll(t)}))("reminded",(function(t){return s.Oc(e),s.nc().remindToApprove(t)})),s.oc(1,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("approvalGroups",e.approvalGroups)("durationFormat",e.durationFormat)("inProgress",e.inProgress)("page",e.page)("pageSize",e.pageSize)("isMultiplePages",e.isMultiplePages)("totalCount",e.totalCount)("userFilter",e.userFilter)("userGroupFilter",e.userGroupFilter)("groupBy",e.groupBy)("isAdminOrOwner",e.isAdminOrOwner)("isTeamManager",e.isTeamManager)("teamFilterCount",e.teamFilterCount)("noResultMessage",s.qc(1,14,"APPROVAL.NO_TIMESHEETS_ON_LABEL",s.Bc(17,_F,e.label)))}}const WF=function(e,t){return{value:e,label:t}};function XF(e,t){if(1&e){const e=s.Yb();s.Xb(0,"unsubmitted-tab",17),s.jc("filterChanged",(function(t){return s.Oc(e),s.nc().filterChanged(t)}))("emitSelected",(function(t){return s.Oc(e),s.nc().userDropdownClosed(t)}))("remindedToSubmit",(function(t){return s.Oc(e),s.nc().remindSubmitSelected(t)})),s.oc(1,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("approvalGroups",e.approvalGroups)("durationFormat",e.durationFormat)("inProgress",e.inProgress)("hasTimesheet",e.hasTimesheet)("dateRange",e.dateRange)("isAdminOrOwner",e.isAdminOrOwner)("userFilter",e.userFilter)("userGroupFilter",e.userGroupFilter)("isTeamManager",e.isTeamManager)("teamFilterCount",e.teamFilterCount)("noResultMessage",s.qc(1,11,"APPROVAL.NO_TIMESHEETS_ON_UNSUBMITTED_LABEL",s.Cc(14,WF,e.label,e.dateRange.label)))}}function NF(e,t){if(1&e){const e=s.Yb();s.Xb(0,"archived-tab",18),s.jc("emitSelected",(function(t){return s.Oc(e),s.nc().userDropdownClosed(t)}))("filterChanged",(function(t){return s.Oc(e),s.nc().filterChanged(t)})),s.oc(1,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("approvalGroups",e.approvalGroups)("durationFormat",e.durationFormat)("inProgress",e.inProgress)("page",e.page)("pageSize",e.pageSize)("isMultiplePages",e.isMultiplePages)("totalCount",e.totalCount)("groupBy",e.groupBy)("showFilter",e.showFilter)("userFilter",e.userFilter)("userGroupFilter",e.userGroupFilter)("isAdminOrOwner",e.isAdminOrOwner)("isTeamManager",e.isTeamManager)("teamFilterCount",e.teamFilterCount)("noResultMessage",s.qc(1,15,"APPROVAL.NO_TIMESHEETS_ON_LABEL",s.Bc(18,_F,e.label)))}}const DF=function(){return["/approvals"]};let PF=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r,l,b,d){this.activatedRoute=e,this.router=t,this.approvalService=n,this.uiSettings=i,this.cd=s,this.workspaceService=c,this.authService=a,this.timezoneConverter=o,this.loader=r,this.userGroupService=l,this.translate=b,this.translationStore=d,this.ApprovalTab=Ex,this.page=1,this.pageSize=In.j,this.isAdminOrOwner=!1,this.isTeamManager=!1,this.teamFilterCount=0,this.users=[],this.userGroups=[],this.unsubscribe$=new p.a}ngOnInit(){this.labels={[Ex.PENDING]:this.translate.instant("GLOBAL.PENDING_LABEL"),[Ex.UNSUBMITTED]:this.translate.instant("GLOBAL.UNSUBMITTED_LABEL"),[Ex.ARCHIVED]:this.translate.instant("GLOBAL.ARCHIVED_LABEL")},this.wsId=this.workspaceService.getLocalDefaultWorkspace().id,this.getDataFromLocalStorage(),this.page=1,this.subscribeToFragment(),this.getWorkspaceData(),this.authService.permissionData$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(({isAdminOrOwner:e,isTeamManager:t})=>{this.isAdminOrOwner=e,this.isTeamManager=t,this.cd.detectChanges()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}get label(){return this.labels[this.activePill].toLowerCase()}getWorkspaceData(){this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.durationFormat=e.getTimeFormat(),this.hasTimesheet=e.canSeeTimeSheet,this.cd.markForCheck()})}subscribeToFragment(){this.activatedRoute.fragment.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{const t=Ex[(e=e||Ex.PENDING).toUpperCase()];this.activePill=t||Ex.PENDING,t?(this.page=1,this.activePill!==Ex.UNSUBMITTED&&this.checkCount(),this.getApprovals()):this.router.navigate([])})}setDataToLocalStorage(){const e={wsId:this.wsId,page:this.page,pageSize:this.pageSize,groupBy:this.groupBy,showFilter:this.showFilter,dateRange:JSON.stringify(this.dateRange),teamFilterCount:this.teamFilterCount,userFilter:JSON.stringify(this.userFilter),userGroupFilter:JSON.stringify(this.userGroupFilter)};this.uiSettings.setSettings(xn.b.APPROVALS_PAGE,e)}getDataFromLocalStorage(){const e=this.authService.getUser().settings.weekStart;let t=this.uiSettings.getSettings(xn.b.APPROVALS_PAGE);t=(null==t?void 0:t.wsId)===this.wsId?t:{},this.groupBy=t.groupBy||"WEEK",this.showFilter=t.showFilter||"ALL",this.page=+t.page||1,this.pageSize=t.pageSize||In.j;const n=(null==t?void 0:t.dateRange)?JSON.parse(null==t?void 0:t.dateRange):null;this.dateRange=n?{start:ke(n.start),end:ke(n.end),label:n.label||Object(_e.d)({start:ke(n.start),end:ke(n.end)},e,this.translate,this.translationStore).label}:Object(wc.d)(e,this.timezoneConverter),this.dateRange.label=n?this.dateRange.label:this.translate.instant(this.dateRange.label),this.userFilter=t.userFilter&&JSON.parse(t.userFilter)||this.getDefaultUserFilter(),this.userGroupFilter=t.userGroupFilter&&JSON.parse(t.userGroupFilter)||this.getDefaultUserFilter(),this.teamFilterCount=t.teamFilterCount||0,this.cd.detectChanges()}getDefaultUserFilter(){return{contains:on.d.CONTAINS,ids:[],status:on.l.ACTIVE_WITH_PENDING}}approveAll(e){this.inProgress=!0,this.loader.show(this.translate.instant("APPROVAL.LOADER")),this.approvalService.approveAll(this.userFilter,this.userGroupFilter).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.activePill===Ex.PENDING&&(this.approvalGroups=[],this.page=1,this.totalCount=0,this.isMultiplePages=!1,this.setDataToLocalStorage()),e.close(),this.loader.hide(),this.inProgress=!1,this.cd.markForCheck()},()=>{this.inProgress=!1,this.loader.hide()})}remindToApprove(e){this.inProgress=!0,this.loader.show(),this.approvalService.remindToApprove(this.userFilter,this.userGroupFilter).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{e.close(),this.loader.hide(),this.inProgress=!1,this.cd.markForCheck()},()=>{this.inProgress=!1,this.loader.hide()})}remindSubmitSelected(e){this.inProgress=!0,this.loader.show(),this.approvalService.remindToSubmit(this.dateRange.start.toISOString(),this.dateRange.end.toISOString(),this.userFilter,this.userGroupFilter).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{e.close(),this.loader.hide(),this.inProgress=!1,this.cd.markForCheck()},()=>{this.inProgress=!1,this.loader.hide()})}getApprovals(){if(this.activePill!==Ex.UNSUBMITTED){const e={page:this.page,pageSize:this.pageSize,groupBy:this.groupBy,states:this.resolveApprovalStatus(),userFilter:this.userFilter,userGroupFilter:this.userGroupFilter};this.approvalGroups=[],this.inProgress=!0,this.approvalService.getAllApprovalGroups(e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.approvalGroups=e,this.inProgress=!1,this.cd.detectChanges()},()=>this.inProgress=!1)}else this.approvalGroups=[],this.inProgress=!0,this.approvalService.getUnsubmittedDurations(this.dateRange.start.toISOString(),this.dateRange.end.toISOString(),this.userFilter,this.userGroupFilter).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.approvalGroups=e,this.inProgress=!1,this.cd.detectChanges()},()=>this.inProgress=!1)}checkCount(){this.totalCount=0,this.isMultiplePages=!1;const e={page:this.page,pageSize:this.pageSize,groupBy:this.groupBy,states:this.resolveApprovalStatus(),userFilter:this.userFilter,userGroupFilter:this.userGroupFilter};this.approvalService.getFilteredApprovalCount(e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.totalCount=e,this.isMultiplePages=e>this.pageSize,this.cd.markForCheck()})}resolveApprovalStatus(){switch(this.activePill){case Ex.PENDING:return[Ht.PENDING];case Ex.ARCHIVED:return"APPROVED"===this.showFilter?[Ht.APPROVED]:"WITHDRAWN"===this.showFilter?[Ht.WITHDRAWN_APPROVAL]:[Ht.APPROVED,Ht.WITHDRAWN_APPROVAL];case Ex.UNSUBMITTED:return[];default:return[Ht.PENDING]}}filterChanged(e){switch(e.type){case fx.PAGE:this.changePagination({page:e.page,limit:e.pageSize});break;case fx.GROUPBY:this.changeGroupBy(e.groupBy);break;case fx.TEAMMATE:this.changeTeammate();break;case fx.SHOWFILTER:this.changeShowFilter(e.showFilter);break;case fx.DATE:this.changeDates(e.dateRange)}this.activePill!==Ex.UNSUBMITTED&&this.checkCount(),this.getApprovals(),this.setDataToLocalStorage()}changeGroupBy(e){this.groupBy=e,this.page=1}changeTeammate(){this.page=1,this.cd.markForCheck()}changeShowFilter(e){this.showFilter=e,this.page=1,this.cd.markForCheck()}changeDates(e){this.dateRange={start:e.start,end:e.end,label:e.label},this.page=1,this.cd.markForCheck()}changePagination(e){this.page=e.page||this.page,this.pageSize=e.limit||this.pageSize,this.cd.markForCheck()}userDropdownClosed(e){this.teamFilterCount=e.numberOfSelected,this.userFilter=e.users,this.userGroupFilter=e.userGroups,this.setDataToLocalStorage(),this.filterChanged({type:fx.TEAMMATE})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.a),s.Rb(k.d),s.Rb(rn),s.Rb(xn.a),s.Rb(s.h),s.Rb(l.a),s.Rb(re.a),s.Rb(Ic.a),s.Rb(Hn.a),s.Rb(WL.a),s.Rb(g.f),s.Rb(Ra.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["approvals-page"]],decls:27,vars:29,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-h1"],[1,"cl-scroll-tabs-wrapper"],["tabs","",1,"cl-nav","cl-nav-tabs","cl-m-0","cl-scroll-tabs"],[1,"cl-nav-item"],["fragment","pending",1,"cl-nav-link",3,"routerLink"],["fragment","unsubmitted",1,"cl-nav-link",3,"routerLink"],["fragment","archived",1,"cl-nav-link",3,"routerLink"],[1,"cl-card"],[1,"cl-card-body","cl-pb-0"],[1,"cl-tab-content"],[3,"approvalGroups","durationFormat","inProgress","page","pageSize","isMultiplePages","totalCount","userFilter","userGroupFilter","groupBy","isAdminOrOwner","isTeamManager","teamFilterCount","noResultMessage","filterChanged","emitSelected","approved","reminded",4,"ngIf"],[3,"approvalGroups","durationFormat","inProgress","hasTimesheet","dateRange","isAdminOrOwner","userFilter","userGroupFilter","isTeamManager","teamFilterCount","noResultMessage","filterChanged","emitSelected","remindedToSubmit",4,"ngIf"],[3,"approvalGroups","durationFormat","inProgress","page","pageSize","isMultiplePages","totalCount","groupBy","showFilter","userFilter","userGroupFilter","isAdminOrOwner","isTeamManager","teamFilterCount","noResultMessage","emitSelected","filterChanged",4,"ngIf"],[3,"approvalGroups","durationFormat","inProgress","page","pageSize","isMultiplePages","totalCount","userFilter","userGroupFilter","groupBy","isAdminOrOwner","isTeamManager","teamFilterCount","noResultMessage","filterChanged","emitSelected","approved","reminded"],[3,"approvalGroups","durationFormat","inProgress","hasTimesheet","dateRange","isAdminOrOwner","userFilter","userGroupFilter","isTeamManager","teamFilterCount","noResultMessage","filterChanged","emitSelected","remindedToSubmit"],[3,"approvalGroups","durationFormat","inProgress","page","pageSize","isMultiplePages","totalCount","groupBy","showFilter","userFilter","userGroupFilter","isAdminOrOwner","isTeamManager","teamFilterCount","noResultMessage","emitSelected","filterChanged"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"h1",3),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Xb(6,"div",4),s.Xb(7,"ul",5),s.Xb(8,"li",6),s.Xb(9,"a",7),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Wb(),s.Xb(12,"li",6),s.Xb(13,"a",8),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Wb(),s.Xb(16,"li",6),s.Xb(17,"a",9),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(20,"div",10),s.Xb(21,"div",11),s.Xb(22,"div",12),s.Xb(23,"div",12),s.Xc(24,kF,2,19,"pending-tab",13),s.Xc(25,XF,2,17,"unsubmitted-tab",14),s.Xc(26,NF,2,20,"archived-tab",15),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(4),s.ad(s.pc(5,18,"GLOBAL.APPROVALS_LABEL")),s.Cb(5),s.Hb("cl-active",t.activePill===t.ApprovalTab.PENDING),s.wc("routerLink",s.Ac(26,DF)),s.Cb(1),s.ad(s.pc(11,20,"GLOBAL.PENDING_LABEL")),s.Cb(3),s.Hb("cl-active",t.activePill===t.ApprovalTab.UNSUBMITTED),s.wc("routerLink",s.Ac(27,DF)),s.Cb(1),s.ad(s.pc(15,22,"GLOBAL.UNSUBMITTED_LABEL")),s.Cb(3),s.Hb("cl-active",t.activePill===t.ApprovalTab.ARCHIVED),s.wc("routerLink",s.Ac(28,DF)),s.Cb(1),s.ad(s.pc(19,24,"GLOBAL.ARCHIVE_LABEL")),s.Cb(2),s.Hb("approval-pending-tab",t.activePill==t.ApprovalTab.PENDING),s.Cb(4),s.wc("ngIf",t.activePill==t.ApprovalTab.PENDING),s.Cb(1),s.wc("ngIf",t.activePill==t.ApprovalTab.UNSUBMITTED),s.Cb(1),s.wc("ngIf",t.activePill==t.ApprovalTab.ARCHIVED))},directives:[k.g,i.u,dF,OF,yF],pipes:[g.e],encapsulation:2,changeDetection:0}),e})(),MF=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(){const e=this.workspaceService.getLocalDefaultWorkspace();if(e&&e.timeApprovalEnabled)return!0;this.router.navigate(["tracker"])}}return e.\u0275fac=function(t){return new(t||e)(s.fc(l.a),s.fc(k.d))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})(),BF=(()=>{class e{constructor(e,t){this.router=e,this.authService=t}canActivate(){let e;const t=this.authService.permissionData$.pipe(Object(Zt.a)(e=>null!==e),Object(ln.a)(1));t.subscribe(()=>e=!0);const n=this.authService.permissionFailed$,i=t.pipe(Object(mw.a)(n),Object(ln.a)(1));return e||this.authService.getPermissionsForUser(),i.pipe(Object(d.a)(e=>{const t=e&&e.isAdmin||e.isTeamManager;return t||this.router.navigate(["/tracker"]),t}))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(k.d),s.fc(re.a))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})(),UF=(()=>{class e{constructor(e,t){this.authService=e,this.router=t,this.redirects=new Map([["1","clockify://"],["2","clockify-activity://"],["3","https://pmjeegjhjdlccodhacdgbgfagbpmccpe.chromiumapp.org?"],["4","https://f8d29a2fbdeb4a19892b293b70f4219ed117b1f7.extensions.allizom.org/?"]])}canActivate(e,t){if(!this.authService.isLoggedIn())return this.authService.logout(),ao.a.setRedirectUrl(t.url),!1;const n=this.redirects.get(e.params.id),i=localStorage.getItem("token"),s=localStorage.getItem("refreshToken");!!i&&!!s&&!!n&&(window.location.href=`${n}accessToken=${i}&refreshToken=${s}`),this.router.navigate(["tracker"])}}return e.\u0275fac=function(t){return new(t||e)(s.fc(re.a),s.fc(k.d))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var GF=n("yvyG");class xF{constructor(e,t){if(this.label=e.label,this.backgroundColor=e.backgroundColor||e.color,this.hoverBackgroundColor=e.hoverBackgroundColor||e.backgroundColor,this.clientName=e.clientName,this.duration=e.duration,e.hasOwnProperty("percentage")){const t=(""+(e.percentage||0)).replace(/%/gi,"");this.percentage=+t}else if(t){const e=new DA.a(this.duration).asSeconds(),n=new DA.a(t).asSeconds();this.percentage=e?+(e/n*100).toFixed(2):0}else this.percentage=0;const n=e.data?e.data.slice():[];this.data=n.map(e=>Object(sn.u)(e)?e:new DA.a(e).asSeconds())}}function FF(e,t){if(1&e&&(s.Xb(0,"div",2),s.Xb(1,"div",3),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",4),s.Zc(5),s.oc(6,"timeFormat"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,2,"APPROVAL.TABLE.SUBMITTED")),s.Cb(3),s.ad(s.qc(6,4,null==e.tableInfo?null:e.tableInfo.pendingTime,e.durationFormat))}}function jF(e,t){if(1&e&&(s.Xb(0,"div",2),s.Xb(1,"div",3),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",5),s.Zc(5),s.oc(6,"timeFormat"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,2,"GLOBAL.APPROVED_LABEL")),s.Cb(3),s.ad(s.qc(6,4,null==e.tableInfo?null:e.tableInfo.approvedTime,e.durationFormat))}}function ZF(e,t){if(1&e&&(s.Xb(0,"div",2),s.Xb(1,"div",3),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",6),s.Zc(5),s.oc(6,"timeFormat"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,2,"GLOBAL.BILLABLE_LABEL")),s.Cb(3),s.ad(s.qc(6,4,null==e.tableInfo?null:e.tableInfo.billableTime,e.durationFormat))}}function VF(e,t){if(1&e&&(s.Xb(0,"div",2),s.Xb(1,"div",3),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",7),s.Zc(5),s.oc(6,"roundIfWholeNumber"),s.oc(7,"centsToDollars"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,3,"GLOBAL.AMOUNT_LABEL")),s.Cb(3),s.cd("",s.pc(6,5,s.pc(7,7,null==e.tableInfo?null:e.tableInfo.billableAmount))," ",e.currency,"")}}function YF(e,t){if(1&e&&(s.Xb(0,"div",2),s.Xb(1,"div",3),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div",8),s.Zc(5),s.oc(6,"roundIfWholeNumber"),s.oc(7,"centsToDollars"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,3,"GLOBAL.COST_LABEL")),s.Cb(3),s.cd("",s.pc(6,5,s.pc(7,7,null==e.tableInfo?null:e.tableInfo.costAmount))," ",e.currency,"")}}let HF=(()=>{class e{constructor(e){this.workspaceService=e,this.ApprovalStatus=Ht}ngOnInit(){this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.activeBillable=this.workspace.activeBillableHours}get hasApprovedTime(){return!!this.tableInfo&&!!Object(ke.duration)(this.tableInfo.approvedTime).asMilliseconds()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["approval-table-header"]],inputs:{tableInfo:"tableInfo",durationFormat:"durationFormat",currency:"currency",isCostRateActive:"isCostRateActive",status:"status"},decls:6,vars:5,consts:[[1,"cl-d-flex","cl-flex-column","cl-flex-md-row","cl-w-100","cl-align-items-md-end","cl-justify-content-between"],["class","cl-dashboard-card-header-item cl-flex-fill cl-col-xl-auto",4,"ngIf"],[1,"cl-dashboard-card-header-item","cl-flex-fill","cl-col-xl-auto"],[1,"cl-h4","cl-mb-0"],["data-cy","submitted-time",1,"cl-h1"],["data-cy","approved-time",1,"cl-h1"],["data-cy","billable-time",1,"cl-h1"],["data-cy","billable-amount",1,"cl-h1"],[1,"cl-h1"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xc(1,FF,7,7,"div",1),s.Xc(2,jF,7,7,"div",1),s.Xc(3,ZF,7,7,"div",1),s.Xc(4,VF,8,9,"div",1),s.Xc(5,YF,8,9,"div",1),s.Wb()),2&e&&(s.Cb(1),s.wc("ngIf",t.status===t.ApprovalStatus.PENDING),s.Cb(1),s.wc("ngIf",t.hasApprovedTime||t.status===t.ApprovalStatus.APPROVED||t.status===t.ApprovalStatus.WITHDRAWN_APPROVAL),s.Cb(1),s.wc("ngIf",t.activeBillable),s.Cb(1),s.wc("ngIf",t.activeBillable),s.Cb(1),s.wc("ngIf",t.isCostRateActive&&t.activeBillable))},directives:[i.u],pipes:[g.e,dv.a,Ai.a,Oi.a],encapsulation:2,changeDetection:0}),e})();function $F(e,t){if(1&e&&(s.Xb(0,"label",7),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.ad(e.label)}}let KF=(()=>{class e{constructor(){this.label="Add note",this.minLength=1,this.onClose=new s.n,this.onSubmit=new s.n,this.note=""}ngOnInit(){}get isValid(){return this.note.trim().length>=(this.minLength||0)}submit(){this.isValid&&this.onSubmit.emit(this.note)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["note-modal"]],inputs:{inProgress:"inProgress",btnText:"btnText",label:"label",minLength:"minLength"},outputs:{onClose:"onClose",onSubmit:"onSubmit"},decls:12,vars:7,consts:[[1,"cl-modal-body"],[1,"cl-form-group","cl-mb-2"],["for","add-note",4,"ngIf"],["ngbAutofocus","","id","add-note","rows","5",1,"cl-form-control",3,"ngModel","ngModelChange"],[1,"cl-modal-footer"],["tabindex","0",3,"click","keyup.enter","keyup.space"],["type","button","tabindex","0",1,"cl-btn","cl-btn-primary",3,"disabled","click","keyup.enter","keyup.space"],["for","add-note"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div"),s.Xb(2,"div",1),s.Xc(3,$F,2,1,"label",2),s.Xb(4,"textarea",3),s.jc("ngModelChange",(function(e){return t.note=e})),s.Zc(5,"            "),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(6,"div",4),s.Xb(7,"a",5),s.jc("click",(function(){return t.onClose.emit()}))("keyup.enter",(function(){return t.onClose.emit()}))("keyup.space",(function(){return t.onClose.emit()})),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Xb(10,"button",6),s.jc("click",(function(){return t.submit()}))("keyup.enter",(function(){return t.submit()}))("keyup.space",(function(){return t.submit()})),s.Zc(11),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.wc("ngIf",t.label),s.Cb(1),s.wc("ngModel",t.note),s.Cb(4),s.ad(s.pc(9,5,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",!t.isValid||t.inProgress),s.Cb(1),s.ad(t.btnText))},directives:[i.u,v.c,v.s,v.v],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function qF(e,t){1&e&&(s.Xb(0,"div",18),s.Xb(1,"span",19),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"GLOBAL.APPROVED_LABEL")," "))}function zF(e,t){1&e&&(s.Xb(0,"div",18),s.Xb(1,"span",20),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,1,"APPROVAL.SHARED.WITHDRAW")," "))}function QF(e,t){if(1&e&&(s.Xb(0,"div",15),s.Xb(1,"h1",16),s.Zc(2),s.oc(3,"dateFormat"),s.oc(4,"dateFormat"),s.Wb(),s.Xc(5,qF,4,3,"div",17),s.Xc(6,zF,4,3,"div",17),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.dd(" ",e.details.owner.userName,", ",s.qc(3,5,e.details.dateRange.start,e.details.owner.timeZone)," - ",s.qc(4,8,e.details.dateRange.end,e.details.owner.timeZone)," "),s.Cb(3),s.wc("ngIf",e.details.status.state===e.ApprovalStatus.APPROVED),s.Cb(1),s.wc("ngIf",e.details.status.state===e.ApprovalStatus.WITHDRAWN_APPROVAL)}}function JF(e,t){if(1&e&&(s.Xb(0,"div",5),s.Xb(1,"span",6),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"span",21),s.Zc(5),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.bd("",s.pc(3,3,"APPROVAL.DETAILS.TIMEZONE"),": "),s.Cb(3),s.cd("(UTC ",e.offset,") ",e.details.owner.timeZone,"")}}function ej(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"dateFormat"),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.bd(" (",s.qc(2,1,e.details.date,e.details.owner.timeZone),") ")}}function tj(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"APPROVAL.DETAILS.APPROVED_BY"),": "))}function nj(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"APPROVAL.DETAILS.WITHDRAWN_BY"),": "))}function ij(e,t){if(1&e&&(s.Xb(0,"div",5),s.Xb(1,"span",22),s.Xc(2,tj,3,3,"ng-container",8),s.Xc(3,nj,3,3,"ng-container",8),s.Wb(),s.Xb(4,"span",23),s.Zc(5),s.oc(6,"dateFormat"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.wc("ngIf",(null==e.details?null:e.details.status.state)===e.ApprovalStatus.APPROVED),s.Cb(1),s.wc("ngIf",(null==e.details?null:e.details.status.state)===e.ApprovalStatus.WITHDRAWN_APPROVAL),s.Cb(2),s.cd(" ",null==e.details?null:e.details.status.updatedByUserName," (",s.qc(6,4,null==e.details?null:e.details.status.updatedAt,e.details.owner.timeZone),") ")}}function sj(e,t){if(1&e&&(s.Xb(0,"div",24),s.Xb(1,"div",25),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"p",26),s.Zc(5),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.bd("",s.pc(3,2,"GLOBAL.NOTE_LABEL"),":"),s.Cb(3),s.ad(null==e.details?null:e.details.status.note)}}const cj=function(e){return{"cl-disabled":e}};function aj(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",27),s.Xb(2,"button",28,29),s.jc("click",(function(){s.Oc(e);const t=s.Lc(3),n=s.nc(),i=s.Lc(23);return t.blur(),n.openModal(i)})),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Xb(6,"div",27),s.Xb(7,"button",30,31),s.jc("click",(function(){s.Oc(e);const t=s.Lc(8),n=s.nc(),i=s.Lc(21);return t.blur(),n.openModal(i)})),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc();s.Cb(2),s.wc("ngClass",s.Bc(8,cj,e.inProgress)),s.Cb(2),s.bd(" ",s.pc(5,4,"APPROVAL.DETAILS.REJECT")," "),s.Cb(3),s.wc("disabled",e.inProgress),s.Cb(2),s.bd(" ",s.pc(10,6,"APPROVAL.DETAILS.APPROVE")," ")}}function oj(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",27),s.Xb(2,"button",32,33),s.jc("click",(function(){s.Oc(e);const t=s.Lc(3),n=s.nc(),i=s.Lc(25);return t.blur(),n.openModal(i)})),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc();s.Cb(2),s.wc("ngClass",s.Bc(4,cj,e.inProgress)),s.Cb(2),s.bd(" ",s.pc(5,2,"GLOBAL.WITHDRAW_HEADER_APPROVAL")," ")}}function rj(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",34),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().approve(n)}))("close",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",35),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,"APPROVAL.MODALS.APPROVE_HEADER"))("btnText",s.pc(2,6,"APPROVAL.DETAILS.APPROVE"))("inProgress",e.inProgress),s.Cb(4),s.bd(" ",s.pc(5,8,"APPROVAL.MODALS.APPROVE_BODY"),". ")}}function lj(e,t){if(1&e){const e=s.Yb();s.Xb(0,"modal-header",36),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"note-modal",37),s.jc("onSubmit",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().reject(n,i)}))("onClose",(function(){return t.$implicit.close()})),s.oc(3,"translate"),s.oc(4,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,"APPROVAL.MODALS.REJECT_HEADER")),s.Cb(2),s.wc("label",s.pc(3,6,"APPROVAL.MODALS.REJECT_BODY_LABEL"))("btnText",s.pc(4,8,"APPROVAL.DETAILS.REJECT"))("inProgress",e.inProgress)}}function bj(e,t){if(1&e){const e=s.Yb();s.Xb(0,"modal-header",36),s.jc("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb(),s.Xb(2,"note-modal",37),s.jc("onSubmit",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().withdraw(n,i)}))("onClose",(function(){return t.$implicit.close()})),s.oc(3,"translate"),s.oc(4,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,"GLOBAL.WITHDRAW_HEADER_APPROVAL")),s.Cb(2),s.wc("label",s.pc(3,6,"APPROVAL.MODALS.WITHDRAW_BODY_LABEL"))("btnText",s.pc(4,8,"TIMESHEET2.WITHDRAW"))("inProgress",e.inProgress)}}const dj=function(){return["/approvals"]};let uj=(()=>{class e{constructor(e,t,n,i,s,c){this.approvalService=e,this.modalService=t,this.userService=n,this.cd=i,this.router=s,this.analyticsService=c,this.ApprovalStatus=Ht,this.unsubscribe$=new p.a}ngOnInit(){this.offset=ke.tz(this.details.owner.timeZone).format("Z");const e=this.userService.getTimeZone();this.adminOffset=ke.tz(e).format("Z"),this.fragment=this.details.status.state===Ht.WITHDRAWN_APPROVAL||this.details.status.state===Ht.APPROVED?"archived":this.details.status.state.toLowerCase()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}openModal(e){this.modalService.open(e,{centered:!0})}approve(e){this.inProgress=!0,this.approvalService.approve(this.details.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.details=t,this.inProgress=!1,e.close(),this.navigateBack(),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"approve",section:"Approvals"}))},()=>{this.inProgress=!1,this.cd.markForCheck()})}reject(e,t){this.inProgress=!0,this.approvalService.reject(this.details.id,e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.inProgress=!1,this.details=e,t.close(),this.navigateBack(),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"reject",section:"Approvals"}))},()=>{this.inProgress=!1,this.cd.markForCheck()})}withdraw(e,t){this.inProgress=!0,this.approvalService.withdrawApproval(this.details.id,e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.details=e,this.inProgress=!1,this.cd.detectChanges(),t.close(),this.navigateBack(),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"withdraw",section:"Approvals"}))},()=>{this.inProgress=!1,this.cd.markForCheck()})}navigateBack(){this.router.navigate(["approvals"],{fragment:this.fragment})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(rn),s.Rb(w.q),s.Rb(Lc.a),s.Rb(s.h),s.Rb(k.d),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["approval-detail-info"]],inputs:{details:"details"},decls:26,vars:17,consts:[[1,"cl-col-lg-8"],[1,"cl-d-inline-block","cl-mb-2",3,"routerLink","fragment"],["class","cl-d-flex cl-align-items-center cl-mb-2",4,"ngIf"],[1,"cl-d-flex","cl-mb-3","cl-mb-lg-0"],["class","cl-mr-3",4,"ngIf"],[1,"cl-mr-3"],[1,"cl-text-gray-9"],["data-cy","approval-submitted-by",1,"cl-text-gray-6","cl-text-break"],[4,"ngIf"],["class","cl-mb-3 cl-mb-lg-0",4,"ngIf"],[1,"cl-col-lg-4"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-lg-end"],["approveModal",""],["rejectModal",""],["withdrawModal",""],[1,"cl-d-flex","cl-align-items-center","cl-mb-2"],[1,"cl-mb-0","cl-text-break"],["class","cl-ml-3",4,"ngIf"],[1,"cl-ml-3"],[1,"cl-badge-approve","cl-approve-status-approved","no-wrap"],[1,"cl-badge-approve","cl-badge-status-dark-gray"],[1,"cl-text-gray-6"],["data-cy","approval-details-status",1,"cl-text-gray-9"],[1,"cl-text-gray-6","cl-text-break"],[1,"cl-mb-3","cl-mb-lg-0"],[1,"cl-mt-3","cl-text-gray-9"],["data-cy","note",1,"cl-text-gray-6","cl-mb-0"],[1,"cl-page-header-action"],["type","button","data-cy","reject-approval",1,"cl-btn","cl-btn-outline-primary",3,"ngClass","click"],["rejectBtn",""],["type","button","data-cy","approve-approval",1,"cl-btn","cl-btn-primary",3,"disabled","click"],["approveBtn",""],["type","button","data-cy","withdraw-approval",1,"cl-btn","cl-btn-outline-primary",3,"ngClass","click"],["withdrawBtn",""],[3,"title","btnText","inProgress","confirmed","close"],[1,"cl-text-dark","cl-mb-0"],[3,"title","onClose"],[3,"label","btnText","inProgress","onSubmit","onClose"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"a",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,QF,7,11,"div",2),s.Xb(5,"div",3),s.Xc(6,JF,6,5,"div",4),s.Xb(7,"div",5),s.Xb(8,"span",6),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Xb(11,"span",7),s.Zc(12),s.Xc(13,ej,3,4,"ng-container",8),s.Wb(),s.Wb(),s.Xc(14,ij,7,7,"div",4),s.Wb(),s.Xc(15,sj,6,4,"div",9),s.Wb(),s.Xb(16,"div",10),s.Xb(17,"div",11),s.Xc(18,aj,11,10,"ng-container",8),s.Xc(19,oj,6,6,"ng-container",8),s.Wb(),s.Wb(),s.Xc(20,rj,6,10,"ng-template",null,12,s.Yc),s.Xc(22,lj,5,10,"ng-template",null,13,s.Yc),s.Xc(24,bj,5,10,"ng-template",null,14,s.Yc)),2&e&&(s.Cb(1),s.wc("routerLink",s.Ac(16,dj))("fragment",t.fragment),s.Cb(1),s.bd(" ",s.pc(3,12,"GLOBAL.APPROVALS_LABEL")," "),s.Cb(2),s.wc("ngIf",t.details),s.Cb(2),s.wc("ngIf",t.offset!==t.adminOffset),s.Cb(3),s.bd("",s.pc(10,14,"APPROVAL.DETAILS.SUBMITTED_BY"),": "),s.Cb(3),s.bd(" ",null==t.details?null:t.details.creator.userName," "),s.Cb(1),s.wc("ngIf",null==t.details?null:t.details.date),s.Cb(1),s.wc("ngIf",(null==t.details?null:t.details.status.state)===t.ApprovalStatus.APPROVED||(null==t.details?null:t.details.status.state)===t.ApprovalStatus.WITHDRAWN_APPROVAL),s.Cb(1),s.wc("ngIf",null==t.details?null:t.details.status.note),s.Cb(3),s.wc("ngIf",(null==t.details?null:t.details.status.state)===t.ApprovalStatus.PENDING),s.Cb(1),s.wc("ngIf",(null==t.details?null:t.details.status.state)===t.ApprovalStatus.APPROVED))},directives:[k.g,i.u,i.r,Si.a,Wd.a,KF],pipes:[g.e,bv.a],encapsulation:2,changeDetection:0}),e})();const pj=function(e,t){return{"background-color":e,width:t}};let hj=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["chart-horizontal-line"]],inputs:{backgroundColor:"backgroundColor",percentage:"percentage"},decls:2,vars:4,consts:[[1,"cl-horizontal-chart--progress",2,"width","100%"],[1,"cl-horizontal-chart--progress--item",3,"ngStyle"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Sb(1,"div",1),s.Wb()),2&e&&(s.Cb(1),s.wc("ngStyle",s.Cc(1,pj,t.backgroundColor,t.percentage+"%")))},directives:[i.x],encapsulation:2,changeDetection:0}),e})();function mj(e,t){if(1&e&&(s.Xb(0,"span",11),s.Zc(1),s.Wb()),2&e){const e=s.nc().$implicit;s.Cb(1),s.bd(" - ",e.clientName," ")}}const gj=function(e){return{data:e}};function Ej(e,t){if(1&e&&s.Tb(0,12),2&e){const e=s.nc().$implicit;s.nc();const t=s.Lc(4);s.wc("ngTemplateOutlet",t)("ngTemplateOutletContext",s.Bc(2,gj,e))}}function fj(e,t){if(1&e&&(s.Xb(0,"tr"),s.Xb(1,"td",4),s.Xb(2,"span"),s.Zc(3),s.Xc(4,mj,2,1,"span",5),s.Wb(),s.Wb(),s.Xb(5,"td",6),s.Zc(6),s.oc(7,"timeFormat"),s.Wb(),s.Xb(8,"td",7),s.Sb(9,"chart-horizontal-line",8),s.Xc(10,Ej,1,4,"ng-template",null,9,s.Yc),s.Wb(),s.Xb(12,"td",10),s.Zc(13),s.Wb(),s.Wb()),2&e){const e=t.$implicit,n=s.Lc(11),i=s.nc();s.Cb(2),s.Db("title",e.clientName?e.label+" - "+e.clientName:e.label),s.Cb(1),s.bd(" ",e.label," "),s.Cb(1),s.wc("ngIf",e.clientName),s.Cb(2),s.bd(" ",s.qc(7,8,e.duration,i.durationFormat)," "),s.Cb(3),s.wc("ngbTooltip",n)("percentage",e.percentage)("backgroundColor",e.backgroundColor),s.Cb(4),s.bd(" ",e.percentage,"% ")}}const Sj=function(e){return{count:e}};function Cj(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",13),s.Xb(1,"span"),s.Xb(2,"button",14),s.jc("click",(function(){return s.Oc(e),s.nc().onLoadMore.emit()})),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.bd(" ",s.qc(4,1,"SHARED_MODULES.CHART.LOAD_MORE_WITH_COUNT_LABEL",s.Bc(4,Sj,e.totalLength-e.chartData.length))," ")}}function Aj(e,t){if(1&e&&(s.Xb(0,"div",15),s.Sb(1,"i",16),s.Xb(2,"span"),s.Zc(3),s.Wb(),s.Wb(),s.Xb(4,"span",17),s.Zc(5),s.oc(6,"timeFormat"),s.Wb(),s.Xb(7,"span",18),s.Zc(8),s.Wb()),2&e){const e=t.data,n=s.nc();s.Cb(1),s.Wc("background",e.backgroundColor,s.Kb),s.Cb(2),s.bd("",e.label,":"),s.Cb(2),s.bd(" ",s.qc(6,5,e.duration,n.durationFormat)," "),s.Cb(3),s.bd(" ",e.percentage,"% ")}}let Oj=(()=>{class e{constructor(e){this.cd=e,this.onLoadMore=new s.n}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["chart-horizontal"]],inputs:{chartData:"chartData",totalLength:"totalLength",durationFormat:"durationFormat"},outputs:{onLoadMore:"onLoadMore"},decls:5,vars:2,consts:[[1,"cl-main-horizontal-chart-container"],[4,"ngFor","ngForOf"],["class","cl-or-divider cl-mt-3",4,"ngIf"],["tooltipContent",""],[1,"cl-text-truncate","cl-main-horizontal-chart-container--label"],["class","cl-listing-client",4,"ngIf"],[1,"cl-w-10","cl-text-right"],[1,"cl-w-50","cl-main-horizontal-chart-container--progress"],["placement","bottom-left",1,"cl-main-horizontal-chart-container--progress--bar",3,"ngbTooltip","percentage","backgroundColor"],["tooltip",""],[1,"cl-w-10","cl-text-nowrap","cl-text-gray-9","cl-text-right"],[1,"cl-listing-client"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cl-or-divider","cl-mt-3"],[1,"cl-btn","cl-btn-sm","cl-btn-outline-light","cl-w-max-content",3,"click"],[1,"cl-tooltip-label","cl-text-truncate","cl-text-left"],[1,"cl-entry__project__dot"],[1,"cl-tooltip-duration",2,"white-space","nowrap"],[1,"cl-text-right","cl-text-gray-9"]],template:function(e,t){1&e&&(s.Xb(0,"table",0),s.Xc(1,fj,14,11,"tr",1),s.Wb(),s.Xc(2,Cj,5,6,"div",2),s.Xc(3,Aj,9,8,"ng-template",null,3,s.Yc)),2&e&&(s.Cb(1),s.wc("ngForOf",t.chartData),s.Cb(1),s.wc("ngIf",t.totalLength>t.chartData.length))},directives:[i.t,i.u,hj,w.bb,i.B],pipes:[dv.a,g.e],encapsulation:2,changeDetection:0}),e})();var vj=n("a+PT");function Tj(e,t){if(1&e&&(s.Xb(0,"span",16),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.wc("title",e.timeEntry.description),s.Cb(1),s.bd(" ",e.timeEntry.description," ")}}function Ij(e,t){1&e&&(s.Xb(0,"span",17),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"APPROVAL.ENTRY_NO_DESCRIPTION")," "))}function wj(e,t){if(1&e&&(s.Vb(0),s.Sb(1,"span",11),s.Xb(2,"span",23),s.Zc(3),s.Wb(),s.Ub()),2&e){const e=s.nc(2);s.Cb(3),s.bd(" ",e.timeEntry.project.clientName," ")}}function Lj(e,t){if(1&e&&(s.Xb(0,"div",18),s.Xb(1,"div",19),s.Xb(2,"span",20),s.Sb(3,"i",21),s.Zc(4),s.Wb(),s.Xc(5,wj,4,1,"ng-container",22),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.Wc("color",e.timeEntry.project.color),s.Cb(1),s.Wc("background-color",e.timeEntry.project.color),s.Cb(1),s.cd(" ",e.timeEntry.project.name,"",null!=e.timeEntry.task&&e.timeEntry.task.name?": "+e.timeEntry.task.name:""," "),s.Cb(1),s.wc("ngIf",e.timeEntry.project.clientName)}}function Rj(e,t){if(1&e&&(s.Xb(0,"div",24),s.Xb(1,"span",25),s.Zc(2),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.bd(" ",e.tagsLabel," ")}}function yj(e,t){if(1&e&&s.Sb(0,"billable-icon",26),2&e){const e=s.nc();s.wc("disableEdit",!0)("billable",e.timeEntry.billable)}}function _j(e,t){if(1&e&&(s.Xb(0,"div",27),s.oc(1,"translate"),s.Sb(2,"img",28),s.Wb()),2&e){const e=s.nc();s.wc("title",s.pc(1,2,e.timeEntry.approvalRequestId?"GLOBAL.APPROVED_LABEL":"GLOBAL.PENDING_LABEL")),s.Cb(2),s.wc("src",e.timeEntry.approvalRequestId?"assets/ui-icons/checkmark-green-circle.svg":"assets/ui-icons/icon-pending.svg",s.Qc)}}function kj(e,t){if(1&e&&s.Sb(0,"custom-fields-values",29),2&e){const e=s.nc();s.wc("timeEntryId",e.timeEntry.id)("projectId",null==e.timeEntry.project?null:e.timeEntry.project.id)("customFields",e.customFields)("disableEdit",!0)("customFieldValues",e.timeEntry.customFieldValues)}}let Wj=(()=>{class e{constructor(e){this.workspaceService=e}ngOnInit(){this.tagsLabel=this.timeEntry.tags.map(e=>e.name).join(", "),this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.activeBillable=this.workspace.activeBillableHours}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["approval-entry"]],inputs:{timeEntry:"timeEntry",customFields:"customFields",durationFormat:"durationFormat",ownerTimeZone:"ownerTimeZone",showApprovalStatus:"showApprovalStatus"},decls:24,vars:19,consts:[[1,"cl-component-row","cl-border-0","cl-p-0"],[1,"cl-d-flex","cl-flex-column","cl-flex-lg-row","cl-w-100","cl-pt-2","cl-pt-lg-0"],[1,"cl-component-divided-left","cl-justify-content-start","cl-cut-text","cl-no-divider-border","cl-my-1","cl-my-lg-0","cl-mx-n1","cl-mx-lg-0"],["class","cl-cut-text",3,"title",4,"ngIf","ngIfElse"],["noDescriptionTemplate",""],["class","cl-component-divided-left cl-justify-content-start cl-cut-text cl-remove-divider-mob cl-my-1 cl-my-lg-0 cl-mx-n1 cl-mx-lg-0",4,"ngIf"],["class","cl-component-divided-left cl-justify-content-start cl-remove-divider-mob cl-cut-text cl-my-1 cl-my-lg-0 cl-mx-n1 cl-mx-lg-0",4,"ngIf"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end","cl-template-separator-mob","cl-min-height-40","cl-w-100","cl-w-lg-auto","cl-ml-auto","cl-mt-2","cl-mt-lg-0"],["class","cl-component-divided-left cl-remove-divider-mob cl-disable-pointer",3,"disableEdit","billable",4,"ngIf"],[1,"cl-component-divided-left"],[1,"cl-input-time-picker","cl-text-right","cl-bg-white"],[1,"cl-h-line-divider"],[1,"cl-input-time-picker","cl-bg-white"],[1,"cl-input-time-picker-sum","cl-bg-white","cl-text-right"],["class","cl-component-divided-left",3,"title",4,"ngIf"],["class","cl-disabled",3,"timeEntryId","projectId","customFields","disableEdit","customFieldValues",4,"ngIf"],[1,"cl-cut-text",3,"title"],[1,"cl-text-gray-9","cl-cut-text"],[1,"cl-component-divided-left","cl-justify-content-start","cl-cut-text","cl-remove-divider-mob","cl-my-1","cl-my-lg-0","cl-mx-n1","cl-mx-lg-0"],[1,"cl-project-name","cl-project-name-colored","cl-listing-project-client","cl-cut-text"],[1,"cl-locked-no-underline"],[1,"cl-entry__project__dot"],[4,"ngIf"],[1,"cl-listing-client","cl-locked-no-underline"],[1,"cl-component-divided-left","cl-justify-content-start","cl-remove-divider-mob","cl-cut-text","cl-my-1","cl-my-lg-0","cl-mx-n1","cl-mx-lg-0"],[1,"cl-badge","cl-badge-tag","cl-cut-text"],[1,"cl-component-divided-left","cl-remove-divider-mob","cl-disable-pointer",3,"disableEdit","billable"],[1,"cl-component-divided-left",3,"title"],[3,"src"],[1,"cl-disabled",3,"timeEntryId","projectId","customFields","disableEdit","customFieldValues"]],template:function(e,t){if(1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xc(3,Tj,2,2,"span",3),s.Xc(4,Ij,3,3,"ng-template",null,4,s.Yc),s.Wb(),s.Xc(6,Lj,6,7,"div",5),s.Xc(7,Rj,3,1,"div",6),s.Xb(8,"div",7),s.Xc(9,yj,1,2,"billable-icon",8),s.Xb(10,"div",9),s.Xb(11,"span",10),s.Zc(12),s.oc(13,"hourFormat"),s.Wb(),s.Sb(14,"span",11),s.Xb(15,"span",12),s.Zc(16),s.oc(17,"hourFormat"),s.Wb(),s.Wb(),s.Xb(18,"div",9),s.Xb(19,"span",13),s.Zc(20),s.oc(21,"timeFormat"),s.Wb(),s.Wb(),s.Xc(22,_j,3,4,"div",14),s.Wb(),s.Wb(),s.Wb(),s.Xc(23,kj,1,5,"custom-fields-values",15)),2&e){const e=s.Lc(5);s.Cb(3),s.wc("ngIf",t.timeEntry.description)("ngIfElse",e),s.Cb(3),s.wc("ngIf",null==t.timeEntry.project?null:t.timeEntry.project.id),s.Cb(1),s.wc("ngIf",t.tagsLabel),s.Cb(2),s.wc("ngIf",t.activeBillable),s.Cb(3),s.bd(" ",s.qc(13,10,t.timeEntry.timeInterval.start,t.ownerTimeZone)," "),s.Cb(4),s.bd(" ",s.qc(17,13,t.timeEntry.timeInterval.end,t.ownerTimeZone)," "),s.Cb(4),s.bd(" ",s.qc(21,16,t.timeEntry.timeInterval.duration,t.durationFormat)," "),s.Cb(2),s.wc("ngIf",t.showApprovalStatus||t.timeEntry.approvalRequestId),s.Cb(1),s.wc("ngIf",(null==t.customFields?null:t.customFields.length)>0)}},directives:[i.u,MO.a,YO.a],pipes:[vj.a,dv.a,g.e],encapsulation:2,changeDetection:0}),e})();function Xj(e,t){if(1&e&&s.Sb(0,"approval-entry",5),2&e){const e=t.$implicit,n=s.nc();s.wc("durationFormat",n.durationFormat)("timeEntry",e)("ownerTimeZone",n.ownerTimeZone)("customFields",n.customFields)("showApprovalStatus",n.showApprovalStatus)}}let Nj=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["approval-entry-group"]],inputs:{entryGroup:"entryGroup",customFields:"customFields",durationFormat:"durationFormat",ownerTimeZone:"ownerTimeZone",showApprovalStatus:"showApprovalStatus"},decls:12,vars:11,consts:[[1,"cl-card-header","cl-px-2","cl-px-lg-3"],[1,"cl-d-flex","cl-align-items-end"],[1,"cl-h6","cl-mb-0","cl-lh-1"],[1,"cl-h2","cl-mb-0","cl-ml-2","cl-lh-1"],["class","cl-d-block cl-px-0 cl-hover-shadow cl-border-bottom",3,"durationFormat","timeEntry","ownerTimeZone","customFields","showApprovalStatus",4,"ngFor","ngForOf"],[1,"cl-d-block","cl-px-0","cl-hover-shadow","cl-border-bottom",3,"durationFormat","timeEntry","ownerTimeZone","customFields","showApprovalStatus"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div"),s.Zc(2),s.oc(3,"dateFormat"),s.Wb(),s.Xb(4,"div",1),s.Xb(5,"div",2),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"div",3),s.Zc(9),s.oc(10,"timeFormat"),s.Wb(),s.Wb(),s.Wb(),s.Xc(11,Xj,1,5,"approval-entry",4)),2&e&&(s.Cb(2),s.ad(s.pc(3,4,t.entryGroup.date)),s.Cb(4),s.bd("",s.pc(7,6,"APPROVAL.GROUPS.TOTAL_TIME"),": "),s.Cb(3),s.bd(" ",s.qc(10,8,t.entryGroup.time,t.durationFormat)," "),s.Cb(2),s.wc("ngForOf",t.entryGroup.timeEntries))},directives:[i.t,Wj],pipes:[bv.a,g.e,dv.a],encapsulation:2,changeDetection:0}),e})();const Dj=["titleLabel"];function Pj(e,t){if(1&e&&(s.Xb(0,"span",10),s.Zc(1),s.Wb()),2&e){const e=s.nc().$implicit;s.Cb(1),s.bd(" - ",e.clientName,"")}}function Mj(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"tr"),s.Xb(2,"td"),s.Xb(3,"span",6),s.Sb(4,"i",7),s.Xb(5,"span"),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xc(8,Pj,2,1,"span",8),s.Wb(),s.Wb(),s.Xb(9,"td",4),s.Zc(10),s.oc(11,"timeFormat"),s.Wb(),s.Xb(12,"td",9),s.Zc(13),s.Wb(),s.Wb(),s.Ub()),2&e){const e=t.$implicit,n=s.nc();s.Cb(4),s.Wc("background",e.backgroundColor,s.Kb),s.Cb(2),s.ad(e.label?e.label:s.pc(7,6,"GLOBAL.WITHOUT_PROJECT_LABEL")),s.Cb(2),s.wc("ngIf",e.clientName),s.Cb(2),s.ad(s.qc(11,8,e.duration,n.durationFormat)),s.Cb(3),s.bd("",e.percentage,"%")}}let Bj=(()=>{class e{constructor(){}ngOnInit(){this.barChartDataWithPercentage=this.barChartData.map(e=>{const t=e.duration,n=new DA.a(t).asSeconds();return e.percentage=t?Number((n/this.totalDuration*100).toFixed(2)):0,e}),this.barChartDataWithPercentage.sort((e,t)=>{const n=e.percentage,i=t.percentage;return n>i?-1:n<i?1:0})}ngAfterViewInit(){this.titleLabel&&this.titleLabel.nativeElement.focus()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["chart-details-modal"]],viewQuery:function(e,t){var n;1&e&&s.gd(Dj,!0),2&e&&s.Kc(n=s.kc())&&(t.titleLabel=n.first)},inputs:{barChartData:"barChartData",title:"title",durationFormat:"durationFormat",totalDuration:"totalDuration"},decls:14,vars:8,consts:[[1,"cl-modal-body","cl-overflow-auto"],[1,"cl-m-0","tr-table-reset"],[1,"cl-pb-2"],["titleLabel",""],[1,"cl-text-right","cl-px-2"],[4,"ngFor","ngForOf"],[1,"cl-project-name"],[1,"cl-entry__project__dot"],["class","cl-text-gray-9",4,"ngIf"],[1,"cl-text-gray-9","cl-text-right"],[1,"cl-text-gray-9"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"table",1),s.Xb(2,"tr"),s.Xb(3,"th",2,3),s.Xb(5,"b"),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xb(8,"th",4),s.Xb(9,"b"),s.Zc(10),s.oc(11,"timeFormat"),s.Wb(),s.Wb(),s.Sb(12,"th",4),s.Wb(),s.Xc(13,Mj,14,11,"ng-container",5),s.Wb(),s.Wb()),2&e&&(s.Cb(6),s.ad(s.pc(7,3,"GLOBAL.PROJECTS_LABEL")),s.Cb(4),s.ad(s.qc(11,5,t.totalDuration,t.durationFormat)),s.Cb(3),s.wc("ngForOf",t.barChartDataWithPercentage))},directives:[i.t,i.u],pipes:[g.e,dv.a],encapsulation:2,changeDetection:0}),e})();function Uj(e,t){if(1&e&&s.Sb(0,"approval-detail-info",15),2&e){const e=s.nc();s.wc("details",e.approvalRequest)}}function Gj(e,t){if(1&e){const e=s.Yb();s.Xb(0,"bar-chart",16),s.jc("showAllBarValues",(function(t){s.Oc(e);const n=s.nc(),i=s.Lc(16);return n.openModalForBar(t,i)})),s.Wb()}if(2&e){const e=s.nc();s.wc("barChartData",e.barChartData)("barChartLabels",e.barChartLabels)("totalDurationByDate",e.totalDurationByDate)("projectCountByDate",e.projectCountByDate)("isBillabilityType",!1)("updateDataOnChartChange",!0)("canSeeRates",!0)("format",e.durationFormat)("currency",e.currency)("chartDataDurationUnit","seconds")}}function xj(e,t){if(1&e&&s.Sb(0,"doughnut-chart",17),2&e){const e=s.nc();s.wc("currency",e.currency)("format",e.durationFormat)("canSeeRates",!0)("tooltipToLeft",!1)("isBillabilityType",!1)("updateDataOnChartChange",!0)("doughnutChart",e.doughnutChart)("totalTime",e.totalTime)}}function Fj(e,t){if(1&e){const e=s.Yb();s.Xb(0,"chart-horizontal",18),s.jc("onLoadMore",(function(){return s.Oc(e),s.nc().loadMore()})),s.Wb()}if(2&e){const e=s.nc();s.wc("durationFormat",e.durationFormat)("totalLength",null==e.doughnutChartAll?null:e.doughnutChartAll.length)("chartData",e.doughnutChart)}}function jj(e,t){if(1&e&&(s.Vb(0),s.Sb(1,"approval-entry-group",19),s.Ub()),2&e){const e=t.$implicit,n=s.nc();s.Cb(1),s.wc("durationFormat",n.durationFormat)("entryGroup",e)("ownerTimeZone",n.approvalRequest.owner.timeZone)("customFields",n.customFields)("showApprovalStatus",!n.equalStatus&&n.approvalRequest.status.state===n.ApprovalStatus.PENDING)}}function Zj(e,t){if(1&e&&(s.Xb(0,"modal-header",20),s.jc("onClose",(function(){return t.$implicit.close()})),s.Wb(),s.Sb(1,"chart-details-modal",21)),2&e){const e=s.nc();s.wc("title",e.barChartLabels[e.selectedIndex]),s.Cb(1),s.wc("durationFormat",e.durationFormat)("totalDuration",e.totalDurationByDate[e.selectedIndex])("barChartData",e.selectedBarChartsData)}}let Vj=(()=>{class e{constructor(e,t,n,i,s,c,a,o){this.workspaceService=e,this.approvalService=t,this.route=n,this.customFieldService=i,this.cd=s,this.systemSettingsService=c,this.modalService=a,this.translationStore=o,this.ApprovalStatus=Ht,this.unsubscribe$=new p.a}ngOnInit(){this.id=this.route.snapshot.params.id,this.setWorkspace(),this.getDetailsData(),this.getDashboardData()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}setWorkspace(){this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.durationFormat=e.getTimeFormat(),this.currency=e.hourlyRate.currency,this.workspace=e,e.hasFeature(is.a.CUSTOM_FIELDS)&&this.getCustomFields()})}getDetailsData(){this.approvalService.getApprovalDetails(this.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.approvalRequest=e.approvalRequest,this.entryGroups=e.entryGroups,this.tableInfo=e.tableInfo,this.equalStatus=e.equalStatus,this.cd.markForCheck()})}getDashboardData(){const e=this.translationStore.getCurrentLang();this.approvalService.getApprovalDashboard(this.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{this.dates=t.dates,this.totalTime=t.totalTime;const n=t.barChartData.map(e=>new xF(e,this.totalTime));n.sort((e,t)=>e.percentage>t.percentage?-1:e.percentage<t.percentage||e.label>t.label?1:e.label<t.label?-1:void 0),this.doughnutChartAll=n,this.doughnutChart=this.doughnutChartAll.slice(0,10),this.barChartData=n.length?n:[new xF({})],this.barChartLabels=this.dates.map(t=>ke(t).locale(e).format("ddd, MMM D")),this.totalDurationByDate=t.totalDurationByDate.map(e=>new DA.a(e).asSeconds()),this.projectCountByDate=t.projectCountByDate,this.dateAndTotalTime=t.dateAndTotalTime,this.cd.detectChanges()})}openModalForBar(e,t){this.selectedIndex=e,this.selectedBarChartsData=this.dateAndTotalTime[this.dates[e]].map(e=>new xF(e,this.totalTime)),this.modalService.open(t,{centered:!0})}loadMore(){this.doughnutChart=this.doughnutChartAll.slice(0,this.doughnutChart.length+10),this.cd.detectChanges()}getCustomFields(){this.customFieldService.get().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.customFields=e,this.cd.detectChanges()})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(rn),s.Rb(k.a),s.Rb(UA.a),s.Rb(s.h),s.Rb(bn.a),s.Rb(w.q),s.Rb(Ra.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["approval-details-page"]],decls:17,vars:10,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],["class","cl-row cl-align-items-center",3,"details",4,"ngIf"],[1,"cl-card","cl-border-bottom"],[1,"cl-card-header","cl-px-0",3,"tableInfo","isCostRateActive","durationFormat","status","currency"],[1,"cl-card-body","cl-p-0"],[1,"cl-main-chart-wrapper"],["class","cl-main-chart-container cl-d-block",3,"barChartData","barChartLabels","totalDurationByDate","projectCountByDate","isBillabilityType","updateDataOnChartChange","canSeeRates","format","currency","chartDataDurationUnit","showAllBarValues",4,"ngIf"],[1,"cl-main-chart-container"],[1,"cl-row"],["class","cl-col-md-4 cl-mb-3 cl-mb-md-0",3,"currency","format","canSeeRates","tooltipToLeft","isBillabilityType","updateDataOnChartChange","doughnutChart","totalTime",4,"ngIf"],["class","cl-col-md-8",3,"durationFormat","totalLength","chartData","onLoadMore",4,"ngIf"],[4,"ngFor","ngForOf"],["chartModal",""],[1,"cl-row","cl-align-items-center",3,"details"],[1,"cl-main-chart-container","cl-d-block",3,"barChartData","barChartLabels","totalDurationByDate","projectCountByDate","isBillabilityType","updateDataOnChartChange","canSeeRates","format","currency","chartDataDurationUnit","showAllBarValues"],[1,"cl-col-md-4","cl-mb-3","cl-mb-md-0",3,"currency","format","canSeeRates","tooltipToLeft","isBillabilityType","updateDataOnChartChange","doughnutChart","totalTime"],[1,"cl-col-md-8",3,"durationFormat","totalLength","chartData","onLoadMore"],[1,"cl-d-block","cl-card","cl-border-bottom",3,"durationFormat","entryGroup","ownerTimeZone","customFields","showApprovalStatus"],[3,"title","onClose"],[3,"durationFormat","totalDuration","barChartData"]],template:function(e,t){1&e&&(s.Xb(0,"main",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xc(3,Uj,1,1,"approval-detail-info",3),s.Wb(),s.Xb(4,"div",4),s.Sb(5,"approval-table-header",5),s.Xb(6,"div",6),s.Xb(7,"div",7),s.Xc(8,Gj,1,10,"bar-chart",8),s.Wb(),s.Xb(9,"div",7),s.Xb(10,"div",9),s.Xb(11,"div",10),s.Xc(12,xj,1,8,"doughnut-chart",11),s.Xc(13,Fj,1,3,"chart-horizontal",12),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(14,jj,2,5,"ng-container",13),s.Wb(),s.Wb(),s.Xc(15,Zj,2,4,"ng-template",null,14,s.Yc)),2&e&&(s.Cb(3),s.wc("ngIf",t.approvalRequest),s.Cb(2),s.wc("tableInfo",t.tableInfo)("isCostRateActive",null==t.workspace?null:t.workspace.isCostRateActive)("durationFormat",t.durationFormat)("status",null==t.approvalRequest||null==t.approvalRequest.status?null:t.approvalRequest.status.state)("currency",t.currency),s.Cb(3),s.wc("ngIf",t.barChartData),s.Cb(4),s.wc("ngIf",t.doughnutChart),s.Cb(1),s.wc("ngIf",t.doughnutChart),s.Cb(1),s.wc("ngForOf",t.entryGroups))},directives:[i.u,HF,i.t,uj,ya.a,_a.a,Oj,Nj,Wd.a,Bj],encapsulation:2,changeDetection:0}),e})();var Yj=function(e){return e.PAYMENT="PAYMENT",e.INVOICES="INVOICES",e.PLANS="PLANS",e}({}),Hj=function(e){return e.NONE_SELECTED="NONE_SELECTED",e.NO_LONGER_NEED="NO_LONGER_NEED",e.TOO_COMPLICATED="TOO_COMPLICATED",e.LACKED_FEATURES="LACKED_FEATURES",e.NEED_OTHER_INTEGRATIONS="NEED_OTHER_INTEGRATIONS",e.TOO_EXPENSIVE="TOO_EXPENSIVE",e.TECHNICAL_ISSUES="TECNICAL_ISSUES",e.NOT_GOOD_FIT="NOT_GOOD_FIT",e}({}),$j=n("AytR");function Kj(e,t){1&e&&(s.Xb(0,"div",9),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"a",10),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"span"),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Xb(10,"a",11),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.bd("",s.pc(3,4,"GLOBAL.NEED_HELP"),"? "),s.Cb(3),s.bd("",s.pc(6,6,"GLOBAL.CONTACT_SUPPORT_LABEL")," "),s.Cb(3),s.bd("",s.pc(9,8,"SHARED_FOLDER.SUPPORT_PART_2")," "),s.Cb(3),s.ad(s.pc(12,10,"SHARED_FOLDER.SUPPORT_PART_3")))}let qj=(()=>{class e{constructor(e,t,n){this.analyticsService=e,this.modalService=t,this.closeModal=new s.n,this.openCancelSubscriptionReasonModal=new s.n}ngOnInit(){this.isForbiddenZone=In.g.includes(ke.tz.guess())}close(){this.closeModal.emit(!0)}openModal(e){this.modalService.open(e,{centered:!0})}continue(){this.analyticsService.addEvent(new Fi.a({event:"submit",value:"continue",section:"Subscription",section2:"Cancel Subscription"})),this.openCancelReasonModal()}openCancelReasonModal(){this.openCancelSubscriptionReasonModal.emit(!0),this.close()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(xi.a),s.Rb(w.q),s.Rb(v.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["cancel-subscription"]],outputs:{closeModal:"closeModal",openCancelSubscriptionReasonModal:"openCancelSubscriptionReasonModal"},decls:19,vars:13,consts:[[1,"cl-modal-body","cl-text-center","cl-py-4"],["class","cl-d-block cl-alert cl-alert-primary cl-alert-reset-main cl-fade cl-show cl-mb-2 cl-text-left cl-p-2",4,"ngIf"],[1,"cl-mb-3"],["src","assets/images/illustrations/cancel-subscription.svg",1,"cl-img-fluid"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-list-unstyled","cl-ml-0","cl-mb-0","cl-text-gray-6"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-d-block","cl-alert","cl-alert-primary","cl-alert-reset-main","cl-fade","cl-show","cl-mb-2","cl-text-left","cl-p-2"],["href","https://clockify.me/help/contact","target","_blank",1,"cl-font-weight-bold"],["href","https://clockify.me/help/contact/sales","target","_blank",1,"cl-font-weight-bold"]],template:function(e,t){1&e&&(s.Xb(0,"div"),s.Xb(1,"div",0),s.Xc(2,Kj,13,12,"div",1),s.Xb(3,"div",2),s.Sb(4,"img",3),s.Wb(),s.Xb(5,"div",4),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"ul",5),s.Xb(9,"li"),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(12,"div",6),s.Xb(13,"a",7),s.jc("click",(function(){return t.close()})),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Xb(16,"button",8),s.jc("click",(function(){return t.continue()})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.wc("ngIf",!t.isForbiddenZone),s.Cb(4),s.ad(s.pc(7,5,"GLOBAL.CANCEL_SUBSCRIPTION_LABEL")),s.Cb(4),s.ad(s.pc(11,7,"SHARED_FOLDER.SUBSCRIPTION_END_LOSE_FEATURES_WARNING")),s.Cb(4),s.ad(s.pc(15,9,"SHARED_FOLDER.KEEP_SUBSCRIPTION")),s.Cb(3),s.bd("",s.pc(18,11,"GLOBAL.CONTINUE_BTN")," "))},directives:[i.u],pipes:[g.e],encapsulation:2}),e})();class zj{constructor(e,t,n){this._id=e,this._name=t,this._text=n}get id(){return this._id}get name(){return this._name}get text(){return this._text}set id(e){this._id=e}set name(e){this._name=e}set text(e){this._text=e}}function Qj(e,t){1&e&&(s.Xb(0,"div",15),s.Xb(1,"div",16),s.Xb(2,"span"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.bd(" ",s.pc(4,1,"PAGES.FEATURES.PLAN.LEGACY.INFO_MESSAGE")," "))}function Jj(e,t){if(1&e&&(s.Xb(0,"div"),s.Xb(1,"div",17),s.Sb(2,"input",18),s.Xb(3,"label",19),s.Zc(4),s.oc(5,"translate"),s.Xb(6,"span",20),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e){const e=t.$implicit;s.Cb(2),s.wc("id",e.name)("value",e),s.Cb(1),s.wc("for",e.name),s.Cb(1),s.bd(" ",s.pc(5,6,e.text1)," "),s.Cb(3),s.bd(" ",s.pc(8,8,e.text2),""),s.Cb(2),s.bd(" ",s.pc(10,10,e.text3)," ")}}let eZ=(()=>{class e{constructor(e,t,n){this.translate=e,this.analyticsService=t,this.openConfirmCancellationModal=new s.n,this.closeModal=new s.n,this.cancellationReasons=[{id:1,name:Hj.NO_LONGER_NEED,text1:"",text2:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.NO_LONGER_NEED.TEXT2",text3:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.NO_LONGER_NEED.TEXT3"},{id:2,name:Hj.TOO_COMPLICATED,text1:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.TOO_COMPLICATED.TEXT1",text2:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.TOO_COMPLICATED.TEXT2",text3:""},{id:3,name:Hj.LACKED_FEATURES,text1:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.LACKED_FEATURES.TEXT1",text2:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.LACKED_FEATURES.TEXT2",text3:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.LACKED_FEATURES.TEXT3"},{id:4,name:Hj.NEED_OTHER_INTEGRATIONS,text1:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.OTHER_INTEGRATIONS.TEXT1",text2:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.OTHER_INTEGRATIONS.TEXT2",text3:""},{id:5,name:Hj.TOO_EXPENSIVE,text1:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.TOO_EXPENSIVE.TEXT1",text2:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.TOO_EXPENSIVE.TEXT2",text3:""},{id:6,name:Hj.TECHNICAL_ISSUES,text1:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.TECHNICAL_ISSUES.TEXT1",text2:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.TECHNICAL_ISSUES.TEXT2",text3:""},{id:7,name:Hj.NOT_GOOD_FIT,text1:"",text2:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.NOT_GOOD_FIT.TEXT2",text3:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.NOT_GOOD_FIT.TEXT3"}],this.form=n.group({cancellationReason:["",v.G.required]})}ngOnInit(){this.subscribeToCancellationReasonChange()}close(){this.closeModal.emit(!0)}subscribeToCancellationReasonChange(){this.form.valueChanges.subscribe(e=>{const t=e.cancellationReason,n=t.text1?this.translate.instant(t.text1):"",i=t.text2?this.translate.instant(t.text2):"",s=t.text3?this.translate.instant(t.text3):"";this.reason=new zj(t.id,t.name,n+i+s)})}openNextModal(){var e;this.analyticsService.addEvent(new Fi.a({event:"submit",uevent:"submit",value:(null===(e=this.reason)||void 0===e?void 0:e.id)?this.reason.id+" - "+this.reason.name:"0",section:"Subscription",section2:"Cancel Subscription",section4:"page1"})),this.openConfirmCancellationModal.emit(this.reason),this.close()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(g.f),s.Rb(xi.a),s.Rb(v.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["cancel-subscription-reason-modal"]],inputs:{isLegacy:"isLegacy"},outputs:{openConfirmCancellationModal:"openConfirmCancellationModal",closeModal:"closeModal"},decls:27,vars:18,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],["class","cl-mb-3",4,"ngIf"],[3,"formGroup"],[1,"cl-form-row"],[1,"cl-form-group","cl-col-lg-custom-12"],[1,"cl-form-group","cl-d-block"],[4,"ngFor","ngForOf"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],[1,"cl-btn","cl-btn-primary",3,"title","click"],[1,"cl-mb-3"],[1,"cl-alert","cl-alert-warning","cl-fade","cl-show","cl-mb-2","cl-text-left","cl-p-2"],[1,"cl-custom-control","cl-custom-radio","cl-d-block","cl-margin-bottom"],["type","radio","formControlName","cancellationReason",1,"cl-custom-control-input",3,"id","value"],[1,"cl-custom-control-label",3,"for"],[1,"cl-font-weight-bolder"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.close()})),s.Xb(5,"span",3),s.Sb(6,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",5),s.Xc(8,Qj,5,3,"div",6),s.Xb(9,"div"),s.Xb(10,"form",7),s.Xb(11,"div",8),s.Xb(12,"div",9),s.Xb(13,"span"),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(16,"div",10),s.Xc(17,Jj,11,12,"div",11),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(18,"div",12),s.Xb(19,"a",13),s.jc("click",(function(){return t.close()})),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Xb(22,"div"),s.Xb(23,"button",14),s.jc("click",(function(){return t.openNextModal()})),s.oc(24,"translate"),s.Zc(25),s.oc(26,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,8,"GLOBAL.CANCEL_SUBSCRIPTION_LABEL")),s.Cb(6),s.wc("ngIf",t.isLegacy),s.Cb(2),s.wc("formGroup",t.form),s.Cb(4),s.bd("",s.pc(15,10,"SHARED_FOLDER.CANCEL_REASON_LABEL"),":"),s.Cb(3),s.wc("ngForOf",t.cancellationReasons),s.Cb(3),s.ad(s.pc(21,12,"GLOBAL.NEVERMIND_CANCEL_BTN")),s.Cb(3),s.wc("title",s.pc(24,14,"SHARED_FOLDER.SUPPORT_PART_1")),s.Cb(2),s.bd(" ",s.pc(26,16,"GLOBAL.NEXT_LABEL")," "))},directives:[i.u,v.I,v.t,v.k,i.t,v.A,v.c,v.s,v.i],pipes:[g.e],encapsulation:2}),e})();var tZ=function(e){return e.NOT_USING_IT_ENOUGH="NOT_USING_IT_ENOUGH",e.DONT_NEED_IT_TEMPORARILY="DONT_NEED_IT_TEMPORARILY",e}({});function nZ(e,t){if(1&e&&(s.Xb(0,"div"),s.Xb(1,"div",18),s.Sb(2,"input",19),s.Xb(3,"label",20),s.Zc(4),s.oc(5,"translate"),s.Xb(6,"span",21),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e){const e=t.$implicit;s.Cb(2),s.wc("id",e.name)("value",e),s.Cb(1),s.wc("for",e.name),s.Cb(1),s.bd(" ",s.pc(5,5,e.text1)," "),s.Cb(3),s.bd(" ",s.pc(8,7,e.text2)," ")}}let iZ=(()=>{class e{constructor(e,t){this.translate=e,this.cancelSubscription=new s.n,this.closeModal=new s.n,this.reason="0",this.reasons=[{id:1,name:tZ.DONT_NEED_IT_TEMPORARILY,text1:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.NO_LONGER_NEED.REASON1.TEXT1",text2:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.NO_LONGER_NEED.REASON1.TEXT2"},{id:2,name:tZ.NOT_USING_IT_ENOUGH,text1:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.NO_LONGER_NEED.REASON2.TEXT1",text2:"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.NO_LONGER_NEED.REASON2.TEXT2"}],this.form=t.group({reason:["",v.G.required]})}ngOnInit(){this.subscribeToNoLongerReasonChange()}close(){this.closeModal.emit(!0)}subscribeToNoLongerReasonChange(){this.form.valueChanges.subscribe(e=>{this.reason=e.reason.id+" - "+this.translate.instant(e.reason.text1)+this.translate.instant(e.reason.text2)})}setAdditionalMessage(e){e.target.value&&(this.additionalMessage=e.target.value)}cancelPaymentSubscription(){this.cancelSubscription.emit(this.reason+", 0, "+(this.additionalMessage?this.additionalMessage:"0"))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(g.f),s.Rb(v.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["no-longer-need-modal"]],outputs:{cancelSubscription:"cancelSubscription",closeModal:"closeModal"},decls:35,vars:21,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[3,"formGroup"],[1,"cl-form-row"],[1,"cl-form-group","cl-mb-0","cl-col-lg-custom-12"],[1,"cl-margin-bottom-lg"],[1,"cl-form-group","cl-d-block"],[4,"ngFor","ngForOf"],[1,"cl-form-group","cl-mb-0","cl-col-lg-custom-12","cl-margin-top-sm"],[1,"cl-form-group","cl-mb-0"],["rows","4","name","additionalMessage",1,"cl-form-control",3,"ngModel","ngModelChange","blur"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],[1,"cl-btn","cl-btn-primary",3,"title","click"],[1,"cl-custom-control","cl-custom-radio","cl-d-block","cl-margin-bottom"],["type","radio","formControlName","reason",1,"cl-custom-control-input",3,"id","value"],[1,"cl-custom-control-label",3,"for"],[1,"cl-font-weight-bolder"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.close()})),s.Xb(5,"span",3),s.Sb(6,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",5),s.Xb(8,"div"),s.Xb(9,"form",6),s.Xb(10,"div",7),s.Xb(11,"div",8),s.Xb(12,"p",9),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(15,"div",10),s.Xc(16,nZ,9,9,"div",11),s.Wb(),s.Wb(),s.Sb(17,"hr"),s.Xb(18,"div",7),s.Xb(19,"div",12),s.Xb(20,"p",9),s.Zc(21),s.oc(22,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(23,"div",13),s.Xb(24,"textarea",14),s.jc("ngModelChange",(function(e){return t.additionalMessage=e}))("blur",(function(e){return t.setAdditionalMessage(e)})),s.Zc(25,"            "),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(26,"div",15),s.Xb(27,"a",16),s.jc("click",(function(){return t.close()})),s.Zc(28),s.oc(29,"translate"),s.Wb(),s.Xb(30,"div"),s.Xb(31,"button",17),s.jc("click",(function(){return t.cancelPaymentSubscription()})),s.oc(32,"translate"),s.Zc(33),s.oc(34,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,9,"GLOBAL.CONFIRM_CANCELLATION_LABEL")),s.Cb(7),s.wc("formGroup",t.form),s.Cb(4),s.bd(" ",s.pc(14,11,"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.REASON_MESSAGE"),""),s.Cb(3),s.wc("ngForOf",t.reasons),s.Cb(5),s.bd("",s.pc(22,13,"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.ADDITIONAL_MESSAGE")," "),s.Cb(3),s.wc("ngModel",t.additionalMessage),s.Cb(4),s.ad(s.pc(29,15,"GLOBAL.NEVERMIND_CANCEL_BTN")),s.Cb(3),s.wc("title",s.pc(32,17,"SHARED_FOLDER.SUPPORT_PART_1")),s.Cb(2),s.bd("",s.pc(34,19,"GLOBAL.CANCEL_SUBSCRIPTION_LABEL")," "))},directives:[v.I,v.t,v.k,i.t,v.c,v.s,v.v,v.A,v.i],pipes:[g.e],encapsulation:2}),e})();function sZ(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",6),s.Xb(1,"div",7),s.Xb(2,"p"),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Xb(5,"div",24),s.Xb(6,"dropdown-items",25),s.jc("onChanged",(function(t){return s.Oc(e),s.nc().selectOtherTool(t)})),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.ad(s.pc(4,4,"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.ANOTHER_TOOL_MSG2")),s.Cb(3),s.wc("list",e.otherTools)("initLabel",s.pc(7,6,"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.SELECT_TOOL"))("value",e.selectedOtherTool)}}let cZ=(()=>{class e{constructor(e){this.translate=e,this.cancelSubscription=new s.n,this.closeModal=new s.n,this.movingToAnotherToolParameter="0",this.anotherToolNameParameter="0",this.otherTools=[new Un.a("1","In-house solution"),new Un.a("2","Clickup"),new Un.a("3","Harvest"),new Un.a("4","Toggl"),new Un.a("5","QuickBooks"),new Un.a("6","Monday"),new Un.a("7","Gusto"),new Un.a("8","Hubstaff"),new Un.a("9","Other")]}ngOnInit(){this.setAdditionalMessageQuestion()}close(){this.closeModal.emit(!0)}setMovingToAnotherTool(e){e?this.movingToAnotherToolParameter="1 - Yes":(this.movingToAnotherToolParameter="2 - No",this.anotherToolNameParameter="0")}selectOtherTool(e){const t=this.otherTools.find(t=>t.value===e);this.anotherToolNameParameter=t.value+" - "+t.label}cancelPaymentSubscription(){this.cancelSubscription.emit(this.reason.id+" - "+this.reason.text+", "+this.movingToAnotherToolParameter+", "+this.anotherToolNameParameter+", "+(this.additionalMessage?this.additionalMessage:"0"))}setAdditionalMessage(e){e.target.value&&(this.additionalMessage=e.target.value)}setAdditionalMessageQuestion(){var e;switch(null===(e=this.reason)||void 0===e?void 0:e.name){case Hj.LACKED_FEATURES:this.additionalMessageQuestion=this.translate.instant("GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.QUESTION1");break;case Hj.NEED_OTHER_INTEGRATIONS:this.additionalMessageQuestion=this.translate.instant("GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.QUESTION2");break;case Hj.TOO_EXPENSIVE:this.additionalMessageQuestion=this.translate.instant("GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.QUESTION3");break;case Hj.TECHNICAL_ISSUES:this.additionalMessageQuestion=this.translate.instant("GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.QUESTION4");break;case Hj.NOT_GOOD_FIT:this.additionalMessageQuestion=this.translate.instant("GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.QUESTION5");break;default:this.additionalMessageQuestion=this.translate.instant("GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.IMPROVE_MSG")}}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["other-reasons-modal"]],inputs:{reason:"reason"},outputs:{cancelSubscription:"cancelSubscription",closeModal:"closeModal"},decls:42,vars:28,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-row"],[1,"cl-form-group","cl-mb-0","cl-col-lg-custom-12"],[1,"cl-margin-bottom-lg"],[1,"cl-form-group","cl-d-block"],[1,"cl-custom-control","cl-custom-radio","cl-margin-bottom"],["type","radio","id","moving","name","movingToAnotherTool",1,"cl-custom-control-input",3,"value","ngModel","ngModelChange","click"],["for","moving",1,"cl-custom-control-label"],[1,"cl-custom-control","cl-custom-radio"],["type","radio","id","notMoving","name","movingToAnotherTool",1,"cl-custom-control-input",3,"value","ngModel","ngModelChange","change"],["for","notMoving",1,"cl-custom-control-label"],["class","cl-form-row",4,"ngIf"],[1,"cl-form-group","cl-mb-0","cl-col-lg-custom-12","cl-margin-top-sm"],[1,"cl-margin-bottom-lg",3,"innerHTML"],[1,"cl-form-group","cl-mb-0"],["rows","4","name","additionalMessage",1,"cl-form-control",3,"ngModel","ngModelChange","blur"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],[1,"cl-btn","cl-btn-primary",3,"title","click"],[1,"cl-form-group","cl-col-lg-custom-4"],[1,"cl-d-inline-block","cl-w-100",3,"list","initLabel","value","onChanged"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.close()})),s.Xb(5,"span",3),s.Sb(6,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",5),s.Xb(8,"form"),s.Xb(9,"div",6),s.Xb(10,"div",7),s.Xb(11,"p",8),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(14,"div",9),s.Xb(15,"div",10),s.Xb(16,"input",11),s.jc("ngModelChange",(function(e){return t.movingToAnotherTool=e}))("click",(function(){return t.setMovingToAnotherTool(!0)})),s.Wb(),s.Xb(17,"label",12),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Wb(),s.Xb(20,"div",13),s.Xb(21,"input",14),s.jc("ngModelChange",(function(e){return t.movingToAnotherTool=e}))("change",(function(){return t.setMovingToAnotherTool(!1)})),s.Wb(),s.Xb(22,"label",15),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xc(25,sZ,8,8,"div",16),s.Wb(),s.Sb(26,"hr"),s.Xb(27,"div",6),s.Xb(28,"div",17),s.Sb(29,"p",18),s.Wb(),s.Wb(),s.Xb(30,"div",19),s.Xb(31,"textarea",20),s.jc("ngModelChange",(function(e){return t.additionalMessage=e}))("blur",(function(e){return t.setAdditionalMessage(e)})),s.Zc(32,"        "),s.Wb(),s.Wb(),s.Wb(),s.Xb(33,"div",21),s.Xb(34,"a",22),s.jc("click",(function(){return t.close()})),s.Zc(35),s.oc(36,"translate"),s.Wb(),s.Xb(37,"div"),s.Xb(38,"button",23),s.jc("click",(function(){return t.cancelPaymentSubscription()})),s.oc(39,"translate"),s.Zc(40),s.oc(41,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,14,"GLOBAL.CONFIRM_CANCELLATION_LABEL")),s.Cb(10),s.ad(s.pc(13,16,"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.ANOTHER_TOOL_MSG1")),s.Cb(4),s.wc("value",!0)("ngModel",t.movingToAnotherTool),s.Cb(2),s.ad(s.pc(19,18,"GLOBAL.CONFIRM_LABEL")),s.Cb(3),s.wc("value",!1)("ngModel",t.movingToAnotherTool),s.Cb(2),s.ad(s.pc(24,20,"GLOBAL.NO_LABEL")),s.Cb(2),s.wc("ngIf",t.movingToAnotherTool),s.Cb(4),s.wc("innerHTML",t.additionalMessageQuestion,s.Pc),s.Cb(2),s.wc("ngModel",t.additionalMessage),s.Cb(4),s.ad(s.pc(36,22,"GLOBAL.NEVERMIND_CANCEL_BTN")),s.Cb(3),s.wc("title",s.pc(39,24,"SHARED_FOLDER.SUPPORT_PART_1")),s.Cb(2),s.bd("",s.pc(41,26,"GLOBAL.CANCEL_SUBSCRIPTION_LABEL")," "))},directives:[v.I,v.t,v.u,v.A,v.c,v.s,v.v,i.u,ji.a],pipes:[g.e],encapsulation:2}),e})(),aZ=(()=>{class e{constructor(){this.cancelSubscription=new s.n,this.closeModal=new s.n}ngOnInit(){}close(){this.closeModal.emit(!0)}cancelPaymentSubscription(){this.cancelSubscription.emit("0, 0, "+(this.additionalMessage?this.additionalMessage:"0"))}setAdditionalMessage(e){e.target.value&&(this.additionalMessage=e.target.value)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["no-reason-selected-modal"]],outputs:{cancelSubscription:"cancelSubscription",closeModal:"closeModal"},decls:25,vars:16,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-form-row"],[1,"cl-form-group","cl-mb-0","cl-col-lg-custom-12"],[1,"cl-margin-bottom-lg"],["rows","4","name","additionalMessage",1,"cl-form-control",3,"ngModel","ngModelChange","blur"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],[1,"cl-btn","cl-btn-primary",3,"title","click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.close()})),s.Xb(5,"span",3),s.Sb(6,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",5),s.Xb(8,"form"),s.Xb(9,"div",6),s.Xb(10,"div",7),s.Xb(11,"p",8),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Xb(14,"div",7),s.Xb(15,"textarea",9),s.jc("ngModelChange",(function(e){return t.additionalMessage=e}))("blur",(function(e){return t.setAdditionalMessage(e)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(16,"div",10),s.Xb(17,"a",11),s.jc("click",(function(){return t.close()})),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Xb(20,"div"),s.Xb(21,"button",12),s.jc("click",(function(){return t.cancelPaymentSubscription()})),s.oc(22,"translate"),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,6,"GLOBAL.CONFIRM_CANCELLATION_LABEL")),s.Cb(10),s.bd(" ",s.pc(13,8,"GLOBAL.SUBSCRIPTION.CANCELLATION_REASON.IMPROVE_MSG")," "),s.Cb(3),s.wc("ngModel",t.additionalMessage),s.Cb(3),s.ad(s.pc(19,10,"GLOBAL.NEVERMIND_CANCEL_BTN")),s.Cb(3),s.wc("title",s.pc(22,12,"SHARED_FOLDER.SUPPORT_PART_1")),s.Cb(2),s.bd("",s.pc(24,14,"GLOBAL.CANCEL_SUBSCRIPTION_LABEL")," "))},directives:[v.I,v.t,v.u,v.c,v.s,v.v],pipes:[g.e],encapsulation:2}),e})();const oZ=["successModal"],rZ=["featuresInfoModal"],lZ=["upgradeModal"],bZ=["userSeatsModal"],dZ=["pumbleCoupon"],uZ=["subscriptionFailedModal"],pZ=["cancelSubscriptionReason"],hZ=["otherReasons"],mZ=["noLongerNeed"],gZ=["noReasonSelected"];function EZ(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",46),s.Xb(1,"div",47),s.Xb(2,"div",48),s.Xb(3,"div",49),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"a",50),s.jc("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(8);return t.openModal(n),t.generatePumbleCoupon()})),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Xb(9,"div",51),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Wb(),s.Xb(12,"div",52),s.Sb(13,"img",53),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.Cb(4),s.ad(s.pc(5,3,"PUMBLE_COUPON.EXCLUSIVE_OFFER")),s.Cb(3),s.ad(s.pc(8,5,"PUMBLE_COUPON.DISCOUNT")),s.Cb(3),s.ad(s.pc(11,7,"PUMBLE_COUPON.PUMBLE_PRO")))}const fZ=function(e){return{date:e}};function SZ(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",54),s.Zc(1),s.oc(2,"lowercase"),s.oc(3,"translate"),s.oc(4,"translate"),s.Xb(5,"a",55),s.jc("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(20);return t.cancelSubscription(n)})),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(1),s.dd(" ",null==e.nextSubscriptionType?null:e.nextSubscriptionType.title," (",s.pc(2,4,s.pc(3,6,-1===(null==e.nextSubscriptionType?null:e.nextSubscriptionType.value.indexOf("YEAR"))?"GLOBAL.MONTHLY_LABEL":"SUBSCRIPTION_TABS.SHARED.PAY_ANNUAL_LABEL")),") ",s.qc(4,8,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.PAY_MONTHLY_LABEL_PART_2",s.Bc(13,fZ,e.nextBillingDate)),". "),s.Cb(5),s.ad(s.pc(7,11,"GLOBAL.CANCEL_BTN"))}}function CZ(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",55),s.jc("click",(function(){s.Oc(e);const t=s.nc(3),n=s.Lc(10);return t.openReactivateDialog(n)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.REACTIVATE_BUTTON")))}function AZ(e,t){if(1&e&&(s.Xb(0,"div",56),s.Zc(1),s.oc(2,"translate"),s.Xc(3,CZ,3,3,"a",57),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.pc(2,2,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.CANCELED_WARNING"),""),s.Cb(2),s.wc("ngIf",!e.currentPaymentType.legacy)}}function OZ(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",56),s.Zc(1),s.oc(2,"translate"),s.Xb(3,"a",55),s.jc("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(6);return t.openEditPaymentInfo(n)})),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,2,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.PAYMENT_FAILED_WARNING")," "),s.Cb(3),s.ad(s.pc(5,4,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.RETRY_PAYMENT_LABEL")))}function vZ(e,t){1&e&&(s.Xb(0,"span"),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.CURRENT_PLAN_PART_2_CANCELED")))}function TZ(e,t){1&e&&(s.Xb(0,"span",58),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.CURRENT_PLAN_PART_2_LEGACY")))}function IZ(e,t){if(1&e&&(s.Xb(0,"span",59),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.pc(2,1,e.isMonthly?"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.MONTHLY_BILLING_LABEL":"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.ANNUAL_BILLING_LABEL")," ")}}function wZ(e,t){1&e&&(s.Xb(0,"span",59),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.FOREVER_BILLING_LABEL")," "))}function LZ(e,t){if(1&e){const e=s.Yb();s.Xb(0,"span"),s.Xb(1,"a",60),s.jc("click",(function(){return s.Oc(e),s.nc(2).upgradeYearly()})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.ad(s.pc(3,1,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.SAVE_ANNUAL_INFO")))}function RZ(e,t){if(1&e&&(s.Xb(0,"span",61),s.Zc(1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.ad("."+(e.payment.amount?e.payment.amount.toString().split(".")[1]?e.payment.amount.toString().split(".")[1]:"00":e.currentPaymentType.fullPrice.toString().split(".")[1]))}}function yZ(e,t){if(1&e&&(s.Xb(0,"div",62),s.Xb(1,"div"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"div"),s.Zc(5),s.Wb(),s.Wb()),2&e){const e=s.nc(2);s.Cb(2),s.bd(" ",s.pc(3,2,e.payment.paid?"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.NEXT_BILLING_DATE_LABEL":"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.EXPIRE_DATE_LABEL")," "),s.Cb(3),s.ad(e.nextBillingDate)}}const _Z=function(e){return{"cl-disabled cl-text-dark":e}},kZ=function(e,t){return{count:e,length:t}};function WZ(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div"),s.Sb(1,"hr"),s.Xb(2,"div",63),s.Xb(3,"span"),s.Xb(4,"span"),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Xb(7,"a",64),s.jc("click",(function(){return s.Oc(e),s.nc(2).openFeaturesInfo("user-seats")})),s.Sb(8,"img",65),s.Wb(),s.Wb(),s.Xb(9,"span"),s.Xb(10,"span",66),s.oc(11,"translate"),s.Xb(12,"a",67),s.jc("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(16);return t.isAddingSeats=!1,t.openModal(n)})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Zc(15," / "),s.Xb(16,"a",68),s.jc("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(16);return t.isAddingSeats=!0,t.openModal(n)})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(19,"div",69),s.Sb(20,"div",70),s.Wb(),s.Xb(21,"p",71),s.Zc(22),s.oc(23,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(5),s.ad(s.pc(6,12,"GLOBAL.USER_SEATS_TITLE")),s.Cb(5),s.xc("title",e.isUsedAllSeats?s.pc(11,14,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.REMOVE_USER_TOOLTIP"):""),s.Cb(2),s.wc("ngClass",s.Bc(23,_Z,e.isUsedAllSeats)),s.Cb(1),s.ad(s.pc(14,16,"GLOBAL.REMOVE_LABEL")),s.Cb(4),s.ad(s.pc(18,18,"GLOBAL.ADD_LABEL")),s.Cb(3),s.Wc("width",e.percentage+"%"),s.Hb("cl-progress-bar-success-blue",!e.isUsedAllSeats)("cl-bg-danger",e.isUsedAllSeats),s.Cb(2),s.bd(" ",s.qc(23,20,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.ACTIVE_MEMEBERS_OF_PAID_LABEL",s.Cc(25,kZ,e.activeMembers,e.payment.quantity))," ")}}function XZ(e,t){1&e&&(s.Xb(0,"ul",72),s.Xb(1,"li"),s.mc(),s.Xb(2,"svg",73),s.Sb(3,"path",74),s.Wb(),s.lc(),s.Xb(4,"span"),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Xb(7,"li"),s.mc(),s.Xb(8,"svg",73),s.Sb(9,"path",74),s.Wb(),s.lc(),s.Xb(10,"span"),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb(),s.Xb(13,"li"),s.mc(),s.Xb(14,"svg",73),s.Sb(15,"path",74),s.Wb(),s.lc(),s.Xb(16,"span"),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb(),s.Xb(19,"li"),s.mc(),s.Xb(20,"svg",73),s.Sb(21,"path",74),s.Wb(),s.lc(),s.Xb(22,"span"),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Wb(),s.Xb(25,"li"),s.mc(),s.Xb(26,"svg",73),s.Sb(27,"path",74),s.Wb(),s.lc(),s.Xb(28,"span"),s.Zc(29),s.oc(30,"translate"),s.Wb(),s.Wb(),s.Xb(31,"li"),s.mc(),s.Xb(32,"svg",73),s.Sb(33,"path",74),s.Wb(),s.lc(),s.Xb(34,"span"),s.Zc(35),s.oc(36,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(5),s.ad(s.pc(6,6,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.FREE_PLAN_FEATURES.TRACKING")),s.Cb(6),s.ad(s.pc(12,8,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.FREE_PLAN_FEATURES.USERS")),s.Cb(6),s.ad(s.pc(18,10,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.FREE_PLAN_FEATURES.PROJECTS")),s.Cb(6),s.ad(s.pc(24,12,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.FREE_PLAN_FEATURES.REPORTS")),s.Cb(6),s.ad(s.pc(30,14,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.FREE_PLAN_FEATURES.APPS")),s.Cb(6),s.ad(s.pc(36,16,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.FREE_PLAN_FEATURES.API")))}function NZ(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",64),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(4).openFeaturesInfo(t.type)})),s.Sb(1,"img",65),s.Wb()}}function DZ(e,t){if(1&e&&(s.Xb(0,"li"),s.mc(),s.Xb(1,"svg",73),s.Sb(2,"path",74),s.Wb(),s.lc(),s.Xb(3,"span"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,NZ,2,0,"a",76),s.Wb()),2&e){const e=t.$implicit;s.Cb(4),s.ad(s.pc(5,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function PZ(e,t){if(1&e&&(s.Vb(0),s.Xc(1,DZ,7,4,"li",75),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",e.PLUS_FEATURES_TYPES)}}function MZ(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",64),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(4).openFeaturesInfo(t.type)})),s.Sb(1,"img",65),s.Wb()}}function BZ(e,t){if(1&e&&(s.Xb(0,"li"),s.mc(),s.Xb(1,"svg",73),s.Sb(2,"path",74),s.Wb(),s.lc(),s.Xb(3,"span"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,MZ,2,0,"a",76),s.Wb()),2&e){const e=t.$implicit;s.Cb(4),s.ad(s.pc(5,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function UZ(e,t){if(1&e&&(s.Vb(0),s.Xc(1,BZ,7,4,"li",75),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",e.PREMIUM_FEATURES_TYPES)}}function GZ(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",64),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(4).openFeaturesInfo(t.type)})),s.Sb(1,"img",65),s.Wb()}}function xZ(e,t){if(1&e&&(s.Xb(0,"li"),s.mc(),s.Xb(1,"svg",73),s.Sb(2,"path",74),s.Wb(),s.lc(),s.Xb(3,"span"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,GZ,2,0,"a",76),s.Wb()),2&e){const e=t.$implicit;s.Cb(4),s.ad(s.pc(5,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function FZ(e,t){if(1&e&&(s.Vb(0),s.Xc(1,xZ,7,4,"li",75),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",e.ENTERPRISE_FEATURES_TYPES)}}function jZ(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",64),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(4).openFeaturesInfo(t.type)})),s.Sb(1,"img",65),s.Wb()}}function ZZ(e,t){if(1&e&&(s.Xb(0,"li"),s.mc(),s.Xb(1,"svg",73),s.Sb(2,"path",74),s.Wb(),s.lc(),s.Xb(3,"span"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,jZ,2,0,"a",76),s.Wb()),2&e){const e=t.$implicit;s.Cb(4),s.ad(s.pc(5,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function VZ(e,t){if(1&e&&(s.Vb(0),s.Xc(1,ZZ,7,4,"li",75),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",e.BASIC_2021_FEATURE_TYPES)}}function YZ(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",64),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(4).openFeaturesInfo(t.type)})),s.Sb(1,"img",65),s.Wb()}}function HZ(e,t){if(1&e&&(s.Xb(0,"li"),s.mc(),s.Xb(1,"svg",73),s.Sb(2,"path",74),s.Wb(),s.lc(),s.Xb(3,"span"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,YZ,2,0,"a",76),s.Wb()),2&e){const e=t.$implicit;s.Cb(4),s.ad(s.pc(5,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function $Z(e,t){if(1&e&&(s.Vb(0),s.Xc(1,HZ,7,4,"li",75),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",e.STANDARD_2021_FEATURE_TYPES)}}function KZ(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",64),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(4).openFeaturesInfo(t.type)})),s.Sb(1,"img",65),s.Wb()}}function qZ(e,t){if(1&e&&(s.Xb(0,"li"),s.mc(),s.Xb(1,"svg",73),s.Sb(2,"path",74),s.Wb(),s.lc(),s.Xb(3,"span"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,KZ,2,0,"a",76),s.Wb()),2&e){const e=t.$implicit;s.Cb(4),s.ad(s.pc(5,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function zZ(e,t){if(1&e&&(s.Vb(0),s.Xc(1,qZ,7,4,"li",75),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",e.PRO_2021_FEATURE_TYPES)}}function QZ(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",64),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(4).openFeaturesInfo(t.type)})),s.Sb(1,"img",65),s.Wb()}}function JZ(e,t){if(1&e&&(s.Xb(0,"li"),s.mc(),s.Xb(1,"svg",73),s.Sb(2,"path",74),s.Wb(),s.lc(),s.Xb(3,"span"),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,QZ,2,0,"a",76),s.Wb()),2&e){const e=t.$implicit;s.Cb(4),s.ad(s.pc(5,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function eV(e,t){if(1&e&&(s.Vb(0),s.Xc(1,JZ,7,4,"li",75),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}function tV(e,t){if(1&e&&(s.Xb(0,"ul",72),s.Xc(1,PZ,2,1,"ng-container",0),s.Xc(2,UZ,2,1,"ng-container",0),s.Xc(3,FZ,2,1,"ng-container",0),s.Xc(4,VZ,2,1,"ng-container",0),s.Xc(5,$Z,2,1,"ng-container",0),s.Xc(6,zZ,2,1,"ng-container",0),s.Xc(7,eV,2,1,"ng-container",0),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.wc("ngIf",e.isPlus(e.currentPaymentType.value)||e.isPremium(e.currentPaymentType.value)||e.isEnterprise(e.currentPaymentType.value)),s.Cb(1),s.wc("ngIf",e.isPremium(e.currentPaymentType.value)||e.isEnterprise(e.currentPaymentType.value)),s.Cb(1),s.wc("ngIf",e.isEnterprise(e.currentPaymentType.value)),s.Cb(1),s.wc("ngIf",e.isBasic(e.currentPaymentType.value)||e.isStandard(e.currentPaymentType.value)||e.isPro(e.currentPaymentType.value)||e.isEnterprise2021(e.currentPaymentType.value)),s.Cb(1),s.wc("ngIf",e.isStandard(e.currentPaymentType.value)||e.isPro(e.currentPaymentType.value)||e.isEnterprise2021(e.currentPaymentType.value)),s.Cb(1),s.wc("ngIf",e.isPro(e.currentPaymentType.value)||e.isEnterprise2021(e.currentPaymentType.value)),s.Cb(1),s.wc("ngIf",e.isEnterprise2021(e.currentPaymentType.value))}}function nV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",64),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(4).openFeaturesInfo(t.type)})),s.Sb(1,"img",65),s.Wb()}}function iV(e,t){if(1&e&&(s.Xb(0,"li"),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,nV,2,0,"a",76),s.Wb()),2&e){const e=t.$implicit;s.Cb(2),s.ad(s.pc(3,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function sV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",64),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(4).openFeaturesInfo(t.type)})),s.Sb(1,"img",65),s.Wb()}}function cV(e,t){if(1&e&&(s.Xb(0,"li"),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,sV,2,0,"a",76),s.Wb()),2&e){const e=t.$implicit;s.Cb(2),s.ad(s.pc(3,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function aV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",64),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(4).openFeaturesInfo(t.type)})),s.Sb(1,"img",65),s.Wb()}}function oV(e,t){if(1&e&&(s.Xb(0,"li"),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,aV,2,0,"a",76),s.Wb()),2&e){const e=t.$implicit;s.Cb(2),s.ad(s.pc(3,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function rV(e,t){if(1&e&&(s.Vb(0),s.Xc(1,iV,5,4,"li",75),s.Xb(2,"div",79),s.Xc(3,cV,5,4,"li",75),s.Wb(),s.Xb(4,"div",79),s.Xc(5,oV,5,4,"li",75),s.Wb(),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",e.STANDARD_2021_FEATURE_TYPES),s.Cb(2),s.wc("ngForOf",e.PRO_2021_FEATURE_TYPES),s.Cb(2),s.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}function lV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",64),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(4).openFeaturesInfo(t.type)})),s.Sb(1,"img",65),s.Wb()}}function bV(e,t){if(1&e&&(s.Xb(0,"li"),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,lV,2,0,"a",76),s.Wb()),2&e){const e=t.$implicit;s.Cb(2),s.ad(s.pc(3,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function dV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",64),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(4).openFeaturesInfo(t.type)})),s.Sb(1,"img",65),s.Wb()}}function uV(e,t){if(1&e&&(s.Xb(0,"li"),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,dV,2,0,"a",76),s.Wb()),2&e){const e=t.$implicit;s.Cb(2),s.ad(s.pc(3,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function pV(e,t){if(1&e&&(s.Vb(0),s.Xc(1,bV,5,4,"li",75),s.Xb(2,"div",79),s.Xc(3,uV,5,4,"li",75),s.Wb(),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",e.PRO_2021_FEATURE_TYPES),s.Cb(2),s.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}function hV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",64),s.jc("click",(function(){s.Oc(e);const t=s.nc().$implicit;return s.nc(4).openFeaturesInfo(t.type)})),s.Sb(1,"img",65),s.Wb()}}function mV(e,t){if(1&e&&(s.Xb(0,"li"),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xc(4,hV,2,0,"a",76),s.Wb()),2&e){const e=t.$implicit;s.Cb(2),s.ad(s.pc(3,2,e.title)),s.Cb(2),s.wc("ngIf",e.text)}}function gV(e,t){if(1&e&&(s.Vb(0),s.Xc(1,mV,5,4,"li",75),s.Ub()),2&e){const e=s.nc(3);s.Cb(1),s.wc("ngForOf",e.ENTERPRISE_2021_FEATURE_TYPES)}}const EV=function(){return["/subscription"]};function fV(e,t){if(1&e&&(s.Vb(0),s.Sb(1,"hr"),s.Xb(2,"div",77),s.Xb(3,"a",78),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"ul",72),s.Xc(9,rV,6,3,"ng-container",0),s.Xc(10,pV,4,2,"ng-container",0),s.Xc(11,gV,2,1,"ng-container",0),s.Wb(),s.Ub()),2&e){const e=s.nc(2);s.Cb(3),s.wc("routerLink",s.Ac(10,EV)),s.Cb(1),s.ad(s.pc(5,6,"GLOBAL.UPGRADE_BTN")),s.Cb(2),s.bd(" ",s.pc(7,8,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.UPGRADE_TO_GET_FEATURES")," "),s.Cb(3),s.wc("ngIf",e.isBasic(e.currentPaymentType.value)),s.Cb(1),s.wc("ngIf",e.isStandard(e.currentPaymentType.value)),s.Cb(1),s.wc("ngIf",e.isPro(e.currentPaymentType.value))}}function SV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",80),s.Xb(1,"div",81),s.Xb(2,"div",82),s.Xb(3,"div",83),s.Xb(4,"div",84),s.Xb(5,"span",85),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Xb(8,"a",86),s.jc("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(4);return t.openEditInvoiceInfo(n)})),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Xb(11,"div",87),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Xb(14,"div",24),s.Zc(15),s.oc(16,"translate"),s.Wb(),s.Xb(17,"div",87),s.Zc(18),s.oc(19,"translate"),s.Wb(),s.Xb(20,"div",24),s.Zc(21),s.oc(22,"translate"),s.Wb(),s.Xb(23,"div",87),s.Zc(24),s.oc(25,"translate"),s.Wb(),s.Xb(26,"div",24),s.Zc(27),s.oc(28,"translate"),s.Wb(),s.Xb(29,"div",87),s.Zc(30),s.oc(31,"translate"),s.Wb(),s.Xb(32,"div",24),s.Zc(33),s.oc(34,"translate"),s.Wb(),s.Xb(35,"div",87),s.Zc(36),s.oc(37,"translate"),s.Wb(),s.Xb(38,"div",24),s.Zc(39),s.oc(40,"translate"),s.Wb(),s.Xb(41,"div",87),s.Zc(42),s.oc(43,"translate"),s.oc(44,"translate"),s.Wb(),s.Xb(45,"div",24),s.Zc(46),s.oc(47,"translate"),s.Wb(),s.Xb(48,"div",87),s.Zc(49),s.oc(50,"translate"),s.oc(51,"translate"),s.Wb(),s.Xb(52,"div",24),s.Zc(53),s.oc(54,"translate"),s.Wb(),s.Xb(55,"div",87),s.Zc(56),s.oc(57,"translate"),s.Wb(),s.Xb(58,"div",24),s.Zc(59),s.oc(60,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(61,"div",88),s.Xb(62,"div",82),s.Xb(63,"div",83),s.Xb(64,"div",84),s.Xb(65,"span",85),s.Zc(66),s.oc(67,"translate"),s.Wb(),s.Xb(68,"a",86),s.jc("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(6);return t.openEditPaymentInfo(n)})),s.Zc(69),s.oc(70,"translate"),s.Wb(),s.Wb(),s.Xb(71,"div",87),s.Zc(72),s.oc(73,"translate"),s.Wb(),s.Xb(74,"div",24),s.Zc(75),s.Wb(),s.Xb(76,"div",87),s.Zc(77),s.oc(78,"translate"),s.Wb(),s.Xb(79,"div",24),s.Zc(80),s.Wb(),s.Xb(81,"div",87),s.Zc(82),s.oc(83,"translate"),s.Wb(),s.Xb(84,"div",24),s.Zc(85),s.Wb(),s.Xb(86,"div",87),s.Zc(87),s.oc(88,"translate"),s.Wb(),s.Xb(89,"div",24),s.Zc(90),s.Wb(),s.Xb(91,"div",87),s.Zc(92),s.oc(93,"translate"),s.oc(94,"translate"),s.Wb(),s.Xb(95,"div",24),s.Zc(96),s.Wb(),s.Xb(97,"div",87),s.Zc(98),s.oc(99,"translate"),s.oc(100,"translate"),s.Wb(),s.Xb(101,"div",24),s.Zc(102),s.Wb(),s.Xb(103,"div",87),s.Zc(104),s.oc(105,"translate"),s.Wb(),s.Xb(106,"div",24),s.Zc(107),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(6),s.ad(s.pc(7,39,"GLOBAL.INVOICE_EXPLANATION")),s.Cb(3),s.ad(s.pc(10,41,"GLOBAL.EDIT_LABEL")),s.Cb(3),s.ad(s.pc(13,43,"GLOBAL.COMPANY_NAME_LABEL")),s.Cb(3),s.ad((null==e.invoiceInformation?null:e.invoiceInformation.companyName)||s.pc(16,45,"GLOBAL.NO_DATA_LABEL")),s.Cb(3),s.ad(s.pc(19,47,"GLOBAL.SEND_EMAIL_TO_LABEL")),s.Cb(3),s.ad((null==e.invoiceInformation?null:e.invoiceInformation.email)||s.pc(22,49,"GLOBAL.NO_DATA_LABEL")),s.Cb(3),s.ad(s.pc(25,51,"GLOBAL.LABEL_COUNTRY")),s.Cb(3),s.ad((null==e.invoiceInformation?null:e.invoiceInformation.country)||s.pc(28,53,"GLOBAL.NO_DATA_LABEL")),s.Cb(3),s.ad(s.pc(31,55,"GLOBAL.ADDRESS_LABEL")),s.Cb(3),s.ad((null==e.invoiceInformation?null:e.invoiceInformation.address1)||s.pc(34,57,"GLOBAL.NO_DATA_LABEL")),s.Cb(3),s.ad(s.pc(37,59,"GLOBAL.LABEL_CITY")),s.Cb(3),s.ad((null==e.invoiceInformation?null:e.invoiceInformation.city)||s.pc(40,61,"GLOBAL.NO_DATA_LABEL")),s.Cb(3),s.cd("",s.pc(43,63,"GLOBAL.LABEL_STATE")," / ",s.pc(44,65,"GLOBAL.LABEL_PROVINCE"),""),s.Cb(4),s.ad((null==e.invoiceInformation?null:e.invoiceInformation.state)||s.pc(47,67,"GLOBAL.NO_DATA_LABEL")),s.Cb(3),s.cd("",s.pc(50,69,"GLOBAL.LABEL_ZIP")," / ",s.pc(51,71,"GLOBAL.LABEL_POSTAL"),""),s.Cb(4),s.ad((null==e.invoiceInformation?null:e.invoiceInformation.zip)||s.pc(54,73,"GLOBAL.NO_DATA_LABEL")),s.Cb(3),s.ad(s.pc(57,75,"GLOBAL.TAX_ID_LABEL")),s.Cb(3),s.ad((null==e.invoiceInformation?null:e.invoiceInformation.vatNumber)||s.pc(60,77,"GLOBAL.NO_DATA_LABEL")),s.Cb(7),s.ad(s.pc(67,79,"GLOBAL.PAYMENT_INFORMATION_TITLE")),s.Cb(3),s.ad(s.pc(70,81,"GLOBAL.EDIT_LABEL")),s.Cb(3),s.ad(s.pc(73,83,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.VISA_LABEL")),s.Cb(3),s.bd("************",null==e.paymentInformation?null:e.paymentInformation.last4,""),s.Cb(2),s.ad(s.pc(78,85,"GLOBAL.LABEL_EXPIRATION_DATE")),s.Cb(3),s.cd("",null==e.paymentInformation?null:e.paymentInformation.cardExpMonth,"/",null==e.paymentInformation?null:e.paymentInformation.cardExpYear,""),s.Cb(2),s.ad(s.pc(83,87,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.CARD_HOLDER_LABEL")),s.Cb(3),s.ad(null==e.paymentInformation?null:e.paymentInformation.cardHolder),s.Cb(2),s.ad(s.pc(88,89,"GLOBAL.LABEL_STREET")),s.Cb(3),s.ad(null==e.paymentInformation?null:e.paymentInformation.street),s.Cb(2),s.cd("",s.pc(93,91,"GLOBAL.LABEL_ZIP")," / ",s.pc(94,93,"GLOBAL.LABEL_POSTAL"),""),s.Cb(4),s.ad(null==e.paymentInformation?null:e.paymentInformation.zip),s.Cb(2),s.cd("",s.pc(99,95,"GLOBAL.LABEL_STATE")," / ",s.pc(100,97,"GLOBAL.LABEL_PROVINCE"),""),s.Cb(4),s.ad(null==e.paymentInformation?null:e.paymentInformation.state),s.Cb(2),s.ad(s.pc(105,99,"GLOBAL.LABEL_COUNTRY")),s.Cb(3),s.ad(null==e.paymentInformation?null:e.paymentInformation.country)}}function CV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",89),s.jc("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(20);return t.cancelSubscription(n)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.CANCEL_SUBSCRIPTION_LABEL")," "))}function AV(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"div",17),s.Xb(2,"div",18),s.Xb(3,"div",19),s.Xc(4,EZ,14,9,"div",20),s.Xb(5,"div",21),s.Xc(6,SZ,8,15,"div",22),s.Xc(7,AZ,4,4,"div",23),s.Xc(8,OZ,6,6,"div",23),s.Xb(9,"div",24),s.Zc(10),s.oc(11,"translate"),s.Xc(12,vZ,3,3,"span",0),s.Xc(13,TZ,3,3,"span",25),s.Wb(),s.Xb(14,"div",26),s.Xb(15,"span"),s.Zc(16),s.Xc(17,IZ,3,3,"span",27),s.Xc(18,wZ,3,3,"span",27),s.Wb(),s.Xc(19,LZ,4,3,"span",0),s.Wb(),s.Wb(),s.Xb(20,"div",28),s.Xb(21,"div",29),s.Xb(22,"div",30),s.Xb(23,"div",31),s.Xb(24,"span",32),s.Zc(25,"$"),s.Wb(),s.Xb(26,"span",33),s.Zc(27),s.Wb(),s.Xc(28,RZ,2,1,"span",34),s.Wb(),s.Xb(29,"div"),s.Xb(30,"div",35),s.Zc(31),s.oc(32,"translate"),s.oc(33,"lowercase"),s.oc(34,"translate"),s.oc(35,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xc(36,yZ,6,4,"div",36),s.Wb(),s.Xc(37,WZ,24,28,"div",0),s.Sb(38,"hr"),s.Xb(39,"div",29),s.Xb(40,"div",24),s.Zc(41),s.oc(42,"translate"),s.Wb(),s.Xb(43,"div",24),s.Zc(44),s.oc(45,"number"),s.Wb(),s.Wb(),s.Xb(46,"div",37),s.Sb(47,"hr"),s.Xc(48,XZ,37,18,"ul",38),s.Xc(49,tV,8,7,"ul",38),s.Xc(50,fV,12,11,"ng-container",0),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(51,"div",39),s.Xc(52,SV,108,101,"div",40),s.Wb(),s.Wb(),s.Xb(53,"div",41),s.Xb(54,"p",42),s.Zc(55),s.oc(56,"translate"),s.Xb(57,"a",43),s.Zc(58),s.oc(59,"translate"),s.Wb(),s.Zc(60),s.oc(61,"translate"),s.Xb(62,"a",44),s.Zc(63),s.Wb(),s.Wb(),s.Xc(64,CV,3,3,"a",45),s.Wb(),s.Ub()),2&e){const e=s.nc();s.Cb(2),s.wc("ngClass",e.currentPaymentType.colorParent),s.Cb(2),s.wc("ngIf",e.payment.paid&&!e.isCouponUsed),s.Cb(2),s.wc("ngIf",e.nextSubscriptionType&&e.nextSubscriptionType.value!=e.currentPaymentType.value),s.Cb(1),s.wc("ngIf",!(e.payment.paid||e.nextSubscriptionType&&e.nextSubscriptionType.value!=e.currentPaymentType.value||"FREE"===e.currentPaymentType.value)),s.Cb(1),s.wc("ngIf",e.paymentFailed),s.Cb(2),s.bd(" ",s.pc(11,30,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.CURRENT_PLAN_PART_1")," "),s.Cb(2),s.wc("ngIf",(null==e.nextSubscriptionType?null:e.nextSubscriptionType.value)!=e.currentPaymentType.value&&e.payment.paid),s.Cb(1),s.wc("ngIf",e.currentPaymentType.legacy),s.Cb(3),s.bd("",e.currentPaymentType.title.toUpperCase()," "),s.Cb(1),s.wc("ngIf","FREE"!==e.currentPaymentType.value),s.Cb(1),s.wc("ngIf","FREE"===e.currentPaymentType.value),s.Cb(1),s.wc("ngIf",!e.currentPaymentType.legacy&&-1===e.currentPaymentType.label.indexOf("YEAR")&&(null==e.nextSubscriptionType?null:e.nextSubscriptionType.value)===e.currentPaymentType.value&&e.payment.paid),s.Cb(8),s.bd(" ",e.payment.amount?e.payment.amount.toString().split(".")[0]:e.currentPaymentType.price," "),s.Cb(1),s.wc("ngIf","FREE"!==e.currentPaymentType.value),s.Cb(3),s.cd(" ",s.pc(32,32,null!=e.currentPaymentType&&e.currentPaymentType.bySeat?"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.PAY_PER_SEAT_PART":"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.PAY_PER_PART")," ",e.isMonthly?s.pc(33,34,s.pc(34,36,"GLOBAL.MONTH_LABEL")):s.pc(35,38,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.PAY_PER_YEAR_PART")," "),s.Cb(5),s.wc("ngIf",e.nextBillingDate),s.Cb(1),s.wc("ngIf",null==e.currentPaymentType?null:e.currentPaymentType.bySeat),s.Cb(4),s.bd(" ",s.pc(42,40,e.isMonthly?"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.PRICE_TOTAL_MONTH":"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.PRICE_TOTAL_YEAR")," "),s.Cb(3),s.bd(" $",e.payment.totalAmount?e.payment.totalAmount:s.qc(45,42,e.payment.quantity*e.payment.amount,"1.2-2")," "),s.Cb(4),s.wc("ngIf","FREE"===e.currentPaymentType.value),s.Cb(1),s.wc("ngIf","FREE"!==e.currentPaymentType.value),s.Cb(1),s.wc("ngIf",!e.currentPaymentType.legacy&&!e.isEnterprise2021(e.currentPaymentType.value)),s.Cb(2),s.wc("ngIf","FREE"!==e.currentPaymentType.value),s.Cb(3),s.bd(" ",s.pc(56,45,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.CONTACT_SUPPORT_TEXT.PART_1")," "),s.Cb(3),s.ad(s.pc(59,47,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.CONTACT_SUPPORT_TEXT.PART_2")),s.Cb(2),s.bd(", ",s.pc(61,49,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.CONTACT_SUPPORT_TEXT.PART_3")," "),s.Cb(2),s.wc("href","mailto:"+e.supportEmail,s.Qc),s.Cb(1),s.ad(e.supportEmail),s.Cb(1),s.wc("ngIf",e.payment.paid&&(null==e.nextSubscriptionType?null:e.nextSubscriptionType.value)===e.currentPaymentType.value)}}function OV(e,t){if(1&e&&(s.Xb(0,"features-info",90),s.jc("close",(function(){return t.$implicit.close()})),s.Wb()),2&e){const e=s.nc();s.wc("type",e.featuresInfoType)}}function vV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",91),s.Xb(1,"h1",92),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",93),s.jc("click",(function(){return t.$implicit.close()})),s.Xb(5,"span",94),s.Sb(6,"img",95),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",96),s.Xb(8,"stripe-invoice",97),s.jc("turnAddress",(function(t){return s.Oc(e),s.nc().addressOn=t})),s.Wb(),s.Wb(),s.Xb(9,"div",98),s.Xb(10,"a",99),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xb(13,"button",100),s.jc("click",(function(){return s.Oc(e),s.nc().getInvoiceInformation()})),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,7,"GLOBAL.INVOICE_EXPLANATION")),s.Cb(6),s.wc("editInvoiceInformation",e.invoiceInformationCopy)("workspaceName",e.workspace.name)("mode","edit"),s.Cb(3),s.ad(s.pc(12,9,"GLOBAL.CANCEL_BTN")),s.Cb(2),s.wc("disabled",e.buttonDisabled),s.Cb(1),s.bd(" ",s.pc(15,11,"GLOBAL.SAVE_LABEL")," ")}}function TV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",91),s.Xb(1,"h1",92),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",93),s.jc("click",(function(){return t.$implicit.close()})),s.Xb(5,"span",94),s.Sb(6,"img",95),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",96),s.Xb(8,"stripe",101,102),s.jc("closeDialog",(function(){return t.$implicit.close()}))("paymentInformation",(function(t){return s.Oc(e),s.nc().getPaymentInformation(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,6,"GLOBAL.PAYMENT_INFORMATION_TITLE")),s.Cb(6),s.wc("editPaymentInformation",e.paymentInformationCopy)("invoiceInformation",e.invoiceInformation)("mode","edit")("isMonthly",e.isMonthly)("paymentFailedMessage",e.failMessage)}}function IV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",114),s.Xb(1,"span"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",115),s.jc("click",(function(){s.Oc(e);const t=s.nc(2),n=s.Lc(32),i=s.Lc(30);return t.openModal(t.isEmailVerified?n:i)})),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Wb()}2&e&&(s.Cb(2),s.bd(" ",s.pc(3,2,"PUMBLE_COUPON.CHAT_WITH_TEAMMATES")," "),s.Cb(3),s.bd(" ",s.pc(6,4,"PUMBLE_COUPON.ENABLE_CHAT")," "))}const wV=function(e){return{promoCode:e}};function LV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",91),s.Xb(1,"h1",103),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",93),s.jc("click",(function(){return t.$implicit.close()})),s.Xb(5,"span",94),s.Sb(6,"img",95),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",104),s.Xc(8,IV,7,6,"div",105),s.Sb(9,"img",106),s.Xb(10,"div",107),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Xb(13,"div",108),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Xb(16,"div",109),s.Zc(17),s.oc(18,"translate"),s.Sb(19,"br"),s.Xb(20,"span"),s.Xb(21,"a",110),s.Zc(22," Pumble PRO "),s.Wb(),s.Wb(),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Xb(25,"div",111),s.Zc(26),s.oc(27,"translate"),s.Wb(),s.Wb(),s.Xb(28,"div",98),s.Xb(29,"a",112),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(30),s.oc(31,"translate"),s.Wb(),s.Xb(32,"button",113),s.jc("click",(function(){return s.Oc(e),s.nc().goToPumble()})),s.Zc(33),s.oc(34,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,9,"PUMBLE_COUPON.EXCLUSIVE_OFFER")),s.Cb(6),s.wc("ngIf",!e.isConnected),s.Cb(3),s.ad(s.pc(12,11,"PUMBLE_COUPON.TRACKING_AND_COMMUNICATION")),s.Cb(3),s.ad(s.pc(15,13,"PUMBLE_COUPON.DISCOUNT")),s.Cb(3),s.ad(s.pc(18,15,"PUMBLE_COUPON.YEAR_DISCOUNT_PART_ONE")),s.Cb(6),s.ad(s.pc(24,17,"PUMBLE_COUPON.YEAR_DISCOUNT_PART_TWO")),s.Cb(3),s.ad(s.qc(27,19,"PUMBLE_COUPON.PROMO_CODE",s.Bc(26,wV,e.promoCode))),s.Cb(4),s.ad(s.pc(31,22,"GLOBAL.CLOSE_BTN")),s.Cb(3),s.ad(s.pc(34,24,"PUMBLE_COUPON.USE_COUPON"))}}const RV=function(e){return{title:e}};function yV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",116),s.Xb(1,"div",117),s.Sb(2,"img",118),s.Wb(),s.Xb(3,"div",119),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"p",120),s.Zc(7),s.oc(8,"translate"),s.oc(9,"lowercase"),s.oc(10,"translate"),s.oc(11,"translate"),s.Wb(),s.Wb(),s.Xb(12,"div",98),s.Xb(13,"a",99),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Xb(16,"button",121),s.jc("click",(function(){return s.Oc(e),s.nc().reactivate()})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(4),s.ad(s.pc(5,6,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.REACTIVATE_SUBSCRIPTION.TITLE")),s.Cb(3),s.dd("",s.qc(8,8,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.REACTIVATE_SUBSCRIPTION.PART_1",s.Bc(21,RV,e.currentPaymentType.title))," ",s.pc(9,11,s.pc(10,13,e.isMonthly?"GLOBAL.MONTHLY_LABEL":"SUBSCRIPTION_TABS.SHARED.PAY_ANNUAL_LABEL"))," ",s.pc(11,15,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.REACTIVATE_SUBSCRIPTION.PART_3"),""),s.Cb(7),s.ad(s.pc(15,17,"GLOBAL.NEVERMIND_CANCEL_BTN")),s.Cb(3),s.ad(s.pc(18,19,"GLOBAL.REACTIVATE_BUTTON"))}}function _V(e,t){if(1&e){const e=s.Yb();s.Xb(0,"switching-plan",122),s.jc("pay",(function(t){return s.Oc(e),s.nc().pay(t)}))("closeModal",(function(){return t.$implicit.close()})),s.Wb()}if(2&e){const e=s.nc();s.wc("disableButton",e.buttonDisabled)("workspace",e.workspace)("type",e.plan)("price",e.price)}}const kV=function(e){return{name:e}};function WV(e,t){if(1&e&&(s.Xb(0,"div",116),s.Xb(1,"div",117),s.Sb(2,"img",123),s.Wb(),s.Xb(3,"div",119),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xb(6,"p",124),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Xb(9,"div",98),s.Xb(10,"a",112),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(4),s.ad(s.pc(5,3,"GLOBAL.SUCCESS_MSG")),s.Cb(3),s.ad(s.qc(8,5,"SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.UPGRADED_SUCCES_TEXT",s.Bc(10,kV,e.workspace.name))),s.Cb(4),s.ad(s.pc(12,8,"GLOBAL.CLOSE_BTN"))}}function XV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"user-seats-modal",125),s.jc("closeModal",(function(){return t.$implicit.close()}))("saveQuantity",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().saveQuantity(n,i)})),s.Wb()}if(2&e){const e=s.nc();s.wc("activeUsers",e.activeMembers)("currentQuantity",e.payment.quantity)("unusedSeats",e.payment.quantity-e.activeMembers)("isAdd",e.isAddingSeats)("inProgress",e.inProgress)("currentType",e.currentPaymentType)("amount",e.payment.amount)}}function NV(e,t){1&e&&(s.Xb(0,"subscription-incomplete-modal",126),s.jc("close",(function(){return t.$implicit.close()})),s.Wb())}function DV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"cancel-subscription",127),s.jc("closeModal",(function(){return t.$implicit.close()}))("openCancelSubscriptionReasonModal",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(22);return t.openModal(n)})),s.Wb()}}function PV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"cancel-subscription-reason-modal",128),s.jc("closeModal",(function(){return t.$implicit.close()}))("openConfirmCancellationModal",(function(t){return s.Oc(e),s.nc().openConfirmCancellationModal(t)}))("cancellationReason",(function(){return s.Oc(e),s.nc().cancellationReason})),s.Wb()}if(2&e){const e=s.nc();s.wc("isLegacy",e.currentPaymentType.legacy)}}function MV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"no-longer-need-modal",129),s.jc("closeModal",(function(){return t.$implicit.close()}))("cancelSubscription",(function(t){return s.Oc(e),s.nc().cancelPaymentSubscription(t)})),s.Wb()}}function BV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"other-reasons-modal",130),s.jc("closeModal",(function(){return t.$implicit.close()}))("cancelSubscription",(function(t){return s.Oc(e),s.nc().cancelPaymentSubscription(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("reason",e.cancellationReason)}}function UV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"no-reason-selected-modal",129),s.jc("closeModal",(function(){return t.$implicit.close()}))("cancelSubscription",(function(t){return s.Oc(e),s.nc().cancelPaymentSubscription(t)})),s.Wb()}}function GV(e,t){1&e&&(s.Xb(0,"verify-email-modal",126),s.jc("close",(function(){return t.$implicit.close()})),s.Wb())}function xV(e,t){if(1&e&&(s.Xb(0,"pumble-integration-modals",131),s.jc("close",(function(){return t.$implicit.close()})),s.Wb()),2&e){const e=s.nc();s.wc("workspaceId",e.workspace.id)("integration",e.integration)("pumbleSettings",e.pumbleSettings)}}let FV=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r,l,b,d,u,p){this.authService=e,this.workspaceService=t,this.paymentService=n,this.loader=i,this.toaster=s,this.systemSettingsService=c,this.modalService=a,this.notificationService=o,this.cd=r,this.translateService=l,this.analyticsService=b,this.activeRoute=d,this.http=u,this.pumbleService=p,this.unsubscribe$=new Fn.a,this.isFree=mo.g,this.isPlus=mo.i,this.isPremium=mo.j,this.isEnterprise=mo.e,this.isBasic=mo.d,this.isStandard=mo.l,this.isPro=mo.k,this.isEnterprise2021=mo.f,this.BASIC_2021_FEATURE_TYPES=gC,this.STANDARD_2021_FEATURE_TYPES=fC,this.PRO_2021_FEATURE_TYPES=CC,this.ENTERPRISE_2021_FEATURE_TYPES=OC,this.PLUS_FEATURES_TYPES=TC,this.PREMIUM_FEATURES_TYPES=wC,this.ENTERPRISE_FEATURES_TYPES=RC,this.isEmailVerified=!0,this.isConnected=!1,this.pumbleSettings=new xu}ngOnInit(){this.isEmailVerified="ACTIVE"==this.authService.getUser().status,this.checkIfConnectedToPumble(),this.subscribeToWorkspace(),this.notificationService.paymentFailedNotification$.pipe(Object(Zt.a)(e=>null!=e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.paymentFailed=e&&e.filter(e=>e.data.workspaceId==this.workspace.id).length>0}),this.workspaceService.payment$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.payment=e,this.payment.nextSubscriptionType?(this.nextSubscriptionType=Object(mo.c)(e.nextSubscriptionType),this.nextBillingDate=ke(e.billingDate).format(this.profile.settings.dateFormat)):this.nextSubscriptionType=mo.a.FREE,this.percentage=this.payment.quantity?100*this.activeMembers/this.payment.quantity:0,this.isUsedAllSeats=this.percentage>=100,this.cd.detectChanges()}),this.systemSettingsService.customEmailsSettings.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.supportEmail=e.supportEmail}),this.systemSettingsService.getCustomEmailsSettings(),this.paymentService.getPaymentInformation(this.workspace.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.paymentInformation=e}),this.paymentService.getInvoiceInformation(this.workspace.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.invoiceInformation=e}),this.workspaceService.getPaymentDate(),this.generatePumbleCoupon(),this.activeRoute.queryParams.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{"true"===e.pumbleCoupon&&this.openModal(this.pumbleCoupon)})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}subscribeToWorkspace(){this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.workspace=e,this.activeMembers=this.workspace.memberships.filter(e=>e.isActiveOrPending).length,this.currentPaymentType=Object(mo.c)(this.workspace.featureSubscriptionType),this.profile=this.authService.getUser(),this.isMonthly=Object(mo.h)(this.currentPaymentType.value),this.cd.detectChanges()})}cancelSubscription(e){this.modalService.open(e,{centered:!0}),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"cancel subscription",section:"Subscription"}))}reactivate(){this.buttonDisabled=!0,this.loader.show("GLOBAL.PROCESSING_PAYMENT_MESSAGE_TITLE"),this.paymentService.reactivateSubscription(this.workspace.id).subscribe(()=>{this.workspaceService.getPaymentDate(this.workspace.id),this.buttonDisabled=!1,this.loader.hide(),this.modalService.dismissAll(),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"reactivate",section:"Subscription",section2:"Reactivate",section4:"button reactivate confirm"}))},()=>{this.loader.hide(),this.buttonDisabled=!1})}getPumbleWorkspaces(){this.workspaceService.getIntegrationToken(this.workspace.id).pipe(Dh(1e4)).subscribe(e=>{this.workspaceService.getPumbleWorkspaces(e.integrationToken).pipe(Dh(2e3)).subscribe(e=>{this.pumbleSettings.pumbleWorkspaces=[],e.workspaces&&(this.pumbleSettings.hasPumbleAccount=!0,e.workspaces.length>0&&(this.pumbleSettings.isPumbleAdmin=!0,e.workspaces.forEach(e=>{this.pumbleSettings.pumbleWorkspaces.push(new Ph(e.id,e.name))})))},e=>{this.toaster.pop("error",this.translateService.instant("WORKSPACE.INTEGRATION.PUMBLE.NETWORK_CONNECTION_ERROR"))})})}openEditInvoiceInfo(e){this.invoiceInformationCopy=new Cw.a(this.invoiceInformation),this.modalService.open(e,{centered:!0})}openReactivateDialog(e){this.modalService.open(e,{centered:!0})}openEditPaymentInfo(e){this.paymentInformationCopy=new Aw.a(this.paymentInformation),this.modalService.open(e,{centered:!0})}getInvoiceInformation(){this.invoiceInformationCopy.isCompanyNameEmpty()?this.toaster.pop("error",this.translateService.instant("GLOBAL.COMPANY_NAME_ERROR_MESSAGE")):this.invoiceInformationCopy.isAddressEmpty(this.addressOn)?this.toaster.pop("error",this.translateService.instant("GLOBAL.ADDRESS_FIELDS_ERROR_MESSAGE")):this.invoiceInformationCopy.isVatEmpty()?this.toaster.pop("error",this.translateService.instant("GLOBAL.VAT_ERROR_MESSAGE")):(this.buttonDisabled=!0,this.loader.show("SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.UPDATING_LOADER_TITLE"),this.paymentService.editInvoiceInformation(this.workspace.id,new Cw.a(this.invoiceInformationCopy)).subscribe(e=>{this.invoiceInformation=e,this.modalService.dismissAll(),this.buttonDisabled=!1,this.loader.hide(),this.toaster.pop("success",this.translateService.instant("GLOBAL.INVOICE_INFO_UPDATED"),this.translateService.instant("GLOBAL.BILLING_CHANGE_SUCCESS_BODY"))},e=>{var t;this.modalService.dismissAll(),this.buttonDisabled=!1,this.loader.hide(),this.toaster.pop("error",null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)}))}getPaymentInformation(e){this.buttonDisabled=!0,this.loader.show(),this.paymentService.editPaymentInformation(this.workspace.id,new Aw.a(e)).subscribe(e=>{this.paymentInformation=e,this.modalService.dismissAll(),this.loader.hide(),this.buttonDisabled=!1,this.toaster.pop("success",this.translateService.instant("GLOBAL.INVOICE_INFO_UPDATED"),this.translateService.instant("GLOBAL.BILLING_CHANGE_SUCCESS_BODY")),this.paymentFailed&&location.reload()},e=>{var t;this.buttonDisabled=!1,this.loader.hide(),this.failMessage=e.error.message,this.toaster.pop("error",null===(t=e.error)||void 0===t?void 0:t.message)})}pay(e){this.buttonDisabled=!0,this.loader.show("GLOBAL.PROCESSING_PAYMENT_MESSAGE_TITLE"),this.paymentService.chargeCard(this.paymentInformation,e.quantity,e.value,this.workspace.id).subscribe(()=>{this.workspaceService.getPaymentDate(this.workspace.id),this.modalService.dismissAll(),this.workspaceService.getDefaultWorkspace(),this.buttonDisabled=!1,this.loader.hide(),this.modalService.open(this.successModal,{centered:!0})},e=>{var t;e.error&&e.error.message&&e.error.message.includes("incomplete")?this.modalService.open(this.subscriptionFailedModal):this.toaster.pop("error",(null===(t=e.error)||void 0===t?void 0:t.message)||this.translateService.instant("GLOBAL.PROCESSING_FAILED_ERROR_MESSAGE")),this.failMessage=e.error.message,this.buttonDisabled=!1,this.loader.hide()})}openFeaturesInfo(e){this.modalService.open(this.featuresInfoModal,{size:"lg",centered:!0}),this.featuresInfoType=e}upgradeYearly(){this.plan=Object(mo.c)(this.currentPaymentType.label.split("_2021")[0].concat("_YEAR").concat("_2021")),this.paymentService.previewPrice(this.plan.value,this.activeMembers).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.price=e.price,this.modalService.open(this.upgradeModal,{centered:!0})})}cancelPaymentSubscription(e){var t;this.buttonDisabled=!0,this.loader.show("SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.TERMINATION_SUBSCRIPTION_LOADER_NOTIFICATION"),this.paymentService.cancelSubscription(this.workspace.id,null===(t=this.cancellationReason)||void 0===t?void 0:t.text).subscribe(()=>{var t,n,i;this.buttonDisabled=!1,this.loader.hide(),this.workspaceService.getPaymentDate(this.workspace.id),this.modalService.dismissAll(),this.analyticsService.addEvent(new Fi.a({event:"submit",uevent:"submit",value:e,section:"Subscription",section2:"Cancel Subscription",section4:"page2"}));const s=mo.a[this.workspace.featureSubscriptionType];this.analyticsService.addEvent(new Fi.a({event:"refund",value:"refund",uevent:"refund",ecommerce:{transaction_id:null==s?void 0:s.value,action:"downgrade",value:(null===(t=this.payment)||void 0===t?void 0:t.amount)*(null===(n=this.payment)||void 0===n?void 0:n.quantity),currency:"USD",items:[{index:null==s?void 0:s.index,item_name:null==s?void 0:s.value,price:null==s?void 0:s.fullPrice,quantity:null===(i=this.payment)||void 0===i?void 0:i.quantity}]}}))},e=>{var t;this.buttonDisabled=!1,this.loader.hide(),this.modalService.dismissAll(),this.toaster.pop("error",(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translateService.instant("SUBSCRIPTION_TABS.SUBSCRIPTION_PAYMENT.ERRORS.CANCEL_SUBSCRIPTION_FAILED"))})}openModal(e){this.modalService.open(e,{centered:!0})}generatePumbleCoupon(){this.paymentService.getPumbleCoupon().subscribe(e=>{this.isCouponUsed=e.used,this.promoCode=e.coupon})}checkIfConnectedToPumble(){this.workspaceService.isPumbleActivated$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isConnected=e,this.cd.detectChanges()})}saveQuantity(e,t){this.loader.show();const n=this.isAddingSeats?this.payment.quantity+e:this.payment.quantity-e;this.inProgress=!0,this.paymentService.updateQuantity(n,this.payment.quantity).subscribe(i=>{this.payment=i,this.workspaceService.payment$.next(i),this.percentage=this.payment.quantity?100*this.activeMembers/this.payment.quantity:0,this.isUsedAllSeats=this.percentage>=100,this.loader.hide(),this.inProgress=!1,this.isAddingSeats?(this.analyticsService.addEvent(new Fi.a({event:"purchase",ecommerce:{transaction_id:mo.a[this.workspace.featureSubscriptionType].value,value:mo.a[this.workspace.featureSubscriptionType].fullPrice*e,currency:"USD",items:[{index:mo.a[this.workspace.featureSubscriptionType].index,item_name:mo.a[this.workspace.featureSubscriptionType].value,price:mo.a[this.workspace.featureSubscriptionType].fullPrice,quantity:n}]}})),this.analyticsService.addEvent(new Fi.a({event:"submit",value:" Pay & Save",amount:e,section:"Subscription",section2:"User seats",section3:"Buy more seats"}))):(this.analyticsService.addEvent(new Fi.a({event:"refund",ecommerce:{transaction_id:mo.a[this.workspace.featureSubscriptionType].value,value:mo.a[this.workspace.featureSubscriptionType].fullPrice*e,currency:"USD",items:[{index:mo.a[this.workspace.featureSubscriptionType].index,item_name:mo.a[this.workspace.featureSubscriptionType].value,price:mo.a[this.workspace.featureSubscriptionType].fullPrice,quantity:n}]}})),this.analyticsService.addEvent(new Fi.a({event:"submit",amount:e,section:"Subscription",section2:"User seats",section3:"Remove unused seats"}))),t.close()},e=>{e.error&&e.error.message&&e.error.message.includes("incomplete")&&this.modalService.open(this.subscriptionFailedModal),this.loader.hide(),this.inProgress=!1})}openConfirmCancellationModal(e){this.cancellationReason=e,this.openModal(this.cancellationReason?this.cancellationReason.name==Hj.NO_LONGER_NEED?this.noLongerNeedModal:this.otherReasonsModal:this.noReasonSelectedModal)}goToPumble(){window.open(`${$j.a.pumbleAppUrl}/admin/billing?PLAN=PRO&COUPON=${this.promoCode}`,"_blank")}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(re.a),s.Rb(l.a),s.Rb(dC.a),s.Rb(Hn.a),s.Rb(r.a),s.Rb(bn.a),s.Rb(w.q),s.Rb(Gm.a),s.Rb(s.h),s.Rb(g.f),s.Rb(xi.a),s.Rb(k.a),s.Rb(m.c),s.Rb(Gu.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["subscription-payment"]],viewQuery:function(e,t){var n;1&e&&(s.gd(oZ,!0),s.gd(rZ,!0),s.gd(lZ,!0),s.gd(bZ,!0),s.gd(dZ,!0),s.gd(uZ,!0),s.gd(pZ,!0),s.gd(hZ,!0),s.gd(mZ,!0),s.gd(gZ,!0)),2&e&&(s.Kc(n=s.kc())&&(t.successModal=n.first),s.Kc(n=s.kc())&&(t.featuresInfoModal=n.first),s.Kc(n=s.kc())&&(t.upgradeModal=n.first),s.Kc(n=s.kc())&&(t.userSeatsModal=n.first),s.Kc(n=s.kc())&&(t.pumbleCoupon=n.first),s.Kc(n=s.kc())&&(t.subscriptionFailedModal=n.first),s.Kc(n=s.kc())&&(t.cancelSubscriptionReasonModal=n.first),s.Kc(n=s.kc())&&(t.otherReasonsModal=n.first),s.Kc(n=s.kc())&&(t.noLongerNeedModal=n.first),s.Kc(n=s.kc())&&(t.noReasonSelectedModal=n.first))},decls:33,vars:1,consts:[[4,"ngIf"],["featuresInfoModal",""],["invoiceInfoModal",""],["paymentInfoModal",""],["pumbleCoupon",""],["reactivateModal",""],["upgradeModal",""],["successModal",""],["userSeatsModal",""],["subscriptionFailedModal",""],["cancelSubscriptionModal",""],["cancelSubscriptionReason",""],["noLongerNeed",""],["otherReasons",""],["noReasonSelected",""],["emailNotVerifiedModal",""],["emailVerifiedConnectionModals",""],[1,"cl-row","cl-upgrade-row"],[1,"cl-col-lg-custom-4","cl-upgrade-col","cl-mb-2","cl-mb-lg-custom-0",3,"ngClass"],[1,"cl-card","cl-h-100","cl-border-bottom"],["class","cl-pumble-coupon cl-border-bottom cl-py-3",4,"ngIf"],[1,"cl-card-header","cl-border-0","cl-bg-transparent","cl-pt-3","cl-flex-column","cl-align-items-start"],["class","cl-alert cl-alert-primary cl-w-100",4,"ngIf"],["class","cl-alert cl-alert-warning cl-w-100",4,"ngIf"],[1,"cl-h2"],["class","cl-h3 cl-text-gray-6",4,"ngIf"],[1,"cl-h2","cl-text-color","cl-d-flex","cl-justify-content-between","cl-w-100"],["class","cl-h3 cl-ml-1 cl-text-gray-6",4,"ngIf"],[1,"cl-card-body","cl-py-0","cl-px-3"],[1,"cl-d-flex","cl-justify-content-between"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-d-flex","cl-align-items-start","cl-mr-2"],[1,"cl-mr-1"],[1,"cl-display-1","cl-lh-1","cl-mb-0","cl-text-gray-3"],["class","cl-align-self-end",4,"ngIf"],[1,"cl-text-gray-6","cl-small","cl-lh-1"],["class","cl-text-gray-6 cl-small cl-text-right",4,"ngIf"],[1,"cl-d-lg-custom-block"],["class","cl-list-unstyled cl-add-lh cl-ml-0",4,"ngIf"],[1,"cl-col-lg-custom-8","cl-upgrade-col"],["class","cl-row cl-h-100",4,"ngIf"],[1,"cl-d-flex","cl-justify-content-between","cl-my-3"],[1,"cl-small","cl-mb-0"],["target","_blank","href","https://clockify.me/help/"],[3,"href"],["class","cl-text-danger",3,"click",4,"ngIf"],[1,"cl-pumble-coupon","cl-border-bottom","cl-py-3"],[1,"cl-d-flex","cl-justify-content-around","cl-align-items-center"],[1,"cl-flex-1"],[1,"cl-small"],[1,"cl-color-blue","cl-font-size-lg","cl-h1",3,"click"],[1,"cl-small","cl-text-font-weight-500"],[1,"cl-d-flex","cl-justify-content-end","cl-flex-1"],["src","assets/images/pumble_coupon_illustration.svg","alt","Pumble Coupon"],[1,"cl-alert","cl-alert-primary","cl-w-100"],[1,"cl-btn",3,"click"],[1,"cl-alert","cl-alert-warning","cl-w-100"],["class","cl-btn",3,"click",4,"ngIf"],[1,"cl-h3","cl-text-gray-6"],[1,"cl-h3","cl-ml-1","cl-text-gray-6"],[1,"cl-small","cl-color-blue",3,"click"],[1,"cl-align-self-end"],[1,"cl-text-gray-6","cl-small","cl-text-right"],[1,"cl-mb-1","cl-d-flex","cl-justify-content-between"],[1,"cl-ml-1","cl-d-inline-flex",3,"click"],["src","assets/ui-icons/info-9.svg"],[3,"title"],[1,"cl-color-blue","cl-small",3,"ngClass","click"],[1,"cl-color-blue","cl-small",3,"click"],[1,"cl-progress",2,"height","5px"],["role","progressbar",1,"cl-progress-bar"],[1,"cl-mt-1"],[1,"cl-list-unstyled","cl-add-lh","cl-ml-0"],["viewBox","0 0 15 13","fill","none",1,"cl-checkmark-svg","cl-mr-1","cl-dynamic-color"],["d","M13 2L5.47368 10L2 6.30769"],[4,"ngFor","ngForOf"],["class","cl-ml-1 cl-d-inline-flex",3,"click",4,"ngIf"],[1,"cl-h3"],["fragment","plans",3,"routerLink"],[1,"cl-mt-3"],[1,"cl-row","cl-h-100"],[1,"cl-col-lg-6","cl-mb-2","cl-mb-lg-0"],[1,"cl-h-100","cl-pt-2","cl-px-3","cl-bg-white","cl-border","cl-rounded"],[1,"cl-pt-2"],[1,"cl-d-flex","cl-flex-wrap","cl-justify-content-start","cl-align-items-center","cl-mb-3"],[1,"cl-h1","cl-mr-3"],[1,"cl-btn","cl-btn-sm","cl-btn-primary",3,"click"],[1,"cl-text-gray-9"],[1,"cl-col-lg-6"],[1,"cl-text-danger",3,"click"],[3,"type","close"],[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[3,"editInvoiceInformation","workspaceName","mode","turnAddress"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"disabled","click"],[3,"editPaymentInformation","invoiceInformation","mode","isMonthly","paymentFailedMessage","closeDialog","paymentInformation"],["stripe",""],[1,"cl-modal-title","cl-text-center"],[1,"cl-modal-body","cl-text-center"],["class","cl-mb-3 cl-m-0 cl-pr-0 cl-pl-0 cl-alert cl-alert-info cl-alert-reset-main cl-alert-dismissible cl-fade cl-show cl-d-flex cl-justify-content-around",4,"ngIf"],["src","assets/images/pumble_coupon_illustration.svg","alt",""],[1,"cl-text-uppercase","cl-small","cl-py-1","cl-mt-3","cl-text-gray-9"],[1,"cl-h1","cl-py-1"],[1,"cl-small","cl-px-3","cl-py-1","cl-text-gray-6"],["href","https://pumble.com/pricing","target","_blank"],[1,"cl-small","cl-text-gray-6","cl-mt-1"],["ngbAutofocus","",1,"cl-color-blue",3,"click"],["ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-mb-3","cl-m-0","cl-pr-0","cl-pl-0","cl-alert","cl-alert-info","cl-alert-reset-main","cl-alert-dismissible","cl-fade","cl-show","cl-d-flex","cl-justify-content-around"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-primary","cl-text-uppercase",3,"click"],[1,"cl-modal-body","cl-text-center","cl-py-4"],[1,"cl-mb-3"],["src","assets/images/illustrations/reactivate.svg",1,"cl-img-fluid"],[1,"cl-h1","cl-mb-2","cl-text-gray-3"],[1,"cl-mb-0","cl-text-gray-6"],[1,"cl-btn","cl-btn-primary",3,"click"],[3,"disableButton","workspace","type","price","pay","closeModal"],["src","assets/images/illustrations/success.svg",1,"cl-img-fluid"],[1,"cl-mb-0","cl-text-gray-6","cl-text-break"],[3,"activeUsers","currentQuantity","unusedSeats","isAdd","inProgress","currentType","amount","closeModal","saveQuantity"],[3,"close"],[3,"closeModal","openCancelSubscriptionReasonModal"],[3,"isLegacy","closeModal","openConfirmCancellationModal","cancellationReason"],[3,"closeModal","cancelSubscription"],[3,"reason","closeModal","cancelSubscription"],[3,"workspaceId","integration","pumbleSettings","close"]],template:function(e,t){1&e&&(s.Xc(0,AV,65,51,"ng-container",0),s.Xc(1,OV,1,1,"ng-template",null,1,s.Yc),s.Xc(3,vV,16,13,"ng-template",null,2,s.Yc),s.Xc(5,TV,10,8,"ng-template",null,3,s.Yc),s.Xc(7,LV,35,28,"ng-template",null,4,s.Yc),s.Xc(9,yV,19,23,"ng-template",null,5,s.Yc),s.Xc(11,_V,1,4,"ng-template",null,6,s.Yc),s.Xc(13,WV,13,12,"ng-template",null,7,s.Yc),s.Xc(15,XV,1,7,"ng-template",null,8,s.Yc),s.Xc(17,NV,1,0,"ng-template",null,9,s.Yc),s.Xc(19,DV,1,0,"ng-template",null,10,s.Yc),s.Xc(21,PV,1,1,"ng-template",null,11,s.Yc),s.Xc(23,MV,1,0,"ng-template",null,12,s.Yc),s.Xc(25,BV,1,1,"ng-template",null,13,s.Yc),s.Xc(27,UV,1,0,"ng-template",null,14,s.Yc),s.Xc(29,GV,1,0,"ng-template",null,15,s.Yc),s.Xc(31,xV,1,3,"ng-template",null,16,s.Yc)),2&e&&s.wc("ngIf",t.payment)},directives:[i.u,i.r,i.t,k.g,BC,Lw,Bw,DC,mD,yC,qj,eZ,iZ,cZ,aZ,Uu,Qu],pipes:[g.e,i.q,i.g],encapsulation:2}),e})();function jV(e,t){if(1&e&&(s.Xb(0,"a",18),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc().$implicit;s.xc("href",e.invoicePdf,s.Qc),s.Cb(1),s.ad(s.pc(2,2,"SUBSCRIPTION_TABS.INVOICES.DOWNLOAD_INVOICE_BTN"))}}function ZV(e,t){if(1&e&&(s.Xb(0,"a",19),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc().$implicit;s.xc("href",e.invoicePay,s.Qc),s.Cb(1),s.bd("",s.pc(2,2,"SUBSCRIPTION_TABS.INVOICES.PAY_INVOICE_BTN")," ")}}function VV(e,t){if(1&e&&(s.Xb(0,"tr"),s.Xb(1,"td",11),s.Xb(2,"div",12),s.Xb(3,"span"),s.Zc(4),s.Wb(),s.Wb(),s.Wb(),s.Xb(5,"td",13),s.Xb(6,"div",14),s.Xb(7,"span"),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(10,"td",8),s.Xb(11,"span"),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Xb(14,"td",11),s.Xb(15,"div",15),s.Xc(16,jV,3,4,"a",16),s.Xc(17,ZV,3,4,"a",17),s.Wb(),s.Wb(),s.Wb()),2&e){const e=t.$implicit,n=s.nc();s.Cb(4),s.ad(e.date),s.Cb(4),s.ad(s.pc(9,6,n.statusLabels.get(e.status.toUpperCase()))),s.Cb(4),s.cd("",e.amount," ",s.pc(13,8,"SUBSCRIPTION_TABS.INVOICES.USD_CUR"),""),s.Cb(4),s.wc("ngIf",e.invoicePdf),s.Cb(1),s.wc("ngIf","open"===e.status)}}let YV=(()=>{class e{constructor(e,t,n){this.paymentService=e,this.workspaceService=t,this.cd=n,this.unsubscribe$=new p.a,this.statusLabels=new Map([[jn.a.PAID.toUpperCase(),"INVOICES.SHARED.PAID_LABEL"],[jn.a.SENT.toUpperCase(),"INVOICES.SHARED.SENT_LABEL"],[jn.a.UNSENT.toUpperCase(),"INVOICES.SHARED.UNSENT_LABEL"],[jn.a.VOID.toUpperCase(),"INVOICES.SHARED.VOID_LABEL"]])}ngOnInit(){this.paymentService.invoices$.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.invoices=e,this.cd.markForCheck()}),this.paymentService.getInvoices()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(dC.a),s.Rb(l.a),s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["invoices"]],decls:25,vars:13,consts:[[1,"cl-card","cl-border-bottom-0","cl-mb-0"],[1,"cl-card-header","cl-border-bottom-0","cl-pl-2","cl-pl-lg-3","cl-pr-0"],[1,"cl-h6","cl-mb-0"],[1,"cl-page-component-wrapper","cl-mb-0"],[1,"cl-table-responsive"],[1,"cl-table","cl-table-bordered","cl-remove-cell-borders","cl-text-gray-6"],[1,"cl-pl-lg-3"],[1,"cl-h5"],[1,"cl-pr-lg-3","cl-text-right"],[1,"cl-px-0"],[4,"ngFor","ngForOf"],[1,"cl-p-0"],[1,"cl-py-2","cl-px-2","cl-px-lg-3"],[1,"cl-pr-lg-3"],[1,"cl-component-divided-left","cl-justify-content-start","cl-pl-2","cl-pl-lg-3"],[1,"cl-component-divided-left","cl-w-100","cl-py-2","cl-px-2","cl-px-lg-3"],["class","cl-d-inline-block cl-ml-lg-auto cl-color-blue",3,"href",4,"ngIf"],["class","cl-d-inline-block cl-ml-lg-auto cl-color-blue","target","_blank",3,"href",4,"ngIf"],[1,"cl-d-inline-block","cl-ml-lg-auto","cl-color-blue",3,"href"],["target","_blank",1,"cl-d-inline-block","cl-ml-lg-auto","cl-color-blue",3,"href"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"span",2),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(5,"div",3),s.Xb(6,"div",4),s.Xb(7,"table",5),s.Xb(8,"thead"),s.Xb(9,"tr"),s.Xb(10,"th",6),s.Xb(11,"span",7),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Xb(14,"th",6),s.Xb(15,"span",7),s.Zc(16),s.oc(17,"translate"),s.Wb(),s.Wb(),s.Xb(18,"th",8),s.Xb(19,"span",7),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Wb(),s.Sb(22,"th",9),s.Wb(),s.Wb(),s.Xb(23,"tbody"),s.Xc(24,VV,18,10,"tr",10),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.ad(s.pc(4,5,"SUBSCRIPTION_TABS.INVOICES.PAST_BILLING_HEADER")),s.Cb(9),s.ad(s.pc(13,7,"GLOBAL.DATE_LABEL")),s.Cb(4),s.ad(s.pc(17,9,"GLOBAL.STATUS_LABEL")),s.Cb(4),s.ad(s.pc(21,11,"GLOBAL.AMOUNT_LABEL")),s.Cb(4),s.wc("ngForOf",t.invoices))},directives:[i.t,i.u],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function HV(e,t){if(1&e){const e=s.Yb();s.Xb(0,"li",6),s.Xb(1,"a",7),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.activatePill(t.SubscriptionPills.PAYMENT)})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.Hb("cl-active",e.activePill===e.SubscriptionPills.PAYMENT),s.Cb(1),s.bd(" ",s.pc(3,3,"SUBSCRIPTION_TABS.PAYMENT_LABEL")," ")}}function $V(e,t){if(1&e){const e=s.Yb();s.Xb(0,"li",6),s.Xb(1,"a",7),s.jc("click",(function(){s.Oc(e);const t=s.nc();return t.activatePill(t.SubscriptionPills.PLANS)})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.Hb("cl-active",e.activePill===e.SubscriptionPills.PLANS),s.Cb(1),s.bd(" ",s.pc(3,3,"SUBSCRIPTION_TABS.PLANS_LABEL")," ")}}function KV(e,t){1&e&&s.Sb(0,"subscription-payment")}function qV(e,t){if(1&e&&(s.Vb(0),s.Xc(1,KV,1,0,"subscription-payment",12),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.activePill===e.SubscriptionPills.PAYMENT)}}function zV(e,t){1&e&&s.Sb(0,"invoices")}function QV(e,t){1&e&&s.Sb(0,"upgrade")}function JV(e,t){if(1&e&&(s.Vb(0),s.Xc(1,QV,1,0,"upgrade",12),s.Ub()),2&e){const e=s.nc();s.Cb(1),s.wc("ngIf",e.activePill===e.SubscriptionPills.PLANS)}}let eY=(()=>{class e{constructor(e,t,n,i,s,c,a){this.workspaceService=e,this.userService=t,this.paymentService=n,this.activatedRoute=i,this.router=s,this.cd=c,this.loader=a,this.SubscriptionPills=Yj,this.unsubscribe$=new Fn.a}ngOnInit(){this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isEnterprise2021Ws=Object(mo.f)(e.featureSubscriptionType)}),this.activatedRoute.fragment.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{const t=Yj[(e||"").toUpperCase()];this.activePill=t||Yj.PAYMENT,this.activatedRoute.snapshot.queryParamMap.get("plan")}),this.paymentService.getPaymentInformation().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.hasPaymentInfo=!!e.cardHolder});const e=this.paymentService.getEverHadSubscription$(),t=this.paymentService.getInvoices$(),n=this.workspaceService.getPaymentDate$();this.loader.show(),Object(Sb.a)(e,t,n).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.everHadPaidSubscription=e[0],this.hasOpenInvoice=e[1]&&e[1].some(e=>"open"===e.status),this.hasPaidInvoice=e[1]&&e[1].some(e=>"paid"===e.status),this.isPaid=e[2].paid,this.cd.markForCheck(),this.checkTabPermission(),this.loader.hide()},e=>{this.loader.hide()})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}get showPlans(){return!(this.hasPaidInvoice&&!this.hasPaymentInfo&&!this.everHadPaidSubscription||this.hasOpenInvoice||this.isEnterprise2021Ws&&!1!==this.isPaid)}activatePill(e){this.activePill=e,this.router.navigate([],{fragment:e.toString().toLowerCase()})}get showPayment(){return this.everHadPaidSubscription||this.isPaid}checkTabPermission(){this.activePill!==Yj.PLANS||this.showPlans||this.activatePill(Yj.PAYMENT),this.activePill!==Yj.PAYMENT||this.showPayment||this.activatePill(Yj.INVOICES),this.activePill===Yj.INVOICES&&this.showPayment&&this.activatePill(Yj.PAYMENT)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(Lc.a),s.Rb(dC.a),s.Rb(k.a),s.Rb(k.d),s.Rb(s.h),s.Rb(Hn.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["subscription-tabs"]],decls:18,vars:10,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-scroll-tabs-wrapper"],["tabs","",1,"cl-nav","cl-nav-tabs","cl-m-0","cl-scroll-tabs"],["tabs","tabs"],["class","cl-nav-item",4,"ngIf"],[1,"cl-nav-item"],[1,"cl-nav-link",3,"click"],[1,"cl-card"],[1,"cl-card-body"],[1,"cl-tab-content"],[1,"cl-tab-pane","cl-fade","cl-active","cl-show"],[4,"ngIf"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"ul",3,4),s.Xc(5,HV,4,5,"li",5),s.Xb(6,"li",6),s.Xb(7,"a",7),s.jc("click",(function(){return t.activatePill(t.SubscriptionPills.INVOICES)})),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Xc(10,$V,4,5,"li",5),s.Wb(),s.Wb(),s.Xb(11,"div",8),s.Xb(12,"div",9),s.Xb(13,"div",10),s.Xb(14,"div",11),s.Xc(15,qV,2,1,"ng-container",12),s.Xc(16,zV,1,0,"invoices",12),s.Xc(17,JV,2,1,"ng-container",12),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(5),s.wc("ngIf",t.showPayment),s.Cb(2),s.Hb("cl-active",t.activePill===t.SubscriptionPills.INVOICES),s.Cb(1),s.bd(" ",s.pc(9,8,"GLOBAL.INVOICES_LABEL")," "),s.Cb(2),s.wc("ngIf",t.showPlans),s.Cb(5),s.wc("ngIf",t.showPayment),s.Cb(1),s.wc("ngIf",t.activePill===t.SubscriptionPills.INVOICES),s.Cb(1),s.wc("ngIf",t.showPlans))},directives:[lo.a,i.u,FV,YV,_A],pipes:[g.e],encapsulation:2}),e})(),tY=(()=>{class e{constructor(e){this.router=e}canActivate(){const e=bo.a.environment.selfHosted;return e&&this.router.navigate(["/tracker"]),!e}}return e.\u0275fac=function(t){return new(t||e)(s.fc(k.d))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})(),nY=(()=>{class e{constructor(e,t,n,i){this.workspaceService=e,this.router=t,this.paymentService=n,this.authService=i}canActivate(e){return e.data||console.warn("HadSubscriptionGuard: missing data"),this.authService.permissionData$.pipe(Object(Zt.a)(e=>null!==e),Object(ln.a)(1)).pipe(Object(yb.a)(t=>t.isAdminOrOwner?this.getHasInvoiceData(e):(this.router.navigate(["tracker"]),Object(Yt.a)(!1))))}getHasInvoiceData(e){return"boolean"==typeof this.paymentService.hasInvoice$.getValue()||this.paymentService.getInvoices(),this.paymentService.hasInvoice$.pipe(Object(Zt.a)(e=>null!==e),Object(ln.a)(1),Object(d.a)(t=>{var n;const i=null===(n=e.data)||void 0===n?void 0:n.allowIfHasInvoice;if(i&&t)return!0;if(!i&&!t)return!0;if("subscription"===e.data.redirectionPage){const t={fragment:Yj.PLANS};e.queryParamMap.get("plan")&&(t.queryParams={plan:e.queryParamMap.get("plan")}),this.router.navigate([e.data.redirectionPage],t)}else this.router.navigate([e.data.redirectionPage]);return!1}))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(l.a),s.fc(k.d),s.fc(dC.a),s.fc(re.a))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})(),iY=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(){const e=this.workspaceService.getDefaultWorkspaceId(),t=this.workspaceService.paymentMap$.getValue();return t&&t.has(e)||this.workspaceService.getPaymentDate(),this.workspaceService.paymentMap$.pipe(Object(Zt.a)(e=>null!==e),Object(Zt.a)(t=>t.has(e)),Object(ln.a)(1),Object(d.a)(t=>{const n=t.get(e);if(!n.paid||n.type!==mo.b.ENTERPRISE_2021&&n.type!==mo.b.ENTERPRISE_YEAR_2021)return!0;this.router.navigate(["tracker"])}))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(l.a),s.fc(k.d))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var sY=function(e){return e.TAGS="TAGS",e.CLIENTS="CLIENTS",e}({});function cY(e,t){if(1&e&&(s.Xb(0,"div",10),s.Xb(1,"div",11),s.Zc(2),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.bd(" ",e.itemAddress," ")}}function aY(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",17),s.jc("click",(function(){return s.Oc(e),s.nc(2).onArchive.emit(!0)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.ARCHIVE_LABEL")," "))}function oY(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",18),s.jc("click",(function(){return s.Oc(e),s.nc(2).onArchive.emit(!1)})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.RESTORE_LABEL")," "))}function rY(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",19),s.jc("click",(function(){return s.Oc(e),s.nc(2).onDelete.emit()})),s.Zc(1),s.oc(2,"translate"),s.Wb()}2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"GLOBAL.DELETE_BTN")," "))}function lY(e,t){if(1&e&&(s.Xb(0,"div",12),s.Xb(1,"div",13),s.Xc(2,aY,3,3,"a",14),s.Xc(3,oY,3,3,"a",15),s.Xc(4,rY,3,3,"a",16),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.wc("ngIf",!e.isArchived),s.Cb(1),s.wc("ngIf",e.isArchived),s.Cb(1),s.wc("ngIf",e.isArchived)}}let bY=(()=>{class e{constructor(){this.onEdit=new s.n,this.onDelete=new s.n,this.onArchive=new s.n,this.hasSecondColumn=!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["entity-row"]],inputs:{itemName:"itemName",itemAddress:"itemAddress",isArchived:"isArchived",hasSecondColumn:"hasSecondColumn"},outputs:{onEdit:"onEdit",onDelete:"onDelete",onArchive:"onArchive"},decls:13,vars:7,consts:[[1,"cl-d-flex","cl-flex-column","cl-flex-lg-row","cl-w-100","cl-align-items-start","cl-align-items-lg-center"],[1,"cl-px-2","cl-px-lg-3","cl-py-3","cl-cut-text","cl-w-100","cl-w-lg-auto","cl-clients-table-col-1"],["class","cl-component-divided-left cl-remove-divider-mob cl-pl-2 cl-pl-lg-1 cl-pb-3 cl-pb-lg-0 cl-justify-content-start cl-clients-table-col-2",4,"ngIf"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-end","cl-template-separator-mob","cl-min-height-40","cl-w-100","cl-w-lg-auto","cl-ml-auto"],[1,"cl-component-divided-left","cl-no-divider-border-down-md","cl-px-2",3,"title","click"],["src","assets/images/ui-icons/edit.svg",1,"cl-px-1"],["dropdown","",1,"cl-dropdown","cl-d-flex","cl-justify-content-lg-custom-end","cl-w-100","pointer"],["closeDropdown","","role","button",1,"cl-component-divided-left","cl-d-flex","cl-dropdown-toggle","cl-no-arrow"],["src","assets/images/ui-icons/menu-dots-vertical.svg",1,"cl-px-2"],["class","cl-dropdown-menu cl-dropdown-menu-right",4,"dropdownContent"],[1,"cl-component-divided-left","cl-remove-divider-mob","cl-pl-2","cl-pl-lg-1","cl-pb-3","cl-pb-lg-0","cl-justify-content-start","cl-clients-table-col-2"],[1,"cl-cut-text"],[1,"cl-dropdown-menu","cl-dropdown-menu-right"],[1,"cl-scroll-area"],["class","cl-dropdown-item","closeDropdown","","data-cy","archive",3,"click",4,"ngIf"],["class","cl-dropdown-item","closeDropdown","","data-cy","restore-client",3,"click",4,"ngIf"],["class","cl-dropdown-item","closeDropdown","","data-cy","delete-client",3,"click",4,"ngIf"],["closeDropdown","","data-cy","archive",1,"cl-dropdown-item",3,"click"],["closeDropdown","","data-cy","restore-client",1,"cl-dropdown-item",3,"click"],["closeDropdown","","data-cy","delete-client",1,"cl-dropdown-item",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div"),s.Xb(1,"div",0),s.Xb(2,"div",1),s.Zc(3),s.Wb(),s.Xc(4,cY,3,1,"div",2),s.Xb(5,"div",3),s.Xb(6,"a",4),s.jc("click",(function(){return t.onEdit.emit()})),s.oc(7,"translate"),s.Sb(8,"img",5),s.Wb(),s.Xb(9,"div",6),s.Xb(10,"div",7),s.Sb(11,"img",8),s.Wb(),s.Xc(12,lY,5,3,"div",9),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.Wc("text-decoration",t.isArchived?"line-through":""),s.Cb(1),s.ad(t.itemName),s.Cb(1),s.wc("ngIf",t.hasSecondColumn),s.Cb(2),s.xc("title",s.pc(7,5,"GLOBAL.EDIT_LABEL")))},directives:[i.u,Nc.a,Dc.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();var dY=n("nAmH");function uY(e,t){1&e&&(s.Xb(0,"span",10),s.Zc(1,"&"),s.Wb())}function pY(e,t){1&e&&(s.Xb(0,"span",11),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.ADDRESS_LABEL")))}function hY(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"entity-row",12),s.jc("onEdit",(function(){s.Oc(e);const n=t.$implicit,i=s.nc(),c=s.Lc(11),a=s.Lc(9);return i.openModal(n,i.hasSecondColumn?c:a)}))("onDelete",(function(){s.Oc(e);const n=t.$implicit,i=s.nc(),c=s.Lc(13);return i.openModal(n,c)}))("onArchive",(function(n){s.Oc(e);const i=t.$implicit,c=s.nc(),a=s.Lc(15);return c.archiveProjects=!1,c.openModal(i,a,n)})),s.Wb(),s.Ub()}if(2&e){const e=t.$implicit,n=s.nc();s.Cb(1),s.wc("itemName",e.name)("itemAddress",e.address)("isArchived",e.archived)("hasSecondColumn",n.hasSecondColumn)}}const mY=function(e){return{label:e}};function gY(e,t){if(1&e){const e=s.Yb();s.Xb(0,"rename-modal",13),s.jc("editedValue",(function(n){s.Oc(e);const i=t.$implicit,c=s.nc();return c.editItem(n,c.selected.address),i.close()}))("isOpen",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.qc(1,2,"WORKSPACE.EDIT_LABEL",s.Bc(5,mY,e.label)))("inputValue",e.selected.name)}}function EY(e,t){if(1&e){const e=s.Yb();s.Xb(0,"edit-client-modal",14),s.jc("onEdit",(function(n){s.Oc(e);const i=t.$implicit;return s.nc().editItem(n.name,n.address),i.close()}))("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.qc(1,3,"WORKSPACE.EDIT_LABEL",s.Bc(6,mY,e.label)))("item",e.selected)("clientLabel",e.label)}}const fY=function(e){return{value:e}};function SY(e,t){if(1&e&&(s.Xb(0,"span",19),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.qc(2,1,"WORKSPACE.GENERAL_SETTINGS.TIME_APPROVAL.WARNING_FOR_TAG",s.Bc(4,fY,e.selected.name))," ")}}function CY(e,t){if(1&e&&(s.Xb(0,"p",20),s.Zc(1),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",e.infoMessageForDelete," ")}}function AY(e,t){if(1&e){const e=s.Yb();s.Xb(0,"delete-confirm-modal",15),s.jc("onDelete",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return i.deleteItem(i.selected),n.close()}))("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",16),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,SY,3,6,"span",17),s.Xc(7,CY,2,1,"p",18),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,8,"GLOBAL.DELETE_BTN"))("btnText",s.pc(2,10,"GLOBAL.DELETE_BTN"))("showConfirmation",e.timeApprovalEnabled&&e.entity===e.EntityTab.TAGS),s.Cb(3),s.wc("ngClass",e.infoMessageForDelete?"cl-h2 cl-cut-text-wrap":"cl-text-muted cl-cut-text-wrap cl-mb-0"),s.Cb(1),s.cd(" ",s.pc(5,12,"WORKSPACE.DELETE.CONFIRM")," ",e.selected.name,"? "),s.Cb(2),s.wc("ngIf",e.timeApprovalEnabled&&e.entity===e.EntityTab.TAGS),s.Cb(1),s.wc("ngIf",e.infoMessageForDelete)}}function OY(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",23),s.Xb(1,"div",24),s.Xb(2,"input",25),s.jc("ngModelChange",(function(t){return s.Oc(e),s.nc(2).archiveProjects=t})),s.Wb(),s.Xb(3,"label",26),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc(2);s.Cb(2),s.wc("ngModel",e.archiveProjects),s.Cb(2),s.cd(" ",s.pc(5,3,"WORKSPACE.ARCHIVE.CHECK_FOR_PROJECT")," ",e.label," ")}}function vY(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",21),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit;return s.nc().archiveOrRestore(),n.close()}))("close",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",16),s.Zc(4),s.oc(5,"translate"),s.oc(6,"translate"),s.Wb(),s.Xc(7,OY,6,5,"div",22),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,7,e.isArchived?"GLOBAL.ARCHIVE_LABEL":"GLOBAL.RESTORE_LABEL"))("btnText",s.pc(2,9,e.isArchived?"GLOBAL.ARCHIVE_LABEL":"GLOBAL.RESTORE_LABEL"))("isDanger",!0),s.Cb(3),s.wc("ngClass",e.infoMessageForDelete?"cl-h2 cl-cut-text-wrap":"cl-text-muted cl-cut-text-wrap cl-mb-0"),s.Cb(1),s.cd(" ",e.isArchived?s.pc(5,11,"WORKSPACE.ARCHIVE.CONFIRM_ACTION"):s.pc(6,13,"WORKSPACE.RESTORE.CONFIRM_ACTION")," ",e.selected.name,"? "),s.Cb(3),s.wc("ngIf",e.isArchived&&e.entity===e.EntityTab.CLIENTS)}}let TY=(()=>{class e{constructor(e,t,n,i,c){this.toaster=e,this.cd=t,this.modalService=n,this.workspaceService=i,this.translateService=c,this.hasSecondColumn=!1,this.onEditItem=new s.n,this.onDeleteItem=new s.n,this.EntityTab=sY,this.sortByNameMapper=e=>e.name}ngOnInit(){this.timeApprovalEnabled=this.workspaceService.getLocalDefaultWorkspace().timeApprovalEnabled}editItem(e,t){if(!this.hasSecondColumn&&this.items.filter(t=>t.name===e.trim()).length>0){const t=this.translateService.instant("WORKSPACE.ENTITY_TABLE.LABEL_NAME_EXISTS_ERROR_MSG",{labelName:Object(u_.a)(this.label),newLabelName:e});return void this.toaster.error(t)}const n={name:this.selected.name,archived:this.selected.archived};this.selected.name=e,this.entity===sY.CLIENTS&&(this.selected.address=t,n.address=this.selected.address),this.onEditItem.emit({item:this.selected,backup:n})}archiveOrRestore(){const e={name:this.selected.name,archived:this.isArchived};this.selected.archived=this.isArchived,this.onEditItem.emit({item:this.selected,archiveProjects:this.archiveProjects,backup:e})}openModal(e,t,n){this.selected=e,this.setInfoMessage(e),this.isArchived=n,this.modalService.open(t,{centered:!0})}deleteItem(e){const t=this.items.indexOf(e);this.onDeleteItem.emit(this.items[t])}setInfoMessage(e){switch(this.entity){case sY.TAGS:this.infoMessageForDelete=this.translateService.instant("WORKSPACE.ENTITY_TABLE.DELETE_TAG_MSG",{tagName:e.name});break;case sY.CLIENTS:this.infoMessageForDelete=this.translateService.instant("WORKSPACE.ENTITY_TABLE.DELETE_CLIENT_MSG",{clientName:e.name,clientLabel:this.label})}}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(r.a),s.Rb(s.h),s.Rb(w.q),s.Rb(l.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["entity-table"]],inputs:{items:"items",entity:"entity",label:"label",hasSecondColumn:"hasSecondColumn"},outputs:{onEditItem:"onEditItem",onDeleteItem:"onDeleteItem"},decls:16,vars:8,consts:[[1,"cl-card","cl-mb-1","cl-mb-lg-2","cl-border-bottom"],[1,"cl-card-header","cl-px-2","cl-px-lg-3",2,"justify-content","start"],[1,"cl-h6","cl-mb-0","cl-mr-1","cl-mr-lg-0","cl-clients-table-col-1"],["class","cl-h6 cl-mb-0 cl-d-inline cl-d-lg-none cl-mr-1",4,"ngIf"],["class","cl-h6 cl-mb-0 cl-clients-table-col-2",4,"ngIf"],[4,"ngFor","ngForOf"],["renameModal",""],["editFullModal",""],["deleteModal",""],["archiveModal",""],[1,"cl-h6","cl-mb-0","cl-d-inline","cl-d-lg-none","cl-mr-1"],[1,"cl-h6","cl-mb-0","cl-clients-table-col-2"],[1,"cl-component-row","cl-component-row-divide-md","cl-px-0","cl-d-block",3,"itemName","itemAddress","isArchived","hasSecondColumn","onEdit","onDelete","onArchive"],[3,"title","inputValue","editedValue","isOpen"],[3,"title","item","clientLabel","onEdit","onClose"],[3,"title","btnText","showConfirmation","onDelete","onClose"],[3,"ngClass"],["class","cl-alert cl-alert-warning cl-justify-content-center ng-star-inserted",4,"ngIf"],["class","cl-text-muted cl-cut-text-wrap cl-mb-0",4,"ngIf"],[1,"cl-alert","cl-alert-warning","cl-justify-content-center","ng-star-inserted"],[1,"cl-text-muted","cl-cut-text-wrap","cl-mb-0"],[3,"title","btnText","isDanger","confirmed","close"],["class","cl-form-group cl-mb-0",4,"ngIf"],[1,"cl-form-group","cl-mb-0"],[1,"cl-custom-control","cl-custom-checkbox"],["type","checkbox","id","customCheck1",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","customCheck1",1,"cl-custom-control-label"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"span",2),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Xc(5,uY,2,0,"span",3),s.Xc(6,pY,3,3,"span",4),s.Wb(),s.Xc(7,hY,2,4,"ng-container",5),s.Wb(),s.Xc(8,gY,2,7,"ng-template",null,6,s.Yc),s.Xc(10,EY,2,8,"ng-template",null,7,s.Yc),s.Xc(12,AY,8,14,"ng-template",null,8,s.Yc),s.Xc(14,vY,8,15,"ng-template",null,9,s.Yc)),2&e&&(s.Hb("cl-has-second-column",t.hasSecondColumn),s.Cb(3),s.ad(s.pc(4,6,"GLOBAL.NAME_LABEL")),s.Cb(2),s.wc("ngIf",t.hasSecondColumn),s.Cb(1),s.wc("ngIf",t.hasSecondColumn),s.Cb(1),s.wc("ngForOf",t.items))},directives:[i.u,i.t,bY,dY.a,Gs,Xd.a,i.r,Si.a,v.a,v.s,v.v],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function IY(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",20),s.Xb(1,"pager",21,22),s.jc("pageChanged",(function(t){return s.Oc(e),s.nc().pageChanged(t)}))("limitChanged",(function(t){return s.Oc(e),s.nc().limitChanged(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.wc("page",null==e.pagination?null:e.pagination.page)("limit",null==e.pagination?null:e.pagination.pageSize)}}const wY=function(e){return{label:e}};let LY=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r){this.router=e,this.activatedRoute=t,this.tagService=n,this.workspaceService=i,this.formBuilder=s,this.uiSettingsService=c,this.cd=a,this.translateService=o,this.analyticsService=r,this._searchName="",this.items=[],this.pageDebouncer$=new p.a,this.searchDebouncer$=new p.a,this.unsubscribe$=new p.a,this.label="tag",this.EntityTab=sY,this.statusDropdownValues=[new Ea.a(Rn.a.ACTIVE,this.translateService.instant("TEAMS.MEMBERS.STATUS_LABELS.ACTIVE_LABEL")),new Ea.a(Rn.a.ARCHIVED,this.translateService.instant("GLOBAL.SHOW_ARCHIVED_LABEL")),new Ea.a(Rn.a.ALL,this.translateService.instant("GLOBAL.SHOW_ALL_LABEL"))],this.entityStatus=this.statusDropdownValues[0].value}set searchName(e){this._searchName=e,this.searchDebouncer$.next(this.searchName)}get searchName(){return this._searchName}ngOnInit(){this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>this.workspace=e),this.createForm=this.formBuilder.group({name:["",[Bi.a.required]],inProgress:[!1,[Bi.a.requiredFalse]]}),this.initPagination(),this.subscribeToData(),this.getRouteParamsFromUrl(),this.setRouteDebouncer(),this.setSearchDebouncer()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}subscribeToData(){this.tagService.tags.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(this.onSuccessGetData.bind(this))}onSuccessGetData(e){const t=e.length<this.pagination.pageSize,n=e.length;this.items=e,this.isMultiplePages=this.pagination.page>1||n>=In.j||n>=this.pagination.pageSize,this.cd.detectChanges(),this.pager&&!this.reachedTheLimit&&this.pager.allowNextPage(!t)}setInProgress(e){this.createForm.patchValue({inProgress:e})}setName(e){this.createForm.patchValue({name:e})}trimName(){const e=Object(sn.H)(this.createForm.value.name);this.setName(e)}getData(e){this.tagService.getAllTagsV1(e,this.workspace.id,Object.assign(Object.assign({},this.pagination),{name:this.searchName})).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(this.onSuccessGetData.bind(this))}createItem(){this.trimName();const e=this.createForm.value.name;this.setInProgress(!0),this.tagService.create(e,this.workspace.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.items.unshift(e),this.setName(""),this.setInProgress(!1),this.entityTable.cd.detectChanges(),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"add",amount:"",section:"Tags"}))},()=>this.setInProgress(!1))}editItem({item:e,backup:t}){this.tagService.clearTagsSubject(),this.tagService.update(e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(null,n=>{e.name=t.name,this.entityTable.cd.detectChanges()})}deleteItem(e){this.tagService.delete(e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.items=this.items.filter(t=>t.id!==e.id),0===this.items.length&&this.pagination.page>1&&(this.pagination.page--,this.getData(this.entityStatus)),this.cd.detectChanges(),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"delete",amount:"",section:"Tags"}))})}pageChanged(e){if(this.pagination.page>e.page)this.reachedTheLimit=!1;else if(this.reachedTheLimit)return;this.pagination.page=e.page,this.pageDebouncer$.next()}limitChanged(e){this.reachedTheLimit=!1,this.pagination.page=1,this.pagination.pageSize=e.limit,this.pageDebouncer$.next()}initPagination(){const e=this.uiSettingsService.getSettings(xn.b.ENTITY_PAGESIZE);this.pagination={page:1,pageSize:e||In.j}}setSearchDebouncer(){this.searchDebouncer$.pipe(Object(De.a)(350),Object(Lh.a)(),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.pagination.page=1,this.getData(this.entityStatus)})}setRouteDebouncer(){this.pageDebouncer$.pipe(Object(De.a)(350),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.router.navigate([],{queryParams:this.pagination,relativeTo:this.activatedRoute})})}getRouteParamsFromUrl(){this.activatedRoute.queryParams.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{Object(sn.u)(e.page)&&e.page>0&&(this.pagination.page=Number(e.page)),Object(sn.u)(e.pageSize)&&e.pageSize>0&&e.pageSize<=200&&(this.pagination.pageSize=Number(e.pageSize)),this.getData(this.entityStatus)})}filterEntity(e){this.entityStatus=e,this.getData(e),this.cd.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.d),s.Rb(k.a),s.Rb(vn.a),s.Rb(l.a),s.Rb(v.f),s.Rb(xn.a),s.Rb(s.h),s.Rb(g.f),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["entity-tab"]],viewQuery:function(e,t){var n;1&e&&(s.gd(TY,!0),s.gd(Pi.a,!0)),2&e&&(s.Kc(n=s.kc())&&(t.entityTable=n.first),s.Kc(n=s.kc())&&(t.pager=n.first))},decls:28,vars:24,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center"],[1,"cl-col"],[1,"cl-text-capitalize"],[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-d-flex","cl-col-lg-custom-9","cl-mb-2","cl-mb-lg-custom-0"],[1,"cl-d-inline-block",3,"list","value","onChanged"],[1,"cl-form-group","cl-mb-2","cl-mb-lg-custom-0","cl-ml-2","cl-w-1"],["type","text",1,"cl-form-control",3,"ngModel","placeholder","ngModelChange"],[1,"cl-col-lg-custom-3"],[1,"cl-form-group","cl-mb-0"],[1,"cl-form-row",3,"formGroup","ngSubmit"],["type","text","autocomplete","off","preventMultipleSpaces","","formControlName","name",1,"cl-form-control",3,"placeholder","blur"],[1,"cl-col-auto"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"],[3,"items","label","entity","onEditItem","onDeleteItem"],["entityTable",""],["class","cl-mt-2 cl-mt-lg-3",4,"ngIf"],[1,"cl-mt-2","cl-mt-lg-3"],[3,"page","limit","pageChanged","limitChanged"],["pager",""]],template:function(e,t){1&e&&(s.Xb(0,"main",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"h1",5),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(8,"div",6),s.Xb(9,"div",3),s.Xb(10,"div",7),s.Xb(11,"dropdown-items",8),s.jc("onChanged",(function(e){return t.filterEntity(e)})),s.Wb(),s.Xb(12,"div",9),s.Xb(13,"input",10),s.jc("ngModelChange",(function(e){return t.searchName=e})),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(15,"div",11),s.Xb(16,"div",12),s.Xb(17,"form",13),s.jc("ngSubmit",(function(){return t.createItem()})),s.Xb(18,"div",4),s.Xb(19,"input",14),s.jc("blur",(function(){return t.trimName()})),s.oc(20,"translate"),s.Wb(),s.Wb(),s.Xb(21,"div",15),s.Xb(22,"button",16),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(25,"entity-table",17,18),s.jc("onEditItem",(function(e){return t.editItem(e)}))("onDeleteItem",(function(e){return t.deleteItem(e)})),s.Wb(),s.Xc(27,IY,3,2,"div",19),s.Wb(),s.Wb()),2&e&&(s.Cb(6),s.ad(s.pc(7,13,"GLOBAL.TAGS_LABEL")),s.Cb(5),s.wc("list",t.statusDropdownValues)("value",t.entityStatus),s.Cb(2),s.xc("placeholder",s.pc(14,15,"WORKSPACE.ACCOUNT.USER.SEARCH_BY.NAME")),s.wc("ngModel",t.searchName),s.Cb(4),s.wc("formGroup",t.createForm),s.Cb(2),s.wc("placeholder",s.qc(20,17,"WORKSPACE.ADD_NEW_LABEL",s.Bc(22,wY,t.label))),s.Cb(3),s.wc("disabled",t.createForm.invalid),s.Cb(1),s.ad(s.pc(24,20,"GLOBAL.ADD_LABEL")),s.Cb(2),s.wc("items",t.items)("label",t.label)("entity",t.EntityTab.TAGS),s.Cb(2),s.wc("ngIf",t.isMultiplePages))},directives:[ji.a,v.c,v.s,v.v,v.I,v.t,v.k,ND.a,v.i,TY,i.u,Pi.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})(),RY=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(){return!!this.workspaceService.getLocalDefaultWorkspace().invoicingEnabled||(this.router.navigate(["tracker"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(s.fc(l.a),s.fc(k.d))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();function yY(e,t){1&e&&(s.Xb(0,"h1",23),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.CLIENTS_LABEL")))}function _Y(e,t){1&e&&(s.Xb(0,"h1",23),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.DEPARTMENT_LABEL")))}function kY(e,t){1&e&&(s.Xb(0,"h1",23),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.ad(s.pc(2,1,"GLOBAL.CATEGORIES_LABEL")))}function WY(e,t){if(1&e&&(s.Xb(0,"h1",23),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.ad(e.labelPlural)}}function XY(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",24),s.Xb(1,"pager",25,26),s.jc("pageChanged",(function(t){return s.Oc(e),s.nc().pageChanged(t)}))("limitChanged",(function(t){return s.Oc(e),s.nc().limitChanged(t)})),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.wc("page",null==e.pagination?null:e.pagination.page)("limit",null==e.pagination?null:e.pagination.pageSize)}}let NY=(()=>{class e{constructor(e,t,n,i,s,c,a,o,r){this.router=e,this.activatedRoute=t,this.workspaceService=n,this.clientService=i,this.formBuilder=s,this.uiSettingsService=c,this.cd=a,this.translate=o,this.analyticsService=r,this._searchName="",this.items=[],this.pageDebouncer$=new p.a,this.searchDebouncer$=new p.a,this.unsubscribe$=new p.a,this.EntityTab=sY,this.statusDropdownValues=[new Ea.a(Rn.a.ACTIVE,this.translate.instant("TEAMS.MEMBERS.STATUS_LABELS.ACTIVE_LABEL")),new Ea.a(Rn.a.ARCHIVED,this.translate.instant("GLOBAL.SHOW_ARCHIVED_LABEL")),new Ea.a(Rn.a.ALL,this.translate.instant("GLOBAL.SHOW_ALL_LABEL"))],this.entityStatus=this.statusDropdownValues[0].value}set searchName(e){this._searchName=e,this.searchDebouncer$.next(this.searchName)}get searchName(){return this._searchName}ngOnInit(){this.workspaceService.defaultWorkspace$.pipe(Object(Zt.a)(e=>!!e),Object(ln.a)(1),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{var t,n;this.workspace=e,this.label=null===(t=this.workspace.projectGroupingLabel)||void 0===t?void 0:t.toLowerCase(),this.labelTranslated=null===(n=this.workspaceService.generateClientLabel(this.label))||void 0===n?void 0:n.toLowerCase(),this.labelPlural=this.workspaceService.generateClientsLabel(this.workspace.projectGroupingLabel),this.showAddress=this.workspace.invoicingEnabled,this.createNewInputLabel=this.setCreateNewInputPlaceholder(this.label)}),this.createForm=this.formBuilder.group({name:["",[Bi.a.required]],inProgress:[!1,[Bi.a.requiredFalse]]}),this.initPagination(),this.subscribeToData(),this.getRouteParamsFromUrl(),this.setRouteDebouncer(),this.setSearchDebouncer()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}subscribeToData(){this.clientService.clients.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(this.onSuccessGetData.bind(this))}onSuccessGetData(e){const t=e.length<this.pagination.pageSize,n=e.length;this.items=e,this.isMultiplePages=this.pagination.page>1||n>=In.j||n>=this.pagination.pageSize,this.cd.detectChanges(),this.pager&&!this.reachedTheLimit&&this.pager.allowNextPage(!t)}setInProgress(e){this.createForm.patchValue({inProgress:e})}setName(e){this.createForm.patchValue({name:e})}trimName(){const e=Object(sn.H)(this.createForm.value.name);this.setName(e)}getData(e){this.clientService.getAllClientsV1(e,this.workspace.id,Object.assign(Object.assign({},this.pagination),{name:this.searchName})).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(this.onSuccessGetData.bind(this))}createItem(){this.trimName();const e=this.createForm.value.name;this.setInProgress(!0),this.clientService.create(e,this.labelTranslated,this.workspace.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.items.unshift(e),this.setName(""),this.setInProgress(!1),this.entityTable.cd.detectChanges(),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"add",section:"Client"}))},()=>this.setInProgress(!1))}editItem({item:e,backup:t,archiveProjects:n}){this.clientService.update(e,!!n,this.label).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(null,n=>{e.name=t.name,e.address=t.address,this.entityTable.cd.detectChanges()})}deleteItem(e){this.clientService.delete(e,this.label).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.items=this.items.filter(t=>t.id!==e.id),0===this.items.length&&this.pagination.page>1&&(this.pagination.page--,this.getData(this.entityStatus)),this.cd.detectChanges(),this.analyticsService.addEvent(new Fi.a({event:"submit",value:"delete",section:"Client"}))})}pageChanged(e){if(this.pagination.page>e.page)this.reachedTheLimit=!1;else if(this.reachedTheLimit)return;this.pagination.page=e.page,this.pageDebouncer$.next()}limitChanged(e){this.reachedTheLimit=!1,this.pagination.page=1,this.pagination.pageSize=e.limit,this.pageDebouncer$.next()}initPagination(){const e=this.uiSettingsService.getSettings(xn.b.ENTITY_PAGESIZE);this.pagination={page:1,pageSize:e||In.j}}setSearchDebouncer(){this.searchDebouncer$.pipe(Object(De.a)(350),Object(Lh.a)(),Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.pagination.page=1,this.getData(this.entityStatus)})}setRouteDebouncer(){this.pageDebouncer$.pipe(Object(De.a)(350),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.router.navigate([],{queryParams:this.pagination,relativeTo:this.activatedRoute})})}getRouteParamsFromUrl(){this.activatedRoute.queryParams.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{Object(sn.u)(e.page)&&e.page>0&&(this.pagination.page=Number(e.page)),Object(sn.u)(e.pageSize)&&e.pageSize>0&&e.pageSize<=200&&(this.pagination.pageSize=Number(e.pageSize)),this.getData(this.entityStatus)})}filterEntity(e){this.entityStatus=e,this.getData(e),this.cd.detectChanges()}setCreateNewInputPlaceholder(e){let t;switch(e){case"category":t=this.translate.instant("WORKSPACE.ADD_NEW_CATEGORY");break;case"client":t=this.translate.instant("WORKSPACE.ADD_NEW_CLIENT");break;case"department":t=this.translate.instant("WORKSPACE.ADD_NEW_DEPARTMENT");break;default:t=this.translate.instant("WORKSPACE.ADD_NEW_LABEL",{label:e})}return t}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.d),s.Rb(k.a),s.Rb(l.a),s.Rb(Mi.a),s.Rb(v.f),s.Rb(xn.a),s.Rb(s.h),s.Rb(g.f),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["clients-tab"]],viewQuery:function(e,t){var n;1&e&&(s.gd(TY,!0),s.gd(Pi.a,!0)),2&e&&(s.Kc(n=s.kc())&&(t.entityTable=n.first),s.Kc(n=s.kc())&&(t.pager=n.first))},decls:29,vars:21,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center"],[1,"cl-col",3,"ngSwitch"],["class","cl-text-capitalize",4,"ngSwitchCase"],["class","cl-text-capitalize",4,"ngSwitchDefault"],[1,"cl-pb-2","cl-pb-lg-3"],[1,"cl-d-flex","cl-col-lg-custom-9","cl-mb-2","cl-mb-lg-custom-0"],[1,"cl-d-inline-block",3,"list","value","onChanged"],[1,"cl-form-group","cl-mb-2","cl-mb-lg-custom-0","cl-ml-2","cl-w-1"],["type","text",1,"cl-form-control",3,"ngModel","placeholder","ngModelChange"],[1,"cl-col-lg-custom-3"],[1,"cl-form-group","cl-mb-0"],[1,"cl-form-row",3,"formGroup","ngSubmit"],[1,"cl-col"],[1,"cl-cut-text-wrapper"],["type","text","autocomplete","off","preventMultipleSpaces","","formControlName","name",1,"cl-form-control","cl-cut-text",3,"placeholder","blur"],[1,"cl-col-auto"],["type","submit",1,"cl-btn","cl-btn-primary",3,"disabled"],[3,"items","label","hasSecondColumn","entity","onEditItem","onDeleteItem"],["entityTable",""],["class","cl-mt-2 cl-mt-lg-3",4,"ngIf"],[1,"cl-text-capitalize"],[1,"cl-mt-2","cl-mt-lg-3"],[3,"page","limit","pageChanged","limitChanged"],["pager",""]],template:function(e,t){1&e&&(s.Xb(0,"main",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xc(5,yY,3,3,"h1",5),s.Xc(6,_Y,3,3,"h1",5),s.Xc(7,kY,3,3,"h1",5),s.Xc(8,WY,2,1,"h1",6),s.Wb(),s.Wb(),s.Wb(),s.Xb(9,"div",7),s.Xb(10,"div",3),s.Xb(11,"div",8),s.Xb(12,"dropdown-items",9),s.jc("onChanged",(function(e){return t.filterEntity(e)})),s.Wb(),s.Xb(13,"div",10),s.Xb(14,"input",11),s.jc("ngModelChange",(function(e){return t.searchName=e})),s.oc(15,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(16,"div",12),s.Xb(17,"div",13),s.Xb(18,"form",14),s.jc("ngSubmit",(function(){return t.createItem()})),s.Xb(19,"div",15),s.Xb(20,"span",16),s.Xb(21,"input",17),s.jc("blur",(function(){return t.trimName()})),s.Wb(),s.Wb(),s.Wb(),s.Xb(22,"div",18),s.Xb(23,"button",19),s.Zc(24),s.oc(25,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(26,"entity-table",20,21),s.jc("onEditItem",(function(e){return t.editItem(e)}))("onDeleteItem",(function(e){return t.deleteItem(e)})),s.Wb(),s.Xc(28,XY,3,2,"div",22),s.Wb(),s.Wb()),2&e&&(s.Cb(4),s.wc("ngSwitch",t.workspace.projectGroupingLabel),s.Cb(1),s.wc("ngSwitchCase","client"),s.Cb(1),s.wc("ngSwitchCase","department"),s.Cb(1),s.wc("ngSwitchCase","category"),s.Cb(5),s.wc("list",t.statusDropdownValues)("value",t.entityStatus),s.Cb(2),s.xc("placeholder",s.pc(15,17,"WORKSPACE.ACCOUNT.USER.SEARCH_BY.NAME")),s.wc("ngModel",t.searchName),s.Cb(4),s.wc("formGroup",t.createForm),s.Cb(3),s.wc("placeholder",t.createNewInputLabel),s.Cb(2),s.wc("disabled",t.createForm.invalid),s.Cb(1),s.ad(s.pc(25,19,"GLOBAL.ADD_LABEL")),s.Cb(2),s.wc("items",t.items)("label",t.labelTranslated)("hasSecondColumn",t.showAddress)("entity",t.EntityTab.CLIENTS),s.Cb(2),s.wc("ngIf",t.isMultiplePages))},directives:[i.y,i.z,i.A,ji.a,v.c,v.s,v.v,v.I,v.t,v.k,ND.a,v.i,TY,i.u,Pi.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();function DY(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",38),s.Xb(1,"info"),s.Xb(2,"span"),s.Zc(3),s.oc(4,"translate"),s.oc(5,"translate"),s.Wb(),s.Xb(6,"a",39),s.jc("click",(function(){return s.Oc(e),s.nc().resendEmail()})),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.dd("",s.pc(4,4,"EMAIL_PREFERENCES.INFO_VERIFY.PART_1")," (",e.user.email,") ",s.pc(5,6,"EMAIL_PREFERENCES.INFO_VERIFY.PART_2")," "),s.Cb(4),s.ad(s.pc(8,8,"EMAIL_PREFERENCES.INFO_VERIFY.LINK"))}}const PY=function(){return["/user/settings"]};let MY=(()=>{class e{constructor(e,t,n,i){this.authService=e,this.cd=t,this.userService=n,this.analyticsServics=i,this.debouncerEmailPreferencesr$=new p.a,this.unsubscribe$=new Fn.a}ngOnInit(){this.user=this.authService.getUser(),this.getUserPreferences(),this.debouncerEmailPreferencesr$.pipe(Object(De.a)(600),Object(Pe.a)(this.unsubscribe$)).subscribe(()=>this.save())}getUserPreferences(){this.userService.checkNewsletterSubscription(this.user.id).subscribe(e=>{this.userStatus=this.user.status,this.emailAlerts=this.user.settings.alerts,this.emailApproval=this.user.settings.approval,this.emailLongRunning=this.user.settings.longRunning,this.emailWeeklyUpdates=this.user.settings.weeklyUpdates,this.emailScheduledReports=this.user.settings.scheduledReports,this.emailPto=this.user.settings.pto,this.emailReminders=this.user.settings.reminders,this.emailNewsletter=e,this.user.settings.sendNewsletter=e,this.cd.detectChanges()})}save(){this.userService.updateEmailPreferencesSettings(this.user).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{})}updateEmailPreferences(){this.debouncerEmailPreferencesr$.next()}toggleProperty(e){this.user.settings[e]=!this.user.settings[e],this.analyticsServics.addEvent(new Fi.a({event:"switch",uevent:"switch",section:"Profile settings",section2:"Manage email preferences",section3:e,value:this.user.settings[e]})),this.updateEmailPreferences()}resendEmail(){this.authService.resendVerifyEmailPreferences()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(re.a),s.Rb(s.h),s.Rb(Lc.a),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["emailpreferences"]],inputs:{user:"user",settings:"settings"},decls:107,vars:78,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-end"],[1,"cl-col-auto"],[1,"cl-breadcrumb","cl-p-0","cl-mb-2","cl-bg-transparent","cl-ml-0"],[1,"cl-breadcrumb-item"],[3,"routerLink"],[1,"cl-mb-2","cl-mb-lg-0"],[1,"cl-card"],[1,"cl-card-body"],["class","cl-form-group cl-alert-info-blue-text cl-d-inline-block",4,"ngIf"],[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-12"],[1,"cl-h2","cl-mb-1"],[1,"cl-text-gray-9","cl-w-lg-75"],[1,"cl-custom-control","cl-custom-checkbox","cl-custom-control-inline"],["type","checkbox","id","emailNewsletter","name","emailNewsletter",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","emailNewsletter",1,"cl-custom-control-label"],[1,"cl-text-gray-9","cl-d-block","cl-mt-1"],["type","checkbox","id","emailWeeklyUpdates","name","emailWeeklyUpdates",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","emailWeeklyUpdates",1,"cl-custom-control-label"],["type","checkbox","id","emailLongRunning","name","emailLongRunning",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","emailLongRunning",1,"cl-custom-control-label"],["type","checkbox","id","emailScheduledReports","name","emailScheduledReports",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","emailScheduledReports",1,"cl-custom-control-label"],["type","checkbox","id","emailApproval","name","emailApproval",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","emailApproval",1,"cl-custom-control-label"],["type","checkbox","id","emailPto","name","emailPto",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","emailPto",1,"cl-custom-control-label"],["type","checkbox","id","emailAlerts","name","emailAlerts",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","emailAlerts",1,"cl-custom-control-label"],["type","checkbox","id","emailReminders","name","emailReminders",1,"cl-custom-control-input",3,"ngModel","change","ngModelChange"],["for","emailReminders",1,"cl-custom-control-label"],[1,"cl-d-flex","cl-align-items-center"],["triggers","manual","popoverclass","popover-dark","placement","top","container","body",1,"cl-ml-2","cl-mr-1","cl-d-inline-flex"],["src","assets/ui-icons/info-9.svg"],[1,"cl-text-gray-9","cl-d-block","cl-pl-1"],[1,"cl-form-group","cl-alert-info-blue-text","cl-d-inline-block"],[1,"cl-font-weight-normal","cl-alert-link",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"main",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"nav"),s.Xb(6,"ol",5),s.Xb(7,"li",6),s.Xb(8,"a",7),s.Zc(9),s.oc(10,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(11,"h1",8),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(14,"div",9),s.Xb(15,"div",10),s.Xc(16,DY,9,10,"div",11),s.Xb(17,"div",12),s.Xb(18,"div",13),s.Xb(19,"div",14),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Xb(22,"div",15),s.Zc(23),s.oc(24,"translate"),s.Wb(),s.Wb(),s.Xb(25,"div"),s.Xb(26,"div",13),s.Xb(27,"div",16),s.Xb(28,"input",17),s.jc("change",(function(){return t.toggleProperty("sendNewsletter")}))("ngModelChange",(function(e){return t.emailNewsletter=e})),s.Wb(),s.Xb(29,"label",18),s.Zc(30),s.oc(31,"translate"),s.Xb(32,"span",19),s.Zc(33),s.oc(34,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(35,"div",13),s.Xb(36,"div",16),s.Xb(37,"input",20),s.jc("change",(function(){return t.toggleProperty("weeklyUpdates")}))("ngModelChange",(function(e){return t.emailWeeklyUpdates=e})),s.Wb(),s.Xb(38,"label",21),s.Zc(39),s.oc(40,"translate"),s.Xb(41,"span",19),s.Zc(42),s.oc(43,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(44,"div",13),s.Xb(45,"div",16),s.Xb(46,"input",22),s.jc("change",(function(){return t.toggleProperty("longRunning")}))("ngModelChange",(function(e){return t.emailLongRunning=e})),s.Wb(),s.Xb(47,"label",23),s.Zc(48),s.oc(49,"translate"),s.Xb(50,"span",19),s.Zc(51),s.oc(52,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(53,"div",13),s.Xb(54,"div",16),s.Xb(55,"input",24),s.jc("change",(function(){return t.toggleProperty("scheduledReports")}))("ngModelChange",(function(e){return t.emailScheduledReports=e})),s.Wb(),s.Xb(56,"label",25),s.Zc(57),s.oc(58,"translate"),s.Xb(59,"span",19),s.Zc(60),s.oc(61,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(62,"div",13),s.Xb(63,"div",16),s.Xb(64,"input",26),s.jc("change",(function(){return t.toggleProperty("approval")}))("ngModelChange",(function(e){return t.emailApproval=e})),s.Wb(),s.Xb(65,"label",27),s.Zc(66),s.oc(67,"translate"),s.Xb(68,"span",19),s.Zc(69),s.oc(70,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(71,"div",13),s.Xb(72,"div",16),s.Xb(73,"input",28),s.jc("change",(function(){return t.toggleProperty("pto")}))("ngModelChange",(function(e){return t.emailPto=e})),s.Wb(),s.Xb(74,"label",29),s.Zc(75),s.oc(76,"translate"),s.Xb(77,"span",19),s.Zc(78),s.oc(79,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(80,"div",13),s.Xb(81,"div",16),s.Xb(82,"input",30),s.jc("change",(function(){return t.toggleProperty("alerts")}))("ngModelChange",(function(e){return t.emailAlerts=e})),s.Wb(),s.Xb(83,"label",31),s.Zc(84),s.oc(85,"translate"),s.Xb(86,"span",19),s.Zc(87),s.oc(88,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(89,"div",13),s.Xb(90,"div",16),s.Xb(91,"input",32),s.jc("change",(function(){return t.toggleProperty("reminders")}))("ngModelChange",(function(e){return t.emailReminders=e})),s.Wb(),s.Xb(92,"label",33),s.Zc(93),s.oc(94,"translate"),s.Xb(95,"span",19),s.Zc(96),s.oc(97,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(98,"div"),s.Sb(99,"hr"),s.Xb(100,"div"),s.Xb(101,"div",34),s.Xb(102,"a",35),s.Sb(103,"img",36),s.Wb(),s.Xb(104,"span",37),s.Zc(105),s.oc(106,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(8),s.wc("routerLink",s.Ac(77,PY)),s.Cb(1),s.ad(s.pc(10,35,"GLOBAL.PROFILE_SETTINGS_LABEL")),s.Cb(3),s.ad(s.pc(13,37,"GLOBAL.EMAIL_PREFERENCES_LABEL")),s.Cb(4),s.wc("ngIf","PENDING_EMAIL_VERIFICATION"===t.user.status),s.Cb(4),s.bd(" ",s.pc(21,39,"EMAIL_PREFERENCES.MANAGE_NOTIFICATIONS.TITLE")," "),s.Cb(3),s.bd(" ",s.pc(24,41,"EMAIL_PREFERENCES.MANAGE_NOTIFICATIONS.DESCRIPTION")," "),s.Cb(2),s.Hb("disable-area","PENDING_EMAIL_VERIFICATION"===t.user.status),s.Cb(3),s.wc("ngModel",t.emailNewsletter),s.Cb(2),s.bd(" ",s.pc(31,43,"EMAIL_PREFERENCES.NEWSLETTER.TITLE")," "),s.Cb(3),s.bd(" ",s.pc(34,45,"EMAIL_PREFERENCES.NEWSLETTER.DESCRIPTION")," "),s.Cb(4),s.wc("ngModel",t.emailWeeklyUpdates),s.Cb(2),s.bd(" ",s.pc(40,47,"EMAIL_PREFERENCES.WEEKLY_REPORT.TITLE")," "),s.Cb(3),s.bd(" ",s.pc(43,49,"EMAIL_PREFERENCES.WEEKLY_REPORT.DESCRIPTION")," "),s.Cb(4),s.wc("ngModel",t.emailLongRunning),s.Cb(2),s.bd(" ",s.pc(49,51,"EMAIL_PREFERENCES.LONG_RUNNING_TIMER.TITLE")," "),s.Cb(3),s.bd(" ",s.pc(52,53,"EMAIL_PREFERENCES.LONG_RUNNING_TIMER.DESCRIPTION")," "),s.Cb(4),s.wc("ngModel",t.emailScheduledReports),s.Cb(2),s.bd(" ",s.pc(58,55,"EMAIL_PREFERENCES.SCHEDULED_REPORTS.TITLE")," "),s.Cb(3),s.bd(" ",s.pc(61,57,"EMAIL_PREFERENCES.SCHEDULED_REPORTS.DESCRIPTION")," "),s.Cb(4),s.wc("ngModel",t.emailApproval),s.Cb(2),s.bd(" ",s.pc(67,59,"EMAIL_PREFERENCES.APPROVAL.TITLE")," "),s.Cb(3),s.bd(" ",s.pc(70,61,"EMAIL_PREFERENCES.APPROVAL.DESCRIPTION")," "),s.Cb(4),s.wc("ngModel",t.emailPto),s.Cb(2),s.bd(" ",s.pc(76,63,"EMAIL_PREFERENCES.TIME_OFF.TITLE")," "),s.Cb(3),s.bd(" ",s.pc(79,65,"EMAIL_PREFERENCES.TIME_OFF.DESCRIPTION")," "),s.Cb(4),s.wc("ngModel",t.emailAlerts),s.Cb(2),s.bd(" ",s.pc(85,67,"EMAIL_PREFERENCES.ALERTS.TITLE")," "),s.Cb(3),s.bd(" ",s.pc(88,69,"EMAIL_PREFERENCES.ALERTS.DESCRIPTION")," "),s.Cb(4),s.wc("ngModel",t.emailReminders),s.Cb(2),s.bd(" ",s.pc(94,71,"EMAIL_PREFERENCES.REMINDERS.TITLE")," "),s.Cb(3),s.bd(" ",s.pc(97,73,"EMAIL_PREFERENCES.REMINDERS.DESCRIPTION")," "),s.Cb(2),s.Hb("disable-area","PENDING_EMAIL_VERIFICATION"===t.user.status),s.Cb(7),s.bd(" ",s.pc(106,75,"EMAIL_PREFERENCES.CLOCKIFY_MESSAGE")," "))},directives:[k.g,i.u,v.a,v.s,v.v,To.a],pipes:[g.e],encapsulation:2,changeDetection:0}),e})();class BY{constructor(e){this.screenshotId=e.screenshotId,this.screenshotUrl=e.screenshotUrl,this.timeEntryId=e.timeEntryId,this.createdAt=e.createdAt}}let UY=(()=>{class e{constructor(e,t,n,i){this.http=e,this.workspaceService=t,this.toaster=n,this.translateService=i,this.error=new p.a}getCountForUsers(e,t,n){const i=this.workspaceService.getDefaultWorkspaceId();let s=(new m.h).append("start",t).append("end",n);return e.forEach(e=>{s=s.append("userIds",e)}),this.http.get(`${dt.j}/workspaces/${i}/users/screenshots-count`,{params:s}).pipe(Object(u.a)(()=>{},e=>{this.toaster.error(this.translateService.instant("SERVICES.SCREENSHOT.GET.MANY.ERROR_MESSAGE"))}))}getCountForUser(e,t,n){const i=this.workspaceService.getDefaultWorkspaceId(),s=(new m.h).append("userIds",e).append("start",t).append("end",n);return this.http.get(`${dt.j}/workspaces/${i}/users/screenshots-count`,{params:s}).pipe(Object(d.a)(t=>t[e]||0),Object(u.a)(()=>{},e=>{var t;return(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translateService.instant("SERVICES.SCREENSHOT.GET.MANY.ERROR_MESSAGE")}))}getScreenshots(e,t){const n=this.workspaceService.getDefaultWorkspaceId(),i=(new m.h).append("start",t.start).append("end",t.end).append("page",t.page);return this.http.get(`${dt.j}/workspaces/${n}/users/${e}/screenshots`,{params:i}).pipe(Object(d.a)(e=>e.map(e=>new BY(e))),Object(u.a)(()=>{},e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translateService.instant("SERVICES.SCREENSHOT.GET.MANY.ERROR_MESSAGE"))}))}adminDelete(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`${dt.j}/workspaces/${t}/screenshots/${e}`).pipe(Object(u.a)(()=>this.toaster.success(this.translateService.instant("SERVICES.SCREENSHOT.DELETE.SUCCESS_MESSAGE")),e=>{var t;return this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translateService.instant("SERVICES.SCREENSHOT.DELETE.ERROR_MESSAGE"))}))}delete(e,t){const n=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(dt.j+`/workspaces/${n}/time-entries/${t}/screenshots/${e}`).pipe(Object(u.a)(()=>this.toaster.success(this.translateService.instant("SERVICES.SCREENSHOT.DELETE.SUCCESS_MESSAGE")),e=>{var t;this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||this.translateService.instant("SERVICES.SCREENSHOT.DELETE.ERROR_MESSAGE"))}))}getScreenshot(e,t){const n=this.workspaceService.getDefaultWorkspaceId();return this.http.get(`${dt.j}/workspaces/${n}/users/${t}/screenshots/${e}`).pipe(Object(d.a)(e=>new BY(e)),Object(u.a)(()=>{},e=>this.toaster.error(this.translateService.instant("SERVICES.SCREENSHOT.GET.ONE.ERROR_MESSAGE"))))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(m.c),s.fc(l.a),s.fc(r.a),s.fc(g.f))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var GY=n("WjWa"),xY=n("uI7B"),FY=n("6gGB"),jY=n("+W0u");let ZY=(()=>{class e{constructor(){this.onClose=new s.n,this.onPrevious=new s.n,this.onNext=new s.n,this.onImageError=new s.n}handleKeyboardEvent(e){"ArrowLeft"!==e.key||this.noPrevious||this.onPrevious.emit(!0),"ArrowRight"!==e.key||this.noNext||this.onNext.emit(!0)}next(){this.onNext.emit(!0)}previous(){this.onPrevious.emit(!0)}close(){this.onClose.emit(!0)}onError(){const e=this.screenshot.screenshotUrl;e!==this.lastErrorImageUrl&&(this.lastErrorImageUrl=e,this.onImageError.emit())}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["preview-screenshot"]],hostBindings:function(e,t){1&e&&s.jc("keydown",(function(e){return t.handleKeyboardEvent(e)}),!1,s.Mc)},inputs:{title:"title",screenshot:"screenshot",noPrevious:"noPrevious",noNext:"noNext"},outputs:{onClose:"onClose",onPrevious:"onPrevious",onNext:"onNext",onImageError:"onImageError"},decls:20,vars:10,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close","cl-no-outline",3,"click"],["aria-hidden","true"],["src","assets/images/ui-icons/close.svg"],[1,"cl-modal-body"],[1,"cl-d-flex","cl-mb-3"],[1,"cl-my-auto","cl-mr-3"],[1,"cl-btn","cl-btn-fixed-40","cl-btn-outline-light","cl-d-print-none",3,"disabled","click"],["src","assets/images/ui-icons/chevron-left.svg"],[1,"cl-w-100"],[1,"cl-w-100",3,"src","error"],[1,"cl-my-auto","cl-ml-3"],["src","assets/images/ui-icons/chevron-right.svg"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.Wb(),s.Xb(3,"button",2),s.jc("click",(function(){return t.close()})),s.Xb(4,"span",3),s.Sb(5,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(6,"div",5),s.Xb(7,"div",6),s.Xb(8,"div",7),s.Xb(9,"button",8),s.jc("click",(function(){return t.previous()})),s.Sb(10,"img",9),s.Wb(),s.Wb(),s.Xb(11,"div",10),s.Xb(12,"p"),s.Zc(13),s.oc(14,"translate"),s.oc(15,"hourFormat"),s.Wb(),s.Xb(16,"img",11),s.jc("error",(function(){return t.onError()})),s.Wb(),s.Wb(),s.Xb(17,"div",12),s.Xb(18,"button",8),s.jc("click",(function(){return t.next()})),s.Sb(19,"img",13),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(t.title),s.Cb(7),s.wc("disabled",t.noPrevious),s.Cb(4),s.cd("",s.pc(14,6,"ACTIVITY_TABS.SHARED.RECORDED_AT")," ",s.pc(15,8,null==t.screenshot?null:t.screenshot.createdAt),""),s.Cb(3),s.xc("src",t.screenshot.screenshotUrl,s.Qc),s.Cb(2),s.wc("disabled",t.noNext))},pipes:[g.e,vj.a],encapsulation:2}),e})(),VY=(()=>{class e{constructor(e){this.formatIs12Hour=e.getTimeFormatForUser()===Lg.a.HOUR12}transform(e,t){const n=ke().set("hour",e).set("minute",0);return t&&n.add(t,"hour"),this.formatIs12Hour?n.format("h:mmA").toString():n.format("HH:mm").toString()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(Lc.a))},e.\u0275pipe=s.Qb({name:"numberToHoursFormat",type:e,pure:!0}),e})();const YY=["dropdownUsers"];function HY(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",9),s.Xb(1,"dropdown-searchable",19,20),s.jc("onOpen",(function(){s.Oc(e);const t=s.nc();return!t.isGetUsersTriggered&&t.getUsers()}))("loadMore",(function(){return s.Oc(e),s.nc().loadMoreUsers()}))("onSearch",(function(t){return s.Oc(e),s.nc().onSearchUser(t)}))("onFilterChanged",(function(t){return s.Oc(e),s.nc().userFilterChanged(t)}))("onChanged",(function(t){return s.Oc(e),s.nc().userChange(t)})),s.oc(3,"translate"),s.oc(4,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.xc("placeholder",s.pc(3,9,"ACTIVITY_TABS.SCREENSHOTS.SEARCH_TEAMMATES_PLACEHOLDER")),s.wc("list",e.users)("value",e.selectedUser.id)("filterOptions",e.userFilterOptions)("selectedName",e.selectedUser.name||e.selectedUser.email)("selectedCount",e.selectedUser.count)("usersFull",e.usersFull)("overrideTitle",e.selectedUser.id===e.loggedInUser.id?s.pc(4,11,"GLOBAL.TEAMMATES_DROPDOWN"):"")("searchOffline",e.areAllUsersLoaded)}}function $Y(e,t){if(1&e&&(s.Xb(0,"span",21),s.Zc(1),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd("(",e.screenshotCount,")")}}function KY(e,t){if(1&e&&(s.Xb(0,"div",40),s.Zc(1),s.oc(2,"hourFormat"),s.Wb()),2&e){const e=s.nc().$implicit;s.Cb(1),s.bd(" ",s.pc(2,1,e.createdAt)," ")}}function qY(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",31),s.Xb(1,"div",32),s.Xb(2,"span",33),s.Xb(3,"button",34),s.jc("click",(function(){s.Oc(e);const n=t.$implicit,i=s.nc(3),c=s.Lc(21);return i.openModal(c,n)})),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Xb(6,"span",35),s.Xb(7,"button",36),s.jc("click",(function(){s.Oc(e);const n=t.$implicit,i=s.nc(3),c=s.Lc(19);return i.openModal(c,n)})),s.Sb(8,"img",37),s.Wb(),s.Wb(),s.Sb(9,"img",38),s.Wb(),s.Xc(10,KY,3,3,"div",39),s.Wb()}if(2&e){const e=t.$implicit;s.Cb(4),s.bd(" ",s.pc(5,3,"ACTIVITY_TABS.SCREENSHOTS.VIEW_IMAGE_BTN"),""),s.Cb(5),s.xc("src",e.screenshotUrl,s.Qc),s.Cb(1),s.wc("ngIf",e.createdAt)}}function zY(e,t){if(1&e&&(s.Xb(0,"div",27),s.Xb(1,"div",28),s.Xb(2,"div",29),s.Zc(3),s.oc(4,"numberToHoursFormat"),s.oc(5,"numberToHoursFormat"),s.Wb(),s.Wb(),s.Xc(6,qY,11,5,"div",30),s.Wb()),2&e){const e=t.$implicit;s.Cb(3),s.cd(" ",s.pc(4,3,e.hour)," - ",s.qc(5,5,e.hour,1)," "),s.Cb(3),s.wc("ngForOf",e.screenshots)}}function QY(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",22),s.Xb(1,"div",23),s.Xb(2,"div",24),s.Xb(3,"div",25),s.jc("scrolled",(function(){return s.Oc(e),s.nc().onScroll()})),s.Xc(4,zY,7,8,"div",26),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.wc("infiniteScrollDistance",3)("infiniteScrollThrottle",150),s.Cb(1),s.wc("ngForOf",e.screenshotGroups)}}function JY(e,t){1&e&&(s.Vb(0),s.Xb(1,"p",46),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"a",47),s.Zc(5),s.oc(6,"translate"),s.Wb(),s.Ub()),2&e&&(s.Cb(2),s.bd(" ",s.pc(3,2,"ACTIVITY_TABS.SCREENSHOTS.NO_SCREENSHOTS_PROMO_INFO"),". "),s.Cb(3),s.bd(" ",s.pc(6,4,"ACTIVITY_TABS.SCREENSHOTS.NO_SCREENSHOTS_PROMO_BTN"),""))}function eH(e,t){if(1&e&&(s.Xb(0,"div",41),s.Xb(1,"div",42),s.Sb(2,"img",43),s.Wb(),s.Xb(3,"span",44),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Xc(6,JY,7,6,"ng-container",45),s.Wb()),2&e){const e=s.nc();s.Cb(4),s.ad(s.pc(5,2,"ACTIVITY_TABS.SCREENSHOTS.NO_SCREENSHOTS_HEADER")),s.Cb(2),s.wc("ngIf",e.loggedInUser.id===e.selectedUser.id)}}function tH(e,t){if(1&e){const e=s.Yb();s.Xb(0,"delete-confirm-modal",48),s.jc("onClose",(function(){return t.$implicit.close()}))("onDelete",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return i.delete(i.selectedScreenshot),n.close()})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",49),s.Zc(4),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,"ACTIVITY_TABS.SCREENSHOTS.DELETE_SCREENSHOT_BTN"))("btnText",s.pc(2,6,"GLOBAL.DELETE_BTN"))("showConfirmation",!1),s.Cb(4),s.bd(" ",e.deleteMessage," ")}}function nH(e,t){if(1&e){const e=s.Yb();s.Xb(0,"preview-screenshot",50),s.jc("onPrevious",(function(){return s.Oc(e),s.nc().previous()}))("onNext",(function(){return s.Oc(e),s.nc().next()}))("onClose",(function(){return t.$implicit.close()}))("onImageError",(function(){return s.Oc(e),s.nc().updateUrl()})),s.Wb()}if(2&e){const e=s.nc();s.wc("title",e.selectedUser.name)("screenshot",e.selectedScreenshot)("noPrevious",e.screenshots.indexOf(e.selectedScreenshot)<1)("noNext",e.screenshots.indexOf(e.selectedScreenshot)===e.screenshots.length-1)}}let iH=(()=>{class e{constructor(e,t,n,i,s,c,a,o){this.cd=e,this.userService=t,this.authService=n,this.screenshotsService=i,this.workspaceService=s,this.modal=c,this.loader=a,this.translate=o,this.screenshotGroups=[],this.userFilterOptions=[new Ea.a("ALL",this.translate.instant("GLOBAL.ACTIVE_AND_INACTIVE_LABEL")),new Ea.a(on.l.ACTIVE,this.translate.instant("GLOBAL.ACTIVE_LABEL")),new Ea.a(on.l.INACTIVE,this.translate.instant("GLOBAL.INACTIVE_LABEL"))],this.ActivityPills=GY.a,this.unsubscribe$=new p.a,this.dateRange={start:ke().startOf("day").toISOString(),end:ke().endOf("day").toISOString()},this.usersQuery={page:1,name:"",limit:In.j,status:"ACTIVE",statuses:"ACTIVE",emailAsName:!0},this.users=[],this.usersFull=[]}ngOnInit(){this.isAdminOrOwner=this.authService.isAdminOrOwner(),this.authService.permissionData$.pipe(Object(Zt.a)(e=>null!==e),Object(Pe.a)(this.unsubscribe$)).subscribe(({isAdminOrOwner:e})=>this.isAdminOrOwner=e),this.loggedInUser=this.authService.getUser(),this.selectedUser=new xY.a({id:this.loggedInUser.id,name:this.loggedInUser.name}),this.resetScreenshots(),this.getScreenshotsWithCount()}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}resetScreenshots(){this.screenshotPage=1,this.screenshotGroups=[],this.screenshots=[],this.screenshotCount=null}dateRangeChanged(e){this.dateRange={start:e.dateRange.start.clone().toISOString(),end:e.dateRange.end.clone().toISOString()},this.resetScreenshots(),this.getScreenshotsWithCount(),this.users.length>190?(this.users=[],this.usersQuery.page=1,this.areAllUsersLoaded=!1,this.isGetUsersTriggered=!1):(this.clearAllUsersCount(),this.getScreenshotCountForUsers(this.users))}userChange(e){this.resetScreenshots(),this.selectedUser=e,Object(sn.t)(e.count)?(this.screenshotCount=e.count,this.getScreenshots()):this.getScreenshotsWithCount()}getScreenshotsWithCount(){this.loader.show(),this.screenshotsService.getCountForUser(this.selectedUser.id,this.dateRange.start,this.dateRange.end).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.screenshotCount=e||0,this.screenshotCount?this.getScreenshots():this.loader.hide(),this.cd.detectChanges()},()=>this.loader.hide())}getScreenshots(){this.screenshotsService.getScreenshots(this.selectedUser.id,{page:this.screenshotPage,start:this.dateRange.start,end:this.dateRange.end}).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.groupScreenshots(e),this.screenshots=[...this.screenshots,...e],this.loader.hide(),this.cd.detectChanges()},()=>this.loader.hide())}groupScreenshots(e){if(!(null==e?void 0:e.length))return;let t=this.screenshotGroups.length;e.forEach(e=>{var n;const i=ke(e.createdAt).hours();(null===(n=this.screenshotGroups[t-1])||void 0===n?void 0:n.hour)===i?this.screenshotGroups[t-1].screenshots.push(e):(this.screenshotGroups.push({hour:i,screenshots:[e]}),t++)}),this.cd.detectChanges()}onScroll(){this.screenshots.length>=this.screenshotCount||(this.screenshotPage++,this.getScreenshots())}openModal(e,t){this.selectedScreenshot=t,this.deleteMessage=this.getDeleteMessage(t),this.modal.open(e,{centered:!0,size:"md"})}delete(e){this.loader.showBar(),this.isAdminOrOwner?this.screenshotsService.adminDelete(e.screenshotId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.screenshotDeleted(e),this.loader.hide()},()=>this.loader.hide()):this.screenshotsService.delete(e.screenshotId,e.timeEntryId).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.screenshotDeleted(e),this.loader.hide()},()=>this.loader.hide())}getDeleteMessage(e){if(this.isAdminOrOwner)return this.translate.instant("ACTIVITY_TABS.SCREENSHOTS.DELETE_SCREENSHOT_WARNING_MESSAGE_ADMIN");const t=this.screenshots.filter(t=>t.timeEntryId===e.timeEntryId);if(1===t.length)return this.translate.instant("ACTIVITY_TABS.SCREENSHOTS.DELETE_SCREENSHOT_WARNING_MESSAGE");let n;n=0===t.indexOf(e)?ke(e.createdAt).diff(ke(t[1].createdAt)):t.indexOf(e)===t.length-1?ke(t[t.length-2].createdAt).diff(ke(e.createdAt)):ke(t[t.indexOf(e)-1].createdAt).diff(ke(e.createdAt));const i=Object(ke.duration)(Math.abs(n)).format("m:ss");return this.translate.instant("ACTIVITY_TABS.SCREENSHOTS.DELETE_SCREENSHOT_WARNING_MESSAGE_PARAMS",{minutes:i.split(":")[0],seconds:i.split(":")[1]})}updateUrl(){this.screenshotsService.getScreenshot(this.selectedScreenshot.screenshotId,this.selectedUser.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.selectedScreenshot.screenshotUrl=e.screenshotUrl,this.cd.detectChanges()})}next(){const e=this.screenshots.indexOf(this.selectedScreenshot)+1;this.selectedScreenshot=this.screenshots[e],this.cd.detectChanges()}previous(){const e=this.screenshots.indexOf(this.selectedScreenshot)-1;this.selectedScreenshot=this.screenshots[e],this.cd.detectChanges()}screenshotDeleted(e){this.screenshots=this.screenshots.filter(t=>t.screenshotId!==e.screenshotId),this.screenshotCount=this.screenshots.length,this.screenshotGroups=[],this.groupScreenshots(this.screenshots),this.users=this.users.map(e=>(e.id===this.selectedUser.id&&e.count--,e)),this.cd.detectChanges()}onSearchUser(e){this.usersQuery.name=e,this.usersQuery.page=1,this.getUsers()}userFilterChanged(e){this.usersQuery.statuses=e,this.usersQuery.status=e,this.usersQuery.page=1,this.getUsers()}loadMoreUsers(){this.usersQuery.page++,this.getUsers()}getUsers(){if(!this.isAdminOrOwner)return;this.isGetUsersTriggered=!0;const{name:e,page:t}=this.usersQuery;this.usersQuery.emailAsName=!0,this.workspaceService.getUsers(this.usersQuery,!0).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(n=>{this.areAllUsersLoaded=!e&&n.users.length<this.usersQuery.limit;const i=n.users.map(e=>new xY.a(e));1===t?(this.users=i,this.usersFull=n.users):(this.users=[...this.users,...i],this.usersFull=[...this.usersFull,...n.users]),this.getScreenshotCountForUsers(i),this.cd.detectChanges()})}getScreenshotCountForUsers(e){e.length&&this.isAdminOrOwner&&this.screenshotsService.getCountForUsers(e.map(e=>e.id),this.dateRange.start,this.dateRange.end).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(t=>{e.map(e=>(e.count=t[e.id]||0,e)),this.dropdownUsers&&this.dropdownUsers.triggerDetection(),this.cd.detectChanges()})}clearAllUsersCount(){this.users=(this.users||[]).map(e=>(e.count=null,e)),this.dropdownUsers&&this.dropdownUsers.triggerDetection()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.h),s.Rb(Lc.a),s.Rb(re.a),s.Rb(UY),s.Rb(l.a),s.Rb(w.q),s.Rb(Hn.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["screenshots"]],viewQuery:function(e,t){var n;1&e&&s.gd(YY,!0),2&e&&s.Kc(n=s.kc())&&(t.dropdownUsers=n.first)},decls:22,vars:11,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center","cl-justify-content-between"],[1,"cl-col-auto","cl-mb-3","cl-mb-md-0","cl-d-flex","cl-align-items-center","cl-justify-content-between"],[1,"cl-btn-group",3,"page"],[1,"cl-col-auto","cl-ml-auto","cl-mb-3","cl-mb-md-0"],["class","cl-d-flex cl-align-items-center",4,"ngIf"],[1,"cl-col-md-auto"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-page-header-action","cl-w-100","cl-w-md-auto"],[3,"isDaily","disableOpenPicker","onlyLastDays","getOfUtc","resourceType","dateRangeOut"],[1,"cl-page-component-wrapper"],[1,"cl-h1","cl-mb-3"],["class","cl-text-gray-9",4,"ngIf"],["class","cl-card cl-p-2",4,"ngIf"],["class","cl-no-entries","style","margin-top: 10%;",4,"ngIf"],["deleteModal",""],["previewModal",""],[1,"cl-cut-text-wrapper",3,"list","value","filterOptions","selectedName","selectedCount","usersFull","placeholder","overrideTitle","searchOffline","onOpen","loadMore","onSearch","onFilterChanged","onChanged"],["dropdownUsers",""],[1,"cl-text-gray-9"],[1,"cl-card","cl-p-2"],[1,"cl-card-body","cl-p-3"],[1,"cl-screenshots-wrapper"],["infiniteScroll","",1,"cl-container-fluid",3,"infiniteScrollDistance","infiniteScrollThrottle","scrolled"],["class","cl-row cl-mb-2",4,"ngFor","ngForOf"],[1,"cl-row","cl-mb-2"],[1,"cl-col-12","cl-mb-2"],[1,"cl-screenshots-time-range"],["class","cl-col-auto cl-col-screenshot-thumb",4,"ngFor","ngForOf"],[1,"cl-col-auto","cl-col-screenshot-thumb"],[1,"cl-border","cl-relative","cl-rounded","cl-screenshot",2,"width","205px","height","115px"],[1,"screenshot-btn-wrapper"],[1,"cl-btn","cl-btn-primary",3,"click"],[1,"cl-absolute-right"],[1,"cl-btn","cl-btn-sm","cl-btn-outline-light","cl-p-0","cl-border-top-0","cl-border-right-0",3,"click"],["src","assets/images/ui-icons/delete.svg",1,"cl-p-1"],[1,"cl-img-fluid","cl-screenshot-img",2,"width","203px","height","113px",3,"src"],["class","cl-mt-2 cl-text-center cl-text-muted cl-small",4,"ngIf"],[1,"cl-mt-2","cl-text-center","cl-text-muted","cl-small"],[1,"cl-no-entries",2,"margin-top","10%"],[1,"cl-no-entries-image-wrapper"],["src","assets/images/no_screenshots.svg",1,"no__entries--image"],[1,"cl-h2","cl-mb-1"],[4,"ngIf"],[1,"cl-mb-0","cl-mb-3",2,"max-width","380px"],["href","https://clockify.me/screenshot-recording-app","target","_blank",1,"cl-btn","cl-btn-primary"],[3,"title","btnText","showConfirmation","onClose","onDelete"],[1,"cl-text-muted","cl-mb-0"],[3,"title","screenshot","noPrevious","noNext","onPrevious","onNext","onClose","onImageError"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Sb(5,"activity-tabs",5),s.Wb(),s.Xb(6,"div",6),s.Xc(7,HY,5,13,"div",7),s.Wb(),s.Xb(8,"div",8),s.Xb(9,"div",9),s.Xb(10,"div",10),s.Xb(11,"datepicker-range",11),s.jc("dateRangeOut",(function(e){return t.dateRangeChanged(e)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(12,"div",12),s.Xb(13,"div",13),s.Zc(14),s.Xc(15,$Y,2,1,"span",14),s.Wb(),s.Xc(16,QY,5,3,"div",15),s.Xc(17,eH,7,4,"div",16),s.Wb(),s.Wb(),s.Wb(),s.Xc(18,tH,5,8,"ng-template",null,17,s.Yc),s.Xc(20,nH,1,4,"ng-template",null,18,s.Yc)),2&e&&(s.Cb(5),s.wc("page",t.ActivityPills.SCREENSHOTS),s.Cb(2),s.wc("ngIf",t.isAdminOrOwner),s.Cb(4),s.wc("isDaily",!0)("disableOpenPicker",!0)("onlyLastDays",7)("getOfUtc",!0)("resourceType","Screenshots"),s.Cb(3),s.bd(" ",t.selectedUser.name," "),s.Cb(1),s.wc("ngIf",t.screenshotCount),s.Cb(1),s.wc("ngIf",null==t.screenshots?null:t.screenshots.length),s.Cb(1),s.wc("ngIf",0===t.screenshotCount))},directives:[jY.a,i.u,ws.a,FY.a,Ae.a,i.t,Xd.a,ZY],pipes:[g.e,VY,vj.a],encapsulation:2,changeDetection:0}),e})(),sH=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(e){const t=this.workspaceService.getLocalDefaultWorkspace();return!(!e.data.locations||!t.locationsEnabled)||!(!e.data.screenshots||!t.screenshotsEnabled)||(this.router.navigate(["tracker"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(s.fc(l.a),s.fc(k.d))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var cH=n("bOdf"),aH=function(e){return e.DEFAULTS="DEFAULTS",e.APPEARANCE="APPEARANCE",e.TRANSLATIONS="TRANSLATIONS",e}({});const oH=["tabs"],rH=function(e){return{value:e}};function lH(e,t){if(1&e&&(s.Xb(0,"small",36),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.SETTINGS.NO_LONGER_THAN_INFO",s.Bc(4,rH,e.maxLabelLength))," ")}}function bH(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",3),s.Xb(1,"label",34),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"input",35),s.jc("keyup.enter",(function(t){return s.Oc(e),t.target.blur()}))("change",(function(){return s.Oc(e),s.nc().modelChanged()})),s.Wb(),s.Xc(5,lH,3,6,"small",6),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.ad(s.pc(3,4,"INVOICES.ITEM_TYPE.TITLE")),s.Cb(2),s.Hb("cl-border-danger",e.notValid("itemType")),s.Cb(1),s.wc("ngIf",e.notValid("itemType"))}}function dH(e,t){if(1&e&&(s.Xb(0,"small",36),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.SETTINGS.NO_LONGER_THAN_INFO",s.Bc(4,rH,e.maxLabelLength))," ")}}function uH(e,t){if(1&e&&(s.Xb(0,"small",36),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.SETTINGS.NO_LONGER_THAN_INFO",s.Bc(4,rH,e.maxLabelLength))," ")}}function pH(e,t){if(1&e&&(s.Xb(0,"small",36),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.SETTINGS.NO_LONGER_THAN_INFO",s.Bc(4,rH,e.maxLabelLength))," ")}}function hH(e,t){if(1&e&&(s.Xb(0,"small",36),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.SETTINGS.NO_LONGER_THAN_INFO",s.Bc(4,rH,e.maxLabelLength))," ")}}function mH(e,t){if(1&e&&(s.Xb(0,"small",36),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.SETTINGS.NO_LONGER_THAN_INFO",s.Bc(4,rH,e.maxLabelLength))," ")}}function gH(e,t){if(1&e&&(s.Xb(0,"small",36),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.SETTINGS.NO_LONGER_THAN_INFO",s.Bc(4,rH,e.maxLabelLength))," ")}}function EH(e,t){if(1&e&&(s.Xb(0,"small",36),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.SETTINGS.NO_LONGER_THAN_INFO",s.Bc(4,rH,e.maxLabelLength))," ")}}function fH(e,t){if(1&e&&(s.Xb(0,"small",36),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.SETTINGS.NO_LONGER_THAN_INFO",s.Bc(4,rH,e.maxLabelLength))," ")}}function SH(e,t){if(1&e&&(s.Xb(0,"small",36),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.SETTINGS.NO_LONGER_THAN_INFO",s.Bc(4,rH,e.maxLabelLength))," ")}}function CH(e,t){if(1&e&&(s.Xb(0,"small",36),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.SETTINGS.NO_LONGER_THAN_INFO",s.Bc(4,rH,e.maxLabelLength))," ")}}function AH(e,t){if(1&e&&(s.Xb(0,"small",36),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.SETTINGS.NO_LONGER_THAN_INFO",s.Bc(4,rH,e.maxLabelLength))," ")}}function OH(e,t){if(1&e&&(s.Xb(0,"small",36),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.SETTINGS.NO_LONGER_THAN_INFO",s.Bc(4,rH,e.maxLabelLength))," ")}}function vH(e,t){if(1&e&&(s.Xb(0,"small",36),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.SETTINGS.NO_LONGER_THAN_INFO",s.Bc(4,rH,e.maxLabelLength))," ")}}function TH(e,t){if(1&e&&(s.Xb(0,"small",36),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e){const e=s.nc();s.Cb(1),s.bd(" ",s.qc(2,1,"INVOICES.SETTINGS.NO_LONGER_THAN_INFO",s.Bc(4,rH,e.maxLabelLength))," ")}}let IH=(()=>{class e{constructor(e,t,n,i,c){this.router=e,this.invoiceService=t,this.formBuilder=n,this.activatedRoute=i,this.cd=c,this.maxLabelLength=20,this.unsubscribe$=new Fn.a,this.canUpdate=!1,this.onSave=new s.n}set labels(e){this.initDefaultFormControls(),e&&(this._labels=e,this.form.patchValue({issueDate:this.labels.issueDate,dueDate:this.labels.dueDate,billFrom:this.labels.billFrom,billTo:this.labels.billTo,description:this.labels.description,quantity:this.labels.quantity,unitPrice:this.labels.unitPrice,amount:this.labels.amount,subtotal:this.labels.subtotal,discount:this.labels.discount,tax:this.labels.tax,tax2:this.labels.tax2,totalAmount:this.labels.totalAmount,notes:this.labels.notes,itemType:this.labels.itemType}),this.canUpdate=!0,this.cd.detectChanges())}get labels(){return this._labels}set workspace(e){e&&(this._workspace=e,this.hasExpensesFeature=this._workspace.hasFeature(is.a.EXPENSES))}ngOnInit(){}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}modelChanged(e=!1){this.canUpdate&&this.form.valid&&this.save()}notValid(e){const t=this.form.get(e);return!!t&&t.dirty&&t.touched&&!!t.errors}initDefaultFormControls(){this.form=this.formBuilder.group({itemType:["",v.G.maxLength(this.maxLabelLength)],issueDate:["",v.G.maxLength(this.maxLabelLength)],dueDate:["",v.G.maxLength(this.maxLabelLength)],billFrom:["",v.G.maxLength(this.maxLabelLength)],billTo:["",v.G.maxLength(this.maxLabelLength)],description:["",v.G.maxLength(this.maxLabelLength)],quantity:["",v.G.maxLength(this.maxLabelLength)],unitPrice:["",v.G.maxLength(this.maxLabelLength)],amount:["",v.G.maxLength(this.maxLabelLength)],subtotal:["",v.G.maxLength(this.maxLabelLength)],discount:["",v.G.maxLength(this.maxLabelLength)],tax:["",v.G.maxLength(this.maxLabelLength)],tax2:["",v.G.maxLength(this.maxLabelLength)],totalAmount:["",v.G.maxLength(this.maxLabelLength)],notes:["",v.G.maxLength(this.maxLabelLength)]})}save(){this.onSave.emit(new Qn(this.form.value))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.d),s.Rb(ti),s.Rb(v.f),s.Rb(k.a),s.Rb(s.h))},e.\u0275cmp=s.Lb({type:e,selectors:[["translations-tab"]],viewQuery:function(e,t){var n;1&e&&s.gd(oH,!0),2&e&&s.Kc(n=s.kc())&&(t.tabs=n.first)},inputs:{labels:"labels",workspace:"workspace"},outputs:{onSave:"onSave"},decls:89,vars:89,consts:[[1,"cl-text-wrap","cl-mb-3"],[3,"formGroup"],["class","cl-form-group",4,"ngIf"],[1,"cl-form-group"],["for","issueDate"],["type","text","id","issueDate","formControlName","issueDate","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["class","cl-form-text cl-text-danger",4,"ngIf"],["for","dueDate"],["type","text","id","dueDate","formControlName","dueDate","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","billFrom"],["type","text","id","billFrom","formControlName","billFrom","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["class","cl-form-text  cl-text-danger",4,"ngIf"],["for","billTo"],["type","text","id","billTo","formControlName","billTo","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","description"],["type","text","id","description","formControlName","description","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","quantity"],["type","text","id","quantity","formControlName","quantity","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","unitPrice"],["type","text","id","unitPrice","formControlName","unitPrice","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","amount"],["type","text","id","amount","formControlName","amount","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","subtotal"],["type","text","id","subtotal","formControlName","subtotal","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","discount"],["type","text","id","discount","formControlName","discount","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","tax"],["type","text","id","tax","formControlName","tax","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","tax2"],["type","text","id","tax2","formControlName","tax2","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","totalAmount"],["type","text","id","totalAmount","formControlName","totalAmount","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","notes"],["type","text","id","notes","formControlName","notes","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],["for","itemType"],["type","text","id","itemType","formControlName","itemType","autocomplete","off",1,"cl-form-control","cl-col-md-3","cl-mb-3","cl-text-gray-6",3,"keyup.enter","change"],[1,"cl-form-text","cl-text-danger"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Zc(1),s.oc(2,"translate"),s.Wb(),s.Xb(3,"form",1),s.Xc(4,bH,6,6,"div",2),s.Xb(5,"div",3),s.Xb(6,"label",4),s.Zc(7),s.oc(8,"translate"),s.Wb(),s.Xb(9,"input",5),s.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),s.Wb(),s.Xc(10,dH,3,6,"small",6),s.Wb(),s.Xb(11,"div",3),s.Xb(12,"label",7),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Xb(15,"input",8),s.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),s.Wb(),s.Xc(16,uH,3,6,"small",6),s.Wb(),s.Xb(17,"div",3),s.Xb(18,"label",9),s.Zc(19),s.oc(20,"translate"),s.Wb(),s.Xb(21,"input",10),s.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),s.Wb(),s.Xc(22,pH,3,6,"small",11),s.Wb(),s.Xb(23,"div",3),s.Xb(24,"label",12),s.Zc(25),s.oc(26,"translate"),s.Wb(),s.Xb(27,"input",13),s.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),s.Wb(),s.Xc(28,hH,3,6,"small",6),s.Wb(),s.Xb(29,"div",3),s.Xb(30,"label",14),s.Zc(31),s.oc(32,"translate"),s.Wb(),s.Xb(33,"input",15),s.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),s.Wb(),s.Xc(34,mH,3,6,"small",6),s.Wb(),s.Xb(35,"div",3),s.Xb(36,"label",16),s.Zc(37),s.oc(38,"translate"),s.Wb(),s.Xb(39,"input",17),s.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),s.Wb(),s.Xc(40,gH,3,6,"small",6),s.Wb(),s.Xb(41,"div",3),s.Xb(42,"label",18),s.Zc(43),s.oc(44,"translate"),s.Wb(),s.Xb(45,"input",19),s.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),s.Wb(),s.Xc(46,EH,3,6,"small",6),s.Wb(),s.Xb(47,"div",3),s.Xb(48,"label",20),s.Zc(49),s.oc(50,"translate"),s.Wb(),s.Xb(51,"input",21),s.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),s.Wb(),s.Xc(52,fH,3,6,"small",6),s.Wb(),s.Xb(53,"div",3),s.Xb(54,"label",22),s.Zc(55),s.oc(56,"translate"),s.Wb(),s.Xb(57,"input",23),s.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),s.Wb(),s.Xc(58,SH,3,6,"small",6),s.Wb(),s.Xb(59,"div",3),s.Xb(60,"label",24),s.Zc(61),s.oc(62,"translate"),s.Wb(),s.Xb(63,"input",25),s.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),s.Wb(),s.Xc(64,CH,3,6,"small",6),s.Wb(),s.Xb(65,"div",3),s.Xb(66,"label",26),s.Zc(67),s.oc(68,"translate"),s.Wb(),s.Xb(69,"input",27),s.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),s.Wb(),s.Xc(70,AH,3,6,"small",6),s.Wb(),s.Xb(71,"div",3),s.Xb(72,"label",28),s.Zc(73),s.oc(74,"translate"),s.Wb(),s.Xb(75,"input",29),s.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),s.Wb(),s.Xc(76,OH,3,6,"small",6),s.Wb(),s.Xb(77,"div",3),s.Xb(78,"label",30),s.Zc(79),s.oc(80,"translate"),s.Wb(),s.Xb(81,"input",31),s.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),s.Wb(),s.Xc(82,vH,3,6,"small",6),s.Wb(),s.Xb(83,"div",3),s.Xb(84,"label",32),s.Zc(85),s.oc(86,"translate"),s.Wb(),s.Xb(87,"input",33),s.jc("keyup.enter",(function(e){return e.target.blur()}))("change",(function(){return t.modelChanged()})),s.Wb(),s.Xc(88,TH,3,6,"small",6),s.Wb(),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,59,"INVOICES.SETTINGS.TRANSLATE_INFO"),"\n"),s.Cb(2),s.wc("formGroup",t.form),s.Cb(1),s.wc("ngIf",t.hasExpensesFeature&&t._workspace.expensesEnabled),s.Cb(3),s.ad(s.pc(8,61,"INVOICES.SHARED.ISSUE_DATE")),s.Cb(2),s.Hb("cl-border-danger",t.notValid("issueDate")),s.Cb(1),s.wc("ngIf",t.notValid("issueDate")),s.Cb(3),s.ad(s.pc(14,63,"INVOICES.SHARED.DUE_DATE")),s.Cb(2),s.Hb("cl-border-danger",t.notValid("dueDate")),s.Cb(1),s.wc("ngIf",t.notValid("dueDate")),s.Cb(3),s.ad(s.pc(20,65,"INVOICES.SHARED.BILL_FROM")),s.Cb(2),s.Hb("cl-border-danger",t.notValid("billFrom")),s.Cb(1),s.wc("ngIf",t.notValid("billFrom")),s.Cb(3),s.ad(s.pc(26,67,"INVOICES.SHARED.BILL_TO")),s.Cb(2),s.Hb("cl-border-danger",t.notValid("billTo")),s.Cb(1),s.wc("ngIf",t.notValid("billTo")),s.Cb(3),s.ad(s.pc(32,69,"GLOBAL.DESCRIPTION_LABEL")),s.Cb(2),s.Hb("cl-border-danger",t.notValid("description")),s.Cb(1),s.wc("ngIf",t.notValid("description")),s.Cb(3),s.ad(s.pc(38,71,"INVOICES.SHARED.QUANTITY")),s.Cb(2),s.Hb("cl-border-danger",t.notValid("quantity")),s.Cb(1),s.wc("ngIf",t.notValid("quantity")),s.Cb(3),s.ad(s.pc(44,73,"INVOICES.SHARED.UNIT_PRICE")),s.Cb(2),s.Hb("cl-border-danger",t.notValid("unitPrice")),s.Cb(1),s.wc("ngIf",t.notValid("unitPrice")),s.Cb(3),s.ad(s.pc(50,75,"GLOBAL.AMOUNT_LABEL")),s.Cb(2),s.Hb("cl-border-danger",t.notValid("amount")),s.Cb(1),s.wc("ngIf",t.notValid("amount")),s.Cb(3),s.ad(s.pc(56,77,"INVOICES.SHARED.SUBTOTAL")),s.Cb(2),s.Hb("cl-border-danger",t.notValid("subtotal")),s.Cb(1),s.wc("ngIf",t.notValid("subtotal")),s.Cb(3),s.ad(s.pc(62,79,"INVOICES.SHARED.DISCOUNT")),s.Cb(2),s.Hb("cl-border-danger",t.notValid("discount")),s.Cb(1),s.wc("ngIf",t.notValid("discount")),s.Cb(3),s.ad(s.pc(68,81,"INVOICES.SHARED.TAX")),s.Cb(2),s.Hb("cl-border-danger",t.notValid("tax")),s.Cb(1),s.wc("ngIf",t.notValid("tax")),s.Cb(3),s.ad(s.pc(74,83,"INVOICES.SHARED.TAX2")),s.Cb(2),s.Hb("cl-border-danger",t.notValid("tax2")),s.Cb(1),s.wc("ngIf",t.notValid("tax2")),s.Cb(3),s.ad(s.pc(80,85,"INVOICES.SHARED.TOTAL_AMOUNT")),s.Cb(2),s.Hb("cl-border-danger",t.notValid("totalAmount")),s.Cb(1),s.wc("ngIf",t.notValid("totalAmount")),s.Cb(3),s.ad(s.pc(86,87,"INVOICES.SHARED.NOTES")),s.Cb(2),s.Hb("cl-border-danger",t.notValid("notes")),s.Cb(1),s.wc("ngIf",t.notValid("notes")))},directives:[v.I,v.t,v.k,i.u,v.c,v.s,v.i],pipes:[g.e],encapsulation:2}),e})();var wH=function(e){return e.COMPOUND="COMPOUND",e.SIMPLE="SIMPLE",e.NONE="NONE",e}({});function LH(e,t){if(1&e){const e=s.Yb();s.Xb(0,"a",12),s.jc("keyup.enter",(function(){s.Oc(e);const n=t.$implicit;return s.nc(2).valueChange(n)}))("click",(function(){s.Oc(e);const n=t.$implicit;return s.nc(2).valueChange(n)})),s.Zc(1),s.Wb()}if(2&e){const e=t.$implicit,n=s.nc(2);s.Hb("cl-active",n.selected===e),s.Cb(1),s.bd(" ",n.options[e]," ")}}function RH(e,t){if(1&e&&(s.Xb(0,"div",8),s.Xb(1,"div",9),s.Xc(2,LH,2,3,"a",10),s.Sb(3,"span",11),s.Wb(),s.Wb()),2&e){const e=s.nc();s.Cb(2),s.wc("ngForOf",e.objectKeys(e.options))}}function yH(e,t){1&e&&(s.Xb(0,"label",13),s.Zc(1),s.oc(2,"translate"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"INVOICES.SETTINGS.INVOICE_ACTIVE_AFTER_LABEL")," "))}function _H(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",14),s.Xb(1,"div",15),s.Xb(2,"div",16),s.Xb(3,"input",17,18),s.jc("change",(function(){return s.Oc(e),s.nc().numberChanged()}))("keyup.enter",(function(){return s.Oc(e),s.Lc(4).blur()}))("ngModelChange",(function(t){return s.Oc(e),s.nc().newDueDays=t})),s.Wb(),s.Xb(5,"label",13),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.wc("ngModel",e.newDueDays),s.Cb(3),s.bd(" ",s.pc(7,2,"INVOICES.SETTINGS.INVOICE_ACTIVE_AFTER_LABEL")," ")}}var kH=function(e){return e.UPON_RECEIPT="UPON_RECEIPT",e.TEN="TEN",e.FIFTEEN="FIFTEEN",e.THIRTY="THIRTY",e.SIXTY="SIXTY",e.NINETY="NINETY",e.CUSTOM="CUSTOM",e}({});let WH=(()=>{class e{constructor(e){this.translationService=e,this.objectKeys=Object.keys,this.options={UPON_RECEIPT:this.translationService.instant("GLOBAL.UPON_RECEIPT_LABEL"),TEN:"Net 10",FIFTEEN:"Net 15",THIRTY:"Net 30",SIXTY:"Net 60",NINETY:"Net 90",CUSTOM:this.translationService.instant("GLOBAL.CUSTOM_LABEL")},this.onChange=new s.n,this.unsubscribe$=new p.a}set dueDays(e){(e||0===e)&&(this._dueDays=e,this.newDueDays=e,this.initSelected())}get dueDays(){return this._dueDays}ngOnInit(){this.newDueDays=this.dueDays}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}initSelected(){this.selected=0===this.dueDays?kH.UPON_RECEIPT:10===this.dueDays?kH.TEN:15===this.dueDays?kH.FIFTEEN:30===this.dueDays?kH.THIRTY:60===this.dueDays?kH.SIXTY:90===this.dueDays?kH.NINETY:kH.CUSTOM}valueChange(e){if(e!==this.selected&&(this.selected=e,e===kH.UPON_RECEIPT&&this.onChange.emit(0),e===kH.TEN&&this.onChange.emit(10),e===kH.FIFTEEN&&this.onChange.emit(15),e===kH.THIRTY&&this.onChange.emit(30),e===kH.SIXTY&&this.onChange.emit(60),e===kH.NINETY&&this.onChange.emit(90),e===kH.CUSTOM)){if(!this.newDueDays)return;this.onChange.emit(this.newDueDays)}}numberChanged(){this.onChange.emit(this.newDueDays)}emitChanges(){this.onChange.emit(this.newDueDays)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["payment-due"]],inputs:{dueDays:"dueDays"},outputs:{onChange:"onChange"},decls:9,vars:3,consts:[[1,"cl-form-row"],[1,"cl-form-group","cl-mb-0","cl-col-md-12","cl-col-lg-8","cl-col-lg-custom-5","cl-d-flex"],[1,"cl-pl-0","cl-ml-0","cl-form-group","cl-col-md-6"],["dropdownKey","",1,"cl-dropdown"],["tabindex","0","dropdownKeyButton","",1,"cl-btn","cl-btn-outline-light","cl-w-100","cl-text-left","cl-dropdown-toggle","cl-cut-text","cl-pr-3"],["class","cl-dropdown-menu","openUpAtBottom","",4,"dropdownKeyContent"],["class","cl-text-gray-9 cl-ml-2 cl-pt-2",4,"ngIf"],["class","cl-col-md-6",4,"ngIf"],["openUpAtBottom","",1,"cl-dropdown-menu"],[1,"cl-scroll-area"],["clickCloseDropdown","","tabindex","0","class","cl-dropdown-item",3,"cl-active","keyup.enter","click",4,"ngFor","ngForOf"],["dropdownClose","","tabindex","0"],["clickCloseDropdown","","tabindex","0",1,"cl-dropdown-item",3,"keyup.enter","click"],[1,"cl-text-gray-9","cl-ml-2","cl-pt-2"],[1,"cl-col-md-6"],[1,"cl-form-group"],[1,"cl-input-group"],["type","number","name","daysInput","tabindex","0",1,"cl-form-control",2,"min-width","55px",3,"ngModel","change","keyup.enter","ngModelChange"],["daysInput",""]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"a",4),s.Zc(5),s.Wb(),s.Xc(6,RH,4,1,"div",5),s.Wb(),s.Wb(),s.Xc(7,yH,3,3,"label",6),s.Xc(8,_H,8,4,"div",7),s.Wb(),s.Wb()),2&e&&(s.Cb(5),s.bd(" ",t.options[t.selected]," "),s.Cb(2),s.wc("ngIf","CUSTOM"!==t.selected),s.Cb(1),s.wc("ngIf","CUSTOM"===t.selected))},directives:[ni.a,ii.a,si.a,i.u,i.t,v.y,v.c,v.s,v.v],pipes:[g.e],encapsulation:2}),e})();const XH=["addItemBtn"],NH=["item"];function DH(e,t){if(1&e){const e=s.Yb();s.Xb(0,"delete-confirm-modal",20),s.jc("onDelete",(function(){s.Oc(e);const n=t.$implicit,i=s.nc().$implicit;return s.nc().deleteItem(i),n.close()}))("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",21),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc().$implicit,t=s.nc();s.wc("title",s.pc(1,6,"GLOBAL.DELETE_BTN"))("btnText",s.pc(2,8,"GLOBAL.DELETE_BTN"))("showConfirmation",!1),s.Cb(3),s.wc("ngClass",t.infoMessageForDelete?"cl-h2 cl-cut-text-wrap":"cl-text-muted cl-cut-text-wrap cl-mb-0"),s.Cb(1),s.cd(" ",s.pc(5,10,"WORKSPACE.DELETE.CONFIRM")," ",e.name,"? ")}}function PH(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",12),s.Xb(2,"div",13),s.Xb(3,"div",14),s.Xb(4,"input",15,16),s.jc("ngModelChange",(function(n){return s.Oc(e),t.$implicit.name=n}))("focusin",(function(){s.Oc(e);const n=t.$implicit;return s.nc().rememberOldValue(n)}))("focusout",(function(){s.Oc(e);const n=t.$implicit;return s.nc().saveItem(n)})),s.oc(6,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",17),s.oc(8,"translate"),s.Xb(9,"button",18),s.jc("click",(function(){s.Oc(e);const t=s.Lc(13);return s.nc().openDeleteModal(t)})),s.Xb(10,"span",3),s.Sb(11,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(12,DH,6,12,"ng-template",null,19,s.Yc),s.Ub()}if(2&e){const e=t.$implicit,n=s.nc();s.Cb(4),s.yc("name","item",n.index,""),s.xc("placeholder",s.pc(6,5,"INVOICES.ITEM_TYPE.TITLE")),s.wc("ngModel",e.name),s.Cb(3),s.wc("ngbTooltip",n.shouldBeDisabled(e)?s.pc(8,7,"INVOICES.ITEM_TYPE.EDIT.MODAL.DELETE_TOOLTIP"):""),s.Cb(2),s.wc("disabled",n.shouldBeDisabled(e))}}const MH=function(e){return{"cl-disabled":e}};let BH=(()=>{class e{constructor(e,t,n,i,c,a){this.modalService=e,this.itemTypeService=t,this.cd=n,this.translate=i,this.toaster=c,this.renderer=a,this._ngUnsubscribe$=new p.a,this.closeEmit=new s.n,this.open=new s.n}set items(e){this._items=e}get items(){return this._items}createEmptyItem(){this.renderer.removeClass(this.rows.last.nativeElement,"cl-border-red"),this.items[this.items.length-1].name.length<2?this.renderer.addClass(this.rows.last.nativeElement,"cl-border-red"):(this.newItem=new as,this.newItem.name="",this.items.push(this.newItem),this.cd.detectChanges(),this.rows.last.nativeElement.focus())}openDeleteModal(e){this.modalService.open(e,{centered:!0})}saveItem(e){this.renderer.removeClass(this.rows.last.nativeElement,"cl-border-red");const t=e.name.length<2;if(t)return this.toaster.pop("error",this.translate.instant("INVOICES.ITEM_TYPE.CREATE.MODAL.NAME.FAILED_MESSAGE")),null!=e.id&&(e.name=this.oldNameValue),void(null==e.id&&t&&this.renderer.addClass(this.rows.last.nativeElement,"cl-border-red"));null!=e.id?e.name!=this.oldNameValue&&this.itemTypeService.update(e).subscribe(e=>{},t=>{e.name=this.oldNameValue}):this.itemTypeService.create(e.name).subscribe(e=>{},t=>{e.name=""})}rememberOldValue(e){null!=e.id&&(this.oldNameValue=e.name)}deleteItem(e){if(setTimeout(()=>{this.addItemBtn.nativeElement.focus()},100),null!=e.id){const t=this.items.findIndex(t=>t.id===e.id);this.itemTypeService.delete(this.items[t]).subscribe(()=>{})}}shouldBeDisabled(e){return e.id===this.defaults.defaultImportExpenseItemTypeId||e.id===this.defaults.defaultImportTimeItemTypeId}isMaximumItemTypes(){return this.items.length>49}close(){this.closeEmit.emit()}ngOnDestroy(){this._ngUnsubscribe$.next(!0),this._ngUnsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q),s.Rb(os),s.Rb(s.h),s.Rb(g.f),s.Rb(a.d),s.Rb(s.F))},e.\u0275cmp=s.Lb({type:e,selectors:[["item-type-modal"],["","item-type-modal",""]],viewQuery:function(e,t){var n;1&e&&(s.gd(XH,!0),s.gd(NH,!0)),2&e&&(s.Kc(n=s.kc())&&(t.addItemBtn=n.first),s.Kc(n=s.kc())&&(t.rows=n))},inputs:{items:"items",defaults:"defaults"},outputs:{closeEmit:"closeEmit",open:"open"},decls:19,vars:16,consts:[[1,"cl-modal-header"],[1,"cl-modal-title"],["type","button",1,"cl-close","cl-no-focus",3,"click"],["aria-hidden","true"],["src","../../../../../../assets/images/ui-icons/close.svg"],[1,"cl-overflow-auto","cl-pt-2"],[4,"ngFor","ngForOf"],[1,"cl-d-inline-flex",3,"ngbTooltip"],["type","button",1,"cl-btn","cl-btn-sm","cl-btn-outline-primary","cl-px-2","cl-mt-2","cl-mb-3","cl-ml-3",3,"ngClass","click"],["addItemBtn",""],[1,"cl-p-3","cl-border-top","cl-d-flex","cl-justify-content-end"],[1,"cl-btn","cl-btn-link","cl-text-capitalize",3,"click"],[1,"cl-px-3","cl-py-1","cl-d-flex"],[1,"cl-form-row","cl-w-100"],[1,"cl-w-100"],["type","text","required","",1,"cl-form-control","cl-border","cl-px-2","cl-w-100","cl-h-100",3,"name","ngModel","placeholder","ngModelChange","focusin","focusout"],["item",""],[1,"cl-ml-1",3,"ngbTooltip"],["type","button",1,"cl-btn","cl-border","cl-border-left-0",3,"disabled","click"],["itemTypeDeleteModal",""],[3,"title","btnText","showConfirmation","onDelete","onClose"],[3,"ngClass"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h1",1),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Xb(4,"button",2),s.jc("click",(function(){return t.close()})),s.Xb(5,"span",3),s.Sb(6,"img",4),s.Wb(),s.Wb(),s.Wb(),s.Xb(7,"div",5),s.Xc(8,PH,14,9,"ng-container",6),s.Wb(),s.Xb(9,"div",7),s.oc(10,"translate"),s.Xb(11,"button",8,9),s.jc("click",(function(){return t.createEmptyItem()})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Xb(15,"div",10),s.Xb(16,"button",11),s.jc("click",(function(){return t.close()})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb()),2&e&&(s.Cb(2),s.ad(s.pc(3,6,"INVOICES.ITEM_TYPE.EDIT.MODAL.TITLE")),s.Cb(6),s.wc("ngForOf",t.items),s.Cb(1),s.wc("ngbTooltip",t.isMaximumItemTypes()?s.pc(10,8,"INVOICES.ITEM_TYPE.EDIT.MODAL.MAX_TOOLTIP"):""),s.Cb(2),s.wc("ngClass",s.Bc(14,MH,t.isMaximumItemTypes())),s.Cb(2),s.ad(s.pc(14,10,"GLOBAL.TYPE.ADD_BTN")),s.Cb(4),s.ad(s.pc(18,12,"GLOBAL.CLOSE_BTN")))},directives:[i.t,w.bb,i.r,v.c,v.D,v.s,v.v,Xd.a],pipes:[g.e],encapsulation:2}),e})();function UH(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",2),s.Xb(1,"div",3),s.Xb(2,"div",4),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Xb(5,"div",5),s.Xb(6,"div",2),s.Xb(7,"div",6),s.Xb(8,"dropdown-items",16),s.jc("onChanged",(function(t){return s.Oc(e),s.nc().setDefaultItemType(t)})),s.Wb(),s.Wb(),s.Vb(9),s.Xb(10,"button",17),s.jc("click",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(2);return t.openModal(n)})),s.Zc(11),s.oc(12,"translate"),s.Wb(),s.Ub(),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(3),s.ad(s.pc(4,5,"INVOICES.ITEM_TYPE.TITLE")),s.Cb(5),s.wc("list",e.itemsDropdown)("initLabel",null==e.selected?null:e.selected.label)("value",null==e.selected?null:e.selected.label),s.Cb(3),s.ad(s.pc(12,7,"INVOICES.ITEM_TYPE.EDIT.BUTTON"))}}function GH(e,t){if(1&e&&(s.Xb(0,"item-type-modal",18),s.jc("closeEmit",(function(){return t.$implicit.close()})),s.Wb()),2&e){const e=s.nc();s.wc("items",e.items)("defaults",e.defaults)}}function xH(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"button",19),s.jc("click",(function(){return s.Oc(e),s.nc().addTax2()})),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Ub()}2&e&&(s.Cb(2),s.ad(s.pc(3,1,"INVOICES.SETTINGS.ADD_SECOND_TAX_LABEL")))}function FH(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",2),s.Xb(2,"div",3),s.Xb(3,"div",4),s.Zc(4),s.oc(5,"translate"),s.Wb(),s.Wb(),s.Xb(6,"div",5),s.Xb(7,"div",2),s.Xb(8,"div",6),s.Xb(9,"input",20,8),s.jc("inputChange",(function(t){s.Oc(e);const n=s.nc();return n.defaults.tax2=t,n.modelChanged()}))("keyup.enter",(function(){return s.Oc(e),s.Lc(10).blur()})),s.Wb(),s.Wb(),s.Xb(11,"button",21),s.jc("click",(function(){return s.Oc(e),s.nc().removeTax2()})),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Zc(14),s.oc(15,"translate"),s.Sb(16,"br"),s.Sb(17,"br"),s.Xb(18,"div",6),s.Xb(19,"div",22),s.Xb(20,"input",23),s.jc("change",(function(){s.Oc(e);const t=s.nc();return t.setTaxType("SIMPLE"),t.modelChanged()})),s.Wb(),s.Xb(21,"label",24),s.Zc(22),s.oc(23,"translate"),s.Wb(),s.Wb(),s.Xb(24,"div",22),s.Xb(25,"input",25),s.jc("change",(function(){s.Oc(e);const t=s.nc();return t.setTaxType("COMPOUND"),t.modelChanged()})),s.Wb(),s.Xb(26,"label",26),s.Zc(27),s.oc(28,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=s.nc();s.Cb(4),s.ad(s.pc(5,13,"INVOICES.DETAILS.ADD_TAX2")),s.Cb(5),s.wc("decimals",6)("minNumber",-100)("maxNumber",100)("ngModel",null==e.defaults?null:e.defaults.tax2),s.Cb(3),s.ad(s.pc(13,15,"GLOBAL.REMOVE_LABEL")),s.Cb(2),s.bd(" ",s.pc(15,17,"INVOICES.SETTINGS.TAXATION_MODE.LABEL")," "),s.Cb(6),s.wc("value",!0)("checked","SIMPLE"==(null==e.defaults?null:e.defaults.taxType)||"NONE"==(null==e.defaults?null:e.defaults.taxType)),s.Cb(2),s.bd(" ",s.pc(23,19,"INVOICES.SETTINGS.TAXATION_MODE.SIMPLE_LABEL")," "),s.Cb(3),s.wc("value",!1)("checked","COMPOUND"==(null==e.defaults?null:e.defaults.taxType)),s.Cb(2),s.bd(" ",s.pc(28,21,"INVOICES.SETTINGS.TAXATION_MODE.COMPOUND_LABEL")," ")}}let jH=(()=>{class e{constructor(e,t,n,i){this.modalService=e,this.itemTypeService=t,this.cd=n,this.invoiceService=i,this.itemsDropdown=[],this.items=[],this._ngUnsubscribe$=new p.a,this.onSave=new s.n}set workspace(e){e&&(this._workspace=e,this.hasExpensesFeature=this._workspace.hasFeature(is.a.EXPENSES))}get workspace(){return this._workspace}set defaults(e){e&&(this._defaults=e,this.fetchItemTypes())}get defaults(){return this._defaults}ngOnInit(){this.itemTypeService.newItem.pipe(Object(Pe.a)(this._ngUnsubscribe$)).subscribe(e=>{const t=this.items.findIndex(e=>null===e.id);-1!=t?this.items[t]=e:this.items.push(e),this.itemsDropdown=this.items.filter(e=>null!==e.id).map(e=>new Un.a(e.id,e.name))}),this.itemTypeService.updateItem.pipe(Object(Pe.a)(this._ngUnsubscribe$)).subscribe(e=>{this.items=this.items.map(t=>t.id===e.id?e:t),this.itemsDropdown=this.items.filter(e=>null!==e.id).map(e=>new Un.a(e.id,e.name)),this.selected.value==e.id&&(this.selected=this.itemsDropdown.find(t=>t.value===e.id))}),this.itemTypeService.deletedItem.pipe(Object(Pe.a)(this._ngUnsubscribe$)).subscribe(e=>{const t=this.items.findIndex(t=>t.id===e.id);this.selected.value==e.id?this.invoiceService.setRefreshSettings():(this.items.splice(t,1),this.items=this.items.filter(e=>e.name.length>=2),this.itemsDropdown=this.items.map(e=>new Un.a(e.id,e.name)))})}addTax2(){this.showTax2=!0}setNotes(e){this.defaults.notes=e.target.value}setTaxType(e){this.defaults.taxType=e}setDueDays(e){this.defaults.dueDays=e,this.modelChanged()}removeTax2(){this.showTax2=!1,0===this.defaults.tax2&&"NONE"==this.defaults.taxType||(this.defaults.tax2=0,this.defaults.taxType=wH.NONE,this.modelChanged())}modelChanged(){this.onSave.emit(this.defaults)}openModal(e){this.items=this.items.filter(e=>null!==e.id),this.cd.detectChanges(),this.modalService.open(e,{centered:!0})}fetchItemTypes(){this.itemTypeService.getItemTypes().subscribe(({items:e})=>{this.itemsDropdown=e.map(e=>new Un.a(e.id,e.name)),this.items=e,this.selected=this.itemsDropdown.find(e=>e.value===this.defaults.itemTypeId),this.cd.detectChanges()})}setDefaultItemType(e){const t=this.itemsDropdown.find(t=>t.value==e);this.defaults.itemTypeId=t.value,this.selected=new Un.a(t.value,t.label),this.modelChanged()}ngOnDestroy(){this._ngUnsubscribe$.next(!0),this._ngUnsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(w.q),s.Rb(os),s.Rb(s.h),s.Rb(ti))},e.\u0275cmp=s.Lb({type:e,selectors:[["defaults-tab"]],inputs:{workspace:"workspace",defaults:"defaults"},outputs:{onSave:"onSave"},decls:38,vars:23,consts:[["class","cl-form-row",4,"ngIf"],["itemTypeModal",""],[1,"cl-form-row"],[1,"cl-form-group","cl-col-md-12"],[1,"cl-h2","cl-mb-0"],[1,"cl-form-group","cl-mb-0","cl-col-md-12","cl-col-lg-8","cl-col-lg-custom-4"],[1,"cl-form-group","cl-col-md-6"],["id","tax","autocomplete","off","spellcheck","false","placeholder","%","numericInput","","type","text",1,"cl-form-control",3,"decimals","minNumber","maxNumber","ngModel","inputChange","keyup.enter"],["taxInput",""],[4,"ngIf"],[1,"cl-mt-0"],[3,"dueDays","onChange"],["type","text","id","subject","autocomplete","off","inputString","","spellcheck","false",1,"cl-form-control",3,"required","ngModel","placeholder","keyup.enter","inputChange"],["currencyInput",""],[1,"cl-form-group","cl-col-md-12","cl-col-lg-8","cl-col-lg-custom-4"],["name","note","id","note","cols","30","rows","6",1,"cl-form-control",3,"ngModel","change"],[3,"list","initLabel","value","onChanged"],[1,"cl-ml-2","cl-pb-2","cl-btn-link","cl-no-focus-underline",3,"click"],[3,"items","defaults","closeEmit"],[1,"cl-ml-2","cl-pb-2","cl-btn-link",3,"click"],["id","tax2","autocomplete","off","spellcheck","false","placeholder","%","numericInput","","type","text",1,"cl-form-control",3,"decimals","minNumber","maxNumber","ngModel","inputChange","keyup.enter"],[1,"cl-pb-2","cl-btn-link",3,"click"],[1,"cl-custom-control","cl-custom-radio","cl-form-group"],["type","radio","id","simple","name","simpleTax",1,"cl-custom-control-input",3,"value","checked","change"],["for","simple",1,"cl-custom-control-label"],["type","radio","id","compound","name","compoundTax",1,"cl-custom-control-input",3,"value","checked","change"],["for","compound",1,"cl-custom-control-label"]],template:function(e,t){if(1&e){const e=s.Yb();s.Xc(0,UH,13,9,"div",0),s.Xc(1,GH,1,2,"ng-template",null,1,s.Yc),s.Xb(3,"div",2),s.Xb(4,"div",3),s.Xb(5,"div",4),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xb(8,"div",5),s.Xb(9,"div",2),s.Xb(10,"div",6),s.Xb(11,"input",7,8),s.jc("inputChange",(function(e){return t.defaults.tax=e,t.modelChanged()}))("keyup.enter",(function(){return s.Oc(e),s.Lc(12).blur()})),s.Wb(),s.Wb(),s.Xc(13,xH,4,3,"ng-container",9),s.Wb(),s.Wb(),s.Wb(),s.Xc(14,FH,29,23,"ng-container",9),s.Sb(15,"hr",10),s.Xb(16,"payment-due",11),s.jc("onChange",(function(e){return t.setDueDays(e)})),s.Wb(),s.Sb(17,"hr",10),s.Xb(18,"div",2),s.Xb(19,"div",3),s.Xb(20,"div",4),s.Zc(21),s.oc(22,"translate"),s.Wb(),s.Wb(),s.Xb(23,"div",5),s.Xb(24,"div",2),s.Xb(25,"div",3),s.Xb(26,"input",12,13),s.jc("keyup.enter",(function(){return s.Oc(e),s.Lc(27).blur()}))("inputChange",(function(e){return t.defaults.subject=e,t.modelChanged()})),s.oc(28,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Sb(29,"hr",10),s.Xb(30,"div",2),s.Xb(31,"div",3),s.Xb(32,"div",4),s.Zc(33),s.oc(34,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(35,"div",2),s.Xb(36,"div",14),s.Xb(37,"textarea",15),s.jc("change",(function(e){return t.setNotes(e),t.modelChanged()})),s.Wb(),s.Wb(),s.Wb()}2&e&&(s.wc("ngIf",t.hasExpensesFeature&&t.workspace.expensesEnabled),s.Cb(6),s.ad(s.pc(7,15,"INVOICES.SHARED.TAX")),s.Cb(5),s.wc("decimals",6)("minNumber",-100)("maxNumber",100)("ngModel",null==t.defaults?null:t.defaults.tax),s.Cb(2),s.wc("ngIf",!t.showTax2&&0==(null==t.defaults?null:t.defaults.tax2)),s.Cb(1),s.wc("ngIf",0!==(null==t.defaults?null:t.defaults.tax2)||t.showTax2),s.Cb(2),s.wc("dueDays",null==t.defaults?null:t.defaults.dueDays),s.Cb(5),s.ad(s.pc(22,17,"INVOICES.DETAILS.SUBJECT")),s.Cb(5),s.xc("placeholder",s.pc(28,19,"INVOICES.DETAILS.SUBJECT")),s.wc("required",!1)("ngModel",null==t.defaults?null:t.defaults.subject),s.Cb(7),s.ad(s.pc(34,21,"INVOICES.SHARED.NOTES")),s.Cb(4),s.wc("ngModel",null==t.defaults?null:t.defaults.notes))},directives:[i.u,v.c,ls,v.s,v.v,WH,vo,v.D,ji.a,BH],pipes:[g.e],encapsulation:2}),e})();function ZH(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",3),s.Xb(1,"input",12),s.jc("ngModelChange",(function(t){s.Oc(e);const n=s.nc();return n.pdf.itemType=t,n.modelChanged()})),s.Wb(),s.Xb(2,"label",13),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(1),s.wc("ngModel",null==e.pdf?null:e.pdf.itemType),s.Cb(2),s.bd(" ",s.pc(4,2,"INVOICES.ITEM_TYPE.TITLE")," ")}}let VH=(()=>{class e{constructor(){this.onSave=new s.n}set pdf(e){e&&(this._pdf=e)}get pdf(){return this._pdf}set workspace(e){e&&(this._workspace=e,this.hasExpensesFeature=this._workspace.hasFeature(is.a.EXPENSES))}ngOnInit(){}modelChanged(){this.onSave.emit(this.pdf)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Lb({type:e,selectors:[["appearance-tab"]],inputs:{pdf:"pdf",workspace:"workspace"},outputs:{onSave:"onSave"},decls:27,vars:19,consts:[[1,"cl-form-row","cl-d-block"],[1,"cl-form-group","cl-col-md-12"],[1,"cl-h2","cl-mb-0"],[1,"cl-custom-control","cl-custom-checkbox"],["type","checkbox","id","quantity",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","quantity",1,"cl-custom-control-label"],["type","checkbox","id","unitprice",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","unitprice",1,"cl-custom-control-label"],["class","cl-custom-control cl-custom-checkbox",4,"ngIf"],[1,"cl-custom-control","cl-custom-switch"],["type","checkbox","name","rtl","id","rtl",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","rtl",1,"cl-custom-control-label"],["type","checkbox","id","itemType",1,"cl-custom-control-input",3,"ngModel","ngModelChange"],["for","itemType",1,"cl-custom-control-label"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Zc(3),s.oc(4,"translate"),s.Wb(),s.Wb(),s.Xb(5,"div",3),s.Xb(6,"input",4),s.jc("ngModelChange",(function(e){return t.pdf.quantity=e,t.modelChanged()})),s.Wb(),s.Xb(7,"label",5),s.Zc(8),s.oc(9,"translate"),s.Wb(),s.Wb(),s.Xb(10,"div",3),s.Xb(11,"input",6),s.jc("ngModelChange",(function(e){return t.pdf.unitPrice=e,t.modelChanged()})),s.Wb(),s.Xb(12,"label",7),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Xc(15,ZH,5,4,"div",8),s.Wb(),s.Sb(16,"hr"),s.Xb(17,"div",0),s.Xb(18,"div",1),s.Xb(19,"div",2),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Wb(),s.Xb(22,"div",9),s.Xb(23,"input",10),s.jc("ngModelChange",(function(e){return t.pdf.RTL=e,t.modelChanged()})),s.Wb(),s.Xb(24,"label",11),s.Zc(25),s.oc(26,"translate"),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.ad(s.pc(4,9,"INVOICES.SHOW_COLUMNS_IN_PDF")),s.Cb(3),s.wc("ngModel",null==t.pdf?null:t.pdf.quantity),s.Cb(2),s.bd(" ",s.pc(9,11,"INVOICES.SHARED.QUANTITY")," "),s.Cb(3),s.wc("ngModel",null==t.pdf?null:t.pdf.unitPrice),s.Cb(2),s.bd(" ",s.pc(14,13,"INVOICES.SHARED.UNIT_PRICE")," "),s.Cb(2),s.wc("ngIf",t.hasExpensesFeature&&t._workspace.expensesEnabled),s.Cb(5),s.ad(s.pc(21,15,"INVOICES.SETTINGS.TEXT_DISPLAY.TITLE")),s.Cb(3),s.wc("ngModel",null==t.pdf?null:t.pdf.RTL),s.Cb(2),s.bd(" ",s.pc(26,17,"INVOICES.SETTINGS.TEXT_DISPLAY.LABEL")," "))},directives:[v.a,v.s,v.v,i.u],pipes:[g.e],encapsulation:2}),e})();const YH=["tabs"];function HH(e,t){if(1&e){const e=s.Yb();s.Xb(0,"translations-tab",15),s.jc("onSave",(function(t){return s.Oc(e),s.nc().saveLabels(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("labels",null==e.settings?null:e.settings.labels)("workspace",e.workspace)}}function $H(e,t){if(1&e){const e=s.Yb();s.Xb(0,"defaults-tab",16),s.jc("onSave",(function(t){return s.Oc(e),s.nc().saveDefaults(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("defaults",null==e.settings?null:e.settings.defaults)("workspace",e.workspace)}}function KH(e,t){if(1&e){const e=s.Yb();s.Xb(0,"appearance-tab",17),s.jc("onSave",(function(t){return s.Oc(e),s.nc().saveExportFields(t)})),s.Wb()}if(2&e){const e=s.nc();s.wc("pdf",null==e.settings?null:e.settings.exportFields)("workspace",e.workspace)}}const qH=function(){return{count:2}};let zH=(()=>{class e{constructor(e,t,n,i){this.router=e,this.activatedRoute=t,this.invoiceService=n,this.workspaceService=i,this.unsubscribe$=new Fn.a}ngOnInit(){this.invoiceService.getInvoiceSettings().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.settings=e}),this.activatedRoute.fragment.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{const t=aH[(e||"").toUpperCase()];this.pills={[t||aH.DEFAULTS]:!0},t||this.router.navigate([])}),this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.invoiceService.refreshSettings().pipe(Object(Pe.a)(this.unsubscribe$),Object(cH.a)(()=>this.invoiceService.getInvoiceSettings())).subscribe(e=>{this.settings=e})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}saveLabels(e){this.settings.labels=e,this.invoiceService.editInvoiceSettings(this.settings).subscribe()}saveDefaults(e){this.settings.defaults=e,this.invoiceService.editInvoiceSettings(this.settings).subscribe()}saveExportFields(e){this.settings.exportFields=e,this.invoiceService.editInvoiceSettings(this.settings).subscribe()}activatePill(e){this.pills={[e]:!0},e===aH.DEFAULTS?this.router.navigate([]):this.router.navigate([],{fragment:e.toString().toLowerCase()})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.d),s.Rb(k.a),s.Rb(ti),s.Rb(l.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["invoice-settings"]],viewQuery:function(e,t){var n;1&e&&s.gd(YH,!0),2&e&&s.Kc(n=s.kc())&&(t.tabs=n.first)},decls:28,vars:23,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],["routerLink","/invoices","translate","",1,"cl-d-inline-block","cl-mb-2","cl-d-print-none",3,"translateParams"],[1,"cl-d-flex","cl-align-items-center"],[1,"cl-scroll-tabs-wrapper"],["tabs","",1,"cl-nav","cl-nav-tabs","cl-m-0","cl-scroll-tabs"],["tabs","tabs"],[1,"cl-nav-item"],[1,"cl-nav-link",3,"click"],[1,"cl-card"],[1,"cl-card-body"],[3,"labels","workspace","onSave",4,"ngIf"],[3,"defaults","workspace","onSave",4,"ngIf"],[3,"pdf","workspace","onSave",4,"ngIf"],[3,"labels","workspace","onSave"],[3,"defaults","workspace","onSave"],[3,"pdf","workspace","onSave"]],template:function(e,t){1&e&&(s.Xb(0,"main",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"a",3),s.Zc(4,"INVOICES.INVOICE"),s.Wb(),s.Xb(5,"h1",4),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xb(8,"div",5),s.Xb(9,"ul",6,7),s.Xb(11,"li",8),s.Xb(12,"a",9),s.jc("click",(function(){return t.activatePill("DEFAULTS")})),s.Zc(13),s.oc(14,"translate"),s.Wb(),s.Wb(),s.Xb(15,"li",8),s.Xb(16,"a",9),s.jc("click",(function(){return t.activatePill("APPEARANCE")})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb(),s.Xb(19,"li",8),s.Xb(20,"a",9),s.jc("click",(function(){return t.activatePill("TRANSLATIONS")})),s.Zc(21),s.oc(22,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(23,"div",10),s.Xb(24,"div",11),s.Xc(25,HH,1,2,"translations-tab",12),s.Xc(26,$H,1,2,"defaults-tab",13),s.Xc(27,KH,1,2,"appearance-tab",14),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Cb(3),s.wc("translateParams",s.Ac(22,qH)),s.Cb(3),s.ad(s.pc(7,14,"INVOICES.SETTINGS.HEADER")),s.Cb(6),s.Hb("cl-active",t.pills.DEFAULTS),s.Cb(1),s.bd(" ",s.pc(14,16,"INVOICES.SETTINGS.DEFAULTS_LABEL")," "),s.Cb(3),s.Hb("cl-active",t.pills.APPEARANCE),s.Cb(1),s.bd(" ",s.pc(18,18,"INVOICES.SETTINGS.APPEARANCE_LABEL")," "),s.Cb(3),s.Hb("cl-active",t.pills.TRANSLATIONS),s.Cb(1),s.bd(" ",s.pc(22,20,"INVOICES.SETTINGS.TRANSLATIONS_LABEL")," "),s.Cb(4),s.wc("ngIf",t.pills.TRANSLATIONS),s.Cb(1),s.wc("ngIf",t.pills.DEFAULTS),s.Cb(1),s.wc("ngIf",t.pills.APPEARANCE))},directives:[k.g,g.b,lo.a,i.u,IH,jH,VH],pipes:[g.e],encapsulation:2}),e})();function QH(e,t){1&e&&s.Sb(0,"img",23)}function JH(e,t){if(1&e){const e=s.Yb();s.Xb(0,"stripe-invoice",24),s.jc("turnAddress",(function(t){return s.Oc(e),s.nc(2).addressOn=t}))("nextStep",(function(){return s.Oc(e),s.nc(2).toggleInformation(!0)})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("editInvoiceInformation",e.invoiceInformation)("workspaceName",e.workspace.name)("mode","create")}}function e$(e,t){if(1&e){const e=s.Yb();s.Xb(0,"stripe",25),s.jc("paymentInformation",(function(t){s.Oc(e);const n=s.nc(2),i=s.Lc(13);return n.getPaymentInformation(t,i)}))("closeDialog",(function(){return s.Oc(e),s.nc(2).toggleInformation(!1)})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("editPaymentInformation",e.paymentInformation)("invoiceInformation",e.invoiceInformation)("mode","create")("isPaymentInfo",!0)("isMonthly",!1)("paymentFailedMessage",e.failMessage)}}function t$(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",11),s.Xb(1,"div",12),s.Xb(2,"div",11),s.Xb(3,"div",13),s.Xb(4,"ul",14),s.Xb(5,"li",15),s.Xb(6,"a",16),s.jc("click",(function(){return s.Oc(e),s.nc().toggleInformation(!1)})),s.Xb(7,"div",17),s.Zc(8),s.oc(9,"translate"),s.Xc(10,QH,1,0,"img",18),s.Wb(),s.Xb(11,"div",19),s.Zc(12),s.oc(13,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Xb(14,"li",15),s.Xb(15,"a",16),s.jc("click",(function(){return s.Oc(e),s.nc().toggleInformation(!0)})),s.Xb(16,"div",17),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Xb(19,"div",19),s.Zc(20),s.oc(21,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(22,"div",20),s.Xc(23,JH,1,3,"stripe-invoice",21),s.Xc(24,e$,1,6,"stripe",22),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(6),s.Hb("cl-active",!e.isPayment),s.Cb(2),s.bd(" ",s.pc(9,11,"GLOBAL.STEP_1_TITLE")," "),s.Cb(2),s.wc("ngIf",e.isPayment),s.Cb(2),s.bd(" ",s.pc(13,13,"GLOBAL.INVOICE_EXPLANATION")," "),s.Cb(3),s.Hb("cl-active",e.isPayment),s.Cb(2),s.bd(" ",s.pc(18,15,"GLOBAL.STEP_2_TITLE")," "),s.Cb(3),s.bd(" ",s.pc(21,17,"GLOBAL.PAYMENT_INFORMATION_TITLE")," "),s.Cb(3),s.wc("ngIf",!e.isPayment),s.Cb(1),s.wc("ngIf",e.isPayment)}}function n$(e,t){1&e&&(s.Xb(0,"div",26),s.Zc(1),s.oc(2,"title"),s.Wb()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"PAYMENT_INFO.ALERT_PERMISSION")," "))}function i$(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",27),s.Xb(1,"h1"),s.Zc(2),s.oc(3,"translate"),s.Wb(),s.Wb(),s.Xb(4,"div",28),s.Xb(5,"p"),s.Zc(6),s.oc(7,"translate"),s.Xb(8,"b"),s.Zc(9),s.Wb(),s.Zc(10),s.oc(11,"translate"),s.Wb(),s.Wb(),s.Xb(12,"div",29),s.Xb(13,"a",30),s.jc("click",(function(){return t.$implicit.close()})),s.Zc(14),s.oc(15,"translate"),s.Wb(),s.Xb(16,"button",31),s.jc("click",(function(){return s.Oc(e),s.nc().savePaymentInfo()})),s.Zc(17),s.oc(18,"translate"),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.Cb(2),s.bd(" ",s.pc(3,6,"GLOBAL.SAVE_INFO_TITLE")," "),s.Cb(4),s.bd(" ",s.pc(7,8,"PAYMENT_INFO.CONFIRM_MODAL.CONTENT1")," "),s.Cb(3),s.ad(e.workspace.name),s.Cb(1),s.bd(" ",s.pc(11,10,"PAYMENT_INFO.CONFIRM_MODAL.CONTENT2")," "),s.Cb(4),s.bd(" ",s.pc(15,12,"GLOBAL.CANCEL_BTN")," "),s.Cb(3),s.bd(" ",s.pc(18,14,"GLOBAL.SAVE_LABEL")," ")}}let s$=(()=>{class e{constructor(e,t,n,i,s,c,a){this.toaster=e,this.workspaceService=t,this.paymentService=n,this.loader=i,this.modal=s,this.authService=c,this.translate=a,this.unsubscribe$=new p.a,this.invoiceInformation=new Cw.a,this.paymentInformation=new Aw.a}ngOnInit(){this.translations=this.translate.instant(["GLOBAL.COMPANY_NAME_ERROR_MESSAGE","GLOBAL.ADDRESS_FIELDS_ERROR_MESSAGE","GLOBAL.VAT_ERROR_MESSAGE","GLOBAL.BILLING_CHANGE_SUCCESS_MESSAGE","GLOBAL.BILLING_CHANGE_SUCCESS_BODY"]),this.workspace=this.workspaceService.getLocalDefaultWorkspace(),this.isAdmin=this.authService.isAdminOrOwner(),this.isAdmin&&(this.paymentService.getPaymentInformation().pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.paymentInformation=e}),this.paymentService.getInvoiceInformation(this.workspace.id).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.invoiceInformation=e}))}toggleInformation(e){this.invoiceInformation.isCompanyNameEmpty()?this.toaster.pop("error",this.translations["GLOBAL.COMPANY_NAME_ERROR_MESSAGE"]):this.invoiceInformation.isAddressEmpty(this.addressOn)?this.toaster.pop("error",this.translations["GLOBAL.ADDRESS_FIELDS_ERROR_MESSAGE"]):this.invoiceInformation.isVatEmpty()?this.toaster.pop("error",this.translations["GLOBAL.VAT_ERROR_MESSAGE"]):(window.scrollTo(0,0),this.isPayment=e)}getPaymentInformation(e,t){this.paymentInformation=new Aw.a(e),this.modal.open(t,{centered:!0})}ngOnDestroy(){this.unsubscribe$.next(!0),this.unsubscribe$.complete()}savePaymentInfo(){this.loader.show();const e=this.paymentService.editPaymentInformation(this.workspace.id,this.paymentInformation),t=this.paymentService.editInvoiceInformation(this.workspace.id,this.invoiceInformation);Object(Sb.a)(e,t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.paymentInformation=e[0],this.invoiceInformation=e[1],this.toaster.pop("success",this.translations["GLOBAL.BILLING_CHANGE_SUCCESS_MESSAGE"],this.translations["GLOBAL.BILLING_CHANGE_SUCCESS_BODY"]),this.loader.hide(),this.modal.dismissAll()},e=>{var t;this.failMessage=null===(t=e.error)||void 0===t?void 0:t.message,this.loader.hide()})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(r.a),s.Rb(l.a),s.Rb(dC.a),s.Rb(Hn.a),s.Rb(w.q),s.Rb(re.a),s.Rb(g.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["payment-info"]],decls:14,vars:5,consts:[[1,"cl-page-wrapper"],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-align-items-center"],[1,"cl-col-md-4","cl-mb-3","cl-mb-md-0","cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-justify-content-md-start"],[1,"cl-float-left"],[1,"cl-mt-3"],[1,"cl-h-100","cl-pt-2","cl-px-3","cl-pb-3","cl-bg-white","cl-border","cl-rounded"],["class","cl-row",4,"ngIf"],["class","cl-alert cl-alert-info cl-mt-3",4,"ngIf"],["confirm",""],[1,"cl-row"],[1,"cl-col-lg-custom-4"],[1,"cl-col-lg-custom-12"],["id","myTab","role","tablist",1,"cl-nav","cl-nav-tabs","cl-custom-tabs-minimal","cl-mb-2"],[1,"cl-nav-item","cl-flex-grow-1"],[1,"cl-nav-link","cl-pl-0","cl-text-left",3,"click"],[1,"cl-h5","cl-mb-0"],["src","/assets/images/ui-icons/checkmark-green.svg","class","cl-ml-2",4,"ngIf"],[1,"cl-lowercase"],[1,"cl-tab-content"],[3,"editInvoiceInformation","workspaceName","mode","turnAddress","nextStep",4,"ngIf"],[3,"editPaymentInformation","invoiceInformation","mode","isPaymentInfo","isMonthly","paymentFailedMessage","paymentInformation","closeDialog",4,"ngIf"],["src","/assets/images/ui-icons/checkmark-green.svg",1,"cl-ml-2"],[3,"editInvoiceInformation","workspaceName","mode","turnAddress","nextStep"],[3,"editPaymentInformation","invoiceInformation","mode","isPaymentInfo","isMonthly","paymentFailedMessage","paymentInformation","closeDialog"],[1,"cl-alert","cl-alert-info","cl-mt-3"],[1,"cl-modal-header"],[1,"cl-modal-body"],[1,"cl-modal-footer"],[1,"cl-color-blue",3,"click"],["type","button","ngbAutofocus","",1,"cl-btn","cl-btn-primary",3,"click"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"div",1),s.Xb(2,"div",2),s.Xb(3,"div",3),s.Xb(4,"div",4),s.Xb(5,"h1",5),s.Zc(6),s.oc(7,"translate"),s.Wb(),s.Wb(),s.Xb(8,"div",6),s.Xb(9,"div",7),s.Xc(10,t$,25,19,"div",8),s.Xc(11,n$,3,3,"div",9),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(12,i$,19,16,"ng-template",null,10,s.Yc)),2&e&&(s.Cb(6),s.bd(" ",s.pc(7,3,"GLOBAL.PAYMENT_INFORMATION_TITLE")," "),s.Cb(4),s.wc("ngIf",t.isAdmin),s.Cb(1),s.wc("ngIf",!t.isAdmin))},directives:[i.u,Lw,Bw],pipes:[g.e],encapsulation:2}),e})(),c$=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(e){var t;const n=this.workspaceService.getLocalDefaultWorkspace();return!(!n.hasFeature(is.a.TIME_OFF)||!(null===(t=n.timeOff)||void 0===t?void 0:t.active))||(this.router.navigate(["tracker"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(s.fc(l.a),s.fc(k.d))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var a$=n("AYje"),o$=n("c+i4"),r$=n("gtca"),l$=n("IS9F");const b$=["detailedHeader"],d$=["editModal"],u$=["detailedRows"];function p$(e,t){if(1&e){const e=s.Yb();s.Xb(0,"reports-filter",22),s.jc("onApply",(function(t){return s.Oc(e),s.nc(2).applyFilter(t)})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("hideMembers",e.hideMembers)("isExpense",!0)("hideUserGroupMembers",e.hideUserGroupMembers)("description",e.description)("valuesData",e.filterValuesData)("note",e.note)("withoutNote",e.withoutNote)("withoutDescription",e.withoutDescription)("customFieldFilters",e.customFieldFilters)}}const h$=function(e){return{"cl-disabled":e}};function m$(e,t){if(1&e){const e=s.Yb();s.Vb(0),s.Xb(1,"div",23),s.Xb(2,"tr",24,25),s.jc("onSelectChange",(function(){return s.Oc(e),s.nc(2).calculateNumberOfSelected()}))("deleteExpense",(function(t){return s.Oc(e),s.nc(2).deleteExpense(t)}))("editExpense",(function(t){return s.Oc(e),s.nc(2).editExpense(t)})),s.Wb(),s.Wb(),s.Ub()}if(2&e){const e=t.$implicit,n=s.nc(2);s.Cb(2),s.wc("isDesktop",n.isDesktop)("ngClass",s.Bc(7,h$,n.editEntryDisabled(e)))("expandAll",n.expandAll)("disableEdit",n.editEntryDisabled(e))("expenseEntry",e)("isAdminOrOwner",n.isAdminOrOwner)("invoicingEnabled",n.workspace.invoicingEnabled)}}function g$(e,t){if(1&e){const e=s.Yb();s.Xb(0,"app-create-expense",26),s.jc("close",(function(){return t.$implicit.close()}))("selectedUser",(function(t){return s.Oc(e),s.nc(2).selectUser(t)})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("user",e.selectedUser)("expense",e.expense)}}function E$(e,t){if(1&e){const e=s.Yb();s.Xb(0,"pager",27),s.jc("pageChanged",(function(t){return s.Oc(e),s.nc(2).setPagination(t)}))("limitChanged",(function(t){return s.Oc(e),s.nc(2).setPagination(t)})),s.Wb()}if(2&e){const e=s.nc(2);s.wc("page",e.pagination.page)("limit",e.pagination.pageSize)("total",e.entriesCount)}}function f$(e,t){if(1&e){const e=s.Yb();s.Xb(0,"div",4),s.Xb(1,"div",5),s.Xb(2,"div",6),s.Xb(3,"div",7),s.Sb(4,"switch-reports",8),s.Wb(),s.Xb(5,"div",9),s.Xb(6,"div",10),s.Xb(7,"div",11),s.Xb(8,"datepicker-range",12),s.jc("dateRangeOut",(function(t){return s.Oc(e),s.nc().updateDateRange(t)})),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xc(9,p$,1,9,"reports-filter",13),s.Xb(10,"expenses-table-info",14),s.jc("exportAsCsv",(function(){return s.Oc(e),s.nc().exportExpenseAsCsv()}))("exportAsExcel",(function(){return s.Oc(e),s.nc().exportExpenseAsExcel()}))("downloadReceipts",(function(){return s.Oc(e),s.nc().downloadReceipts()})),s.Wb(),s.Xb(11,"div",15),s.Xb(12,"table",16),s.Xb(13,"thead"),s.Xb(14,"tr",17,18),s.jc("onSelectAllChange",(function(t){return s.Oc(e),s.nc().setAllChange(t)}))("onExpandAll",(function(t){return s.Oc(e),s.nc().expandAllRows(t)}))("onChange",(function(t){return s.Oc(e),s.nc().columnOrderChanged(t)}))("onMarkAs",(function(t){s.Oc(e);const n=s.nc(),i=s.Lc(3);return n.markAsInvoiced=t,n.openModal(i)}))("bulkDelete",(function(){s.Oc(e);const t=s.nc(),n=s.Lc(5);return t.openModal(n)})),s.Wb(),s.Wb(),s.Xb(16,"tbody"),s.Xc(17,m$,4,9,"ng-container",19),s.Wb(),s.Wb(),s.Wb(),s.Xc(18,g$,1,2,"ng-template",null,20,s.Yc),s.Xc(20,E$,1,3,"pager",21),s.Wb()}if(2&e){const e=s.nc();s.Cb(4),s.wc("page","EXPENSE_DETAILED"),s.Cb(4),s.wc("timeEntriesDateRange",e.dateRange),s.Cb(1),s.wc("ngIf",e.filterValuesData),s.Cb(1),s.wc("totalInfo",e.expenseTotalInfo),s.Cb(4),s.wc("invoicingEnabled",e.workspace.invoicingEnabled)("numberOfAvailableEntries",e.numberOfAvailableEntries)("numberOfSelected",e.numberOfSelected)("numberOfEntries",null==e.expenseEntries?null:e.expenseEntries.length)("isAdminOrOwner",e.isAdminOrOwner)("isDesktop",e.isDesktop)("totalExpenses",null==e.expenseTotalInfo?null:e.expenseTotalInfo.entriesCount)("areAllCheckedEntriesInvoiced",e.areAllCheckedEntriesInvoiced)("sortOrder",e.sortData.sortOrder)("entriesOnOtherPages",e.entriesOnOtherPages)("sortColumn",e.sortData.sortColumn),s.Cb(3),s.wc("ngForOf",e.expenseEntries),s.Cb(3),s.wc("ngIf",e.showPagination)}}function S$(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"REPORTS.DETAILED_REPORT.NEW_INVOICE_MODAL_INFO_EXPENSES_1")," "))}function C$(e,t){1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e&&(s.Cb(1),s.bd(" ",s.pc(2,1,"REPORTS.DETAILED_REPORT.NEW_INVOICE_MODAL_INFO_EXPENSES_2")," "))}function A$(e,t){if(1&e){const e=s.Yb();s.Xb(0,"simple-modal",28),s.jc("confirmed",(function(){s.Oc(e);const n=t.$implicit,i=s.nc();return i.invoiceMarkAs(i.markAsInvoiced),n.close()}))("close",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",29),s.Xc(4,S$,3,3,"ng-container",30),s.Xc(5,C$,3,3,"ng-container",30),s.Wb(),s.Wb()}if(2&e){const e=s.nc();s.wc("title",s.pc(1,4,e.markAsInvoiced?"REPORTS.DETAILED_REPORT.MARK_INVOICED_BTN":"REPORTS.DETAILED_REPORT.MARK_UNINVOICED_BTN"))("btnText",s.pc(2,6,e.markAsInvoiced?"REPORTS.DETAILED_REPORT.NEW_INVOICE_BTN":"REPORTS.DETAILED_REPORT.NEW_UNINVOICE_BTN")),s.Cb(4),s.wc("ngIf",e.markAsInvoiced),s.Cb(1),s.wc("ngIf",!e.markAsInvoiced)}}const O$=function(e){return{count:e}};function v$(e,t){if(1&e&&(s.Vb(0),s.Zc(1),s.oc(2,"translate"),s.Ub()),2&e){const e=s.nc(2);s.Cb(1),s.bd(" ",s.qc(2,1,"REPORTS.DETAILED_EXPENSES_REPORT.DELETE_MODAL_BODY_INFO_WITH_PARAM",s.Bc(4,O$,e.numberOfExpenseEntriesSelected))," ")}}function T$(e,t){1&e&&(s.Zc(0),s.oc(1,"translate")),2&e&&s.bd(" ",s.pc(1,1,"REPORTS.DETAILED_EXPENSES_REPORT.DELETE_MODAL_BODY_INFO")," ")}function I$(e,t){if(1&e){const e=s.Yb();s.Xb(0,"delete-confirm-modal",31),s.jc("onDelete",(function(){s.Oc(e);const n=t.$implicit;return s.nc().deleteManyConfirmed(n)}))("onClose",(function(){return t.$implicit.close()})),s.oc(1,"translate"),s.oc(2,"translate"),s.Xb(3,"p",32),s.Xc(4,v$,3,6,"ng-container",33),s.Wb(),s.Xc(5,T$,2,3,"ng-template",null,34,s.Yc),s.Wb()}if(2&e){const e=s.Lc(6),t=s.nc();s.wc("title",s.pc(1,5,"GLOBAL.DELETE_BTN"))("inProgress",t.isDeleteInProgress)("btnText",s.pc(2,7,"GLOBAL.DELETE_BTN")),s.Cb(4),s.wc("ngIf",t.isAdminOrOwner||!t.bulkEditDataService.isSelectedAllGlobally)("ngIfElse",e)}}let w$=(()=>{class e extends o_{constructor(e,t,n,i,s,c,a,o,r,l,b,d,u,p,h,m,g,E,f,S,C,A,O,v){super(e,t,n,i,s,c,a,o,r,b,d,u,p,h,g,E,f,S,C,v),this.bulkEditDataService=m,this.expenseService=A,this.invoiceService=O,this.analyticsService=v,this.TYPE=Fy.a.EXPENSE_DETAILED}ngOnInit(){super.ngOnInit(),this.userId=this.authService.getUser().id,this.user=this.authService.getUser(),this.selectedUser=this.user}getReports(e){this.loader.show("GLOBAL.LOADER_LOADING"),this.totalOptions=(null==e?void 0:e.totalsOptions)?e.totalsOptions:i_.CALCULATE;const t=this.createExpenseReportQuery(),n=this.bulkEditDataService.isSelectedAllGlobally;this.reportService.expensesDetailedResponse.pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(({totals:t,expenses:i})=>{var s,c;if(this.errorResponse=!1,this.expenseTotalInfo=t,this.entriesOnOtherPages=(null===(s=this.expenseTotalInfo)||void 0===s?void 0:s.entriesCount)-i.length,this.entriesCount=null===(c=this.expenseTotalInfo)||void 0===c?void 0:c.entriesCount,this.showPagination=this.entriesCount>=In.j||this.entriesCount>=this.pagination.pageSize,this.expenseEntries=i,this.numberOfAvailableEntries=this.expenseEntries.filter(e=>!e.isLocked).length,0===i.length&&1!==this.pagination.page)return this.pagination.page=1,void this.getReports();n&&e&&e.keepSelectedAllGlobally?(this.cd.detectChanges(),this.setAllChange(!0),setTimeout(()=>{this.detailedHeader.selectAllGlobally()})):this.calculateNumberOfSelected(),this.loader.hide()},()=>{this.errorResponse=!0,this.cd.markForCheck(),this.loader.hide()}),this.reportService.getExpensesDetailedReport(t)}calculateNumberOfSelected(){if(!this.expenseEntries)return this.numberOfSelected=0,void(this.numberOfAvailableEntries=0);const e=this.expenseEntries.filter(e=>e.bulkEdit).length;this.numberOfSelected=e,this.cd.detectChanges(),this.numberOfAvailableEntries=this.detailedRows.filter(e=>!e.disableEdit).length,this.workspace.invoicingEnabled&&(this.areAllCheckedEntriesInvoiced=this.expenseEntries.filter(e=>e.bulkEdit).every(e=>e.hasInvoice))}setAllChange(e){this.detailedRows.forEach(t=>{t.setIsSelected(e)}),this.calculateNumberOfSelected()}defaultFilter(){}get expenseEntriesSelected(){return this.expenseEntries.filter(e=>e.bulkEdit)}get numberOfExpenseEntriesSelected(){return this.bulkEditDataService.isSelectedAllGlobally?this.expenseEntriesSelected.length+this.entriesOnOtherPages:this.expenseEntriesSelected.length}expandAllRows(e){this.expandAll=e,this.cd.detectChanges()}columnOrderChanged(e){this.sortData=e,this.navigate(),this.uiSettingsService.setSettings(xn.b.EXPENSE_DETAILED_SORT,this.sortData)}editEntryDisabled(e){return!this.isAdminOrOwner&&(!!e.isLocked||this.userId!==e.userId&&!this.isManagerAllowedToEditEntry(e))}isManagerAllowedToEditEntry(e){return this.isTeamManagerAllowedToEdit&&this.teamManagerUsers.some(t=>t.id===e.userId)}deleteExpense(e){this.expenseService.delete(e.id).subscribe(()=>{this.getReports()})}editExpense(e){this.expense=e,this.selectedUser=new Ca.a({id:this.expense.userId,name:this.expense.userName}),this.openModal(this.editModal)}selectUser(e){this.selectedUser=e,this.getReports()}invoiceMarkAs(e){const t=this.expenseEntriesSelected.map(e=>e.id),n=this.bulkEditDataService.isSelectedAllGlobally;if(this.loader.showBar(),!n)return void this.bulkEntriesInvoiceStatus(t,e);const i=this.createExpenseReportQuery();this.expenseService.getEntryIds(i).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(n=>{this.bulkEntriesInvoiceStatus([...t,...n],e)},()=>{this.loader.hide()})}bulkEntriesInvoiceStatus(e,t){const n=[...new Set(e)];this.invoiceService.bulkExpenseEntriesInvoiceStatus(n,t).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(()=>{this.getReports(),this.detailedHeader.onBulkComplete(),this.loader.hide()},()=>this.loader.hide())}deleteManyConfirmed(e){this.isDeleteInProgress=!0;const t=this.expenseEntriesSelected.map(e=>e.id);if(!this.bulkEditDataService.isSelectedAllGlobally)return void this.deleteExpenseEntryMany(e,t);const n=this.createExpenseReportQuery();this.expenseService.getEntryIds(n).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(n=>{this.deleteExpenseEntryMany(e,[...t,...n])},()=>this.isDeleteInProgress=!1)}deleteExpenseEntryMany(e,t){const n=this.bulkEditDataService.isSelectedAllGlobally;if(this.loader.showBar(),!n)return void this.bulkDelete(t,e);const i=this.createExpenseReportQuery();this.expenseService.getEntryIds(i).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(n=>{this.bulkDelete([...t,...n],e)},()=>{this.loader.hide()})}bulkDelete(e,t){this.expenseService.deleteManyExpense(e).pipe(Object(Pe.a)(this.unsubscribe$)).subscribe(e=>{this.isDeleteInProgress=!1,t.close(),this.getReports(),this.detailedHeader.onBulkComplete()},()=>{this.isDeleteInProgress=!1})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.a),s.Rb(re.a),s.Rb(s.h),s.Rb(xn.a),s.Rb(k.d),s.Rb(Uy.a),s.Rb(k.a),s.Rb(By.a),s.Rb(Gn.a),s.Rb(vn.a),s.Rb(Hn.a),s.Rb(WA.a),s.Rb(w.q),s.Rb(bn.a),s.Rb(Gy.a),s.Rb(l_.a),s.Rb(UA.a),s.Rb(a_.a),s.Rb(Ic.a),s.Rb(g.f),s.Rb(Ra.a),s.Rb(a$.a),s.Rb(ti),s.Rb(xi.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["detailed-expense-reports"]],viewQuery:function(e,t){var n;1&e&&(s.gd(b$,!0),s.gd(d$,!0),s.gd(u$,!0)),2&e&&(s.Kc(n=s.kc())&&(t.detailedHeader=n.first),s.Kc(n=s.kc())&&(t.editModal=n.first),s.Kc(n=s.kc())&&(t.detailedRows=n))},features:[s.zb],decls:6,vars:1,consts:[[1,"cl-page-wrapper"],["class","cl-container-fluid",4,"ngIf"],["invoiceBulkModal",""],["delete",""],[1,"cl-container-fluid"],[1,"cl-page-header-wrapper"],[1,"cl-row","cl-align-items-center","cl-justify-content-between"],[1,"cl-col-auto","cl-mb-3","cl-mb-md-0","cl-d-flex","cl-align-items-center","cl-justify-content-between","cl-justify-content-md-start"],[1,"cl-btn-group",3,"page"],[1,"cl-col-auto"],[1,"cl-d-flex","cl-align-items-center","cl-justify-content-sm-end"],[1,"cl-page-header-action","cl-w-100","cl-w-md-auto"],[3,"timeEntriesDateRange","dateRangeOut"],["class","cl-d-block",3,"hideMembers","isExpense","hideUserGroupMembers","description","valuesData","note","withoutNote","withoutDescription","customFieldFilters","onApply",4,"ngIf"],[1,"cl-card","cl-border-bottom-0","cl-mb-0",3,"totalInfo","exportAsCsv","exportAsExcel","downloadReceipts"],[1,"cl-page-component-wrapper"],[1,"cl-detailed-expense-table","cl-table","cl-table-bordered","cl-remove-cell-borders","cl-responsive","cl-text-gray-6"],["expense-detailed-header","",3,"invoicingEnabled","numberOfAvailableEntries","numberOfSelected","numberOfEntries","isAdminOrOwner","isDesktop","totalExpenses","areAllCheckedEntriesInvoiced","sortOrder","entriesOnOtherPages","sortColumn","onSelectAllChange","onExpandAll","onChange","onMarkAs","bulkDelete"],["detailedHeader",""],[4,"ngFor","ngForOf"],["editModal",""],[3,"page","limit","total","pageChanged","limitChanged",4,"ngIf"],[1,"cl-d-block",3,"hideMembers","isExpense","hideUserGroupMembers","description","valuesData","note","withoutNote","withoutDescription","customFieldFilters","onApply"],[1,"cl-row-hover-shadow"],["expense-detailed-row","",3,"isDesktop","ngClass","expandAll","disableEdit","expenseEntry","isAdminOrOwner","invoicingEnabled","onSelectChange","deleteExpense","editExpense"],["detailedRows",""],[3,"user","expense","close","selectedUser"],[3,"page","limit","total","pageChanged","limitChanged"],[3,"title","btnText","confirmed","close"],[1,"cl-text-muted","cl-cut-text-wrap"],[4,"ngIf"],[3,"title","inProgress","btnText","onDelete","onClose"],[1,"cl-h2","cl-cut-text-wrap"],[4,"ngIf","ngIfElse"],["unknownNumberTemplate",""]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xc(1,f$,21,17,"div",1),s.Wb(),s.Xc(2,A$,6,8,"ng-template",null,2,s.Yc),s.Xc(4,I$,7,9,"ng-template",null,3,s.Yc)),2&e&&(s.Cb(1),s.wc("ngIf",t.workspace))},directives:[i.u,f_,ws.a,o$.a,c_.a,i.t,C_.a,r$.a,i.r,l$.a,Pi.a,Si.a,Xd.a],pipes:[g.e],encapsulation:2}),e})(),L$=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(e){const t=this.workspaceService.getLocalDefaultWorkspace();return!(!t.hasFeature(is.a.EXPENSES)||!t.expensesEnabled)||(this.router.navigate(["tracker"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(s.fc(l.a),s.fc(k.d))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})(),R$=(()=>{class e{constructor(e,t){this.workspaceService=e,this.router=t}canActivate(){return!!this.workspaceService.getLocalDefaultWorkspace().schedulingEnabled||(this.router.navigate(["tracker"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(s.fc(l.a),s.fc(k.d))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var y$=n("Nm8O");const _$=[{path:"exchange/:exchangeToken",component:(()=>{class e{constructor(e,t,n,i){this.route=e,this.authService=t,this.router=n,this.jwtHelper=i}ngOnInit(){const e=this.route.snapshot.paramMap.get("exchangeToken"),t=this.route.snapshot.queryParams.redirectUrl,n=this.jwtHelper.decodeToken(e);this.authService.loginWithExchange(e).pipe(Object(ln.a)(1)).subscribe(e=>{this.authService.saveTokenToLocalStorage(e.token,e.refreshToken),n&&n.userId?this.authService.loginAsAdmin(n.userId,n.subdomainName).pipe(Object(ln.a)(1)).subscribe(e=>{this.authService.saveTokenToLocalStorage(e.token,e.refreshToken),this.getUserById(e.id,t)}):this.getUserById(e.id,t)},e=>{console.log(e),this.router.navigate(["login"])})}getUserById(e,t){this.authService.getUserById(e).pipe(Object(ln.a)(1)).subscribe(e=>{e||this.router.navigate(["login"]),this.authService.redirectAfterLogin({url:t||"tracker"})})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(k.a),s.Rb(re.a),s.Rb(k.d),s.Rb(y$.a))},e.\u0275cmp=s.Lb({type:e,selectors:[["exchange-token-redirect"]],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})()},{path:"redirect/:id",canActivate:[UF]},{path:"redirect-integration",component:Bn},{path:"",redirectTo:In.o,pathMatch:"full"},{path:"",component:OG,canActivate:[Sw,oo,dn,gw],resolve:{role:Ew},children:[{path:In.o,component:hI,canActivate:[PP]},{path:"dashboard",component:co},{path:"projects",component:xW.a,canActivate:[kA],data:{page:Pr.PROJECT}},{path:"projects/:projectId/edit",component:FW.a},{path:"approvals",component:PF,canActivate:[MF,BF,GF.a],data:{feature:is.a.APPROVAL}},{path:"approvals/:id",component:Vj,canActivate:[MF,BF,GF.a],data:{feature:is.a.APPROVAL}},{path:"workspaces",canActivate:[GW],component:ro.a},{path:"teams",component:DP,canActivate:[kA],data:{page:Pr.TEAM}},{path:"clients",component:NY,canActivate:[KS.a]},{path:"tags",component:LY,canActivate:[KS.a]},{path:"subscription",component:eY,canActivate:[KS.a,tY,nY],data:{allowIfHasInvoice:!0,redirectionPage:"upgrade"}},{path:"payment-info",component:s$,canActivate:[tY]},{path:"activity/screenshots",component:iH,canActivate:[GF.a,sH],data:{screenshots:!0,feature:is.a.SCREENSHOTS}},{path:"activity",redirectTo:"activity/screenshots",canActivate:[sH],data:{screenshots:!0}},{path:"activity/locations",loadChildren:()=>n.e(10).then(n.bind(null,"/wdg")).then(e=>e.LocationsModule),canActivate:[GF.a,sH],data:{locations:!0,feature:is.a.LOCATIONS}},{path:"workspaces/:workspaceId/settings",component:$S,canActivate:[qS]},{path:"user/settings",component:hw},{path:"reports",redirectTo:"reports/summary",pathMatch:"full",canActivate:[kA],data:{page:Pr.REPORTS}},{path:"reports/summary",component:UW,canActivate:[kA],data:{page:Pr.REPORTS}},{path:"reports/weekly",component:NM,canActivate:[kA],data:{page:Pr.REPORTS}},{path:"reports/detailed",component:wW,canActivate:[kA],data:{page:Pr.REPORTS}},{path:"reports/expense/detailed",component:w$,canActivate:[kA],data:{page:Pr.REPORTS}},{path:"reports/shared",component:SM,canActivate:[kA],data:{page:Pr.REPORTS}},{path:"user/settings/delete",component:bC},{path:"timesheet",component:My,canActivate:[fw]},{path:"upgrade",component:_A,canActivate:[KS.a,tY,nY],data:{allowIfHasInvoice:!1,redirectionPage:"subscription"}},{path:"upgrade/:workspaceId",component:vL,canActivate:[KS.a,tY,iY]},{path:"invoices",component:ns,canActivate:[KS.a,RY,GF.a],data:{feature:is.a.INVOICING}},{path:"invoices/settings",component:zH,canActivate:[KS.a,RY]},{path:"invoices/:id",component:Oc,canActivate:[KS.a]},{path:"email-preferences",component:MY},{path:"webhooks",component:ax},{path:"workspaces/:workspaceId/webhooks/:webhookId",component:gx},{path:"calendar",loadChildren:()=>n.e(8).then(n.bind(null,"wcpF")).then(e=>e.CalendarModule)},{path:"time-off",loadChildren:()=>Promise.all([n.e(1),n.e(11)]).then(n.bind(null,"BoVq")).then(e=>e.PtoModule),canActivate:[c$]},{path:"expenses",loadChildren:()=>Promise.resolve().then(n.bind(null,"Zco2")).then(e=>e.ExpensesModule),canActivate:[L$]},{path:"scheduling",loadChildren:()=>Promise.all([n.e(1),n.e(13)]).then(n.bind(null,"oDMQ")).then(e=>e.SchedulingModule),canActivate:[GF.a,R$],data:{feature:is.a.SCHEDULING}}]}];let k$=(()=>{class e{}return e.components=[OG],e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},imports:[[k.h.forChild(_$)],k.h]}),e})();var W$=n("GwYf"),X$=n("Ww9u");let N$=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,v.C,w.s,S.a,W$.a,X$.a,g.d]]}),e})(),D$=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,L.a,v.m,z.a,O.a,Pt.a,rs.g,St.a,S.a,g.d]]}),e})(),P$=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,rs.g,v.m,D$,O.a,g.d]]}),e})(),M$=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,v.C,w.s,S.a,I.a,S.a,j.a,g.d]]}),e})(),B$=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,v.C,Q.a,g.d]]}),e})(),U$=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[ti],imports:[[i.c,v.m,k.h,L.a,Z.a,y.a,we.a,He.a,Pt.a,O.a,B.a,$.a,B$,N$,M$,ae,P$,z.a,v.C,Se.a,J.a,St.a,M.a,S.a,w.db,g.d]]}),e})(),G$=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[v.m,i.c,w.db]]}),e})();var x$=n("xuKB"),F$=n("nNwe");let j$=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[DL.a],imports:[[i.c,v.m,O.a,B.a,$.a,L.a,Ne.a,I.a,w.r,G$,w.db,Bt,Gt.a,x$.a,fe.a,Oe.a,ye.a,Ue.a,Le.a,g.d,F$.a]]}),e})(),Z$=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[Qe,v.m,i.c,Je,ne,w.O,g.d]]}),e})(),V$=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,v.C,g.d]]}),e})(),Y$=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c]]}),e})(),H$=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,Y$,w.db,B.a,g.d]]}),e})(),$$=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,B.a,g.d]]}),e})(),K$=(()=>{class e{constructor(){this._selectedIds$=new Ge.a([]),this._selectedIds=[],this._allSelected$=new Ge.a([]),this._allSelected=[],this._anythingIsSelected$=new Ge.a(!1),this._allUsers=[]}get selectedIds$(){return this._selectedIds$.asObservable()}get selectAll$(){return this._allSelected$.asObservable()}get anythingIsSelected$(){return this._anythingIsSelected$.asObservable()}getcurrentSelection(){return[].concat(...this._selectedIds.map(e=>e.userIds))}getcurrentSelectedNames(){const e=[];return this._selectedIds.forEach(t=>{const n=this._allUsers.find(e=>e.groupId===t.groupId);n&&n.userIds.forEach((i,s)=>{t.userIds.includes(i)&&e.push(n.names[s])})}),e}setAllPosibleIds(e,t,n,i){const s=this._allUsers.find(e=>e.groupId===n);if(s){const c=this._allUsers.filter(e=>e.groupId!=n);s.userIds="set"===i?e:s.userIds.concat(e),s.names="set"===i?t:s.names.concat(t),c.push(s),this._allUsers=c}else this._allUsers.push({groupId:n,names:t,userIds:e})}setSelectSingle(e,t,n){let i=this._selectedIds.find(t=>t.groupId===e);if(i){const s=this._selectedIds.filter(t=>t.groupId!=e);n?i.userIds.push(t):i={groupId:e,userIds:i.userIds.filter(e=>e!=t)},s.push(i),this._selectedIds=s}else n&&this._selectedIds.push({groupId:e,userIds:[t]});this._selectedIds$.next(this._selectedIds),this.setSelectAll(n?{groupId:e,selectAll:this.checkIsSelectAll(e)}:{groupId:e,selectAll:!1},!1)}setSelectAll(e,t=!0){const n=this._allSelected.find(t=>t.groupId===e.groupId);if(n){const t=this._allSelected.filter(t=>t.groupId!=e.groupId);n.selectAll=e.selectAll,t.push(n),this._allSelected=t}else this._allSelected.push(e);this._allSelected$.next(this._allSelected),t&&this.setSelectedWhenSelectAll(e.groupId,e.selectAll),this._anythingIsSelected$.next(this.checkIsAnythingSelected())}resetSelected(){this._selectedIds=[],this._selectedIds$.next([]),this._allSelected=[],this._allSelected$.next([]),this._anythingIsSelected$.next(!1)}resetAllUserArray(){this._allUsers=[]}setSelectedWhenSelectAll(e,t){const n=this._selectedIds.filter(t=>t.groupId!=e);n.push({groupId:e,userIds:t?this._allUsers.find(t=>t.groupId===e).userIds:[]}),this._selectedIds=n,this._selectedIds$.next(this._selectedIds)}checkIsSelectAll(e){var t;const n=null===(t=this._allUsers.find(t=>t.groupId===e))||void 0===t?void 0:t.userIds,i=this._selectedIds$.getValue().find(t=>t.groupId===e).userIds;return!!i.length&&n.length===i.length}checkIsAnythingSelected(){return this._selectedIds.some(e=>e.userIds.length>0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})(),q$=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[MF,K$],imports:[[i.c,v.m,k.h,v.C,B.a,y.a,S.a,ve.a,oe.a,H$,A.a,C.a,je.a,$$,$.a,V$,Pt.a,O.a,x$.a,Z.a,w.db,I.a,L.a,g.d,Ut.a]]}),e})();var z$=n("aLCL");let Q$=(()=>{class e{constructor(e,t,n,i,s){this.http=e,this.workspaceService=t,this.centUSDConverter=n,this.toaster=i,this.translateService=s,this.error=new p.a}create(e,t,n){const i=this.workspaceService.getDefaultWorkspaceId();return this.http.post(`/v1/workspaces/${i}/projects/${t}/tasks/`,{name:e,projectId:t,assigneeIds:n}).pipe(Object(u.a)(()=>{this.toaster.pop("success",this.translateService.instant("SERVICES.PROJECT.TASK.CREATE.SUCCESS_MESSAGE",{taskName:e}))},t=>{400==t.status&&(this.error.next(t),this.toaster.pop("error",this.translateService.instant("SERVICES.PROJECT.TASK.CREATE.ERROR_MESSAGE"),t&&t.error&&t.error.message||this.translateService.instant("SERVICES.PROJECT.TASK.NAME_EXISTS_ERROR_MESSAGE",{taskName:e})))}))}update(e,t=!0,n=""){const i=this.workspaceService.getDefaultWorkspaceId(),s={name:e.name,assigneeIds:e.assigneeIds,userGroupIds:e.userGroupIds,estimate:e.estimate,budgetEstimate:100*e.budgetEstimate,status:e.status?e.status:null,billable:e.billable},c=(new m.h).append("contains-assignee",t.toString()).append("membership-status",n);return this.http.put(`/v1/workspaces/${i}/projects/${e.projectId}/tasks/${e.id}`,s,{params:c}).pipe(Object(d.a)(e=>new yL.a(this.centUSDConverter.setAllHourlyRatesFromCentToUSD(e))),Object(u.a)(()=>{this.toaster.pop("success",this.translateService.instant("SERVICES.TASK.UPDATE.SUCCESS_MESSAGE",{taskName:e.name}))},t=>{400==t.status&&(this.error.next(t),this.toaster.pop("error",this.translateService.instant("SERVICES.PROJECT.TASK.UPDATE.ERROR_MESSAGE"),t&&t.error&&t.error.message||this.translateService.instant("SERVICES.TASK.NAME_EXISTS_ERROR_MESSAGE",{taskName:e.name})`Task with name ${e.name} already exists.`))}))}delete(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.delete(`/v1/workspaces/${t}/projects/${e.projectId}/tasks/${e.id}`).pipe(Object(u.a)(()=>{this.toaster.pop("success",this.translateService.instant("SERVICES.TASKS.DELETE.SUCESS_MESSAGE_WITH_NAME")`Task ${e.name} has been deleted.`)},e=>{this.error.next(e)}))}}return e.\u0275fac=function(t){return new(t||e)(s.fc(m.c),s.fc(l.a),s.fc(ft.a),s.fc(r.a),s.fc(g.f))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac}),e})();var J$=n("C1xe");let eK=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[J$.a,B$,i.c,v.m,v.C,O.a,$.a,M.a,L.a,S.a,g.d]]}),e})(),tK=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,v.m,v.C,J$.a,y.a,$.a,eK,z.a,L.a,S.a,g.d]]}),e})();var nK=n("TuBP"),iK=n("ggBK");let sK=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[UY],imports:[[i.c,y.a,Ze.a,nK.a,I.a,v.m,Ae.b,M.a,B.a,iK.a,Gt.a,g.d]]}),e})(),cK=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[Qe,v.m,i.c,Je,ne,w.O,g.d]]}),e})(),aK=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c]]}),e})(),oK=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},providers:[o,rn,E,xA,XA.a,N_.a,dn,Mi.a,WL.a,vn.a,SI,UA.a,z$.a,Q$,q.a,qS,KS.a,sH,c$,L$,UF,tY,iY,nY,kA,fw,RY,PP,BF,GF.a,R$,FA.a],imports:[[c,_,x,jt.a,ge,Xt,bt,sK,qe,tK,a.c,i.c,Nt.a,Ft,Pn,Mn,U$,j$,k$,me,lt,Z$,cK,q$,St.a,Ke,aK]]}),e})()},W8tW:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("lJxs"),s=n("vkgz"),c=n("1Tmk"),a=n("Ymxs"),o=n("wd/R");class r{constructor(e){this._name=e&&e.name,this._email=e&&e.email,this._weekStart=e&&e.weekStart,this._workCapacity=e&&e.workCapacity&&Number(Object(o.duration)(e.workCapacity).asHours().toFixed(2)),this._workspaceNumber=e&&e.workspaceNumber,this._hasPassword=e&&e.hasPassword,this._hasPendingApprovalRequest=e&&e.hasPendingApprovalRequest}get name(){return this._name}get email(){return this._email}get weekStart(){return this._weekStart}get workCapacity(){return this._workCapacity}get workspaceNumber(){return this._workspaceNumber}get hasPassword(){return this._hasPassword}get hasPendingApprovalRequest(){return this._hasPendingApprovalRequest}}var l=n("fXoL"),b=n("tk/3"),d=n("sYmb");let u=(()=>{class e{constructor(e,t,n,i){this.http=e,this.workspaceService=t,this.toaster=n,this.translateService=i}getMemberProfile(e){const t=this.workspaceService.getDefaultWorkspaceId();return this.http.get(`/workspaces/${t}/member-profile/${e}`).pipe(Object(i.a)(e=>new r(e)),Object(s.a)(()=>{},e=>{var t;return this.toaster.error(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)}))}updateMemberProfile(e,t){const n=this.workspaceService.getDefaultWorkspaceId();return this.http.patch(`/workspaces/${n}/member-profile/${e}`,t).pipe(Object(i.a)(e=>new r(e)),Object(s.a)(()=>{const e=this.translateService.instant("TEAMS.MEMBERS.EDIT_PROFILE.SERVICE.UPDATE_SUCCESS");this.toaster.pop("success",e)},e=>{var t;const n=this.translateService.instant("GLOBAL.UPDATE_FAILED_ERROR_MESSAGE");this.toaster.pop("error",(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||n)}))}}return e.\u0275fac=function(t){return new(t||e)(l.fc(b.c),l.fc(c.a),l.fc(a.a),l.fc(d.f))},e.\u0275prov=l.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},WjWa:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return e.SCREENSHOTS="SCREENSHOTS",e.LOCATIONS="LOCATIONS",e}({})},awBr:function(e,t,n){"use strict";function i(e,t){return e.start.toISOString()===t.start.toISOString()&&e.end.toISOString()===t.end.toISOString()}n.d(t,"a",(function(){return i}))},btz8:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var i=n("fXoL"),s=n("ofXK"),c=n("1kSV");function a(e,t){1&e&&i.Sb(0,"div",2)}function o(e,t){if(1&e&&(i.Xb(0,"span",12),i.Zc(1),i.Wb()),2&e){const e=i.nc(4);i.Cb(1),i.cd(" ",e.dailyTimeOffs[0].name," (",e.dailyTimeOffs[0].hoursDuration,")... ")}}function r(e,t){if(1&e&&(i.Xb(0,"div",10),i.Xc(1,o,2,2,"span",11),i.Wb()),2&e){i.nc();const e=i.Lc(4),t=i.nc(2);i.wc("ngbTooltip",e)("placement",t.tooltipPlacement),i.Cb(1),i.wc("ngIf",t.dailyTimeOffs[0].hours)}}function l(e,t){if(1&e&&(i.Xb(0,"span",12),i.Zc(1),i.Wb()),2&e){const e=i.nc(4);i.Cb(1),i.bd(" ",e.dailyTimeOffs[0].name,"...")}}function b(e,t){if(1&e&&(i.Xb(0,"div",13),i.Xc(1,l,2,1,"span",11),i.Wb()),2&e){i.nc();const e=i.Lc(4),t=i.nc(2);i.wc("ngbTooltip",e)("placement",t.tooltipPlacement),i.Cb(1),i.wc("ngIf",!t.dailyTimeOffs[0].hours)}}function d(e,t){if(1&e&&(i.Xb(0,"span",18),i.Zc(1),i.Wb()),2&e){const e=i.nc(2).$implicit;i.Cb(1),i.bd(" (",e.hours,"),")}}function u(e,t){if(1&e&&(i.Xb(0,"span",18),i.Zc(1),i.Wb()),2&e){const e=i.nc(2).$implicit;i.Cb(1),i.bd(" (",e.hours,")")}}function p(e,t){if(1&e&&(i.Xb(0,"div",14),i.Xb(1,"span"),i.Zc(2),i.Wb(),i.Xc(3,d,2,1,"span",17),i.Xc(4,u,2,1,"span",17),i.Wb()),2&e){const e=i.nc(),t=e.$implicit,n=e.last;i.Cb(2),i.cd(" ",t.name," (",t.hoursDuration,")"),i.Cb(1),i.wc("ngIf",!n),i.Cb(1),i.wc("ngIf",n)}}function h(e,t){if(1&e&&(i.Xb(0,"span"),i.Zc(1),i.Wb()),2&e){const e=i.nc(2).$implicit;i.Cb(1),i.bd(" ",e.name," (half-day),")}}function m(e,t){if(1&e&&(i.Xb(0,"span"),i.Zc(1),i.Wb()),2&e){const e=i.nc(2).$implicit;i.Cb(1),i.bd(" ",e.name," (half-day)")}}function g(e,t){if(1&e&&(i.Xb(0,"div"),i.Xc(1,h,2,1,"span",1),i.Xc(2,m,2,1,"span",1),i.Wb()),2&e){const e=i.nc().last;i.Cb(1),i.wc("ngIf",!e),i.Cb(1),i.wc("ngIf",e)}}function E(e,t){if(1&e&&(i.Xb(0,"span"),i.Zc(1),i.Wb()),2&e){const e=i.nc(2).$implicit;i.Cb(1),i.bd(" ",e.name,",")}}function f(e,t){if(1&e&&(i.Xb(0,"span"),i.Zc(1),i.Wb()),2&e){const e=i.nc(2).$implicit;i.Cb(1),i.ad(e.name)}}function S(e,t){if(1&e&&(i.Xb(0,"div"),i.Xc(1,E,2,1,"span",1),i.Xc(2,f,2,1,"span",1),i.Wb()),2&e){const e=i.nc().last;i.Cb(1),i.wc("ngIf",!e),i.Cb(1),i.wc("ngIf",e)}}function C(e,t){if(1&e&&(i.Xb(0,"div"),i.Xc(1,p,5,4,"div",16),i.Xc(2,g,3,2,"div",1),i.Xc(3,S,3,2,"div",1),i.Wb()),2&e){const e=t.$implicit;i.Cb(1),i.wc("ngIf",e.hours),i.Cb(1),i.wc("ngIf",e.isHalfDay),i.Cb(1),i.wc("ngIf",!e.isHalfDay&&!e.hours)}}function A(e,t){if(1&e&&(i.Xb(0,"div",14),i.Xc(1,C,4,3,"div",15),i.Wb()),2&e){const e=i.nc(3);i.Cb(1),i.wc("ngForOf",e.multipleTimeOffs)}}function O(e,t){if(1&e&&(i.Xb(0,"div",6),i.Xc(1,r,2,3,"div",7),i.Xc(2,b,2,3,"div",8),i.Xc(3,A,2,1,"ng-template",null,9,i.Yc),i.Wb()),2&e){const e=i.nc(2);i.Cb(1),i.wc("ngIf",e.dailyTimeOffs[0].hours),i.Cb(1),i.wc("ngIf",!e.dailyTimeOffs[0].hours)}}function v(e,t){if(1&e&&(i.Vb(0),i.Xb(1,"div",10),i.Xb(2,"span",12),i.Zc(3),i.Wb(),i.Wb(),i.Ub()),2&e){i.nc();const e=i.Lc(3),t=i.nc().$implicit,n=i.nc(3);i.Cb(1),i.wc("ngbTooltip",e)("placement",n.tooltipPlacement),i.Cb(2),i.cd(" ",t.name," (",t.hoursDuration,")")}}function T(e,t){if(1&e&&(i.Xb(0,"div",14),i.Xb(1,"span"),i.Zc(2),i.Wb(),i.Xb(3,"span",18),i.Zc(4),i.Wb(),i.Wb()),2&e){const e=i.nc(2).$implicit;i.Cb(2),i.cd(" ",e.name," (",e.hoursDuration,") "),i.Cb(2),i.bd(" (",e.hours,")")}}function I(e,t){if(1&e&&(i.Xb(0,"div",10),i.Xb(1,"span",12),i.Zc(2),i.Wb(),i.Wb()),2&e){const e=i.nc(2).$implicit,t=i.nc(3);i.wc("ngbTooltip",e.name.length>9?e.name:null)("placement",t.tooltipPlacement),i.Cb(2),i.bd(" ",e.name," ")}}function w(e,t){if(1&e&&(i.Vb(0),i.Xc(1,v,4,4,"ng-container",21),i.Xc(2,T,5,3,"ng-template",null,22,i.Yc),i.Xc(4,I,3,3,"ng-template",null,23,i.Yc),i.Ub()),2&e){const e=i.Lc(5),t=i.nc().$implicit;i.Cb(1),i.wc("ngIf",t.hours)("ngIfElse",e)}}function L(e,t){if(1&e&&(i.Xb(0,"div",10),i.Xb(1,"span",12),i.Zc(2),i.Wb(),i.Wb()),2&e){const e=i.nc().$implicit,t=i.nc(3);i.wc("ngbTooltip",e.name.length>9?e.name+" (half-day)":null)("placement",t.tooltipPlacement),i.Cb(2),i.bd(" ",e.name," (half-day) ")}}function R(e,t){if(1&e&&(i.Xb(0,"div",20),i.Xc(1,w,6,2,"ng-container",1),i.Xc(2,L,3,3,"div",7),i.Wb()),2&e){const e=t.$implicit;i.Cb(1),i.wc("ngIf",!e.isHalfDay),i.Cb(1),i.wc("ngIf",e.isHalfDay)}}function y(e,t){if(1&e&&i.Xc(0,R,3,2,"div",19),2&e){const e=i.nc(2);i.wc("ngForOf",e.dailyTimeOffs)}}function _(e,t){if(1&e&&(i.Vb(0),i.Xb(1,"div",3),i.Xc(2,O,5,2,"div",4),i.Xc(3,y,1,1,"ng-template",null,5,i.Yc),i.Wb(),i.Ub()),2&e){const e=i.Lc(4),t=i.nc();i.Cb(2),i.wc("ngIf",t.dailyTimeOffs.length>1)("ngIfElse",e)}}let k=(()=>{class e{constructor(){this.multipleTimeOffs=[],this.tooltipPlacement=["bottom","left","right"]}set dailyTimeOffs(e){this._dailyTimeOffs=e,this.calculateHoursDuration()}get dailyTimeOffs(){return this._dailyTimeOffs}calculateHoursDuration(){this.dailyTimeOffs.length>1&&this.dailyTimeOffs.forEach((e,t)=>{this.multipleTimeOffs.push(e)}),this.dailyTimeOffs.forEach((e,t)=>{if(e.hours){const t=e.period.end.diff(e.period.start,"minutes");e.hoursDuration=t/60+"h"}})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Lb({type:e,selectors:[["time-off-band"]],inputs:{dailyTimeOffs:"dailyTimeOffs",tooltipPlacement:"tooltipPlacement"},decls:2,vars:2,consts:[["class","cl-time-off-band",4,"ngIf"],[4,"ngIf"],[1,"cl-time-off-band"],[1,"cl-d-flex","cl-justify-content-left","cl-align-items-center","cl-time-off-band"],["class","cl-d-block cl-cut-text-wrapper cl-w-100",4,"ngIf","ngIfElse"],["oneTimeOffPerDay",""],[1,"cl-d-block","cl-cut-text-wrapper","cl-w-100"],["class","cl-d-flex",3,"ngbTooltip","placement",4,"ngIf"],["class","cl-d-block cl-cut-text cl-w-100 cl-text-left",3,"ngbTooltip","placement",4,"ngIf"],["timeOffList",""],[1,"cl-d-flex",3,"ngbTooltip","placement"],["class","cl-cut-text",4,"ngIf"],[1,"cl-cut-text"],[1,"cl-d-block","cl-cut-text","cl-w-100","cl-text-left",3,"ngbTooltip","placement"],[1,"cl-time-off-tooltip"],[4,"ngFor","ngForOf"],["class","cl-time-off-tooltip",4,"ngIf"],["class","cl-arrow-disabled",4,"ngIf"],[1,"cl-arrow-disabled"],["class","cl-cut-text-wrapper",4,"ngFor","ngForOf"],[1,"cl-cut-text-wrapper"],[4,"ngIf","ngIfElse"],["timeOffHoursTooltip",""],["fullDay",""]],template:function(e,t){1&e&&(i.Xc(0,a,1,0,"div",0),i.Xc(1,_,5,2,"ng-container",1)),2&e&&(i.wc("ngIf",!t.dailyTimeOffs.length),i.Cb(1),i.wc("ngIf",null==t.dailyTimeOffs?null:t.dailyTimeOffs.length))},directives:[s.u,c.bb,s.t],encapsulation:2}),e})()},ddZv:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var i=n("wd/R"),s=n("1Tmk"),c=n("tzGe"),a=n("Ymxs"),o=n("fXoL"),r=n("tk/3"),l=n("sYmb");let b=(()=>{class e{constructor(e,t,n,i,s){this.http=e,this.workspaceService=t,this.stopwatchService=n,this.toaster=i,this.translateService=s}endStartedTimeEntry(){const e=this.workspaceService.getDefaultWorkspaceId(),t={end:i().toISOString()};return this.http.put(`/workspaces/${e}/timeEntries/endStarted`,t)}addStartedTimeEntry(e){const t=this.workspaceService.getDefaultWorkspaceId(),n={start:i().toISOString(),billable:e.billable,description:e.description,projectId:e.projectId,taskId:e.taskId,tagIds:e.tagIds};this.http.post(`/workspaces/${t}/timeEntries/`,n).subscribe(()=>{this.stopwatchService.start()},e=>{this.toaster.pop("error",e&&e.error&&e.error.message||this.translateService.instant("SERVICES.TIMER.START.ERROR_MESSAGE"))})}}return e.\u0275fac=function(t){return new(t||e)(o.fc(r.c),o.fc(s.a),o.fc(c.a),o.fc(a.a),o.fc(l.f))},e.\u0275prov=o.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},lNpb:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return e.DAYS="DAYS",e.HOURS="HOURS",e}({})},nNwe:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("ofXK"),s=n("3Pt+"),c=n("9Trn"),a=n("sYmb"),o=n("1kSV"),r=n("fXoL");let l=(()=>{class e{}return e.\u0275mod=r.Pb({type:e}),e.\u0275inj=r.Ob({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,s.m,c.a,a.d,o.s]]}),e})()},twZS:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("83av");const s=e=>{const t=e.get("users"),n=t.get("contains"),s=t.get("ids"),c=e.get("userGroups"),a=c.get("contains"),o=c.get("ids");return n.value||a.value?n.value===i.a.CONTAINS&&a.value===i.a.CONTAINS&&s.value&&0===s.value.length&&o.value&&0===o.value.length?{usersAndUserGroupsInvalid:!0}:void 0:{usersAndUserGroupsInvalid:!0}}}}]);